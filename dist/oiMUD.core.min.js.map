{
  "version": 3,
  "sources": ["../src/lib/inflate_stream.min.js", "../src/lib/buzz.js", "../src/lib/pathfinding3D.js", "../src/events.ts", "../src/library.ts", "../src/telnet.ts", "../src/ansi.ts", "../src/types.ts", "../src/settings.ts", "../src/profile.ts", "../src/input.ts", "../src/lib/rgbcolor.js", "../src/parser.ts", "../src/display.ts", "../package.json", "../src/plugins/msp.ts", "../src/plugin.ts", "../src/plugins/test.ts", "../src/interface/mapdisplay.ts", "../src/map.ts", "../src/interface/dialog.ts", "../src/interface/menu.ts", "../src/interface/adv.editor.ts", "../src/interface/settingsdialog.ts", "../src/interface/splitter.ts", "../src/interface/profilesdialog.ts", "../src/interface/contextmenu.ts", "../src/interface/interface.ts", "../src/html/mapper.menu.htm", "../src/html/mapper.room.htm", "../src/plugins/mapper.ts", "../src/client.ts"],
  "sourcesContent": ["/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function() {'use strict';var k=void 0,l=!0,aa=this;function s(a,d){var b=a.split(\".\"),c=aa;!(b[0]in c)&&c.execScript&&c.execScript(\"var \"+b[0]);for(var e;b.length&&(e=b.shift());)!b.length&&d!==k?c[e]=d:c=c[e]?c[e]:c[e]={}};var x=\"undefined\"!==typeof Uint8Array&&\"undefined\"!==typeof Uint16Array&&\"undefined\"!==typeof Uint32Array&&\"undefined\"!==typeof DataView;function y(a){var d=a.length,b=0,c=Number.POSITIVE_INFINITY,e,g,f,p,h,q,m,n,r,B;for(n=0;n<d;++n)a[n]>b&&(b=a[n]),a[n]<c&&(c=a[n]);e=1<<b;g=new (x?Uint32Array:Array)(e);f=1;p=0;for(h=2;f<=b;){for(n=0;n<d;++n)if(a[n]===f){q=0;m=p;for(r=0;r<f;++r)q=q<<1|m&1,m>>=1;B=f<<16|n;for(r=q;r<e;r+=h)g[r]=B;++p}++f;p<<=1;h<<=1}return[g,b,c]};function z(a,d,b){this.u=[];this.i=b?b:32768;this.v=0;this.a=d===k?0:d;this.d=this.e=0;this.input=x?new Uint8Array(a):a;this.b=new (x?Uint8Array:Array)(this.i);this.c=0;this.t=this.l=!1;this.f=0;this.status=A}var A=0;\nz.prototype.j=function(a,d){var b=!1;a!==k&&(this.input=a);d!==k&&(this.a=d);for(;!b;)switch(this.status){case A:case 1:var c;var e=k;this.status=1;H(this);if(0>(e=I(this,3)))J(this),c=-1;else{e&1&&(this.l=l);e>>>=1;switch(e){case 0:this.h=0;break;case 1:this.h=1;break;case 2:this.h=2;break;default:throw Error(\"unknown BTYPE: \"+e);}this.status=2;c=k}0>c&&(b=l);break;case 2:case 3:switch(this.h){case 0:var g;var f=k,p=k,h=this.input,q=this.a;this.status=3;if(q+4>=h.length)g=-1;else{f=h[q++]|h[q++]<<\n8;p=h[q++]|h[q++]<<8;if(f===~p)throw Error(\"invalid uncompressed block header: length verify\");this.d=this.e=0;this.a=q;this.m=f;this.status=4;g=k}0>g&&(b=l);break;case 1:this.status=3;this.k=ba;this.n=ca;this.status=4;break;case 2:var m;a:{var n=k,r=k,B=k,V=new (x?Uint8Array:Array)(K.length),W=k;this.status=3;H(this);n=I(this,5)+257;r=I(this,5)+1;B=I(this,4)+4;if(0>n||0>r||0>B)J(this),m=-1;else{try{for(var w=k,D=k,E=0,C=k,u=k,t=k,X=k,t=0;t<B;++t){if(0>(w=I(this,3)))throw Error(\"not enough input\");\nV[K[t]]=w}W=y(V);u=new (x?Uint8Array:Array)(n+r);t=0;for(X=n+r;t<X;){D=O(this,W);if(0>D)throw Error(\"not enough input\");switch(D){case 16:if(0>(w=I(this,2)))throw Error(\"not enough input\");for(C=3+w;C--;)u[t++]=E;break;case 17:if(0>(w=I(this,3)))throw Error(\"not enough input\");for(C=3+w;C--;)u[t++]=0;E=0;break;case 18:if(0>(w=I(this,7)))throw Error(\"not enough input\");for(C=11+w;C--;)u[t++]=0;E=0;break;default:E=u[t++]=D}}new (x?Uint8Array:Array)(n);new (x?Uint8Array:Array)(r);this.k=x?y(u.subarray(0,\nn)):y(u.slice(0,n));this.n=x?y(u.subarray(n)):y(u.slice(n))}catch(pa){J(this);m=-1;break a}this.status=4;m=0}}0>m&&(b=l)}break;case 4:case 5:switch(this.h){case 0:var L;a:{var Y=this.input,F=this.a,M=this.b,G=this.c,N=this.m;for(this.status=5;N--;){G===M.length&&(M=P(this,{o:2}));if(F>=Y.length){this.a=F;this.c=G;this.m=N+1;L=-1;break a}M[G++]=Y[F++]}0>N&&(this.status=6);this.a=F;this.c=G;L=0}0>L&&(b=l);break;case 1:case 2:0>da(this)&&(b=l)}break;case 6:this.l?b=l:this.status=A}var Z,v=this.c,$;Z=\nthis.t?x?new Uint8Array(this.b.subarray(this.f,v)):this.b.slice(this.f,v):x?this.b.subarray(this.f,v):this.b.slice(this.f,v);this.f=v;v>32768+this.i&&(this.c=this.f=32768,x?($=this.b,this.b=new Uint8Array(this.i+32768),this.b.set($.subarray(v-32768,v))):this.b=this.b.slice(v-32768));return Z};\nvar ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=x?new Uint16Array(ea):ea,fa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ga=x?new Uint16Array(fa):fa,ha=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],ia=x?new Uint8Array(ha):ha,ja=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ka=x?new Uint16Array(ja):ja,la=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,\n11,11,12,12,13,13],ma=x?new Uint8Array(la):la,Q=new (x?Uint8Array:Array)(288),R,na;R=0;for(na=Q.length;R<na;++R)Q[R]=143>=R?8:255>=R?9:279>=R?7:8;var ba=y(Q),S=new (x?Uint8Array:Array)(30),T,oa;T=0;for(oa=S.length;T<oa;++T)S[T]=5;var ca=y(S);function I(a,d){for(var b=a.e,c=a.d,e=a.input,g=a.a,f;c<d;){if(e.length<=g)return-1;f=e[g++];b|=f<<c;c+=8}f=b&(1<<d)-1;a.e=b>>>d;a.d=c-d;a.a=g;return f}\nfunction O(a,d){for(var b=a.e,c=a.d,e=a.input,g=a.a,f=d[0],p=d[1],h,q,m;c<p;){if(e.length<=g)return-1;h=e[g++];b|=h<<c;c+=8}q=f[b&(1<<p)-1];m=q>>>16;if(m>c)throw Error(\"invalid code length: \"+m);a.e=b>>m;a.d=c-m;a.a=g;return q&65535}function H(a){a.s=a.a;a.r=a.d;a.q=a.e}function J(a){a.a=a.s;a.d=a.r;a.e=a.q}\nfunction da(a){var d=a.b,b=a.c,c,e,g,f,p=a.k,h=a.n,q=d.length,m;for(a.status=5;;){H(a);c=O(a,p);if(0>c)return a.c=b,J(a),-1;if(256===c)break;if(256>c)b===q&&(d=P(a),q=d.length),d[b++]=c;else{e=c-257;f=ga[e];if(0<ia[e]){m=I(a,ia[e]);if(0>m)return a.c=b,J(a),-1;f+=m}c=O(a,h);if(0>c)return a.c=b,J(a),-1;g=ka[c];if(0<ma[c]){m=I(a,ma[c]);if(0>m)return a.c=b,J(a),-1;g+=m}b+f>=q&&(d=P(a),q=d.length);for(;f--;)d[b]=d[b++-g];if(a.a===a.input.length)return a.c=b,-1}}for(;8<=a.d;)a.d-=8,a.a--;a.c=b;a.status=\n6}function P(a,d){var b,c=a.input.length/a.a+1|0,e,g,f,p=a.input,h=a.b;d&&(\"number\"===typeof d.o&&(c=d.o),\"number\"===typeof d.p&&(c+=d.p));2>c?(e=(p.length-a.a)/a.k[2],f=258*(e/2)|0,g=f<h.length?h.length+f:h.length<<1):g=h.length*c;x?(b=new Uint8Array(g),b.set(h)):b=h;a.b=b;return a.b};function U(a){this.input=a===k?new (x?Uint8Array:Array):a;this.a=0;this.g=new z(this.input,this.a);this.b=this.g.b}\nU.prototype.j=function(a){var d;if(a!==k)if(x){var b=new Uint8Array(this.input.length+a.length);b.set(this.input,0);b.set(a,this.input.length);this.input=b}else this.input=this.input.concat(a);var c;if(c=this.method===k){var e;var g=this.a,f=this.input,p=f[g++],h=f[g++];if(p===k||h===k)e=-1;else{switch(p&15){case 8:this.method=8;break;default:throw Error(\"unsupported compression method\");}if(0!==((p<<8)+h)%31)throw Error(\"invalid fcheck flag:\"+((p<<8)+h)%31);if(h&32)throw Error(\"fdict flag is not supported\");\nthis.a=g;e=k}c=0>e}if(c)return new (x?Uint8Array:Array);d=this.g.j(this.input,this.a);0!==this.g.a&&(this.input=x?this.input.subarray(this.g.a):this.input.slice(this.g.a),this.a=0);return d};s(\"Zlib.InflateStream\",U);s(\"Zlib.InflateStream.prototype.decompress\",U.prototype.j);}).call(this);\n", " // ----------------------------------------------------------------------------\n // Buzz, a Javascript HTML5 Audio library\n // v1.1.10 - Built 2015-04-20 13:05\n // Licensed under the MIT license.\n // http://buzz.jaysalvat.com/\n // ----------------------------------------------------------------------------\n // Copyright (C) 2010-2015 Jay Salvat\n // http://jaysalvat.com/\n // ----------------------------------------------------------------------------\n\n(function(context, factory) {\n    \"use strict\";\n    if (typeof module !== \"undefined\" && module.exports) {\n        module.exports = factory();\n    } else if (typeof define === \"function\" && define.amd) {\n        define([], factory);\n    } else {\n        context.buzz = factory();\n    }\n})(this, function() {\n    \"use strict\";\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\n    var buzz = {\n        defaults: {\n            autoplay: false,\n            duration: 5e3,\n            formats: [],\n            loop: false,\n            placeholder: \"--\",\n            preload: \"metadata\",\n            volume: 80,\n            webAudioApi: false,\n            document: window.document\n        },\n        types: {\n            mp3: \"audio/mpeg\",\n            ogg: \"audio/ogg\",\n            wav: \"audio/wav\",\n            aac: \"audio/aac\",\n            m4a: \"audio/x-m4a\"\n        },\n        sounds: [],\n        el: document.createElement(\"audio\"),\n        getAudioContext: function() {\n            if (this.audioCtx === undefined) {\n                try {\n                    this.audioCtx = AudioContext ? new AudioContext() : null;\n                } catch (e) {\n                    this.audioCtx = null;\n                }\n            }\n            return this.audioCtx;\n        },\n        sound: function(src, options) {\n            options = options || {};\n            var doc = options.document || buzz.defaults.document;\n            var pid = 0, events = [], eventsOnce = {}, supported = buzz.isSupported();\n            this.load = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.load();\n                return this;\n            };\n            this.play = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.play();\n                return this;\n            };\n            this.togglePlay = function() {\n                if (!supported) {\n                    return this;\n                }\n                if (this.sound.paused) {\n                    this.sound.play();\n                } else {\n                    this.sound.pause();\n                }\n                return this;\n            };\n            this.pause = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.pause();\n                return this;\n            };\n            this.isPaused = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.paused;\n            };\n            this.stop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.setTime(0);\n                this.sound.pause();\n                return this;\n            };\n            this.isEnded = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.ended;\n            };\n            this.loop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.loop = \"loop\";\n                this.bind(\"ended.buzzloop\", function() {\n                    this.currentTime = 0;\n                    this.play();\n                });\n                return this;\n            };\n            this.unloop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.removeAttribute(\"loop\");\n                this.unbind(\"ended.buzzloop\");\n                return this;\n            };\n            this.mute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = true;\n                return this;\n            };\n            this.unmute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = false;\n                return this;\n            };\n            this.toggleMute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = !this.sound.muted;\n                return this;\n            };\n            this.isMuted = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.muted;\n            };\n            this.setVolume = function(volume) {\n                if (!supported) {\n                    return this;\n                }\n                if (volume < 0) {\n                    volume = 0;\n                }\n                if (volume > 100) {\n                    volume = 100;\n                }\n                this.volume = volume;\n                this.sound.volume = volume / 100;\n                return this;\n            };\n            this.getVolume = function() {\n                if (!supported) {\n                    return this;\n                }\n                return this.volume;\n            };\n            this.increaseVolume = function(value) {\n                return this.setVolume(this.volume + (value || 1));\n            };\n            this.decreaseVolume = function(value) {\n                return this.setVolume(this.volume - (value || 1));\n            };\n            this.setTime = function(time) {\n                if (!supported) {\n                    return this;\n                }\n                var set = true;\n                this.whenReady(function() {\n                    if (set === true) {\n                        set = false;\n                        this.sound.currentTime = time;\n                    }\n                });\n                return this;\n            };\n            this.getTime = function() {\n                if (!supported) {\n                    return null;\n                }\n                var time = Math.round(this.sound.currentTime * 100) / 100;\n                return isNaN(time) ? buzz.defaults.placeholder : time;\n            };\n            this.setPercent = function(percent) {\n                if (!supported) {\n                    return this;\n                }\n                return this.setTime(buzz.fromPercent(percent, this.sound.duration));\n            };\n            this.getPercent = function() {\n                if (!supported) {\n                    return null;\n                }\n                var percent = Math.round(buzz.toPercent(this.sound.currentTime, this.sound.duration));\n                return isNaN(percent) ? buzz.defaults.placeholder : percent;\n            };\n            this.setSpeed = function(duration) {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.playbackRate = duration;\n                return this;\n            };\n            this.getSpeed = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.playbackRate;\n            };\n            this.getDuration = function() {\n                if (!supported) {\n                    return null;\n                }\n                var duration = Math.round(this.sound.duration * 100) / 100;\n                return isNaN(duration) ? buzz.defaults.placeholder : duration;\n            };\n            this.getPlayed = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.played);\n            };\n            this.getBuffered = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.buffered);\n            };\n            this.getSeekable = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.seekable);\n            };\n            this.getErrorCode = function() {\n                if (supported && this.sound.error) {\n                    return this.sound.error.code;\n                }\n                return 0;\n            };\n            this.getErrorMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getErrorCode()) {\n                  case 1:\n                    return \"MEDIA_ERR_ABORTED\";\n\n                  case 2:\n                    return \"MEDIA_ERR_NETWORK\";\n\n                  case 3:\n                    return \"MEDIA_ERR_DECODE\";\n\n                  case 4:\n                    return \"MEDIA_ERR_SRC_NOT_SUPPORTED\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.getStateCode = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.readyState;\n            };\n            this.getStateMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getStateCode()) {\n                  case 0:\n                    return \"HAVE_NOTHING\";\n\n                  case 1:\n                    return \"HAVE_METADATA\";\n\n                  case 2:\n                    return \"HAVE_CURRENT_DATA\";\n\n                  case 3:\n                    return \"HAVE_FUTURE_DATA\";\n\n                  case 4:\n                    return \"HAVE_ENOUGH_DATA\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.getNetworkStateCode = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.networkState;\n            };\n            this.getNetworkStateMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getNetworkStateCode()) {\n                  case 0:\n                    return \"NETWORK_EMPTY\";\n\n                  case 1:\n                    return \"NETWORK_IDLE\";\n\n                  case 2:\n                    return \"NETWORK_LOADING\";\n\n                  case 3:\n                    return \"NETWORK_NO_SOURCE\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.set = function(key, value) {\n                if (!supported) {\n                    return this;\n                }\n                this.sound[key] = value;\n                return this;\n            };\n            this.get = function(key) {\n                if (!supported) {\n                    return null;\n                }\n                return key ? this.sound[key] : this.sound;\n            };\n            this.bind = function(types, func) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                var self = this, efunc = function(e) {\n                    func.call(self, e);\n                };\n                for (var t = 0; t < types.length; t++) {\n                    var type = types[t], idx = type;\n                    type = idx.split(\".\")[0];\n                    events.push({\n                        idx: idx,\n                        func: efunc\n                    });\n                    this.sound.addEventListener(type, efunc, true);\n                }\n                return this;\n            };\n            this.unbind = function(types) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                for (var t = 0; t < types.length; t++) {\n                    var idx = types[t], type = idx.split(\".\")[0];\n                    for (var i = 0; i < events.length; i++) {\n                        var namespace = events[i].idx.split(\".\");\n                        if (events[i].idx === idx || namespace[1] && namespace[1] === idx.replace(\".\", \"\")) {\n                            this.sound.removeEventListener(type, events[i].func, true);\n                            events.splice(i, 1);\n                        }\n                    }\n                }\n                return this;\n            };\n            this.bindOnce = function(type, func) {\n                if (!supported) {\n                    return this;\n                }\n                var self = this;\n                eventsOnce[pid++] = false;\n                this.bind(type + \".\" + pid, function() {\n                    if (!eventsOnce[pid]) {\n                        eventsOnce[pid] = true;\n                        func.call(self);\n                    }\n                    self.unbind(type + \".\" + pid);\n                });\n                return this;\n            };\n            this.trigger = function(types, detail) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                for (var t = 0; t < types.length; t++) {\n                    var idx = types[t];\n                    for (var i = 0; i < events.length; i++) {\n                        var eventType = events[i].idx.split(\".\");\n                        if (events[i].idx === idx || eventType[0] && eventType[0] === idx.replace(\".\", \"\")) {\n                            var evt = doc.createEvent(\"HTMLEvents\");\n                            evt.initEvent(eventType[0], false, true);\n                            evt.originalEvent = detail;\n                            this.sound.dispatchEvent(evt);\n                        }\n                    }\n                }\n                return this;\n            };\n            this.fadeTo = function(to, duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                if (duration instanceof Function) {\n                    callback = duration;\n                    duration = buzz.defaults.duration;\n                } else {\n                    duration = duration || buzz.defaults.duration;\n                }\n                var from = this.volume, delay = duration / Math.abs(from - to), self = this;\n                this.play();\n                function doFade() {\n                    setTimeout(function() {\n                        if (from < to && self.volume < to) {\n                            self.setVolume(self.volume += 1);\n                            doFade();\n                        } else if (from > to && self.volume > to) {\n                            self.setVolume(self.volume -= 1);\n                            doFade();\n                        } else if (callback instanceof Function) {\n                            callback.apply(self);\n                        }\n                    }, delay);\n                }\n                this.whenReady(function() {\n                    doFade();\n                });\n                return this;\n            };\n            this.fadeIn = function(duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                return this.setVolume(0).fadeTo(100, duration, callback);\n            };\n            this.fadeOut = function(duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                return this.fadeTo(0, duration, callback);\n            };\n            this.fadeWith = function(sound, duration) {\n                if (!supported) {\n                    return this;\n                }\n                this.fadeOut(duration, function() {\n                    this.stop();\n                });\n                sound.play().fadeIn(duration);\n                return this;\n            };\n            this.whenReady = function(func) {\n                if (!supported) {\n                    return null;\n                }\n                var self = this;\n                if (this.sound.readyState === 0) {\n                    this.bind(\"canplay.buzzwhenready\", function() {\n                        func.call(self);\n                    });\n                } else {\n                    func.call(self);\n                }\n            };\n            this.addSource = function(src) {\n                var self = this, source = doc.createElement(\"source\");\n                source.src = src;\n                if (buzz.types[getExt(src)]) {\n                    source.type = buzz.types[getExt(src)];\n                }\n                this.sound.appendChild(source);\n                source.addEventListener(\"error\", function(e) {\n                    self.trigger(\"sourceerror\", e);\n                });\n                return source;\n            };\n            function timerangeToArray(timeRange) {\n                var array = [], length = timeRange.length - 1;\n                for (var i = 0; i <= length; i++) {\n                    array.push({\n                        start: timeRange.start(i),\n                        end: timeRange.end(i)\n                    });\n                }\n                return array;\n            }\n            function getExt(filename) {\n                return filename.split(\".\").pop();\n            }\n            if (supported && src) {\n                for (var i in buzz.defaults) {\n                    if (buzz.defaults.hasOwnProperty(i)) {\n                        if (options[i] === undefined) {\n                            options[i] = buzz.defaults[i];\n                        }\n                    }\n                }\n                this.sound = doc.createElement(\"audio\");\n                if (options.webAudioApi) {\n                    var audioCtx = buzz.getAudioContext();\n                    if (audioCtx) {\n                        this.source = audioCtx.createMediaElementSource(this.sound);\n                        this.source.connect(audioCtx.destination);\n                    }\n                }\n                if (src instanceof Array) {\n                    for (var j in src) {\n                        if (src.hasOwnProperty(j)) {\n                            this.addSource(src[j]);\n                        }\n                    }\n                } else if (options.formats.length) {\n                    for (var k in options.formats) {\n                        if (options.formats.hasOwnProperty(k)) {\n                            this.addSource(src + \".\" + options.formats[k]);\n                        }\n                    }\n                } else {\n                    this.addSource(src);\n                }\n                if (options.loop) {\n                    this.loop();\n                }\n                if (options.autoplay) {\n                    this.sound.autoplay = \"autoplay\";\n                }\n                if (options.preload === true) {\n                    this.sound.preload = \"auto\";\n                } else if (options.preload === false) {\n                    this.sound.preload = \"none\";\n                } else {\n                    this.sound.preload = options.preload;\n                }\n                this.setVolume(options.volume);\n                buzz.sounds.push(this);\n            }\n        },\n        group: function(sounds) {\n            sounds = argsToArray(sounds, arguments);\n            this.getSounds = function() {\n                return sounds;\n            };\n            this.add = function(soundArray) {\n                soundArray = argsToArray(soundArray, arguments);\n                for (var a = 0; a < soundArray.length; a++) {\n                    sounds.push(soundArray[a]);\n                }\n            };\n            this.remove = function(soundArray) {\n                soundArray = argsToArray(soundArray, arguments);\n                for (var a = 0; a < soundArray.length; a++) {\n                    for (var i = 0; i < sounds.length; i++) {\n                        if (sounds[i] === soundArray[a]) {\n                            sounds.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n            };\n            this.load = function() {\n                fn(\"load\");\n                return this;\n            };\n            this.play = function() {\n                fn(\"play\");\n                return this;\n            };\n            this.togglePlay = function() {\n                fn(\"togglePlay\");\n                return this;\n            };\n            this.pause = function(time) {\n                fn(\"pause\", time);\n                return this;\n            };\n            this.stop = function() {\n                fn(\"stop\");\n                return this;\n            };\n            this.mute = function() {\n                fn(\"mute\");\n                return this;\n            };\n            this.unmute = function() {\n                fn(\"unmute\");\n                return this;\n            };\n            this.toggleMute = function() {\n                fn(\"toggleMute\");\n                return this;\n            };\n            this.setVolume = function(volume) {\n                fn(\"setVolume\", volume);\n                return this;\n            };\n            this.increaseVolume = function(value) {\n                fn(\"increaseVolume\", value);\n                return this;\n            };\n            this.decreaseVolume = function(value) {\n                fn(\"decreaseVolume\", value);\n                return this;\n            };\n            this.loop = function() {\n                fn(\"loop\");\n                return this;\n            };\n            this.unloop = function() {\n                fn(\"unloop\");\n                return this;\n            };\n            this.setSpeed = function(speed) {\n                fn(\"setSpeed\", speed);\n                return this;\n            };\n            this.setTime = function(time) {\n                fn(\"setTime\", time);\n                return this;\n            };\n            this.set = function(key, value) {\n                fn(\"set\", key, value);\n                return this;\n            };\n            this.bind = function(type, func) {\n                fn(\"bind\", type, func);\n                return this;\n            };\n            this.unbind = function(type) {\n                fn(\"unbind\", type);\n                return this;\n            };\n            this.bindOnce = function(type, func) {\n                fn(\"bindOnce\", type, func);\n                return this;\n            };\n            this.trigger = function(type) {\n                fn(\"trigger\", type);\n                return this;\n            };\n            this.fade = function(from, to, duration, callback) {\n                fn(\"fade\", from, to, duration, callback);\n                return this;\n            };\n            this.fadeIn = function(duration, callback) {\n                fn(\"fadeIn\", duration, callback);\n                return this;\n            };\n            this.fadeOut = function(duration, callback) {\n                fn(\"fadeOut\", duration, callback);\n                return this;\n            };\n            function fn() {\n                var args = argsToArray(null, arguments), func = args.shift();\n                for (var i = 0; i < sounds.length; i++) {\n                    sounds[i][func].apply(sounds[i], args);\n                }\n            }\n            function argsToArray(array, args) {\n                return array instanceof Array ? array : Array.prototype.slice.call(args);\n            }\n        },\n        all: function() {\n            return new buzz.group(buzz.sounds);\n        },\n        isSupported: function() {\n            return !!buzz.el.canPlayType;\n        },\n        isOGGSupported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType('audio/ogg; codecs=\"vorbis\"');\n        },\n        isWAVSupported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType('audio/wav; codecs=\"1\"');\n        },\n        isMP3Supported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType(\"audio/mpeg;\");\n        },\n        isAACSupported: function() {\n            return !!buzz.el.canPlayType && (buzz.el.canPlayType(\"audio/x-m4a;\") || buzz.el.canPlayType(\"audio/aac;\"));\n        },\n        toTimer: function(time, withHours) {\n            var h, m, s;\n            h = Math.floor(time / 3600);\n            h = isNaN(h) ? \"--\" : h >= 10 ? h : \"0\" + h;\n            m = withHours ? Math.floor(time / 60 % 60) : Math.floor(time / 60);\n            m = isNaN(m) ? \"--\" : m >= 10 ? m : \"0\" + m;\n            s = Math.floor(time % 60);\n            s = isNaN(s) ? \"--\" : s >= 10 ? s : \"0\" + s;\n            return withHours ? h + \":\" + m + \":\" + s : m + \":\" + s;\n        },\n        fromTimer: function(time) {\n            var splits = time.toString().split(\":\");\n            if (splits && splits.length === 3) {\n                time = parseInt(splits[0], 10) * 3600 + parseInt(splits[1], 10) * 60 + parseInt(splits[2], 10);\n            }\n            if (splits && splits.length === 2) {\n                time = parseInt(splits[0], 10) * 60 + parseInt(splits[1], 10);\n            }\n            return time;\n        },\n        toPercent: function(value, total, decimal) {\n            var r = Math.pow(10, decimal || 0);\n            return Math.round(value * 100 / total * r) / r;\n        },\n        fromPercent: function(percent, total, decimal) {\n            var r = Math.pow(10, decimal || 0);\n            return Math.round(total / 100 * percent * r) / r;\n        }\n    };\n    return buzz;\n});", "/**\n *    ____       _   _     _____ _           _ _                _         \n *   |  _ \\ __ _| |_| |__ |  ___(_)_ __   __| (_)_ __   __ _   (_)___     \n *   | |_) / _` | __| '_ \\| |_  | | '_ \\ / _` | | '_ \\ / _` |  | / __|    \n *   |  __/ (_| | |_| | | |  _| | | | | | (_| | | | | | (_| |_ | \\__ \\    \n *   |_|   \\__,_|\\__|_| |_|_|   |_|_| |_|\\__,_|_|_| |_|\\__, (_)/ |___/    \n *                                                     |___/ |__/         \n *   https://github.com/qiao/PathFinding.js\n */\n(function (e) {\n    if (\"function\" == typeof bootstrap) bootstrap(\"pf\", e);\n    else if (\"object\" == typeof exports) module.exports = e();\n    else if (\"function\" == typeof define && define.amd) define(e);\n    else if (\"undefined\" != typeof ses) {\n        if (!ses.ok()) return;\n        ses.makePF = e\n    }\n    else \"undefined\" != typeof window ? window.PF = e() : global.PF = e();\n})(function () {\n    var define, ses, bootstrap, module, exports;\n    return (function (e, t, n) { function i(n, s) { if (!t[n]) { if (!e[n]) { var o = typeof require == \"function\" && require; if (!s && o) return o(n, !0); if (r) return r(n, !0); throw new Error(\"Cannot find module '\" + n + \"'\") } var u = t[n] = { exports: {} }; e[n][0].call(u.exports, function (t) { var r = e[n][1][t]; return i(r ? r : t) }, u, u.exports) } return t[n].exports } var r = typeof require == \"function\" && require; for (var s = 0; s < n.length; s++)i(n[s]); return i })({\n        1: [function (require, module, exports) {\n            module.exports = require('./lib/heap');\n\n        }, { \"./lib/heap\": 2 }], 2: [function (require, module, exports) {\n            // Generated by CoffeeScript 1.6.3\n            (function () {\n                var Heap, defaultCmp, floor, heapify, heappop, heappush, heappushpop, heapreplace, insort, min, nlargest, nsmallest, updateItem, _siftdown, _siftup;\n\n                floor = Math.floor, min = Math.min;\n\n                /* \n                Default comparison function to be used\n                */\n\n\n                defaultCmp = function (x, y) {\n                    if (x < y) {\n                        return -1;\n                    }\n                    if (x > y) {\n                        return 1;\n                    }\n                    return 0;\n                };\n\n                /* \n                Insert item x in list a, and keep it sorted assuming a is sorted.\n                \n                If x is already in a, insert it to the right of the rightmost x.\n                \n                Optional args lo (default 0) and hi (default a.length) bound the slice\n                of a to be searched.\n                */\n\n\n                insort = function (a, x, lo, hi, cmp) {\n                    var mid;\n                    if (lo == null) {\n                        lo = 0;\n                    }\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (lo < 0) {\n                        throw new Error('lo must be non-negative');\n                    }\n                    if (hi == null) {\n                        hi = a.length;\n                    }\n                    while (lo < hi) {\n                        mid = floor((lo + hi) / 2);\n                        if (cmp(x, a[mid]) < 0) {\n                            hi = mid;\n                        } else {\n                            lo = mid + 1;\n                        }\n                    }\n                    return ([].splice.apply(a, [lo, lo - lo].concat(x)), x);\n                };\n\n                /*\n                Push item onto heap, maintaining the heap invariant.\n                */\n\n\n                heappush = function (array, item, cmp) {\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    array.push(item);\n                    return _siftdown(array, 0, array.length - 1, cmp);\n                };\n\n                /*\n                Pop the smallest item off the heap, maintaining the heap invariant.\n                */\n\n\n                heappop = function (array, cmp) {\n                    var lastelt, returnitem;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    lastelt = array.pop();\n                    if (array.length) {\n                        returnitem = array[0];\n                        array[0] = lastelt;\n                        _siftup(array, 0, cmp);\n                    } else {\n                        returnitem = lastelt;\n                    }\n                    return returnitem;\n                };\n\n                /*\n                Pop and return the current smallest value, and add the new item.\n                \n                This is more efficient than heappop() followed by heappush(), and can be \n                more appropriate when using a fixed size heap. Note that the value\n                returned may be larger than item! That constrains reasonable use of\n                this routine unless written as part of a conditional replacement:\n                    if item > array[0]\n                      item = heapreplace(array, item)\n                */\n\n\n                heapreplace = function (array, item, cmp) {\n                    var returnitem;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    returnitem = array[0];\n                    array[0] = item;\n                    _siftup(array, 0, cmp);\n                    return returnitem;\n                };\n\n                /*\n                Fast version of a heappush followed by a heappop.\n                */\n\n\n                heappushpop = function (array, item, cmp) {\n                    var _ref;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (array.length && cmp(array[0], item) < 0) {\n                        _ref = [array[0], item], item = _ref[0], array[0] = _ref[1];\n                        _siftup(array, 0, cmp);\n                    }\n                    return item;\n                };\n\n                /*\n                Transform list into a heap, in-place, in O(array.length) time.\n                */\n\n\n                heapify = function (array, cmp) {\n                    var i, _i, _j, _len, _ref, _ref1, _results, _results1;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    _ref1 = (function () {\n                        _results1 = [];\n                        for (var _j = 0, _ref = floor(array.length / 2); 0 <= _ref ? _j < _ref : _j > _ref; 0 <= _ref ? _j++ : _j--) { _results1.push(_j); }\n                        return _results1;\n                    }).apply(this).reverse();\n                    _results = [];\n                    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n                        i = _ref1[_i];\n                        _results.push(_siftup(array, i, cmp));\n                    }\n                    return _results;\n                };\n\n                /*\n                Update the position of the given item in the heap.\n                This function should be called every time the item is being modified.\n                */\n\n\n                updateItem = function (array, item, cmp) {\n                    var pos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    pos = array.indexOf(item);\n                    if (pos === -1) {\n                        return;\n                    }\n                    _siftdown(array, 0, pos, cmp);\n                    return _siftup(array, pos, cmp);\n                };\n\n                /*\n                Find the n largest elements in a dataset.\n                */\n\n\n                nlargest = function (array, n, cmp) {\n                    var elem, result, _i, _len, _ref;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    result = array.slice(0, n);\n                    if (!result.length) {\n                        return result;\n                    }\n                    heapify(result, cmp);\n                    _ref = array.slice(n);\n                    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                        elem = _ref[_i];\n                        heappushpop(result, elem, cmp);\n                    }\n                    return result.sort(cmp).reverse();\n                };\n\n                /*\n                Find the n smallest elements in a dataset.\n                */\n\n\n                nsmallest = function (array, n, cmp) {\n                    var elem, i, los, result, _i, _j, _len, _ref, _ref1, _results;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (n * 10 <= array.length) {\n                        result = array.slice(0, n).sort(cmp);\n                        if (!result.length) {\n                            return result;\n                        }\n                        los = result[result.length - 1];\n                        _ref = array.slice(n);\n                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                            elem = _ref[_i];\n                            if (cmp(elem, los) < 0) {\n                                insort(result, elem, 0, null, cmp);\n                                result.pop();\n                                los = result[result.length - 1];\n                            }\n                        }\n                        return result;\n                    }\n                    heapify(array, cmp);\n                    _results = [];\n                    for (i = _j = 0, _ref1 = min(n, array.length); 0 <= _ref1 ? _j < _ref1 : _j > _ref1; i = 0 <= _ref1 ? ++_j : --_j) {\n                        _results.push(heappop(array, cmp));\n                    }\n                    return _results;\n                };\n\n                _siftdown = function (array, startpos, pos, cmp) {\n                    var newitem, parent, parentpos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    newitem = array[pos];\n                    while (pos > startpos) {\n                        parentpos = (pos - 1) >> 1;\n                        parent = array[parentpos];\n                        if (cmp(newitem, parent) < 0) {\n                            array[pos] = parent;\n                            pos = parentpos;\n                            continue;\n                        }\n                        break;\n                    }\n                    return array[pos] = newitem;\n                };\n\n                _siftup = function (array, pos, cmp) {\n                    var childpos, endpos, newitem, rightpos, startpos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    endpos = array.length;\n                    startpos = pos;\n                    newitem = array[pos];\n                    childpos = 2 * pos + 1;\n                    while (childpos < endpos) {\n                        rightpos = childpos + 1;\n                        if (rightpos < endpos && !(cmp(array[childpos], array[rightpos]) < 0)) {\n                            childpos = rightpos;\n                        }\n                        array[pos] = array[childpos];\n                        pos = childpos;\n                        childpos = 2 * pos + 1;\n                    }\n                    array[pos] = newitem;\n                    return _siftdown(array, startpos, pos, cmp);\n                };\n\n                Heap = (function () {\n                    Heap.push = heappush;\n\n                    Heap.pop = heappop;\n\n                    Heap.replace = heapreplace;\n\n                    Heap.pushpop = heappushpop;\n\n                    Heap.heapify = heapify;\n\n                    Heap.nlargest = nlargest;\n\n                    Heap.nsmallest = nsmallest;\n\n                    function Heap(cmp) {\n                        this.cmp = cmp != null ? cmp : defaultCmp;\n                        this.nodes = [];\n                    }\n\n                    Heap.prototype.push = function (x) {\n                        return heappush(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.pop = function () {\n                        return heappop(this.nodes, this.cmp);\n                    };\n\n                    Heap.prototype.peek = function () {\n                        return this.nodes[0];\n                    };\n\n                    Heap.prototype.contains = function (x) {\n                        return this.nodes.indexOf(x) !== -1;\n                    };\n\n                    Heap.prototype.replace = function (x) {\n                        return heapreplace(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.pushpop = function (x) {\n                        return heappushpop(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.heapify = function () {\n                        return heapify(this.nodes, this.cmp);\n                    };\n\n                    Heap.prototype.updateItem = function (x) {\n                        return updateItem(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.clear = function () {\n                        return this.nodes = [];\n                    };\n\n                    Heap.prototype.empty = function () {\n                        return this.nodes.length === 0;\n                    };\n\n                    Heap.prototype.size = function () {\n                        return this.nodes.length;\n                    };\n\n                    Heap.prototype.clone = function () {\n                        var heap;\n                        heap = new Heap();\n                        heap.nodes = this.nodes.slice(0);\n                        return heap;\n                    };\n\n                    Heap.prototype.toArray = function () {\n                        return this.nodes.slice(0);\n                    };\n\n                    Heap.prototype.insert = Heap.prototype.push;\n\n                    Heap.prototype.remove = Heap.prototype.pop;\n\n                    Heap.prototype.top = Heap.prototype.peek;\n\n                    Heap.prototype.front = Heap.prototype.peek;\n\n                    Heap.prototype.has = Heap.prototype.contains;\n\n                    Heap.prototype.copy = Heap.prototype.clone;\n\n                    return Heap;\n\n                })();\n\n                if (typeof module !== \"undefined\" && module !== null ? module.exports : void 0) {\n                    module.exports = Heap;\n                } else {\n                    window.Heap = Heap;\n                }\n\n            }).call(this);\n\n        }, {}], 3: [function (require, module, exports) {\n            module.exports = {\n                'Heap': require('heap'),\n                'Node': require('./core/Node'),\n                'Grid': require('./core/Grid'),\n                'Util': require('./core/Util'),\n                'Heuristic': require('./core/Heuristic'),\n                'AStarFinder': require('./finders/AStarFinder'),\n                'BestFirstFinder': require('./finders/BestFirstFinder'),\n                'BreadthFirstFinder': require('./finders/BreadthFirstFinder'),\n                'DijkstraFinder': require('./finders/DijkstraFinder'),\n                'BiAStarFinder': require('./finders/BiAStarFinder'),\n                'BiBestFirstFinder': require('./finders/BiBestFirstFinder'),\n                'BiBreadthFirstFinder': require('./finders/BiBreadthFirstFinder'),\n                'BiDijkstraFinder': require('./finders/BiDijkstraFinder'),\n                'JumpPointFinder': require('./finders/JumpPointFinder'),\n                'IDAStarFinder': require('./finders/IDAStarFinder')\n            };\n\n        }, { \"./core/Grid\": 4, \"./core/Heuristic\": 5, \"./core/Node\": 6, \"./core/Util\": 7, \"./finders/AStarFinder\": 8, \"./finders/BestFirstFinder\": 9, \"./finders/BiAStarFinder\": 10, \"./finders/BiBestFirstFinder\": 11, \"./finders/BiBreadthFirstFinder\": 12, \"./finders/BiDijkstraFinder\": 13, \"./finders/BreadthFirstFinder\": 14, \"./finders/DijkstraFinder\": 15, \"./finders/IDAStarFinder\": 16, \"./finders/JumpPointFinder\": 17, \"heap\": 1 }], 4: [function (require, module, exports) {\n            var Node = require('./Node');\n\n            /**\n             * The Grid class, which serves as the encapsulation of the layout of the nodes.\n             * @constructor\n             * @param {number} width Number of columns of the grid.\n             * @param {number} height Number of rows of the grid.\n             * @param {Array.<Array.<(number|boolean)>>} [matrix] - A 0-1 matrix\n             *     representing the walkable status of the nodes(0 or false for walkable).\n             *     If the matrix is not supplied, all the nodes will be walkable.  */\n            function Grid(width, height, depth, matrix) {\n                /**\n                 * The number of columns of the grid.\n                 * @type number\n                 */\n                this.width = width;\n                /**\n                 * The number of rows of the grid.\n                 * @type number\n                 */\n                this.height = height;\n\n                this.depth = depth;\n\n\n                /**\n                 * A 2D array of nodes.\n                 */\n                this.nodes = this._buildNodes(width, height, depth, matrix);\n            }\n\n            /**\n             * Build and return the nodes.\n             * @private\n             * @param {number} width\n             * @param {number} height\n             * @param {Array.<Array.<number|boolean>>} [matrix] - A 0-1 matrix representing\n             *     the walkable status of the nodes.\n             * @see Grid\n             */\n            Grid.prototype._buildNodes = function (width, height, depth, matrix) {\n                var i, j, z,\n                    nodes = new Array(height),\n                    row;\n\n                for (i = 0; i < height; ++i) {\n                    nodes[i] = new Array(width);\n                    for (j = 0; j < width; ++j) {\n                        nodes[i][j] = new Array(depth);\n                        for (z = 0; z < depth; ++z) {\n                            nodes[i][j][z] = new Node(j, i, z);\n                        }\n                    }\n                }\n\n\n                if (matrix === undefined) {\n                    return nodes;\n                }\n\n                if (matrix.length !== height || matrix[0].length !== width) {\n                    throw new Error('Matrix size does not fit');\n                }\n\n                for (i = 0; i < height; ++i) {\n                    for (j = 0; j < width; ++j) {\n                        for (z = 0; z < depth; ++z) {\n                            nodes[i][j][z].walkable = matrix[i][j][z];\n                        }\n                    }\n                }\n\n                return nodes;\n            };\n\n\n            Grid.prototype.getNodeAt = function (x, y, z) {\n                return this.nodes[y][x][z];\n            };\n\n\n            /**\n             * Determine whether the node at the given position is walkable.\n             * (Also returns false if the position is outside the grid.)\n             * @param {number} x - The x coordinate of the node.\n             * @param {number} y - The y coordinate of the node.\n             * @param {number} z - The z coordinate of the node.\n             * @return {boolean} - The walkability of the node.\n             */\n\n            /*\n               public enum RoomExits\n               {\n                   Unknown = 4096,    \n                   Out = 2048,\n                   Enter = 1024,                       \n                   Up = 512,\n                   Down = 256,\n                   North = 128,\n                   NorthEast = 64,\n                   East = 32,\n                   SouthEast = 16,\n                   South = 8,\n                   SouthWest = 4,\n                   West = 2,\n                   NorthWest = 1,\n                   None = 0,\n                   //Directional = North | NorthEast | NorthWest | South | SouthEast | SouthWest | West | East,\n                   //All = Directional | Up | Down\n               }\n            */\n            Grid.prototype.isWalkableAt = function (x, y, z, d) {\n                return this.isInside(x, y, z) && (this.nodes[y][x][z].walkable & d) == d;\n            };\n\n\n            /**\n             * Determine whether the position is inside the grid.\n             * XXX: `grid.isInside(x, y, z)` is wierd to read.\n             * It should be `(x, y, z) is inside grid`, but I failed to find a better\n             * name for this method.\n             * @param {number} x\n             * @param {number} y\n             * @param {number} z\n             * @return {boolean}\n             */\n            Grid.prototype.isInside = function (x, y, z) {\n                return (x >= 0 && x < this.width) && (y >= 0 && y < this.height) && (z >= 0 && z < this.depth);\n            };\n\n\n            /**\n             * Set whether the node on the given position is walkable.\n             * NOTE: throws exception if the coordinate is not inside the grid.\n             * @param {number} x - The x coordinate of the node.\n             * @param {number} y - The y coordinate of the node.\n             * @param {number} z - The z coordinate of the node.\n             * @param {boolean} walkable - Whether the position is walkable.\n             */\n            Grid.prototype.setWalkableAt = function (x, y, z, walkable) {\n                this.nodes[y][x][z].walkable = walkable;\n            };\n\n\n            /**\n             * Get the neighbors of the given node.\n             *\n             *     offsets      diagonalOffsets:\n             *  +---+---+---+    +---+---+---+\n             *  |   | 0 |   |    | 0 |   | 1 |\n             *  +---+---+---+    +---+---+---+\n             *  | 3 |   | 1 |    |   |   |   |\n             *  +---+---+---+    +---+---+---+\n             *  |   | 2 |   |    | 3 |   | 2 |\n             *  +---+---+---+    +---+---+---+\n             *\n             *  When allowDiagonal is true, if offsets[i] is valid, then\n             *  diagonalOffsets[i] and\n             *  diagonalOffsets[(i + 1) % 4] is valid.\n             * @param {Node} node\n             * @param {boolean} allowDiagonal\n             * @param {boolean} dontCrossCorners\n             */\n            Grid.prototype.getNeighbors = function (node, allowDiagonal, dontCrossCorners) {\n                var x = node.x,\n                    y = node.y,\n                    z = node.z,\n                    neighbors = [],\n                    s0 = false, d0 = false,\n                    s1 = false, d1 = false,\n                    s2 = false, d2 = false,\n                    s3 = false, d3 = false,\n                    s4 = false,\n                    s5 = false,\n                    nodes = this.nodes;\n\n                // \u2191\n                if (this.isWalkableAt(x, y, z, 128) && this.isInside(x, y - 1, z, 8)) {\n                    neighbors.push(nodes[y - 1][x][z]);\n                    s0 = true;\n                }\n                // \u2192\n                if (this.isWalkableAt(x, y, z, 32) && this.isInside(x + 1, y, z, 2)) {\n                    neighbors.push(nodes[y][x + 1][z]);\n                    s1 = true;\n                }\n                // \u2193\n                if (this.isWalkableAt(x, y, z, 8) && this.isInside(x, y + 1, z, 128)) {\n                    neighbors.push(nodes[y + 1][x][z]);\n                    s2 = true;\n                }\n                // \u2190\n                if (this.isWalkableAt(x, y, z, 2) && this.isInside(x - 1, y, z, 32)) {\n                    neighbors.push(nodes[y][x - 1][z]);\n                    s3 = true;\n                }\n                //up\n                if (this.isWalkableAt(x, y, z, 512) && this.isInside(x, y, z + 1, 256)) {\n                    neighbors.push(nodes[y][x][z + 1]);\n                    s4 = true;\n                }\n                //down\n                if (this.isWalkableAt(x, y, z, 256) && this.isInside(x, y, z - 1, 512)) {\n                    neighbors.push(nodes[y][x][z - 1]);\n                    s5 = true;\n                }\n\n\n                if (!allowDiagonal) {\n                    return neighbors;\n                }\n\n                if (dontCrossCorners) {\n                    d0 = s3 && s0;\n                    d1 = s0 && s1;\n                    d2 = s1 && s2;\n                    d3 = s2 && s3;\n                } else {\n                    d0 = s3 || s0 || true;\n                    d1 = s0 || s1 || true;\n                    d2 = s1 || s2 || true;\n                    d3 = s2 || s3 || true;\n                }\n\n                // \u2196 nw\n                if (d0 && this.isWalkableAt(x, y, z, 1) && this.isInside(x - 1, y - 1, z, 16)) {\n                    neighbors.push(nodes[y - 1][x - 1][z]);\n                }\n                // \u2197 ne\n                if (d1 && this.isWalkableAt(x, y, z, 64) && this.isInside(x + 1, y - 1, z, 4)) {\n                    neighbors.push(nodes[y - 1][x + 1][z]);\n                }\n                // \u2198 se\n                if (d2 && this.isWalkableAt(x, y, z, 16) && this.isInside(x + 1, y + 1, z, 1)) {\n                    neighbors.push(nodes[y + 1][x + 1][z]);\n                }\n                // \u2199 sw\n                if (d3 && this.isWalkableAt(x, y, z, 4) && this.isInside(x - 1, y + 1, z, 64)) {\n                    neighbors.push(nodes[y + 1][x - 1][z]);\n                }\n\n                return neighbors;\n            };\n\n\n            /**\n             * Get a clone of this grid.\n             * @return {Grid} Cloned grid.\n             */\n            Grid.prototype.clone = function () {\n                var i, j,\n\n                    width = this.width,\n                    height = this.height,\n                    depth = this.depth,\n                    thisNodes = this.nodes,\n\n                    newGrid = new Grid(width, height, depth),\n                    newNodes = new Array(height),\n                    row;\n\n                for (i = 0; i < height; ++i) {\n                    newNodes[i] = new Array(width);\n                    for (j = 0; j < width; ++j) {\n                        newNodes[i][j] = new Array(depth);\n                        for (z = 0; z < depth; ++z) {\n                            newNodes[i][j][z] = new Node(j, i, z, thisNodes[i][j][z].walkable);\n                        }\n                    }\n                }\n\n                newGrid.nodes = newNodes;\n\n                return newGrid;\n            };\n\n            module.exports = Grid;\n\n        }, { \"./Node\": 6 }], 5: [function (require, module, exports) {\n            /**\n             * @namespace PF.Heuristic\n             * @description A collection of heuristic functions.\n             */\n            module.exports = {\n\n                /**\n                 * Manhattan distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} dx + dy\n                 */\n                manhattan: function (dx, dy, dz) {\n                    return dx + dy + dz;\n                },\n\n                /**\n                 * Euclidean distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} sqrt(dx * dx + dy * dy)\n                 */\n                euclidean: function (dx, dy, dz) {\n                    return Math.sqrt(dx * dx + dy * dy + dz * dz);\n                },\n\n                /**\n                 * Chebyshev distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} max(dx, dy)\n                 */\n                chebyshev: function (dx, dy, dz) {\n                    return Math.max(dx, dy, dz);\n                }\n\n            };\n\n        }, {}], 6: [function (require, module, exports) {\n            /**\n             * A node in grid. \n             * This class holds some basic information about a node and custom \n             * attributes may be added, depending on the algorithms' needs.\n             * @constructor\n             * @param {number} x - The x coordinate of the node on the grid.\n             * @param {number} y - The y coordinate of the node on the grid.\n             * @param {boolean} [walkable] - Whether this node is walkable.\n             */\n            function Node(x, y, z, walkable) {\n                /**\n                 * The x coordinate of the node on the grid.\n                 * @type number\n                 */\n                this.x = x;\n                /**\n                 * The y coordinate of the node on the grid.\n                 * @type number\n                 */\n                this.y = y;\n                /**\n                 * Whether this node can be walked through.\n                 * @type boolean\n                 */\n                this.walkable = (walkable === undefined ? true : walkable);\n\n                this.z = z;\n            }\n\n            module.exports = Node;\n\n        }, {}], 7: [function (require, module, exports) {\n            /**\n             * Backtrace according to the parent records and return the path.\n             * (including both start and end nodes)\n             * @param {Node} node End node\n             * @return {Array.<Array.<number>>} the path\n             */\n            function backtrace(node) {\n                var path = [[node.x, node.y, node.z]];\n                while (node.parent) {\n                    node = node.parent;\n                    path.push([node.x, node.y, node.z]);\n                }\n                return path.reverse();\n            }\n            exports.backtrace = backtrace;\n\n            /**\n             * Backtrace from start and end node, and return the path.\n             * (including both start and end nodes)\n             * @param {Node}\n             * @param {Node}\n             */\n            function biBacktrace(nodeA, nodeB) {\n                var pathA = backtrace(nodeA),\n                    pathB = backtrace(nodeB);\n                return pathA.concat(pathB.reverse());\n            }\n            exports.biBacktrace = biBacktrace;\n\n            /**\n             * Compute the length of the path.\n             * @param {Array.<Array.<number>>} path The path\n             * @return {number} The length of the path\n             */\n            function pathLength(path) {\n                var i, sum = 0, a, b, dx, dy, dz;\n                for (i = 1; i < path.length; ++i) {\n                    a = path[i - 1];\n                    b = path[i];\n                    dx = a[0] - b[0];\n                    dy = a[1] - b[1];\n                    dz = a[2] - b[2];\n                    sum += Math.sqrt(dx * dx + dy * dy + dz * dz);\n                }\n                return sum;\n            }\n            exports.pathLength = pathLength;\n\n\n            /**\n             * Given the start and end coordinates, return all the coordinates lying\n             * on the line formed by these coordinates, based on Bresenham's algorithm.\n             * http://en.wikipedia.org/wiki/Bresenham's_line_algorithm#Simplification\n             * https://www.geeksforgeeks.org/bresenhams-algorithm-for-3-d-line-drawing/\n             * @param {number} x1 Start x coordinate\n             * @param {number} y1 Start y coordinate\n             * @param {number} z1 Start z coordinate\n             * @param {number} x2 End x coordinate\n             * @param {number} y2 End y coordinate\n             * @param {number} z2 End z coordinate\n             * @return {Array.<Array.<number>>} The coordinates on the line\n             */\n            function getLine(x1, y1, z1, x2, y2, z2) {\n                let ListOfPoints = [];\n                ListOfPoints.push([x1, y1, z1]);\n                let dx = Math.abs(x2 - x1);\n                let dy = Math.abs(y2 - y1);\n                let dz = Math.abs(z2 - z1);\n                let xs;\n                let ys;\n                let zs;\n                if (x2 > x1) {\n                    xs = 1;\n                } else {\n                    xs = -1;\n                }\n                if (y2 > y1) {\n                    ys = 1;\n                } else {\n                    ys = -1;\n                }\n                if (z2 > z1) {\n                    zs = 1;\n                } else {\n                    zs = -1;\n                }\n\n                // Driving axis is X-axis\"\n                if (dx >= dy && dx >= dz) {\n                    let p1 = 2 * dy - dx;\n                    let p2 = 2 * dz - dx;\n                    while (x1 != x2) {\n                        x1 += xs;\n                        if (p1 >= 0) {\n                            y1 += ys;\n                            p1 -= 2 * dx;\n                        }\n                        if (p2 >= 0) {\n                            z1 += zs;\n                            p2 -= 2 * dx;\n                        }\n                        p1 += 2 * dy;\n                        p2 += 2 * dz;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n\n                    // Driving axis is Y-axis\"\n                } else if (dy >= dx && dy >= dz) {\n                    let p1 = 2 * dx - dy;\n                    let p2 = 2 * dz - dy;\n                    while (y1 != y2) {\n                        y1 += ys;\n                        if (p1 >= 0) {\n                            x1 += xs;\n                            p1 -= 2 * dy;\n                        }\n                        if (p2 >= 0) {\n                            z1 += zs;\n                            p2 -= 2 * dy;\n                        }\n                        p1 += 2 * dx;\n                        p2 += 2 * dz;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n\n                    // Driving axis is Z-axis\"\n                } else {\n                    let p1 = 2 * dy - dz;\n                    let p2 = 2 * dx - dz;\n                    while (z1 != z2) {\n                        z1 += zs;\n                        if (p1 >= 0) {\n                            y1 += ys;\n                            p1 -= 2 * dz;\n                        }\n                        if (p2 >= 0) {\n                            x1 += xs;\n                            p2 -= 2 * dz;\n                        }\n                        p1 += 2 * dy;\n                        p2 += 2 * dx;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n                }\n                return ListOfPoints;\n            }\n            exports.getLine = getLine;\n\n\n            /**\n             * Smoothen the give path.\n             * The original path will not be modified; a new path will be returned.\n             * @param {PF.Grid} grid\n             * @param {Array.<Array.<number>>} path The path\n             * @return {Array.<Array.<number>>} Smoothened path\n             */\n            function smoothenPath(grid, path) {\n                var len = path.length,\n                    x0 = path[0][0],        // path start x\n                    y0 = path[0][1],        // path start y\n                    z0 = path[0][2],\n                    x1 = path[len - 1][0],  // path end x\n                    y1 = path[len - 1][1],  // path end y\n                    z1 = path[len - 1][2],\n                    sx, sy, sz                 // current start coordinate\n                ex, ey, ez                // current end coordinate\n                lx, ly, lz                 // last valid end coordinate\n                newPath,\n                    i, j, coord, line, testCoord, blocked;\n\n                sx = x0;\n                sy = y0;\n                sz = z0\n                lx = path[1][0];\n                ly = path[1][1];\n                lz = path[1][2];\n                newPath = [[sx, sy, sz]];\n\n                for (i = 2; i < len; ++i) {\n                    coord = path[i];\n                    ex = coord[0];\n                    ey = coord[1];\n                    ez = coord[2];\n                    line = getLine(sx, sy, sz, ex, ey, ez);\n\n                    blocked = false;\n                    for (j = 1; j < line.length; ++j) {\n\n                        testCoord = line[j];\n\n                        if (!grid.isWalkableAt(testCoord[0], testCoord[1])) {\n                            blocked = true;\n                            newPath.push([lx, ly]);\n                            sx = lx;\n                            sy = ly;\n                            break;\n                        }\n                    }\n                    if (!blocked) {\n                        lx = ex;\n                        ly = ey;\n                    }\n                }\n                newPath.push([x1, y1]);\n\n                return newPath;\n            }\n            exports.smoothenPath = smoothenPath;\n\n        }, {}], 8: [function (require, module, exports) {\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * A* path-finder.\n             * based upon https://github.com/bgrins/javascript-astar\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths, \n             *     in order to speed up the search.\n             */\n            function AStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            AStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                //if start or end are not in grid return;\n                if (!grid.isInside(startX, startY, startZ) || !grid.isInside(endX, endY, endZ))\n                    return [];\n\n                var openList = new Heap(function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                });\n                var startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    heuristic = this.heuristic,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    weight = this.weight,\n                    abs = Math.abs, SQRT2 = Math.SQRT2,\n                    node, neighbors, neighbor, i, l, x, y, ng, z;\n\n\n\n                // set the `g` and `f` value of the start node to be 0\n                startNode.g = 0;\n                startNode.f = 0;\n\n                // push the start node into the open list\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the open list is not empty\n                while (!openList.empty()) {\n                    // pop the position of node which has the minimum `f` value.\n                    node = openList.pop();\n                    node.closed = true;\n\n                    // if reached the end position, construct the path and return it\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - endX), abs(y - endY), abs(z - endZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                openList.push(neighbor);\n                                neighbor.opened = true;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                openList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n                } // end while not open list empty\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = AStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }], 9: [function (require, module, exports) {\n            var AStarFinder = require('./AStarFinder');\n\n            /**\n             * Best-First-Search path-finder.\n             * @constructor\n             * @extends AStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function BestFirstFinder(opt) {\n                AStarFinder.call(this, opt);\n\n                var orig = this.heuristic;\n                this.heuristic = function (dx, dy, dz) {\n                    return orig(dx, dy, dz) * 1000000;\n                };\n            }\n\n            BestFirstFinder.prototype = new AStarFinder();\n            BestFirstFinder.prototype.constructor = BestFirstFinder;\n\n            module.exports = BestFirstFinder;\n\n        }, { \"./AStarFinder\": 8 }], 10: [function (require, module, exports) {\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * A* path-finder.\n             * based upon https://github.com/bgrins/javascript-astar\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths, \n             *     in order to speed up the search.\n             */\n            function BiAStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BiAStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var cmp = function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                },\n                    startOpenList = new Heap(cmp),\n                    endOpenList = new Heap(cmp),\n                    startNode = grid.getNodeAt(startX, startY),\n                    endNode = grid.getNodeAt(endX, endY),\n                    heuristic = this.heuristic,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    weight = this.weight,\n                    abs = Math.abs, SQRT2 = Math.SQRT2,\n                    node, neighbors, neighbor, i, l, x, y, ng, z,\n                    BY_START = 1, BY_END = 2;\n\n                // set the `g` and `f` value of the start node to be 0\n                // and push it into the start open list\n                startNode.g = 0;\n                startNode.f = 0;\n                startOpenList.push(startNode);\n                startNode.opened = BY_START;\n\n                // set the `g` and `f` value of the end node to be 0\n                // and push it into the open open list\n                endNode.g = 0;\n                endNode.f = 0;\n                endOpenList.push(endNode);\n                endNode.opened = BY_END;\n\n                // while both the open lists are not empty\n                while (!startOpenList.empty() && !endOpenList.empty()) {\n\n                    // pop the position of start node which has the minimum `f` value.\n                    node = startOpenList.pop();\n                    node.closed = true;\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened === BY_END) {\n                            return Util.biBacktrace(node, neighbor);\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - endX), abs(y - endY), abs(z - endZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                startOpenList.push(neighbor);\n                                neighbor.opened = BY_START;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                startOpenList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n\n\n                    // pop the position of end node which has the minimum `f` value.\n                    node = endOpenList.pop();\n                    node.closed = true;\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened === BY_START) {\n                            return Util.biBacktrace(neighbor, node);\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - startX), abs(y - startY), abs(z - startZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                endOpenList.push(neighbor);\n                                neighbor.opened = BY_END;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                endOpenList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n                } // end while not open list empty\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BiAStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }], 11: [function (require, module, exports) {\n            var BiAStarFinder = require('./BiAStarFinder');\n\n            /**\n             * Bi-direcitional Best-First-Search path-finder.\n             * @constructor\n             * @extends BiAStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function BiBestFirstFinder(opt) {\n                BiAStarFinder.call(this, opt);\n\n                var orig = this.heuristic;\n                this.heuristic = function (dx, dy, dz) {\n                    return orig(dx, dy, dz) * 1000000;\n                };\n            }\n\n            BiBestFirstFinder.prototype = new BiAStarFinder();\n            BiBestFirstFinder.prototype.constructor = BiBestFirstFinder;\n\n            module.exports = BiBestFirstFinder;\n\n        }, { \"./BiAStarFinder\": 10 }], 12: [function (require, module, exports) {\n            var Util = require('../core/Util');\n\n            /**\n             * Bi-directional Breadth-First-Search path finder.\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BiBreadthFirstFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n            }\n\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BiBreadthFirstFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    startOpenList = [], endOpenList = [],\n                    neighbors, neighbor, node,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    BY_START = 0, BY_END = 1,\n                    i, l;\n\n                // push the start and end nodes into the queues\n                startOpenList.push(startNode);\n                startNode.opened = true;\n                startNode.by = BY_START;\n\n                endOpenList.push(endNode);\n                endNode.opened = true;\n                endNode.by = BY_END;\n\n                // while both the queues are not empty\n                while (startOpenList.length && endOpenList.length) {\n\n                    // expand start open list\n\n                    node = startOpenList.shift();\n                    node.closed = true;\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened) {\n                            // if this node has been inspected by the reversed search,\n                            // then a path is found.\n                            if (neighbor.by === BY_END) {\n                                return Util.biBacktrace(node, neighbor);\n                            }\n                            continue;\n                        }\n                        startOpenList.push(neighbor);\n                        neighbor.parent = node;\n                        neighbor.opened = true;\n                        neighbor.by = BY_START;\n                    }\n\n                    // expand end open list\n\n                    node = endOpenList.shift();\n                    node.closed = true;\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened) {\n                            if (neighbor.by === BY_START) {\n                                return Util.biBacktrace(neighbor, node);\n                            }\n                            continue;\n                        }\n                        endOpenList.push(neighbor);\n                        neighbor.parent = node;\n                        neighbor.opened = true;\n                        neighbor.by = BY_END;\n                    }\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BiBreadthFirstFinder;\n\n        }, { \"../core/Util\": 7 }], 13: [function (require, module, exports) {\n            var BiAStarFinder = require('./BiAStarFinder');\n\n            /**\n             * Bi-directional Dijkstra path-finder.\n             * @constructor\n             * @extends BiAStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BiDijkstraFinder(opt) {\n                BiAStarFinder.call(this, opt);\n                this.heuristic = function (dx, dy, dz) {\n                    return 0;\n                };\n            }\n\n            BiDijkstraFinder.prototype = new BiAStarFinder();\n            BiDijkstraFinder.prototype.constructor = BiDijkstraFinder;\n\n            module.exports = BiDijkstraFinder;\n\n        }, { \"./BiAStarFinder\": 10 }], 14: [function (require, module, exports) {\n            var Util = require('../core/Util');\n\n            /**\n             * Breadth-First-Search path finder.\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BreadthFirstFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BreadthFirstFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var openList = [],\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    neighbors, neighbor, node, i, l;\n\n                // push the start pos into the queue\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the queue is not empty\n                while (openList.length) {\n                    // take the front node from the queue\n                    node = openList.shift();\n                    node.closed = true;\n\n                    // reached the end position\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        // skip this neighbor if it has been inspected before\n                        if (neighbor.closed || neighbor.opened) {\n                            continue;\n                        }\n\n                        openList.push(neighbor);\n                        neighbor.opened = true;\n                        neighbor.parent = node;\n                    }\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BreadthFirstFinder;\n\n        }, { \"../core/Util\": 7 }], 15: [function (require, module, exports) {\n            var AStarFinder = require('./AStarFinder');\n\n            /**\n             * Dijkstra path-finder.\n             * @constructor\n             * @extends AStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function DijkstraFinder(opt) {\n                AStarFinder.call(this, opt);\n                this.heuristic = function (dx, dy, dz) {\n                    return 0;\n                };\n            }\n\n            DijkstraFinder.prototype = new AStarFinder();\n            DijkstraFinder.prototype.constructor = DijkstraFinder;\n\n            module.exports = DijkstraFinder;\n\n        }, { \"./AStarFinder\": 8 }], 16: [function (require, module, exports) {\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n            var Node = require('../core/Node');\n\n            /**\n             * Iterative Deeping A Star (IDA*) path-finder.\n             *\n             * Recursion based on:\n             *   http://www.apl.jhu.edu/~hall/AI-Programming/IDA-Star.html\n             *\n             * Path retracing based on:\n             *  V. Nageshwara Rao, Vipin Kumar and K. Ramesh\n             *  \"A Parallel Implementation of Iterative-Deeping-A*\", January 1987.\n             *  ftp://ftp.cs.utexas.edu/.snapshot/hourly.1/pub/AI-Lab/tech-reports/UT-AI-TR-87-46.pdf\n             *\n             * @author Gerard Meier (www.gerardmeier.com)\n             *\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths,\n             *     in order to speed up the search.\n             * @param {object} opt.trackRecursion Whether to track recursion for statistical purposes.\n             * @param {object} opt.timeLimit Maximum execution time. Use <= 0 for infinite.\n             */\n\n            function IDAStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n                this.trackRecursion = opt.trackRecursion || false;\n                this.timeLimit = opt.timeLimit || Infinity; // Default: no time limit.\n            }\n\n            /**\n             * Find and return the the path. When an empty array is returned, either\n             * no path is possible, or the maximum execution time is reached.\n             *\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            IDAStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                // Used for statistics:\n                var nodesVisited = 0;\n\n                // Execution time limitation:\n                var startTime = new Date().getTime();\n\n                // Heuristic helper:\n                var h = function (a, b) {\n                    return this.heuristic(Math.abs(b.x - a.x), Math.abs(b.y - a.y), Math.abs(b.z - a.z));\n                }.bind(this);\n\n                // Step cost from a to b:\n                var cost = function (a, b) {\n                    return (a.x === b.x || a.y === b.y || a.z === b.z) ? 1 : Math.SQRT2;\n                };\n\n                /**\n                 * IDA* search implementation.\n                 *\n                 * @param {Node} The node currently expanding from.\n                 * @param {number} Cost to reach the given node.\n                 * @param {number} Maximum search depth (cut-off value).\n                 * @param {{Array.<[number, number]>}} The found route.\n                 * @param {number} Recursion depth.\n                 *\n                 * @return {Object} either a number with the new optimal cut-off depth,\n                 * or a valid node instance, in which case a path was found.\n                 */\n                var search = function (node, g, cutoff, route, depth) {\n                    nodesVisited++;\n\n                    // Enforce timelimit:\n                    if (this.timeLimit > 0 && new Date().getTime() - startTime > this.timeLimit * 1000) {\n                        // Enforced as \"path-not-found\".\n                        return Infinity;\n                    }\n\n                    var f = g + h(node, end) * this.weight;\n\n                    // We've searched too deep for this iteration.\n                    if (f > cutoff) {\n                        return f;\n                    }\n\n                    if (node == end) {\n                        route[depth] = [node.x, node.y, node.z];\n                        return node;\n                    }\n\n                    var min, t, k, neighbour;\n\n                    var neighbours = grid.getNeighbors(node, this.allowDiagonal, this.dontCrossCorners);\n\n                    // Sort the neighbours, gives nicer paths. But, this deviates\n                    // from the original algorithm - so I left it out.\n                    //neighbours.sort(function(a, b){\n                    //    return h(a, end) - h(b, end);\n                    //});\n\n                    for (k = 0, min = Infinity; neighbour = neighbours[k]; ++k) {\n\n                        if (this.trackRecursion) {\n                            // Retain a copy for visualisation. Due to recursion, this\n                            // node may be part of other paths too.\n                            neighbour.retainCount = neighbour.retainCount + 1 || 1;\n\n                            if (neighbour.tested !== true) {\n                                neighbour.tested = true;\n                            }\n                        }\n\n                        t = search(neighbour, g + cost(node, neighbour), cutoff, route, depth + 1);\n\n                        if (t instanceof Node) {\n                            route[depth] = [node.x, node.y, node.z];\n\n                            // For a typical A* linked list, this would work:\n                            // neighbour.parent = node;\n                            return t;\n                        }\n\n                        // Decrement count, then determine whether it's actually closed.\n                        if (this.trackRecursion && (--neighbour.retainCount) === 0) {\n                            neighbour.tested = false;\n                        }\n\n                        if (t < min) {\n                            min = t;\n                        }\n                    }\n\n                    return min;\n\n                }.bind(this);\n\n                // Node instance lookups:\n                var start = grid.getNodeAt(startX, startY, startZ);\n                var end = grid.getNodeAt(endX, endY, endZ);\n\n                // Initial search depth, given the typical heuristic contraints,\n                // there should be no cheaper route possible.\n                var cutOff = h(start, end);\n\n                var j, route, t;\n\n                // With an overflow protection.\n                for (j = 0; true; ++j) {\n                    //console.log(\"Iteration: \" + j + \", search cut-off value: \" + cutOff + \", nodes visited thus far: \" + nodesVisited + \".\");\n\n                    route = [];\n\n                    // Search till cut-off depth:\n                    t = search(start, 0, cutOff, route, 0);\n\n                    // Route not possible, or not found in time limit.\n                    if (t === Infinity) {\n                        return [];\n                    }\n\n                    // If t is a node, it's also the end node. Route is now\n                    // populated with a valid path to the end node.\n                    if (t instanceof Node) {\n                        //console.log(\"Finished at iteration: \" + j + \", search cut-off value: \" + cutOff + \", nodes visited: \" + nodesVisited + \".\");\n                        return route;\n                    }\n\n                    // Try again, this time with a deeper cut-off. The t score\n                    // is the closest we got to the end node.\n                    cutOff = t;\n                }\n\n                // This _should_ never to be reached.\n                return [];\n            };\n\n            module.exports = IDAStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Node\": 6, \"../core/Util\": 7 }], 17: [function (require, module, exports) {\n            /**\n             * @author aniero / https://github.com/aniero\n             */\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * Path finder using the Jump Point Search algorithm\n             * @param {object} opt\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function JumpPointFinder(opt) {\n                opt = opt || {};\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.trackJumpRecursion = opt.trackJumpRecursion || false;\n            }\n\n            /**\n             * Find and return the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            JumpPointFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var openList = this.openList = new Heap(function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                }),\n                    startNode = this.startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = this.endNode = grid.getNodeAt(endX, endY, endZ), node;\n\n                this.grid = grid;\n\n\n                // set the `g` and `f` value of the start node to be 0\n                startNode.g = 0;\n                startNode.f = 0;\n\n                // push the start node into the open list\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the open list is not empty\n                while (!openList.empty()) {\n                    // pop the position of node which has the minimum `f` value.\n                    node = openList.pop();\n                    node.closed = true;\n\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    this._identifySuccessors(node);\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            /**\n             * Identify successors for the given node. Runs a jump point search in the\n             * direction of each available neighbor, adding any points found to the open\n             * list.\n             * @protected\n             */\n            JumpPointFinder.prototype._identifySuccessors = function (node) {\n                var grid = this.grid,\n                    heuristic = this.heuristic,\n                    openList = this.openList,\n                    endX = this.endNode.x,\n                    endY = this.endNode.y,\n                    endZ = this.endNode.z\n                neighbors, neighbor,\n                    jumpPoint, i, l,\n                    x = node.x, y = node.y, z = node.z\n                jx, jy, dx, dy, d, ng, jumpNode, dz, jz\n                abs = Math.abs, max = Math.max;\n\n                neighbors = this._findNeighbors(node);\n                for (i = 0, l = neighbors.length; i < l; ++i) {\n                    neighbor = neighbors[i];\n                    jumpPoint = this._jump(neighbor[0], neighbor[1], x, y, z);\n                    if (jumpPoint) {\n\n                        jx = jumpPoint[0];\n                        jy = jumpPoint[1];\n                        jz = jumpPoint[2]\n                        jumpNode = grid.getNodeAt(jx, jy, jz);\n\n                        if (jumpNode.closed) {\n                            continue;\n                        }\n\n                        // include distance, as parent may not be immediately adjacent:\n                        d = Heuristic.euclidean(abs(jx - x), abs(jy - y), abs(jz - z));\n                        ng = node.g + d; // next `g` value\n\n                        if (!jumpNode.opened || ng < jumpNode.g) {\n                            jumpNode.g = ng;\n                            jumpNode.h = jumpNode.h || heuristic(abs(jx - endX), abs(jy - endY), abs(jz - endZ));\n                            jumpNode.f = jumpNode.g + jumpNode.h;\n                            jumpNode.parent = node;\n\n                            if (!jumpNode.opened) {\n                                openList.push(jumpNode);\n                                jumpNode.opened = true;\n                            } else {\n                                openList.updateItem(jumpNode);\n                            }\n                        }\n                    }\n                }\n            };\n\n            /**\n             * Search recursively in the direction (parent -> child), stopping only when a\n             * jump point is found.\n             * @protected\n             * @return {Array.<[number, number]>} The x, y coordinate of the jump point\n             *     found, or null if not found\n             */\n            JumpPointFinder.prototype._jump = function (x, y, z, px, py, pz) {\n                var grid = this.grid,\n                    dx = x - px, dy = y - py, jx, jy;\n                dz = z - pz, jz;\n\n                if (!grid.isWalkableAt(x, y, z)) {\n                    return null;\n                }\n\n                if (this.trackJumpRecursion === true) {\n                    grid.getNodeAt(x, y, z).tested = true;\n                }\n\n                if (grid.getNodeAt(x, y, z) === this.endNode) {\n                    return [x, y, z];\n                }\n\n                // check for forced neighbors\n                // along the diagonal\n                if (dx !== 0 && dy !== 0) {\n                    if ((grid.isWalkableAt(x - dx, y + dy, z) && !grid.isWalkableAt(x - dx, y, z)) ||\n                        (grid.isWalkableAt(x + dx, y - dy, z) && !grid.isWalkableAt(x, y - dy, z))) {\n                        return [x, y, z];\n                    }\n                }\n                // horizontally/vertically\n                else {\n                    if (dx !== 0) { // moving along x\n                        if ((grid.isWalkableAt(x + dx, y + 1, z) && !grid.isWalkableAt(x, y + 1, z)) ||\n                            (grid.isWalkableAt(x + dx, y - 1, z) && !grid.isWalkableAt(x, y - 1, z))) {\n                            return [x, y, z];\n                        }\n                    }\n                    else {\n                        if ((grid.isWalkableAt(x + 1, y + dy, z) && !grid.isWalkableAt(x + 1, y, z)) ||\n                            (grid.isWalkableAt(x - 1, y + dy, z) && !grid.isWalkableAt(x - 1, y, z))) {\n                            return [x, y, z];\n                        }\n                    }\n                }\n                if (dz !== 0) {\n                    jz = his._jump(x, y, z + dz, x, y, z);\n                    if (jz) return [x, y, z];\n                }\n                // when moving diagonally, must check for vertical/horizontal jump points\n                if (dx !== 0 && dy !== 0) {\n                    jx = this._jump(x + dx, y, z, x, y, z);\n                    jy = this._jump(x, y + dy, z, x, y, z);\n                    if (jx || jy) {\n                        return [x, y, z];\n                    }\n                }\n\n                // moving diagonally, must make sure one of the vertical/horizontal\n                // neighbors is open to allow the path\n                if (grid.isWalkableAt(x + dx, y, z) || grid.isWalkableAt(x, y + dy, z)) {\n                    return this._jump(x + dx, y + dy, z, x, y, z);\n                } else {\n                    return null;\n                }\n            };\n\n            /**\n             * Find the neighbors for the given node. If the node has a parent,\n             * prune the neighbors based on the jump point search algorithm, otherwise\n             * return all available neighbors.\n             * @return {Array.<[number, number]>} The neighbors found.\n             */\n            JumpPointFinder.prototype._findNeighbors = function (node) {\n                var parent = node.parent,\n                    x = node.x, y = node.y, z = node.z,\n                    grid = this.grid,\n                    px, py, nx, ny, dx, dy, pz, nz, dz\n                neighbors = [], neighborNodes, neighborNode, i, l;\n\n                // directed pruning: can ignore most neighbors, unless forced.\n\n                if (parent) {\n                    px = parent.x;\n                    py = parent.y;\n                    pz = parent.z;\n                    // get the normalized direction of travel\n                    dx = (x - px) / Math.max(Math.abs(x - px), 1);\n                    dy = (y - py) / Math.max(Math.abs(y - py), 1);\n                    dz = (z - pz) / Math.max(Math.abs(z - pz), 1);\n\n                    //search up/down\n                    if (dz !== 0) {\n                        if (grid.isWalkableAt(x, y, z + dz)) {\n                            if (grid.isWalkableAt(x, y, z + dz)) {\n                                neighbors.push([x + dx, y + dy, z + dz]);\n                            }\n                            if (!grid.isWalkableAt(x, y, z + 1)) {\n                                neighbors.push([x + dx, y + dy, z + 1]);\n                            }\n                            if (!grid.isWalkableAt(x, y, z - 1)) {\n                                neighbors.push([x + dx, y + dy, z - 1]);\n                            }\n                        }\n                    }\n                    // search diagonally\n                    else if (dx !== 0 && dy !== 0) {\n                        if (grid.isWalkableAt(x, y + dy, z)) {\n                            neighbors.push([x, y + dy, z]);\n                        }\n                        if (grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y, z]);\n                        }\n                        if (grid.isWalkableAt(x, y + dy, z) || grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y + dy, z]);\n                        }\n                        if (!grid.isWalkableAt(x - dx, y, z) && grid.isWalkableAt(x, y + dy, z)) {\n                            neighbors.push([x - dx, y + dy, z]);\n                        }\n                        if (!grid.isWalkableAt(x, y - dy, z) && grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y - dy, z]);\n                        }\n                    }\n                    // search horizontally/vertically\n                    else {\n                        if (dx === 0) {\n                            if (grid.isWalkableAt(x, y + dy, z)) {\n                                if (grid.isWalkableAt(x, y + dy, z)) {\n                                    neighbors.push([x, y + dy, z]);\n                                }\n                                if (!grid.isWalkableAt(x + 1, y, z)) {\n                                    neighbors.push([x + 1, y + dy, z]);\n                                }\n                                if (!grid.isWalkableAt(x - 1, y, z)) {\n                                    neighbors.push([x - 1, y + dy, z]);\n                                }\n                            }\n                        }\n                        else {\n                            if (grid.isWalkableAt(x + dx, y, z)) {\n                                if (grid.isWalkableAt(x + dx, y, z)) {\n                                    neighbors.push([x + dx, y, z]);\n                                }\n                                if (!grid.isWalkableAt(x, y + 1, z)) {\n                                    neighbors.push([x + dx, y + 1, z]);\n                                }\n                                if (!grid.isWalkableAt(x, y - 1, z)) {\n                                    neighbors.push([x + dx, y - 1, z]);\n                                }\n                            }\n                        }\n                    }\n                }\n                // return all neighbors\n                else {\n                    neighborNodes = grid.getNeighbors(node, true);\n                    for (i = 0, l = neighborNodes.length; i < l; ++i) {\n                        neighborNode = neighborNodes[i];\n                        neighbors.push([neighborNode.x, neighborNode.y, neighborNode.z]);\n                    }\n                }\n\n                return neighbors;\n            };\n\n            module.exports = JumpPointFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }]\n    }, {}, [3])(3);\n});", "/**\r\n * A custom event emitter that will work in browsers or nodejs\r\n * Contains naming conventions from all standard formats\r\n */\r\nexport class EventEmitter {\r\n    #events = {};\r\n\r\n    public bind(type: string, listener: Function, caller?) {\r\n        if (!Array.isArray(this.#events[type]) || typeof this.#events[type] === 'undefined')\r\n            this.#events[type] = [];\r\n        this.#events[type].push({ listener: listener, caller: caller });\r\n    }\r\n\r\n    public on(type: string, listener: Function, caller?) {\r\n        this.bind(type, listener, caller);\r\n    }\r\n\r\n    public addEventListener(type: string, listener: Function, caller?) {\r\n        this.bind(type, listener, caller);\r\n    }\r\n\r\n    public fire(type, args?, caller?) {\r\n        if (!type || typeof type !== 'string')\r\n            throw new Error('Event missing.');\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        if (!args || args === null || typeof args === 'undefined')\r\n            args = [];\r\n        else if (!Array.isArray(args))\r\n            args = [args];\r\n\r\n        caller = caller || this;\r\n        var events = this.#events[type];\r\n        for (var i = 0, len = events.length; i < len; i++) {\r\n            events[i].listener.apply(events[i].caller || caller, args);\r\n        }\r\n    }\r\n\r\n    public emit(type, ...args) {\r\n        this.fire(type, args);\r\n    }\r\n\r\n    public dispatchEvent(type: string, args?, caller?) {\r\n        this.fire(type, args, caller);\r\n    }\r\n\r\n    public unbind(type, listener) {\r\n        if (!type || !listener) return;\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        const events = this.#events[type];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            if (events[i].listener === listener) {\r\n                events.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public remove(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public off(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeListener(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeAllListeners(type?) {\r\n        if (!type) {\r\n            this.#events = [];\r\n            return;\r\n        }\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        delete this.#events[type];\r\n    }\r\n\r\n    public removeListenersFromCaller(caller, type?) {\r\n        if (!type) {\r\n            Object.keys(this.#events).forEach(key => {\r\n                const events = this.#events[key];\r\n                for (let i = events.length - 1; i >= 0; i--) {\r\n                    if (events[i].caller === caller) {\r\n                        events.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            return;\r\n        }\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        const events = this.#events[type];\r\n        for (let i = 0, len = events.length; i < len; i++) {\r\n            if (events[i].caller === caller) {\r\n                events.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public listeners(type?) {\r\n        if (!type) return this.#events;\r\n        return this.#events[type] || [];\r\n    }\r\n}", "/**\n * @file Core functions and helpers\n *\n * @author William\n */\n//spell-checker:ignore Eisu, Junja, Hanja, Nonconvert, Modechange, printscreen, jisho, Masshou, Touroku, loya, roya\n//spell-checker:ignore Wsctrl, Cusel, Enlw, Backtab, Crsel, Exsel, Ereof rtrim ltrim Dropdown DBLUNDERLINE noflash\ndeclare global {\n    interface String {\n        trimLeft(): string;\n        trimRight(): string;\n        rtrim(): string;\n        addSlashes(): string;\n    }\n\n    interface Uint8Array {\n        charAt;\n        charCodeAt;\n    }\n\n    interface Object {\n        toType;\n    }\n}\n\n/**\n * Copyright (c) Mozilla Foundation http://www.mozilla.org/\n * This code is available under the terms of the MIT License\n */\nif (!Array.prototype.filter) {\n    Array.prototype.filter = function (fun /*, thisp*/) {\n        var len = this.length >>> 0;\n        if (typeof fun != 'function') {\n            throw new TypeError();\n        } ``\n\n        var res = [];\n        var thisp = arguments[1];\n        for (var i = 0; i < len; i++) {\n            if (i in this) {\n                var val = this[i]; // in case fun mutates this\n                if (fun.call(thisp, val, i, this)) {\n                    res.push(val);\n                }\n            }\n        }\n\n        return res;\n    };\n}\n\nexport function SortArrayByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    return 0;\n}\n\nexport function SortMapByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    if (a.index < b.index)\n        return -1;\n    if (a.index > b.index)\n        return 1;\n    return 0;\n}\n\nexport function SortItemArrayByPriority(list) {\n    const map = list.map((el, i) => {\n        return { index: i, priority: el.priority };\n    });\n    map.sort(SortMapByPriority);\n    return map.map((el) => {\n        return list[el.index];\n    });\n}\n\nexport function FilterArrayByKeyValue(array, k, v) {\n    const res = [];\n    if (!array || array.length === 0) return res;\n    const al = array.length;\n    for (let i = 0; i < al; i++) {\n        if (array[i]['enabled'] && array[i][k] === v)\n            res.push(array[i]);\n    }\n    if (res.length <= 1) return res;\n    return res.sort(SortArrayByPriority);\n}\n\nconst _edCache = document.createElement('div');\n\nexport function htmlEncode2(value) {\n    _edCache.textContent = value.replace(/ /g, '\\u00A0');\n    return _edCache.innerHTML;\n}\n\nexport function htmlDecode2(value) {\n    _edCache.innerHTML = value;\n    return _edCache.textContent.replace(/\\u00A0/g, ' ');\n}\n\nexport function htmlEncode(value) {\n    _edCache.textContent = value;\n    return _edCache.innerHTML;\n}\n\nexport function htmlDecode(value) {\n    _edCache.innerHTML = value;\n    return _edCache.textContent;\n}\n\nexport function htmlEntities(str) {\n    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\n\nexport function stripHTML(html) {\n    _edCache.innerHTML = html;\n    return _edCache.textContent || _edCache.innerText || '';\n}\n\nexport function stripParentheses(str) {\n    return str.replace(/(^\\()|(\\)$)/g, '');\n}\n\nexport function stripQuotes(str) {\n    str = str.replace(/^\"(.+(?=\"$))?\"$/, '$1');\n    str = str.replace(/^'(.+(?='$))?'$/, '$1');\n    return str;\n}\n\nexport function offset(el) {\n    const box = el.getBoundingClientRect();\n    const docElem = document.documentElement;\n    return {\n        top: box.top + window.pageYOffset - docElem.clientTop,\n        left: box.left + window.pageXOffset - docElem.clientLeft\n    };\n}\n\nexport class StringBuffer {\n    public buffer: string[];\n    //public rawbuffer: string[];\n    public length: number = 0;\n    constructor(str?: string) {\n        if (typeof str == 'string' && str.length > 0)\n            this.buffer = [str];\n        else\n            this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n    }\n\n    public prepend(string) {\n        this.buffer.unshift(string);\n        //this.rawbuffer.unshift(string.charCodeAt(0));\n        this.length += string.length;\n        return this;\n    }\n\n    public append(string) {\n        this.buffer.push(string);\n        this.length += string.length;\n        //this.rawbuffer.push(string.charCodeAt(0));\n        return this;\n    }\n\n    public push(string) {\n        if (typeof string === 'number')\n            this.appendCode(string);\n        else\n            this.append(string);\n    }\n\n    public appendCode(b) {\n        this.buffer.push(String.fromCharCode(b));\n        //this.rawbuffer.push(b);\n        this.length++;\n        return this;\n    }\n\n    public toString() {\n        return this.buffer.join('');\n    }\n\n    public clear(str?) {\n        this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n        if (str && typeof str != 'undefined' && str.length) {\n            this.buffer.push(str);\n            this.length = str.length;\n        }\n        return this;\n    }\n\n    public concat(arr) {\n        this.buffer = this.buffer.concat(arr);\n        //this.rawbuffer.push(arr.charCodeAt(0));\n    }\n\n}\n\nexport function CharAllowedInURL(chr, proto) {\n    if (chr.length > 1)\n        return false;\n    if (\n        chr === '-' ||\n        chr === '_' ||\n        chr === '.' ||\n        chr === '~' ||\n        chr === '!' ||\n        chr === '*' ||\n        chr === '\\'' ||\n        chr === ';' ||\n        chr === ':' ||\n        chr === '@' ||\n        chr === '&' ||\n        chr === '=' ||\n        chr === '+' ||\n        chr === '$' ||\n        chr === ',' ||\n        chr === '/' ||\n        chr === '\\\\' ||\n        chr === '?' ||\n        chr === '%' ||\n        chr === '#' ||\n        chr === '[' ||\n        chr === ']' ||\n        chr === '(' ||\n        chr === ')'\n    )\n        return !proto;\n    const i = chr.charCodeAt(0);\n    if (i > 64 && i < 91)\n        return true;\n    if (i > 96 && i < 123)\n        return true;\n    if (i > 47 && i < 58)\n        return true;\n    if (i >= 160 && i <= 55295)\n        return true;\n    if (i >= 57344 && i <= 64975)\n        return true;\n    if (i >= 65008 && i <= 65533)\n        return true;\n    if (i >= 65536 && i <= 131069)\n        return true;\n    if (i >= 131072 && i <= 196605)\n        return true;\n    if (i >= 196608 && i <= 262141)\n        return true;\n    if (i >= 262144 && i <= 327677)\n        return true;\n    if (i >= 327680 && i <= 393213)\n        return true;\n    if (i >= 393216 && i <= 458749)\n        return true;\n    if (i >= 458752 && i <= 524285)\n        return true;\n    if (i >= 524288 && i <= 589821)\n        return true;\n    if (i >= 589824 && i <= 655357)\n        return true;\n    if (i >= 655360 && i <= 720893)\n        return true;\n    if (i >= 720896 && i <= 786429)\n        return true;\n    if (i >= 786432 && i <= 851965)\n        return true;\n    if (i >= 851968 && i <= 917501)\n        return true;\n    if (i >= 921600 && i <= 983037)\n        return true;\n    if (i >= 983040 && i <= 1048573)\n        return true;\n    if (i >= 1048576 && i <= 1114109)\n        return true;\n    return false;\n}\n\nexport let keyCodeToChar = {\n    3: 'Cancel',\n    6: 'Help',\n    8: 'Backspace',\n    9: 'Tab',\n    19: 'Pause/Break',\n    20: 'Caps Lock',\n    21: 'Kana',\n    22: 'Eisu',\n    23: 'Junja',\n    24: 'Final',\n    25: 'Hanja',\n    27: 'Esc',\n    28: 'Convert',\n    29: 'Nonconvert',\n    30: 'Accept',\n    31: 'Modechange',\n    32: 'Space',\n    33: 'Page Up',\n    34: 'Page Down',\n    35: 'End',\n    36: 'Home',\n    37: 'Left',\n    38: 'Up',\n    39: 'Right',\n    40: 'Down',\n    41: 'Select',\n    42: 'Print',\n    43: 'Execute',\n    44: 'Printscreen',\n    45: 'Insert',\n    46: 'Delete',\n    48: '0',\n    49: '1',\n    50: '2',\n    51: '3',\n    52: '4',\n    53: '5',\n    54: '6',\n    55: '7',\n    56: '8',\n    57: '9',\n    58: 'Colon',\n    59: 'Semicolon',\n    60: 'Less Than',\n    61: 'Equals2',\n    62: 'Greater Than',\n    63: 'Question Mark',\n    65: 'A',\n    66: 'B',\n    67: 'C',\n    68: 'D',\n    69: 'E',\n    70: 'F',\n    71: 'G',\n    72: 'H',\n    73: 'I',\n    74: 'J',\n    75: 'K',\n    76: 'L',\n    77: 'M',\n    78: 'N',\n    79: 'O',\n    80: 'P',\n    81: 'Q',\n    82: 'R',\n    83: 'S',\n    84: 'T',\n    85: 'U',\n    86: 'V',\n    87: 'W',\n    88: 'X',\n    89: 'Y',\n    90: 'Z',\n    93: 'Context Menu',\n    95: 'Sleep',\n    96: 'Numpad 0',\n    97: 'Numpad 1',\n    98: 'Numpad 2',\n    99: 'Numpad 3',\n    100: 'Numpad 4',\n    101: 'Numpad 5',\n    102: 'Numpad 6',\n    103: 'Numpad 7',\n    104: 'Numpad 8',\n    105: 'Numpad 9',\n    106: 'Numpad *',\n    107: 'Numpad +',\n    109: 'Numpad -',\n    110: 'Numpad .',\n    111: 'Numpad /',\n    112: 'F1',\n    113: 'F2',\n    114: 'F3',\n    115: 'F4',\n    116: 'F5',\n    117: 'F6',\n    118: 'F7',\n    119: 'F8',\n    120: 'F9',\n    121: 'F10',\n    122: 'F11',\n    123: 'F12',\n    124: 'F13',\n    125: 'F14',\n    126: 'F15',\n    127: 'F16',\n    128: 'F17',\n    129: 'F18',\n    130: 'F19',\n    131: 'F20',\n    132: 'F21',\n    133: 'F22',\n    134: 'F23',\n    135: 'F24',\n    144: 'Num Lock',\n    145: 'Scroll Lock',\n    146: 'Win Oem Fj Jisho',\n    147: 'Win Oem Fj Masshou',\n    148: 'Win Oem Fj Touroku',\n    149: 'Win Oem Fj Loya',\n    150: 'Win Oem Fj Roya',\n    160: 'Circumflex',\n    161: 'Exclamation',\n    162: 'Double Quote',\n    163: 'Hash',\n    164: 'Dollar',\n    165: 'Percent',\n    166: 'Ampersand',\n    167: 'Underscore',\n    168: 'Open Paren',\n    169: 'Close Paren',\n    170: 'Asterisk',\n    171: 'Plus',\n    172: 'Pipe',\n    173: 'Hyphen Minus',\n    174: 'Open Curly Bracket',\n    175: 'Close Curly Bracket',\n    176: 'Tilde',\n    181: 'Volume Mute',\n    182: 'Volume Down',\n    183: 'Volume Up',\n    186: ';',\n    187: 'Equals',\n    188: ',',\n    189: 'Minus',\n    190: '.',\n    191: '/',\n    192: '`',\n    219: '[',\n    220: '\\\\',\n    221: ']',\n    222: '\\'',\n    227: 'Win Ico Help',\n    228: 'Win Ico 00',\n    230: 'Win Ico Clear',\n    233: 'Win Oem Reset',\n    234: 'Win Oem Jump',\n    235: 'Win Oem Pa1',\n    236: 'Win Oem Pa2',\n    237: 'Win Oem Pa3',\n    238: 'Win Oem Wsctrl',\n    239: 'Win Oem Cusel',\n    240: 'Win Oem Attn',\n    241: 'Win Oem Finish',\n    242: 'Win Oem Copy',\n    243: 'Win Oem Auto',\n    244: 'Win Oem Enlw',\n    245: 'Win Oem Backtab',\n    246: 'Attn',\n    247: 'Crsel',\n    248: 'Exsel',\n    249: 'Ereof',\n    250: 'Play',\n    251: 'Zoom',\n    253: 'Pa1',\n    254: 'Win Oem Clear'\n};\n\nexport let keyCharToCode = {\n    Cancel: 3,\n    Help: 6,\n    Backspace: 8,\n    Tab: 9,\n    'Pause/Break': 19,\n    'Caps Lock': 20,\n    Esc: 27,\n    Space: 32,\n    'Page Up': 33,\n    'Page Down': 34,\n    End: 35,\n    Home: 36,\n    Left: 37,\n    Up: 38,\n    Right: 39,\n    Down: 40,\n    Insert: 45,\n    Delete: 46,\n    0: 48,\n    1: 49,\n    2: 50,\n    3: 51,\n    4: 52,\n    5: 53,\n    6: 54,\n    7: 55,\n    8: 56,\n    9: 57,\n    A: 65,\n    B: 66,\n    C: 67,\n    D: 68,\n    E: 69,\n    F: 70,\n    G: 71,\n    H: 72,\n    I: 73,\n    J: 74,\n    K: 75,\n    L: 76,\n    M: 77,\n    N: 78,\n    O: 79,\n    P: 80,\n    Q: 81,\n    R: 82,\n    S: 83,\n    T: 84,\n    U: 85,\n    V: 86,\n    W: 87,\n    X: 88,\n    Y: 89,\n    Z: 90,\n    'Numpad 0': 96,\n    'Numpad 1': 97,\n    'Numpad 2': 98,\n    'Numpad 3': 99,\n    'Numpad 4': 100,\n    'Numpad 5': 101,\n    'Numpad 6': 102,\n    'Numpad 7': 103,\n    'Numpad 8': 104,\n    'Numpad 9': 105,\n    'Numpad *': 106,\n    'Numpad +': 107,\n    'Numpad -': 109,\n    'Numpad .': 110,\n    'Numpad /': 111,\n    F1: 112,\n    F2: 113,\n    F3: 114,\n    F4: 115,\n    F5: 116,\n    F6: 117,\n    F7: 118,\n    F8: 119,\n    F9: 120,\n    F10: 121,\n    F11: 122,\n    F12: 123,\n    'Num Lock': 144,\n    'Scroll Lock': 145,\n    ';': 186,\n    ',': 188,\n    '.': 190,\n    '/': 191,\n    '`': 192,\n    '[': 219,\n    '\\\\': 220,\n    ']': 221,\n    '\\'': 222,\n    Kana: 21,\n    Eisu: 22,\n    Junja: 23,\n    Final: 24,\n    Hanja: 25,\n    Convert: 28,\n    Nonconvert: 29,\n    Accept: 30,\n    Modechange: 31,\n    Select: 41,\n    Print: 42,\n    Execute: 43,\n    Printscreen: 44,\n    Colon: 58,\n    Semicolon: 59,\n    'Less Than': 60,\n    Equals2: 61,\n    'Greater Than': 62,\n    'Question Mark': 63,\n    'Context Menu': 93,\n    Sleep: 95,\n    F13: 124,\n    F14: 125,\n    F15: 126,\n    F16: 127,\n    F17: 128,\n    F18: 129,\n    F19: 130,\n    F20: 131,\n    F21: 132,\n    F22: 133,\n    F23: 134,\n    F24: 135,\n    'Win Oem Fj Jisho': 146,\n    'Win Oem Fj Masshou': 147,\n    'Win Oem Fj Touroku': 148,\n    'Win Oem Fj Loya': 149,\n    'Win Oem Fj Roya': 150,\n    Circumflex: 160,\n    Exclamation: 161,\n    'Double Quote': 162,\n    Hash: 163,\n    Dollar: 164,\n    Percent: 165,\n    Ampersand: 166,\n    Underscore: 167,\n    'Open Paren': 168,\n    'Close Paren': 169,\n    Asterisk: 170,\n    Plus: 171,\n    Pipe: 172,\n    'Hyphen Minus': 173,\n    'Open Curly Bracket': 174,\n    'Close Curly Bracket': 175,\n    Tilde: 176,\n    'Volume Mute': 181,\n    'Volume Down': 182,\n    'Volume Up': 183,\n    Equals: 187,\n    Minus: 189,\n    'Win Ico Help': 227,\n    'Win Ico 00': 228,\n    'Win Ico Clear': 230,\n    'Win Oem Reset': 233,\n    'Win Oem Jump': 234,\n    'Win Oem Pa1': 235,\n    'Win Oem Pa2': 236,\n    'Win Oem Pa3': 237,\n    'Win Oem Wsctrl': 238,\n    'Win Oem Cusel': 239,\n    'Win Oem Attn': 240,\n    'Win Oem Finish': 241,\n    'Win Oem Copy': 242,\n    'Win Oem Auto': 243,\n    'Win Oem Enlw': 244,\n    'Win Oem Backtab': 245,\n    Attn: 246,\n    Crsel: 247,\n    Exsel: 248,\n    Ereof: 249,\n    Play: 250,\n    Zoom: 251,\n    Pa1: 253,\n    'Win Oem Clear': 254\n\n};\n\n//var hasHorizontalScrollbar = div.scrollWidth > div.clientWidth;\n//var hasVerticalScrollbar = div.scrollHeight > div.clientHeight;\n(function ($) {\n    $.fn.hasHorizontalScrollBar = function () {\n        return $(this)[0].scrollWidth > $(this).innerWidth();\n    };\n})(jQuery);\n\nexport function clone(obj, replacer?) {\n    return JSON.parse(JSON.stringify(obj, replacer));\n}\n\nexport function cloneObject(obj) {\n    if (!obj) return obj;\n    const nObj = {};\n    let prop;\n    for (prop in obj) {\n        if (!obj.hasOwnProperty(prop)) continue;\n        if (obj[prop])\n            nObj[prop] = obj[prop];\n        else if (typeof obj[prop] === 'object')\n            nObj[prop] = cloneObject(obj[prop]);\n        else if (Array.isArray(obj[prop]))\n            nObj[prop] = cloneArray(obj[prop]);\n        else\n            nObj[prop] = obj[prop];\n    }\n    return nObj;\n}\n\nexport function cloneArray(arr) {\n    if (!arr || arr.length === 0) return new Array();\n    const nArr = new Array(arr.length);\n    let l = arr.length;\n    while (l--) {\n        if (typeof arr[l] === 'object')\n            nArr[l] = cloneObject(arr[l]);\n        else if (Array.isArray(arr[l]))\n            nArr[l] = cloneArray(arr[l]);\n        else\n            nArr[l] = cloneObject(arr[l]);\n    }\n    return nArr;\n}\n\nexport function copy(o) {\n    let output;\n    let v;\n    let key;\n    if (!o || (typeof o !== 'object' && !Array.isArray(o)))\n        return o;\n    output = Array.isArray(o) ? [] : {};\n    for (key in o) {\n        if (!o.hasOwnProperty(key)) continue;\n        v = o[key];\n        output[key] = (v && (typeof v === 'object' || Array.isArray(v))) ? copy(v) : v;\n    }\n    return output;\n}\n\nexport function setSelectionRange(input, selectionStart, selectionEnd) {\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(selectionStart, selectionEnd);\n    }\n    else if (input.createTextRange) {\n        const range = input.createTextRange();\n        range.collapse(true);\n        range.moveEnd('character', selectionEnd);\n        range.moveStart('character', selectionStart);\n        range.select();\n    }\n}\n\nexport function selectAll(input) {\n    if (!input || input.value.length === 0) return;\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(0, input.value.length);\n    }\n    else\n        input.select();\n}\n\nexport function getSelectionText() {\n    var text = \"\";\n    if (window.getSelection)\n        text = window.getSelection().toString();\n    return text;\n}\n\nCanvasRenderingContext2D.prototype.fillRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.fill();\n};\n\nCanvasRenderingContext2D.prototype.strokeRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.stroke();\n};\n\nif (!Object.keys) Object.keys = function (o) {\n    if (o !== Object(o))\n        throw new TypeError('Object.keys called on a non-object');\n    var k = [], p;\n    for (p in o) if (Object.prototype.hasOwnProperty.call(o, p)) k.push(p);\n    return k;\n};\n\nif (!Object.toType) Object.toType = function (obj) {\n    return ({}).toString.call(obj).match(/\\s([a-z|A-Z]+)/)[1].toLowerCase();\n};\n\nif (typeof String.prototype.startsWith != 'function') {\n    String.prototype.startsWith = function (str) {\n        return this.slice(0, str.length) == str;\n    };\n}\n\nif (typeof String.prototype.endsWith != 'function') {\n    String.prototype.endsWith = function (str) {\n        return this.slice(-str.length) == str;\n    };\n}\n\nif (typeof String.prototype.splice !== 'function') {\n    String.prototype.splice = function (this: string, idx: number, s: string, rem?: number) {\n        if (typeof rem === 'undefined') rem = 0;\n        return (this.slice(0, idx) + s + this.slice(idx + Math.abs(rem)));\n    };\n}\n\nif (typeof String.prototype.padStart !== 'function') {\n    String.prototype.padStart = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number')\n            paddingValue = ' '.repeat(paddingValue);\n        return String(paddingValue + this).slice(-paddingValue.length);\n    };\n}\n\nif (typeof String.prototype.padEnd !== 'function') {\n    String.prototype.padEnd = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number') {\n            if (paddingValue <= this.length) return this;\n            paddingValue = ' '.repeat(paddingValue - this.length);\n            return this + paddingValue;\n        }\n        if (paddingValue.length <= this.length) return this;\n        return this + paddingValue.slice(-this.length);\n    };\n}\n\nif (!String.prototype.replaceAll) {\n    String.prototype.replaceAll = function (str, newStr) {\n\n        // If a regex pattern\n        if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {\n            return this.replace(str, newStr);\n        }\n\n        // If a string\n        return this.replace(new RegExp(str, 'g'), newStr);\n    };\n}\n\nif (typeof Uint8Array.prototype.charAt != 'function') {\n    Uint8Array.prototype.charAt = function (this: Uint8Array, idx: number) {\n        return String.fromCharCode(this[idx]);\n    };\n}\n\nif (typeof Uint8Array.prototype.charCodeAt != 'function') {\n    Uint8Array.prototype.charCodeAt = function (this: Uint8Array, idx: number) {\n        return this[idx];\n    };\n}\n\nexport function addSlashes(string, all?) {\n    if (!string || !string.length) return string;\n    if (all)\n        return string.replace(/\\\\/g, '\\\\\\\\').\n            replace(/\\u0008/g, '\\\\b').\n            replace(/\\t/g, '\\\\t').\n            replace(/\\n/g, '\\\\n').\n            replace(/\\f/g, '\\\\f').\n            replace(/\\r/g, '\\\\r').\n            replace(/'/g, '\\\\\\'').\n            replace(/\"/g, '\\\\\"').\n            replace(/\\u0000/g, '\\\\0');\n    return string.replace(/\\\\/g, '\\\\\\\\').\n        replace(/'/g, '\\\\\\'').\n        replace(/\"/g, '\\\\\"');\n}\n\nString.prototype.addSlashes = function (this: string) {\n    //no need to do (str+'') anymore because 'this' can only be a string\n    return addSlashes(this);\n}\n\nString.prototype.splitQuote = function (this: string, sep: string, type?, escape?, escapeChar?) {\n    if (this.length === 0)\n        return [];\n    if (!sep || !sep.length)\n        return [this];\n    if (!type) type = 1 | 2;\n    if (!escape) escape = 1 | 2;\n    if (!escapeChar) escapeChar = '\\\\';\n    let quote: boolean = false;\n    let sQuote: boolean = false;\n    const str = [];\n    let pS = 0;\n    let s = 0;\n    let c: string;\n    let pC = '';\n    let sp;\n    const spl = sep.length;\n    let spC: string;\n    const tl = this.length;\n    for (; s < tl; s++) {\n        c = this.charAt(s);\n        if (c === '\"' && (type & 2) === 2) {\n            if ((escape & 2) === 2) {\n                if (s === 0 || pC !== escapeChar)\n                    quote = !quote;\n            }\n            else\n                quote = !quote;\n        }\n        else if (c === '\\'' && (type & 1) === 1) {\n            if ((escape & 1) === 1) {\n                if (s === 0 || pC !== escapeChar)\n                    sQuote = !sQuote;\n            }\n            else\n                sQuote = !sQuote;\n        }\n        else if (!quote && !sQuote) {\n            for (sp = 0; sp < spl; sp++) {\n                spC = sep.charAt(sp);\n                if (c === spC) {\n                    if (s > pS || s === 0) {\n                        str.push(this.substr(pS, s - pS));\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === pS) {\n                        str.push('');\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === tl - 1)\n                        str.push('');\n                }\n            }\n        }\n        pC = c;\n    }\n    if (s === tl && s === pS && sep.indexOf(pC) !== -1) {\n        str.push('');\n        pS = s + 1;\n    }\n    if (s > pS)\n        str.push(this.substr(pS, s - pS));\n    return str;\n};\n\nexport function getTimeSpan(i: number): string {\n    let al;\n    const tmp = [];\n\n    al = Math.floor(i / (1000 * 60 * 60 * 24));\n    i -= al * (1000 * 60 * 60 * 24);\n    if (al === 1) tmp.push(al + ' day');\n    else if (al > 0) tmp.push(al + ' days');\n\n    al = Math.floor(i / (1000 * 60 * 60));\n    i -= al * (1000 * 60 * 60);\n    if (al === 1) tmp.push(al + ' hour');\n    else if (al > 0) tmp.push(al + ' hours');\n\n    al = Math.floor(i / (1000 * 60));\n    i -= al * (1000 * 60);\n    if (al === 1) tmp.push(al + ' minute');\n    else if (al > 0) tmp.push(al + ' minutes');\n\n    al = Math.floor(i / (1000));\n    i -= al * (1000);\n    if (al === 1) tmp.push(al + ' second');\n    else if (al > 0) tmp.push(al + ' seconds');\n    if (tmp.length === 0)\n        tmp.push('0 seconds');\n    return tmp.join(', ');\n}\n\nexport function naturalCompare(a, b) {\n    const ax = [];\n    const bx = [];\n\n    a.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { ax.push([$1 || Infinity, $2 || '']); });\n    b.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { bx.push([$1 || Infinity, $2 || '']); });\n\n    while (ax.length && bx.length) {\n        const an = ax.shift();\n        const bn = bx.shift();\n        const nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);\n        if (nn) return nn;\n    }\n\n    return ax.length - bx.length;\n}\n\nexport function getScrollBarWidth(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetWidth;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    if (w1 === w2) w2 = el.clientWidth;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n\nexport function getScrollBarHeight(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetHeight;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n\nexport function getScrollBarSize(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n\n    const w1 = inner.offsetWidth;\n    const h1 = inner.offsetHeight;\n\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    let h2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientWidth;\n    if (h1 === h2) h2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return [(w1 - w2), (h1 - h2)];\n}\n\nexport function formatSize(size) {\n    if (size >= 1073741824)\n        return Math.round(size / 1073741824).toLocaleString() + ' GB';\n    else if (size >= 1048576)\n        return Math.round(size / 1048576).toLocaleString() + ' MB';\n    else if (size >= 1024)\n        return Math.round(size / 1024).toLocaleString() + ' KB';\n    return size.toLocaleString() + ' B';\n}\n\nexport function capitalize(s, first?) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = first ? 1 : s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1).toLowerCase();\n                break;\n            }\n        }\n    }\n    return s.join(' ');\n}\n\nexport function capitalizePinkfish(s) {\n    const p = string_parts(s);\n    if (p.length !== 3)\n        return capitalize(s, true);\n    return p[0] + capitalize(p[1], true) + p[2];\n}\n\nfunction is_color(str) {\n    if (!_colorCodes)\n        loadColors();\n    if (!str)\n        return false;\n    if (_colorCodes[str])\n        return true;\n    switch (str) {\n        case 'ITALIC':\n        case 'UNDERLINE':\n        case 'STRIKEOUT':\n        case 'DBLUNDERLINE':\n        case 'OVERLINE':\n        case 'FLASH':\n        case 'REVERSE':\n        case 'RESET':\n        case 'DEFAULT':\n        case 'BOLD':\n            return true;\n    }\n    return false;\n}\n\nfunction string_parts(str) {\n    let tmp;\n    let t2;\n    let ss;\n    let se;\n    let sm;\n    let s;\n    let e;\n    let c;\n    //more accurate then a regex even if slower in some cases\n    if (!str.length) return ['', '', ''];\n    tmp = str.split('%^');\n    c = tmp.length;\n    if (c === 1)\n        return ['', str, ''];\n\n    if (tmp[0].length === 0) {\n        for (s = 0; s < c; s++) {\n            t2 = tmp[s];\n            if (!t2.length) continue;\n            if (!is_color(t2)) {\n                s--;\n                break;\n            }\n        }\n    }\n    else\n        s--;\n    if (tmp[c - 1].length === 0) {\n        for (e = c - 1; e > s; e--) {\n            t2 = tmp[e];\n            if (!t2.length) continue;\n            if (!is_color(t2)) {\n                e++;\n                break;\n            }\n        }\n    }\n    else\n        e = c;\n    sm = tmp.slice(s + 1, e).join('%^');\n    if (!sm.length)\n        return [str, '', ''];\n    ss = tmp.slice(0, s + 1).join('%^');\n    se = tmp.slice(e).join('%^');\n    if (sm.length) {\n        if (ss.length)\n            ss += '%^';\n        if (se.length)\n            se = '%^' + se;\n    }\n    return [ss, sm, se];\n}\n\nexport function inverse(s) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if (c >= 'A' && c <= 'Z')\n                s[i] = s[i].substr(0, p) + c.toLowerCase() + s[i].substr(p + 1);\n            else if (c >= 'a' && c <= 'z')\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1);\n        }\n    }\n    return s.join(' ');\n}\n\nexport function invert(obj) {\n    const new_obj = {};\n    let prop;\n    for (prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            new_obj[obj[prop]] = prop;\n        }\n    }\n    return new_obj;\n}\n\nexport function Cardinal(x) {\n    let str;\n    if (x === 0) return 'zero';\n    if (x < 0) {\n        str = 'negative ';\n        x = Math.abs(x);\n    }\n    else\n        str = '';\n    switch (x) {\n        case 1:\n            return str + 'one';\n        case 2:\n            return str + 'two';\n        case 3:\n            return str + 'three';\n        case 4:\n            return str + 'four';\n        case 5:\n            return str + 'five';\n        case 6:\n            return str + 'six';\n        case 7:\n            return str + 'seven';\n        case 8:\n            return str + 'eight';\n        case 9:\n            return str + 'nine';\n        case 10:\n            return str + 'ten';\n        case 11:\n            return str + 'eleven';\n        case 12:\n            return str + 'twelve';\n        case 13:\n            return str + 'thirteen';\n        case 14:\n            return str + 'fourteen';\n        case 15:\n            return str + 'fifteen';\n        case 16:\n            return str + 'sixteen';\n        case 17:\n            return str + 'seventeen';\n        case 18:\n            return str + 'eighteen';\n        case 19:\n            return str + 'nineteen';\n        case 20:\n            return str + 'twenty';\n        default:\n            if (x > 1000000000)\n                return 'over a billion';\n            else if (x / 1000000 > 0) {\n                if (x % 1000000 > 0)\n                    return +' million ' + Cardinal(x % 1000000);\n                return Cardinal((x / 1000000) >> 0) + ' million';\n            }\n            else if (x / 1000 > 0) {\n                if (x % 1000 > 0)\n                    return Cardinal((x / 1000) >> 0) + ' thousand ' + Cardinal(x % 1000);\n                return Cardinal((x / 1000) >> 0) + ' thousand';\n            }\n            else if (x / 100 > 0) {\n                if (x % 100 > 0)\n                    return Cardinal((x / 100) >> 0) + ' hundred' + Cardinal(x % 100);\n                return Cardinal((x / 100) >> 0) + ' hundred';\n            }\n            else {\n                if (x % 10 > 0)\n                    str = '-' + Cardinal(x % 10);\n                else\n                    str = '';\n                switch (x / 10) {\n                    case 2:\n                        return 'twenty' + str;\n                    case 3:\n                        return 'thirty' + str;\n                    case 4:\n                        return 'forty' + str;\n                    case 5:\n                        return 'fifty' + str;\n                    case 6:\n                        return 'sixty' + str;\n                    case 7:\n                        return 'seventy' + str;\n                    case 8:\n                        return 'eighty' + str;\n                    case 9:\n                        return 'ninety' + str;\n                    default:\n                        return 'error';\n                }\n            }\n    }\n}\n\nexport function wordwrap(str, maxWidth, newLineStr?) {\n    let done = false;\n    let res = '';\n    let found;\n    let i;\n    newLineStr = newLineStr || '\\n';\n    do {\n        found = false;\n        // Inserts new line at first whitespace of the line\n        for (i = maxWidth - 1; i >= 0; i--) {\n            if (testWhite(str.charAt(i))) {\n                res = res + [str.slice(0, i + 1), newLineStr].join('');\n                str = str.slice(i + 1);\n                found = true;\n                break;\n            }\n        }\n        // Inserts new line at maxWidth position, the word is too long to wrap\n        if (!found) {\n            res += [str.slice(0, maxWidth), newLineStr].join('');\n            str = str.slice(maxWidth);\n        }\n\n        if (str.length < maxWidth)\n            done = true;\n    } while (!done);\n    if (str.length > 0)\n        return res + str;\n    return res;\n}\n\nfunction testWhite(x) {\n    return /^\\s$/.test(x.charAt(0));\n}\n\nexport function splitQuoted(str, sep, t?, e?, ec?) {\n    if (typeof (t) === 'undefined') t = 1 | 2;\n    if (typeof (e) === 'undefined') e = 0;\n    if (typeof (ec) === 'undefined') ec = '\\\\';\n    if (!str || str.length === 0)\n        return [];\n    if (!sep || sep.length === 0)\n        return [str];\n    sep = sep.split('');\n    let q = false;\n    let sq = false;\n    const strings = [];\n    let ps = 0;\n    let s = 0;\n    const sl = str.length;\n    let c;\n    for (; s < sl; s++) {\n        c = str.charAt(s);\n        if (c === '\"' && (t & 2) === 2) {\n            if ((e & 2) === 2 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    q = !q;\n            }\n            else\n                q = !q;\n        }\n        else if (c === '\\'' && (t & 1) === 1) {\n            if ((e & 1) === 1 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    sq = !sq;\n            }\n            else\n                sq = !sq;\n        }\n        else if (!sq && !q) {\n            const spl = sep.length;\n            for (let sp = 0; sp < spl; sp++) {\n                if (c === sep[sp]) {\n                    if (s > ps || s === 0) {\n                        strings.push(str.substring(ps, s));\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === ps) {\n                        strings.push('');\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === (sl - 1))\n                        strings.push('');\n                }\n            }\n        }\n    }\n    if (s === sl && s === ps && sep.indexOf(str.charAt(s - 1)) > -1) {\n        strings.push('');\n        ps = s + 1;\n    }\n    if (s > ps)\n        strings.push(str.substring(ps, s));\n    return strings;\n}\n\nexport function leadingZeros(num, totalChars: number, padWith: string, trim?: boolean) {\n    num = num + '';\n    padWith = (padWith) ? padWith : '0';\n    if (num.length < totalChars) {\n        while (num.length < totalChars) {\n            num = padWith + num;\n        }\n    }\n    if (trim && num.length > totalChars) {\n        num = num.substring((num.length - totalChars), totalChars);\n    }\n    return num;\n}\n\nexport function resetCursor(txtElement) {\n    txtElement.scrollTop = 0;\n    txtElement.scrollLeft = 0;\n    if (typeof txtElement.selectionStart === 'number') {\n        txtElement.selectionStart = 0;\n        txtElement.selectionEnd = 0;\n    }\n    else if (txtElement.setSelectionRange) {\n        txtElement.focus();\n        txtElement.setSelectionRange(0, 0);\n        txtElement.focus();\n    } else if (txtElement.createTextRange) {\n        const range = txtElement.createTextRange();\n        range.moveStart('character', 0);\n        range.select();\n    }\n}\n\nexport function moveCursorToEnd(el) {\n    el.scrollTop = el.scrollHeight;\n    if (typeof el.selectionStart === 'number') {\n        el.selectionStart = el.selectionEnd = el.value.length;\n    } else if (typeof el.createTextRange !== 'undefined') {\n        el.focus();\n        const range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n    }\n}\n\nexport function getCursor(el) {\n    if (!el) return 0;\n    if (typeof el.selectionStart === 'number') {\n        return el.selectionDirection == 'backward' ? el.selectionStart : el.selectionEnd;\n    } else if ((<any>document).selection) {\n        // Set focus on the element\n        el.focus();\n        // To get cursor position, get empty selection range\n        var oSel = (<any>document).selection.createRange();\n        // Move selection start to 0 position\n        oSel.moveStart('character', -el.value.length);\n        // The caret position is selection length\n        return oSel.text.length;\n    }\n    return 0;\n}\n\nexport function stringToEnum(str, en, ignoreCase?) {\n    if (!str || !en) return 0;\n    if (ignoreCase)\n        str = str.toUpperCase();\n    //split strip and trim spaces\n    str = str.split(',').map(v => v.trim());\n    //init value\n    let value = 0;\n    let sl = str.length;\n    //get the enum keys\n    const values = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    let test = values.slice(0);\n    //ignore case just make everything upper\n    if (ignoreCase)\n        test = test.map(v => v.toUpperCase());\n    //loop the strings\n    while (sl--) {\n        let vl = values.length;\n        //loop the enum to try and find the string value\n        while (vl--) {\n            //found value add it on\n            if (test[vl] === str[sl]) {\n                value |= en[values[vl].replace(/ /g, '_')];\n                break;\n            }\n        }\n    }\n    //return final value\n    return value;\n}\n\nexport function enumToString(value, en, exact?) {\n    let state;\n    const states = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    if (value === 0)\n        return en[0];\n    const f = [];\n    state = states.length;\n    while (state--) {\n        if (en[states[state]] === 0) continue;\n        if (exact) {\n            if (value === en[states[state]])\n                f.push(capitalize(states[state].replace(/_/g, ' ')));\n        }\n        else if ((value & en[states[state]]) === en[states[state]])\n            f.push(capitalize(states[state].replace(/_/g, ' ')));\n    }\n    return f.join(', ');\n}\n\n//https://j11y.io/snippets/wordwrap-for-javascript/\nexport function wordWrap(str, width, brk, cut) {\n    brk = brk || 'n';\n    width = width || 75;\n    cut = cut || false;\n    if (!str) return str;\n    const regex = '.{1,' + width + '}(\\s|$)' + (cut ? '|.{' + width + '}|.+$' : '|\\S+?(\\s|$)');\n    return str.match(RegExp(regex, 'g')).join(brk);\n}\n\nexport function wordBreak(str, start, length) {\n    if (length < 0) return 0;\n    let wBreak = length - 1;\n    if (start + wBreak >= str.length)\n        return str.length - start;\n    while (wBreak >= 0 && str.charAt(start + wBreak) !== ' ' && str.charAt(start + wBreak) !== '\\\\')\n        wBreak--;\n    if (wBreak <= 0)\n        return length;\n    wBreak++;\n    return wBreak;\n}\n\nexport function formatString(str, indent, width?, prefix?, postFix?, preIdent?) {\n    if (!str || str.length === 0) return '';\n    width = width || 66;\n    if (width < 40) width = 40;\n    if (typeof prefix !== 'string')\n        prefix = '\"';\n    if (typeof postFix !== 'string')\n        postFix = '\"';\n    preIdent = preIdent || '';\n    if (str.length <= width)\n        return prefix + str + postFix;\n    const list = [];\n    let wBreak = wordBreak(str, 0, width);\n    list.push(str.substr(0, wBreak));\n    let len = str.length - wBreak;\n    let tmp = wBreak; // set start of next line at window width\n    while (len / width > 0) { // while full lines loop\n        wBreak = wordBreak(str, tmp, width);\n        list.push(str.substr(tmp, wBreak));\n        tmp += wBreak; // move to next line\n        len -= wBreak; // remove line width\n    }\n    if (len > 0) // left over\n        list.push(str.substr(tmp, len));\n    return prefix + list.join(postFix + '\\n' + preIdent + ' '.repeat(indent) + prefix) + postFix;\n}\n\nexport function consolidate(amt, str) {\n    let y;\n    let l;\n    let e = '';\n    if (!amt || !str || amt < 2) return str;\n    if (str.endsWith(' ')) {\n        e = ' ';\n        str = str.trim();\n    }\n    str = str.split(' ');\n    if (str[0].toLowerCase() === 'a' || str[0].toLowerCase() === 'an' || str[0].toLowerCase() === 'the')\n        str.shift();\n    l = str.length;\n    y = str.indexOf('of');\n    if (y > 0)\n        str[y - 1] = pluralize(str[y - 1]);\n    else if (str[l - 1].endsWith(')')) {\n        y = l - 1;\n        while (y >= 0) {\n            if (str[y].startsWith('('))\n                break;\n            y--;\n        }\n        if (y - 1 >= 0)\n            str[y - 1] = pluralize(str[y - 1]);\n    }\n    else if (str[l - 1].match(/\\(.*\\)/)) {\n        if (l - 2 >= 0)\n            str[l - 2] = pluralize(str[l - 2]);\n    }\n    else\n        str[l - 1] = pluralize(str[l - 1]);\n    if (amt > 10)\n        return 'numerous ' + str.join(' ') + e;\n    return ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'][amt] + ' ' + str.join(' ') + e;\n}\n\n//spell-checker:disable\nexport function pluralize(revert) {\n    const plural = {\n        '(quiz)$': '$1zes',\n        '^(ox)$': '$1en',\n        '([m|l])ouse$': '$1ice',\n        '(matr|vert|ind)ix|ex$': '$1ices',\n        '(x|ch|ss|sh)$': '$1es',\n        '([^aeiouy]|qu)y$': '$1ies',\n        '(hive)$': '$1s',\n        '(?:([^f])fe|([lr])f)$': '$1$2ves',\n        '(shea|lea|loa|thie)f$': '$1ves',\n        sis$: 'ses',\n        '([ti])um$': '$1a',\n        '(tomat|potat|ech|her|vet)o$': '$1oes',\n        '(bu)s$': '$1ses',\n        '(alias)$': '$1es',\n        '(octop)us$': '$1i',\n        '(ax|test)is$': '$1es',\n        '(us)$': '$1es',\n        '([^s]+)$': '$1s'\n    };\n\n    const singular = {\n        '(quiz)zes$': '$1',\n        '(matr)ices$': '$1ix',\n        '(vert|ind)ices$': '$1ex',\n        '^(ox)en$': '$1',\n        '(alias)es$': '$1',\n        '(octop|vir)i$': '$1us',\n        '(cris|ax|test)es$': '$1is',\n        '(shoe)s$': '$1',\n        '(o)es$': '$1',\n        '(bus)es$': '$1',\n        '([m|l])ice$': '$1ouse',\n        '(x|ch|ss|sh)es$': '$1',\n        '(m)ovies$': '$1ovie',\n        '(s)eries$': '$1eries',\n        '([^aeiouy]|qu)ies$': '$1y',\n        '([lr])ves$': '$1f',\n        '(tive)s$': '$1',\n        '(hive)s$': '$1',\n        '(li|wi|kni)ves$': '$1fe',\n        '(shea|loa|lea|thie)ves$': '$1f',\n        '(^analy)ses$': '$1sis',\n        '((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$': '$1$2sis',\n        '([ti])a$': '$1um',\n        '(n)ews$': '$1ews',\n        '(h|bl)ouses$': '$1ouse',\n        '(corpse)s$': '$1',\n        '(us)es$': '$1',\n        s$: ''\n    };\n\n    const irregular = {\n        move: 'moves',\n        foot: 'feet',\n        goose: 'geese',\n        sex: 'sexes',\n        child: 'children',\n        man: 'men',\n        tooth: 'teeth',\n        person: 'people'\n    };\n\n    const uncountable = [\n        'sheep',\n        'fish',\n        'deer',\n        'moose',\n        'series',\n        'species',\n        'money',\n        'rice',\n        'information',\n        'equipment'\n    ];\n\n    // save some time in the case that singular and plural are the same\n    if (uncountable.indexOf(revert.toLowerCase()) >= 0)\n        return revert;\n    let word;\n    // check for irregular forms\n    for (word in irregular) {\n        if (!irregular.hasOwnProperty(word)) continue;\n        let pattern;\n        let replace;\n        if (revert) {\n            pattern = new RegExp(irregular[word] + '$', 'i');\n            replace = word;\n        } else {\n            pattern = new RegExp(word + '$', 'i');\n            replace = irregular[word];\n        }\n        if (pattern.test(revert))\n            return revert.replace(pattern, replace);\n    }\n    let array;\n    if (revert) array = singular;\n    else array = plural;\n    let reg;\n\n    // check for matches using regular expressions\n    for (reg in array) {\n        if (!array.hasOwnProperty(reg)) continue;\n        const pattern = new RegExp(reg, 'i');\n\n        if (pattern.test(revert))\n            return revert.replace(pattern, array[reg]);\n    }\n\n    return revert;\n}\n//spell-checker:enable\n\nexport function stripPinkfish(text) {\n    text = text || '';\n    text = text.split('%^');\n    const stack = [];\n    let t = 0;\n    const tl = text.length;\n    for (; t < tl; t++) {\n        if (text[t].startsWith('B_') && is_color(text[t].substr(2)))\n            continue;\n        else if (is_color(text[t]))\n            continue;\n        stack.push(text[t]);\n    }\n    return stack.join('');\n}\n\nlet _colorCodes;\nexport function pinkfishToHTML(text) {\n    text = text || '';\n    text = text.split('%^');\n    if (!_colorCodes)\n        loadColors();\n    const stack = [];\n    let codes = [];\n    let t = 0;\n    let tl = text.length;\n    let bold = false;\n    let boldNest = false;\n    let classes = [];\n    for (; t < tl; t++) {\n        switch (text[t]) {\n            case 'ITALIC':\n                stack.push('<em>');\n                codes.push('</em>');\n                break;\n            case 'UNDERLINE':\n                classes.push('underline');\n                break;\n            case 'STRIKEOUT':\n                classes.push('strikeout');\n                break;\n            case 'DBLUNDERLINE':\n                classes.push('dblunderline');\n                break;\n            case 'OVERLINE':\n                classes.push('overline');\n                break;\n            case 'FLASH':\n                classes.push('noflash');\n                break;\n            case 'REVERSE':\n                classes.push('reverse');\n                break;\n            case 'RESET':\n            case 'DEFAULT':\n                const cl = codes.length;\n                for (let c = 0; c < cl; c++)\n                    stack.push(codes[c]);\n                codes = [];\n                classes = [];\n                break;\n            case 'BOLD':\n                bold = true;\n                break;\n            case '':\n                break;\n            default:\n                if (text[t].startsWith('B_')) {\n                    text[t] = text[t].substr(2);\n                    if (bold && !boldNest) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;background-color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    bold = false;\n                    continue;\n                }\n                else if (_colorCodes[text[t]]) {\n                    if (bold && !_colorCodes['BOLD%^%^' + text[t]]) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                    }\n                    else if (bold) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^' + text[t]] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                        continue;\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    continue;\n                }\n                else if (bold && !boldNest) {\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                    codes.push('</span>');\n                }\n                if (classes.length) {\n                    stack.push('<span class=\"' + classes.join(' ') + '\">');\n                    codes.push('</span>');\n                    classes = [];\n                }\n                stack.push(text[t]);\n                bold = false;\n                boldNest = false;\n                break;\n        }\n    }\n    if (classes.length) {\n        stack.push('<span class=\"' + classes.join(' ') + '\">');\n        codes.push('</span>');\n    }\n    for (t = 0, tl = codes.length; t < tl; t++)\n        stack.push(codes[t]);\n    return stack.join('');\n}\n\nfunction loadColors() {\n    let c;\n    let color;\n    let r;\n    let g;\n    let b;\n    let idx;\n    _colorCodes = {};\n\n    _colorCodes['BLACK'] = '000000';\n    _colorCodes['RED'] = '800000';\n    _colorCodes['GREEN'] = '008000';\n    _colorCodes['ORANGE'] = '808000';\n    _colorCodes['BLUE'] = '0000EE';\n    _colorCodes['MAGENTA'] = '800080';\n    _colorCodes['CYAN'] = '008080';\n    _colorCodes['WHITE'] = 'BBBBBB';\n    _colorCodes['mono11'] = '808080';\n    _colorCodes['BOLD%^%^RED'] = 'FF0000';\n    _colorCodes['BOLD%^%^GREEN'] = '00FF00';\n    _colorCodes['YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^BLUE'] = '5C5CFF';\n    _colorCodes['BOLD%^%^MAGENTA'] = 'FF00FF';\n    _colorCodes['BOLD%^%^CYAN'] = '00FFFF';\n    _colorCodes['BOLD%^%^WHITE'] = 'FFFFFF';\n    _colorCodes['BOLD%^%^BLACK'] = '808080';\n\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = `RGB${r}${g}${b}`;\n                color = '';\n                c = 0;\n                c = r * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = g * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = b * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                if (!_colorCodes[idx])\n                    _colorCodes[idx] = color.toUpperCase();\n            }\n        }\n    }\n\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        if (g < 16)\n            g = '0' + g.toString(16).toUpperCase();\n        else\n            g = g.toString(16).toUpperCase();\n        g = g + g + g;\n        if (r < 242)\n            _colorCodes['mono0' + (r - 232)] = g;\n        else\n            _colorCodes['mono' + (r - 232)] = g;\n    }\n}\n\nexport function getColors() {\n    const _ColorTable = [];\n    let r;\n    let g;\n    let b;\n    let idx;\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = 16 + (r * 36) + (g * 6) + b;\n                _ColorTable[idx] = 'rgb(';\n                if (r > 0)\n                    _ColorTable[idx] += r * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (g > 0)\n                    _ColorTable[idx] += g * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (b > 0)\n                    _ColorTable[idx] += b * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ')';\n            }\n        }\n    }\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        _ColorTable[r] = ['rgb(', g, ',', g, ',', g, ')'].join('');\n    }\n    _ColorTable[0] = 'rgb(0,0,0)'; //black fore\n    _ColorTable[1] = 'rgb(128, 0, 0)'; //red fore\n    _ColorTable[2] = 'rgb(0, 128, 0)'; //green fore\n    _ColorTable[3] = 'rgb(128, 128, 0)'; //yellow fore\n    _ColorTable[4] = 'rgb(0, 0, 238)'; //blue fore\n    _ColorTable[5] = 'rgb(128, 0, 128)'; //magenta fore\n    _ColorTable[6] = 'rgb(0, 128, 128)'; //cyan fore\n    _ColorTable[7] = 'rgb(187, 187, 187)'; //white fore\n    _ColorTable[8] = 'rgb(128, 128, 128)'; //black  bold\n    _ColorTable[9] = 'rgb(255, 0, 0)'; //Red bold\n    _ColorTable[10] = 'rgb(0, 255, 0)'; //green bold\n    _ColorTable[11] = 'rgb(255, 255, 0)'; //yellow bold\n    _ColorTable[12] = 'rgb(92, 92, 255)'; //blue bold\n    _ColorTable[13] = 'rgb(255, 0, 255)'; //magenta bold\n    _ColorTable[14] = 'rgb(0, 255, 255)'; //cyan bold\n    _ColorTable[15] = 'rgb(255, 255, 255)'; //white bold\n    _ColorTable[256] = 'rgb(0, 0, 0)'; //black faint\n    _ColorTable[257] = 'rgb(118, 0, 0)'; //red  faint\n    _ColorTable[258] = 'rgb(0, 108, 0)'; //green faint\n    _ColorTable[259] = 'rgb(145, 136, 0)'; //yellow faint\n    _ColorTable[260] = 'rgb(0, 0, 167)'; //blue faint\n    _ColorTable[261] = 'rgb(108, 0, 108)'; //magenta faint\n    _ColorTable[262] = 'rgb(0, 108, 108)'; //cyan faint\n    _ColorTable[263] = 'rgb(161, 161, 161)'; //white faint\n    _ColorTable[264] = 'rgb(0, 0, 0)'; //BackgroundBlack\n    _ColorTable[265] = 'rgb(128, 0, 0)'; //red back\n    _ColorTable[266] = 'rgb(0, 128, 0)'; //greenback\n    _ColorTable[267] = 'rgb(128, 128, 0)'; //yellow back\n    _ColorTable[268] = 'rgb(0, 0, 238)'; //blue back\n    _ColorTable[269] = 'rgb(128, 0, 128)'; //magenta back\n    _ColorTable[270] = 'rgb(0, 128, 128)'; //cyan back\n    _ColorTable[271] = 'rgb(187, 187, 187)'; //white back\n    _ColorTable[272] = 'rgb(0,0,0)'; //InfoBackground\n    _ColorTable[273] = 'rgb(0, 255, 255)'; //InfoText\n    _ColorTable[274] = 'rgb(0,0,0)'; //LocalEchoBackground\n    _ColorTable[275] = 'rgb(255, 255, 0)'; //LocalEchoText\n    _ColorTable[276] = 'rgb(0, 0, 0)'; //DefaultBack\n    _ColorTable[277] = 'rgb(229, 229, 229)'; //DefaultFore\n    _ColorTable[278] = 'rgb(205, 0, 0)'; //ErrorFore\n    _ColorTable[279] = 'rgb(229, 229, 229)'; //ErrorBack\n    _ColorTable[280] = 'rgb(255,255,255)'; //DefaultBrightFore\n    return _ColorTable;\n}\n\nexport function formatUnit(str, ch?) {\n    if (!str) return str;\n    if (/^\\d+c$/.test(str)) {\n        if (ch)\n            return (parseInt(str, 10) * ch) + 'px';\n        return str + 'h';\n    }\n    if (/^\\d+$/.test(str))\n        return parseInt(str, 10) + 'px';\n    return str;\n}\n\nexport function replaceHtml(el, html) {\n    const oldEl = typeof el === 'string' ? document.getElementById(el) : el;\n    /*@cc_on // Pure innerHTML is slightly faster in IE\n        oldEl.innerHTML = html;\n        return oldEl;\n    @*/\n    const newEl = oldEl.cloneNode(false);\n    newEl.innerHTML = html;\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    /* Since we just removed the old element from the DOM, return a reference\n    to the new element, which can be used to restore variable references. */\n    return newEl;\n}\n\nexport function isValidIdentifier(str: string): boolean {\n    if (!str || str.length === 0) return false;\n    //valid character check\n    if (!str.match(/^[a-zA-Z_$][a-zA-Z_$0-9]*$/g))\n        return false;\n    //not a keyword\n    return ['break', 'case', 'catch', 'continue', 'debugger', 'default', 'delete', 'do', 'else', 'finally', 'for', 'function', 'if', 'in', 'instanceof', 'new', 'return', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with', 'class', 'const', 'enum', 'export', 'extends', 'import', 'super', 'implements', 'interface', 'let', 'package', 'private', 'protected', 'public', 'static', 'yield', 'null', 'true', 'false', 'NaN', 'Infinity', 'undefined', 'eval', 'arguments'].indexOf(str) === -1;\n}\n\nexport function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function insertValue(input, value) {\n    if (!input) return;\n    const active = <HTMLElement>document.activeElement;\n    if (!active || active != input)\n        input.focus();\n    document.execCommand(\"insertText\", false, value);\n    if (active && active != input)\n        active.focus();\n}\n\nif (!Array.isArray) {\n    (<any>Array.isArray) = function (arg) {\n        return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n}\n\nlet txtDecoder;\nexport function ArrayBufferToString(buffer) {\n    if (window.TextDecoder !== undefined) {\n        return (txtDecoder || (txtDecoder = new TextDecoder())).decode(new Uint8Array(buffer));\n    }\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nexport function Uint8ArrayToString(buffer) {\n    if (window.TextDecoder !== undefined)\n        return (txtDecoder || (txtDecoder = new TextDecoder())).decode(buffer);\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(buffer)));\n}\n\nexport function StringToArrayBuffer(string) {\n    return StringToUint8Array(string).buffer;\n}\n\nexport function BinaryToString(binary) {\n    var error;\n\n    try {\n        return decodeURIComponent(escape(binary));\n    } catch (_error) {\n        error = _error;\n        if (error instanceof URIError) {\n            return binary;\n        } else {\n            throw error;\n        }\n    }\n}\n\nexport function StringToBinary(string) {\n    var chars, code, i, isUCS2, len, _i;\n\n    len = string.length;\n    chars = [];\n    isUCS2 = false;\n    for (i = _i = 0; 0 <= len ? _i < len : _i > len; i = 0 <= len ? ++_i : --_i) {\n        code = String.prototype.charCodeAt.call(string, i);\n        if (code > 255) {\n            isUCS2 = true;\n            chars = null;\n            break;\n        } else {\n            chars.push(code);\n        }\n    }\n    if (isUCS2 === true) {\n        return unescape(encodeURIComponent(string));\n    } else {\n        return String.fromCharCode.apply(null, Array.prototype.slice.apply(chars));\n    }\n}\n\nlet txtEncoder;\nexport function StringToUint8Array(string) {\n    var binary, binLen, buffer, chars, i, _i;\n    if (window.TextEncoder !== undefined)\n        return (txtEncoder || (txtEncoder = new TextEncoder())).encode(string);\n    binary = StringToBinary(string);\n    binLen = binary.length;\n    buffer = new ArrayBuffer(binLen);\n    chars = new Uint8Array(buffer);\n    for (i = _i = 0; 0 <= binLen ? _i < binLen : _i > binLen; i = 0 <= binLen ? ++_i : --_i) {\n        chars[i] = String.prototype.charCodeAt.call(binary, i);\n    }\n    return chars;\n}\n\n//attempt to copy text to clipboard, may or may not always work depending on permissions and browser\nexport function copyText(text: string) {\n    return new Promise(function (resolve, reject) {\n        try {\n            if (typeof navigator !== \"undefined\" && typeof navigator.clipboard !== \"undefined\" && typeof navigator.permissions !== \"undefined\") {\n                var blob = new Blob([text], { type: \"text/plain\" });\n                var data = [new ClipboardItem({ \"text/plain\": blob })];\n                navigator.permissions.query({ name: \"clipboardWrite\" as PermissionName }).then(function (permission) {\n                    if (permission.state === \"granted\" || permission.state === \"prompt\") {\n                        navigator.clipboard.write(data).then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error(\"Permission not granted!\"));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported(\"copy\")) {\n                var textarea = document.createElement(\"textarea\");\n                textarea.value = text;\n                textarea.textContent = text;\n                textarea.style.position = \"fixed\";\n                textarea.style.width = '2em';\n                textarea.style.height = '2em';\n                textarea.style.padding = '0';\n                textarea.style.border = 'none';\n                textarea.style.outline = 'none';\n                textarea.style.boxShadow = 'none';\n                textarea.style.background = 'transparent';\n                document.body.appendChild(textarea);\n                textarea.focus();\n                textarea.select();\n                try {\n                    document.execCommand(\"copy\");\n                    document.body.removeChild(textarea);\n                    resolve(null);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error(\"None of copying methods are supported by this browser!\"));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function pasteText() {\n    return new Promise<string>(function (resolve, reject) {\n        try {\n            if (typeof navigator !== \"undefined\" && typeof navigator.clipboard !== \"undefined\" && typeof navigator.permissions !== \"undefined\") {\n                navigator.permissions.query({ name: \"clipboardRead\" as PermissionName }).then(function (permission) {\n                    if (permission.state === \"granted\" || permission.state === \"prompt\") {\n                        navigator.clipboard.readText().then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error(\"Permission not granted!\"));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported(\"paste\")) {\n                var textarea = document.createElement(\"textarea\");\n                textarea.style.position = \"fixed\";\n                textarea.style.width = '2em';\n                textarea.style.height = '2em';\n                textarea.style.padding = '0';\n                textarea.style.border = 'none';\n                textarea.style.outline = 'none';\n                textarea.style.boxShadow = 'none';\n                textarea.style.background = 'transparent';\n                document.body.appendChild(textarea);\n                textarea.focus();\n                textarea.select();\n                try {\n                    document.execCommand(\"paste\", false, null);\n                    resolve(textarea.value);\n                    document.body.removeChild(textarea);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error(\"None of pasting methods are supported by this browser!\"));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function pasteSync() {\n    let value = '';\n    if (document.queryCommandSupported && document.queryCommandSupported(\"paste\")) {\n        var textarea = document.createElement(\"textarea\");\n        textarea.style.position = \"fixed\";\n        textarea.style.width = '2em';\n        textarea.style.height = '2em';\n        textarea.style.padding = '0';\n        textarea.style.border = 'none';\n        textarea.style.outline = 'none';\n        textarea.style.boxShadow = 'none';\n        textarea.style.background = 'transparent';\n        document.body.appendChild(textarea);\n        textarea.focus();\n        textarea.select();\n        try {\n            document.execCommand(\"paste\", false, null);\n            value = textarea.value;\n        }\n        catch (e) {\n        }\n        finally {\n            document.body.removeChild(textarea);\n        }\n    }\n    return value;\n}\n\nexport function getParameterByName(name: string, url?: string): string {\n    if (!name) return null;\n    if (!url) url = window.location.href;\n    name = name.replace(/[[\\]]/g, '\\\\$&');\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\n\nexport function fSaveAs() {\n    // Feature test: Does this browser support the download attribute on anchor tags? (currently only Chrome)\n    var DownloadAttributeSupport = 'download' in document.createElement('a');\n\n    // Use any available BlobBuilder/URL implementation:\n    var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    // IE 10 has a handy navigator.msSaveBlob method. Maybe other browsers will emulate that interface?\n    // See: http://msdn.microsoft.com/en-us/library/windows/apps/hh441122.aspx\n    navigator.saveBlob = navigator.saveBlob || navigator.msSaveBlob || navigator.mozSaveBlob || navigator.webkitSaveBlob;\n\n    // Anyway, HMTL5 defines a very similar but more powerful window.saveAs function:\n    // http://www.w3.org/TR/file-writer-api/#the-filesaver-interface\n    window.saveAs = window.saveAs || window.webkitSaveAs || window.mozSaveAs || window.msSaveAs;\n    // However, this is not supported by any browser yet. But there is a compatibility library that\n    // adds this function to browsers that support Blobs (except Internet Exlorer):\n    // http://eligrey.com/blog/post/saving-generated-files-on-the-client-side\n    // https://github.com/eligrey/FileSaver.js\n\n    // mime types that (potentially) don't trigger a download when opened in a browser:\n    var BrowserSupportedMimeTypes = {\n        'image/jpeg': true,\n        'image/png': true,\n        'image/gif': true,\n        'image/svg+xml': true,\n        'image/bmp': true,\n        'image/x-windows-bmp': true,\n        'image/webp': true,\n        'audio/wav': true,\n        'audio/mpeg': true,\n        'audio/webm': true,\n        'audio/ogg': true,\n        'video/mpeg': true,\n        'video/webm': true,\n        'video/ogg': true,\n        'text/plain': true,\n        'text/html': true,\n        'text/xml': true,\n        'application/xhtml+xml': true,\n        'application/json': true\n    };\n\n    // Blobs and saveAs (or saveBlob)\t:\n    if (BlobBuilder && (window.saveAs || navigator.saveBlob)) {\n        // Currently only IE 10 supports this, but I hope other browsers will also implement the saveAs/saveBlob method eventually.\n        this.show = function (data, name, mimetype) {\n            var builder = new BlobBuilder();\n            builder.append(data);\n            var blob = builder.getBlob(mimetype || 'application/octet-stream');\n            if (!name) name = 'Download.bin';\n            // I don't assign saveAs to navigator.saveBlob (or the other way around)\n            // because I cannot know at this point whether future implementations\n            // require these methods to be called with 'this' assigned to window (or\n            // naviagator) in order to work. E.g. console.log won't work when not called\n            // with this === console.\n            if (window.saveAs) {\n                window.saveAs(blob, name);\n            }\n            else {\n                navigator.saveBlob(blob, name);\n            }\n        };\n    }\n    // Blobs and object URLs:\n    else if (BlobBuilder && URL) {\n        // Currently WebKit and Gecko support BlobBuilder and object URLs.\n        this.show = function (data, name, mimetype) {\n            var blob, url, builder = new BlobBuilder();\n            builder.append(data);\n            if (!mimetype) mimetype = 'application/octet-stream';\n            if (DownloadAttributeSupport) {\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                var link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                var event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // \"application/octet-stream\" for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    else if (Blob && URL) {\n        this.show = function (data, name, mimetype) {\n            var blob, url;\n            if (!mimetype) mimetype = 'application/octet-stream';\n            blob = new Blob([data], { type: mimetype });\n            if (DownloadAttributeSupport) {\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                var link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                var event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // \"application/octet-stream\" for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    // data:-URLs:\n    else if (!/\\bMSIE\\b/.test(navigator.userAgent)) {\n        // IE does not support URLs longer than 2048 characters (actually bytes), so it is useless for data:-URLs.\n        // Also it seems not to support window.open in combination with data:-URLs at all.\n        this.show = function (data, name, mimetype) {\n            if (!mimetype) mimetype = 'application/octet-stream';\n            // Again I need to filter the mime type so a download is forced.\n            if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                mimetype = 'application/octet-stream';\n            }\n            // Note that encodeURIComponent produces UTF-8 encoded text. The mime type should contain\n            // the charset=UTF-8 parameter. In case you don't want the data to be encoded as UTF-8\n            // you could use escape(data) instead.\n            window.open('data:' + mimetype + ',' + encodeURIComponent(data), '_blank', '');\n        };\n    }\n    // Internet Explorer before version 10 does not support any of the methods above.\n    // If it is text data you could show it in an textarea and tell the user to copy it into a text file.\n}\n\nwindow.fileSaveAs = new fSaveAs();\n\n\nfunction utf8() {\n    var intc, i;\n\n    //http://siphon9.net/loune/2009/10/javascript-snippet-to-convert-raw-utf8-to-unicode/\n    function TryGetCharUTF8(b, count) {\n        var c = b.charCodeAt(i);\n        /*\n         * 10000000 80\n         * 11000000 C0\n         * 11100000 E0\n         * 11110000 F0\n         * 11111000 F8\n         * 11111100 FC\n         * \n         * FEFF = 65279 = BOM\n         * \n         * string musicalbassclef = \"\" + (char)0xD834 + (char)0xDD1E; 119070 0x1D11E\n         */\n        if ((c & 0x80) === 0)\n            intc = c;\n        else {\n            if ((c & 0xE0) == 0xC0) {\n                intc = ((c & 0x1F) << 6) | ((b.charCodeAt(i + 1) & 0x3F));\n                i += 1;\n            }\n            else if ((c & 0xF0) == 0xE0) {\n                // 3 bytes Covers the rest of the BMP\n                //if (i+2 >= count) return false;\n                intc = ((c & 0xF) << 12) | ((b.charCodeAt(i + 1) & 0x3F) << 6) | ((b.charCodeAt(i + 2) & 0x3F));\n                //alert(c + ' '+b.charCodeAt(i + 1) +' '+b.charCodeAt(i + 2));\n                i += 2;\n            }\n            else if ((c & 0xF8) == 0xF0) {\n                intc = ((c & 0x7) << 18) | ((b.charCodeAt(i + 1) & 0x3F) << 12) | ((b.charCodeAt(i + 2) & 0x3F) << 6) | ((b.charCodeAt(i + 3) & 0x3F));\n                i += 1;\n            }\n            else\n                return false;\n        }\n        return true;\n    }\n\n    this.decode = function (s) {\n        var ss = new StringBuffer();\n        var sl = s.length;\n        for (i = 0; i < sl; i++) {\n            if (TryGetCharUTF8(s, sl))\n                ss.appendCode(intc);\n        }\n        return ss.toString();\n    };\n\n    this.decode2 = function (s) {\n        var ss = new StringBuffer();\n        var sl = s.length;\n        var i, c;\n        for (i = 0; i < sl; i++) {\n            c = s.charCodeAt(i);\n            if ((c & 0x80) !== 0) {\n                if ((c & 0xE0) == 0xC0) {\n                    c = ((c & 0x1F) << 6) | ((s.charCodeAt(i + 1) & 0x3F));\n                    i += 1;\n                }\n                else if ((c & 0xF0) == 0xE0) {\n                    c = ((c & 0xF) << 12) | ((s.charCodeAt(i + 1) & 0x3F) << 6) | ((s.charCodeAt(i + 2) & 0x3F));\n                    i += 2;\n                }\n                else if ((c & 0xF8) == 0xF0) {\n                    c = ((c & 0x7) << 18) | ((s.charCodeAt(i + 1) & 0x3F) << 12) | ((s.charCodeAt(i + 2) & 0x3F) << 6) | ((s.charCodeAt(i + 3) & 0x3F));\n                    i += 1;\n                }\n                else\n                    continue;\n            }\n            ss.appendCode(c);\n        }\n        return ss.toString();\n    };\n\n}\n\nwindow.UTF8 = new utf8();\n\nexport function printArray(data) {\n    if (data === null || typeof data == 'undefined') return data;\n    var dl, ba;\n    var idx = 0;\n    dl = data.byteLength;\n    ba = new StringBuffer();\n    for (; idx < dl; idx++) {\n        if (data[idx] < 32 || data[idx] >= 127)\n            ba.append('<' + data[idx] + '>');\n        else\n            ba.append(String.fromCharCode(data[idx]));\n    }\n    //save newly escaped string\n    return ba.toString();\n}\n\nexport function getScrollbarWidth() {\n\n    // Creating invisible container\n    const outer = document.createElement('div');\n    outer.style.visibility = 'hidden';\n    outer.style.overflow = 'scroll'; // forcing scrollbar to appear\n    (<any>outer.style).msOverflowStyle = 'scrollbar'; // needed for WinJS apps\n    document.body.appendChild(outer);\n\n    // Creating inner element and placing it in the container\n    const inner = document.createElement('div');\n    outer.appendChild(inner);\n\n    // Calculating difference between container's full width and the child width\n    const scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);\n\n    // Removing temporary elements from the DOM\n    outer.parentNode.removeChild(outer);\n\n    return scrollbarWidth;\n\n}\n\nexport function openFileDialog(title?: string, multiple?: boolean, accept?: string) {\n    return new Promise<FileList>((resolve, reject) => {\n        let dialog = document.createElement('dialog');\n        if (typeof dialog.showModal !== \"function\") {\n            reject(\"Browser does not support dialogs.\");\n            return;\n        }\n        dialog.id = 'openFileDialog';\n        dialog.style.zIndex = '2000';\n        dialog.style.height = '158px';\n        dialog.style.width = '350px';\n        dialog.innerHTML = `<div class=\"dialog-header\" style=\"font-weight: bold\"><button type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" onclick=\"document.getElementById('openFileDialog').close();\"></button><div>${title || 'Open file...'}</div></div><div class=\"dialog-body\"><div class=\"m-3\"><input class=\"form-control\" type=\"file\" id=\"openFileDialog-files\"${multiple ? ' multiple' : ''} required${accept && accept.length ? (' accept=\"' + accept + '\"') : ''}></div></div><div class=\"dialog-footer\"><button id=\"openFileDialog-cancel\" style=\"float: right\" type=\"button\" class=\"btn btn-default\" onclick=\"document.getElementById('openFileDialog').close();\">Cancel</button><button id=\"openFileDialog-ok\" style=\"float: right\" type=\"button\" class=\"btn btn-primary\">Ok</button></div>`;\n        document.body.appendChild(dialog);\n        //dialog.addEventListener('open', onOpen);\n        dialog.addEventListener('close', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('closed');\n        });\n        dialog.addEventListener('cancel', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('canceled');\n        });\n        document.getElementById('openFileDialog-ok').addEventListener('click', () => {\n            const input: HTMLInputElement = (<HTMLInputElement>document.getElementById('openFileDialog-files'));\n            if (!input.files || input.files.length === 0) {\n                input.classList.add('is-invalid')\n                return;\n            }\n            input.classList.remove('is-invalid');\n            dialog.close();\n            dialog.returnValue = 'files-ok';\n            resolve(input.files);\n        });\n        dialog.showModal();\n    });\n}\n\nexport function readFile(file, progress?) {\n    return new Promise((resolve, reject) => {\n        if (!file) reject(new Error('Invalid file'));\n        var reader = new FileReader();\n        reader.onerror = reject;\n        reader.onload = evt => {\n            resolve(evt.target.result);\n        };\n        reader.readAsText(file);\n        if (progress)\n            reader.onprogress = progress;\n    });\n}\n\nconst _timers = {};\nexport function debounce(mainFunction, delay, key?) {\n    key = key || 'default';\n    // Clear the previous timer to prevent the execution of 'mainFunction'\n    clearTimeout(_timers[key]);\n    // Set a new timer that will execute 'mainFunction' after the specified delay\n    _timers[key] = setTimeout(() => {\n        mainFunction();\n        delete _timers[key];\n    }, delay);\n}\n\nexport function markdownParser(text) {\n    const toHTML = text\n        .replace(/`(.*)`/gim, '<span class=\"markdown-code\" style=\"display: inline-block;background-color: #ececec\">$1</span>') // code block\n        .replace(/^---/gim, '<hr>')\n        .replace(/\\[(.*)\\]\\((.*)\\)/gim, '<a href=\"$2\">$1</a>')\n        .replace(/^##### (.*$)/gim, '<h5>$1</h5>') // h3 tag\n        .replace(/^##### (.*$)/gim, '<h5>$1</h5>') // h3 tag\n        .replace(/^#### (.*$)/gim, '<h4>$1</h4>') // h3 tag\n        .replace(/^### (.*$)/gim, '<h3>$1</h3>') // h3 tag\n        .replace(/^## (.*$)/gim, '<h2>$1</h2>') // h2 tag\n        .replace(/^# (.*$)/gim, '<h1>$1</h1>') // h1 tag\n        .replace(/\\*\\*(.*)\\*\\*/gim, '<b>$1</b>') // bold text\n        .replace(/\\*(.*)\\*/gim, '<i>$1</i>') // italic text\n        .replace(/_(.*)_/gim, '<i>$1</i>') // italic text\n        .replace(/\\\\$/gim, '$')\n        .replace(/\\\\{/gim, '\\\\');\n    return toHTML.trim(); // using trim method to remove whitespace\n}\n\nexport function scrollChildIntoView(parent, child) {\n    const childRect = child.getBoundingClientRect();\n    const parentRect = parent.getBoundingClientRect();\n\n    if (\n        childRect.top < parentRect.top ||\n        childRect.bottom > parentRect.bottom ||\n        childRect.left < parentRect.left ||\n        childRect.right > parentRect.right\n    ) {\n        child.scrollIntoView({\n            behavior: \"smooth\", // Optional for smooth scrolling\n            block: \"nearest\" // Scrolls to nearest edge of the parent\n        });\n    }\n}\n\nexport function getWordAtPosition(x, y) {\n    // Get the element at the specified coordinates\n    const element = document.elementFromPoint(x, y);\n\n    // Check if the element exists and contains text\n    if (element && element.textContent) {\n        // Get the text content of the element\n        const text = element.textContent;\n\n        // Find the word boundaries around the specified position\n        let start = text.lastIndexOf(' ', x) + 1;\n        let end = text.indexOf(' ', x);\n        if (end === -1) {\n            end = text.length;\n        }\n\n        // Extract the word\n        const word = text.substring(start, end);\n\n        return word;\n    }\n\n    return null;\n}", "// spell-checker:words TELOP, TERMINALTYPE, NEWENVIRON, Achaea, Webdings, ENDOFRECORD, USERVAR keepalive, DONT\nimport { EventEmitter } from './events';\nimport { StringBuffer, StringToUint8Array, ArrayBufferToString, printArray } from './library';\n\ndeclare global {\n    interface Window {\n        telnet: Telnet;\n    }\n}\n\ndeclare let UTF8;\nimport { Zlib } from './lib/inflate_stream.min.js';\n\nexport interface TelnetOption {\n    telnet: Telnet;\n    option: number;\n    verb: number;\n    value: string;\n    handled: boolean;\n}\n\nexport interface TelnetOptions {\n    MCCP: boolean;\n    MXP: boolean;\n    NAWS: boolean;\n    MSDP: boolean;\n    GMCP: boolean;\n    MSSP: boolean;\n    ECHO: boolean;\n    TTYPE: boolean;\n    EOR: boolean;\n    NEWENVIRON: boolean;\n    ZMP: boolean;\n    ATCP: boolean;\n    CHARSET: boolean;\n}\n\nexport interface TelnetOptionsServer {\n    MCCP1: boolean;\n    MCCP2: boolean;\n    MXP: boolean;\n    NAWS: boolean;\n    MSDP: boolean;\n    GMCP: boolean;\n    MSSP: boolean;\n    EOR: boolean;\n    NEWENVIRON: boolean;\n    ZMP: boolean;\n    ATCP: boolean;\n    CHARSET: boolean;\n}\n\n/**\n * A telnet base telnet object to create a connection to a host:port and handle\n * the base telnet protocol. In addition to the base protocol it also handles MCCP 1 & 2,\n * NAWS, MXP, GMCP, MSSP, CHARSET for UTF-8. To support MCCP it requires the module {@link module:src/lib/zlib-inflate}.\n *\n * @author Icewolfz\n * @copyright Icewolfz 2013\n * @class Telnet\n * @extends {EventEmitter}\n * @version 2.0\n * @requires module:src/lib/zlib-inflate\n * @namespace Telnet\n * @constructor\n * @param {Object} options\t\t\t\t- The options to start off with\n * @param {Object} options.host\t\t\t- The host to connect to\n * @param {Object} options.port\t\t\t- The port to connect to\n *\n * @todo add ZMP support\n * @todo add ENVIRON/NEWENVIRON exactly the same, but for var/value reversed, and there are rules to detect this so just treat ENVIRON as NEWENVIRON\n * @todo add ATCP support similar to GMCP\n * @todo add MSDP table/array support\n * @todo add MCP (Mud client protocol) - encodes protocol in text that is processed out and separates into an in bound (normal text), and out of bound (protocol data) see http://www.moo.mud.org/mcp/\n * @todo add CHARSET ttable support\n * \n * @property {Object}  options\t\t\t\t\t\t- The telnet options to enable or disable\n * @property {Boolean} [options.ECHO=1]\t\t\t\t- Enable/disable Echo (1)\n * @property {Boolean} [options.TTYPE=1]\t\t\t- Enable/disable Terminal Type - Does MTTS (http://tintin.sourceforge.net/mtts/) (TTYPE) (24)\n * @property {Boolean} [options.EOR=1]\t\t\t\t- Enable/disable End of record (EOR) (25/239)\n * @property {Boolean} [options.NAWS=1]\t\t\t\t- Enable/disable Negotiate About Window Size (NAWS) (31)\n * @property {Boolean} [options.NEWENVIRON=0]\t    - Enable/disable Environment Option (36/39)\n * @property {Boolean} [options.MSDP=1]\t\t\t\t- Enable/disable Mud Server Data Protocol (MSDP) (69)\n * @property {Boolean} [options.MSSP=0]\t\t\t\t- Enable/disable Mud Server Status Protocol (MSSP) (70)\n * @property {Boolean} [options.MCCP=1]\t\t\t\t- Enable/disable MUD Compression Protocol (MCCP) (85/86)\n * @property {Boolean} [options.MXP=1]\t\t\t\t- Enable/disable MUD eXtension Protocol  (MXP) (91)\n * @property {Boolean} [options.ZMP=0]\t\t\t\t- Enable/disable Zenith MUD Protocol (ZMP) (93)\n * @property {Boolean} [options.GMCP=1]\t\t\t\t- Enable/disable Generic Mud Communication Protocol/ATCP2 protocol (GMCP) (201)\n * @property {Boolean} [options.ATCP=0]\t\t\t\t- Enable/disable Achaea Telnet Client Protocol (ATCP) (200)\n * @property {Boolean} [options.CHARSET=1]\t\t    - Enable/disable CHARSET enabled, and which type, 1 is UTF-8\n * @property {Object}  server\t\t\t\t\t\t- The telnet options the server has enabled or disabled\n * @property {Boolean} [server.NAWS=0]\t\t\t\t- Is NAWS enabled\n * @property {Boolean} [server.MSDP=0]\t\t\t\t- Is MSDP enabled\n * @property {Boolean} [server.GMCP=0]\t\t\t\t- Is GMCP enabled\n * @property {Boolean} [server.MXP=0]\t\t\t\t- Is MXP enabled\n * @property {Boolean} [server.MCCP1=0]\t\t\t\t- Is MCCP1 enabled\n * @property {Boolean} [server.MCCP2=0]\t\t\t\t- Is MCCP2 enabled\n * @property {Boolean} [server.MSSP=0]\t\t\t\t- Is MSSP enabled\n * @property {Boolean} [server.NEWENVIRON=0]\t    - Is NEWENVIRON enabled\n * @property {Boolean} [server.ZMP=0]\t\t\t\t- Is ZMP enabled\n * @property {Boolean} [server.EOR=0]\t\t\t\t- Is EOR enabled\n * @property {Boolean} [server.ATCP=0]\t\t\t\t- Is ATCP enabled\n * @property {Boolean} [server.CHARSET=0]\t\t\t- Is CHARSET enabled, and which type, 1 is UTF-8\n * @property {String}  host\t\t\t\t\t\t\t- The host, may include ws://, wss://, http://, or https://, if not supplied uses set scheme\n * @property {Number}  port\t\t\t\t\t\t\t- The port, if set to < 1 it will use host only\n * @property {Boolean} [prompt=false]\t\t\t\t- The prompt state to determine if current end of line is a prompt or not\n * @property {Boolean} [echo=true]\t\t\t\t\t- The echo state to determine if you should echo text to the screen\n * @property {Boolean} [firstSent=true]\t\t\t\t- Weather anything has been sent yet, excluding telnet options\n * @property {Boolean} [firstReceived=true]\t\t    - Weather anything has been received yet, excluding telnet options\n * @property {String}  version\t\t\t\t\t\t- The version of the client to send for GMCP Core.Hello\n * @property {String}  [terminal=ansi]\t\t\t\t- The terminal type to send the first time for TTYPE\n * @property {Boolean} [UTF8=true]\t\t\t\t\t- Force process data after telnet options as UTF8 character\n * @property {Object}  [MSSP={}]\t\t\t\t\t- MSSP object that contains all variables and their assigned values.\n * @property {Object}  [socket=null]\t\t\t\t- The websocket object\n * @property {Number}  [latency=0]\t\t\t\t\t- The milliseconds between the last send and the current received data\n * @property {Boolean} [enableLatency=false]\t    - Attempt to calculate the latency between a send/receive, and if sent on receive send a GMCP ping back and attempt to get latency of a connection\n * @property {Number}  [latencyAvg=0]\t\t\t\t- The average milliseconds between the last send and the current received data\n * @property {Number}  [enablePing=false]\t\t\t- Enable GMCP ping back to better track latency\n * @property {Array}   GMCPSupports\t\t\t\t\t- An array of supported GMCP modules for mat of \"Modulate 0|1\", defaults are \"Core 1\", \"Char 1\", \"Char.Vitals 1\", \"Char.Experience 1\"\n * @property {string}  scheme                       - The websocket scheme to use, ws://, wss://, http://, or https:// must include the ://\n * @property {string}  protocol                     - The websocket protocol to use, defaults to binary\n */\nexport class Telnet extends EventEmitter {\n    private _splitBuffer: number[] = [];\n    private _connected: boolean = false;\n    private _MTTS: number = 0;\n    private zStream: any = 0;\n    private _latencyTime: Date = null;\n    private _doPing: boolean = false;\n    private _closed: boolean = true;\n    private _zlib: boolean = false;\n\n    public options: TelnetOptions = { MCCP: true, MXP: true, NAWS: true, MSDP: true, GMCP: true, MSSP: false, ECHO: true, TTYPE: true, EOR: true, NEWENVIRON: false, ZMP: false, ATCP: false, CHARSET: true };\n    public host: string = '';\n    public port: number = 23;\n    public prompt: boolean = false;\n    public echo: boolean = true;\n    public firstSent: boolean = true;\n    public firstReceived: boolean = true;\n    public server: TelnetOptionsServer = { NAWS: false, MSDP: false, GMCP: false, MXP: false, MCCP1: false, MCCP2: false, MSSP: false, NEWENVIRON: false, ZMP: false, EOR: false, ATCP: false, CHARSET: false };\n    public version: string = '2.0';\n    public terminal: string = 'ansi';\n    public UTF8: boolean = true;\n    public MSSP = {};\n    public socket: WebSocket = null;\n    public latency: number = 0;\n    public latencyAvg: number = null;\n    public enableLatency: boolean = false;\n    public enablePing: boolean = false;\n    public GMCPSupports: string[] = ['Core 1', 'Char 1', 'Char.Vitals 1', 'Char.Experience 1'];\n    public enableDebug: boolean = false;\n    public scheme: string = 'ws://';\n    public protocol: string = 'binary';\n\n    /**\n     * Creates an instance of Telnet.\n     *\n     * @param {any} options a list of options to set\n     *\n     * @memberOf Telnet\n     */\n    constructor(options?: TelnetOptions | any) {\n        super();\n        if (options) {\n            if ('host' in options) {\n                if (options.host && options.host.length)\n                    this.host = options.host;\n                delete options.host;\n            }\n            if ('port' in options) {\n                this.port = options.port;\n                delete options.port;\n            }\n            if ('scheme' in options) {\n                if (options.scheme && options.scheme.length)\n                    this.scheme = options.scheme;\n                delete options.scheme;\n            }\n            if ('protocol' in options) {\n                if (options.protocol && options.protocol.length)\n                    this.protocol = options.protocol;\n                delete options.protocol;\n            }\n        }\n        this.options = Object.assign(this.options, options || {});\n    }\n\n    /**\n     * @name connected\n     * @desc determine if connected to host\n     * @returns {Boolean} weather connected to host or not\n     *\n     * @readonly\n     *\n     * @memberOf Telnet\n     */\n    get connected(): boolean {\n        if (!this.socket || typeof this.socket === 'undefined')\n            return false;\n        return this._connected;\n    }\n\n    /**\n         * @name Telnet#reset\n         * @desc reset state in preparation for a connect\n         */\n    public reset() {\n        this._MTTS = 0;\n        this.firstSent = true;\n        this.firstReceived = true;\n        this.prompt = false;\n        this.echo = true;\n        this.server = { NAWS: false, MSDP: false, GMCP: false, MXP: false, MCCP1: false, MCCP2: false, MSSP: false, EOR: false, NEWENVIRON: false, ATCP: false, CHARSET: false, ZMP: false };\n        this._splitBuffer = [];\n        this._endMCCP();\n        this._connected = false;\n        this._closed = false;\n        if (this.enableDebug)\n            this.emit('debug', 'Reset');\n    }\n\n    /**\n     * @name connect\n     * @desc connect to target host\n     *\n     * @fires Telnet#connecting\n     */\n    public connect() {\n        this._destroySocket();\n        this.reset();\n        this.emit('connecting');\n        this.socket = this._createSocket(this.host, this.port);\n        if (this.enableDebug)\n            this.emit('debug', 'Connecting to ' + this.host + ':' + this.port);\n    }\n\n    /**\n     * @name Telnet#close\n     * @desc close the connection ot host and reset state in preparation for next connection\n     *\n     * @fires Telnet#close\n     */\n    public close() {\n        if (this._closed) return;\n        this._destroySocket();\n        this.reset();\n        this.emit('close');\n        this._closed = true;\n        if (this.enableDebug)\n            this.emit('debug', 'Closed');\n    }\n\n    /**\n     * @name Telnet#receivedData\n     * @desc data that is received from the host to be processed\n     *\n     * @param {String} data string received from host\n     * @fires Telnet#received-data\n     */\n    public receivedData(data: Uint8Array, skipDecompress?: boolean, prependSplit?: boolean) {\n        if (this.enableLatency) {\n            if (this._latencyTime !== null) {\n                this.latency = new Date().getTime() - this._latencyTime.getTime();\n                if (this.latencyAvg == null)\n                    this.latencyAvg = this.latency;\n                else\n                    this.latencyAvg = (this.latency + this.latencyAvg) / 2;\n                this._latencyTime = null;\n                this._doPing = false;\n                this.emit('latency-changed', this.latency, this.latencyAvg);\n            }\n            else if (!this._doPing && this.enablePing)\n                this._doPing = true;\n            else {\n                this._latencyTime = null;\n                this._doPing = false;\n            }\n        }\n        if (this.enableDebug)\n            this.emit('debug', 'PreProcess:' + data, 1);\n        data = this.processData(data, skipDecompress, false, prependSplit);\n        if (this.enableDebug)\n            this.emit('debug', 'PostProcess:' + data, 1);\n        this.emit('received-data', data);\n        if (this.enableLatency) {\n            //split packet more then likely so reset timer for next part\n            if (this._splitBuffer.length > 0) {\n                if (this.enablePing) this._doPing = true;\n                this._latencyTime = null;\n            }\n            //gmcp ping, send after process to have a more accurate time\n            else if (this._doPing && this.enablePing) {\n                setTimeout(() => {\n                    this._latencyTime = new Date();\n                    this.sendGMCP('Core.Ping ' + this.latencyAvg);\n                });\n            }\n            else\n                this._doPing = false;\n        }\n    }\n\n    /**\n     * @name Telnet#sendTerminal\n     * @desc Send terminal type telnet option to mud to identify the terminal\n     */\n    public sendTerminal() {\n        if (this.enableDebug) {\n            if (this._MTTS === 0)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>' + this.terminal + '<IAC><SE>');\n            else if (this._MTTS === 1)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>ANSI-256COLOR<IAC><SE>');\n            else if (this._MTTS >= 2)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>MTTS 9<IAC><SE>');\n        }\n        if (this._MTTS === 0) {\n            var tmp = new Uint8Array(6 + this.terminal.length);\n            tmp.set([255, 250, 24, 0], 0);\n            tmp.set(StringToUint8Array(this.terminal), 4);\n            tmp.set([255, 240], 4 + this.terminal.length);\n            this.sendData(tmp, true);\n        }\n        else if (this._MTTS === 1)\n            this.sendData([255, 250, 24, 0, 65, 78, 83, 73, 45, 50, 53, 54, 67, 79, 76, 79, 82, 255, 240], true);\n        else if (this._MTTS >= 2)\n            this.sendData([255, 250, 24, 0, 77, 84, 84, 83, 32, 57, 255, 240], true);\n    }\n\n    /**\n     * @name Telnet#sendData\n     * @desc Send data to the host\n     *\n     * @param {String} data string to send\n     * @param {Boolean} raw send raw unescaped telnet data to host, other wise it will escape the IAC for proper telnet\n     * @fires Telnet#data-sent\n     */\n    public sendData(data: any, raw?: boolean) {\n        if (data == null || typeof data === 'undefined' || data.length === 0)\n            return;\n        if (this.connected) {\n            try {\n                if (!raw) {\n                    //goAhead ended\n                    this.prompt = false;\n                    //if not an option and need to ensure proper escaping of IAC\n                    data = this._escapeData(data);\n                    if (this.enableLatency) this._latencyTime = new Date();\n                }\n                if (this.socket !== null) {\n                    if (data instanceof Uint8Array) {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataU8:' + printArray(data));\n                        this.socket.send(data);\n                    }\n                    else if (Array.isArray(data)) {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataBA' + printArray(new Uint8Array(data)));\n                        this.socket.send(new Uint8Array(data));\n                    }\n                    else {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataR:' + printArray(StringToUint8Array(data)));\n                        this.socket.send(data);\n                    }\n                    if (!raw) this.firstSent = false;\n                }\n\n            }\n            catch (e) {\n                this.emit('error', e);\n            }\n        }\n        else if (this.enableLatency)\n            this._latencyTime = null;\n        this.emit('data-sent', data, raw);\n    }\n\n    /**\n     * @name Telnet#processData\n     * @desc Process raw incoming data\n     *\n     * @param {string} data The data to process\n     * @returns {string} The results of the processed data\n     * @fires Telnet#receive-option\n     * @fires Telnet#receive-MSDP\n     * @fires Telnet#receive-GMCP\n     * @fires Telnet#receive-MSSP\n     * @fires Telnet#receive-NEWENVIRON\n     * @fires Telnet#receive-CHARSET\n     */\n    //this.processData = function(data) { return data; };\n    public processData(data: Uint8Array, skipDecompress?: boolean, returnRaw?: boolean, prependSplit?: boolean) {\n        let len: number;\n        let tmp: (string | boolean | Uint8Array) = '';\n        let _sb;\n        if (data == null)\n            return data;\n        if (!skipDecompress)\n            data = this._decompressData(data);\n        len = data.byteLength;\n        if (len === 0)\n            return data;\n        _sb = this._splitBuffer;\n        if (_sb.length > 0) {\n            if (this.enableDebug) this.emit('debug', 'Split buffer length: ' + _sb.length, 1);\n            tmp = new Uint8Array(len + _sb.length);\n            if (prependSplit) {\n                tmp.set(data, 0);\n                tmp.set(_sb, data.byteLength);\n            }\n            else {\n                tmp.set(_sb, 0);\n                tmp.set(data, _sb.length);\n            }\n            data = tmp;\n            _sb = [];\n            len = data.byteLength;\n        }\n        let state: number = 0;\n        let pState: number = 0;\n        let processed: StringBuffer = new StringBuffer();\n\n        const ga: boolean = this.prompt;\n        let verb: number = 0;\n        let option: number = 0;\n        let msdp_val: string = '';\n        let msdp_var: string = '';\n        let _MSSP;\n        let i: number = 0;\n        let ne: number;\n        let idx: number = 0;\n        tmp = '';\n        //reset for new state\n        this.prompt = false;\n        let debugOp = '';\n        try {\n            for (; idx < len; idx++) {\n                i = data[idx];\n                switch (state) {\n                    case 0:\n                        // If the current byte is the \"Interpret as Command\" code, set the state to 1.\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp = 'TELOP: <IAC>';\n                            //store in case it is split;\n                            _sb.push(i);\n                            state = 1;\n                        }\n                        else if (this.UTF8 || (this.options.CHARSET && this.server.CHARSET)) {\n                            //If current byte has first bit on unicode\n                            if ((i & 0x80) === 0x80 && idx >= len - 4) {\n                                let uLen = 0;\n                                //Get byte count based on bits turned on\n                                if ((i & 0xC0) === 0xC0)\n                                    uLen = 1;\n                                else if ((i & 0xE0) === 0xE0)\n                                    uLen = 2;\n                                else if ((i & 0xF0) === 0xF0)\n                                    uLen = 3;\n                                //if idx + length larger then current length, good chance the unicode character is split so store and end process\n                                if (idx + uLen >= len) {\n                                    _sb.push(...data.slice(idx));\n                                    if (this.enableDebug) {\n                                        this.emit('debug', 'Unicode split length: ' + uLen, 1);\n                                        this.emit('debug', 'Split buffer length: ' + _sb.length, 1);\n                                    }\n                                    break;\n                                }\n                                /**\n                                 * https://stackoverflow.com/questions/22404493/is-there-a-drastic-difference-between-utf-8-and-utf-16/22404874\n                                    0xxxxxxx // 1 byte\n                                    110xxxxx 10xxxxxx //2 bytes  0xC0\n                                    1110xxxx 10xxxxxx 10xxxxxx //3 bytes 0xE0\n                                    11110xxx 10xxxxxx 10xxxxxx 10xxxxxx //4 bytes 0xF0\n                                 */\n                            }\n                            processed.appendCode(i);\n                        }\n                        else\n                            processed.appendCode(i);\n                        break;\n                    case 1: // Telnet Option\n                        if (i === 255) //escaped\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<IAC>');\n                                debugOp = '';\n                            }\n                            processed.appendCode(i);\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if ((!this.options.EOR || !this.server.EOR) && i === 239) //EOR, if not enabled treat as NOP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 241 || i === 130) //no operation, just continue on\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 249 || i === 239) //EOR | GA\n                        {\n                            if (this.enableDebug) {\n                                if (i === 239)\n                                    this.emit('debug', debugOp + '<EOR>');\n                                else\n                                    this.emit('debug', debugOp + '<GA>');\n                                debugOp = '';\n                            }\n                            //more data to read, so ga means nothing but a new line\n                            if (idx + 1 < len && len - idx > 2) {\n                                processed.push('\\n');\n                                this.prompt = false;\n                            }\n                            else\n                                this.prompt = true;\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 253 || i === 254 || i === 251 || i === 252) //WILL DONT WONT DO\n                        {\n                            if (this.enableDebug) {\n                                switch (i) {\n                                    case 253: debugOp += '<DO>'; break;\n                                    case 254: debugOp += '<DONT>'; break;\n                                    case 251: debugOp += '<WILL>'; break;\n                                    case 252: debugOp += '<WONT>'; break;\n                                }\n                            }\n                            //store in case it is split;\n                            _sb.push(i);\n                            verb = i;\n                            state = 2;\n                        }\n                        else if (i === 250) // Sub negotiation\n                        {\n                            if (this.enableDebug) debugOp += '<SB>';\n                            _sb.push(i);\n                            state = 3;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb = [];\n                            state = 0;\n                        }\n                        break;\n                    case 2: //WILL DONT WONT DO response\n                        if (i === 1) // ECHO\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<ECHO>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                if (this.options.ECHO) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><ECHO>');\n                                    this.replyToOption(i, 251, verb);\n                                    this.echo = false;\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                    this.echo = true;\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><ECHO>');\n                                this.replyToOption(i, 252, verb);\n                                this.echo = true;\n                            }\n                            else if (verb === 251) {\n                                if (this.options.ECHO) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><ECHO>');\n                                    this.replyToOption(i, 253, verb);\n                                    this.echo = false;\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                    this.echo = true;\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                this.echo = true;\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 24) // TERMINALTYPE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<TERMINALTYPE>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                if (this.options.TTYPE) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><TERMINALTYPE>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><TERMINALTYPE>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                if (this.options.TTYPE) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><TERMINALTYPE>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 25) // END OF RECORD\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<ENDOFRECORD>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.EOR = true;\n                                if (this.options.EOR) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><ENDOFRECORD>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><ENDOFRECORD>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.EOR = true;\n                                if (this.options.EOR) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><ENDOFRECORD>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 31) // NAWS\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NAWS>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.NAWS = true;\n                                if (this.options.NAWS) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><NAWS>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.NAWS = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><NAWS>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.NAWS = true;\n                                if (this.options.NAWS) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><NAWS>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.NAWS = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            this.emit('windowSize');\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 36 || i === 39) // NEWENVIRON\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NEWENVIRON>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.NEWENVIRON = true;\n                                if (this.options.NEWENVIRON) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><NEWENVIRON>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><NEWENVIRON>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.NEWENVIRON = true;\n                                if (this.options.NEWENVIRON) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><NEWENVIRON>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 69) // MSDP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MSDP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MSDP = true;\n                                if (this.options.MSDP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MSDP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MSDP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MSDP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MSDP = true;\n                                if (this.options.MSDP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MSDP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MSDP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 70) // MSSP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MSSP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MSSP = true;\n                                if (this.options.MSSP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MSSP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MSSP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MSSP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MSSP = true;\n                                if (this.options.MSSP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MSSP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MSSP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 85) // MCCP1\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MCCP1>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MCCP1 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MCCP1>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MCCP1 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MCCP1>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MCCP1 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MCCP1>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MCCP1 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 86) // MCCP2\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MCCP2>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MCCP2 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MCCP2>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MCCP2 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MCCP2>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MCCP2 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MCCP2>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MCCP2 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 91) // MXP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MXP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MXP = true;\n                                if (this.options.MXP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MXP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MXP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MXP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MXP = true;\n                                if (this.options.MXP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MXP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MXP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 130 || i === 241) // NOP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            this._fireReceiveOption(i, verb, '');\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 201) //GMCP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<GMCP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.GMCP = true;\n                                if (this.options.GMCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><GMCP>');\n                                    this.replyToOption(i, 251, verb);\n                                    this._startGMCP();\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.GMCP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><GMCP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.GMCP = true;\n                                if (this.options.GMCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><GMCP>');\n                                    this.replyToOption(i, 253, verb);\n                                    this._startGMCP();\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.GMCP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 42) //CHARSET\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<CHARSET>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.CHARSET = true;\n                                if (this.options.CHARSET) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><CHARSET>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.CHARSET = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><CHARSET>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.CHARSET = true;\n                                if (this.options.CHARSET) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><CHARSET>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.CHARSET = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else // Blindly reject the option.\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + this._formatByte(i));\n                                debugOp = '';\n                            }\n                            if (verb === 251 || verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><' + i + '>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            else if (verb === 254 || verb === 253) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><' + i + '>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        break;\n                    case 3: // Sub negotiation\n                        option = i;\n                        if (i === 24) // TERMINALTYPE\n                        {\n                            if (this.enableDebug) debugOp += '<TERMINALTYPE>';\n                            _sb.push(i);\n                            option = i;\n                            state = 4;\n                        }\n                        else if (i === 36 || i === 39) // NEWENVIRON\n                        {\n                            if (this.enableDebug) debugOp += '<NEWENVIRON>';\n                            _sb.push(i);\n                            option = i;\n                            state = 12;\n                            ne = -1;\n                        }\n                        else if (i === 69) // MSDP\n                        {\n                            if (this.enableDebug) debugOp += '<MSDP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 4;\n                        }\n                        else if (i === 70) // MSSP\n                        {\n                            if (this.enableDebug) debugOp += '<MSSP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 8;\n                            _MSSP = {};\n                        }\n                        else if (i === 85 || i === 86) // MCCP1 & MCCP2\n                        {\n                            if (this.enableDebug) debugOp += i === 85 ? '<MCCP1>' : '<MCCP2>';\n                            _sb.push(i);\n                            option = i;\n                            state = 11;\n                        }\n                        else if (i === 201) {\n                            if (this.enableDebug) debugOp += '<GMCP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 7;\n                        }\n                        //IAC SB MXP IAC SE - this tells the client that from now on we are sending MXP sequences.\n                        //http://www.mushclient.com/mushclient/addingservermxp.htm\n                        //Not sure what to reply once you receive this from a sever\n                        //else if(i === 91)\n                        //{\n                        //}\n                        else if (i === 240) // SE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 42) //CHARSET\n                        {\n                            if (this.enableDebug) debugOp += '<CHARSET>';\n                            _sb.push(i);\n                            option = i;\n                            state = 17;\n                            msdp_val = '';\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 4: //MSDP negotiation\n                        if (option === 24 && i === 1) // TERMINALTYPE SEND\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            verb = 1;\n                        }\n                        else if (i === 240) // SE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            if (option === 24 && verb === 1) // TERMINALTYPE\n                            {\n                                tmp = false;\n                                this._fireReceiveOption(option, 250, '');\n                                if (!tmp) {\n                                    this.sendTerminal(); //sending it once doesn't seem to work, sending it a 2nd time seems to register it correctly\n                                    this.sendTerminal();\n                                    this._MTTS++;\n                                }\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (option === 69 && i === 1) // MSDP\n                        {\n                            if (this.enableDebug) debugOp += '<MSDP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 5;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 5: // MSDP Variable\n                        if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSDP_VAL>';\n                            _sb.push(i);\n                            msdp_val = '';\n                            state = 6;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 6: // MSDP Value\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSDP_VAR>';\n                            this._fireReceiveMSDP(msdp_var, msdp_val);\n                            msdp_val = '';\n                            msdp_var = '';\n                            _sb.push(i);\n                            state = 5;\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveMSDP(msdp_var, msdp_val);\n                            msdp_val = '';\n                            msdp_var = '';\n                            state = 0;\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 7: // GMCP Sub Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveGMCP(msdp_val);\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 8: // MSSP Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                this.emit('debug', this.MSSP);\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this.emit('receive-MSSP', _MSSP);\n                            msdp_val = '';\n                            msdp_var = '';\n                            _MSSP = 0;\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 9;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 9: // MSSP Variable\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                            state = 8;\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                        }\n                        else if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAL>';\n                            _sb.push(i);\n                            this.MSSP[msdp_var] = '';\n                            _MSSP[msdp_var] = '';\n                            state = 10;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 10: // MSSP Value\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                            state = 8;\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 9;\n                        }\n                        else if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAL>';\n                            _sb.push(i);\n                            this.MSSP[msdp_var] = '';\n                            _MSSP[msdp_var] = '';\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            this.MSSP[msdp_var] += String.fromCharCode(i);\n                            _MSSP[msdp_var] += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 11: // MCCP Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            this._fireReceiveOption(option, 86, '');\n                            this._startMCCP();\n                            state = 0;\n                            _sb = [];\n                            if (idx < len - 1)\n                                processed.append(this.processData(data.subarray(idx + 1), skipDecompress, true));\n                            idx = len;\n                        }\n                        break;\n                    case 12: // NEWENVIRON Sub sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveGMCP(msdp_val);\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else if (i === 0) // IS\n                        {\n                            if (this.enableDebug) debugOp += '<IS>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 1) // SEND\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 2) // INFO\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 13: // NEWENVIRON\n                        if (i === 0) //var\n                        {\n                            if (this.enableDebug) debugOp += '<VAR>';\n                            _sb.push(i);\n                            state = 14;\n                            verb = i;\n                            msdp_var = '';\n                            if (ne === -1) ne = 0;\n                        }\n                        else if (i === 1) //value\n                        {\n                            if (this.enableDebug) debugOp += '<VALUE>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                            if (ne === -1) ne = 1;\n                        }\n                        else if (i === 3) //user var\n                        {\n                            if (this.enableDebug) debugOp += '<USERVAR>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            tmp = this._fireReceiveOption(option, 250, tmp);\n                            this.emit('receive-NEWENVIRON', msdp_val);\n                            //custom handled so don't do defaults\n                            if (!tmp) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><NEWENVIRON><IS><IAC><SE>');\n                                this.sendData(new Uint8Array([255, 250]), true);\n                                this.sendData(option, true);\n                                this.sendData(new Uint8Array([0, 255, 240]), true);\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 14:  // NEWENVIRON Var\n                        if (i === 2) //escape\n                        {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                            state = 15;\n                            pState = 14;\n                        }\n                        else if (i === 255 || i <= 3) {\n                            idx--;\n                            state = 13;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 15:\n                        if (this.enableDebug) debugOp += this._formatByte(i);\n                        if (pState === 16)\n                            msdp_val += String.fromCharCode(i);\n                        else\n                            msdp_var += String.fromCharCode(i);\n                        state = pState;\n                        _sb.push(i);\n                        break;\n                    case 16:\n                        break;\n                    case 17: //CHARSET\n                        if (i === 1) //REQUEST\n                        {\n                            if (this.enableDebug) debugOp += '<REQUEST>';\n                            _sb.push(i);\n                            state = 18;\n                            msdp_val = '';\n                        }\n                        //TODO add ttable support\n                        //https://www.rfc-editor.org/rfc/rfc2066.html\n                        else if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = this._fireReceiveOption(option, 250, msdp_val);\n                            this.emit('receive-CHARSET', msdp_val);\n                            if (!tmp) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><CHARSET><REJECTED><IAC><SE>');\n                                this.sendData(new Uint8Array([255, 250, 42, 3, 255, 240]), true);\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 18: //CHARSET REQUEST\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = this._fireReceiveOption(option, 250, msdp_val);\n                            this.emit('receive-CHARSET', msdp_val.slice(1));\n                            if (!tmp) {\n                                if (this.options.CHARSET && msdp_val.slice(1).toLowerCase() === 'utf-8') {\n                                    this.server.CHARSET = true;\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><ACCEPTED>UTF-8<IAC><SE>');\n                                    this.sendData(new Uint8Array([255, 250, 42, 2]), true);\n                                    this.sendData('UTF-8', true);\n                                    this.sendData(new Uint8Array([255, 240]), true);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><CHARSET><REJECTED><IAC><SE>');\n                                    this.sendData(new Uint8Array([255, 250, 42, 3, 255, 240]), true);\n                                }\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                }\n            }\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        if (this.enableDebug) {\n            {\n                if (debugOp.length > 0)\n                    this.emit('debug', debugOp);\n            }\n            this.emit('debug', 'Post Split buffer length: ' + _sb.length, 1);\n            this.emit('debug', 'PostSplit buffer  ' + printArray(new Uint8Array(_sb)), 1);\n        }\n        //if processed and was prev goAhead, it needs to starts a new line to correctly end goAhead\n        if (ga && processed.length > 0)\n            processed.prepend('\\n');\n        else if (ga)  //go ahead wasn't effected and if prev true, so reset back to true\n            this.prompt = true;\n        if (processed.length > 0)\n            this.firstReceived = false;\n        this._splitBuffer = _sb;\n        if (returnRaw)\n            return processed;\n        //force UTF8 or if charset is enabled and type is UTF8 process data as UTF8 data\n        if (this.UTF8 || (this.options.CHARSET && this.server.CHARSET))\n            return UTF8.decode2(processed.toString());\n        return processed.toString();\n    }\n\n    /**\n     * @name Telnet#replyToOption\n     * @desc Replay to a telnet option\n     *\n     * @param {Number} op The telnet option code\n     * @param {Number} verb The telnet verb to reply with\n     * @param {Number} reply The telnet verb your reply from\n     * @param {String|undefined} val The value if the option has one\n     * @return boolean returns if the reply was handled or not\n     * @fires Telnet#receive-option\n     */\n    public replyToOption(op: number, verb: number, reply: number, val?: string): boolean {\n        if (typeof val === 'undefined') val = '';\n        if (this._fireReceiveOption(op, reply, val))\n            return false;\n        this.sendData(new Uint8Array([255, verb, op]), true);\n        return true;\n    }\n\n    /**\n     * @name Telnet#updateWindow\n     * @desc Send a NAWS Window update\n     *\n     * @param {Number} w The current width in lines of the window\n     * @param {Number} h The current height in characters of the window\n     */\n    public updateWindow(w, h) {\n        if (h < 1 || w < 1 || !this.connected || !this.server.NAWS) return;\n        try {\n            let w1;\n            let w2;\n            let h1;\n            let h2;\n            const mf = Math.floor;\n            w1 = mf(w / 256);\n            if (w1 > 256)\n                w1 = 255;\n            w2 = w % 256;\n            h1 = mf(h / 256);\n            if (h1 > 256)\n                h1 = 255;\n            h2 = h % 256;\n            if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><NAWS><' + w1 + '><' + w2 + '><' + h1 + '><' + h2 + '><IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 31, w1, w2, h1, h2, 255, 240]), true);\n        }\n        catch (e) {\n            this.emit('error', { message: 'UpdateWindow Error: ' + e, err: e });\n        }\n    }\n\n    /**\n     * @name Telnet#sendGMCP\n     * @desc Send a GMCP formatted string\n     *\n     * @param {String} str The GMCP formatted string to send to the host\n     */\n    public sendGMCP(str) {\n        if (this.connected && this.server.GMCP) {\n            if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><GMCP>' + this._escapeData(str).toString('binary') + '<IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n            this.sendData(this._escapeData(str), true);\n            this.sendData(new Uint8Array([255, 240]), true);\n        }\n    }\n\n    /**\n     * @name Telnet#startGMCP\n     * @desc Start GMCP and send Core.Hello and Core.Support.Set\n     */\n    private _startGMCP() {\n        if (this.server.GMCP) {\n            if (this.enableDebug)\n                this.emit('debug', 'REPLY: <IAC><SB><GMCP>Core.Hello { \"client\": \"' + this.terminal + '\", \"version\": \"' + this.version + '\" }<IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n            this.sendData('Core.Hello { \"client\": \"' + this.terminal + '\", \"version\": \"' + this.version + '\" }', true);\n            this.sendData(new Uint8Array([255, 240]), true);\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n\n            if (this.GMCPSupports.length > 0) {\n                //ensure we at least support core module\n                if (this.GMCPSupports.indexOf('Core 1') === -1)\n                    this.GMCPSupports.unshift('Core 1');\n                if (this.enableDebug)\n                    this.emit('debug', 'REPLY: <IAC><SB><GMCP>' + JSON.stringify(this.GMCPSupports) + '<IAC><SE>');\n                this.sendData('Core.Supports.Set ' + JSON.stringify(this.GMCPSupports));\n            }\n            else {\n                if (this.enableDebug)\n                    this.emit('debug', 'REPLY: <IAC><SB><GMCP>Core.Supports.Set [ \"Core 1\" ]<IAC><SE>');\n                this.sendData('Core.Supports.Set [ \"Core 1\" ]', true);\n            }\n            this.sendData(new Uint8Array([255, 240]), true);\n        }\n    }\n\n    /**\n     * @name Telnet#startMCCP\n     * @desc Start MCCP compression protocol and set compress state on\n     */\n    private _startMCCP() {\n        this._zlib = true;\n    }\n\n    /**\n     * @name Telnet#endMCCP\n     * @desc End MCCP compression protocol and set compress state off\n     */\n    private _endMCCP() {\n        this._zlib = false;\n        this.zStream = 0;\n    }\n\n    /**\n     * @name Telnet#decompressData\n     * @desc Decompresses a ZLIB stream if ZLIB is present and compress state is on\n     *\n     * @param {String} data The compressed data string\n     * @returns {String} The decompressed data or the original data i ZLIB is not found or compress state is off\n     */\n    private _decompressData(data) {\n        if (!this._zlib) return data;\n        if (!this.zStream)\n            this.zStream = new Zlib.InflateStream();\n        if (this.enableDebug) this.emit('debug', 'Pre decompress:' + printArray(data), 1);\n        data = this.zStream.decompress(data);\n        if (this.enableDebug) this.emit('debug', 'Post decompress:' + printArray(data), 1);\n        return new Uint8Array(data);\n    }\n\n    /**\n     * @name Telnet#escapeData\n     * @desc Escape data for sending over telnet, IAC should become IAC IAC and \\r to \\r\\0 and \\n to \\r\\n\n     *\n     * @param {String} data the data to be escaped\n     * @returns {String} the data after being escaped\n     *\n     */\n    private _escapeData(data) {\n        if (data == null || typeof data === 'undefined') return data;\n        let dl;\n        let ba;\n        let idx = 0;\n        let i;\n        let c;\n        if (data instanceof Uint8Array) {\n            dl = data.byteLength;\n            ba = new StringBuffer();\n            for (; idx < dl; idx++) {\n                ba.appendCode(data[idx]);\n                if (data[idx] === 255)\n                    ba.appendCode(255);\n                else if (data[idx] === 13 && dl === 1)\n                    ba.append('\\r\\n');\n                else if (data[idx] === 10 && dl === 1)\n                    ba.append('\\r\\0');\n            }\n            return ba.toString();\n        }\n        dl = data.length;\n        ba = new StringBuffer();\n        for (; idx < dl; idx++) {\n            c = data.charAt(idx);\n            i = data.charCodeAt(idx);\n            ba.append(c);\n            if (i === 255)\n                ba.append(c);\n            else if (i === 13 && dl === 1)\n                ba.append('\\r\\n');\n            else if (i === 10 && dl === 1)\n                ba.append('\\r\\0');\n        }\n        return ba.toString();\n    }\n\n    /**\n     * @name Telnet#createSocket \n     * @desc Create a websocket object and assign events\n     *\n     * @returns {object} returns the socket object\n     */\n    private _createSocket(host, port) {\n        let _socket;\n        try {\n            //test if host has a scheme:// at the start and use it, does not care if it is a valid one or not let websocket worry about that\n            const hasScheme = /^[a-z0-9]+:\\/\\//.test(host);\n            //if scheme and has a port set append the port\n            if (hasScheme && port > 0)\n                _socket = new WebSocket(host + ':' + port, this.protocol || 'binary');\n            //no port but a scheme so use host and let websocket use default ports\n            else if (hasScheme)\n                _socket = new WebSocket(host, this.protocol || 'binary');\n            //host and port, prepend scheme and append port\n            else if (host && port > 0)\n                _socket = new WebSocket((this.scheme || 'ws://') + host + ':' + port, this.protocol || 'binary');\n            //when all else fails just try and use host prepended with scheme\n            else if (host)\n                _socket = new WebSocket((this.scheme || 'ws://') + host, this.protocol || 'binary');\n            _socket.binaryType = 'arraybuffer';\n            //the socket was closed for some reason, any code but 1000 means some type of error so send it to the error system, call close for cleanup and then trigger teh onClose event\n            _socket.onclose = (evt) => {\n                if (evt.code === 1006 && evt.type === 'close' && !this._closed)\n                    this.close();\n                else if (evt.code !== 1000 && !this._closed) {\n                    this.emit('error', { message: 'Closed due to transmission error', err: evt });\n                    this.close();\n                }\n            };\n            //trigger the onConnect event when the socket has been opened\n            _socket.onopen = () => {\n                this._connected = true;\n                this.emit('connect');\n            };\n            //data was received, process the data\n            _socket.onmessage = (evt) => {\n                if (evt.data instanceof ArrayBuffer) {\n                    var data = new Uint8Array(evt.data);\n                    if (this.enableDebug) this.emit('debug', 'Data ArrayBuffer received:' + printArray(data));\n                    this.receivedData(data);\n                }\n                else if (evt.data instanceof Blob) {\n                    var reader = new FileReader();\n                    reader.onloadend = () => {\n                        var data = new Uint8Array(<ArrayBuffer>reader.result);\n                        this.receivedData(data);\n                        if (this.enableDebug) this.emit('debug', 'Data Blob received:' + printArray(reader.result));\n                    };\n                    reader.readAsArrayBuffer(evt.data);\n                }\n                else {\n                    if (this.enableDebug) this.emit('debug', 'Data received:' + evt.data);\n                    this.receivedData(evt.data);\n                }\n            };\n            //an error happened so let the error function fire\n            _socket.onerror = (evt) => {\n                if (!this._closed)\n                    this.emit('error', evt);\n            };\n            return _socket;\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        return null;\n    }\n\n    /**\n    * @name Telnet#destroySocket\n    * @desc Destroy the current websocket object by assigning all functions to be empty\n    *\n    * @returns {object} returns null\n    */\n    private _destroySocket() {\n        if (!this.socket || this.socket == null) return;\n        try {\n            this.socket.onopen = function () { };\n            this.socket.onclose = function () { };\n            this.socket.onmessage = function () { };\n            this.socket.onerror = function () { };\n            if (this.connected)\n                this.socket.close();\n            delete this.socket;\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        this.socket = null;\n    }\n\n    /**\n    * @name Telnet#fireTelnetOption \n    * @desc Fire the onTelnetOption e\n    *\n    * @returns {object} returns null\n    */\n    private _fireReceiveOption(option, verb, val) {\n        const data: TelnetOption = { telnet: this, option: option, verb: 250, value: val, handled: false };\n        this.emit('received-option', data);\n        return data.handled;\n    }\n\n    private _fireReceiveMSDP(msdp_var, msdp_val) {\n        const data = { telnet: this, variable: msdp_var, value: msdp_val, handled: false };\n        this.emit('received-MSDP', data);\n        return data.handled;\n    }\n\n    private _fireReceiveGMCP(val) {\n        const data = { telnet: this, value: val, handled: false };\n        this.emit('received-GMCP', data);\n        return data.handled;\n    }\n\n    private _formatByte(b) {\n        if (b < 32 || b >= 127)\n            return '<' + b + '>';\n        return String.fromCharCode(b);\n    }\n\n    /**\n     * @name Telnet#onError\n     * @desc Fired when an error happens\n     * @method \n     * @event Telnet#onError\n     * @property {String|Object} err - the err object or message\n     */\n\n    /**\n     * @name Telnet#onConnecting\n     * @desc Fired when attempting to connect to host\n     * @method  \n     * @event Telnet#onConnecting\n     */\n\n    /**\n     * @name Telnet#onConnect\n     * @desc Fired when successfully connected to host\n     * @method  \n     * @event Telnet#onConnect\n     */\n\n    /**\n    * @name Telnet#onClose\n    * @desc Fired when connection is closed to host\n    * @method  \n    * @event Telnet#onClose\n    */\n\n    /**\n     * @name Telnet#onReceivedData\n     * @desc Fired when data is received from the host\n     * @method  \n     * @event Telnet#onReceivedData\n     * @property {String} data - received from the host after being processed for telnet options\n     */\n\n    /**\n     * @name Telnet#onDataSent\n     * @desc Fired when data is sent to the host\n     * @method  \n     * @event Telnet#onDataSent\n     * @property {String} data - data that was sent to the host\n     */\n\n    /**\n     * @name Telnet#onReceiveMSDP\n     * @desc Fired when a MSDP variable is received from host\n     * @method  \n     * @event Telnet#onReceiveMSDP\n     * @property {String} msdp_var - MSDP variable name\n     * @property {String} msdp_val - MSDP value of variable\n     */\n\n    /**\n    * @name Telnet#onReceiveGMCP\n    * @desc Fired when GMCP data is received from host\n    * @method  \n    * @event Telnet#onReceiveGMCP\n    * @property {String} value - The raw GMCP string\n    */\n\n    /**\n    * @name Telnet#onReceiveMSSP\n    * @desc Fired when MSSP variables and values are found\n    * @method  \n    * @event Telnet#onReceiveMSSP\n    * @type {object}\n    * @property {object} - the MSSP object containing all variables and values found\n    */\n\n    /**\n     * @name Telnet#onTelnetOption\n     * @desc Fired when a telnet option is found and before any reply sent\n     * @method  \n     * @event Telnet#onTelnetOption\n     * @type {object}\n     * @property {Number} option - Telnet option code\n     * @property {Number} verb - Telnet verb being replied to\n     * @property {String} value - Telnet option value if it has one\n     *\n     * @returns {Boolean} true if the option was handled, false if not handled and to continue default action\n     */\n\n}\n\nwindow.telnet = new Telnet;", "//spell-checker:ignore Xred\r\n/**\r\n *\r\n *\r\n * @export\r\n * @enum {number}\r\n */\r\nexport enum Ansi {\r\n    None = 0,\r\n    Bold = 1,\r\n    Faint = 2,\r\n    Underline = 4,\r\n    Italic = 3,\r\n    Slow = 5,\r\n    Rapid = 6,\r\n    Inverse = 7,\r\n    Hidden = 8,\r\n    Strikeout = 9,\r\n    DoubleUnderline = 21,\r\n    Overline = 53\r\n}\r\n\r\n/**\r\n * Enum for Ansi color codes.\r\n * @readonly\r\n * @enum {number}\r\n */\r\nexport enum AnsiColorCode {\r\n    /** @desc  Custom color for error Information */\r\n    ErrorBackground = -12,\r\n    /** @desc  Custom background color for error Information */\r\n    ErrorText = -11,\r\n    /** @desc  Custom background color for client Information */\r\n    InfoBackground = -8,\r\n    /** @desc  Custom foreground color for client Information */\r\n    InfoText = -7,\r\n    /** @desc  Custom tag for local echo */\r\n    LocalEcho = -3,\r\n    /** @desc  Custom tag for local echo */\r\n    LocalEchoBack = -4,\r\n    /** @desc All attributes off */\r\n    Reset = 0,\r\n    /** @desc Bold ON */\r\n    Bold = 1,\r\n    /** @desc Faint ON */\r\n    Faint = 2,\r\n    /** @desc Italic ON */\r\n    Italic = 3,\r\n    /** @desc Underscore */\r\n    Underline = 4,\r\n    /** @desc Blink ON (Slow) */\r\n    Blink = 5,\r\n    /** @desc Blink ON (Rapid) */\r\n    BlinkRapid = 6,\r\n    /** @desc Reverse Video ON */\r\n    Reverse = 7,\r\n    /** @desc Concealed ON */\r\n    Hidden = 8,\r\n    /** @desc  strike through */\r\n    StrikeThrough = 9,\r\n    /** @desc double underline on */\r\n    DoubleUnderline = 21,\r\n    /** @desc bold off */\r\n    BoldOff = 22,\r\n    /** @desc italics off */\r\n    ItalicOff = 23,\r\n    /** @desc underline off */\r\n    UnderlineOff = 24,\r\n    /** @desc blink off (slow) */\r\n    BlinkOff = 25,\r\n    /** @desc blink off (rapid) */\r\n    BlinkRapidOff = 26,\r\n    /** @desc inverse off */\r\n    ReverseOff = 27,\r\n    /** @desc Visible */\r\n    Visible = 28,\r\n    /** @desc strike through off */\r\n    StrikeThroughOff = 29,\r\n    /** @desc Black Foreground */\r\n    Black = 30,\r\n    /** @desc Red Foreground */\r\n    Red = 31,\r\n    /** @desc Green Foreground */\r\n    Green = 32,\r\n    /** @desc Yellow Foreground */\r\n    Yellow = 33,\r\n    /** @desc Blue Foreground */\r\n    Blue = 34,\r\n    /** @desc Magenta Foreground */\r\n    Magenta = 35,\r\n    /** @desc Cyan Foreground */\r\n    Cyan = 36,\r\n    /** @desc White Foreground */\r\n    White = 37,\r\n    /** @desc Default */\r\n    DefaultFore = 39,\r\n    /** @desc Black Background */\r\n    BlackBackground = 40,\r\n    /** @desc Red Background */\r\n    RedBackground = 41,\r\n    /** @desc Green Background */\r\n    GreenBackground = 42,\r\n    /** @desc Yellow Background */\r\n    YellowBackground = 43,\r\n    /** @desc Blue Background */\r\n    BlueBackground = 44,\r\n    /** @desc Magenta Background */\r\n    MagentaBackground = 45,\r\n    /** @desc Cyan Background */\r\n    CyanBackground = 46,\r\n    /** @desc White Background */\r\n    WhiteBackground = 47,\r\n    /** @desc default */\r\n    DefaultBack = 49,\r\n    /** @desc Subscript */\r\n    Subscript = 74,\r\n    /** @desc Superscript */\r\n    Superscript = 73,\r\n    SubSuperOff = 75,\r\n    // xterm 16 color support\r\n    /** @desc Set foreground color to Black */\r\n    XBlack = 90,\r\n    /** @desc Set foreground color to Red */\r\n    XRed = 91,\r\n    /** @desc Set foreground color to Green */\r\n    XGreen = 92,\r\n    /** @desc Set foreground color to Yellow */\r\n    XYellow = 93,\r\n    /** @desc Set foreground color to Blue */\r\n    XBlue = 94,\r\n    /** @desc Set foreground color to Magenta */\r\n    XMagenta = 95,\r\n    /** @desc Set foreground color to Cyan */\r\n    XCyan = 96,\r\n    /** @desc Set foreground color to White */\r\n    XWhite = 97,\r\n    /** @desc Set background color to Black */\r\n    XBlackBackground = 100,\r\n    /** @desc Set background color to Red */\r\n    XRedBackground = 101,\r\n    /** @desc Set background color to Green */\r\n    XGreenBackground = 102,\r\n    /** @desc Set background color to Yellow */\r\n    XYellowBackground = 103,\r\n    /** @desc Set background color to Blue */\r\n    XBlueBackground = 104,\r\n    /** @desc Set background color to Magenta */\r\n    XMagentaBackground = 105,\r\n    /** @desc Set background color to Cyan */\r\n    XCyanBackground = 106,\r\n    /** @desc Set background color to White */\r\n    XWhiteBackground = 107\r\n}\r\n\r\nexport function getAnsiColorCode(color: string, back?: boolean) {\r\n    switch (color.toLowerCase()) {\r\n        case 'black':\r\n            return back ? 40 : 30;\r\n        case 'red':\r\n            return back ? 41 : 31;\r\n        case 'green':\r\n            return back ? 42 : 32;\r\n        case 'yellow':\r\n            return back ? 43 : 33;\r\n        case 'blue':\r\n            return back ? 44 : 34;\r\n        case 'magenta':\r\n            return back ? 45 : 35;\r\n        case 'cyan':\r\n            return back ? 46 : 36;\r\n        case 'white':\r\n            return back ? 47 : 37;\r\n        case 'default':\r\n            return back ? 49 : 39;\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function getColorCode(code) {\r\n    let f = -1;\r\n    let b = -1;\r\n    let bold = false;\r\n    //rev            1024\r\n    if (code - 1024 >= 0) {\r\n        code -= 1024;\r\n    }\r\n    //blink            512  \r\n    if (code - 512 >= 0) {\r\n        code -= 512;\r\n    }\r\n    //under            256    \r\n    if (code - 256 >= 0) {\r\n        code -= 256;\r\n    }\r\n    //bold            128    \r\n    if (code - 128 >= 0) {\r\n        code -= 128;\r\n        bold = true;\r\n    }\r\n    if (code - 112 >= 0) {\r\n        code -= 112\r\n        b = 47;\r\n    }\r\n    if (code - 96 >= 0) {\r\n        code -= 96;\r\n        b = 43;\r\n    }\r\n    if (code - 80 >= 0) {\r\n        code -= 80;\r\n        b = 45;\r\n    }\r\n    if (code - 64 >= 0) {\r\n        code -= 64;\r\n        b = 41;\r\n    }\r\n    if (code - 48 >= 0) {\r\n        code -= 48;\r\n        b = 46\r\n    }\r\n    if (code - 32 >= 0) {\r\n        code -= 32;\r\n        b = 42;\r\n    }\r\n    if (code - 16 >= 0) {\r\n        code -= 16;\r\n        b = 44;\r\n    }\r\n    if (code >= 8) {\r\n        code -= 8;\r\n        bold = true;\r\n    }\r\n    switch (code) {\r\n        case 0:\r\n            f = 30;\r\n            break;\r\n        case 1:\r\n            f = 34;\r\n            break;\r\n        case 2:\r\n            f = 32;\r\n            break;\r\n        case 3:\r\n            f = 36;\r\n            break;\r\n        case 4:\r\n            f = 31;\r\n            break;\r\n        case 5:\r\n            f = 35;\r\n            break;\r\n        case 6:\r\n            f = 33;\r\n            break;\r\n        case 7:\r\n            f = 37;\r\n            break;\r\n    }\r\n    if (bold && f === -1) f = 370;\r\n    else if (bold) f *= 10;\r\n    if (f === -1)\r\n        return `,${b}`;\r\n    if (b === -1)\r\n        return f.toString();\r\n    return `${f},${b}`\r\n}\r\n\r\nexport function isMXPColor(color) {\r\n    if (!color || color.length === 0) return false;\r\n    return ['indianred', 'lightcoral', 'salmon', 'darksalmon', 'lightsalmon',\r\n        'crimson', 'red', 'firebrick', 'darkred', 'pink', 'lightpink', 'hotpink', 'deeppink',\r\n        'mediumvioletred', 'palevioletred', 'lightsalmon', 'coral', 'tomato', 'orangered',\r\n        'darkorange', 'orange', 'gold', 'yellow', 'lightyellow', 'lemonchiffon',\r\n        'lightgoldenrodyellow', 'papayawhip', 'moccasin', 'peachpuff', 'palegoldenrod',\r\n        'khaki', 'darkkhaki', 'lavender', 'thistle', 'plum', 'violet', 'orchid', 'fuchsia',\r\n        'magenta', 'mediumorchid', 'mediumpurple', 'blueviolet', 'darkviolet',\r\n        'darkorchid', 'darkmagenta', 'purple', 'indigo', 'slateblue', 'darkslateblue',\r\n        'mediumslateblue', 'greenyellow', 'chartreuse', 'lawngreen', 'lime', 'limegreen',\r\n        'palegreen', 'lightgreen', 'mediumspringgreen', 'springgreen', 'mediumseagreen',\r\n        'seagreen', 'forestgreen', 'green', 'darkgreen', 'yellowgreen', 'olivedrab',\r\n        'olive', 'darkolivegreen', 'mediumaquamarine', 'darkseagreen', 'lightseagreen',\r\n        'darkcyan', 'teal', 'aqua', 'cyan', 'lightcyan', 'paleturquoise', 'aquamarine',\r\n        'turquoise', 'mediumturquoise', 'darkturquoise', 'cadetblue', 'steelblue',\r\n        'lightsteelblue', 'powderblue', 'lightblue', 'skyblue', 'lightskyblue',\r\n        'deepskyblue', 'dodgerblue', 'cornflowerblue', 'mediumslateblue', 'royalblue',\r\n        'blue', 'mediumblue', 'darkblue', 'navy', 'midnightblue', 'cornsilk',\r\n        'blanchedalmond', 'bisque', 'navajowhite', 'wheat', 'burlywood', 'tan',\r\n        'rosybrown', 'sandybrown', 'goldenrod', 'darkgoldenrod', 'peru', 'chocolate',\r\n        'saddlebrown', 'sienna', 'brown', 'maroon', 'white', 'snow', 'honeydew',\r\n        'mintcream', 'azure', 'aliceblue', 'ghostwhite', 'whitesmoke', 'seashell',\r\n        'beige', 'oldlace', 'floralwhite', 'ivory', 'antiquewhite', 'linen',\r\n        'lavenderblush', 'mistyrose', 'gainsboro', 'lightgrey', 'silver', 'darkgray',\r\n        'gray', 'dimgray', 'lightslategray', 'slategray', 'darkslategray', 'black'].indexOf(color.toLowerCase()) != -1;\r\n}\r\n\r\nexport function getAnsiCode(str, back?: boolean) {\r\n    switch (str) {\r\n        /** @desc  custom color for error information */\r\n        case 'errortextbackground':\r\n        case 'errorbackground':\r\n            return -12;\r\n        /** @desc  custom background color for error information */\r\n        case 'errortext':\r\n            return back ? -12 : -11;\r\n        /** @desc  custom background color for client information */\r\n        case 'infobackground':\r\n            return -8;\r\n        /** @desc  custom foreground color for client information */\r\n        case 'infotext':\r\n            return back ? -8 : -7;\r\n        /** @desc  custom tag for local echo */\r\n        case 'localecho':\r\n            return back ? -4 : -3;\r\n        /** @desc  custom tag for local echo */\r\n        case 'localechoback':\r\n            return -4;\r\n        /** @desc all attributes off */\r\n        case 'reset':\r\n            return 0;\r\n        /** @desc bold on */\r\n        case 'bold':\r\n            return 1;\r\n        /** @desc faint on */\r\n        case 'faint':\r\n            return 2;\r\n        /** @desc italic on */\r\n        case 'italic':\r\n            return 3;\r\n        /** @desc underscore */\r\n        case 'underline':\r\n            return 4;\r\n        /** @desc blink on (slow) */\r\n        case 'blink':\r\n            return 5;\r\n        /** @desc blink on (rapid) */\r\n        case 'blinkrapid':\r\n            return 6;\r\n        /** @desc reverse video on */\r\n        case 'reverse':\r\n            return 7;\r\n        /** @desc concealed on */\r\n        case 'hidden':\r\n            return 8;\r\n        /** @desc  strike through */\r\n        case 'strikethrough':\r\n            return 9;\r\n        /** @desc double underline on */\r\n        case 'doubleunderline':\r\n            return 21;\r\n        /** @desc bold off */\r\n        case 'boldoff':\r\n            return 22;\r\n        /** @desc italics off */\r\n        case 'italicoff':\r\n            return 23;\r\n        /** @desc underline off */\r\n        case 'underlineoff':\r\n            return 24;\r\n        /** @desc blink off (slow) */\r\n        case 'blinkoff':\r\n            return 25;\r\n        /** @desc blink off (rapid) */\r\n        case 'blinkrapidoff':\r\n            return 26;\r\n        /** @desc inverse off */\r\n        case 'reverseoff':\r\n            return 27;\r\n        /** @desc visible */\r\n        case 'visible':\r\n            return 28;\r\n        /** @desc strike through off */\r\n        case 'strikethroughoff':\r\n            return 29;\r\n        /** @desc black foreground */\r\n        case 'black':\r\n            return back ? 40 : 30;\r\n        /** @desc red foreground */\r\n        case 'red':\r\n            return back ? 41 : 31;\r\n        /** @desc green foreground */\r\n        case 'green':\r\n            return back ? 42 : 32;\r\n        /** @desc yellow foreground */\r\n        case 'yellow':\r\n            return back ? 43 : 33;\r\n        /** @desc blue foreground */\r\n        case 'blue':\r\n            return back ? 44 : 34;\r\n        /** @desc magenta foreground */\r\n        case 'magenta':\r\n            return back ? 45 : 35;\r\n        /** @desc cyan foreground */\r\n        case 'cyan':\r\n            return back ? 46 : 36;\r\n        /** @desc white foreground */\r\n        case 'white':\r\n            return back ? 47 : 37;\r\n        /** @desc default */\r\n        case 'default':\r\n        case 'defaultfore':\r\n            return back ? 49 : 39;\r\n        /** @desc black background */\r\n        case 'blackbackground':\r\n            return 40;\r\n        /** @desc red background */\r\n        case 'redbackground':\r\n            return 41;\r\n        /** @desc green background */\r\n        case 'greenbackground':\r\n            return 42;\r\n        /** @desc yellow background */\r\n        case 'yellowbackground':\r\n            return 43;\r\n        /** @desc blue background */\r\n        case 'bluebackground':\r\n            return 44;\r\n        /** @desc magenta background */\r\n        case 'magentabackground':\r\n            return 45;\r\n        /** @desc cyan background */\r\n        case 'cyanbackground':\r\n            return 46;\r\n        /** @desc white background */\r\n        case 'whitebackground':\r\n            return 47;\r\n        /** @desc default */\r\n        case 'defaultbackground':\r\n        case 'defaultback':\r\n            return 49;\r\n        case 'overline':\r\n            return 53;\r\n        /** @desc subscript */\r\n        case 'subscript':\r\n            return 74;\r\n        /** @desc superscript */\r\n        case 'superscript':\r\n            return 73;\r\n        case 'subsuperoff':\r\n            return 75;\r\n        // xterm 16 color support\r\n        /** @desc set foreground color to black */\r\n        case 'xblack':\r\n            return back ? 100 : 90;\r\n        /** @desc set foreground color to red */\r\n        case 'xred':\r\n            return back ? 101 : 91;\r\n        /** @desc set foreground color to green */\r\n        case 'xgreen':\r\n            return back ? 102 : 92;\r\n        /** @desc set foreground color to yellow */\r\n        case 'xyellow':\r\n            return back ? 103 : 93;\r\n        /** @desc set foreground color to blue */\r\n        case 'xblue':\r\n            return back ? 104 : 94;\r\n        /** @desc set foreground color to magenta */\r\n        case 'xmagenta':\r\n            return back ? 105 : 95;\r\n        /** @desc set foreground color to cyan */\r\n        case 'xcyan':\r\n            return back ? 106 : 96;\r\n        /** @desc set foreground color to white */\r\n        case 'xwhite':\r\n            return back ? 107 : 97;\r\n        /** @desc set background color to black */\r\n        case 'xblackbackground':\r\n            return 100;\r\n        /** @desc set background color to red */\r\n        case 'xredbackground':\r\n            return 101;\r\n        /** @desc set background color to green */\r\n        case 'xgreenbackground':\r\n            return 102;\r\n        /** @desc set background color to yellow */\r\n        case 'xyellowbackground':\r\n            return 103;\r\n        /** @desc set background color to blue */\r\n        case 'xbluebackground':\r\n            return 104;\r\n        /** @desc set background color to magenta */\r\n        case 'xmagentabackground':\r\n            return 105;\r\n        /** @desc set background color to cyan */\r\n        case 'xcyanbackground':\r\n            return 106;\r\n        /** @desc set background color to white */\r\n        case 'xwhitebackground':\r\n            return 107\r\n    }\r\n    return -1;\r\n}", "import { Display } from \"./display\";\n\nexport interface Point {\n  x: number;\n  y: number;\n  lineID: number;\n}\n\nexport interface DisplayOptions extends ParserOptions {\n  colors?: boolean;\n  backgroundColors?: boolean;\n  container?: string | JQuery | HTMLElement;\n}\n\nexport interface LogOptions {\n  path?: string;\n  offline?: boolean;\n  gagged?: boolean;\n  enabled?: boolean;\n  unique?: boolean;\n  prepend?: boolean;\n  name?: string;\n  what?: Log;\n  debug?: boolean;\n}\n\nexport interface WindowState {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  maximized: boolean;\n}\n\nexport enum BackupSelection {\n  None = 0,\n  Map = 2,\n  Profiles = 4,\n  Settings = 8,\n  Windows = 16,\n  Characters = 32,\n  All = 30\n}\n\nexport enum NewLineType {\n  None = 0,\n  Ctrl = 1,\n  Shift = 2,\n  CtrlOrShift = 4,\n  CtrlAndShift = 8\n}\n\nexport enum ScriptEngineType {\n  Full = 1,\n  Fast = 2,\n  Simple = 4\n}\n\nexport enum Log {\n  None = 0,\n  Html = 1,\n  Text = 2,\n  Raw = 4\n}\n\nexport enum FormatType {\n  Normal = 0,\n  Link = 1,\n  LinkEnd = 2,\n  MXPLink = 3,\n  MXPLinkEnd = 4,\n  Image = 5,\n  WordBreak = 6,\n  MXPSend = 7,\n  MXPSendEnd = 8,\n  MXPExpired = 9,\n  MXPSkip = 10\n}\n\nexport enum OnDisconnect {\n  Nothing = 0, Reconnect = 1, ReconnectDialog = 2, LoadManager = 4, Close = 8\n}\n\nexport enum OnProfileChange {\n  Nothing = 0, Reload = 1, Ask = 2, Warn = 4\n}\n\nexport enum OnProfileDeleted {\n  Nothing = 0, Remove = 1, Ask = 2, Warn = 4\n}\n\nexport enum ProfileSortOrder {\n  None = 0, Alpha = 2, Priority = 4, Index = 8\n}\n\nexport enum Echo {\n  None = 0, Triggers = 8, Scripts = 2, Commands = 4\n}\n\nexport enum TabCompletion { PrependBuffer = 1, AppendBuffer = 2, BufferOnly = 4, List = 8 }\n\n/**\n   * Enum flag for Font styles.\n   * @readonly\n   * @enum {number}\n   * @typedef {number} FontStyle\n   */\nexport enum FontStyle {\n  None = 0,\n  Bold = 1,\n  Faint = 2,\n  Italic = 4,\n  Underline = 8,\n  Slow = 16, /** @desc Slow blink text combined with slow for final blink  */\n  Rapid = 32, /** @desc Rapid blink text combined with slow for final blink */\n  Inverse = 64, /** @desc reverse back and fore color */\n  Hidden = 128, /** @desc hide text */\n  Strikeout = 256,\n  DoubleUnderline = 512,\n  Overline = 1024\n}\n\nexport enum SettingType {\n  String = 0,\n  Boolean = 1,\n  Number = 2,\n  Raw = 3,\n  Custom = 4,\n  ComboBox = 5\n}\n\nexport interface LineFormat {\n  formatType: FormatType;\n  offset: number;\n  color: string | number;\n  background: string | number;\n  size: string;\n  font: string;\n  style: FontStyle;\n  hr?: boolean;\n}\n\nexport interface ImageFormat {\n  formatType: FormatType;\n  name: string;\n  url: string;\n  type: string;\n  height: string;\n  width: string;\n  vspace: string;\n  align: string;\n  ismap: boolean;\n}\n\nexport interface LinkFormat {\n  formatType: FormatType;\n  href?: string;\n  hint?: string;\n  expire?: string;\n  prompt?: boolean;\n  tt?: string | number;\n}\nexport interface ParserLine {\n  raw: string;\n  line: string;\n  fragment: boolean;\n  gagged: boolean;\n  formats: LineFormat[];\n  remote: boolean;\n  timestamp?: number;\n}\n\nexport interface ParserOptions {\n  DefaultImageURL?: string;\n  enableMXP?: boolean;\n  enableDebug?: boolean;\n  enableMSP?: boolean;\n  enableURLDetection?: boolean;\n  window?: Size;\n  enableFlashing?: boolean;\n  emulateTerminal?: boolean;\n  bell?: string;\n  enableBell?: boolean;\n  display?: Display;\n  enableLinks?: boolean;\n  showInvalidMXPTags?: boolean;\n}\n\nexport class Size {\n  public width: number = 0;\n  public height: number = 0;\n\n  constructor(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n  }\n}\n\nexport enum IEDError {\n  RESET = 1,\n  USERRESET = 2,\n  DL_USERABORT = 3,\n  DL_NOTSTART = 4,\n  DL_TOOMANY = 5,\n  DL_INPROGRESS = 6,\n  DL_UNKNOWN = 7,\n  UL_USERABORT = 8,\n  UL_BADENCODE = 9,\n  UL_TOOLARGE = 10,\n  UL_FAILWRITE = 11,\n  UL_UNKNOWN = 12,\n  UL_INVALIDFILE = 13,\n  UL_INVALIDPATH = 14,\n  DL_INVALIDFILE = 15,\n  DL_INVALIDPATH = 16,\n  CMD_INVALIDFMT = 17,\n  CMD_INVALID = 18,\n  DIR_INVALIDFMT = 19,\n  DIR_INVALIDPATH = 20,\n  UL_INVALIDFMT = 21,\n  DL_INVALIDFMT = 22,\n  DIR_TOOMANY = 23,\n  DIR_CANTREAD = 24,\n  DIR_NOTSTART = 25,\n  CMD_DENIED = 26,\n  CMD_INVALIDFILE = 27,\n  CMD_INVALIDARG = 28,\n  CMD_INVALIDPATH = 29,\n  INVALIDPATH = 30,\n  INVALIDFILE = 31,\n  CMD_NOEXIST = 32,\n  CMD_DIRECTORY = 33,\n  CMD_EXIST = 34,\n  CMD_UNKNOWN = 35,\n  UL_TOOMANY = 36,\n  UL_INPROGRESS = 37,\n  CMD_FILE = 38,\n  UL_DENIED = 39,\n  UL_FILE = 40,\n  USER_DENIED = 41\n}\n\nexport enum IEDCmdStatus {\n  denied = 0,\n  success = 1,\n  failed = 2\n}\n\nexport enum MailStatus {\n  SUCCESS = 0,\n  ERROR = 1,\n  NO_RECIPIENTS = 2,\n  INVALID_ID = 3,\n  INVALID_GROUP = 4,\n  NOT_ALLOWED = 5,\n  GROUP_EXIST = 6,\n  PLAYER_EXIST = 7,\n  PLAYER_DOES_EXIST = 8,\n  INVALID_DATA = 9,\n  ERROR_LOADING = 10,\n  RESET = 11,\n  CHUNK = 12\n}\n\nexport enum MailAction {\n  list = 0,\n  read = 1,\n  mark = 2,\n  send = 3,\n  reset = 4\n}\n\nexport enum MailReadFormat {\n  none = 0,\n  html = 1,\n  ansi = 2\n}\n\nexport enum MailFolders {\n  inbox = 0,\n  drafts = 1,\n  sent = 2,\n  trash = 3\n}\n\nexport enum ProfileSaveType {\n  Any = 0,\n  Trigger = 1,\n  Button = 2,\n  Macro = 4,\n  Alias = 8,\n  Context = 16,\n  Variable = 32\n}\n\nexport interface MenuItem {\n  name: string;\n  action?: Function | string;\n  icon?: string;\n  position?: number | string;\n}\n\nexport interface FunctionEvent {\n  name: string;\n  args: string[];\n  raw: string;\n  handled: boolean;\n  return: any;\n}\n", "//spell-checker:words vscroll, hscroll, askoncancel, askonclose,commandon, cmdfont\n//spell-checker:ignore emoteto, emotetos askonchildren YYYYMMDD Hmmss\nimport { NewLineType, Log, BackupSelection, OnDisconnect, ProfileSortOrder, OnProfileChange, OnProfileDeleted, ScriptEngineType, SettingType, Echo, TabCompletion } from './types';\n\n/**\n * Array that contains details about setting values\n * [settingKey, object property, setting data type, default value, max length\n *\n * settingKey - unique key value, object property value if object property undefined, 0 or null\n * object property - the value used to access setting if settingKey is not property, can use . to denote nested properties\n * setting data type - the data type of setting\n *      0 string\n *      1 boolean\n *      2 number\n *      3 raw setting\n *      4 custom\n *      5 combo-box\n * default value - the default value of setting\n * max length - optional max length\n */\nexport let SettingList: any[] = [\n    ['bufferSize', 0, 2, 500],\n    ['commandDelay', 0, 2, 500],\n    ['commandDelayCount', 0, 2, 5],\n    ['commandHistorySize', 0, 2, 20],\n    ['fontSize', 0, 0, '1em', 0],\n    ['cmdfontSize', 0, 0, '1em', 0],\n    ['commandEcho', 0, 1, true],\n    ['flashing', 0, 1, false],\n    ['autoConnect', 0, 1, true],\n    ['enableAliases', -1, 1, true],\n    ['enableTriggers', -1, 1, true],\n    ['enableMacros', -1, 1, true],\n    ['showScriptErrors', 0, 1, false],\n    ['commandStacking', 0, 1, true],\n    ['commandStackingChar', 0, 0, ';', 1],\n    ['htmlLog', 0, 1, true],\n    ['keepLastCommand', 0, 1, true],\n    ['enableMCCP', 0, 1, true],\n    ['enableUTF8', 0, 1, true],\n    ['font', 0, 5, '\\'Courier New\\', Courier, monospace', 0],\n    ['cmdfont', 0, 5, '\\'Courier New\\', Courier, monospace', 0],\n    ['aliases', -1, 4],\n    ['macros', -1, 4],\n    ['triggers', -1, 4],\n    ['mapFollow', 'mapper.follow', 1, true],\n    ['mapEnabled', 'mapper.enabled', 1, true],\n    ['MapperSplitArea', 'mapper.split', 1, false],\n    ['MapperFillWalls', 'mapper.fill', 1, false],\n    ['MapperOpen', 'showMapper', 1, false],\n    ['fullScreen', -1, 3, false],\n    ['enableMXP', 0, 1, true],\n    ['enableMSP', 0, 1, true],\n    ['parseCommands', 0, 3, true],\n    ['lagMeter', 0, 1, false],\n    ['enablePing', 0, 1, false],\n    ['enableEcho', 0, 1, true],\n    ['enableSpeedpaths', 0, 1, true],\n    ['speedpathsChar', 0, 0, '!', 1],\n    ['parseSpeedpaths', 0, 1, true],\n    ['profile', -1, 0, 'Default', 1],\n    ['parseSingleQuotes', 0, 1, false],\n    ['parseDoubleQuotes', 0, 1, true],\n    ['logEnabled', 0, 1, false],\n    ['logPrepend', 0, 1, false],\n    ['logOffline', 0, 1, false],\n    ['logUniqueOnConnect', 0, 1, true],\n    ['enableURLDetection', 0, 1, true],\n    ['colors', 0, 4],\n    ['notifyMSPPlay', 0, 1, false],\n    ['CommandonClick', 0, 1, true],\n    ['allowEval', 0, 1, true],\n    ['allowEscape', 0, 1, true],\n    ['AutoCopySelectedToClipboard', 0, 1, false],\n    ['enableDebug', 0, 1, false],\n    ['editorPersistent', 0, 1, false],\n    ['askonclose', 0, 1, true],\n    ['dev', 0, 1, false],\n    //New settings\n    ['chat.captureLines', 0, 1, false],\n    ['chat.captureAllLines', 0, 1, false],\n    ['chat.captureReviews', 0, 1, false],\n    ['chat.captureTells', 0, 1, false],\n    ['chat.captureTalk', 0, 1, false],\n    ['chat.gag', 0, 1, false],\n    ['chat.CaptureOnlyOpen', 0, 1, false],\n    ['checkForUpdates', 0, 1, false],\n    ['autoCreateCharacter', 0, 1, false],\n    ['askonchildren', 0, 1, true],\n    ['mapper.legend', 0, 1, false],\n    ['mapper.room', 0, 1, false],\n    ['mapper.importType', 0, 2, 1],\n    ['mapper.vscroll', 0, 2, 0],\n    ['mapper.hscroll', 0, 2, 0],\n    ['mapper.scale', 0, 2, 100],\n    ['mapper.alwaysOnTop', 0, 1, false],\n    ['mapper.alwaysOnTopClient', 0, 1, true],\n    ['mapper.memory', 0, 1, false],\n    ['mapper.memorySavePeriod', 0, 2, 900000],\n    ['mapper.active.ID', 0, 0, null],\n    ['mapper.active.x', 0, 2, 0],\n    ['mapper.active.y', 0, 2, 0],\n    ['mapper.active.z', 0, 2, 0],\n    ['mapper.active.area', 0, 0, null],\n    ['mapper.active.zone', 0, 2, 0],\n    ['mapper.persistent', 0, 1, true],\n    ['profiles.split', 0, 2, 200],\n    ['profiles.askoncancel', 0, 1, true],\n    ['profiles.triggersAdvanced', 0, 1, false],\n    ['profiles.aliasesAdvanced', 0, 1, false],\n    ['profiles.buttonsAdvanced', 0, 1, false],\n    ['profiles.macrosAdvanced', 0, 1, false],\n    ['profiles.contextsAdvanced', 0, 1, false],\n    ['profiles.codeEditor', 0, 1, true],\n    ['profiles.watchFiles', 0, 1, true],\n    ['chat.alwaysOnTop', 0, 1, false],\n    ['chat.alwaysOnTopClient', 0, 1, true],\n    ['chat.log', 0, 1, false],\n    ['chat.persistent', 0, 1, false],\n    ['chat.zoom', 0, 2, 1],\n    ['chat.font', 0, 5, '\\'Courier New\\', Courier, monospace'],\n    ['chat.fontSize', 0, 0, '1em'],\n    ['title', 0, 0, '$t'],\n    ['logGagged', 0, 1, false],\n    ['logTimeFormat', 0, 0, 'YYYYMMDD-HHmmss'],\n    ['autoConnectDelay', 0, 2, 600],\n    ['autoLogin', 0, 1, true],\n    ['onDisconnect', 0, 2, OnDisconnect.ReconnectDialog],\n    ['enableKeepAlive', 0, 1, false],\n    ['keepAliveDelay', 0, 2, 0],\n    ['newlineShortcut', 0, 2, NewLineType.Ctrl],\n    ['logWhat', 0, 2, Log.Html],\n    ['logErrors', 0, 1, true],\n    ['showErrorsExtended', 0, 1, false],\n    ['reportCrashes', 0, 1, false],\n    ['enableCommands', 0, 1, true],\n    ['commandChar', 0, 0, '#', 1],\n    ['escapeChar', 0, 0, '\\\\', 1],\n    ['enableVerbatim', 0, 1, true],\n    ['verbatimChar', 0, 0, '`'],\n    ['soundPath', 0, 0, ''],\n    ['logPath', 0, 0, ''],\n    ['theme', 0, 0, ''],\n    ['gamepads', 0, 1, false],\n    ['buttons.connect', 0, 1, true],\n    ['buttons.characters', 0, 1, true],\n    ['buttons.preferences', 0, 1, true],\n    ['buttons.log', 0, 1, true],\n    ['buttons.clear', 0, 1, true],\n    ['buttons.lock', 0, 1, true],\n    ['buttons.map', 0, 1, true],\n    ['buttons.user', 0, 1, true],\n    ['buttons.mail', 0, 1, false],\n    ['buttons.compose', 0, 1, false],\n    ['buttons.immortal', 0, 1, true],\n    ['buttons.codeEditor', 0, 1, false],\n    ['find.case', 0, 1, false],\n    ['find.word', 0, 1, false],\n    ['find.reverse', 0, 1, false],\n    ['find.regex', 0, 1, false],\n    ['find.selection', 0, 1, false],\n    ['find.show', 0, 1, false],\n    ['display.split', 0, 1, false],\n    ['display.splitHeight', 0, 2, -1],\n    ['display.splitLive', 0, 1, true],\n    ['display.roundedOverlays', 0, 1, true],\n    ['backupLoad', 0, 2, BackupSelection.All],\n    ['backupSave', 0, 2, BackupSelection.All],\n    ['backupAllProfiles', 0, 1, true],\n    ['scrollLocked', 0, 1, false],\n    ['showStatus', 0, 1, true],\n    ['showCharacterManager', 0, 1, false],\n    ['showChat', 0, 1, false],\n    ['showEditor', 0, 1, false],\n    ['showArmor', 0, 1, false],\n    ['showStatusWeather', 0, 1, true],\n    ['showStatusLimbs', 0, 1, true],\n    ['showStatusHealth', 0, 1, true],\n    ['showStatusExperience', 0, 1, true],\n    ['showStatusPartyHealth', 0, 1, true],\n    ['showStatusCombatHealth', 0, 1, true],\n    ['showButtonBar', 0, 1, true],\n    ['allowNegativeNumberNeeded', 0, 1, false],\n    ['spellchecking', 0, 1, true],\n    ['hideOnMinimize', 0, 1, false],\n    ['showTrayIcon', 0, 1, false],\n    ['statusExperienceNeededProgressbar', 0, 1, false],\n    ['trayClick', 0, 2, 0],\n    ['trayDblClick', 0, 2, 0],\n    ['pasteSpecialPrefix', 0, 0, ''],\n    ['pasteSpecialPostfix', 0, 0, ''],\n    ['pasteSpecialReplace', 0, 0, ''],\n    ['pasteSpecialPrefixEnabled', 0, 1, true],\n    ['pasteSpecialPostfixEnabled', 0, 1, true],\n    ['pasteSpecialReplaceEnabled', 0, 1, true],\n    ['display.showSplitButton', 0, 1, true],\n    ['chat.split', 0, 1, false],\n    ['chat.splitHeight', 0, 2, -1],\n    ['chat.splitLive', 0, 1, true],\n    ['chat.roundedOverlays', 0, 1, true],\n    ['chat.showSplitButton', 0, 1, true],\n    ['chat.bufferSize', 0, 2, 500],\n    ['chat.flashing', 0, 1, false],\n    ['display.hideTrailingEmptyLine', 0, 1, true],\n    ['display.enableColors', 0, 1, true],\n    ['display.enableBackgroundColors', 0, 1, true],\n    ['enableSound', 0, 1, true],\n    ['allowHalfOpen', 0, 1, true],\n    ['editorClearOnSend', 0, 1, true],\n    ['editorCloseOnSend', 0, 1, true],\n    ['askOnCloseAll', 0, 1, true],\n    ['askonloadCharacter', 0, 1, true],\n    ['mapper.roomWidth', 0, 2, 200],\n    ['mapper.roomGroups', 0, 2, 1 | 2 | 4],\n    ['mapper.showInTaskBar', 0, 1, false],\n    ['profiles.enabled', 0, 4, []],\n    ['profiles.sortOrder', 0, 2, ProfileSortOrder.Priority | ProfileSortOrder.Index],\n    ['profiles.sortDirection', 0, 2, 1],\n    ['profiles.showInTaskBar', 0, 1, false],\n    ['profiles.profileSelected', 0, 0, 'default'],\n    ['profiles.profileExpandSelected', 0, 1, true],\n    ['chat.lines', 0, 4, []],\n    ['chat.showInTaskBar', 0, 1, false],\n    ['chat.showTimestamp', 0, 1, false],\n    ['chat.timestampFormat', 0, 0, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['chat.tabWidth', 0, 2, 8],\n    ['chat.displayControlCodes', 0, 1, false],\n    ['chat.emulateTerminal', 0, 1, false],\n    ['chat.emulateControlCodes', 0, 1, true],\n    ['chat.wordWrap', 0, 1, false],\n    ['chat.wrapAt', 0, 2, 0],\n    ['chat.indent', 0, 2, 4],\n    ['chat.scrollLocked', 0, 1, false],\n    ['chat.find.case', 0, 1, false],\n    ['chat.find.word', 0, 1, false],\n    ['chat.find.reverse', 0, 1, false],\n    ['chat.find.regex', 0, 1, false],\n    ['chat.find.selection', 0, 1, false],\n    ['chat.find.show', 0, 1, false],\n    ['chat.find.highlight', 0, 1, false],\n    ['chat.find.location', 0, 4, [5, 20]],\n    ['codeEditor.showInTaskBar', 0, 1, false],\n    ['codeEditor.persistent', 0, 1, false],\n    ['codeEditor.alwaysOnTop', 0, 1, false],\n    ['codeEditor.alwaysOnTopClient', 0, 1, true],\n    ['autoTakeoverLogin', 0, 1, false],\n    ['fixHiddenWindows', 0, 1, true],\n    ['maxReconnectDelay', 0, 2, 3600],\n    ['enableBackgroundThrottling', 0, 1, true],\n    ['enableBackgroundThrottlingClients', 0, 1, false],\n    ['showInTaskBar', 0, 1, true],\n    ['showLagInTitle', 0, 1, false],\n    ['mspMaxRetriesOnError', 0, 2, 0],\n    ['logTimestamp', 0, 1, false],\n    ['logTimestampFormat', 0, 0, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['disableTriggerOnError', 0, 1, true],\n    ['prependTriggeredLine', 0, 1, true],\n    ['enableParameters', 0, 1, true],\n    ['parametersChar', 0, 0, '%', 1],\n    ['enableNParameters', 0, 1, true],\n    ['nParametersChar', 0, 0, '$', 1],\n    ['enableParsing', 0, 1, true],\n    ['externalWho', 0, 1, true],\n    ['externalHelp', 0, 1, true],\n    ['watchForProfilesChanges', 0, 1, false],\n    ['onProfileChange', 0, 2, OnProfileChange.Nothing],\n    ['onProfileDeleted', 0, 2, OnProfileDeleted.Nothing],\n    ['enableDoubleParameterEscaping', 0, 1, false],\n    ['ignoreEvalUndefined', 0, 1, true],\n    ['enableInlineComments', 0, 1, true],\n    ['enableBlockComments', 0, 1, true],\n    ['inlineCommentString', 0, 0, '//'],\n    ['blockCommentString', 0, 0, '/*'],\n    ['allowCommentsFromCommand', 0, 1, false],\n    ['saveTriggerStateChanges', 0, 1, true],\n    ['groupProfileSaves', 0, 1, false],\n    ['groupProfileSaveDelay', 0, 2, 20000],\n    ['returnNewlineOnEmptyValue', 0, 1, false],\n    ['pathDelay', 0, 2, 0],\n    ['pathDelayCount', 0, 2, 1],\n    ['echoSpeedpaths', 0, 1, false],\n    ['alwaysShowTabs', 0, 1, false],\n    ['scriptEngineType', 0, SettingType.Number, ScriptEngineType.Simple],\n    ['initializeScriptEngineOnLoad', 0, SettingType.Boolean, false],\n    ['find.highlight', 0, SettingType.Boolean, false],\n    ['find.location', 0, SettingType.Custom, [5, 20]],\n    ['display.showInvalidMXPTags', 0, SettingType.Boolean, false],\n    ['display.showTimestamp', 0, SettingType.Boolean, false],\n    ['display.timestampFormat', 0, SettingType.String, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['display.displayControlCodes', 0, SettingType.Boolean, false],\n    ['display.emulateTerminal', 0, SettingType.Boolean, false],\n    ['display.emulateControlCodes', 0, SettingType.Boolean, true],\n    ['display.wordWrap', 0, SettingType.Boolean, false],\n    ['display.tabWidth', 0, SettingType.Number, 8],\n    ['display.wrapAt', 0, SettingType.Number, 0],\n    ['display.indent', 0, SettingType.Number, 4],\n    ['statusWidth', 0, SettingType.Number, -1],\n    ['showEditorInTaskBar', 0, SettingType.Boolean, true],\n    ['trayMenu', 0, SettingType.Number, 0],\n    ['lockLayout', 0, SettingType.Boolean, false],\n    ['loadLayout', 0, SettingType.String, ''],\n    ['useSingleInstance', 0, SettingType.Boolean, true],\n    ['onSecondInstance', 0, SettingType.Number, 0],\n    ['characterManagerDblClick', 0, SettingType.Number, 0],\n    ['enableTabCompletion', SettingType.Boolean, true],\n    ['ignoreCaseTabCompletion', 0, SettingType.Boolean, false],\n    ['tabCompletionBufferLimit', 0, SettingType.Number, 100],\n    ['enableNotifications', 0, SettingType.Boolean, true],\n    ['echo', 0, SettingType.Number, Echo.None],\n    ['commandAutoSize', 0, SettingType.Boolean, false],\n    ['commandWordWrap', 0, SettingType.Boolean, false],\n    ['commandScrollbars', 0, SettingType.Boolean, false],\n    ['tabCompletionList', 0, SettingType.String, ''],\n    ['tabCompletionLookupType', 0, SettingType.Number, TabCompletion.PrependBuffer],\n    ['tabCompletionReplaceCasing', 0, SettingType.Number, 0],\n    ['characterManagerAddButtonAction', 0, SettingType.Number, 0],\n    ['enableCrashReporting', 0, SettingType.Boolean, false],\n    ['characterManagerPanelWidth', 0, SettingType.Number, 0],\n    ['ignoreInputLeadingWhitespace', 0, SettingType.Boolean, false],\n    ['profiles.find.case', 0, 1, false],\n    ['profiles.find.word', 0, 1, false],\n    ['profiles.find.reverse', 0, 1, false],\n    ['profiles.find.regex', 0, 1, false],\n    ['profiles.find.selection', 0, 1, false],\n    ['profiles.find.show', 0, 1, false],\n    ['profiles.find.value', 0, 1, false],\n    ['skipMore', 0, 1, false],\n    ['skipMoreDelay', 0, SettingType.Number, 5000],\n    ['commandMinLines', 0, SettingType.Number, 1],\n    ['backupReplaceCharacters', 0, SettingType.Boolean, true],\n    ['simpleAlarms', 0, SettingType.Boolean, false],\n    ['simpleEditor', 0, SettingType.Boolean, false],\n    ['selectLastCommand', 0, SettingType.Boolean, true]\n];\n\nexport const SettingProperties = ['bufferSize', 'commandDelay', 'commandDelayCount', 'commandHistorySize', 'fontSize', 'cmdfontSize', 'commandEcho', 'flashing', 'autoConnect', 'enableAliases', 'enableTriggers', 'enableMacros', 'showScriptErrors', 'commandStacking', 'commandStackingChar', 'htmlLog', 'keepLastCommand', 'enableMCCP', 'enableUTF8', 'font', 'cmdfont', 'mapper.follow', 'mapper.enabled', 'mapper.split', 'mapper.fill', 'showMapper', 'fullScreen', 'enableMXP', 'enableMSP', 'parseCommands', 'lagMeter', 'enablePing', 'enableEcho', 'enableSpeedpaths', 'speedpathsChar', 'parseSpeedpaths', 'profile', 'parseSingleQuotes', 'parseDoubleQuotes', 'logEnabled', 'logPrepend', 'logOffline', 'logUniqueOnConnect', 'enableURLDetection', 'notifyMSPPlay', 'CommandonClick', 'allowEval', 'allowEscape', 'AutoCopySelectedToClipboard', 'enableDebug', 'editorPersistent', 'askonclose', 'dev', 'chat.captureLines', 'chat.captureAllLines', 'chat.captureReviews', 'chat.captureTells', 'chat.captureTalk', 'chat.gag', 'chat.CaptureOnlyOpen', 'checkForUpdates', 'autoCreateCharacter', 'askonchildren', 'mapper.legend', 'mapper.room', 'mapper.importType', 'mapper.vscroll', 'mapper.hscroll', 'mapper.scale', 'mapper.alwaysOnTop', 'mapper.alwaysOnTopClient', 'mapper.memory', 'mapper.memorySavePeriod', 'mapper.active.ID', 'mapper.active.x', 'mapper.active.y', 'mapper.active.z', 'mapper.active.area', 'mapper.active.zone', 'mapper.persistent', 'profiles.split', 'profiles.askoncancel', 'profiles.triggersAdvanced', 'profiles.aliasesAdvanced', 'profiles.buttonsAdvanced', 'profiles.macrosAdvanced', 'profiles.contextsAdvanced', 'profiles.codeEditor', 'profiles.watchFiles', 'chat.alwaysOnTop', 'chat.alwaysOnTopClient', 'chat.log', 'chat.persistent', 'chat.zoom', 'chat.font', 'chat.fontSize', 'title', 'logGagged', 'logTimeFormat', 'autoConnectDelay', 'autoLogin', 'onDisconnect', 'enableKeepAlive', 'keepAliveDelay', 'newlineShortcut', 'logWhat', 'logErrors', 'showErrorsExtended', 'reportCrashes', 'enableCommands', 'commandChar', 'escapeChar', 'enableVerbatim', 'verbatimChar', 'soundPath', 'logPath', 'theme', 'gamepads', 'buttons.connect', 'buttons.characters', 'buttons.preferences', 'buttons.log', 'buttons.clear', 'buttons.lock', 'buttons.map', 'buttons.user', 'buttons.mail', 'buttons.compose', 'buttons.immortal', 'buttons.codeEditor', 'find.case', 'find.word', 'find.reverse', 'find.regex', 'find.selection', 'find.show', 'display.split', 'display.splitHeight', 'display.splitLive', 'display.roundedOverlays', 'backupLoad', 'backupSave', 'backupAllProfiles', 'backupReplaceCharacters', 'scrollLocked', 'showStatus', 'showCharacterManager', 'showChat', 'showEditor', 'showArmor', 'showStatusWeather', 'showStatusLimbs', 'showStatusHealth', 'showStatusExperience', 'showStatusPartyHealth', 'showStatusCombatHealth', 'showButtonBar', 'allowNegativeNumberNeeded', 'spellchecking', 'hideOnMinimize', 'showTrayIcon', 'statusExperienceNeededProgressbar', 'trayClick', 'trayDblClick', 'pasteSpecialPrefix', 'pasteSpecialPostfix', 'pasteSpecialReplace', 'pasteSpecialPrefixEnabled', 'pasteSpecialPostfixEnabled', 'pasteSpecialReplaceEnabled', 'display.showSplitButton', 'chat.split', 'chat.splitHeight', 'chat.splitLive', 'chat.roundedOverlays', 'chat.showSplitButton', 'chat.bufferSize', 'chat.flashing', 'display.hideTrailingEmptyLine', 'display.enableColors', 'display.enableBackgroundColors', 'enableSound', 'allowHalfOpen', 'editorClearOnSend', 'editorCloseOnSend', 'askOnCloseAll', 'askonloadCharacter', 'mapper.roomWidth', 'mapper.roomGroups', 'mapper.showInTaskBar', 'profiles.enabled', 'profiles.sortOrder', 'profiles.sortDirection', 'profiles.showInTaskBar', 'profiles.profileSelected', 'profiles.profileExpandSelected', 'chat.lines', 'chat.showInTaskBar', 'chat.showTimestamp', 'chat.timestampFormat', 'chat.tabWidth', 'chat.displayControlCodes', 'chat.emulateTerminal', 'chat.emulateControlCodes', 'chat.wordWrap', 'chat.wrapAt', 'chat.indent', 'chat.scrollLocked', 'chat.find.case', 'chat.find.word', 'chat.find.reverse', 'chat.find.regex', 'chat.find.selection', 'chat.find.show', 'chat.find.highlight', 'chat.find.location', 'codeEditor.showInTaskBar', 'codeEditor.persistent', 'codeEditor.alwaysOnTop', 'codeEditor.alwaysOnTopClient', 'autoTakeoverLogin', 'fixHiddenWindows', 'maxReconnectDelay', 'enableBackgroundThrottling', 'enableBackgroundThrottlingClients', 'showInTaskBar', 'showLagInTitle', 'mspMaxRetriesOnError', 'logTimestamp', 'logTimestampFormat', 'disableTriggerOnError', 'prependTriggeredLine', 'enableParameters', 'parametersChar', 'enableNParameters', 'nParametersChar', 'enableParsing', 'externalWho', 'externalHelp', 'watchForProfilesChanges', 'onProfileChange', 'onProfileDeleted', 'enableDoubleParameterEscaping', 'ignoreEvalUndefined', 'enableInlineComments', 'enableBlockComments', 'inlineCommentString', 'blockCommentString', 'allowCommentsFromCommand', 'saveTriggerStateChanges', 'groupProfileSaves', 'groupProfileSaveDelay', 'returnNewlineOnEmptyValue', 'pathDelay', 'pathDelayCount', 'echoSpeedpaths', 'alwaysShowTabs', 'scriptEngineType', 'initializeScriptEngineOnLoad', 'find.highlight', 'find.location', 'display.showInvalidMXPTags', 'display.showTimestamp', 'display.timestampFormat', 'display.displayControlCodes', 'display.emulateTerminal', 'display.emulateControlCodes', 'display.wordWrap', 'display.tabWidth', 'display.wrapAt', 'display.indent', 'statusWidth', 'showEditorInTaskBar', 'trayMenu', 'lockLayout', 'loadLayout', 'useSingleInstance', 'statusWidth', 'characterManagerDblClick', 'warnAdvancedSettings', 'showAdvancedSettings', 'enableTabCompletion', 'tabCompletionBufferLimit', 'ignoreCaseTabCompletion', 'enableNotifications', 'commandAutoSize', 'commandWordWrap', 'commandScrollbars', 'tabCompletionList', 'tabCompletionLookupType', 'tabCompletionReplaceCasing', 'characterManagerAddButtonAction', 'enableCrashReporting', 'characterManagerPanelWidth', 'ignoreInputLeadingWhitespace', 'profiles.find.case', 'profiles.find.word', 'profiles.find.reverse', 'profiles.find.regex', 'profiles.find.selection', 'profiles.find.show', 'profiles.find.value', 'skipMore', 'skipMoreDelay', 'commandMinLines', 'simpleAlarms', 'simpleEditor', 'selectLastCommand'];\n\n/**\n * Class that contains all options, sets default values and allows loading and saving to json files\n *\n * @export\n * @class Settings\n */\nexport class Settings {\n    public colors: string[];\n    public enableTriggers: boolean;\n    public showErrorsExtended: boolean;\n    public logErrors: boolean;\n    public commandEcho: boolean;\n    public autoConnect: boolean;\n    public keepLastCommand: boolean;\n\n    constructor() {\n        /*\n        let subs;\n        let obj;\n        let k;\n        let kl;\n        */\n        for (var s = 0, sl = SettingList.length; s < sl; s++) {\n            if (SettingList[s][2] === SettingType.Custom) continue;\n            this[SettingList[s][0]] = Settings.getValue(SettingList[s][0]);\n            /*\n            subs = SettingList[s][0].split('.');\n            if ((kl = subs.length) > 1) {\n                obj = this[subs[0]] = {};\n                for (k = 1; k < kl - 1; k++) {\n                    obj[subs[k]] = {};\n                }\n                obj[subs[subs.length-1]] = Settings.getValue(SettingList[s][0]);\n            }\n            */\n        }\n        this.colors = Settings.getValue('colors');\n    }\n\n    public static settingError = false;\n\n    public static getValue(setting: string, defaultValue?: any) {\n        var tmp;\n        if (Settings.settingError) {\n            if (defaultValue === null || typeof defaultValue == 'undefined')\n                return Settings.defaultValue(setting);\n            return defaultValue;\n        }\n        try {\n            tmp = $.jStorage.get(setting);\n            if (typeof tmp == 'undefined' || tmp === null) {\n                if (defaultValue === null || typeof defaultValue == 'undefined')\n                    return Settings.defaultValue(setting);\n                return defaultValue;\n            }\n            switch (setting) {\n                case 'showChat':\n                case 'showStatus':\n                case 'showButtons':\n                case 'enableCommands':\n                case 'enableVerbatim':\n                case 'allowEscape':\n                case 'autoConnect':\n                case 'mapFollow':\n                case 'mapEnabled':\n                case 'flashing':\n                case 'commandEcho':\n                case 'enableAliases':\n                case 'enableTriggers':\n                case 'enableButtons':\n                case 'enableMacros':\n                case 'commandStacking':\n                case 'htmlLog':\n                case 'keepLastCommand':\n                case 'fullScreen':\n                case 'enableMXP':\n                case 'enableURLDetection':\n                case 'enableMCCP':\n                case 'enableUTF8':\n                case 'parseCommands':\n                case 'lagMeter':\n                case 'showScriptErrors':\n                case 'enablePing':\n                case 'enableEcho':\n                case 'enableSpeedpaths':\n                case 'parseSpeedpaths':\n                case 'mapper.enabled':\n                case 'MapperSplitArea':\n                case 'mapper.split':\n                case 'MapperFillWalls':\n                case 'mapper.fill':\n                case 'mapper.follow':\n                case 'MapperOpen':\n                case 'showMapper':\n                case 'parseSingleQuotes':\n                case 'parseDoubleQuotes':\n                case 'logEnabled':\n                case 'logOffline':\n                case 'logPrepend':\n                case 'logUniqueOnConnect':\n                case 'toolsPinned':\n                case 'notifyMSPPlay':\n                case 'CommandonClick':\n                case 'allowEval':\n                case 'disableTriggerOnError':\n                case 'prependTriggeredLine':\n                case 'chat.captureLines':\n                case 'chat.captureAllLines':\n                case 'chat.captureReviews':\n                case 'chat.captureTells':\n                case 'chat.captureTalk':\n                case 'chat.gag':\n                case 'chat.CaptureOnlyOpen':\n                case 'simpleAlarms':\n                case 'simpleEditor':\n                case 'selectLastCommand':\n                    if (tmp == 1)\n                        return true;\n                    return false;\n                case 'colors':\n                case 'chat.lines':\n                    if (tmp === null || typeof tmp == 'undefined' || tmp.length === 0)\n                        return [];\n                    return JSON.parse(tmp);\n            }\n            return tmp;\n        }\n        catch (err) {\n            if (!Settings.settingError) {\n                alert('Unable to save to localStorage so reverting to default,\\n\\nError description: ' + err.message);\n                Settings.settingError = true;\n            }\n            if (defaultValue === null || typeof defaultValue == 'undefined')\n                return Settings.defaultValue(defaultValue);\n            return defaultValue;\n        }\n    }\n\n    public static setValue(setting: string, value) {\n        switch (setting) {\n            case 'colors':\n            case 'chat.lines':\n                if (value === null || typeof value == 'undefined' || value.length === 0)\n                    $.jStorage.deleteKey(setting);\n                else\n                    $.jStorage.set(setting, JSON.stringify(value));\n                break;\n            default:\n                if (typeof value == 'boolean') {\n                    if (value)\n                        $.jStorage.set(setting, 1);\n                    else\n                        $.jStorage.set(setting, 0);\n                }\n                else\n                    $.jStorage.set(setting, value);\n                break;\n        }\n    }\n\n    public static clearValue(setting: string) {\n        $.jStorage.deleteKey(setting);\n    }\n\n    public static defaultValue(setting) {\n        switch (setting) {\n            case 'bufferSize': return 500;\n            case 'commandDelay': return 500;\n            case 'commandDelayCount': return 5;\n            case 'commandHistorySize': return 20;\n            case 'fontSize': return '1em';\n            case 'cmdfontSize': return '1em';\n            case 'commandEcho': return true;\n            case 'flashing': return false;\n            case 'autoConnect': return true;\n            case 'enableAliases': return true;\n            case 'enableTriggers': return true;\n            case 'enableMacros': return true;\n            case 'showScriptErrors': return false;\n            case 'commandStacking': return true;\n            case 'commandStackingChar': return ';';\n            case 'htmlLog': return true;\n            case 'keepLastCommand': return true;\n            case 'enableMCCP': return true;\n            case 'enableUTF8': return true;\n            case 'font': return '\\'Courier New\\', Courier, monospace';\n            case 'cmdfont': return '\\'Courier New\\', Courier, monospace';\n            case 'mapFollow':\n            case 'mapper.follow': return true;\n            case 'mapEnabled':\n            case 'mapper.enabled': return true;\n            case 'MapperSplitArea':\n            case 'mapper.split': return false;\n            case 'MapperFillWalls':\n            case 'mapper.fill': return false;\n            case 'MapperOpen':\n            case 'showMapper': return false;\n            case 'fullScreen': return false;\n            case 'enableMXP': return true;\n            case 'enableMSP': return true;\n            case 'parseCommands': return true;\n            case 'lagMeter': return false;\n            case 'enablePing': return false;\n            case 'enableEcho': return true;\n            case 'enableSpeedpaths': return true;\n            case 'speedpathsChar': return '!';\n            case 'parseSpeedpaths': return true;\n            case 'profile': return 'Default';\n            case 'parseSingleQuotes': return false;\n            case 'parseDoubleQuotes': return true;\n            case 'logEnabled': return false;\n            case 'logPrepend': return false;\n            case 'logOffline': return false;\n            case 'logUniqueOnConnect': return true;\n            case 'enableURLDetection': return true;\n            case 'notifyMSPPlay': return false;\n            case 'CommandonClick': return true;\n            case 'allowEval': return true;\n            case 'allowEscape': return true;\n            case 'AutoCopySelectedToClipboard': return false;\n            case 'enableDebug': return false;\n            case 'editorPersistent': return false;\n            case 'askonclose': return true;\n            case 'dev': return false;\n            //New settings\n            case 'chat.captureLines': return false;\n            case 'chat.captureAllLines': return false;\n            case 'chat.captureReviews': return false;\n            case 'chat.captureTells': return false;\n            case 'chat.captureTalk': return false;\n            case 'chat.gag': return false;\n            case 'chat.CaptureOnlyOpen': return false;\n            case 'checkForUpdates': return false;\n            case 'autoCreateCharacter': return false;\n            case 'askonchildren': return true;\n            case 'mapper.legend': return false;\n            case 'mapper.room': return false;\n            case 'mapper.importType': return 1;\n            case 'mapper.vscroll': return 0;\n            case 'mapper.hscroll': return 0;\n            case 'mapper.scale': return 100;\n            case 'mapper.active': return {\n                ID: null,\n                x: 0,\n                y: 0,\n                z: 0,\n                area: null,\n                zone: 0\n            };\n            case 'mapper.active.ID': return null;\n            case 'mapper.active.x': return 0;\n            case 'mapper.active.y': return 0;\n            case 'mapper.active.z': return 0;\n            case 'mapper.active.area': return null;\n            case 'mapper.active.zone': return 0;\n            case 'profiles.split': return 200;\n            case 'profiles.askoncancel': return true;\n            case 'profiles.triggersAdvanced': return false;\n            case 'profiles.aliasesAdvanced': return false;\n            case 'profiles.buttonsAdvanced': return false;\n            case 'profiles.macrosAdvanced': return false;\n            case 'profiles.contextsAdvanced': return false;\n            case 'profiles.codeEditor': return true;\n            case 'chat.log': return false;\n            case 'chat.zoom': return 1;\n            case 'chat.font': return '\\'Courier New\\', Courier, monospace';\n            case 'chat.fontSize': return '1em';\n            case 'title': return '$t';\n            case 'logGagged': return false;\n            case 'logTimeFormat': return 'YYYYMMDD-HHmmss';\n            case 'autoConnectDelay': return 600;\n            case 'autoLogin': return true;\n            case 'onDisconnect': return OnDisconnect.ReconnectDialog;\n            case 'enableKeepAlive': return false;\n            case 'keepAliveDelay': return 0;\n            case 'newlineShortcut': return NewLineType.Ctrl;\n            case 'logWhat': return Log.Html;\n            case 'logErrors': return true;\n            case 'showErrorsExtended': return false;\n            case 'reportCrashes': return false;\n            case 'enableCommands': return true;\n            case 'commandChar': return '#';\n            case 'escapeChar': return '\\\\';\n            case 'enableVerbatim': return true;\n            case 'verbatimChar': return '`';\n            case 'soundPath': return '';\n            case 'logPath': return '';\n            case 'theme': return '';\n            case 'gamepads': return false;\n            case 'backupLoad': return BackupSelection.All;\n            case 'backupSave': return BackupSelection.All;\n            case 'backupAllProfiles': return true;\n            case 'backupReplaceCharacters': return true;\n            case 'scrollLocked': return false;\n            case 'showStatus': return true;\n            case 'showChat': return false;\n            case 'showEditor': return false;\n            case 'showArmor': return false;\n            case 'showStatusWeather': return true;\n            case 'showStatusLimbs': return true;\n            case 'showStatusHealth': return true;\n            case 'showStatusExperience': return true;\n            case 'showStatusPartyHealth': return true;\n            case 'showStatusCombatHealth': return true;\n            case 'allowNegativeNumberNeeded': return false;\n            case 'spellchecking': return true;\n            case 'statusExperienceNeededProgressbar': return false;\n            case 'pasteSpecialPrefix': return '';\n            case 'pasteSpecialPostfix': return '';\n            case 'pasteSpecialReplace': return '';\n            case 'pasteSpecialPrefixEnabled': return true;\n            case 'pasteSpecialPostfixEnabled': return true;\n            case 'pasteSpecialReplaceEnabled': return true;\n            case 'display.showSplitButton': return true;\n            case 'chat.bufferSize': return 500;\n            case 'chat.flashing': return false;\n            case 'display.hideTrailingEmptyLine': return true;\n            case 'display.enableColors': return true;\n            case 'display.enableBackgroundColors': return true;\n            case 'enableSound': return true;\n            case 'editorClearOnSend': return true;\n            case 'editorCloseOnSend': return true;\n            case 'askOnCloseAll': return true;\n            case 'askonloadCharacter': return true;\n            case 'mapper.roomWidth': return 200;\n            case 'mapper.roomGroups': return 1 | 2 | 4;\n            case 'mapper.showInTaskBar': return false;\n            case 'profiles.enabled': return [];\n            case 'profiles.sortOrder': return ProfileSortOrder.Priority | ProfileSortOrder.Index;\n            case 'profiles.sortDirection': return 1;\n            case 'profiles.profileSelected': return 'default';\n            case 'profiles.profileExpandSelected': return true;\n            case 'chat.lines': return [];\n            case 'chat.showTimestamp': return false;\n            case 'chat.timestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'chat.tabWidth': return 8;\n            case 'chat.displayControlCodes': return false;\n            case 'chat.emulateTerminal': return false;\n            case 'chat.emulateControlCodes': return true;\n            case 'chat.wordWrap': return false;\n            case 'chat.wrapAt': return 0;\n            case 'chat.indent': return 4;\n            case 'autoTakeoverLogin': return false;\n            case 'maxReconnectDelay': return 3600;\n            case 'showLagInTitle': return false;\n            case 'mspMaxRetriesOnError': return 0;\n            case 'logTimestamp': return false;\n            case 'logTimestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'disableTriggerOnError': return true;\n            case 'prependTriggeredLine': return true;\n            case 'enableParameters': return true;\n            case 'parametersChar': return '%';\n            case 'enableNParameters': return true;\n            case 'nParametersChar': return '$';\n            case 'enableParsing': return true;\n            case 'onProfileChange': return OnProfileChange.Nothing;\n            case 'onProfileDeleted': return OnProfileDeleted.Nothing;\n            case 'enableDoubleParameterEscaping': return false;\n            case 'ignoreEvalUndefined': return true;\n            case 'enableInlineComments': return true;\n            case 'enableBlockComments': return true;\n            case 'inlineCommentString': return '//';\n            case 'blockCommentString': return '/*';\n            case 'allowCommentsFromCommand': return false;\n            case 'saveTriggerStateChanges': return true;\n            case 'groupProfileSaves': return false;\n            case 'groupProfileSaveDelay': return 20000;\n            case 'returnNewlineOnEmptyValue': return false;\n            case 'pathDelay': return 0;\n            case 'pathDelayCount': return 1;\n            case 'echoSpeedpaths': return false;\n            case 'scriptEngineType': return ScriptEngineType.Simple;\n            case 'initializeScriptEngineOnLoad': return false;\n            case 'display.showInvalidMXPTags': return false;\n            case 'display.showTimestamp': return false;\n            case 'display.timestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'display.displayControlCodes': return false;\n            case 'display.emulateTerminal': return false;\n            case 'display.emulateControlCodes': return true;\n            case 'display.wordWrap': return false;\n            case 'display.tabWidth': return 8;\n            case 'display.wrapAt': return 0;\n            case 'display.indent': return 4;\n            case 'statusWidth': return -1;\n            case 'extensions': return {};\n            case 'warnAdvancedSettings': return true;\n            case 'showAdvancedSettings': return false;\n            case 'enableTabCompletion': return true;\n            case 'ignoreCaseTabCompletion': return false;\n            case 'tabCompletionBufferLimit': return 100;\n            case 'enableNotifications': return true;\n            case 'echo': return Echo.None;\n            case 'commandAutoSize': return false;\n            case 'commandWordWrap': return false;\n            case 'commandMinLines': return 1;\n            case 'tabCompletionLookupType': return TabCompletion.PrependBuffer;\n            case 'tabCompletionList': return '';\n            case 'tabCompletionReplaceCasing': return 0;\n            case 'ignoreInputLeadingWhitespace': return false;\n            case 'skipMore': return false;\n            case 'skipMoreDelay': return 5000;\n            case 'simpleAlarms': return false;\n            case 'simpleEditor': return false;\n            case 'selectLastCommand': return true;\n        }\n        return null;\n    }\n\n    public save() {\n        for (var prop in this) {\n            if (!this.hasOwnProperty(prop)) continue;\n            Settings.setValue(prop, this[prop]);\n        }\n    }\n\n    public reset() {\n        for (var s = 0, sl = SettingList.length; s < sl; s++) {\n            if (SettingList[s][2] === SettingType.Custom) continue;\n            this[SettingList[s][0]] = Settings.defaultValue(SettingList[s][0]);\n        }\n        this.colors = [];\n    }\n}", "//spell-checker:ignore displaytype, submenu, triggernewline, triggerprompt\nimport { clone, keyCodeToChar, SortItemArrayByPriority, splitQuoted, isValidIdentifier } from './library';\ndeclare let localforage;\n\nexport enum MacroModifiers {\n    None = 0,\n    Alt = 2,\n    Ctrl = 4,\n    Shift = 8,\n    Meta = 16,\n    All = Alt | Ctrl | Shift | Meta\n}\n\nexport enum ItemDisplayType {\n    Text = 0,\n    Function = 1\n}\n\nexport enum ItemStyle {\n    Text = 0,\n    Parse = 1,\n    Script = 2\n}\n\nexport enum TriggerType {\n    Regular = 0,\n    CommandInputRegular = 1,\n    Event = 2,\n    Alarm = 3,\n    Pattern = 8,\n    CommandInputPattern = 16,\n    Expression = 1 << 6,\n    LoopExpression = 1 << 7\n}\n\nexport enum TriggerTypes {\n    None = 0,\n    CommandInputRegular = 1,\n    Event = 2,\n    Regular = 4,\n    Pattern = 8,\n    CommandInputPattern = 16,\n    Alarm = 32,\n    Expression = 1 << 6,\n    LoopExpression = 1 << 7\n}\n\nexport enum SubTriggerTypes {\n    Skip = 1 << 9,\n    Wait = 1 << 10,\n    LoopPattern = 1 << 12,\n    LoopLines = 1 << 13,\n    Duration = 1 << 14,\n    WithinLines = 1 << 15,\n    Manual = 1 << 16,\n    ReParse = 1 << 17,\n    ReParsePattern = 1 << 18\n}\n\nexport enum VariableType {\n    Auto = 1,\n    Integer = 2,\n    StringExpanded = 3,\n    StringLiteral = 4,\n    StringList = 5,\n    Record = 6,\n    Float = 7,\n    Array = 8\n}\n\nexport function MacroDisplay(item: Macro) {\n    const d = [];\n    if (item.gamepad > 0) {\n        d.push('Gamepad ' + item.gamepad);\n        if (item.key > 0)\n            d.push('Button ' + item.key);\n        else if (item.gamepadAxes < 0)\n            d.push('Axis ' + -item.gamepadAxes);\n        else if (item.gamepadAxes > 0)\n            d.push('Axis ' + item.gamepadAxes);\n        if (d.length === 1)\n            return 'None';\n        return d.join('+');\n    }\n    if (item.key === 0) {\n        if (item.name && item.name.length > 0)\n            return 'None - ' + item.name;\n        return 'None';\n    }\n    if ((item.modifiers & MacroModifiers.Ctrl) === MacroModifiers.Ctrl)\n        d.push('Ctrl');\n    if ((item.modifiers & MacroModifiers.Alt) === MacroModifiers.Alt)\n        d.push('Alt');\n    if ((item.modifiers & MacroModifiers.Shift) === MacroModifiers.Shift)\n        d.push('Shift');\n    if ((item.modifiers & MacroModifiers.Meta) === MacroModifiers.Meta)\n        d.push('Meta');\n    if (keyCodeToChar[item.key])\n        d.push(keyCodeToChar[item.key]);\n    else if (item.name && item.name.length > 0)\n        return 'None - ' + item.name;\n    else\n        return 'None';\n    if (item.name && item.name.length > 0)\n        return d.join('+') + ' - ' + item.name;\n    return d.join('+');\n}\n\nexport class Alarm {\n    public parent: Trigger;\n    public pattern: string;\n    public temp: boolean = false;\n    public start: boolean = false;\n    public seconds: number = -1;\n    public secondsWildcard: boolean = true;\n    public hours: number = -1;\n    public hoursWildcard: boolean = true;\n    public minutes: number = -1;\n    public minutesWildcard: boolean = true;\n    public startTime: number;\n    public suspended: number = 0;\n    public restart: number = 0;\n    public tempTime: number;\n    public prevTime: number;\n\n    constructor(data?, pattern?) {\n        if (typeof data === 'string') {\n            pattern = data;\n            data = 0;\n        }\n        this.parent = data;\n        this.pattern = pattern;\n        this.startTime = Date.now();\n        this.prevTime = this.startTime;\n    }\n\n    public static parse(parent, pattern?: string, readOnly?: boolean): Alarm {\n        if (typeof parent === 'string') {\n            pattern = parent;\n            parent = 0;\n        }\n        if (!pattern || pattern.length === 0) {\n            if (typeof parent === 'object')\n                pattern = parent.pattern;\n            else\n                throw new Error('Blank pattern');\n        }\n        const t = new Alarm(parent, pattern);\n        while (pattern[0] === '-' || pattern[0] === '+') {\n            if (pattern[0] === '-')\n                t.start = true;\n            else if (pattern[0] === '+')\n                t.temp = true;\n            pattern = pattern.substr(1);\n        }\n        if (pattern !== '*') {\n            const parts = pattern.split(':');\n            let tmp;\n            if (parts.length === 0)\n                throw new Error('Invalid format: ' + pattern);\n            if (parts.length === 1) {\n                if (parts[0] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0)\n                        throw new Error('Seconds must be greater than or equal to 0.');\n                    else if (tmp > 59)\n                        t.secondsWildcard = true;\n                    t.seconds = tmp;\n                }\n            }\n            else if (parts.length === 2) {\n                if (parts[0] === '*') {\n                    t.minutesWildcard = true;\n                    t.minutes = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.minutesWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.minutesWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Minutes can only be 0 to 59');\n                    t.minutes = tmp;\n                }\n                if (parts[1] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[1][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[1] = parts[1].substr(1);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[1], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[1]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Seconds can only be 0 to 59');\n                    t.seconds = tmp;\n                }\n            }\n            else {\n                if (parts[0] === '*') {\n                    t.hoursWildcard = true;\n                    t.hours = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.hoursWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.hoursWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0 || tmp > 23)\n                        throw new Error('Hours can only be 0 to 23');\n                    t.hours = tmp;\n                }\n                if (parts[1] === '*') {\n                    t.minutesWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[1][0] === '*') {\n                        t.minutesWildcard = true;\n                        parts[1] = parts[1].substr(1);\n                    }\n                    else\n                        t.minutesWildcard = false;\n                    tmp = parseInt(parts[1], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[1]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Minutes can only be 0 to 59');\n                    t.minutes = tmp;\n                }\n                if (parts[2] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[2][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[2] = parts[2].substr(2);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[2], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[2]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Seconds can only be 0 to 59');\n                    t.seconds = tmp;\n                }\n            }\n        }\n        if (readOnly)\n            t.temp = false;\n        return t;\n    }\n\n    public setTempTime(value: number) {\n        if (!value)\n            this.tempTime = 0;\n        else\n            this.tempTime = Date.now() + value;\n    }\n}\n\nexport class Item {\n    public name: string = '';\n    public priority: number = 0;\n    public display: string = 'name';\n    public displaytype: ItemDisplayType = ItemDisplayType.Text;\n    public value: string = '';\n    public style: ItemStyle = ItemStyle.Parse;\n    public group: string = '';\n    public enabled: boolean = true;\n    public notes: string = '';\n    public profile: Profile;\n\n    constructor(data?, profile?) {\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Item(this);\n    }\n}\n\nexport class Button extends Item {\n    public caption: string = '';\n    public icon: string = '';\n    public append: boolean = false;\n    public send: boolean = true;\n    public chain: boolean = false;\n    public stretch: boolean = false;\n    public parse: boolean = false;\n    public top: number = -1;\n    public left: number = -1;\n    public right: number = -1;\n    public bottom: number = -1;\n    public width: number = 64;\n    public height: number = 64;\n    public iconOnly: boolean = false;\n\n    constructor(data?, profile?) {\n        super(data);\n        this.caption = 'NewButton';\n        this.display = 'caption';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Button(this);\n    }\n}\n\nexport class Macro extends Item {\n    public key: number = 0;\n    public append: boolean = false;\n    public send: boolean = true;\n    public modifiers: MacroModifiers = MacroModifiers.None;\n    public chain: boolean = false;\n    public gamepad: number = 0;\n    public gamepadAxes: number = 0;\n\n    constructor(data?, profile?) {\n        super();\n        this.display = 'return MacroDisplay(item)';\n        this.displaytype = ItemDisplayType.Function;\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Macro(this);\n    }\n}\n\nexport class Alias extends Item {\n    public pattern: string = 'NewAlias';\n    public regexp: boolean = false;\n    public multi: boolean = false;\n    public append: boolean = true;\n    public params: string = '';\n\n    constructor(pattern?: any, value?: string, profile?) {\n        super();\n        if (typeof pattern === 'string')\n            this.pattern = pattern;\n        if (value != null)\n            this.value = value;\n        this.display = 'pattern';\n        if (typeof pattern === 'object') {\n            let prop;\n            for (prop in pattern) {\n                if (!pattern.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = pattern[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Alias(this);\n    }\n}\n\nexport class Trigger extends Item {\n    public pattern: string = 'NewTrigger';\n    public verbatim: boolean = false;\n    public triggerNewline: boolean = true;\n    public triggerPrompt: boolean = false;\n    public type: TriggerType | SubTriggerTypes = TriggerType.Regular;\n    public temp: boolean = false;\n    public caseSensitive: boolean = false;\n    public raw: boolean = false;\n    public state: number = 0;\n    public params: string = '';\n    public triggers: Trigger[] = [];\n    public fired: boolean = false;\n\n    constructor(data?, profile?) {\n        super(data);\n        this.display = 'pattern';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                if (prop === 'triggers') {\n                    this.triggers = [];\n                    const il = data.triggers.length;\n                    for (let i = 0; i < il; i++) {\n                        this.triggers.push(new Trigger(data.triggers[i]));\n                    }\n                }\n                else\n                    this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Trigger(this);\n    }\n\n    public getState(state) {\n        if (state === 0)\n            return this;\n        state--;\n        if (state >= this.triggers.length || state < 0) return null;\n        return this.triggers[state];\n    }\n}\n\nexport class Context extends Item {\n    public caption: string = '';\n    public icon: string = '';\n    public append: boolean = false;\n    public send: boolean = true;\n    public chain: boolean = false;\n    public parent: string = '';\n    public items: Context[] = [];\n    public parse: boolean = false;\n    constructor(data?, profile?) {\n        super(data);\n        this.caption = 'NewContext';\n        this.display = 'caption';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                if (prop === 'items') {\n                    let i = 0;\n                    const il = data[prop].length;\n                    for (; i < il; i++)\n                        this.items.push(new Context(data[prop][i]));\n                }\n                else\n                    this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Context(this);\n    }\n}\n\nexport class Variable extends Item {\n    private _type: string = 'string';\n\n    public type: VariableType = VariableType.Auto;\n    public defaultValue: string = '';\n    public useDefault: boolean = false;\n    public params: string = '';\n\n    public set setValue(value: any) {\n        switch (this.type) {\n            case VariableType.Integer:\n                if (typeof value === 'string') {\n                    value = parseInt(value, 10);\n                    if (isNaN(value))\n                        value = 0;\n                }\n                else if (typeof value === 'boolean')\n                    value = value ? 1 : 0;\n                break;\n            case VariableType.Float:\n                if (typeof value === 'string') {\n                    value = parseFloat(value);\n                    if (isNaN(value))\n                        value = 0.0;\n                }\n                else if (typeof value === 'boolean')\n                    value = value ? 1.0 : 0.0;\n                break;\n        }\n        this.value = value;\n        this._type = typeof value;\n    }\n    public get getValue(): any {\n        switch (this.type) {\n            case VariableType.Auto:\n                if (typeof this.value !== this._type) {\n                    switch (this._type) {\n                        case 'number':\n                            return Number(this.value);\n                        case 'string':\n                            return this.value.toString();\n                        case 'boolean':\n                            return Boolean(this.value);\n                    }\n                }\n                return this.value;\n            case VariableType.Float:\n                return parseFloat(this.value);\n            case VariableType.Integer:\n                return parseInt(this.value, 10);\n            case VariableType.Record:\n                if (typeof this.value === 'string')\n                    try {\n                        return JSON.parse(this.value);\n                    }\n                    catch {\n                        return this.value;\n                    }\n                return this.value;\n            case VariableType.StringList:\n                if (typeof this.value === 'string')\n                    return splitQuoted(this.value, '|');\n                return this.value;\n        }\n        return this.value;\n    }\n\n    constructor(data?, profile?) {\n        super(data);\n        this.profile = profile;\n        if (this.useDefault)\n            this.setValue(this.defaultValue);\n    }\n\n    public clone() {\n        return new Variable(this);\n    }\n\n    public toString() {\n        switch (this.type) {\n            case VariableType.Record:\n                if (typeof this.value === 'string')\n                    return this.value;\n                return JSON.stringify(this.value);\n            case VariableType.StringList:\n                if (typeof this.value === 'string')\n                    return this.value;\n                return '\"' + (<any[]>this.value).join('\"|\"') + '\"';\n        }\n        return this.value?.toString();\n    }\n}\n\nexport class Profile {\n    public name: string = '';\n    public file: string = '';\n    public priority: number = 0;\n    public enabled: boolean = true;\n    public aliases: Alias[] = [];\n    public triggers: Trigger[] = [];\n    public macros: Macro[] = [];\n    public buttons: Button[] = [];\n    public contexts: Context[] = [];\n    public enableMacros: boolean = true;\n    public enableTriggers: boolean = true;\n    public enableAliases: boolean = true;\n    public enableButtons: boolean = true;\n    public enableContexts: boolean = true;\n    public enableDefaultContext: boolean = true;\n\n    constructor(name?: (string | boolean), defaults?: boolean) {\n        if (typeof name === 'string') {\n            this.name = name;\n            this.file = name.toLowerCase();\n            if (defaults == null || defaults)\n                this.macros = Profile.DefaultMacros;\n        }\n        else if (typeof name === 'boolean') {\n            if (name)\n                this.macros = Profile.DefaultMacros;\n        }\n        else if (defaults == null || defaults)\n            this.macros = Profile.DefaultMacros;\n    }\n\n    static get Default(): Profile {\n        return new Profile('Default');\n    }\n\n    static get DefaultMacros(): Macro[] {\n        const data = [\n            {\n                key: 97,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'sw',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'SouthWest',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 98,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 's',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'South',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 99,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'se',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'SouthEast',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 100,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'w',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'West',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 101,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'l',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'Look',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 102,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'e',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'East',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 103,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'nw',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'NorthWest',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 104,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'n',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'North',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 105,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'ne',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'NorthEast',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            }\n        ];\n        const m: Macro[] = [];\n        const dl = data.length;\n        for (let d = 0; d < dl; d++)\n            m.push(new Macro(data[d]));\n        return m;\n    }\n\n    static get DefaultButtons(): Button[] {\n        const buttons: Button[] = [];\n        let b;\n        b = new Button();\n        b.right = 176;\n        b.top = 14;\n        b.caption = 'fa-solid fa-angle-double-up';\n        b.value = 'up';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up,rotate--45';\n        b.value = 'northwest';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up';\n        b.value = 'north';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up,rotate-45';\n        b.value = 'northeast';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 176;\n        b.top = 66;\n        b.caption = 'fa-solid fa-crosshairs';\n        b.value = 'kill ${selected}';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 66;\n        b.caption = 'fa-solid fa-caret-left';\n        b.value = 'west';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 66;\n        b.caption = 'fa-solid fa-magnifying-glass';\n        b.value = 'look ${selected}';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 66;\n        b.caption = 'fa-solid fa-caret-right';\n        b.value = 'east';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 176;\n        b.top = 118;\n        b.caption = 'fa-solid fa-angle-double-down';\n        b.value = 'down';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down,rotate-45';\n        b.value = 'southwest';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down';\n        b.value = 'south';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down,rotate--45';\n        b.value = 'southeast';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        return buttons;\n    }\n\n    public static load(file) {\n        let profile;\n        let data;\n        if (typeof file === 'object')\n            data = file;\n        else\n            return new Profile();\n        profile = new Profile(false);\n        let prop;\n        for (prop in data) {\n            if (!data.hasOwnProperty(prop)) {\n                continue;\n            }\n            if (prop === 'aliases' || prop === 'triggers' || prop === 'macros' || prop === 'buttons' || prop === 'contexts' || prop === 'variables')\n                continue;\n            profile[prop] = data[prop];\n        }\n\n        let i;\n        let il;\n        if (data.aliases && data.aliases.length > 0) {\n            il = data.aliases.length;\n            for (i = 0; i < il; i++) {\n                profile.aliases.push(new Alias(data.aliases[i], null, profile));\n            }\n        }\n        if (data.triggers && data.triggers.length > 0) {\n            il = data.triggers.length;\n            for (i = 0; i < il; i++) {\n                profile.triggers.push(new Trigger(data.triggers[i], profile));\n            }\n        }\n        if (data.macros && data.macros.length > 0) {\n            il = data.macros.length;\n            profile.macros = [];\n            for (i = 0; i < il; i++) {\n                profile.macros.push(new Macro(data.macros[i], profile));\n            }\n        }\n        if (data.buttons && data.buttons.length > 0) {\n            il = data.buttons.length;\n            for (i = 0; i < il; i++) {\n                profile.buttons.push(new Button(data.buttons[i], profile));\n            }\n        }\n        if (data.contexts && data.contexts.length > 0) {\n            il = data.contexts.length;\n            for (i = 0; i < il; i++) {\n                profile.contexts.push(new Context(data.contexts[i], profile));\n            }\n        }\n        profile.file = profile.name;\n        return profile;\n    }\n\n    public clone(version?: number) {\n        let data;\n        let i;\n        let il;\n        if (version === 2) {\n            data = {\n                name: this.name,\n                priority: this.priority,\n                enabled: this.enabled,\n                aliases: [],\n                triggers: [],\n                macros: [],\n                buttons: [],\n                contexts: [],\n                enableMacros: this.enableMacros,\n                enableTriggers: this.enableTriggers,\n                enableAliases: this.enableAliases,\n                enableButtons: this.enableButtons,\n                enableContexts: this.enableContexts,\n                enableDefaultContext: this.enableDefaultContext\n            };\n\n            if (this.aliases.length > 0) {\n                il = this.aliases.length;\n                for (i = 0; i < il; i++) {\n                    data.aliases.push({\n                        pattern: this.aliases[i].pattern,\n                        value: this.aliases[i].value,\n                        priority: this.aliases[i].priority,\n                        regexp: this.aliases[i].regexp,\n                        style: this.aliases[i].style,\n                        multi: this.aliases[i].multi,\n                        append: this.aliases[i].append,\n                        name: this.aliases[i].name,\n                        group: this.aliases[i].group,\n                        enabled: this.aliases[i].enabled,\n                        params: this.aliases[i].params,\n                        display: this.aliases[i].display,\n                        notes: this.aliases[i].notes || ''\n                    });\n                }\n            }\n            if (this.triggers.length > 0) {\n                il = this.triggers.length;\n                for (i = 0; i < il; i++) {\n                    const t = {\n                        pattern: this.triggers[i].pattern,\n                        value: this.triggers[i].value,\n                        priority: this.triggers[i].priority,\n                        verbatim: this.triggers[i].verbatim,\n                        style: this.triggers[i].style,\n                        name: this.triggers[i].name,\n                        group: this.triggers[i].group,\n                        enabled: this.triggers[i].enabled,\n                        display: this.triggers[i].display,\n                        triggernewline: this.triggers[i].triggerNewline,\n                        caseSensitive: this.triggers[i].caseSensitive,\n                        triggerprompt: this.triggers[i].triggerPrompt,\n                        raw: this.triggers[i].raw,\n                        type: this.triggers[i].type,\n                        notes: this.triggers[i].notes || '',\n                        state: this.triggers[i].state || 0,\n                        params: this.triggers[i].params || '',\n                        triggers: []\n                    }\n                    if (this.triggers[i].triggers && this.triggers[i].triggers.length) {\n                        const sl = this.triggers[i].triggers.length;\n                        for (let s = 0; s < sl; s++) {\n                            t.triggers.push({\n                                pattern: this.triggers[i].triggers[s].pattern,\n                                value: this.triggers[i].triggers[s].value,\n                                priority: this.triggers[i].triggers[s].priority,\n                                verbatim: this.triggers[i].triggers[s].verbatim,\n                                style: this.triggers[i].triggers[s].style,\n                                name: this.triggers[i].triggers[s].name,\n                                group: this.triggers[i].triggers[s].group,\n                                enabled: this.triggers[i].triggers[s].enabled,\n                                display: this.triggers[i].triggers[s].display,\n                                triggernewline: this.triggers[i].triggers[s].triggerNewline,\n                                caseSensitive: this.triggers[i].triggers[s].caseSensitive,\n                                triggerprompt: this.triggers[i].triggers[s].triggerPrompt,\n                                raw: this.triggers[i].triggers[s].raw,\n                                type: this.triggers[i].triggers[s].type,\n                                notes: this.triggers[i].triggers[s].notes || '',\n                                state: this.triggers[i].triggers[s].state || 0,\n                                params: this.triggers[i].triggers[s].params || '',\n                                triggers: []\n                            });\n                        }\n                    }\n                    data.triggers.push(t);\n                }\n            }\n            if (this.macros.length > 0) {\n                il = this.macros.length;\n                for (i = 0; i < il; i++) {\n                    data.macros.push({\n                        key: this.macros[i].key,\n                        value: this.macros[i].value,\n                        style: this.macros[i].style,\n                        append: this.macros[i].append,\n                        send: this.macros[i].send,\n                        name: this.macros[i].name,\n                        group: this.macros[i].group,\n                        enabled: this.macros[i].enabled,\n                        display: 'if(item.key === 0) return \"None\"; return keyCodeToChar[item.key]',\n                        displaytype: 1,\n                        modifiers: this.macros[i].modifiers,\n                        chain: this.macros[i].chain,\n                        notes: this.macros[i].notes || ''\n                    });\n                }\n            }\n            if (this.buttons.length > 0) {\n                il = this.buttons.length;\n                for (i = 0; i < il; i++) {\n                    data.buttons.push(clone(this.buttons[i], (key, value) => {\n                        if (key === 'profile') return undefined;\n                        return value;\n                    }));\n                }\n            }\n            if (this.contexts.length > 0) {\n                il = this.contexts.length;\n                for (i = 0; i < il; i++) {\n                    data.contexts.push(clone(this.contexts[i], (key, value) => {\n                        if (key === 'profile') return undefined;\n                        return value;\n                    }));\n                }\n            }\n            return data;\n        }\n        data = clone(this, (key, value) => {\n            if (key === 'profile') return undefined;\n            return value;\n        });\n        const profile = new Profile(false);\n        let prop;\n        for (prop in data) {\n            if (!data.hasOwnProperty(prop)) {\n                continue;\n            }\n            if (prop === 'aliases' || prop === 'triggers' || prop === 'macros' || prop === 'buttons' || prop === 'contexts' || prop === 'variables')\n                continue;\n            profile[prop] = data[prop];\n        }\n\n        if (data.aliases && data.aliases.length > 0) {\n            il = data.aliases.length;\n            for (i = 0; i < il; i++) {\n                profile.aliases.push(new Alias(data.aliases[i], null, profile));\n            }\n        }\n        if (data.triggers && data.triggers.length > 0) {\n            il = data.triggers.length;\n            for (i = 0; i < il; i++) {\n                profile.triggers.push(new Trigger(data.triggers[i], profile));\n            }\n        }\n        if (data.macros && data.macros.length > 0) {\n            il = data.macros.length;\n            profile.macros = [];\n            for (i = 0; i < il; i++) {\n                profile.macros.push(new Macro(data.macros[i], profile));\n            }\n        }\n        if (data.buttons && data.buttons.length > 0) {\n            il = data.buttons.length;\n            for (i = 0; i < il; i++) {\n                profile.buttons.push(new Button(data.buttons[i], profile));\n            }\n        }\n        if (data.contexts && data.contexts.length > 0) {\n            il = data.contexts.length;\n            for (i = 0; i < il; i++) {\n                profile.contexts.push(new Context(data.contexts[i], profile));\n            }\n        }\n        return profile;\n    }\n\n    public find(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return tmp[t];\n        }\n        return null;\n    }\n\n    public findAny(type, field, value?) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] === field[v])\n                        return tmp[t];\n                }\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return tmp[t];\n        }\n        return null;\n    }\n\n    public indexOfAny(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] === field[v])\n                        return this[type].indexOf(tmp[t]);\n                }\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return this[type].indexOf(tmp[t]);\n        }\n        return -1;\n    }\n\n    public indexOf(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] !== field[v]) continue;\n                }\n                return this[type].indexOf(tmp[t]);\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return this[type].indexOf(tmp[t]);\n        }\n        return -1;\n    }\n}\n\nexport class ProfileCollection {\n    public items = {};\n    public keys = [];\n\n    constructor(defaultProfile?: Profile) {\n        this.add(defaultProfile == null ? Profile.Default : defaultProfile);\n    }\n\n    public SortByPriority() {\n        this.keys.sort((a, b) => {\n            let ap = this.items[a].priority;\n            let bp = this.items[b].priority;\n            if (ap > bp)\n                return -1;\n            if (ap < bp)\n                return 1;\n            if (a === 'default')\n                return -1;\n            if (b === 'default')\n                return 1;\n            ap = this.items[a].name;\n            bp = this.items[b].name;\n            if (ap > bp)\n                return 1;\n            if (ap < bp)\n                return -1;\n            return 0;\n        });\n    }\n\n    public enabled(profile: (string | Profile)): boolean {\n        if (!profile || this.keys.length === 0) return false;\n        if (typeof profile === 'string') {\n            if (!this.items[profile.toLowerCase()])\n                return false;\n            return this.items[profile.toLowerCase()].enabled;\n        }\n        return this.items[profile.name.toLowerCase()] ? this.items[profile.name.toLowerCase()].enabled : false;\n    }\n\n    public contains(profile: (string | Profile)): boolean {\n        if (!profile || this.keys.length === 0) return false;\n        if (typeof profile === 'string')\n            return this.items[profile.toLowerCase()] ? true : false;\n        return this.items[profile.name.toLowerCase()] ? true : false;\n    }\n\n    public canDisable(profile: any) {\n        if (!profile || this.keys.length === 0) return false;\n        let idx: any;\n        if (typeof profile === 'number') {\n            if (profile < 0)\n                return false;\n            if (profile >= this.keys.length)\n                return false;\n            idx = this.keys[profile];\n        }\n        else if (typeof profile === 'object')\n            idx = profile.name.toLowerCase();\n        else if (typeof profile === 'string')\n            idx = profile.toLowerCase();\n        else\n            return false;\n\n        if (!this.items[idx]) return false;\n        const e = !this.items[idx].enabled;\n        if (!e) {\n            let c = false;\n            for (const key in this.items) {\n                if (key === idx) continue;\n                if (this.items[key].enabled) c = true;\n                break;\n            }\n            if (!c)\n                return false;\n        }\n        return true;\n    }\n\n    public toggle(profile: any) {\n        if (!profile || this.keys.length === 0) return false;\n        let idx: any;\n        if (typeof profile === 'number') {\n            if (profile < 0)\n                return false;\n            if (profile >= this.keys.length)\n                return false;\n            idx = this.keys[profile];\n        }\n        else if (typeof profile === 'object')\n            idx = profile.name.toLowerCase();\n        else if (typeof profile === 'string')\n            idx = profile.toLowerCase();\n        else\n            return false;\n\n        if (!this.items[idx]) return false;\n        const e = !this.items[idx].enabled;\n        if (!e) {\n            let c = false;\n            for (const key in this.items) {\n                if (key === idx) continue;\n                if (this.items[key].enabled) c = true;\n                break;\n            }\n            if (!c)\n                return false;\n        }\n        this.items[idx].enabled = e;\n        return true;\n    }\n\n    public update() {\n        this.keys = Object.keys(this.items);\n        this.SortByPriority();\n    }\n\n    public add(profile: Profile) {\n        if (!profile)\n            return;\n        this.items[profile.name.toLowerCase()] = profile;\n        this.update();\n    }\n\n    public remove(profile: (string | Profile | number)) {\n        if (!profile || this.keys.length === 0) return;\n        if (typeof profile === 'string')\n            delete this.items[profile.toLowerCase()];\n        else if (typeof profile === 'number') {\n            if (profile < 0 || profile >= this.keys.length) return;\n            delete this.items[this.keys[profile]];\n        }\n        else\n            delete this.items[profile.name.toLowerCase()];\n        this.update();\n    }\n\n    public copy(profile: (string | Profile | number)): (Profile | Profile[]) {\n        if (!profile) return clone(this.items);\n        if (this.keys.length === 0)\n            return null;\n        if (typeof profile === 'string') {\n            if (!this.items[profile.toLowerCase()])\n                return null;\n            return this.items[profile.toLowerCase()].clone();\n        }\n        if (typeof profile === 'number') {\n            if (profile < 0 || profile >= this.keys.length) return null;\n            return this.items[this.keys[profile]].clone();\n        }\n        return profile.clone();\n    }\n\n    public clone(version?: number): ProfileCollection | any {\n        if (version === 2) {\n            const profiles = {};\n            for (const p in this.items)\n                profiles[this.items[p].name.toLowerCase()] = this.items[p].clone(2);\n            return profiles;\n        }\n        const pc = new ProfileCollection();\n        for (const p in this.items)\n            pc.items[this.items[p].name.toLowerCase()] = this.items[p].clone();\n        pc.update();\n        return pc;\n    }\n\n    static load(key?) {\n        return new Promise((resolve, reject) => {\n            let collection = new ProfileCollection();\n            localforage.getItem(key || 'OoMUDProfiles').then(value => {\n                if (typeof value === 'string')\n                    value = JSON.parse(value);\n                if (!value)\n                    collection.add(Profile.Default);\n                else {\n                    const keys = Object.keys(value);\n                    let k = 0;\n                    let kl = keys.length;\n                    for (; k < kl; k++) {\n                        collection.add(Profile.load(value[keys[k]]));\n                    }\n                }\n                resolve(collection);\n            }).catch(reject);\n        })\n    }\n\n    public save(key?) {\n        return localforage.setItem(key || 'OoMUDProfiles', JSON.parse(JSON.stringify(this.items, (key, value) => {\n            if (key === 'profile') return undefined;\n            return value;\n        })));\n    }\n\n    get length(): number {\n        return this.keys.length;\n    }\n\n    public count(): number { return this.keys.length; }\n\n    get active(): Profile {\n        const keys = this.keys;\n        //no profiles, add default and return\n        if (keys.length === 0) {\n            this.add(Profile.Default);\n            return this.items['default'];\n        }\n        //one profile\n        if (keys.length === 1) {\n            //profile is enabled\n            if (this.items[keys[0]].enabled)\n                return this.items[keys[0]];\n            //profile is default enable and return\n            if (this.items[keys[0]].name === 'Default') {\n                this.items[keys[0]].enable = true;\n                return this.items['default'];\n            }\n            //no default add one and return\n            this.add(Profile.Default);\n            return this.items['default'];\n        }\n        //search for first enabled profile\n        for (const key in keys) {\n            if (this.items[key].enabled)\n                return this.items[key];\n        }\n        //none found, see if default exist, if so enable and return\n        if (this.items['default']) {\n            this.items['default'].enabled = true;\n            return this.items['default'];\n        }\n        //no enabled or default, create and return\n        this.add(Profile.Default);\n        return this.items['default'];\n    }\n\n    get aliases(): Alias[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableAliases)\n                return [];\n            return this.items[keys[0]].aliases;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableAliases || this.items[keys[k]].aliases.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].aliases);\n        }\n        return tmp;\n    }\n\n    get triggers(): Trigger[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableTriggers)\n                return [];\n            return this.items[keys[0]].triggers;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableTriggers || this.items[keys[k]].triggers.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].triggers);\n        }\n        return tmp;\n    }\n\n    get macros(): Macro[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableMacros)\n                return [];\n            return this.items[keys[0]].macros;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableMacros || this.items[keys[k]].macros.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].macros);\n        }\n        return tmp;\n    }\n\n    get buttons(): Button[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableButtons)\n                return [];\n            return this.items[keys[0]].buttons;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableButtons || this.items[keys[k]].buttons.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].buttons);\n        }\n        return tmp;\n    }\n\n    get contexts(): Context[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableContexts)\n                return [];\n            return this.items[keys[0]].contexts;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableContexts || this.items[keys[k]].contexts.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].contexts);\n        }\n        return tmp;\n    }\n\n    get defaultContext(): boolean {\n        const keys = this.keys;\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return true;\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled)\n                return true;\n            return this.items[keys[0]].enableDefaultContext;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled)\n                continue;\n            if (!this.items[keys[k]].enableDefaultContext)\n                return false;\n        }\n        return true;\n    }\n}\n\n/*\n*            match any number (even none) of characters or white space\n   .*\n?            match a single character\n   .\n%d            match any number of digits (0-9)\n   \\d*\n%n            match a number that starts with a + or - sign\n   [+|-]?\\d*\n%w            match any number of alpha characters (a-z) (a word)\n   \\w\n%a            match any number of alphanumeric characters (a-z,0-9)\n   [a-zA-Z0-9]*\n%s            match any amount of white space (spaces, tabs)\n   \\s*\n%x            match any amount of non-white space\n   \\S*\n%y            match any amount of non-white space (same as %x but matches start and end of line)\n   \\S*\n%p            match any punctuation\n   \\p{P}\n%q            match any punctuation (same as %p but matches start and end of line)\n   \\p{P}\n%t            match a direction command\n   ignore for now as i dont know what it does             \n%e            match ESC character for ansi patterns\n   \\e\n[range]      match any amount of characters listed in range\n   as is in .net\n^            force pattern to match starting at the beginning of the line\n   as is in .net\n$            force pattern to match ending at the end of the line\n   as is in .net\n(pattern)      save the matched pattern in a parameter %1 though %99\n   as is in .net\n~            quote the next character to prevent it to be interpreted as a wild card, required to match special characters\n   replace with \\                 \n~~            match a quote character verbatim\n   replace with \\\\ (not needed as ~ by itself is replaced with a \\\n{val1|val2|val3|...} match any of the specified strings can not use other wildcard inside this\n   remove {}\n@variable match any of the specified strings or keys\n    parsed and replaced with the variable value\n{^string}      do not match the specified string\n   [^string] replace {} with []\n&nn      matches exactly nn characters (fixed width pattern)\n   {nn} remove & and wrap in {}\n&VarName      assigns the matched string to the given variable (see below for more info)\n   (?<VarName>pattern ) research more, prob is varname can contain patterns so have to parse out name and patterns\n   probably best to pre-parse and get name / pattern then parse pattern separately in a recursive call\n%/regex/% matches the given Regular Expression\n%%function() runs any function\nhttp://forums.zuggsoft.com/modules/mx_kb/kb.php?mode=doc&page=3&refpage=3&a=cmud_Pattern_Match\n           */\nexport function convertPattern(pattern: string, client?) {\n    if (!pattern || !pattern.length) return '';\n    enum convertPatternState {\n        None = 0,\n        Ampersand = 1,\n        Percent = 2,\n        StringMatch = 3,\n        SubPattern = 4,\n        AmpersandPercent = 5,\n        AmpersandPattern = 6,\n        AmpersandRange = 7,\n        PercentRegex = 8,\n        Escape = 9,\n        Variable = 10\n    }\n    let state: convertPatternState = convertPatternState.None;\n    let stringBuilder = [];\n    let idx = 0;\n    let tl = pattern.length;\n    let c;\n    let i;\n    let arg;\n    let pat;\n    let nest = 0;\n    for (idx = 0; idx < tl; idx++) {\n        c = pattern.charAt(idx);\n        i = pattern.charCodeAt(idx);\n        switch (state) {\n            case convertPatternState.Ampersand:\n                if (arg.length === 0 && (c === '*' || c === '?' || c === '^' || c === '$'))\n                    pat = c;\n                else if (arg.length === 0 && c === '%')\n                    state = convertPatternState.AmpersandPercent;\n                else if (pat.length === 0 && c === '(') {\n                    pat = c;\n                    state = convertPatternState.AmpersandPattern;\n                }\n                else if (pat.length === 0 && c === '[') {\n                    pat = c;\n                    state = convertPatternState.AmpersandRange;\n                }\n                else if (c === '{')\n                    continue;\n                //end block or no longer valid varname character\n                else if (c === '}' || !((i >= 48 && i <= 57) || (i >= 65 && i <= 90) || (i >= 97 && i <= 122) || i === 95 || i === 36)) {\n                    if (!isValidIdentifier(arg))\n                        throw new Error('Invalid variable name');\n                    if (!pat.length && /^\\d+$/.exec(arg))\n                        stringBuilder.push('{', arg, '}');\n                    else if (!pat.length)\n                        stringBuilder.push('(?<', arg, '>.*)');\n                    else\n                        stringBuilder.push('(?<', arg, '>', convertPattern(pat), ')');\n                    if (c !== '}')\n                        idx--;\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.AmpersandPercent:\n                pat += '%' + c;\n                state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.AmpersandPattern:\n                pat += c;\n                if (c === ')')\n                    state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.AmpersandRange:\n                pat += c;\n                if (c === ']')\n                    state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.Percent:\n                switch (c) {\n                    case 'd':\n                        stringBuilder.push(\"\\\\d+\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'n':\n                        stringBuilder.push(\"[+-]?\\\\d+\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'w':\n                        stringBuilder.push(\"\\\\w\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'a':\n                        stringBuilder.push(\"[a-zA-Z0-9]*\");\n                        state = convertPatternState.None;\n                        break;\n                    case 's':\n                        stringBuilder.push(\"\\\\s*\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'x':\n                        stringBuilder.push(\"\\\\S*\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'y':\n                        stringBuilder.push(\"\\\\S*\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'p':\n                        stringBuilder.push(\"[\\\\.\\\\?\\\\!\\\\:\\\\;\\\\-\\\\\u2014\\\\(\\\\)\\\\[\\\\]\\\\'\\\\\\\"\\\\\\\\/\\\\,]{1}\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'q':\n                        stringBuilder.push(\"[\\\\.\\\\?\\\\!\\\\:\\\\;\\\\-\\\\\u2014\\\\(\\\\)\\\\[\\\\]\\\\'\\\\\\\"\\\\\\\\/\\\\,]{1}\");\n                        state = convertPatternState.None;\n                        break;\n                    case 't': //jiMUD does not support direction commands\n                        state = convertPatternState.None;\n                        break;\n                    case 'e':\n                        stringBuilder.push(\"\\x1b\");\n                        state = convertPatternState.None;\n                        break;\n                    case '/': // %/pattern/%\n                        state = convertPatternState.PercentRegex;\n                        arg = '';\n                        break;\n                }\n                break;\n            case convertPatternState.PercentRegex:\n                if (c === '%') {\n                    if (!arg.endsWith('/'))\n                        throw new Error('Invalid %/regex/% pattern');\n                    stringBuilder.push(arg.substr(0, arg.length - 1));\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.StringMatch:\n                if (c === '^' && arg.length === 0)\n                    pat = true;\n                else if (c === '}') {\n                    if (pat)\n                        stringBuilder.push('[^', arg, ']');\n                    else\n                        stringBuilder.push(arg);\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.SubPattern:\n                if (c === ':') {\n                    stringBuilder.push('(?<', arg, '>');\n                    state = convertPatternState.None;\n                }\n                else if (c === ')') {\n                    stringBuilder.push('(', convertPattern(arg), ')');\n                    state = convertPatternState.None;\n                    nest--;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.Escape:\n                stringBuilder.push('\\\\', c);\n                state = convertPatternState.None;\n                break;\n            case convertPatternState.Variable:\n                if (c === '{' && arg.length === 0)\n                    continue;\n                else if (c === '}' || !((i >= 48 && i <= 57) || (i >= 65 && i <= 90) || (i >= 97 && i <= 122) || i === 95 || i === 36)) {\n                    if (!isValidIdentifier(arg))\n                        throw new Error('Invalid variable name')\n                    if (client) {\n                        if (client.variables[arg] instanceof Variable)\n                            stringBuilder.push(client.variables[arg].value || '');\n                        else\n                            stringBuilder.push(client.variables[arg] || '');\n                    }\n                    if (c !== '}')\n                        idx--;\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            default:\n                if (c === '*')\n                    stringBuilder.push('.*');\n                else if (c === '?')\n                    stringBuilder.push('.');\n                else if (c === '~')\n                    state = convertPatternState.Escape;\n                else if (c === '@') {\n                    state = convertPatternState.Variable;\n                    arg = '';\n                }\n                else if (c === '&') {\n                    arg = '';\n                    pat = '';\n                    state = convertPatternState.Ampersand;\n                }\n                else if (c === '%')\n                    state = convertPatternState.Percent;\n                else if (c === '{') {\n                    state = convertPatternState.StringMatch;\n                    arg = '';\n                }\n                else if (c === '(') {\n                    state = convertPatternState.SubPattern;\n                    arg = '';\n                    nest++;\n                }\n                else {\n                    if (c === ')')\n                        nest--;\n                    stringBuilder.push(c);\n                }\n                break;\n        }\n    }\n    switch (state) {\n        case convertPatternState.Ampersand:\n            if (!isValidIdentifier(arg))\n                throw new Error('Invalid variable name');\n            if (!pat.length && /^\\d+$/.exec(arg))\n                stringBuilder.push('{', arg, '}');\n            else if (!pat.length)\n                stringBuilder.push('(?<', arg, '>.*)');\n            else\n                stringBuilder.push('(?<', arg, '>', convertPattern(pat), ')');\n            break;\n        case convertPatternState.AmpersandPercent:\n        case convertPatternState.AmpersandPattern:\n        case convertPatternState.AmpersandRange:\n            throw new Error('Invalid &VarName pattern');\n        case convertPatternState.Percent:\n            throw new Error('Invalid % pattern');\n        case convertPatternState.PercentRegex:\n            throw new Error('Invalid %/regex/% pattern');\n        case convertPatternState.StringMatch:\n            throw new Error('Invalid string match pattern');\n        case convertPatternState.SubPattern:\n            throw new Error('Invalid (sub:pattern) pattern');\n        case convertPatternState.Escape:\n            throw new Error('Invalid escape pattern');\n        case convertPatternState.Variable:\n            if (!isValidIdentifier(arg))\n                throw new Error('Invalid variable name');\n            if (client) {\n                if (client.variables[arg] instanceof Variable)\n                    stringBuilder.push(client.variables[arg].getValue() || '');\n                else\n                    stringBuilder.push(client.variables[arg] || '');\n            }\n            break;\n    }\n    if (nest)\n        throw new Error('Invalid save matched pattern');\n    return stringBuilder.join('');\n}", "import { EventEmitter } from './events';\r\nimport { MacroModifiers, MacroDisplay, Alias, Trigger, Button, Profile, TriggerType, TriggerTypes, SubTriggerTypes, convertPattern } from './profile';\r\nimport { getTimeSpan, FilterArrayByKeyValue, SortItemArrayByPriority, clone, StringToUint8Array, splitQuoted, isValidIdentifier, getCursor, insertValue, openFileDialog, readFile } from './library';\r\nimport { Client } from './client';\r\nimport { NewLineType, TabCompletion, FunctionEvent } from './types';\r\nimport { SettingList } from './settings';\r\nimport { getAnsiColorCode, getColorCode, isMXPColor, getAnsiCode } from './ansi';\r\n\r\n\r\n/**\r\n * MATHJS expression engine\r\n * @constant\r\n * @type {object}\r\n */\r\nlet mathjs;\r\nlet _mathjs;\r\ndeclare let math;\r\n\r\n/**\r\n * Moment time format and manipulation (Optional, falls back to default date object formats)\r\n * @type {object}\r\n * @constant\r\n */\r\ndeclare let moment;\r\n\r\nconst WindowVariables = ['$selectedword', '$selword', '$selectedurl', '$selurl', '$selectedline', '$selline', '$selected', '$character', '$copied', '$action', '$trigger', '$caption', '$characterid'];\r\n\r\n/**\r\n * Return the proper case of a string for each word\r\n * @param {string} str - The string to proper capitalize each word of\r\n * @returns {string}\r\n */\r\nfunction ProperCase(str) {\r\n    return str.replace(/\\w*\\S*/g, (txt) => { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\r\n}\r\n\r\n/**\r\n * Return a fudge dice random value\r\n * @returns {number} Returns -1, 1 or 0 randomly\r\n */\r\nfunction fudgeDice() {\r\n    switch (~~(Math.random() * 6) + 1) {\r\n        case 1:\r\n        case 4:\r\n            return -1;\r\n        case 3:\r\n        case 2:\r\n            return 1;\r\n    }\r\n    return 0;\r\n}\r\n\r\n/**\r\n * Enum for input parse state\r\n * @readonly\r\n * @enum {number}\r\n */\r\nenum ParseState {\r\n    none = 0,\r\n    doubleQuoted = 1,\r\n    singleQuoted = 2,\r\n    aliasArguments = 3,\r\n    aliasArgumentsDouble = 4,\r\n    aliasArgumentsSingle = 5,\r\n    path = 6,\r\n    function = 7,\r\n    paramsP = 8,\r\n    paramsPBlock = 9,\r\n    paramsPEscape = 10,\r\n    paramsPNamed = 26,\r\n    paramsN = 11,\r\n    paramsNBlock = 12,\r\n    paramsNEscape = 13,\r\n    paramsNNamed = 14,\r\n    escape = 15,\r\n    verbatim = 16,\r\n    aliasArgumentsEscape = 17,\r\n    pathEscape = 18,\r\n    functionEscape = 19,\r\n    comment = 20,\r\n    inlineCommentStart = 21,\r\n    inlineComment = 22,\r\n    blockCommentStart = 23,\r\n    blockComment = 24,\r\n    blockCommentEnd = 25,\r\n    doubleQuotedEscape = 27,\r\n    singleQuotedEscape = 28\r\n}\r\n\r\n/**\r\n * Type of trigger ot test for\r\n */\r\nenum TriggerTypeFilter {\r\n    Main = 1,\r\n    Sub = 2,\r\n    All = 3\r\n}\r\n\r\n/**\r\n * Command input parser\r\n * \r\n * @class Input\r\n * @extends {EventEmitter}\r\n * @param {Object} client - the mud client object\r\n */\r\nexport class Input extends EventEmitter {\r\n    private _historyIdx: number = -1;\r\n    private _tabIdx: number = -1;\r\n    private _tabWords: string[] = null;;\r\n    private _tabSearch: any;\r\n    private _commandHistory: string[];\r\n    private _locked: number = 0;\r\n    private _TriggerCache: Trigger[] = null;\r\n    private _TriggerStates = {};\r\n    private _TriggerFunctionCache = {};\r\n    private _TriggerRegExCache = {};\r\n    private _LastTriggered = '';\r\n    private _LastTrigger = null;\r\n    private _scrollLock: boolean = false;\r\n    private _gag: number = 0;\r\n    private _gagID: any[] = [];\r\n    private _gags: any[] = [];\r\n    private _stack = [];\r\n    private _vStack = [];\r\n    private _controllers = {};\r\n    private _controllersCount = 0;\r\n    private _gamepadCaches = null;\r\n    private _lastSuspend = -1;\r\n    private _MacroCache = {};\r\n    private _loops: number[] = [];\r\n    private _pathQueue = [];\r\n    private _pathTimeout: any = null;\r\n    private _pathPaused: boolean = false;\r\n\r\n    public client: Client = null;\r\n    public enableParsing: boolean = true;\r\n    public enableTriggers: boolean = true;\r\n\r\n    public getScope() {\r\n        let scope: any = {};\r\n        Object.assign(scope, this.client.variables);\r\n        WindowVariables.forEach((a) => {\r\n            scope[a] = window[a];\r\n            scope[a.substr(1)] = window[a];\r\n        });\r\n        //if no stack use direct for some performance\r\n        if (this._stack.length === 0)\r\n            return scope;\r\n        if (!this.stack.named && !this.loops.length)\r\n            return scope;\r\n        if (this.stack.named)\r\n            Object.assign(scope, this.stack.named);\r\n        if (this.loops.length) {\r\n            scope.repeatnum = this.repeatnum;\r\n            const ll = this.loops.length;\r\n            //i to z only\r\n            for (let l = 0; l < ll && l < 18; l++)\r\n                scope[String.fromCharCode(105 + l)] = this.loops[l];\r\n        }\r\n        //scope.i = this.repeatnum;\r\n        //scope.repeatnum = this.repeatnum;\r\n        return scope;\r\n    }\r\n\r\n    public setScope(scope) {\r\n        //if same object no need to update\r\n        if (scope === this.client.variables) return;\r\n        const ll = this.loops.length;\r\n        for (const name in scope) {\r\n            //not a property, i or repeatnum\r\n            if (!Object.prototype.hasOwnProperty.call(scope, name) || name === 'i' || name === 'repeatnum')\r\n                continue;\r\n            if (WindowVariables.indexOf(name) !== -1 || WindowVariables.indexOf('$' + name) !== -1)\r\n                continue;\r\n            switch (name) {\r\n                case 'clientid':\r\n                    continue;\r\n            }\r\n            //if i to z and the loop exist skip it\r\n            if (name.length === 1 && ll && name.charCodeAt(0) >= 105 && name.charCodeAt(0) < 105 + ll)\r\n                continue;\r\n            //part of the named arguments so skip\r\n            if (this.stack.named && Object.prototype.hasOwnProperty.call(this.stack.named, name))\r\n                continue;\r\n            //update/add new variables\r\n            this.client.variables[name] = scope[name];\r\n        }\r\n    }\r\n\r\n    public evaluate(expression) {\r\n        let scope = this.getScope();\r\n        let results = mathjs().evaluate(expression, scope);\r\n        this.setScope(scope);\r\n        return results;\r\n    }\r\n\r\n    get stack() {\r\n        if (this._stack.length === 0)\r\n            this._stack.push({ args: 0, named: 0, used: 0, append: false });\r\n        return this._stack[this._stack.length - 1];\r\n    }\r\n\r\n    get repeatnum() {\r\n        if (this.loops.length === 0)\r\n            return 0;\r\n        return this.loops[this.loops.length - 1];\r\n    }\r\n\r\n    get loops() {\r\n        if (this._stack.length === 0 || !this.stack.hasOwnProperty('loops'))\r\n            return this._loops;\r\n        return this.stack.loops;\r\n    }\r\n\r\n    get regex() {\r\n        let sl = this._stack.length;\r\n        if (sl === 0)\r\n            return null;\r\n        while (sl >= 0) {\r\n            sl--;\r\n            if (this._stack[sl].hasOwnProperty('regex'))\r\n                return this._stack[sl].regex;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    get indices() {\r\n        let sl = this._stack.length;\r\n        if (sl === 0)\r\n            return [];\r\n        while (sl >= 0) {\r\n            sl--;\r\n            if (this._stack[sl].hasOwnProperty('indices'))\r\n                return this._stack[sl].indices;\r\n        }\r\n        return [];\r\n    }\r\n\r\n    get vStack() {\r\n        if (this._vStack.length === 0)\r\n            return {};\r\n        return this._vStack[this._vStack.length - 1];\r\n    }\r\n\r\n    public vStackPush(obj) {\r\n        this._vStack.push(obj);\r\n    }\r\n\r\n    public vStackPop() {\r\n        this._vStack.pop();\r\n    }\r\n\r\n    get scrollLock(): boolean {\r\n        return this._scrollLock;\r\n    }\r\n    set scrollLock(locked: boolean) {\r\n        if (locked !== this._scrollLock) {\r\n            this._scrollLock = locked;\r\n            this.emit('scroll-lock', this.scrollLock);\r\n        }\r\n    }\r\n\r\n    get lastTriggerExecuted() {\r\n        return this._LastTrigger;\r\n    }\r\n\r\n    get lastTriggered() {\r\n        return this._LastTriggered;\r\n    }\r\n\r\n    set lastTriggered(value) {\r\n        this._LastTriggered = value;\r\n    }\r\n\r\n    private getDiceArguments(arg, scope, fun) {\r\n        let res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\r\n        if (!res || res.length < 3) {\r\n            res = /(\\d+)\\s*?d\\s*?\\/\\s*?(100)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\r\n            if (!res || res.length < 3) {\r\n                //if failed with raw args try compiling and processing in case a variable or expression to build a string\r\n                arg = arg.compile().evaluate(scope);\r\n                res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\r\n                if (!res || res.length < 3) {\r\n                    //check for % dice\r\n                    res = /(\\d+)\\s*?d\\s*?\\/\\s*?(100)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\r\n                    if (!res || res.length < 3)\r\n                        throw new Error('Invalid dice for ' + (fun || 'dice'));\r\n                    res[2] = '%';\r\n                }\r\n            }\r\n            else\r\n                res[2] = '%';\r\n        }\r\n        return res;\r\n    }\r\n\r\n    private initMathJS() {\r\n        _mathjs = math;\r\n        const functions = {\r\n            esc: '\\x1b',\r\n            cr: '\\n',\r\n            lf: '\\r',\r\n            crlf: '\\r\\n',\r\n            diceavg: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                let min;\r\n                let max;\r\n                if (args.length === 0) throw new Error('Invalid arguments for diceavg');\r\n                if (args.length === 1) {\r\n                    res = this.getDiceArguments(args[0], scope, 'diceavg');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for diceavg');\r\n                min = 1;\r\n                if (sides === 'F' || sides === 'f') {\r\n                    min = -1;\r\n                    max = 1;\r\n                }\r\n                else if (sides === '%') {\r\n                    max = 1;\r\n                    min = 0;\r\n                }\r\n                else\r\n                    max = parseInt(sides);\r\n\r\n                if (mod)\r\n                    return math.evaluate(((min + max) / 2 * c) + mod, scope);\r\n                return (min + max) / 2 * c;\r\n            },\r\n            dicemin: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                let min;\r\n                if (args.length === 0) throw new Error('Invalid arguments for dicemin');\r\n                if (args.length === 1) {\r\n                    res = res = this.getDiceArguments(args[0], scope, 'dicemin');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dicemin');\r\n                min = 1;\r\n                if (sides === 'F' || sides === 'f')\r\n                    min = -1;\r\n                else if (sides === '%')\r\n                    min = 0;\r\n                if (mod)\r\n                    return math.evaluate((min * c) + mod, scope);\r\n                return min * c;\r\n            },\r\n            dicemax: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                let max;\r\n                if (args.length === 0) throw new Error('Invalid arguments for dicemax');\r\n                if (args.length === 1) {\r\n                    res = this.getDiceArguments(args[0], scope, 'dicemax');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dicemax');\r\n                if (sides === 'F' || sides === 'f')\r\n                    max = 1;\r\n                else if (sides === '%')\r\n                    max = 1;\r\n                else\r\n                    max = parseInt(sides);\r\n\r\n                if (mod)\r\n                    return math.evaluate((max * c) + mod, scope);\r\n                return max * c;\r\n            },\r\n            dicedev: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                let max;\r\n                if (args.length === 0) throw new Error('Invalid arguments for dicedev');\r\n                if (args.length === 1) {\r\n                    res = this.getDiceArguments(args[0], scope, 'dicedev');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dicedev');\r\n                if (sides === 'F' || sides === 'f')\r\n                    max = 6;\r\n                else if (sides === '%')\r\n                    max = 1;\r\n                else\r\n                    max = parseInt(sides);\r\n                if (mod)\r\n                    return math.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod, scope);\r\n                return Math.sqrt(((max * max) - 1) / 12 * c);\r\n            },\r\n            zdicedev: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                let max;\r\n                if (args.length === 0) throw new Error('Invalid arguments for zdicedev');\r\n                if (args.length === 1) {\r\n                    res = this.getDiceArguments(args[0], scope, 'zdicedev');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for zdicedev');\r\n                if (sides === 'F' || sides === 'f')\r\n                    max = 6;\r\n                else if (sides === '%')\r\n                    max = 1;\r\n                else\r\n                    max = parseInt(sides);\r\n                max--;\r\n                if (mod)\r\n                    return math.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod, scope);\r\n                return Math.sqrt(((max * max) - 1) / 12 * c);\r\n            },\r\n            dice: (args, math, scope) => {\r\n                let res;\r\n                let c;\r\n                let sides;\r\n                let mod;\r\n                if (args.length === 1) {\r\n                    res = this.getDiceArguments(args[0], scope, 'dice');\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length > 1) {\r\n                    c = args[0].compile().evaluate(scope);\r\n                    sides = args[1].toString().trim();\r\n                    if (sides !== 'F' && sides !== '%')\r\n                        sides = args[1].compile().evaluate(scope);\r\n                    if (args.length > 2)\r\n                        mod = args[2].compile().evaluate(scope);\r\n                }\r\n                else\r\n                    throw new Error('Invalid arguments for dice');\r\n                let sum = 0;\r\n                for (let i = 0; i < c; i++) {\r\n                    if (sides === 'F' || sides === 'f')\r\n                        sum += fudgeDice();\r\n                    else if (sides === '%')\r\n                        sum += ~~(Math.random() * 100.0) + 1.0;\r\n                    else\r\n                        sum += ~~(Math.random() * sides) + 1;\r\n                }\r\n                if (sides === '%')\r\n                    sum /= 100.0;\r\n                if (mod)\r\n                    return math.evaluate(sum + mod, scope);\r\n                return sum;\r\n            },\r\n            isdefined: (args, math, scope) => {\r\n                if (args.length === 1) {\r\n                    args[0] = this.stripQuotes(args[0].toString());\r\n                    if (this.client.variables.hasOwnProperty(args[0]))\r\n                        return 1;\r\n                    if (scope.has(args[0]))\r\n                        return 1;\r\n                    return 0;\r\n                }\r\n                throw new Error('Invalid arguments for isdefined');\r\n            },\r\n            defined: (args, math, scope) => {\r\n                let sides;\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for defined');\r\n                else if (args.length === 1) {\r\n                    args[0] = this.stripQuotes(args[0], true);\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0) return 0;\r\n                    //have to check each profile as the client only caches enabled items for speed\r\n                    for (; k < kl; k++) {\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                        sides = sides.find(i => {\r\n                            return i.pattern === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                        sides = sides.find(i => {\r\n                            return i.pattern === args[0] || i.name === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].macros);\r\n                        sides = sides.find(i => {\r\n                            return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                        sides = sides.find(i => {\r\n                            return i.caption === args[0] || i.name === args[0]\r\n                        });\r\n                        if (sides) return 1;\r\n                    }\r\n                    return this.client.variables.hasOwnProperty(args[0]);\r\n                }\r\n                else if (args.length === 2) {\r\n                    args[0] = this.stripQuotes(args[0].toString());\r\n                    args[0] = this.stripQuotes(args[1].toString());\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0) return 0;\r\n                    //have to check each profile as the client only caches enabled items for speed\r\n                    for (; k < kl; k++) {\r\n                        switch (args[1]) {\r\n                            case 'alias':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                                sides = sides.find(i => {\r\n                                    return i.pattern === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'event':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                sides = sides.find(i => {\r\n                                    return i.type === TriggerType.Event && (i.pattern === args[0] || i.name === args[0]);\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'trigger':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                sides = sides.find(i => {\r\n                                    return i.pattern === args[0] || i.name === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'macro':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].macros);\r\n                                sides = sides.find(i => {\r\n                                    return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'button':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                                sides = sides.find(i => {\r\n                                    return i.caption === args[0] || i.name === args[0]\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            //case 'variable':\r\n                            //case 'path':\r\n                            //case 'status':\r\n                            //case 'class':\r\n                            //case 'menu':                        \r\n                            //case 'module':\r\n                        }\r\n                    }\r\n                    if (args[1] === 'variable')\r\n                        return this.client.variables.hasOwnProperty(args[0]) || scope.has(args[0]);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for defined');\r\n                return 0;\r\n            },\r\n            time: (args, math, scope) => {\r\n                if (args.length > 1)\r\n                    throw new Error('Too many arguments for time');\r\n                if (!moment) return new Date().toISOString();\r\n                if (args.length)\r\n                    return moment().format(args[0].compile().evaluate(scope));\r\n                return moment().format();\r\n            },\r\n            clip: (args, math, scope) => {\r\n                if (args.length > 1)\r\n                    throw new Error('Too many arguments for clip');\r\n                if (args.length) {\r\n                    (<any>this.client).writeClipboard(args[0].compile().evaluate(scope));\r\n                    return;\r\n                }\r\n                return (<any>this.client).readClipboard();\r\n            },\r\n            if: (args, math, scope) => {\r\n                if (args.length < 3)\r\n                    throw new Error('Missing arguments for if');\r\n                if (args.length !== 3)\r\n                    throw new Error('Too many arguments for if');\r\n\r\n                if (args[0].compile().evaluate(scope))\r\n                    return args[1].compile().evaluate(scope);\r\n                return args[2].compile().evaluate(scope);\r\n            },\r\n            len: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for len');\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for len');\r\n                return args[0].compile().evaluate(scope).toString().length;\r\n            },\r\n            stripansi: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for len');\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for len');\r\n                const ansiRegex = new RegExp('[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)|(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-nq-uy=><~]))', 'g')\r\n                return args[0].compile().evaluate(scope).toString().replace(ansiRegex, '');\r\n            },\r\n            ansi: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for ansi');\r\n                args = args.map(a =>\r\n                    getAnsiCode(a.toString()) === -1 && a.toString() !== 'current' ? a.compile().evaluate(scope).toString() : a.toString()\r\n                );\r\n                const c = args.length;\r\n                let mod = [];\r\n                let min: any = {};\r\n                let sides;\r\n                let max;\r\n                for (sides = 0; sides < c; sides++) {\r\n                    if (args[sides].trim() === 'current')\r\n                        mod.push(args[sides].trim());\r\n                    else {\r\n                        max = getAnsiCode(args[sides].trim());\r\n                        if (max === -1)\r\n                            throw new Error('Invalid color or style for ansi');\r\n                        //style\r\n                        if (max >= 0 && max < 30)\r\n                            min[max] = 1;\r\n                        //color\r\n                        else\r\n                            mod.push(args[sides]);\r\n                    }\r\n                }\r\n                // fore,back\r\n                if (mod.length > 2)\r\n                    throw new Error('Too many colors for ansi');\r\n                if (mod.length > 1) {\r\n                    if (mod[1] === 'current')\r\n                        mod[1] = '';\r\n                    else\r\n                        mod[1] = getAnsiCode(mod[1], true);\r\n                }\r\n                if (mod.length > 0) {\r\n                    if (min[1] && mod[0] === 'white')\r\n                        mod[0] = '';\r\n                    else if (mod[0] === 'current')\r\n                        mod[0] = '';\r\n                    else\r\n                        mod[0] = getAnsiCode(mod[0]);\r\n                }\r\n\r\n                min = [...Object.keys(min), ...mod]\r\n                if (!min.length)\r\n                    throw new Error('Invalid colors or styles for ansi');\r\n                //remove any current flags\r\n                min = min.filter(f => f !== '');\r\n                return `\\x1b[${min.join(';')}m`;\r\n            },\r\n            color: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for color');\r\n                args = args.map(a =>\r\n                    getAnsiCode(a.toString()) === -1 && a.toString() !== 'current' ? a.compile().evaluate(scope).toString() : a.toString()\r\n                );\r\n                let c;\r\n                let sides;\r\n                if (args.length === 1) {\r\n                    if (args[0] === 'bold')\r\n                        return '370';\r\n                    c = getAnsiColorCode(args[0]);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid fore color');\r\n                    return c.toString();\r\n                }\r\n                else if (args.length === 2) {\r\n                    if (args[0] === 'bold')\r\n                        c = 370;\r\n                    else {\r\n                        c = getAnsiColorCode(args[0]);\r\n                        if (c === -1)\r\n                            throw new Error('Invalid fore color');\r\n                        if (args[1] === 'bold')\r\n                            return (c * 10).toString();\r\n                    }\r\n                    sides = c.toString();\r\n                    c = getAnsiColorCode(args[1], true);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid back color');\r\n                    return sides + ',' + c.toString();\r\n                }\r\n                else if (args.length === 3) {\r\n                    if (args[0] === 'bold') {\r\n                        args.shift();\r\n                        args.push('bold');\r\n                    }\r\n                    if (args[2] !== 'bold')\r\n                        throw new Error('Only bold is supported as third argument for color');\r\n                    c = getAnsiColorCode(args[0]);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid fore color');\r\n                    sides = (c * 10).toString();\r\n                    c = getAnsiColorCode(args[1], true);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid back color');\r\n                    return sides + ',' + c.toString();\r\n                }\r\n                throw new Error('Too many arguments');\r\n            },\r\n            zcolor: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for zcolor');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for zcolor');\r\n                return getColorCode(parseInt(args[0].compile().evaluate(scope), 10));\r\n            },\r\n            case: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for case');\r\n                let i = args[0].compile().evaluate(scope);\r\n                if (i > 0 && i < args.length)\r\n                    return args[i].compile().evaluate(scope);\r\n                return null;\r\n            },\r\n            switch: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for switch');\r\n                if (args.length % 2 === 1)\r\n                    throw new Error('All expressions must have a value for switch');\r\n                let i = args.length\r\n                for (let c = 0; c < i; c += 2) {\r\n                    if (args[c].compile().evaluate(scope))\r\n                        return args[c + 1].compile().evaluate(scope);\r\n                }\r\n                return null;\r\n            },\r\n            ascii: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for ascii');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for ascii');\r\n                if (args[0].toString().trim().length === 0)\r\n                    throw new Error('Invalid argument, empty string for ascii');\r\n                return args[0].toString().trim().charCodeAt(0);\r\n            },\r\n            char: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for char');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for char');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for char');\r\n                return String.fromCharCode(c);\r\n            },\r\n            bitand: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitand');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitand');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitand');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bitand');\r\n                return c & sides;\r\n            },\r\n            bitnot: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitnot');\r\n                else if (args.length !== 1)\r\n                    throw new Error('Too many arguments for bitnot');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitnot');\r\n                return ~c;\r\n            },\r\n            bitor: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitor');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitor');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitor');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bitor');\r\n                return c | sides;\r\n            },\r\n            bitset: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitset');\r\n                else if (args.length > 3)\r\n                    throw new Error('Too many arguments for bitset');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitset');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bitset');\r\n                sides--;\r\n                let mod = 1;\r\n                if (args.length === 3) {\r\n                    mod = args[2].compile().evaluate(scope);\r\n                    if (isNaN(mod))\r\n                        throw new Error('Invalid argument \\'' + args[2].toString() + '\\' must be a number for bitset');\r\n                }\r\n                return (c & (~(1 << sides))) | ((mod ? 1 : 0) << sides);\r\n            },\r\n            bitshift: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitshift');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitshift');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitshift');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bitshift');\r\n                if (sides < 0)\r\n                    return c >> -sides;\r\n                return c << sides\r\n            },\r\n            bittest: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bittest');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bittest');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bittest');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bittest');\r\n                sides--;\r\n                return ((c >> sides) % 2 != 0) ? 1 : 0;\r\n            },\r\n            bitxor: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitxor');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitxor');\r\n                let c = args[0].compile().evaluate(scope);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0].toString() + '\\' must be a number for bitxor');\r\n                let sides = args[1].compile().evaluate(scope);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1].toString() + '\\' must be a number for bitxor');\r\n                return c ^ sides;\r\n            },\r\n            tonumber: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for number');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for number');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                    return parseInt(args[0], 10);\r\n                else if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return parseFloat(args[0]);\r\n                else if (args[0] === \"true\")\r\n                    return 1;\r\n                else if (args[0] === \"false\")\r\n                    return 0;\r\n                return 0;\r\n            },\r\n            isfloat: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for isfloat');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for isfloat');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return 1;\r\n                return 0;\r\n\r\n            },\r\n            isnumber: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for isnumber');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for isnumber');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return 1;\r\n                return 0;\r\n            },\r\n            tostring: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for string');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for string');\r\n                return args[0].compile().evaluate(scope).toString();\r\n            },\r\n            float: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for float');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for float');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return parseFloat(args[0]);\r\n                else if (args[0] === \"true\")\r\n                    return 1.0;\r\n                else if (args[0] === \"false\")\r\n                    return 0.0;\r\n                return 0;\r\n            },\r\n            trim: (args, math, scope) => {\r\n                if (args.length !== 1)\r\n                    throw new Error('Missing arguments for trim');\r\n                return args[0].compile().evaluate(scope).toString().trim();\r\n            },\r\n            trimleft: (args, math, scope) => {\r\n                if (args.length !== 1)\r\n                    throw new Error('Missing arguments for trimleft');\r\n                return args[0].compile().evaluate(scope).toString().trimLeft();\r\n            },\r\n            trimright: (args, math, scope) => {\r\n                if (args.length !== 1)\r\n                    throw new Error('Missing arguments for trimright');\r\n                return args[0].compile().evaluate(scope).toString().trimRight();\r\n            },\r\n            pos: (args, math, scope) => {\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for pos');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for pos');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                args[1] = args[1].compile().evaluate(scope).toString();\r\n                return args[1].indexOf(args[0]) + 1;\r\n            },\r\n            ipos: (args, math, scope) => {\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for pos');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for pos');\r\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\r\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\r\n                return args[1].indexOf(args[0]) + 1;\r\n            },\r\n            ends: (args, math, scope) => {\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for ends');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for ends');\r\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\r\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\r\n                return args[0].endsWith(args[1]);\r\n            },\r\n            begins: (args, math, scope) => {\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for begins');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for begins');\r\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\r\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\r\n                return args[0].startsWith(args[1]);\r\n            },\r\n            alarm: (args, math, scope) => {\r\n                let alarms;\r\n                let a;\r\n                let al;\r\n                let t;\r\n                let p;\r\n                switch (args.length) {\r\n                    case 0:\r\n                        throw new Error('Missing arguments for alarm');\r\n                    case 1:\r\n                        args[0] = args[0].compile().evaluate(scope).toString();\r\n                        alarms = this.client.alarms;\r\n                        al = alarms.length;\r\n                        if (al === 0)\r\n                            throw new Error('No alarms set.');\r\n                        a = 0;\r\n                        for (; a < al; a++) {\r\n                            //only main state counts here\r\n                            if (alarms[a].type !== TriggerType.Alarm) continue;\r\n                            if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\r\n                                if (alarms[a].suspended)\r\n                                    return 0;\r\n                                return this.client.getRemainingAlarmTime(a);\r\n                            }\r\n                        }\r\n                        return;\r\n                    case 2:\r\n                        t = args[1].compile().evaluate(scope);\r\n                        args[0] = args[0].compile().evaluate(scope).toString();\r\n                        alarms = this.client.alarms;\r\n                        al = alarms.length;\r\n                        if (al === 0)\r\n                            throw new Error('No alarms set.');\r\n                        a = 0;\r\n                        if (typeof t === 'string') {\r\n                            for (; a < al; a++) {\r\n                                //only main state counts here\r\n                                if (alarms[a].type !== TriggerType.Alarm) continue;\r\n                                if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\r\n                                    if (alarms[a].profile.name.toUpperCase() !== t.toUpperCase())\r\n                                        continue;\r\n                                    if (alarms[a].suspended)\r\n                                        return 0;\r\n                                    return this.client.getRemainingAlarmTime(a);\r\n                                }\r\n                            }\r\n                            throw new Error('Alarm not found in profile: ' + t + '.');\r\n                        }\r\n                        else {\r\n                            for (; a < al; a++) {\r\n                                //only main state counts here\r\n                                if (alarms[a].type !== TriggerType.Alarm) continue;\r\n                                if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\r\n                                    if (!alarms[a].suspended)\r\n                                        this.client.setAlarmTempTime(a, t);\r\n                                    return t;\r\n                                }\r\n                            }\r\n                            throw new Error('Alarm not found.');\r\n                        }\r\n                    case 3:\r\n                        t = args[1].compile().evaluate(scope);\r\n                        args[0] = args[0].compile().evaluate(scope).toString()\r\n                        p = args[2].compile().evaluate(scope).toString();\r\n                        alarms = this.client.alarms;\r\n                        al = alarms.length;\r\n                        if (al === 0)\r\n                            throw new Error('No alarms set.');\r\n                        a = 0;\r\n                        for (; a < al; a++) {\r\n                            //only main state counts here\r\n                            if (alarms[a].type !== TriggerType.Alarm) continue;\r\n                            if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\r\n                                if (alarms[a].profile.name.toUpperCase() !== p.toUpperCase())\r\n                                    continue;\r\n                                if (!alarms[a].suspended)\r\n                                    this.client.setAlarmTempTime(a, t);\r\n                                return t;\r\n                            }\r\n                        }\r\n                        throw Error('Could not set time, alarm not found in profile: ' + args[2] + '.');\r\n                }\r\n                throw new Error('Too many arguments for alarm');\r\n            },\r\n            state: (args, math, scope) => {\r\n                let trigger;\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for state');\r\n                if (args.length > 2)\r\n                    throw new Error('Too many arguments for state');\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (args.length === 1) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                        trigger = trigger.find(t => {\r\n                            return t.name === args[0] || t.pattern === args[0];\r\n                        });\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                            trigger = trigger.find(t => {\r\n                                return t.name === args[0] || t.pattern === args[0];\r\n                            });\r\n                            if (trigger)\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n                else if (args.length === 2) {\r\n                    args[1] = args[1].compile().evaluate(scope);\r\n                    let profile;\r\n                    if (this.client.profiles.contains(args[1]))\r\n                        profile = this.client.profiles.items[args[1].toLowerCase()];\r\n                    else\r\n                        throw new Error('Profile not found: ' + args[1]);\r\n                    trigger = SortItemArrayByPriority(profile.triggers);\r\n                    trigger = trigger.find(t => {\r\n                        return t.name === args[0] || t.pattern === args[0];\r\n                    });\r\n                }\r\n                if (trigger)\r\n                    return trigger.triggers && trigger.triggers.length ? trigger.state : 0;\r\n                throw new Error('Trigger not found');\r\n            },\r\n            isnull: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    return null;\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for null');\r\n                return args[0].compile().evaluate(scope) ? 1 : 0;\r\n            },\r\n            escape: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for unescape');\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for unescape');\r\n                let c;\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (this.client.getOption('allowEscape')) {\r\n                    const escape = this.client.getOption('allowEscape') ? this.client.getOption('escapeChar') : '';\r\n                    c = escape;\r\n                    if (escape === '\\\\')\r\n                        c += escape;\r\n                    if (this.client.getOption('parseDoubleQuotes'))\r\n                        c += '\"';\r\n                    if (this.client.getOption('parseSingleQuotes'))\r\n                        c += '\\'';\r\n                    if (this.client.getOption('commandStacking'))\r\n                        c += this.client.getOption('commandStackingChar');\r\n                    if (this.client.getOption('enableSpeedpaths'))\r\n                        c += this.client.getOption('speedpathsChar');\r\n                    if (this.client.getOption('enableCommands'))\r\n                        c += this.client.getOption('commandChar');\r\n                    if (this.client.getOption('enableVerbatim'))\r\n                        c += this.client.getOption('verbatimChar');\r\n                    if (this.client.getOption('enableDoubleParameterEscaping'))\r\n                        c += this.client.getOption('parametersChar');\r\n                    if (this.client.getOption('enableNParameters'))\r\n                        c += this.client.getOption('nParametersChar');\r\n                    return args.replace(new RegExp(`[${c}]`, 'g'), escape + '$&');\r\n                }\r\n                return args.replace(/[\\\\\"']/g, '\\$&');\r\n            },\r\n            unescape: (args, math, scope) => {\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for unescape');\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for unescape');\r\n                let c;\r\n                args[0] = args[0].compile().evaluate(scope).toString();\r\n                if (this.client.getOption('allowEscape')) {\r\n                    const escape = this.client.getOption('allowEscape') ? this.client.getOption('escapeChar') : '';\r\n                    c = escape;\r\n                    if (escape === '\\\\')\r\n                        c += escape;\r\n                    if (this.client.getOption('parseDoubleQuotes'))\r\n                        c += '\"';\r\n                    if (this.client.getOption('parseSingleQuotes'))\r\n                        c += '\\'';\r\n                    if (this.client.getOption('commandStacking'))\r\n                        c += this.client.getOption('commandStackingChar');\r\n                    if (this.client.getOption('enableSpeedpaths'))\r\n                        c += this.client.getOption('speedpathsChar');\r\n                    if (this.client.getOption('enableCommands'))\r\n                        c += this.client.getOption('commandChar');\r\n                    if (this.client.getOption('enableVerbatim'))\r\n                        c += this.client.getOption('verbatimChar');\r\n                    if (this.client.getOption('enableDoubleParameterEscaping'))\r\n                        c += this.client.getOption('parametersChar');\r\n                    if (this.client.getOption('enableNParameters'))\r\n                        c += this.client.getOption('nParametersChar');\r\n                    if (escape === '\\\\')\r\n                        return args[0].replace(new RegExp(`\\\\\\\\[${c}]`, 'g'), (m) => m.substr(1));\r\n                    return args[0].replace(new RegExp(`${escape}[${c}]`, 'g'), (m) => m.substr(1));\r\n                }\r\n                return args[0].replace(/\\\\[\\\\\"']/g, (m) => m.substr(1));\r\n            },\r\n            prompt: (args, math, scope) => {\r\n                if (args.length > 3)\r\n                    throw new Error('Too many arguments');\r\n                if (args.length === 0)\r\n                    return window.prompt();\r\n                args = args.map(a => a.compile().evaluate(scope).toString());\r\n                return window.prompt(...args);\r\n            },\r\n            /*\r\n            fileprompt: (args, math, scope) => {\r\n                if (args.length > 2)\r\n                    throw new Error('Too many arguments');\r\n                args = args.map(a => a.compile().evaluate(scope).toString());\r\n                let f = [\r\n                    { name: 'All files (*.*)', extensions: ['*'] },\r\n                ];\r\n                if (args.length > 0 && args[0].trim().length > 0) {\r\n                    f.unshift({\r\n                        name: args[0],\r\n                        extensions: args[0].split(',').map(a => a.trim())\r\n                    })\r\n                }\r\n                var files = dialog.showOpenDialogSync({\r\n                    filters: f,\r\n                    properties: ['openFile', 'promptToCreate'],\r\n                    defaultPath: args.length >= 2 ? parseTemplate(args[1]) : ''\r\n                });\r\n                if (files && files.length) return files[0];\r\n            }\r\n            */\r\n        };\r\n        for (let fun in functions) {\r\n            if (!functions.hasOwnProperty(fun) || typeof functions[fun] !== 'function') {\r\n                continue;\r\n            }\r\n            functions[fun].rawArgs = true;\r\n        }\r\n        _mathjs.import(functions, {});\r\n    }\r\n\r\n    public resetExpressionEngine() {\r\n        if (!_mathjs) return;\r\n        _mathjs = undefined;\r\n    }\r\n\r\n    constructor(client: Client) {\r\n        super();\r\n        if (!client)\r\n            throw new Error('Invalid client!');\r\n        this.client = client;\r\n        //wrap mathjs to load on demand for speed as not every may need math\r\n        mathjs = () => {\r\n            if (_mathjs) return _mathjs;\r\n            this.initMathJS();\r\n            return _mathjs;\r\n        }\r\n        this._commandHistory = [];\r\n        document.addEventListener('keydown', (event) => {\r\n            if (!this.isLocked && this.ProcessMacros(event.which, event.altKey, event.ctrlKey, event.shiftKey, event.metaKey)) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n            //toggle scroll lock\r\n            else if (event.key === 'ScrollLock')\r\n                this.toggleScrollLock();\r\n        });\r\n\r\n        this.client.on('parse-command', (data) => {\r\n            if (this.client.getOption('parseCommands'))\r\n                data.value = this.parseOutgoing(data.value, null, null, null, null, !data.comments);\r\n        });\r\n\r\n        this.client.on('add-line', (data) => {\r\n            this.ExecuteTriggers(TriggerTypes.Regular | TriggerTypes.Pattern | TriggerTypes.LoopExpression, data.line, data.raw, data.fragment, false, true);\r\n            if (this._gag > 0 && !data.fragment) {\r\n                data.gagged = true;\r\n                this._gag--;\r\n            }\r\n            //if not fragment and not gagged count\r\n            if (!data.fragment)\r\n                for (let state in this._TriggerStates) {\r\n                    if (this._TriggerStates[state].lineCount)\r\n                        this._TriggerStates[state].lineCount--;\r\n                    //if (data.remote && this._TriggerStates[state].remoteCount)\r\n                    //this._TriggerStates[state].remoteCount--;\r\n                }\r\n        });\r\n\r\n        this.client.on('options-loaded', () => {\r\n            if (!_mathjs && this.client.getOption('initializeScriptEngineOnLoad'))\r\n                this.initMathJS();\r\n            this.initPads();\r\n        });\r\n\r\n        this.client.commandInput.addEventListener('keyup', event => {\r\n            if (event.key !== 'Escape' && event.key !== 'ArrowUp' && event.key !== 'ArrowDown')\r\n                this._historyIdx = this._commandHistory.length;\r\n        })\r\n\r\n        this.client.commandInput.addEventListener('keydown', event => {\r\n            switch (event.key) {\r\n                case 'Escape': //esc\r\n                    //any modifier set not a proper history navigation    \r\n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\r\n                    this.client.commandInput.blur();\r\n                    this.client.commandInput.value = '';\r\n                    this.client.commandInput.select();\r\n                    this._historyIdx = this._commandHistory.length;\r\n                    this._tabIdx = -1;\r\n                    this._tabWords = null;\r\n                    this._tabSearch = null\r\n                    this.emit('history-navigate', event);\r\n                    break;\r\n                case 'ArrowUp': //up\r\n                    //any modifier set not a proper history navigation    \r\n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\r\n                    if (this._historyIdx === this._commandHistory.length && this.client.commandInput.value.length > 0) {\r\n                        this.AddCommandToHistory(this.client.commandInput.value);\r\n                        if (this.client.commandInput.value === this._commandHistory[this._historyIdx - 1])\r\n                            this._historyIdx--;\r\n                    }\r\n                    this._historyIdx--;\r\n                    if (this._historyIdx < 0)\r\n                        this._historyIdx = 0;\r\n                    if (this._commandHistory.length < 0) {\r\n                        this._historyIdx = -1;\r\n                        this.client.commandInput.value = '';\r\n                    }\r\n                    else if (this._commandHistory.length > 0 && this._historyIdx < this._commandHistory.length && this._historyIdx >= 0) {\r\n                        this.client.commandInput.value = this._commandHistory[this._historyIdx];\r\n                    }\r\n                    setTimeout(() => this.client.commandInput.select(), 0);\r\n                    this.emit('history-navigate', event);\r\n                    break;\r\n                case 'ArrowDown': //down\r\n                    //any modifier set not a proper history navigation    \r\n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\r\n                    if (this._historyIdx === this._commandHistory.length && this.client.commandInput.value.length > 0)\r\n                        this.AddCommandToHistory(this.client.commandInput.value);\r\n                    this._historyIdx++;\r\n                    if (this._historyIdx >= this._commandHistory.length || this._commandHistory.length < 1) {\r\n                        this._historyIdx = this._commandHistory.length;\r\n                        this.client.commandInput.value = '';\r\n                    }\r\n                    else if (this._commandHistory.length > 0 && this._historyIdx < this._commandHistory.length && this._historyIdx >= 0) {\r\n                        this.client.commandInput.value = this._commandHistory[this._historyIdx];\r\n                    }\r\n                    setTimeout(() => this.client.commandInput.select(), 0);\r\n                    this.emit('history-navigate', event);\r\n                    break;\r\n                case 'Enter': // return\r\n                    switch (this.client.getOption('newlineShortcut')) {\r\n                        case NewLineType.Ctrl:\r\n                            if (event.ctrlKey && !event.shiftKey && !event.metaKey && !event.altKey) {\r\n                                insertValue(this.client.commandInput, '\\n');\r\n                                this.emit('history-navigate', event);\r\n                                this.client.commandInput.blur();\r\n                                this.client.commandInput.focus();\r\n                                return true;\r\n                            }\r\n                            break;\r\n                        case NewLineType.CtrlAndShift:\r\n                            if (event.ctrlKey && event.shiftKey && !event.metaKey && !event.altKey) {\r\n                                insertValue(this.client.commandInput, '\\n');\r\n                                this.emit('history-navigate', event);\r\n                                this.client.commandInput.blur();\r\n                                this.client.commandInput.focus();\r\n                                return true;\r\n                            }\r\n                            break;\r\n                        case NewLineType.CtrlOrShift:\r\n                            if ((event.ctrlKey || event.shiftKey) && !event.metaKey && !event.altKey) {\r\n                                insertValue(this.client.commandInput, '\\n');\r\n                                this.emit('history-navigate', event);\r\n                                this.client.commandInput.blur();\r\n                                this.client.commandInput.focus();\r\n                                return true;\r\n                            }\r\n                            break;\r\n                        case NewLineType.Shift:\r\n                            if ((event.ctrlKey && event.shiftKey) && !event.metaKey && !event.altKey) {\r\n                                insertValue(this.client.commandInput, '\\n');\r\n                                this.emit('history-navigate', event);\r\n                                this.client.commandInput.blur();\r\n                                this.client.commandInput.focus();\r\n                                return true;\r\n                            }\r\n                            break;\r\n                    }\r\n                    //only send if no modifiers set\r\n                    if (!event.ctrlKey && !event.shiftKey && !event.metaKey && !event.altKey) {\r\n                        this._tabIdx = -1;\r\n                        this._tabWords = null;\r\n                        this._tabSearch = null\r\n                        this.client.sendCommand(null, null, this.client.getOption('allowCommentsFromCommand'));\r\n                        this.emit('history-navigate', event);\r\n                    }\r\n                    event.preventDefault();\r\n                    break;\r\n                case 'Tab':\r\n                    if (!this.client.getOption('enableTabCompletion') || this.client.commandInput.value.length === 0) return;\r\n                    //any modifiers down do not do tab complete\r\n                    if (event.altKey || event.ctrlKey || event.metaKey) return;\r\n                    if (event.shiftKey)\r\n                        this._tabIdx--;\r\n                    else\r\n                        this._tabIdx++;\r\n                    let start = this.client.commandInput.selectionStart;\r\n                    let end = this.client.commandInput.selectionEnd;\r\n                    if (this._tabWords === null) {\r\n                        const cursorPos = getCursor(this.client.commandInput);\r\n                        //(?=\\s[\\S]+$)\r\n                        let endPos = this.client.commandInput.value.indexOf(' ', cursorPos);\r\n                        if (endPos === -1)\r\n                            endPos = this.client.commandInput.value.indexOf('\\n', cursorPos);\r\n                        let startPos = this.client.commandInput.value.lastIndexOf(' ', cursorPos - 1);\r\n                        if (startPos === -1)\r\n                            startPos = this.client.commandInput.value.indexOf('\\n', cursorPos - 1);\r\n                        if (endPos === -1)\r\n                            endPos = this.client.commandInput.value.length;\r\n                        if (startPos === -1)\r\n                            startPos = 0;\r\n                        else\r\n                            startPos++;\r\n                        start = startPos;\r\n                        end = endPos;\r\n                        if (start === end)\r\n                            end++;\r\n                        const findStr = this.client.commandInput.value.substring(startPos, endPos);\r\n                        //nothing to find so bail\r\n                        if (findStr.length === 0) return;\r\n                        //tabCompletionList\r\n                        //tabCompletionType\r\n                        //this.client.getOption('enableTabCompletion')\r\n                        //TabCompletion\r\n                        this._tabSearch = { start: startPos, end: endPos, find: findStr.length };\r\n                        const regSearch = new RegExp(`^${findStr.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}`, this.client.getOption('ignoreCaseTabCompletion') ? 'i' : '');\r\n                        if (this.client.getOption('tabCompletionLookupType') === TabCompletion.List)\r\n                            this._tabWords = [...new Set(<string>this.client.getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)))];\r\n                        else {\r\n                            //get all words that start with findStr then reverse as you want last words first as they are the newest\r\n                            this._tabWords = [].concat(...this.client.display.lines.slice(this.client.display.lines.length - this.client.getOption('tabCompletionBufferLimit')).map(line => line.text.split(/\\s+/))).filter(word => word.match(regSearch)).reverse();\r\n                            if (this.client.getOption('tabCompletionLookupType') === TabCompletion.PrependBuffer)\r\n                                this._tabWords = [...new Set(<string>this.client.getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)).reverse())].concat(this._tabWords);\r\n                            else if (this.client.getOption('tabCompletionLookupType') === TabCompletion.AppendBuffer)\r\n                                this._tabWords = this._tabWords.concat([...new Set(<string>this.client.getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)).reverse())]);\r\n\r\n                            this._tabWords = [...new Set(this._tabWords)];\r\n                        }\r\n                    }\r\n                    else\r\n                        start -= this._tabSearch.find;\r\n                    if (this._tabWords.length === 0) return;\r\n                    if (this._tabIdx < 0) this._tabIdx = this._tabWords.length - 1;\r\n                    if (this._tabIdx >= this._tabWords.length) this._tabIdx = 0;\r\n\r\n                    const tabCasing = this.client.getOption('tabCompletionReplaceCasing');\r\n                    //Fixes undo/redo but saves all tab changes better to just break undo i think\r\n                    //this.client.commandInput.selectionStart = start;\r\n                    //this.client.commandInput.selectionEnd = end;\r\n                    //insertValue(this.client.commandInput, (tabCasing === 1 ? (this._tabWords[this._tabIdx].toLowerCase()) : (tabCasing === 2 ? this._tabWords[this._tabIdx].toUpperCase() : this._tabWords[this._tabIdx])));\r\n                    this.client.commandInput.value = this.client.commandInput.value.substring(0, start)\r\n                        + (tabCasing === 1 ? (this._tabWords[this._tabIdx].toLowerCase()) : (tabCasing === 2 ? this._tabWords[this._tabIdx].toUpperCase() : this._tabWords[this._tabIdx]))\r\n                        + this.client.commandInput.value.substring(end, this.client.commandInput.value.length);\r\n                    this.client.commandInput.selectionStart = this._tabSearch.start + this._tabSearch.find;\r\n                    this.client.commandInput.selectionEnd = this._tabSearch.start + this._tabWords[this._tabIdx].length;\r\n                    event.preventDefault();\r\n                    this.emit('history-navigate', event);\r\n                    break;\r\n                case 'Shift':\r\n                case 'Control':\r\n                case 'Meta':\r\n                case 'Alt':\r\n                case 'CapsLock':\r\n                case 'Fn':\r\n                case 'NumLock':\r\n                case 'ScrollLock':\r\n                case 'Super':\r\n                case 'PageDown':\r\n                case 'PageUp':\r\n                case 'End':\r\n                case 'Home':\r\n                case 'ArrowLeft':\r\n                case 'ArrowRight':\r\n                case 'ContextMenu':\r\n                    //TODO see if any other keys should not effect tab complete\r\n                    //Do not effect tab completion\r\n                    break;\r\n                default:\r\n                    this._tabIdx = -1;\r\n                    this._tabWords = null;\r\n                    this._tabSearch = null\r\n                    break;\r\n            }\r\n        });\r\n\r\n        this.client.commandInput.addEventListener('mouseup', event => {\r\n            this._tabIdx = -1;\r\n            this._tabWords = null;\r\n            this._tabSearch = null\r\n        });\r\n        //spell-checker:ignore gamepadconnected gamepaddisconnected\r\n        window.addEventListener('gamepadconnected', (e) => {\r\n            if (!this.client.getOption('gamepads')) return;\r\n            if (!this._gamepadCaches)\r\n                this._gamepadCaches = [];\r\n            this._controllers[e.gamepad.index] = { pad: e.gamepad, axes: clone(e.gamepad.axes), state: { axes: [], buttons: [] }, pState: { axes: [], buttons: [] } };\r\n            this._controllersCount++;\r\n            this.updatePads();\r\n        });\r\n\r\n        window.addEventListener('gamepaddisconnected', (e) => {\r\n            if (!this.client.getOption('gamepads')) return;\r\n            delete this._controllers[e.gamepad.index];\r\n            this._controllersCount--;\r\n        });\r\n        this.initPads();\r\n    }\r\n\r\n    private async initPads() {\r\n        if (!this.client || !this.client.options) {\r\n            setTimeout(this.initPads, 5);\r\n            return;\r\n        }\r\n        this._controllers = [];\r\n        this._controllersCount = 0;\r\n        this._gamepadCaches = null;\r\n        if (!this.client.getOption('gamepads')) return;\r\n        const controllers = navigator.getGamepads();\r\n        let ct = 0;\r\n        const cl = controllers.length;\r\n        for (; ct < cl; ct++) {\r\n            if (!controllers[ct]) continue;\r\n            this._controllers[controllers[ct].index] = { pad: controllers[ct], axes: clone(controllers[ct].axes), state: { axes: [], buttons: [] }, pState: { axes: [], buttons: [] } };\r\n            this._controllersCount++;\r\n        }\r\n        this.updatePads();\r\n    }\r\n\r\n    private updatePads() {\r\n        if (this._controllersCount === 0 || !this.client.getOption('gamepads'))\r\n            return;\r\n        const controllers = navigator.getGamepads();\r\n        let c = 0;\r\n        const cl = controllers.length;\r\n        if (!this._gamepadCaches && cl > 0)\r\n            this._gamepadCaches = [];\r\n        for (; c < cl; c++) {\r\n            const controller = controllers[c];\r\n            //no control and did not correctly connect so skip\r\n            if (!controller || !this._controllers[controller.index]) continue;\r\n            const state = this._controllers[controller.index].state;\r\n            const axes = this._controllers[controller.index].axes;\r\n            const bl = controller.buttons.length;\r\n            let i;\r\n            let macros;\r\n            if (!this._gamepadCaches[c])\r\n                this._gamepadCaches[c] = FilterArrayByKeyValue(this.client.macros, 'gamepad', c + 1);\r\n            macros = this._gamepadCaches[c];\r\n            let m = 0;\r\n            const ml = macros.length;\r\n            if (ml === 0) continue;\r\n            for (i = 0; i < bl; i++) {\r\n                let val: any = controller.buttons[i];\r\n                let pressed;\r\n                if (typeof (val) === 'object') {\r\n                    pressed = val.pressed;\r\n                    val = val.value;\r\n                }\r\n                else\r\n                    pressed = val >= 0.5;\r\n                if (state.buttons[i]) {\r\n                    if (state.buttons[i].pressed !== pressed) {\r\n                        state.buttons[i].pressed = pressed;\r\n                        if (!pressed) {\r\n                            for (; m < ml; m++) {\r\n                                if (!macros[m].enabled) continue;\r\n                                if (macros[m].key !== i + 1) continue;\r\n                                if (this.ExecuteMacro(macros[m])) {\r\n                                    if (this._controllersCount > 0 || controllers.length > 0)\r\n                                        requestAnimationFrame(() => { this.updatePads(); });\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    state.buttons[i] = { pct: Math.round(val * 100), pressed: pressed };\r\n                }\r\n            }\r\n\r\n            const al = controller.axes.length;\r\n            let a = 0;\r\n            for (i = 0; i < al; i++) {\r\n                if (state.axes[i] !== controller.axes[i] && controller.axes[i] !== axes[i]) {\r\n                    state.axes[i] = controller.axes[i];\r\n                    if (state.axes[i] < -0.75) {\r\n                        a = -(i + 1);\r\n                    }\r\n                    else if (state.axes[i] > 0.75) {\r\n                        a = i + 1;\r\n                    }\r\n                }\r\n                else if (state.axes[i] < -0.75) {\r\n                    a = -(i + 1);\r\n                }\r\n                else if (state.axes[i] > 0.75) {\r\n                    a = i + 1;\r\n                }\r\n                if (a !== 0)\r\n                    for (; m < ml; m++) {\r\n                        if (!macros[m].enabled) continue;\r\n                        if (macros[m].gamepadAxes !== i + 1) continue;\r\n                        if (this.ExecuteMacro(macros[m])) {\r\n                            if (this._controllersCount > 0 || controllers.length > 0)\r\n                                requestAnimationFrame(() => { this.updatePads(); });\r\n                            return;\r\n                        }\r\n                    }\r\n            }\r\n        }\r\n        if (this._controllersCount > 0 || controllers.length > 0)\r\n            requestAnimationFrame(() => { this.updatePads(); });\r\n    }\r\n\r\n    public adjustLastLine(n, raw?) {\r\n        if (!this.client.display.lines || this.client.display.lines.length === 0)\r\n            return 0;\r\n        if (raw) {\r\n            if (n === this.client.display.lines.length) {\r\n                n--;\r\n                if (this.client.display.lines[n].text.length === 0 && this.client.display.lines[n].raw.length)\r\n                    n--;\r\n            }\r\n            else if (n === this.client.display.lines.length - 1 && this.client.display.lines[n].text.length === 0 && this.client.display.lines[n].raw.length)\r\n                n--;\r\n        }\r\n        else if (n === this.client.display.lines.length) {\r\n            n--;\r\n            if (this.client.display.lines[n].text.length === 0)\r\n                n--;\r\n        }\r\n        else if (n === this.client.display.lines.length - 1 && this.client.display.lines[n].text.length === 0)\r\n            n--;\r\n        return n;\r\n    }\r\n\r\n    get isLocked(): boolean {\r\n        return this._locked === 0 ? false : true;\r\n    }\r\n\r\n    public addLock() {\r\n        this._locked++;\r\n    }\r\n\r\n    public removeLock() {\r\n        this._locked--;\r\n    }\r\n\r\n    public AddCommandToHistory(cmd: string) {\r\n        if ((this._commandHistory.length < 1 || this._commandHistory[this._commandHistory.length - 1] !== cmd) && cmd.length > 0) {\r\n            if (this._commandHistory.length >= this.client.getOption('commandHistorySize'))\r\n                this._commandHistory.shift();\r\n            this._commandHistory.push(cmd);\r\n            this.emit('command-history-changed', this._commandHistory);\r\n        }\r\n    }\r\n\r\n    public clearCommandHistory() {\r\n        this._commandHistory = [];\r\n        this._historyIdx = -1;\r\n        this.emit('command-history-changed', this._commandHistory);\r\n    }\r\n\r\n    public setHistoryIndex(index) {\r\n        if (index < 0 || this._commandHistory.length === 0)\r\n            this._historyIdx = -1;\r\n        else if (index >= this._commandHistory.length)\r\n            this._historyIdx = this._commandHistory.length - 1;\r\n        else\r\n            this._historyIdx = index;\r\n    }\r\n\r\n    public get commandHistory() { return this._commandHistory; }\r\n\r\n    public executeScript(txt: string) {\r\n        if (txt == null)\r\n            return txt;\r\n        let state: number = 0;\r\n        let idx: number = 0;\r\n        let c: string;\r\n        const tl: number = txt.length;\r\n        let fun: string = '';\r\n        let args = [];\r\n        let arg: string = '';\r\n        let raw: string;\r\n        let s = 0;\r\n        const pd: boolean = this.client.getOption('parseDoubleQuotes');\r\n        const ps: boolean = this.client.getOption('parseSingleQuotes');\r\n        const cmdChar: string = this.client.getOption('commandChar');\r\n\r\n        for (; idx < tl; idx++) {\r\n            c = txt.charAt(idx);\r\n            switch (state) {\r\n                //find name\r\n                case 1:\r\n                    if (c === ' ') {\r\n                        state = 2;\r\n                        raw += c;\r\n                    }\r\n                    else {\r\n                        fun += c;\r\n                        raw += c;\r\n                    }\r\n                    break;\r\n                //find arguments\r\n                case 2:\r\n                    if (c === '{') {\r\n                        state = 7;\r\n                        arg += c;\r\n                    }\r\n                    else if (c === '(') {\r\n                        state = 8;\r\n                        arg += c;\r\n                    }\r\n                    else if (c === ' ') {\r\n                        args.push(arg);\r\n                        arg = '';\r\n                    }\r\n                    else {\r\n                        if (c === '\"' && pd)\r\n                            state = 3;\r\n                        else if (c === '\\'' && ps)\r\n                            state = 4;\r\n                        arg += c;\r\n                    }\r\n                    raw += c;\r\n                    break;\r\n                case 3:\r\n                    if (c === '\"')\r\n                        state = 2;\r\n                    //if (c === '\\\\')\r\n                    //state = 5;\r\n                    //else {\r\n                    arg += c;\r\n                    raw += c;\r\n                    //}\r\n                    break;\r\n                case 4:\r\n                    if (c === '\\'')\r\n                        state = 2;\r\n                    //if (c === '\\\\')\r\n                    //state = 6;\r\n                    //else {\r\n                    arg += c;\r\n                    raw += c;\r\n                    //}\r\n                    break;\r\n                case 7:\r\n                    arg += c;\r\n                    if (c === '}') {\r\n                        if (s === 0) {\r\n                            state = 2;\r\n                        }\r\n                        else\r\n                            s--;\r\n                    }\r\n                    else if (c === '{')\r\n                        s++;\r\n                    raw += c;\r\n                    break;\r\n                case 8:\r\n                    arg += c;\r\n                    if (c === ')') {\r\n                        if (s === 0) {\r\n                            state = 2;\r\n                        }\r\n                        else\r\n                            s--;\r\n                    }\r\n                    else if (c === '(')\r\n                        s++;\r\n                    raw += c;\r\n                    break;\r\n                /*\r\n            case 5:\r\n                if (c === '\"') {\r\n                    arg += c;\r\n                    raw += c;\r\n                }\r\n                else {\r\n                    arg += '\\\\';\r\n                    raw += '\\\\';\r\n                    idx--;\r\n                }\r\n                state = 3;\r\n                break;\r\n            case 6:\r\n                if (c === '\\'') {\r\n                    arg += c;\r\n                    raw += c;\r\n                }\r\n                else {\r\n                    arg += '\\\\';\r\n                    raw += '\\\\';\r\n                    idx--;\r\n                }\r\n                state = 4;\r\n                break;\r\n                */\r\n                default:\r\n                    if (idx === 0 && c === cmdChar) {\r\n                        state = 1;\r\n                        fun = '';\r\n                        args = [];\r\n                        arg = '';\r\n                        raw = c;\r\n                    }\r\n                    else\r\n                        return txt;\r\n                    break;\r\n            }\r\n        }\r\n        if (fun.length > 0) {\r\n            //if (state === 3)\r\n            //arg += '\"';\r\n            //else if (state === 4)\r\n            //arg += '\\'';\r\n            if (arg.endsWith('\\n'))\r\n                arg = arg.substring(0, arg.length - 1);\r\n            if (arg.length > 0) args.push(arg);\r\n            return this.executeFunction(fun, args, raw, cmdChar);\r\n        }\r\n        return txt;\r\n    }\r\n\r\n    public executeFunction(fun: string, args, raw: string, cmdChar: string) {\r\n        let n;\r\n        let f = false;\r\n        let items;\r\n        let al;\r\n        let i;\r\n        let tmp;\r\n        let profile = null;\r\n        let name = null;\r\n        let item;\r\n        let p;\r\n        let reload;\r\n        let trigger;\r\n        switch (fun.toLowerCase()) {\r\n            //spell-checker:ignore untrigger unaction\r\n            case 'unaction':\r\n            case 'untrigger':\r\n            case 'unt':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                profile = null;\r\n                name = null;\r\n                reload = true;\r\n                if (args.length < 1 || args.length > 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unt\\x1b[0;-11;-12mrigger {pattern|name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid name or pattern');\r\n                //{pattern} {commands} profile\r\n                if (args[0].match(/^\\{.*\\}$/g))\r\n                    args[0] = this.parseInline(args[0].substr(1, args[0].length - 2));\r\n                else\r\n                    args[0] = this.parseInline(this.stripQuotes(args[0]));\r\n                if (args.length === 2) {\r\n                    profile = this.stripQuotes(args[2]);\r\n                    profile = this.parseInline(profile);\r\n                }\r\n                if (!profile || profile.length === 0) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        item = this.client.profiles.items[keys[k]].findAny('triggers', { name: args[0], pattern: args[0] });\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            item = this.client.profiles.items[keys[k]].findAny('triggers', { name: args[0], pattern: args[0] });\r\n                            if (item) {\r\n                                profile = this.client.profiles.items[keys[k]];\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!item)\r\n                        throw new Error('Trigger \\'' + args[0] + '\\' not found in \\'' + profile.name + '\\'!');\r\n                    this.client.removeTrigger(item);\r\n                    this.client.echo('Trigger \\'' + args[0] + '\\' removed from \\'' + profile.name + '\\'.', -7, -8, true, true);\r\n                }\r\n                else {\r\n                    profile = this.parseInline(profile);\r\n                    if (this.client.profiles.contains(profile)) {\r\n                        profile = this.client.profiles.items[profile.toLowerCase()];\r\n                        item = profile.findAny('triggers', { name: args[0], pattern: args[0] });\r\n                        if (!item)\r\n                            throw new Error('Trigger \\'' + args[0] + '\\' not found in \\'' + profile.name + '\\'!');\r\n                        this.client.removeTrigger(item);\r\n                        this.client.echo('Trigger \\'' + args[0] + '\\' removed from \\'' + profile.name + '\\'.', -7, -8, true, true);\r\n                    }\r\n                    else\r\n                        throw new Error('Profile not found: ' + profile);\r\n                }\r\n                return null;\r\n            case 'suspend':\r\n            case 'sus':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                switch (args.length) {\r\n                    case 0:\r\n                        tmp = this.client.alarms;\r\n                        if (tmp.length === 0)\r\n                            this.client.echo('No alarms defined.', -7, -8, true, true);\r\n                        else {\r\n                            this.client.setAlarmState(0, false);\r\n                            this._lastSuspend = 0;\r\n                            this.client.echo('Last alarm suspended.', -7, -8, true, true);\r\n                        }\r\n                        return null;\r\n                    case 1:\r\n                        items = this.parseInline(this.stripQuotes(args[0]));\r\n                        tmp = this.client.alarms;\r\n                        al = tmp.length;\r\n                        for (let a = tmp.length - 1; a >= 0; a--) {\r\n                            if (tmp[a].name === items || tmp[a].pattern === items) {\r\n                                this.client.setAlarmState(a, false);\r\n                                this.client.echo('Alarm \\'' + items + '\\' suspended.', -7, -8, true, true);\r\n                                this._lastSuspend = a;\r\n                                break;\r\n                            }\r\n                        }\r\n                        return null;\r\n                    default:\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sus\\x1b[0;-11;-12mpend id \\x1b[3mprofile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'sus\\x1b[0;-11;-12mpend');\r\n                }\r\n            case 'resume':\r\n            case 'resu':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                switch (args.length) {\r\n                    case 0:\r\n                        if (this._lastSuspend === -1)\r\n                            return null;\r\n                        this.client.setAlarmState(this._lastSuspend, true);\r\n                        this.client.echo('Last alarm suspended resumed.', -7, -8, true, true);\r\n                        this._lastSuspend = -1;\r\n                        return null;\r\n                    case 1:\r\n                        items = this.parseInline(this.stripQuotes(args[0]));\r\n                        tmp = this.client.alarms;\r\n                        al = tmp.length;\r\n                        for (let a = al - 1; a >= 0; a--) {\r\n                            if (tmp[a].name === items || tmp[a].pattern === items) {\r\n                                this.client.setAlarmState(a, true);\r\n                                this.client.echo('Alarm \\'' + items + '\\' resumed.', -7, -8, true, true);\r\n                                break;\r\n                            }\r\n                        }\r\n                        return null;\r\n                    default:\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'resu\\x1b[0;-11;-12mme id \\x1b[3mprofile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'resu\\x1b[0;-11;-12mme');\r\n                }\r\n            case 'action':\r\n            case 'ac':\r\n            case 'trigger':\r\n            case 'tr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region trigger\r\n                item = {\r\n                    profile: null,\r\n                    name: null,\r\n                    pattern: null,\r\n                    commands: null,\r\n                    options: { priority: 0 }\r\n                };\r\n                if (args.length < 2 || args.length > 5)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'tr\\x1b[0;-11;-12migger name {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'tr\\x1b[0;-11;-12migger {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid trigger name or pattern');\r\n\r\n                if (args[0].match(/^\\{.*\\}$/g)) {\r\n                    item.pattern = args.shift();\r\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                }\r\n                else {\r\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\r\n                    if (!item.name || item.name.length === 0)\r\n                        throw new Error('Invalid trigger name');\r\n                    if (args[0].match(/^\\{.*\\}$/g)) {\r\n                        item.pattern = args.shift();\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    }\r\n                }\r\n                if (args.length !== 0) {\r\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                        item.commands = args.shift();\r\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                    }\r\n                    if (args.length === 1) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        else\r\n                            args[0] = this.stripQuotes(args[0]);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'temporary':\r\n                                    case 'temp':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                        //case 'expression':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1], TriggerTypeFilter.Main))\r\n                                                throw new Error('Invalid trigger type');\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid trigger options');\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'temporary':\r\n                                    case 'temp':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                        //case 'expression':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1], TriggerTypeFilter.Main))\r\n                                                throw new Error('Invalid trigger type');\r\n\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid trigger options');\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                }\r\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name);\r\n                //#endregion\r\n                return null;\r\n            case 'event':\r\n            case 'ev':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region event\r\n                profile = null;\r\n                reload = true;\r\n                item = {\r\n                    profile: null,\r\n                    name: null,\r\n                    pattern: null,\r\n                    commands: null,\r\n                    options: { priority: 0 }\r\n                };\r\n                if (args.length < 2 || args.length > 4)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ev\\x1b[0;-11;-12ment name {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid event name');\r\n\r\n                item.name = this.parseInline(this.stripQuotes(args.shift()));\r\n                if (!item.name || item.name.length === 0)\r\n                    throw new Error('Invalid event name');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing commands or options');\r\n\r\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                    item.commands = args.shift();\r\n                    item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                }\r\n                else\r\n                    throw new Error('Missing commands');\r\n                if (args.length === 1) {\r\n                    args[0] = args[0].substr(1, args[0].length - 2);\r\n                    if (args[0].length !== 0) {\r\n                        this.parseInline(args[0]).split(',').forEach(o => {\r\n                            switch (o.trim()) {\r\n                                case 'nocr':\r\n                                case 'prompt':\r\n                                case 'case':\r\n                                case 'verbatim':\r\n                                case 'disable':\r\n                                case 'temporary':\r\n                                case 'temp':\r\n                                    item.options[o.trim()] = true;\r\n                                    break;\r\n                                default:\r\n                                    if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                        tmp = o.trim().split('=');\r\n                                        if (tmp.length !== 2)\r\n                                            throw new Error(`Invalid event priority option '${o.trim()}'`);\r\n                                        i = parseInt(tmp[1], 10);\r\n                                        if (isNaN(i))\r\n                                            throw new Error('Invalid event priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                        item.options['priority'] = i;\r\n                                    }\r\n                                    else\r\n                                        throw new Error(`Invalid event option '${o.trim()}'`);\r\n                            }\r\n                        });\r\n                    }\r\n                    else\r\n                        throw new Error('Invalid event options');\r\n                }\r\n                else if (args.length === 2) {\r\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[0] = args[0].substr(1, args[0].length - 2);\r\n                    if (args[0].length !== 0) {\r\n                        this.parseInline(args[0]).split(',').forEach(o => {\r\n                            switch (o.trim()) {\r\n                                case 'nocr':\r\n                                case 'prompt':\r\n                                case 'case':\r\n                                case 'verbatim':\r\n                                case 'disable':\r\n                                case 'temporary':\r\n                                case 'temp':\r\n                                    item.options[o.trim()] = true;\r\n                                    break;\r\n                                default:\r\n                                    if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                        tmp = o.trim().split('=');\r\n                                        if (tmp.length !== 2)\r\n                                            throw new Error(`Invalid event priority option '${o.trim()}'`);\r\n                                        i = parseInt(tmp[1], 10);\r\n                                        if (isNaN(i))\r\n                                            throw new Error('Invalid event priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                        item.options['priority'] = i;\r\n                                    }\r\n                                    else\r\n                                        throw new Error(`Invalid event option '${o.trim()}'`);\r\n                            }\r\n                        });\r\n                    }\r\n                    else\r\n                        throw new Error('Invalid event options');\r\n                    item.profile = this.stripQuotes(args[1]);\r\n                    if (item.profile.length !== 0)\r\n                        item.profile = this.parseInline(item.profile);\r\n                }\r\n\r\n                if (!item.profile || item.profile.length === 0) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        profile = this.client.profiles.items[keys[0]];\r\n                        tmp = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers.filter(t => t.type === TriggerType.Event));\r\n                        trigger = tmp.find(t => {\r\n                            return t.name === item.name || t.pattern === item.name;\r\n                        });\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            tmp = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers.filter(t => t.type === TriggerType.Event));\r\n                            trigger = tmp.find(t => {\r\n                                return t.name === item.name || t.pattern === item.name;\r\n                            });\r\n                            if (trigger) {\r\n                                profile = this.client.profiles.items[keys[k]];\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (!profile)\r\n                            profile = this.client.activeProfile;\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.client.profiles.contains(item.profile))\r\n                        profile = this.client.profiles.items[item.profile.toLowerCase()];\r\n                    else\r\n                        throw new Error('Profile not found: ' + item.profile);\r\n                    trigger = tmp.find(t => {\r\n                        return t.name === item.name || t.pattern === item.name;\r\n                    });\r\n                }\r\n                if (!trigger) {\r\n                    trigger = new Trigger();\r\n                    trigger.name = item.name;\r\n                    profile.triggers.push(trigger);\r\n                    this.client.echo('Event \\'' + trigger.name + '\\' added.', -7, -8, true, true);\r\n                    item.new = true;\r\n                }\r\n                else\r\n                    this.client.echo('Event \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\r\n                trigger.pattern = item.name;\r\n                if (item.commands !== null)\r\n                    trigger.value = item.commands;\r\n                trigger.type = TriggerType.Event;\r\n                if (item.options.prompt)\r\n                    trigger.triggerPrompt = true;\r\n                if (item.options.nocr)\r\n                    trigger.triggerNewline = false;\r\n                if (item.options.case)\r\n                    trigger.caseSensitive = true;\r\n                if (item.options.raw)\r\n                    trigger.raw = true;\r\n\r\n                if (item.options.verbatim)\r\n                    trigger.verbatim = true;\r\n                if (item.options.disable)\r\n                    trigger.enabled = false;\r\n                else if (item.options.enable)\r\n                    trigger.enabled = true;\r\n                if (item.options.temporary || item.options.temp)\r\n                    trigger.temp = true;\r\n                trigger.priority = item.options.priority;\r\n                this.client.saveProfiles();\r\n                if (reload)\r\n                    this.client.clearCache();\r\n                if (item.new)\r\n                    this.emit('item-added', 'trigger', profile.name, trigger);\r\n                else\r\n                    this.emit('item-updated', 'trigger', profile.name, profile.triggers.indexOf(trigger), trigger);\r\n                profile = null;\r\n                //#endregion\r\n                return null;\r\n            case 'unevent':\r\n            case 'une':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region unevent\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent name or \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                else {\r\n                    reload = true;\r\n                    profile = null;\r\n                    if (args[0].match(/^\\{.*\\}$/g) || args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g)) {\r\n                        if (args.length > 2)\r\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent name or \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                        if (args.length === 2) {\r\n                            profile = this.parseInline(this.stripQuotes(args[1])).toLowerCase();\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile];\r\n                            else\r\n                                throw new Error('Profile not found: ' + profile);\r\n                        }\r\n                        else\r\n                            profile = this.client.activeProfile;\r\n                        if (args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g))\r\n                            n = this.parseInline(this.stripQuotes(args[0]));\r\n                        else\r\n                            n = this.parseInline(args[0].substr(1, args[0].length - 2));\r\n                    }\r\n                    else {\r\n                        n = this.parseInline(args.join(' '));\r\n                        profile = this.client.activeProfile;\r\n                    }\r\n                    items = SortItemArrayByPriority(profile.triggers.filter(t => t.type === TriggerType.Event));\r\n                    n = this.stripQuotes(n);\r\n                    tmp = n;\r\n                    n = items.findIndex(i => i.pattern === n || i.name === n);\r\n                    f = n !== -1;\r\n                    if (!f)\r\n                        this.client.echo('Event \\'' + tmp + '\\' not found.', -7, -8, true, true);\r\n                    else {\r\n                        this.client.echo('Event \\'' + (items[n].name || items[n].pattern) + '\\' removed.', -7, -8, true, true);\r\n                        if (reload)\r\n                            this.client.removeTrigger(items[n]);\r\n                        else {\r\n                            n = profile.triggers.indexOf(items[n]);\r\n                            profile.triggers.splice(n, 1);\r\n                            this.client.saveProfiles();\r\n                            this.emit('item-removed', 'trigger', profile.name, n);\r\n                        }\r\n                        profile = null;\r\n                    }\r\n                }\r\n                return null;\r\n            //#endregion\r\n            case 'button':\r\n            case 'bu':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region button\r\n                //#button name caption {commands} {icon} options profile\r\n                //#button name|index\r\n                //Options: enable, disable, nosend, chain, append, stretch, priority=#\r\n                if (args.length === 1) {\r\n                    n = this.parseInline(this.stripQuotes(args[0]));\r\n                    items = document.getElementById('user-buttons').children;\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= items.length)\r\n                            throw new Error('Button index must be >= 0 and < ' + items.length);\r\n                        else\r\n                            items[n].click();\r\n                    }\r\n                    else if (items[n])\r\n                        items[n].click();\r\n                    else\r\n                        throw new Error(`Button '${n}' not found`);\r\n                    return null;\r\n                }\r\n                profile = null;\r\n                reload = true;\r\n                item = {\r\n                    profile: null,\r\n                    name: null,\r\n                    caption: null,\r\n                    commands: null,\r\n                    icon: null,\r\n                    options: { priority: 0 }\r\n                };\r\n                if (args.length < 2 || args.length > 5)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'bu\\x1b[0;-11;-12mtton name|index or \\x1b[4m' + cmdChar + 'bu\\x1b[0;-11;-12mtton name \\x1b[3mcaption\\x1b[0;-11;-12m {commands} \\x1b[3m{icon} options profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'by\\x1b[0;-11;-12mutton \\x1b[3mcaption\\x1b[0;-11;-12m {commands} \\x1b[3m{icon} {options} profile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid button name, caption or commands');\r\n\r\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                    item.commands = args.shift();\r\n                    item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                }\r\n                else {\r\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\r\n                    if (!item.name || item.name.length === 0)\r\n                        throw new Error('Invalid button name or caption');\r\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                        item.commands = args.shift();\r\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                    }\r\n                    else {\r\n                        item.caption = this.stripQuotes(args.shift());\r\n                        if (!args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            throw new Error('Missing commands');\r\n                    }\r\n                }\r\n\r\n                if (args.length !== 0) {\r\n                    if (args[0].match(/^\\{.*\\}$/g)) {\r\n                        item.icon = args.shift();\r\n                        item.icon = item.icon.substr(1, item.icon.length - 2);\r\n                    }\r\n                    if (args.length === 1) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        else\r\n                            args[0] = this.stripQuotes(args[0]);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nosend':\r\n                                    case 'chain':\r\n                                    case 'append':\r\n                                    case 'stretch':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid button priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid button priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid button option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid button options');\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nosend':\r\n                                    case 'chain':\r\n                                    case 'append':\r\n                                    case 'stretch':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid button priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid button priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid button option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid button options');\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                }\r\n                if (!item.profile || item.profile.length === 0) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        profile = this.client.profiles.items[keys[0]];\r\n                        if (item.name !== null)\r\n                            trigger = this.client.profiles.items[keys[k]].find('buttons', 'name', item.name);\r\n                        else\r\n                            trigger = this.client.profiles.items[keys[k]].find('buttons', 'caption', item.caption);\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            if (item.name !== null)\r\n                                trigger = this.client.profiles.items[keys[k]].find('buttons', 'name', item.name);\r\n                            else\r\n                                trigger = this.client.profiles.items[keys[k]].find('buttons', 'caption', item.caption);\r\n                            if (trigger) {\r\n                                profile = this.client.profiles.items[keys[k]];\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (!profile)\r\n                            profile = this.client.activeProfile;\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.client.profiles.contains(item.profile))\r\n                        profile = this.client.profiles.items[item.profile.toLowerCase()];\r\n                    else\r\n                        throw new Error('Profile not found: ' + item.profile);\r\n                    if (item.name !== null)\r\n                        trigger = profile.find('buttons', 'name', item.name);\r\n                    else\r\n                        trigger = profile.find('buttons', 'caption', item.caption);\r\n                }\r\n                if (!trigger) {\r\n                    trigger = new Button();\r\n                    trigger.name = item.name || '';\r\n                    trigger.caption = item.caption || '';\r\n                    profile.buttons.push(trigger);\r\n                    if (!item.name && !item.caption)\r\n                        this.client.echo('Button added.', -7, -8, true, true);\r\n                    else\r\n                        this.client.echo('Button \\'' + (trigger.name || trigger.caption || '') + '\\' added.', -7, -8, true, true);\r\n                    item.new = true;\r\n                }\r\n                else\r\n                    this.client.echo('Button \\'' + (trigger.name || trigger.caption || '') + '\\' updated.', -7, -8, true, true);\r\n                if (item.caption !== null)\r\n                    trigger.caption = item.caption;\r\n                if (item.commands !== null)\r\n                    trigger.value = item.commands;\r\n\r\n                if (item.options.icon)\r\n                    trigger.icon = item.options.icon;\r\n                if (item.options.nosend)\r\n                    trigger.send = false;\r\n                if (item.options.chain)\r\n                    trigger.chain = true;\r\n                if (item.options.append)\r\n                    trigger.append = true;\r\n                if (item.options.stretch)\r\n                    trigger.stretch = true;\r\n                if (item.options.disable)\r\n                    trigger.enabled = false;\r\n                else if (item.options.enable)\r\n                    trigger.enabled = true;\r\n                trigger.priority = item.options.priority;\r\n                this.client.saveProfiles();\r\n                if (reload)\r\n                    this.client.clearCache();\r\n                if (item.new)\r\n                    this.emit('item-added', 'button', profile.name, trigger);\r\n                else\r\n                    this.emit('item-updated', 'button', profile.name, profile.buttons.indexOf(trigger), trigger);\r\n                profile = null;\r\n                //#endregion\r\n                return null;\r\n            case 'unbutton':\r\n            case 'unb':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region unbutton\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton name or \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                else {\r\n                    reload = true;\r\n                    profile = null;\r\n                    if (args[0].match(/^\\{.*\\}$/g) || args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g)) {\r\n                        if (args.length > 2)\r\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton name or \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                        if (args.length === 2) {\r\n                            profile = this.parseInline(this.stripQuotes(args[1]));\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile.toLowerCase()];\r\n                            else\r\n                                throw new Error('Profile not found: ' + profile);\r\n                        }\r\n                        else\r\n                            profile = this.client.activeProfile;\r\n                        if (args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g))\r\n                            n = this.parseInline(this.stripQuotes(args[0]));\r\n                        else\r\n                            n = this.parseInline(args[0].substr(1, args[0].length - 2));\r\n                    }\r\n                    else {\r\n                        n = this.parseInline(args.join(' '));\r\n                        profile = this.client.activeProfile;\r\n                    }\r\n                    items = SortItemArrayByPriority(profile.buttons);\r\n                    tmp = n;\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= items.length)\r\n                            throw new Error('Button index must be >= 0 and < ' + items.length);\r\n                        f = true;\r\n                    }\r\n                    else {\r\n                        n = this.stripQuotes(n);\r\n                        n = items.findIndex(i => i.name === n || i.caption === n);\r\n                        f = n !== -1;\r\n                    }\r\n                    if (!f)\r\n                        this.client.echo('Button \\'' + tmp + '\\' not found.', -7, -8, true, true);\r\n                    else {\r\n                        if (items[n].name.length === 0 && items[n].caption.length === 0)\r\n                            this.client.echo('Button \\'' + tmp + '\\' removed.', -7, -8, true, true);\r\n                        else\r\n                            this.client.echo('Button \\'' + (items[n].name || items[n].caption) + '\\' removed.', -7, -8, true, true);\r\n                        n = profile.buttons.indexOf(items[n]);\r\n                        profile.buttons.splice(n, 1);\r\n                        this.client.saveProfiles();\r\n                        if (reload)\r\n                            this.client.clearCache();\r\n                        this.emit('item-removed', 'button', profile.name, n);\r\n                        profile = null;\r\n                    }\r\n                }\r\n                return null;\r\n            //#endregion button\r\n            case 'alarm':\r\n            case 'ala':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region alarm\r\n                //spell-checker:ignore timepattern\r\n                profile = null;\r\n                name = null;\r\n                reload = true;\r\n                n = false;\r\n                if (args.length < 2 || args.length > 4)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm name {timepattern} {commands} \\x1b[3mprofile\\x1b[0;-11;-12m, \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm name {timepattern} \\x1b[3mprofile\\x1b[0;-11;-12m, or \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm {timepattern} {commands} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid name or timepattern');\r\n                //{pattern} {commands} profile\r\n                if (args[0].match(/^\\{.*\\}$/g)) {\r\n                    if (args.length > 3)\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm {timepattern} {commands} profile');\r\n                    args[0] = args[0].substr(1, args[0].length - 2);\r\n                    args[0] = this.parseInline(args[0]);\r\n                    if (args[1].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[1] = args[1].substr(1, args[1].length - 2);\r\n                    if (args.length === 3) {\r\n                        profile = this.stripQuotes(args[2]);\r\n                        profile = this.parseInline(profile);\r\n                    }\r\n\r\n                    if (!profile || profile.length === 0)\r\n                        profile = this.client.activeProfile;\r\n                    else {\r\n                        if (this.client.profiles.contains(profile))\r\n                            profile = this.client.profiles.items[profile.toLowerCase()];\r\n                        else\r\n                            throw new Error('Profile not found: ' + profile);\r\n                    }\r\n                    trigger = new Trigger();\r\n                    trigger.pattern = args[0];\r\n                    trigger.value = args[1];\r\n                    trigger.type = TriggerType.Alarm;\r\n                    profile.triggers.push(trigger);\r\n                    this.client.saveProfiles();\r\n                    if (reload) {\r\n                        this._lastSuspend = -1;\r\n                        this.client.updateAlarms();\r\n                    }\r\n                    this.client.echo('Alarm \\'' + trigger.pattern + '\\' added.', -7, -8, true, true);\r\n                    this.emit('item-added', 'trigger', profile.name, trigger);\r\n                    profile = null;\r\n                    return null;\r\n                }\r\n                name = this.stripQuotes(args[0]);\r\n                if (!name || name.length === 0)\r\n                    throw new Error('Invalid alarm name');\r\n                name = this.parseInline(name);\r\n                let pattern = args[1];\r\n                let commands = null;\r\n                if (pattern.match(/^\\{.*\\}$/g))\r\n                    pattern = pattern.substr(1, pattern.length - 2);\r\n                pattern = this.parseInline(pattern);\r\n                if (args.length === 3) {\r\n                    if (args[2].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        commands = args[2].substr(1, args[2].length - 2);\r\n                    else\r\n                        profile = this.stripQuotes(args[2]);\r\n                }\r\n                else if (args.length === 4) {\r\n                    commands = args[2];\r\n                    profile = this.stripQuotes(args[3]);\r\n                    if (commands.match(/^\\{[\\s\\S]*\\}$/g))\r\n                        commands = commands.substr(1, commands.length - 2);\r\n                }\r\n                if (!profile || profile.length === 0) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        profile = this.client.profiles.items[keys[0]];\r\n                        trigger = profile.find('triggers', 'name', name);\r\n                        if (!trigger && !commands)\r\n                            throw new Error('Alarm not found!');\r\n                        else if (!trigger) {\r\n                            trigger = new Trigger();\r\n                            trigger.name = name;\r\n                            profile.triggers.push(trigger);\r\n                            this.client.echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\r\n                            n = true;\r\n                        }\r\n                        else\r\n                            this.client.echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            trigger = this.client.profiles.items[keys[k]].find('triggers', 'name', name);\r\n                            if (trigger) {\r\n                                profile = this.client.profiles.items[keys[k]];\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (!profile && !commands)\r\n                            throw new Error('Alarm not found!');\r\n                        if (!profile)\r\n                            profile = this.client.activeProfile;\r\n                        if (!trigger) {\r\n                            trigger = new Trigger();\r\n                            n = true;\r\n                            trigger.name = name;\r\n                            profile.triggers.push(trigger);\r\n                            this.client.echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\r\n                        }\r\n                        else\r\n                            this.client.echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\r\n                    }\r\n                }\r\n                else {\r\n                    profile = this.parseInline(profile);\r\n                    if (this.client.profiles.contains(profile))\r\n                        profile = this.client.profiles.items[profile.toLowerCase()];\r\n                    else\r\n                        throw new Error('Profile not found: ' + profile);\r\n                    trigger = profile.find('triggers', 'name', name);\r\n                    if (!trigger && !commands)\r\n                        throw new Error('Alarm not found!');\r\n                    else if (!trigger) {\r\n                        trigger = new Trigger();\r\n                        trigger.name = name;\r\n                        profile.triggers.push(trigger);\r\n                        n = true;\r\n                        this.client.echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\r\n                    }\r\n                    else\r\n                        this.client.echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\r\n                }\r\n                trigger.pattern = pattern;\r\n                trigger.type = TriggerType.Alarm;\r\n                if (commands)\r\n                    trigger.value = commands;\r\n                this.client.saveProfiles();\r\n                if (n)\r\n                    this.emit('item-added', 'trigger', profile.name, trigger);\r\n                else\r\n                    this.emit('item-updated', 'trigger', profile.name, profile.triggers.indexOf(trigger), trigger);\r\n                profile = null;\r\n                if (reload) {\r\n                    this._lastSuspend = -1;\r\n                    this.client.updateAlarms();\r\n                }\r\n                return null;\r\n            //#endregion alarm\r\n            case 'ungag':\r\n            case 'ung':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length > 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ung\\x1b[0;-11;-12mag number or \\x1b[4m' + cmdChar + 'ung\\x1b[0;-11;-12mag');\r\n                if (this._gagID.length) {\r\n                    clearTimeout(this._gagID.pop());\r\n                    this._gags.pop();\r\n                }\r\n                this._gag = 0;\r\n                return null;\r\n            case 'gag':\r\n            case 'ga':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region gag\r\n                if (args.length === 0) {\r\n                    //if one exist for this line remove it and replace it with new one\r\n                    if (this._gags.length && this._gags[this._gags.length - 1] == this.client.display.lines.length) {\r\n                        this._gag = 0;\r\n                        this._gags.pop();\r\n                    }\r\n                    this._gags.push(this.client.display.lines.length);\r\n                    this._gagID.push(setTimeout(() => {\r\n                        n = this.adjustLastLine(this._gags.pop());\r\n                        if (this._gags.length) {\r\n                            let gl = this._gags.length;\r\n                            while (gl >= 0) {\r\n                                gl--;\r\n                                if (this._gags[gl] > n)\r\n                                    this._gags[gl]--;\r\n                            }\r\n                        }\r\n                        this.client.display.removeLine(n);\r\n                    }, 0));\r\n                    this._gag = 0;\r\n                    return null;\r\n                }\r\n                else if (args.length > 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ga\\x1b[0;-11;-12mg number or \\x1b[4m' + cmdChar + 'ga\\x1b[0;-11;-12mg');\r\n                i = parseInt(args[0], 10);\r\n                if (isNaN(i))\r\n                    throw new Error('Invalid number \\'' + args[0] + '\\'');\r\n                //if one exist for this line remove it and replace it with new one\r\n                if (this._gags.length && this._gags[this._gags.length - 1] == this.client.display.lines.length) {\r\n                    this._gag = 0;\r\n                    this._gags.pop();\r\n                }\r\n                this._gags.push(this.client.display.lines.length);\r\n                if (i >= 0) {\r\n                    this._gagID.push(setTimeout(() => {\r\n                        n = this.adjustLastLine(this._gags.pop());\r\n                        if (this._gags.length) {\r\n                            let gl = this._gags.length;\r\n                            while (gl >= 0) {\r\n                                gl--;\r\n                                if (this._gags[gl] > n)\r\n                                    this._gags[gl]--;\r\n                            }\r\n                        }\r\n                        this.client.display.removeLine(n);\r\n                        this._gag = i;\r\n                    }, 0));\r\n                    this._gag = 0;\r\n                }\r\n                else {\r\n                    this._gagID.push(setTimeout(() => {\r\n                        n = this.adjustLastLine(this._gags.pop());\r\n                        i *= -1;\r\n                        if (i > this.client.display.lines.length)\r\n                            i = this.client.display.lines.length;\r\n                        this.client.display.removeLines(n - i, i);\r\n                        this._gag = 0;\r\n                    }, 0));\r\n                    this._gag = 0;\r\n                }\r\n                return null;\r\n            //#endregion gag\r\n            case 'wait':\r\n            case 'wa':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //filter out empty arguments to avoid trailing spaces\r\n                args = args.filter(a => a);\r\n                if (args.length === 0 || args.length > 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wa\\x1b[0;-11;-12mit number');\r\n                i = parseInt(this.parseInline(args[0]), 10);\r\n                if (isNaN(i))\r\n                    throw new Error('Invalid number \\'' + i + '\\' for wait');\r\n                if (i < 1)\r\n                    throw new Error('Must be greater then zero for wait');\r\n                return i;\r\n            case 'showclient':\r\n            case 'showcl':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.show();\r\n                return null;\r\n            case 'hideclient':\r\n            case 'hidecl':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.hide();\r\n                return null;\r\n            case 'toggleclient':\r\n            case 'togglecl':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.toggle();\r\n                return null;\r\n            case 'raiseevent':\r\n            case 'raise':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (this.client.getOption('parseDoubleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\\"/g, '\"');\r\n                        });\r\n                    });\r\n                if (this.client.getOption('parseSingleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\'/g, '\\'');\r\n                        });\r\n                    });\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + '\\x1b[4mraise\\x1b[0;-11;-12mevent name or ' + cmdChar + '\\x1b[4mraise\\x1b[0;-11;-12mevent name arguments');\r\n                else if (args.length === 1)\r\n                    this.client.raise(args[0]);\r\n                else\r\n                    this.client.raise(args[0], args.slice(1));\r\n                return null;\r\n            case 'window':\r\n            case 'win':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (this.client.getOption('parseDoubleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\\"/g, '\"');\r\n                        });\r\n                    });\r\n                if (this.client.getOption('parseSingleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\'/g, '\\'');\r\n                        });\r\n                    });\r\n                if (args.length === 0 || args.length > 3)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + '\\x1b[4mwin\\x1b[0;-11;-12mdow name \\x1b[3mclose\\x1b[0;-11;-12m or ' + cmdChar + '\\x1b[4mwin\\x1b[0;-11;-12mdow new \\x1b[3mcharacter\\x1b[0;-11;-12m');\r\n                else if (args.length === 3)\r\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])), this.stripQuotes(this.parseInline(args[1])), this.stripQuotes(this.parseInline(args.slice(2).join(' '))));\r\n                else if (args.length === 1)\r\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])));\r\n                else\r\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])), this.stripQuotes(this.parseInline(args.slice(1).join(' '))));\r\n                return null;\r\n            case 'raisedelayed':\r\n            case 'raisede':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'raisede\\x1b[0;-11;-12mlayed milliseconds name or \\x1b[4m' + cmdChar + 'raisede\\x1b[0;-11;-12mlayed milliseconds name arguments');\r\n                i = parseInt(this.stripQuotes(this.parseInline(args[0])), 10);\r\n                if (isNaN(i))\r\n                    throw new Error('Invalid number \\'' + args[0] + '\\' for raisedelayed');\r\n                if (i < 1)\r\n                    throw new Error('Must be greater then zero for raisedelayed');\r\n                args.shift();\r\n                if (this.client.getOption('parseDoubleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\\"/g, '\"');\r\n                        });\r\n                    });\r\n                if (this.client.getOption('parseSingleQuotes'))\r\n                    args.forEach((a) => {\r\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\r\n                            return e.replace(/\\\\\\'/g, '\\'');\r\n                        });\r\n                    });\r\n\r\n                if (args.length === 1)\r\n                    this.client.raise(args[0], 0, i);\r\n                else\r\n                    this.client.raise(args[0], args.slice(1), i);\r\n                return null;\r\n            case 'notify':\r\n            case 'not':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'not\\x1b[0;-11;-12mify title \\x1b[3mmessage icon\\x1b[0;-11;-12m');\r\n                else {\r\n                    args[0] = this.stripQuotes(args[0]);\r\n                    if (args[args.length - 1].match(/^\\{.*\\}$/g)) {\r\n                        item = args.pop();\r\n                        n = { icon: this.parseInline(item.substr(1, item.length - 2)) };\r\n                    }\r\n                    if (args.length === 0)\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'not\\x1b[0;-11;-12mify title \\x1b[3mmessage icon\\x1b[0;-11;-12m');\r\n                    if (args.length === 1)\r\n                        this.client.notify(this.parseInline(this.stripQuotes(args[0])), null, n);\r\n                    else\r\n                        this.client.notify(this.parseInline(this.stripQuotes(args[0])), this.parseInline(args.slice(1).join(' ')), n);\r\n                }\r\n                return null;\r\n            case 'idle':\r\n            case 'idletime':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (!this.client.lastSendTime)\r\n                    this.client.echo('Not connected', -7, -8, true, true);\r\n                else\r\n                    this.client.echo('You have been idle: ' + getTimeSpan(Date.now() - this.client.lastSendTime), -7, -8, true, true);\r\n                return null;\r\n            case 'connect':\r\n            case 'connecttime':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (!this.client.connectTime) {\r\n                    if (!moment && this.client.disconnectTime)\r\n                        this.client.echo('Disconnected since: ' + (new Date(this.client.disconnectTime).toLocaleString()), -7, -8, true, true);\r\n                    else if (this.client.disconnectTime)\r\n                        this.client.echo('Disconnected since: ' + new moment(this.client.disconnectTime).format('MM/DD/YYYY hh:mm:ss A'), -7, -8, true, true);\r\n                    else\r\n                        this.client.echo('Not connected', -7, -8, true, true);\r\n                }\r\n                else\r\n                    this.client.echo('You have been connected: ' + getTimeSpan(Date.now() - this.client.connectTime), -7, -8, true, true);\r\n                return null;\r\n            case 'beep':\r\n            case 'be':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.beep();\r\n                return null;\r\n            case 'version':\r\n            case 've':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.echo(this.client.telnet.terminal + ' v' + this.client.version, -7, -8, true, true);\r\n                return null;\r\n            case 'showprompt':\r\n            case 'showp':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                args = this.parseInline(args.join(' '));\r\n                this.client.telnet.receivedData(StringToUint8Array(args), true, true);\r\n                this.client.telnet.prompt = true;\r\n                return null;\r\n            case 'show':\r\n            case 'sh':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                args = this.parseInline(args.join(' ') + '\\n');\r\n                this.client.telnet.receivedData(StringToUint8Array(args), true, true);\r\n                return null;\r\n            case 'sayprompt':\r\n            case 'sayp':\r\n            case 'echoprompt':\r\n            case 'echop':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                args = this.parseInline(args.join(' '));\r\n                this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m', false);\r\n                return null;\r\n            case 'say':\r\n            case 'sa':\r\n            case 'echo':\r\n            case 'ec':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                args = this.parseInline(args.join(' '));\r\n                if (this.client.telnet.prompt)\r\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                else\r\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                this.client.telnet.prompt = false;\r\n                return null;\r\n            case 'print':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                i = this.client.enableTriggers;\r\n                this.client.enableTriggers = false;\r\n                args = this.parseInline(args.join(' '));\r\n                if (this.client.telnet.prompt)\r\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                else\r\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                this.client.telnet.prompt = false;\r\n                this.client.enableTriggers = i;\r\n                return null;\r\n            case 'printprompt':\r\n            case 'printp':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                i = this.client.enableTriggers;\r\n                this.client.enableTriggers = false;\r\n                args = this.parseInline(args.join(' '));\r\n                this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m', false);\r\n                this.client.enableTriggers = i;\r\n                return null;\r\n            case 'alias':\r\n            case 'al':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name value or \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name {value} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                else if (args.length === 1)\r\n                    throw new Error('Must supply an alias value');\r\n                else {\r\n                    n = this.parseInline(this.stripQuotes(args.shift()));\r\n                    reload = true;\r\n                    profile = null;\r\n                    if (args[0].match(/^\\{.*\\}$/g) || args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g)) {\r\n                        if (args.length > 2)\r\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name value or \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name {value} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                        if (args.length === 2) {\r\n                            profile = this.parseInline(this.stripQuotes(args[1]));\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile.toLowerCase()];\r\n                            else\r\n                                throw new Error('Profile not found: ' + profile);\r\n                        }\r\n                        else\r\n                            profile = this.client.activeProfile;\r\n                        if (args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g))\r\n                            args = this.parseInline(this.stripQuotes(args[0]));\r\n                        else\r\n                            args = this.parseInline(args[0].substr(1, args[0].length - 2));\r\n                    }\r\n                    else {\r\n                        args = args.join(' ');\r\n                        profile = this.client.activeProfile;\r\n                    }\r\n                    items = profile.aliases;\r\n                    args = this.stripQuotes(args);\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= items.length)\r\n                            throw new Error('Alias index must be >= 0 and < ' + items.length);\r\n                        else {\r\n                            items[n].value = args;\r\n                            this.client.echo('Alias \\'' + items[n].pattern + '\\' updated.', -7, -8, true, true);\r\n                        }\r\n                    }\r\n                    else {\r\n                        for (i = 0, al = items.length; i < al; i++) {\r\n                            if (items[i]['pattern'] === n) {\r\n                                items[i].value = args;\r\n                                this.client.echo('Alias \\'' + n + '\\' updated.', -7, -8, true, true);\r\n                                this.emit('item-updated', 'alias', profile.name, i, tmp);\r\n                                f = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (!f) {\r\n                            tmp = new Alias(n, args);\r\n                            items.push(tmp);\r\n                            this.emit('item-added', 'alias', profile.name, tmp);\r\n                            this.client.echo('Alias \\'' + n + '\\' added.', -7, -8, true, true);\r\n                        }\r\n                    }\r\n                    profile.aliases = items;\r\n                    this.client.saveProfiles();\r\n                    profile = null;\r\n                    if (reload)\r\n                        this.client.clearCache();\r\n                }\r\n                return null;\r\n            case 'unalias':\r\n            case 'una':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias name or \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                else {\r\n                    reload = true;\r\n                    profile = null;\r\n                    if (args[0].match(/^\\{.*\\}$/g) || args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g)) {\r\n                        if (args.length > 2)\r\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias name or \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                        if (args.length === 2) {\r\n                            profile = this.stripQuotes(args[1]);\r\n                            profile = this.parseInline(profile);\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile.toLowerCase()];\r\n                            else\r\n                                throw new Error('Profile not found: ' + profile);\r\n                        }\r\n                        else\r\n                            profile = this.client.activeProfile;\r\n                        if (args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g))\r\n                            n = this.parseInline(this.stripQuotes(args[0]));\r\n                        else\r\n                            n = this.parseInline(args[0].substr(1, args[0].length - 2));\r\n                    }\r\n                    else {\r\n                        n = this.parseInline(args.join(' '));\r\n                        profile = this.client.activeProfile;\r\n                    }\r\n                    items = profile.aliases;\r\n                    n = this.stripQuotes(n);\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        tmp = n;\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= items.length)\r\n                            throw new Error('Alias index must be >= 0 and < ' + items.length);\r\n                        else\r\n                            f = true;\r\n                    }\r\n                    else {\r\n                        tmp = n;\r\n                        n = items.findIndex(i => i.pattern === n);\r\n                        f = n !== -1;\r\n                    }\r\n                    if (!f)\r\n                        this.client.echo('Alias \\'' + tmp + '\\' not found.', -7, -8, true, true);\r\n                    else {\r\n                        this.client.echo('Alias \\'' + items[n].pattern + '\\' removed.', -7, -8, true, true);\r\n                        items.splice(n, 1);\r\n                        profile.aliases = items;\r\n                        this.client.saveProfiles();\r\n                        if (reload)\r\n                            this.client.clearCache();\r\n                        profile = null;\r\n                        this.emit('item-removed', 'alias', profile.name, n);\r\n                    }\r\n                }\r\n                return null;\r\n            case 'setsetting':\r\n            case 'sets':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sets\\x1b[0;-11;-12metting name value');\r\n                else if (args.length === 1)\r\n                    throw new Error('Must supply a setsetting value');\r\n                else {\r\n                    n = this.stripQuotes(this.parseInline(args[0]));\r\n                    args = this.stripQuotes(this.parseInline(args.slice(1).join(' ')));\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        tmp = n;\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= SettingList.length)\r\n                            throw new Error('Setting index must be >= 0 and < ' + SettingList.length);\r\n                        f = true;\r\n                    }\r\n                    else {\r\n                        n = n.toLowerCase();\r\n                        for (i = 0, al = SettingList.length; i < al; i++) {\r\n                            if (SettingList[i][0].toLowerCase() === n) {\r\n                                n = i;\r\n                                f = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!f)\r\n                        throw new Error('Unknown setting \\'' + tmp + '\\'');\r\n                    else {\r\n                        switch (SettingList[n][2]) {\r\n                            case 0:\r\n                                if (SettingList[n][4] > 0 && args.length > SettingList[n][4])\r\n                                    throw new Error('String can not be longer then ' + SettingList[n][4] + ' characters');\r\n                                else {\r\n                                    this.client.setOption(SettingList[n][1] || SettingList[n][0], args);\r\n                                    this.client.echo('Setting \\'' + SettingList[n][0] + '\\' set to \\'' + args + '\\'.', -7, -8, true, true);\r\n                                    this.client.loadOptions();\r\n                                }\r\n                                break;\r\n                            case 1:\r\n                            case 3:\r\n                                switch (args.toLowerCase()) {\r\n                                    case 'true':\r\n                                    case '1':\r\n                                    case 'yes':\r\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], true);\r\n                                        this.client.echo('Setting \\'' + SettingList[n][0] + '\\' set to true.', -7, -8, true, true);\r\n                                        this.client.loadOptions();\r\n                                        break;\r\n                                    case 'no':\r\n                                    case 'false':\r\n                                    case '0':\r\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], false);\r\n                                        this.client.echo('Setting \\'' + SettingList[n][0] + '\\' set to false.', -7, -8, true, true);\r\n                                        this.client.loadOptions();\r\n                                        break;\r\n                                    case 'toggle':\r\n                                        args = this.client.getOption(SettingList[n][1] || SettingList[n][0]) ? false : true;\r\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], args);\r\n                                        this.client.echo('Setting \\'' + SettingList[n][0] + '\\' set to ' + args + '.', -7, -8, true, true);\r\n                                        this.client.loadOptions();\r\n                                        break;\r\n                                    default:\r\n                                        throw new Error('Invalid value, must be true or false');\r\n                                }\r\n                                break;\r\n                            case 2:\r\n                                i = parseInt(args, 10);\r\n                                if (isNaN(i))\r\n                                    throw new Error('Invalid number \\'' + args + '\\'');\r\n                                else {\r\n                                    this.client.setOption(SettingList[n][1] || SettingList[n][0], i);\r\n                                    this.client.echo('Setting \\'' + SettingList[n][0] + '\\' set to \\'' + i + '\\'.', -7, -8, true, true);\r\n                                    this.client.loadOptions();\r\n                                }\r\n                                break;\r\n                            case 4:\r\n                            case 5:\r\n                                throw new Error('Unsupported setting \\'' + n + '\\'');\r\n                        }\r\n                    }\r\n                }\r\n                return null;\r\n            case 'getsetting':\r\n            case 'gets':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'gets\\x1b[0;-11;-12metting name');\r\n                else {\r\n                    n = this.stripQuotes(this.parseInline(args.join(' ')));\r\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\r\n                        n = parseInt(n, 10);\r\n                        if (n < 0 || n >= SettingList.length)\r\n                            throw new Error('Setting index must be >= 0 and < ' + SettingList.length);\r\n                        else\r\n                            f = true;\r\n                    }\r\n                    else {\r\n\r\n                        tmp = n;\r\n                        n = n.toLowerCase();\r\n                        if (n !== 'all') {\r\n                            for (i = 0, al = SettingList.length; i < al; i++) {\r\n                                if (SettingList[i][0].toLowerCase() === n) {\r\n                                    n = i;\r\n                                    f = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (n === 'all') {\r\n                            tmp = 'Current settings:\\n';\r\n                            //this.client.echo(\"Current settings:\", -7, -8, true, true);\r\n                            for (i = 0, al = SettingList.length; i < al; i++) {\r\n                                switch (SettingList[i][2]) {\r\n                                    case 0:\r\n                                    case 2:\r\n                                        //this.client.echo(\"    \"+_SettingList[i][0]+\": \"+getSetting(_SettingList[i][0]), -7, -8, true, true);\r\n                                        tmp += '    ' + SettingList[i][0] + ': ' + this.client.getOption(SettingList[n][1] || SettingList[n][0]) + '\\n';\r\n                                        break;\r\n                                    case 1:\r\n                                    case 3:\r\n                                        if (this.client.getOption(SettingList[n][1] || SettingList[n][0]))\r\n                                            tmp += '    ' + SettingList[i][0] + ': true\\n';\r\n                                        //this.client.echo(\"    \"+_SettingList[i][0]+\": true\", -7, -8, true, true);\r\n                                        else\r\n                                            tmp += '    ' + SettingList[i][0] + ': false\\n';\r\n                                        //this.client.echo(\"    \"+_SettingList[i][0]+\": false\", -7, -8, true, true);\r\n                                        break;\r\n                                }\r\n                            }\r\n                            this.client.echo(tmp, -7, -8, true, true);\r\n                        }\r\n                        else if (!f)\r\n                            throw new Error('Unknown setting \\'' + n + '\\'');\r\n                        else {\r\n                            switch (SettingList[n][2]) {\r\n                                case 0:\r\n                                case 2:\r\n                                    this.client.echo('Setting \\'' + SettingList[n][0] + '\\' is \\'' + this.client.getOption(SettingList[n][1] || SettingList[n][0]) + '\\'', -7, -8, true, true);\r\n                                    break;\r\n                                case 1:\r\n                                case 3:\r\n                                    if (this.client.getOption(SettingList[n][1] || SettingList[n][0]))\r\n                                        this.client.echo('Setting \\'' + SettingList[n][0] + '\\' is true', -7, -8, true, true);\r\n                                    else\r\n                                        this.client.echo('Setting \\'' + SettingList[n][0] + '\\' is false', -7, -8, true, true);\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return null;\r\n            case 'profilelist':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.echo('\\x1b[4mProfiles:\\x1b[0m', -7, -8, true, true);\r\n                const files = this.client.profiles.keys;\r\n                al = files.length;\r\n                for (i = 0; i < al; i++) {\r\n                    if (this.client.profiles.items[files[i]] && this.client.profiles.items[files[i]].enabled)\r\n                        this.client.echo('   ' + this.client.profiles.keys[i] + ' is enabled', -7, -8, true, true);\r\n                    else\r\n                        this.client.echo('   ' + files[i] + ' is disabled', -7, -8, true, true);\r\n                }\r\n                return null;\r\n            case 'profile':\r\n            case 'pro':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\r\n                else if (args.length === 1) {\r\n                    args[0] = this.parseInline(args[0]);\r\n                    this.client.toggleProfile(args[0]);\r\n                    if (!this.client.profiles.contains(args[0]))\r\n                        throw new Error('Profile not found');\r\n                    else if (this.client.profiles.length === 1)\r\n                        throw new Error(args[0] + ' can not be disabled as it is the only one enabled');\r\n                    if (!this.client.profiles.contains(args[0].toLowerCase()))\r\n                        args = 'Profile not found';\r\n                    else if (this.client.profiles.items[args[0].toLowerCase()].enabled)\r\n                        args = args[0] + ' is enabled';\r\n                    else\r\n                        args = args[0] + ' is disabled';\r\n                }\r\n                else {\r\n                    args[0] = this.parseInline(args[0]).toLowerCase();\r\n                    if (!this.client.profiles.contains(args[0]))\r\n                        throw new Error('Profile not found');\r\n                    if (!args[1])\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\r\n                    args[1] = this.parseInline(args[1]);\r\n                    switch (args[1].toLowerCase()) {\r\n                        case 'enable':\r\n                        case 'on':\r\n                        case 'yes':\r\n                            if (this.client.profiles.items[args[0].toLowerCase()].enabled)\r\n                                args = args[0] + ' is already enabled';\r\n                            else {\r\n                                this.client.toggleProfile(args[0]);\r\n                                if (this.client.profiles.items[args[0].toLowerCase()].enabled !== -1)\r\n                                    args = args[0] + ' is enabled';\r\n                                else\r\n                                    args = args[0] + ' remains disabled';\r\n                            }\r\n                            break;\r\n                        case 'disable':\r\n                        case 'off':\r\n                        case 'no':\r\n                            if (!this.client.profiles.items[args[0].toLowerCase()].enabled)\r\n                                args = args[0] + ' is already disabled';\r\n                            else {\r\n                                if (this.client.profiles.length === 1)\r\n                                    throw new Error(args[0] + ' can not be disabled as it is the only one enabled');\r\n                                this.client.toggleProfile(args[0]);\r\n                                args = args[0] + ' is disabled';\r\n                            }\r\n                            break;\r\n                        default:\r\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\r\n                    }\r\n                }\r\n                if (this.client.telnet.prompt)\r\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                else\r\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\r\n                this.client.telnet.prompt = false;\r\n                return null;\r\n            case 'color':\r\n            case 'co':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length > 1 && args.length < 4) {\r\n                    item = {\r\n                        profile: null,\r\n                        pattern: null,\r\n                        commands: null\r\n                    };\r\n                    item.pattern = args.shift();\r\n                    if (item.pattern.match(/^\\{.*\\}$/g))\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    else\r\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\r\n                    if (args.length === 2) {\r\n                        item.commands = cmdChar + 'COLOR ' + this.parseInline(args[0]);\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                    else\r\n                        item.commands = cmdChar + 'COLOR ' + this.parseInline(args[0]);\r\n                    this.createTrigger(item.pattern, item.commands, item.profile);\r\n                    return null;\r\n                }\r\n                else if (args.length !== 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor color or \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                if (args.length !== 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor color or \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\r\n                n = this.client.display.lines.length;\r\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\r\n                    setTimeout(() => {\r\n                        n = this.adjustLastLine(n);\r\n                        this.client.display.colorSubStrByLine(n, parseInt(args[0], 10));\r\n                    }, 0);\r\n                }\r\n                //back,fore from color function\r\n                else if (args[0].trim().match(/^[-|+]?\\d+\\s*?,\\s*?[-|+]?\\d+$/g)) {\r\n                    args[0] = args[0].split(',');\r\n                    setTimeout(() => {\r\n                        n = this.adjustLastLine(n);\r\n                        this.client.display.colorSubStrByLine(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10));\r\n                    }, 0);\r\n                }\r\n                else {\r\n                    args = args[0].toLowerCase().split(',');\r\n                    if (args.length === 1) {\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            n = this.adjustLastLine(n);\r\n                            this.client.display.colorSubStrByLine(n, i);\r\n                        }, 0);\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0] === 'bold' && args[1] === 'bold')\r\n                            throw new Error('Invalid fore color');\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        else if (args[0] === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[1] === 'bold') {\r\n                            setTimeout(() => {\r\n                                n = this.adjustLastLine(n);\r\n                                if (i === 370)\r\n                                    this.client.display.colorSubStrByLine(n, i);\r\n                                else\r\n                                    this.client.display.colorSubStrByLine(n, i * 10);\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            p = i;\r\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                                i = args[1].trim();\r\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                                i = parseInt(args[1].trim(), 10);\r\n                            else {\r\n                                i = getAnsiColorCode(args[1], true);\r\n                                if (i === -1) {\r\n                                    if (isMXPColor(args[1]))\r\n                                        i = args[1];\r\n                                    else\r\n                                        throw new Error('Invalid back color');\r\n                                }\r\n                            }\r\n                            setTimeout(() => {\r\n                                n = this.adjustLastLine(n);\r\n                                this.client.display.colorSubStrByLine(n, p, i);\r\n                            }, 0);\r\n                        }\r\n                    }\r\n                    else if (args.length === 3) {\r\n                        if (args[0] === 'bold') {\r\n                            args.shift();\r\n                            args.push('bold');\r\n                        }\r\n                        if (args[0].trim() === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[2] !== 'bold')\r\n                            throw new Error('Only bold is supported as third argument');\r\n                        else if (!i)\r\n                            i = 370;\r\n                        else\r\n                            p = i * 10;\r\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[1].trim();\r\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[1].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[1], true);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[1]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid back color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            n = this.adjustLastLine(n);\r\n                            this.client.display.colorSubStrByLine(n, p, i);\r\n                        }, 0);\r\n                    }\r\n                }\r\n                return null;\r\n            case 'cw':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                trigger = this.stack.regex;\r\n                if (args.length > 1 && args.length < 4) {\r\n                    item = {\r\n                        profile: null,\r\n                        pattern: null,\r\n                        commands: null\r\n                    };\r\n                    item.pattern = args.shift();\r\n                    if (item.pattern.match(/^\\{.*\\}$/g))\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    else\r\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\r\n                    if (args.length === 2) {\r\n                        item.commands = cmdChar + 'CW ' + this.parseInline(args[0]);\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                    else\r\n                        item.commands = cmdChar + 'CW ' + this.parseInline(args[0]);\r\n                    this.createTrigger(item.pattern, item.commands, item.profile);\r\n                    return null;\r\n                }\r\n                else if (args.length !== 1)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'cw color or ' + cmdChar + 'cw {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\r\n                //no regex so\r\n                if (!trigger) return null;\r\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\r\n                n = this.client.display.lines.length;\r\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\r\n                    setTimeout(() => {\r\n                        n = this.adjustLastLine(n);\r\n                        //verbatim so color whole line\r\n                        if (trigger.length === 1)\r\n                            this.client.display.colorSubStrByLine(n, parseInt(args[0], 10));\r\n                        else {\r\n                            trigger[1].lastIndex = 0;\r\n                            tmp = trigger[0].matchAll(trigger[1]);\r\n                            for (const match of tmp) {\r\n                                this.client.display.colorSubStrByLine(n, parseInt(args[0], 10), null, match.index, match[0].length);\r\n                            }\r\n                        }\r\n                    }, 0);\r\n                }\r\n                //back,fore from color function\r\n                else if (args[0].trim().match(/^[-|+]?\\d+,[-|+]?\\d+$/g)) {\r\n                    args[0] = args[0].split(',');\r\n                    setTimeout(() => {\r\n                        n = this.adjustLastLine(n);\r\n                        //verbatim so color whole line\r\n                        if (trigger.length === 1)\r\n                            this.client.display.colorSubStrByLine(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10));\r\n                        else {\r\n                            trigger[1].lastIndex = 0;\r\n                            tmp = trigger[0].matchAll(trigger[1]);\r\n                            for (const match of tmp) {\r\n                                this.client.display.colorSubStrByLine(n, parseInt(args[0], 10), parseInt(args[0][1], 10), match.index, match[0].length);\r\n                            }\r\n                        }\r\n                    }, 0);\r\n                }\r\n                else {\r\n                    args = args[0].toLowerCase().split(',');\r\n                    if (args.length === 1) {\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            n = this.adjustLastLine(n);\r\n                            //verbatim so color whole line\r\n                            if (trigger.length === 1)\r\n                                this.client.display.colorSubStrByLine(n, i);\r\n                            else {\r\n                                trigger[1].lastIndex = 0;\r\n                                tmp = trigger[0].matchAll(trigger[1]);\r\n                                for (const match of tmp) {\r\n                                    this.client.display.colorSubStrByLine(n, i, null, match.index, match[0].length);\r\n                                }\r\n                            }\r\n                        }, 0);\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0] === 'bold' && args[1] === 'bold')\r\n                            throw new Error('Invalid fore color');\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        else if (args[0] === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[1] === 'bold') {\r\n                            setTimeout(() => {\r\n                                n = this.adjustLastLine(n);\r\n                                if (i !== 370)\r\n                                    i *= 10;\r\n                                //verbatim so color whole line\r\n                                if (trigger.length === 1)\r\n                                    this.client.display.colorSubStrByLine(n, i);\r\n                                else {\r\n                                    trigger[1].lastIndex = 0;\r\n                                    tmp = trigger[0].matchAll(trigger[1]);\r\n                                    for (const match of tmp) {\r\n                                        this.client.display.colorSubStrByLine(n, i, null, match.index, match[0].length);\r\n                                    }\r\n                                }\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            p = i;\r\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                                i = args[1].trim();\r\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                                i = parseInt(args[1].trim(), 10);\r\n                            else {\r\n                                i = getAnsiColorCode(args[1], true);\r\n                                if (i === -1) {\r\n                                    if (isMXPColor(args[1]))\r\n                                        i = args[1];\r\n                                    else\r\n                                        throw new Error('Invalid back color');\r\n                                }\r\n                            }\r\n                            setTimeout(() => {\r\n                                n = this.adjustLastLine(n);\r\n                                //verbatim so color whole line\r\n                                if (trigger.length === 1)\r\n                                    this.client.display.colorSubStrByLine(n, p, i);\r\n                                else {\r\n                                    trigger[1].lastIndex = 0;\r\n                                    tmp = trigger[0].matchAll(trigger[1]);\r\n                                    for (const match of tmp) {\r\n                                        this.client.display.colorSubStrByLine(n, p, i, match.index, match[0].length);\r\n                                    }\r\n                                }\r\n                            }, 0);\r\n                        }\r\n                    }\r\n                    else if (args.length === 3) {\r\n                        if (args[0] === 'bold') {\r\n                            args.shift();\r\n                            args.push('bold');\r\n                        }\r\n                        if (args[0].trim() === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[2] !== 'bold')\r\n                            throw new Error('Only bold is supported as third argument');\r\n                        else if (!i)\r\n                            i = 370;\r\n                        else\r\n                            p = i * 10;\r\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[1].trim();\r\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[1].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[1], true);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[1]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid back color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            n = this.adjustLastLine(n);\r\n                            //verbatim so color whole line\r\n                            if (trigger.length === 1)\r\n                                this.client.display.colorSubStrByLine(n, p, i);\r\n                            else {\r\n                                trigger[1].lastIndex = 0;\r\n                                tmp = trigger[0].matchAll(trigger[1]);\r\n                                for (const match of tmp) {\r\n                                    this.client.display.colorSubStrByLine(n, p, i, match.index, match[0].length);\r\n                                }\r\n                            }\r\n                        }, 0);\r\n                    }\r\n                }\r\n                return null;\r\n            case 'pcol':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 1 || args.length > 5)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'pcol color \\x1b[3mXStart, XEnd, YStart, YEnd\\x1b[0;-11;-12m');\r\n                if (args.length > 1) {\r\n                    tmp = [].concat(...args.slice(1).map(s => this.parseInline(this.stripQuotes(s)).split(' ')));\r\n                    if (tmp.length > 4)\r\n                        throw new Error('Too many arguments use ' + cmdChar + 'pcol color \\x1b[3mXStart, XEnd, YStart, YEnd\\x1b[0;-11;-12m');\r\n                    item = { xStart: 0 };\r\n                    if (tmp.length > 0)\r\n                        item.xStart = parseInt(tmp[0], 10);\r\n                    if (tmp.length > 1)\r\n                        item.xEnd = parseInt(tmp[1], 10);\r\n                    if (tmp.length > 2)\r\n                        item.yStart = parseInt(tmp[2], 10);\r\n                    if (tmp.length > 3)\r\n                        item.yEnd = parseInt(tmp[3], 10);\r\n                    if (item.hasOwnProperty('yEnd') && item.yEnd > item.yStart)\r\n                        throw new Error('yEnd must be smaller or equal to yStart');\r\n                    if (item.hasOwnProperty('xEnd') && item.xEnd < item.xStart)\r\n                        throw new Error('xEnd must be larger or equal to xStart');\r\n                }\r\n                else\r\n                    item = { xStart: 0 };\r\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\r\n                n = this.adjustLastLine(this.client.display.lines.length);\r\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\r\n                    setTimeout(() => {\r\n                        this.colorPosition(n, parseInt(args[0], 10), null, item);\r\n                    }, 0);\r\n                }\r\n                //back,fore from color function\r\n                else if (args[0].trim().match(/^[-|+]?\\d+\\s*?,\\s*?[-|+]?\\d+$/g)) {\r\n                    args[0] = args[0].split(',');\r\n                    setTimeout(() => {\r\n                        this.colorPosition(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10), item);\r\n                    }, 0);\r\n                }\r\n                else {\r\n                    args = args[0].toLowerCase().split(',');\r\n                    if (args.length === 1) {\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            this.colorPosition(n, i, null, item);\r\n                        }, 0);\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0] === 'bold' && args[1] === 'bold')\r\n                            throw new Error('Invalid fore color');\r\n                        if (args[0] === 'bold')\r\n                            i = 370;\r\n                        else if (args[0] === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[1] === 'bold') {\r\n                            setTimeout(() => {\r\n                                this.colorPosition(n, i === 370 ? i : i * 10, null, item);\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            p = i;\r\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                                i = args[1].trim();\r\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                                i = parseInt(args[1].trim(), 10);\r\n                            else {\r\n                                i = getAnsiColorCode(args[1], true);\r\n                                if (i === -1) {\r\n                                    if (isMXPColor(args[1]))\r\n                                        i = args[1];\r\n                                    else\r\n                                        throw new Error('Invalid back color');\r\n                                }\r\n                            }\r\n                            setTimeout(() => {\r\n                                this.colorPosition(n, p, i, item);\r\n                            }, 0);\r\n                        }\r\n                    }\r\n                    else if (args.length === 3) {\r\n                        if (args[0] === 'bold') {\r\n                            args.shift();\r\n                            args.push('bold');\r\n                        }\r\n                        if (args[0].trim() === 'current')\r\n                            i = null;\r\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[0].trim();\r\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[0].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[0]);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[0]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid fore color');\r\n                            }\r\n                        }\r\n                        if (args[2] !== 'bold')\r\n                            throw new Error('Only bold is supported as third argument');\r\n                        else if (!i)\r\n                            i = 370;\r\n                        else\r\n                            p = i * 10;\r\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\r\n                            i = args[1].trim();\r\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\r\n                            i = parseInt(args[1].trim(), 10);\r\n                        else {\r\n                            i = getAnsiColorCode(args[1], true);\r\n                            if (i === -1) {\r\n                                if (isMXPColor(args[1]))\r\n                                    i = args[0];\r\n                                else\r\n                                    throw new Error('Invalid back color');\r\n                            }\r\n                        }\r\n                        setTimeout(() => {\r\n                            this.colorPosition(n, p, i, item);\r\n                        }, 0);\r\n                    }\r\n                }\r\n                return null;\r\n            case 'highlight':\r\n            case 'hi':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length > 0 && args.length < 2) {\r\n                    item = {\r\n                        profile: null,\r\n                        pattern: null,\r\n                        commands: cmdChar + 'HIGHLIGHT'\r\n                    };\r\n                    item.pattern = args.shift();\r\n                    if (item.pattern.match(/^\\{.*\\}$/g))\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    else\r\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\r\n                    if (args.length === 1)\r\n                        item.profile = this.parseInline(this.stripQuotes(args[0]));\r\n                    this.createTrigger(item.pattern, item.commands, item.profile);\r\n                    return null;\r\n                }\r\n                else if (args.length)\r\n                    throw new Error('Too many arguments use \\x1b[4m' + cmdChar + 'hi\\x1b[0;-11;-12mghlight \\x1b[3mpattern profile\\x1b[0;-11;-12m');\r\n                n = this.client.display.lines.length;\r\n                setTimeout(() => {\r\n                    n = this.adjustLastLine(n);\r\n                    this.client.display.highlightSubStrByLine(n);\r\n                }, 0);\r\n                return null;\r\n            case 'break':\r\n            case 'br':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'br\\x1b[0;-11;-12meak\\x1b[0;-11;-12m');\r\n                if (!this.loops.length)\r\n                    throw new Error('\\x1b[4m' + cmdChar + 'br\\x1b[0;-11;-12meak\\x1b[0;-11;-12m must be used in a loop.');\r\n                if (this.stack.break)\r\n                    this.stack.break++;\r\n                else\r\n                    this.stack.break = 1;\r\n                return -1;\r\n            case 'continue':\r\n            case 'cont':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'cont\\x1b[0;-11;-12minue\\x1b[0;-11;-12m');\r\n                if (!this.loops.length)\r\n                    throw new Error('\\x1b[4m' + cmdChar + 'cont\\x1b[0;-11;-12minue\\x1b[0;-11;-12m must be used in a loop.');\r\n                this.stack.continue = true;\r\n                return -2;\r\n            case 'if':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (!args.length || args.length > 3)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'if {expression} {true-command} \\x1b[3m{false-command}\\x1b[0;-11;-12m');\r\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args[0] = args[0].substr(1, args[0].length - 2);\r\n                tmp = null;\r\n                if (this.evaluate(this.parseInline(args[0]))) {\r\n                    if (args[1].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[1] = args[1].substr(1, args[1].length - 2);\r\n                    tmp = this.parseOutgoing(args[1]);\r\n                }\r\n                else if (args.length > 2) {\r\n                    if (args[2].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[2] = args[2].substr(1, args[2].length - 2);\r\n                    tmp = this.parseOutgoing(args[2]);\r\n                }\r\n                if (tmp != null && tmp.length > 0)\r\n                    return tmp;\r\n                return null;\r\n            case 'case':\r\n            case 'ca':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (!args.length || args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ca\\x1b[0;-11;-12mse\\x1b[0;-11;-12m index {command 1} \\x1b[3m{command n}\\x1b[0;-11;-12m');\r\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args[0] = args[0].substr(1, args[0].length - 2);\r\n                n = this.evaluate(this.parseInline(args[0]));\r\n                if (typeof n !== 'number')\r\n                    return null;\r\n                if (n > 0 && n < args.length) {\r\n                    if (args[n].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[n] = args[n].substr(1, args[n].length - 2);\r\n                    tmp = this.parseOutgoing(args[n]);\r\n                    if (tmp != null && tmp.length > 0)\r\n                        return tmp;\r\n                }\r\n                return null;\r\n            case 'switch':\r\n            case 'sw':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (!args.length || args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sw\\x1b[0;-11;-12mitch\\x1b[0;-11;-12m (expression) {command} \\x1b[3m(expression) {command} ... {else_command}\\x1b[0;-11;-12m');\r\n                if (args.length % 2 === 1)\r\n                    n = args.pop();\r\n                else\r\n                    n = null;\r\n                al = args.length;\r\n                //skip every other one as odd items are the commands to execute\r\n                for (i = 0; i < al; i += 2) {\r\n                    if (args[i].match(/^\\{[\\s\\S]*\\}$/g))\r\n                        args[i] = args[i].substr(1, args[i].length - 2);\r\n                    if (this.evaluate(this.parseInline(args[i]))) {\r\n                        if (args[i + 1].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[i + 1] = args[i + 1].substr(1, args[i + 1].length - 2);\r\n                        tmp = this.parseOutgoing(args[i + 1]);\r\n                        if (tmp != null && tmp.length > 0)\r\n                            return tmp;\r\n                        return null;\r\n                    }\r\n                }\r\n                if (n) {\r\n                    if (n.match(/^\\{[\\s\\S]*\\}$/g))\r\n                        n = n.substr(1, n.length - 2);\r\n                    tmp = this.parseOutgoing(n);\r\n                    if (tmp != null && tmp.length > 0)\r\n                        return tmp;\r\n                }\r\n                return null\r\n            case 'loop':\r\n            case 'loo':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'loo\\x1b[0;-11;-12mp\\x1b[0;-11;-12m range {commands}');\r\n                n = this.parseInline(args.shift()).split(',');\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                if (n.length === 1) {\r\n                    tmp = parseInt(n[0], 10);\r\n                    if (isNaN(tmp))\r\n                        throw new Error('Invalid loop range \\'' + n[0] + '\\' must be a number');\r\n                    return this.executeForLoop(0, tmp, args);\r\n                }\r\n                tmp = parseInt(n[0], 10);\r\n                if (isNaN(tmp))\r\n                    throw new Error('Invalid loop min \\'' + n[0] + '\\' must be a number');\r\n                i = parseInt(n[1], 10);\r\n                if (isNaN(i))\r\n                    throw new Error('Invalid loop max \\'' + n[1] + '\\' must be a number');\r\n                if (tmp > i) tmp++;\r\n                else tmp--;\r\n                return this.executeForLoop(tmp, i, args);\r\n            case 'repeat':\r\n            case 'rep':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'rep\\x1b[0;-11;-12meat\\x1b[0;-11;-12m expression {commands}');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                i = this.evaluate(this.parseInline(i));\r\n                if (typeof i !== 'number')\r\n                    throw new Error('Arguments must be a number');\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                if (i < 1)\r\n                    return this.executeForLoop((-i) + 1, 1, args);\r\n                return this.executeForLoop(0, i, args);\r\n            case 'until':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'until expression {commands}');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                tmp = [];\r\n                this.loops.push(0);\r\n                while (!this.evaluate(this.parseInline(i))) {\r\n                    let out = this.parseOutgoing(args);\r\n                    if (out != null && out.length > 0)\r\n                        tmp.push(out);\r\n                    if (this.stack.continue) {\r\n                        this.stack.continue = false;\r\n                        continue;\r\n                    }\r\n                    if (this.stack.break) {\r\n                        this.stack.break--;\r\n                        break;\r\n                    }\r\n                }\r\n                this.loops.pop();\r\n                if (tmp.length > 0)\r\n                    return tmp.map(v => v.trim()).join('\\n');\r\n                return null;\r\n            case 'while':\r\n            case 'wh':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wh\\x1b[0;-11;-12mile expression {commands}');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                tmp = [];\r\n                this.loops.push(0);\r\n                while (this.evaluate(this.parseInline(i))) {\r\n                    let out = this.parseOutgoing(args);\r\n                    if (out != null && out.length > 0)\r\n                        tmp.push(out);\r\n                    if (this.stack.continue) {\r\n                        this.stack.continue = false;\r\n                        continue;\r\n                    }\r\n                    if (this.stack.break) {\r\n                        this.stack.break--;\r\n                        break;\r\n                    }\r\n                }\r\n                this.loops.pop();\r\n                if (tmp.length > 0)\r\n                    return tmp.map(v => v.trim()).join('\\n');\r\n                return null;\r\n            case 'forall':\r\n            case 'fo':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'fo\\x1b[0;-11;-12mrall stringlist {commands}');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                tmp = [];\r\n                i = this.splitByQuotes(this.stripQuotes(this.parseInline(i)), '|');\r\n                al = i.length;\r\n                for (n = 0; n < al; n++) {\r\n                    this.loops.push(i[n]);\r\n                    let out = this.parseOutgoing(args);\r\n                    if (out != null && out.length > 0)\r\n                        tmp.push(out);\r\n                    if (this.stack.continue) {\r\n                        this.stack.continue = false;\r\n                        continue;\r\n                    }\r\n                    if (this.stack.break) {\r\n                        this.stack.break--;\r\n                        break;\r\n                    }\r\n                    this.loops.pop();\r\n                }\r\n                if (tmp.length > 0)\r\n                    return tmp.map(v => v.trim()).join('\\n');\r\n                return null;\r\n            case 'variable':\r\n            case 'var':\r\n            case 'va':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0) {\r\n                    i = Object.keys(this.client.variables);\r\n                    al = i.length;\r\n                    tmp = [];\r\n                    for (n = 0; n < al; n++)\r\n                        tmp.push(i[n] + ' = ' + this.client.variables[i[n]]);\r\n                    return tmp.join('\\n');\r\n                }\r\n                i = args.shift();\r\n                if (i.match(/^\\{.*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                i = this.parseInline(i);\r\n                if (!isValidIdentifier(i))\r\n                    throw new Error(\"Invalid variable name\");\r\n                if (args.length === 0)\r\n                    return this.client.variables[i]?.toString();\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                args = this.parseInline(args);\r\n                if (args.match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                    this.client.variables[i] = parseInt(args, 10);\r\n                else if (args.match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    this.client.variables[i] = parseFloat(args);\r\n                else if (args === \"true\")\r\n                    this.client.variables[i] = true;\r\n                else if (args === \"false\")\r\n                    this.client.variables[i] = false;\r\n                else\r\n                    this.client.variables[i] = this.stripQuotes(args);\r\n                return null;\r\n            case 'unvar':\r\n            case 'unv':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length !== 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unv\\x1b[0;-11;-12mar name ');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                i = this.parseInline(i);\r\n                delete this.client.variables[i];\r\n                return null;\r\n            case 'add':\r\n            case 'ad':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ad\\x1b[0;-11;-12md name value');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                i = this.parseInline(i);\r\n                if (this.client.variables.hasOwnProperty(i) && typeof this.client.variables[i] !== 'number')\r\n                    throw new Error(i + ' is not a number for add');\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                args = this.evaluate(this.parseInline(args));\r\n                if (typeof args !== 'number')\r\n                    throw new Error('Value is not a number for add');\r\n                if (!this.client.variables.hasOwnProperty(i))\r\n                    this.client.variables[i] = args;\r\n                else\r\n                    this.client.variables[i] += args;\r\n                return null;\r\n            case 'math':\r\n            case 'mat':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length < 2)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'mat\\x1b[0;-11;-12mh name value');\r\n                i = args.shift();\r\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    i = i.substr(1, i.length - 2);\r\n                i = this.parseInline(i);\r\n                args = args.join(' ');\r\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                    args = args.substr(1, args.length - 2);\r\n                args = this.evaluate(this.parseInline(args));\r\n                if (typeof args !== 'number')\r\n                    throw new Error('Value is not a number for add');\r\n                this.client.variables[i] = args;\r\n                return null;\r\n            case 'evaluate':\r\n            case 'eva':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'eva\\x1b[0;-11;-12mluate expression');\r\n                args = this.evaluate(this.parseInline(args.join(' ')));\r\n                if (this.client.getOption('ignoreEvalUndefined') && typeof args === 'undefined')\r\n                    args = '';\r\n                else\r\n                    args = '' + args;\r\n                if (this.client.telnet.prompt)\r\n                    this.client.print('\\n' + args + '\\x1b[0m\\n', false);\r\n                else\r\n                    this.client.print(args + '\\x1b[0m\\n', false);\r\n                this.client.telnet.prompt = false;\r\n                return null\r\n            case 'freeze':\r\n            case 'fr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region freeze\r\n                if (args.length === 0) {\r\n                    this.scrollLock = !this.scrollLock;\r\n                    if (this.scrollLock) {\r\n                        if (this.client.display.scrollAtBottom)\r\n                            this.client.display.scrollUp();\r\n                    }\r\n                    else\r\n                        this.client.display.scrollDisplay();\r\n                }\r\n                else if (args.length === 1) {\r\n                    if (args[0] === \"0\" || args[0] === \"false\") {\r\n                        if (this.scrollLock) {\r\n                            this.scrollLock = false;\r\n                            this.client.display.scrollDisplay();\r\n                        }\r\n                    }\r\n                    else if (!this.scrollLock) {\r\n                        this.scrollLock = true;\r\n                        if (this.client.display.scrollAtBottom)\r\n                            this.client.display.scrollUp();\r\n                    }\r\n                }\r\n                else if (args.length > 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'fr\\x1b[0;-11;-12meeze \\x1b[3mnumber\\x1b[0;-11;-12m');\r\n                return null;\r\n            //#endregion freeze                \r\n            case 'clr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'CLR');\r\n                //nothing to clear so just bail\r\n                if (this.client.display.lines.length === 0)\r\n                    return null;\r\n                i = this.client.display.WindowSize.height + 2;\r\n                //skip trailing new lines\r\n                n = this.client.display.lines.length;\r\n                while (n-- && i) {\r\n                    if (this.client.display.lines[n].text.length)\r\n                        break;\r\n                    i--;\r\n                }\r\n                tmp = [];\r\n                while (i--)\r\n                    tmp.push('\\n');\r\n                this.client.print(tmp.join(''), true);\r\n                return null;\r\n            case 'fire':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                args = this.parseInline(args.join(' ') + '\\n');\r\n                this.ExecuteTriggers(TriggerTypes.Regular | TriggerTypes.Pattern | TriggerTypes.LoopExpression, args, args, false, false);\r\n                return null;\r\n            case 'state': //#STATE id state profile\r\n            case 'sta':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //setup args for easy use\r\n                args = args.map(m => {\r\n                    if (!m || !m.length)\r\n                        return m;\r\n                    if (m.match(/^\\{.*\\}$/g))\r\n                        return this.parseInline(m.substr(1, m.length - 2));\r\n                    return this.parseInline(this.stripQuotes(m));\r\n                })\r\n                switch (args.length) {\r\n                    case 0:\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sta\\x1b[0;-11;-12mte \\x1b[3m name|pattern state profile\\x1b[0;-11;-12m');\r\n                    case 1:\r\n                        //state\r\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\r\n                            if (!this._LastTrigger)\r\n                                throw new Error(\"No trigger has fired yet, unable to set state\");\r\n                            trigger = this._LastTrigger;\r\n                            n = trigger.state;\r\n                            trigger.state = parseInt(args[0], 10);\r\n                        }\r\n                        else {\r\n                            //name|pattern\r\n                            const keys = this.client.profiles.keys;\r\n                            let k = 0;\r\n                            const kl = keys.length;\r\n                            if (kl === 0)\r\n                                return null;\r\n                            if (kl === 1) {\r\n                                if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                                    throw Error('No enabled profiles found!');\r\n                                trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                trigger = trigger.find(t => {\r\n                                    return t.name === args[0] || t.pattern === args[0];\r\n                                });\r\n                            }\r\n                            else {\r\n                                for (; k < kl; k++) {\r\n                                    if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                        continue;\r\n                                    trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                    trigger = trigger.find(t => {\r\n                                        return t.name === args[0] || t.pattern === args[0];\r\n                                    });\r\n                                    if (trigger)\r\n                                        break;\r\n                                }\r\n                            }\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0]);\r\n                            n = trigger.state;\r\n                            trigger.state = 0;\r\n                        }\r\n                        break;\r\n                    case 2:\r\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                            throw new Error('Invalid argument to ' + cmdChar + 'state, first argument must be name|pattern');\r\n                        //name|pattern state\r\n                        if (args[1].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\r\n                            const keys = this.client.profiles.keys;\r\n                            let k = 0;\r\n                            const kl = keys.length;\r\n                            if (kl === 0)\r\n                                return null;\r\n                            if (kl === 1) {\r\n                                if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                                    throw Error('No enabled profiles found!');\r\n                                trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                trigger = trigger.find(t => {\r\n                                    return t.name === args[0] || t.pattern === args[0];\r\n                                });\r\n                            }\r\n                            else {\r\n                                for (; k < kl; k++) {\r\n                                    if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                        continue;\r\n                                    trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                    trigger = trigger.find(t => {\r\n                                        return t.name === args[0] || t.pattern === args[0];\r\n                                    });\r\n                                    if (trigger)\r\n                                        break;\r\n                                }\r\n                            }\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0]);\r\n                            n = trigger.state;\r\n                            trigger.state = parseInt(args[1], 10);\r\n                        }\r\n                        //name|pattern profile\r\n                        else {\r\n                            profile = args[1];\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile.toLowerCase()];\r\n                            else\r\n                                throw new Error('Profile not found: ' + args[1]);\r\n                            trigger = SortItemArrayByPriority(profile.triggers);\r\n                            trigger = trigger.find(t => {\r\n                                return t.name === args[0] || t.pattern === args[0];\r\n                            });\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0] + \" in profile: \" + profile.name);\r\n                            n = trigger.state;\r\n                            trigger.state = 0;\r\n                        }\r\n                        break;\r\n                    case 3: //name|pattern state profile\r\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                            throw new Error('Invalid argument to ' + cmdChar + 'state, first argument must be name|pattern');\r\n                        profile = args[2];\r\n                        if (this.client.profiles.contains(profile))\r\n                            profile = this.client.profiles.items[profile.toLowerCase()];\r\n                        else\r\n                            throw new Error('Profile not found: ' + args[2]);\r\n                        trigger = SortItemArrayByPriority(profile.triggers);\r\n                        trigger = trigger.find(t => {\r\n                            return t.name === args[0] || t.pattern === args[0];\r\n                        });\r\n                        if (!trigger)\r\n                            throw new Error(\"Trigger not found: \" + args[0]);\r\n                        n = trigger.state;\r\n                        trigger.state = parseInt(args[1], 10);\r\n                        break;\r\n                    default:\r\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sta\\x1b[0;-11;-12mte \\x1b[3m name|pattern state profile\\x1b[0;-11;-12m');\r\n                }\r\n                if (trigger.state < 0 || trigger.state > trigger.triggers.length) {\r\n                    trigger.state = n;\r\n                    throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                }\r\n                i = trigger.fired;\r\n                trigger.fired = false;\r\n                this.resetTriggerState(this._TriggerCache.indexOf(trigger), n, i);\r\n                this.client.restartAlarmState(trigger, n, trigger.state);\r\n                this.client.saveProfiles();\r\n                this.client.emit('item-updated', 'trigger', trigger.profile.name, trigger.profile.triggers.indexOf(trigger), trigger);\r\n                this.client.echo('Trigger state set to ' + trigger.state + '.', -7, -8, true, true);\r\n                return null;\r\n            case 'set':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#SET pattern|name state value profile\r\n                //setup args for easy use\r\n                args = args.map(m => {\r\n                    if (!m || !m.length)\r\n                        return m;\r\n                    if (m.match(/^\\{.*\\}$/g))\r\n                        return this.parseInline(m.substr(1, m.length - 2));\r\n                    return this.parseInline(this.stripQuotes(m));\r\n                })\r\n                n = 0;\r\n                i = false;\r\n                switch (args.length) {\r\n                    case 0: //state - set fired to true for last trigger\r\n                        throw new Error('Invalid syntax use ' + cmdChar + 'set \\x1b[3mname|pattern\\x1b[0;-11;-12m state \\x1b[3mvalue profile\\x1b[0;-11;-12m');\r\n                    case 1:\r\n                        //state\r\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\r\n                            if (!this._LastTrigger)\r\n                                throw new Error(\"No trigger has fired yet, unable to set state\");\r\n                            trigger = this._LastTrigger;\r\n                            n = parseInt(args[0], 10)\r\n                            if (n < 0 || n > trigger.triggers.length)\r\n                                throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                            if (n === 0) {\r\n                                i = trigger.fired;\r\n                                trigger.fired = true;\r\n                            }\r\n                            else {\r\n                                i = trigger.triggers[n - 1].fired;\r\n                                trigger.triggers[n - 1].fired = true;\r\n                            }\r\n                        }\r\n                        else\r\n                            throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                        break;\r\n                    case 2:\r\n                        //state value - set fired to value for last trigger\r\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\r\n                            if (!this._LastTrigger)\r\n                                throw new Error(\"No trigger has fired yet, unable to set state\");\r\n                            trigger = this._LastTrigger;\r\n                            n = parseInt(args[0], 10)\r\n                            if (n < 0 || n > trigger.triggers.length)\r\n                                throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                            if (args[1] !== \"0\" && args[1] !== \"1\" && args[1] !== \"true\" && args[1] !== \"false\")\r\n                                throw new Error(\"Value must be 0, 1, true, or false\");\r\n                            if (n === 0) {\r\n                                i = trigger.fired;\r\n                                trigger.fired = args[1] === \"1\" || args[1] === \"true\";\r\n                            }\r\n                            else {\r\n                                i = trigger.triggers[n - 1].fired;\r\n                                trigger.triggers[n - 1].fired = args[1] === \"1\" || args[1] === \"true\";\r\n                            }\r\n                        }\r\n                        //pattern|name state - set trigger state fired to true\r\n                        else {\r\n                            const keys = this.client.profiles.keys;\r\n                            let k = 0;\r\n                            const kl = keys.length;\r\n                            if (kl === 0)\r\n                                return null;\r\n                            if (kl === 1) {\r\n                                if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                                    throw Error('No enabled profiles found!');\r\n                                trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                trigger = trigger.find(t => {\r\n                                    return t.name === args[0] || t.pattern === args[0];\r\n                                });\r\n                            }\r\n                            else {\r\n                                for (; k < kl; k++) {\r\n                                    if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                        continue;\r\n                                    trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                    trigger = trigger.find(t => {\r\n                                        return t.name === args[0] || t.pattern === args[0];\r\n                                    });\r\n                                    if (trigger)\r\n                                        break;\r\n                                }\r\n                            }\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0]);\r\n                            n = parseInt(args[1], 10)\r\n                            if (n < 0 || n > trigger.triggers.length)\r\n                                throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                            if (n === 0) {\r\n                                i = trigger.fired;\r\n                                trigger.fired = true;\r\n                            }\r\n                            else {\r\n                                i = trigger.triggers[n - 1].fired;\r\n                                trigger.triggers[n - 1].fired = true;\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        //pattern|name state profile - set trigger state to fired in profile\r\n                        if (args[2] === \"0\" && args[2] !== \"1\" && args[2] !== \"true\" && args[21] !== \"false\") {\r\n                            profile = args[2];\r\n                            if (this.client.profiles.contains(profile))\r\n                                profile = this.client.profiles.items[profile.toLowerCase()];\r\n                            else\r\n                                throw new Error('Profile not found: ' + profile);\r\n                            trigger = SortItemArrayByPriority(profile.triggers);\r\n                            trigger = trigger.find(t => {\r\n                                return t.name === args[0] || t.pattern === args[0];\r\n                            });\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0] + \" in profile: \" + profile.name);\r\n                            n = parseInt(args[1], 10)\r\n                            if (n < 0 || n > trigger.triggers.length)\r\n                                throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                            if (n === 0) {\r\n                                i = trigger.fired;\r\n                                trigger.fired = true;\r\n                            }\r\n                            else {\r\n                                i = trigger.triggers[n - 1].fired;\r\n                                trigger.triggers[n - 1].fired = true;\r\n                            }\r\n                        }\r\n                        //pattern|name state value - set trigger state fired to value          \r\n                        else {\r\n                            const keys = this.client.profiles.keys;\r\n                            let k = 0;\r\n                            const kl = keys.length;\r\n                            if (kl === 0)\r\n                                return null;\r\n                            if (kl === 1) {\r\n                                if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                                    throw Error('No enabled profiles found!');\r\n                                trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                trigger = trigger.find(t => {\r\n                                    return t.name === args[0] || t.pattern === args[0];\r\n                                });\r\n                            }\r\n                            else {\r\n                                for (; k < kl; k++) {\r\n                                    if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                        continue;\r\n                                    trigger = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                    trigger = trigger.find(t => {\r\n                                        return t.name === args[0] || t.pattern === args[0];\r\n                                    });\r\n                                    if (trigger)\r\n                                        break;\r\n                                }\r\n                            }\r\n                            if (!trigger)\r\n                                throw new Error(\"Trigger not found: \" + args[0]);\r\n                            n = parseInt(args[1], 10)\r\n                            if (n < 0 || n > trigger.triggers.length)\r\n                                throw new Error(\"Trigger state must be greater than or equal to 0 or less than or equal to \" + trigger.triggers.length);\r\n                            if (n === 0) {\r\n                                i = trigger.fired;\r\n                                trigger.fired = args[2] === \"1\" || args[2] === \"true\";\r\n                            }\r\n                            else {\r\n                                i = trigger.triggers[n - 1].fired;\r\n                                trigger.triggers[n - 1].fired = args[2] === \"1\" || args[2] === \"true\";\r\n                            }\r\n                        }\r\n                        break;\r\n                    case 4:\r\n                        //pattern|name state value profile - set trigger state to value in profile \r\n                        profile = args[2];\r\n                        if (this.client.profiles.contains(profile))\r\n                            profile = this.client.profiles.items[profile.toLowerCase()];\r\n                        else\r\n                            throw new Error('Profile not found: ' + profile);\r\n                        trigger = SortItemArrayByPriority(profile.triggers);\r\n                        trigger = trigger.find(t => {\r\n                            return t.name === args[0] || t.pattern === args[0];\r\n                        });\r\n                        if (!trigger)\r\n                            throw new Error(\"Trigger not found: \" + args[0] + \" in profile: \" + profile.name);\r\n                        if (args[2] !== \"0\" && args[2] !== \"1\" && args[2] !== \"true\" && args[2] !== \"false\")\r\n                            throw new Error(\"Value must be 0, 1, true, or false\");\r\n                        if (n === 0) {\r\n                            i = trigger.fired;\r\n                            trigger.fired = args[2] === \"1\" || args[2] === \"true\";\r\n                        }\r\n                        else {\r\n                            i = trigger.triggers[n - 1].fired;\r\n                            trigger.triggers[n - 1].fired = args[2] === \"1\" || args[2] === \"true\";\r\n                        }\r\n                        break;\r\n                    default:\r\n                        throw new Error('Invalid syntax use ' + cmdChar + 'set \\x1b[3mname|pattern\\x1b[0;-11;-12m state \\x1b[3mvalue profile\\x1b[0;-11;-12m');\r\n                }\r\n                this.client.saveProfiles();\r\n                this.client.emit('item-updated', 'trigger', trigger.profile.name, trigger.profile.triggers.indexOf(trigger), trigger);\r\n                this.resetTriggerState(this._TriggerCache.indexOf(trigger), n, i);\r\n                if (n === 0)\r\n                    this.client.echo('Trigger state 0 fired state set to ' + trigger.fired + '.', -7, -8, true, true);\r\n                else {\r\n                    this.client.echo('Trigger state ' + n + ' fired state set to ' + trigger.triggers[n - 1].fired + '.', -7, -8, true, true);\r\n                    //manual trigger fire it using set type\r\n                    if (trigger.enabled && trigger.triggers[n - 1].enabled && trigger.triggers[n - 1].type === SubTriggerTypes.Manual) {\r\n                        this._LastTriggered = '';\r\n                        this.ExecuteTrigger(trigger, [], false, this._TriggerCache.indexOf(trigger), 0, 0, trigger);\r\n                    }\r\n                }\r\n                return null;\r\n            case 'condition':\r\n            case 'cond':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region condition\r\n                item = {\r\n                    profile: null,\r\n                    name: null,\r\n                    pattern: null,\r\n                    commands: null,\r\n                    options: { priority: 0 }\r\n                };\r\n                if (args.length < 2 || args.length > 5)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'cond\\x1b[0;-11;-12mition name|pattern {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'cond\\x1b[0;-11;-12mition {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid trigger name or pattern');\r\n\r\n                if (args[0].match(/^\\{.*\\}$/g)) {\r\n                    item.pattern = args.shift();\r\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                }\r\n                else {\r\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\r\n                    if (!item.name || item.name.length === 0)\r\n                        throw new Error('Invalid trigger name');\r\n                    if (args[0].match(/^\\{.*\\}$/g)) {\r\n                        item.pattern = args.shift();\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    }\r\n                }\r\n                if (args.length !== 0) {\r\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                        item.commands = args.shift();\r\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                    }\r\n                    if (args.length === 1) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        else\r\n                            args[0] = this.stripQuotes(args[0]);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'temporary':\r\n                                    case 'temp':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                    //case 'expression':\r\n                                    case 'reparse':\r\n                                    case 'reparsepattern':\r\n                                    case 'manual':\r\n                                    case 'skip':\r\n                                    case 'looplines':\r\n                                    case 'looppattern':\r\n                                    case 'wait':\r\n                                    case 'duration':\r\n                                    case 'withinlines':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1]))\r\n                                                throw new Error('Invalid trigger type');\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid trigger options');\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'temporary':\r\n                                    case 'temp':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                    //case 'expression':\r\n                                    case 'reparse':\r\n                                    case 'reparsepattern':\r\n                                    case 'manual':\r\n                                    case 'skip':\r\n                                    case 'looplines':\r\n                                    case 'looppattern':\r\n                                    case 'wait':\r\n                                    case 'duration':\r\n                                    case 'withinlines':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1]))\r\n                                                throw new Error('Invalid trigger type');\r\n\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid trigger options');\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                }\r\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name, true);\r\n                //#endregion\r\n                return null;\r\n            case 'cr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.sendBackground('\\n');\r\n                return null;\r\n            case 'send':\r\n            case 'se':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd file \\x1b[3mprefix suffix\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd text');\r\n                args = args.join(' ');\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd file \\x1b[3mprefix suffix\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd text');\r\n                this.client.sendBackground(this.stripQuotes(args), this.client.getOption('allowCommentsFromCommand'));\r\n                return null;\r\n            //work around for send as can not access files so we open a file dialog and ask for the file they want to send instead\r\n            case 'sendfile':\r\n            case 'sendf':\r\n                ((a, r) => {\r\n                    openFileDialog().then(files => {\r\n                        readFile(files[0]).then((contents: any) => {\r\n                            if ((this.client.getOption('echo') & 4) === 4)\r\n                                this.client.echo(r, -3, -4, true, true);\r\n                            p = '';\r\n                            i = '';\r\n                            if (a.length > 1)\r\n                                p = this.stripQuotes(this.parseInline(a[0]));\r\n                            if (a.length > 2)\r\n                                i = this.stripQuotes(this.parseInline(a[1]));\r\n                            //handle \\n and \\r\\n for windows and linux files\r\n                            items = contents.split(/\\r?\\n/);\r\n                            items.forEach(line => {\r\n                                this.client.sendBackground(p + line + i, null, this.client.getOption('allowCommentsFromCommand'));\r\n                            });\r\n                        }).catch(this.client.error);\r\n                    }).catch(() => { });\r\n                })(args, raw);\r\n                return null;\r\n            //work around for sendraw as can not access files so we open a file dialog and ask for the file they want to send instead\r\n            case 'sendfileraw':\r\n            case 'sendfiler':\r\n                ((a, r) => {\r\n                    openFileDialog().then(files => {\r\n                        readFile(files[0]).then((contents: any) => {\r\n                            if ((this.client.getOption('echo') & 4) === 4)\r\n                                this.client.echo(r, -3, -4, true, true);\r\n                            p = '';\r\n                            i = '';\r\n                            if (a.length > 1)\r\n                                p = this.stripQuotes(this.parseInline(a[0]));\r\n                            if (a.length > 2)\r\n                                i = this.stripQuotes(this.parseInline(a[1]));\r\n                            //handle \\n and \\r\\n for windows and linux files\r\n                            items = contents.split(/\\r?\\n/);\r\n                            items.forEach(line => {\r\n                                this.client.sendRaw(p + line + i);\r\n                            });\r\n                        }).catch(this.client.error);\r\n                    }).catch(() => { });\r\n                })(args, raw);\r\n                return null;\r\n            case 'sendraw':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'sendraw text or ' + cmdChar + 'sendraw file \\x1b[3mprefix suffix\\x1b[0;-11;-12m');\r\n                args = args.join(' ');\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'sendraw text or ' + cmdChar + 'sendraw file \\x1b[3mprefix suffix\\x1b[0;-11;-12m');\r\n                if (!args.endsWith('\\n'))\r\n                    args = args + '\\n';\r\n                this.client.sendRaw(args);\r\n                return null;\r\n            case 'sendprompt':\r\n            case 'sendp':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sendp\\x1b[0;-11;-12mrompt text');\r\n                args = args.join(' ');\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sendp\\x1b[0;-11;-12mrompt text');\r\n                this.client.sendRaw(args);\r\n                return null;\r\n            case 'character':\r\n            case 'char':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                this.client.sendRaw(window.$character || '');\r\n                return null;\r\n            case 'speak':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speak text');\r\n                args = args.join(' ');\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speak text');\r\n                args = this.stripQuotes(this.parseInline(args));\r\n                if (args.length !== 0)\r\n                    window.speechSynthesis.speak(new SpeechSynthesisUtterance(args));\r\n                return null;\r\n            case 'speakstop':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length !== 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakstop');\r\n                window.speechSynthesis.cancel();\r\n                return null;\r\n            case 'speakpause':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length !== 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakpause');\r\n                window.speechSynthesis.pause();\r\n                return null;\r\n            case 'speakresume':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length !== 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakresume');\r\n                window.speechSynthesis.resume();\r\n                return null;\r\n            case 'comment':\r\n            case 'comm':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                return null;\r\n            case 'noop':\r\n            case 'no':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length)\r\n                    this.parseInline(args.join(' '));\r\n                return null;\r\n            case 'temp':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //#region temp\r\n                item = {\r\n                    profile: null,\r\n                    name: null,\r\n                    pattern: null,\r\n                    commands: null,\r\n                    options: { priority: 0 }\r\n                };\r\n                if (args.length < 2 || args.length > 5)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'temp name {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or ' + cmdChar + 'temp {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\r\n                if (args[0].length === 0)\r\n                    throw new Error('Invalid temporary trigger or pattern');\r\n\r\n                if (args[0].match(/^\\{.*\\}$/g)) {\r\n                    item.pattern = args.shift();\r\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                }\r\n                else {\r\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\r\n                    if (!item.name || item.name.length === 0)\r\n                        throw new Error('Invalid temporary trigger name');\r\n                    if (args[0].match(/^\\{.*\\}$/g)) {\r\n                        item.pattern = args.shift();\r\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\r\n                    }\r\n                }\r\n                if (args.length !== 0) {\r\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\r\n                        item.commands = args.shift();\r\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\r\n                    }\r\n                    if (args.length === 1) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        else\r\n                            args[0] = this.stripQuotes(args[0]);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                        //case 'expression':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1], TriggerTypeFilter.Main))\r\n                                                throw new Error('Invalid temporary trigger type');\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid temporary trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid temporary trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid temporary trigger options');\r\n                    }\r\n                    else if (args.length === 2) {\r\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\r\n                            args[0] = args[0].substr(1, args[0].length - 2);\r\n                        if (args[0].length !== 0) {\r\n                            this.parseInline(args[0]).split(',').forEach(o => {\r\n                                switch (o.trim()) {\r\n                                    case 'nocr':\r\n                                    case 'prompt':\r\n                                    case 'case':\r\n                                    case 'verbatim':\r\n                                    case 'disable':\r\n                                    case 'enable':\r\n                                    case 'cmd':\r\n                                    case 'raw':\r\n                                    case 'pattern':\r\n                                    case 'regular':\r\n                                    case 'alarm':\r\n                                    case 'event':\r\n                                    case 'cmdpattern':\r\n                                    case 'loopexpression':\r\n                                        //case 'expression':\r\n                                        item.options[o.trim()] = true;\r\n                                        break;\r\n                                    default:\r\n                                        if (o.trim().startsWith('param=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger param option '${o.trim()}'`);\r\n                                            item.options['params'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('type=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger type option '${o.trim()}'`);\r\n                                            if (!this.isTriggerType(tmp[1], TriggerTypeFilter.Main))\r\n                                                throw new Error('Invalid temporary trigger type');\r\n\r\n                                            item.options['type'] = tmp[1];\r\n                                        }\r\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\r\n                                            tmp = o.trim().split('=');\r\n                                            if (tmp.length !== 2)\r\n                                                throw new Error(`Invalid temporary trigger priority option '${o.trim()}'`);\r\n                                            i = parseInt(tmp[1], 10);\r\n                                            if (isNaN(i))\r\n                                                throw new Error('Invalid temporary trigger priority value \\'' + tmp[1] + '\\' must be a number');\r\n                                            item.options['priority'] = i;\r\n                                        }\r\n                                        else\r\n                                            throw new Error(`Invalid temporary trigger option '${o.trim()}'`);\r\n                                }\r\n                            });\r\n                        }\r\n                        else\r\n                            throw new Error('Invalid temporary trigger options');\r\n                        item.profile = this.stripQuotes(args[1]);\r\n                        if (item.profile.length !== 0)\r\n                            item.profile = this.parseInline(item.profile);\r\n                    }\r\n                }\r\n                item.options.temporary = true;\r\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name);\r\n                //#endregion\r\n                return null;\r\n            case 'wrap':\r\n            case 'wr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                //filter out empty arguments to avoid trailing spaces\r\n                args = args.filter(a => a);\r\n                if (args.length > 1)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wr\\x1b[0;-11;-12map or \\x1b[4m' + cmdChar + 'wr\\x1b[0;-11;-12map number');\r\n                if (args.length === 0) {\r\n                    this.client.setOption('display.wordWrap', !this.client.getOption('display.wordWrap'))\r\n                    this.client.display.wordWrap = this.client.getOption('display.wordWrap');\r\n                }\r\n                else {\r\n                    i = parseInt(this.parseInline(args[0]), 10);\r\n                    if (isNaN(i))\r\n                        throw new Error('Invalid number \\'' + i + '\\' for wrap');\r\n                    if (i < 0)\r\n                        throw new Error('Must be greater then or equal to zero for wrap');\r\n                    this.client.setOption('display.wordWrap', true)\r\n                    this.client.setOption('display.wordWrap', i)\r\n                    this.client.display.wordWrap = true;\r\n                    this.client.display.wrapAt = i;\r\n                }\r\n                return null;\r\n            case 'prompt':\r\n            case 'pr':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0 || args.length > 4)\r\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pr\\x1b[0;-11;-12mompt variable \\x1b[3mmessage defaultValue mask\\x1b[0;-11;-12m');\r\n                else {\r\n                    i = args.shift();\r\n                    if (i.match(/^\\{.*\\}$/g))\r\n                        i = i.substr(1, i.length - 2);\r\n                    i = this.parseInline(i);\r\n                    if (!isValidIdentifier(i))\r\n                        throw new Error(\"Invalid variable name\");\r\n                    args = args.map(a => this.parseInline(this.stripQuotes(a)))\r\n                    if (args.length === 3 && args[2] && args[2].toLowerCase() === 'true')\r\n                        args[2] = true;\r\n                    args = window.prompt(...args);\r\n                    if (args?.match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                        this.client.variables[i] = parseInt(args, 10);\r\n                    else if (args?.match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                        this.client.variables[i] = parseFloat(args);\r\n                    else if (args === \"true\")\r\n                        this.client.variables[i] = true;\r\n                    else if (args === \"false\")\r\n                        this.client.variables[i] = false;\r\n                    else\r\n                        this.client.variables[i] = args;\r\n                }\r\n                return null;\r\n            case 'setmap':\r\n                if ((this.client.getOption('echo') & 4) === 4)\r\n                    this.client.echo(raw, -3, -4, true, true);\r\n                if (args.length === 0)\r\n                    throw new Error('Invalid syntax use ' + cmdChar + 'setmap file \\x1b[3msetCharacter\\x1b[0;-11;-12m');\r\n                tmp = this.stripQuotes(this.parseInline(args.shift())) || '';\r\n                if (!tmp || !tmp.length)\r\n                    throw new Error('Empty file\\x1b[0;-11;-12m');\r\n                if (args.length > 1)\r\n                    p = this.stripQuotes(this.parseInline(args.join(' '))).toLocaleLowerCase().trim();\r\n                else\r\n                    p = '';\r\n                this.emit('setmap', tmp, p === 'true' || p === 'yes', true);\r\n                return null;\r\n        }\r\n        if (fun.match(/^[-|+]?\\d+$/)) {\r\n            if ((this.client.getOption('echo') & 4) === 4)\r\n                this.client.echo(raw, -3, -4, true, true);\r\n            i = parseInt(fun, 10);\r\n            if (args.length === 0)\r\n                throw new Error('Invalid syntax use ' + cmdChar + 'nnn commands');\r\n            args = args.join(' ');\r\n            if (args.match(/^\\{[\\s\\S]*\\}$/g))\r\n                args = args.substr(1, args.length - 2);\r\n            if (i < 1)\r\n                return this.executeForLoop((-i) + 1, 1, args);\r\n            return this.executeForLoop(0, i, args);\r\n        }\r\n        const data: FunctionEvent = { name: fun, args: args, raw: raw, handled: false, return: null };\r\n        this.client.emit('function', data);\r\n        if (data.handled) {\r\n            if ((this.client.getOption('echo') & 4) === 4)\r\n                this.client.echo(raw, -3, -4, true, true);\r\n            return data.return;\r\n        }\r\n        if (data.raw.startsWith(cmdChar))\r\n            return cmdChar + this.parseOutgoing(data.raw.substr(1), null, null, null, true);\r\n        return this.parseOutgoing(data.raw + '\\n', null, null, null, true);\r\n    }\r\n\r\n    private executeForLoop(start: number, end: number, commands: string) {\r\n        let tmp = [];\r\n        let r: number;\r\n        if (start > end) {\r\n            for (r = start - 1; r >= end; r--) {\r\n                this.loops.push(r);\r\n                try {\r\n                    let out = this.parseOutgoing(commands);\r\n                    if (out != null && out.length > 0)\r\n                        tmp.push(out);\r\n                    if (this.stack.continue) {\r\n                        this.stack.continue = false;\r\n                        continue;\r\n                    }\r\n                    if (this.stack.break) {\r\n                        this.stack.break--;\r\n                        break;\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    throw e;\r\n                }\r\n                finally {\r\n                    this.loops.pop();\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (r = start; r < end; r++) {\r\n                this.loops.push(r + 1);\r\n                try {\r\n                    let out = this.parseOutgoing(commands);\r\n                    if (out != null && out.length > 0)\r\n                        tmp.push(out);\r\n                    if (this.stack.continue) {\r\n                        this.stack.continue = false;\r\n                        continue;\r\n                    }\r\n                    if (this.stack.break) {\r\n                        this.stack.break--;\r\n                        break;\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    throw e;\r\n                }\r\n                finally {\r\n                    this.loops.pop();\r\n                }\r\n            }\r\n        }\r\n        if (tmp.length > 0)\r\n            return tmp.map(v => v.trim()).join('\\n');\r\n        return null;\r\n    }\r\n\r\n    public parseInline(text) {\r\n        return this.parseOutgoing(text, false, null, false, true);\r\n    }\r\n\r\n    public parseOutgoing(text: string, eAlias?: boolean, stacking?: boolean, append?: boolean, noFunctions?: boolean, noComments?: boolean) {\r\n        const tl = text.length;\r\n        if (!this.enableParsing || text == null || tl === 0)\r\n            return text;\r\n        let str: string = '';\r\n        let alias: string = '';\r\n        let AliasesCached;\r\n        let state = 0;\r\n        //store as local vars to speed up parsing\r\n        const aliases = this.client.aliases;\r\n        const stackingChar: string = this.client.getOption('commandStackingChar');\r\n        const spChar: string = this.client.getOption('speedpathsChar');\r\n        const ePaths: boolean = this.client.getOption('enableSpeedpaths');\r\n        const eCmd: boolean = this.client.getOption('enableCommands');\r\n        const cmdChar: string = this.client.getOption('commandChar');\r\n        const eEscape: boolean = this.client.getOption('allowEscape');\r\n        const escChar: string = this.client.getOption('escapeChar');\r\n        const verbatimChar: string = this.client.getOption('verbatimChar');\r\n        const eVerbatim: boolean = this.client.getOption('enableVerbatim');\r\n        const eParamEscape: boolean = this.client.getOption('enableDoubleParameterEscaping');\r\n        const paramChar: string = this.client.getOption('parametersChar');\r\n        const eParam: boolean = this.client.getOption('enableParameters');\r\n        const nParamChar: string = this.client.getOption('nParametersChar');\r\n        const eNParam: boolean = this.client.getOption('enableNParameters');\r\n        const eEval: boolean = this.client.getOption('allowEval');\r\n        const iEval: boolean = this.client.getOption('ignoreEvalUndefined');\r\n        const iComments: boolean = this.client.getOption('enableInlineComments') && !noComments;\r\n        const bComments: boolean = this.client.getOption('enableBlockComments') && !noComments;\r\n        const iCommentsStr: string[] = this.client.getOption('inlineCommentString').split('');\r\n        const bCommentsStr: string[] = this.client.getOption('blockCommentString').split('');\r\n        const bTrim: boolean = this.client.getOption('ignoreInputLeadingWhitespace');\r\n        let sTrim = '';\r\n        let args = [];\r\n        let arg: any = '';\r\n        let findAlias: boolean = true;\r\n        let out: string = '';\r\n        let a;\r\n        let c: string;\r\n        let al: number;\r\n        let idx: number = 0;\r\n        let tmp;\r\n        let tmp2;\r\n        let start: boolean = true;\r\n        let _neg: boolean = false;\r\n        let _pos: boolean = false;\r\n        let _fall: boolean = false;\r\n        let nest: number = 0;\r\n        const pd: boolean = this.client.getOption('parseDoubleQuotes');\r\n        const ps: boolean = this.client.getOption('parseSingleQuotes');\r\n\r\n        if (eAlias == null)\r\n            eAlias = aliases.length > 0;\r\n        else\r\n            eAlias = eAlias && aliases.length > 0;\r\n\r\n        //if no character set treat it as disabled\r\n        if (stackingChar.length === 0)\r\n            stacking = false;\r\n        else if (stacking == null)\r\n            stacking = this.client.getOption('commandStacking');\r\n        else\r\n            stacking = stacking && this.client.getOption('commandStacking');\r\n\r\n        for (idx = 0; idx < tl; idx++) {\r\n            c = text.charAt(idx);\r\n            switch (state) {\r\n                case ParseState.doubleQuoted:\r\n                    //quoted string\r\n                    if (eEscape && c === escChar)\r\n                        state = ParseState.doubleQuotedEscape;\r\n                    else {\r\n                        if (c === '\"' && pd)\r\n                            state = ParseState.none;\r\n                        if (eAlias && findAlias)\r\n                            alias += c;\r\n                        else\r\n                            str += c;\r\n                    }\r\n                    start = false;\r\n                    break;\r\n                case ParseState.doubleQuotedEscape:\r\n                    state = ParseState.doubleQuoted;\r\n                    if (c !== '\"' && c !== escChar) {\r\n                        idx--;\r\n                        if (eAlias && findAlias)\r\n                            alias += escChar;\r\n                        else\r\n                            str += escChar;\r\n                    }\r\n                    else if (eAlias && findAlias)\r\n                        alias += c;\r\n                    else\r\n                        str += c;\r\n                    break;\r\n                case ParseState.singleQuoted:\r\n                    if (eEscape && c === escChar)\r\n                        state = ParseState.doubleQuotedEscape;\r\n                    else {\r\n                        //quoted string\r\n                        if (c === '\\'' && ps)\r\n                            state = ParseState.none;\r\n                        if (eAlias && findAlias)\r\n                            alias += c;\r\n                        else\r\n                            str += c;\r\n                    }\r\n                    start = false;\r\n                    break;\r\n                case ParseState.singleQuotedEscape:\r\n                    state = ParseState.singleQuoted;\r\n                    if (c !== '\\'' && c !== escChar) {\r\n                        idx--;\r\n                        if (eAlias && findAlias)\r\n                            alias += escChar;\r\n                        else\r\n                            str += escChar;\r\n                    }\r\n                    else if (eAlias && findAlias)\r\n                        alias += c;\r\n                    else\r\n                        str += c;\r\n                    break;\r\n                case ParseState.aliasArguments:\r\n                    //quoted string so keep intact\r\n                    if (c === '\"' && pd) {\r\n                        arg += c;\r\n                        state = ParseState.aliasArgumentsDouble;\r\n                        start = false;\r\n                    }\r\n                    //quoted string so keep int\r\n                    else if (c === '\\'' && ps) {\r\n                        arg += c;\r\n                        state = ParseState.aliasArgumentsSingle;\r\n                        start = false;\r\n                    }\r\n                    else if (eEscape && c === escChar) {\r\n                        state = ParseState.aliasArgumentsEscape;\r\n                        start = false;\r\n                    }\r\n                    //end of alias at end of text, new line, or command stack if enabled\r\n                    else if (idx === tl - 1 || c === '\\n' || (stacking && c === stackingChar)) {\r\n                        if (!(c === '\\n' || (stacking && c === stackingChar)))\r\n                            arg += c;\r\n                        //save any arg that was found\r\n                        if (arg.length > 0)\r\n                            args.push(this.parseInline(arg));\r\n                        al = AliasesCached.length;\r\n                        for (a = 0; a < al; a++) {\r\n                            str = this.ExecuteAlias(AliasesCached[a], args);\r\n                            if (typeof str === 'number') {\r\n                                if (str >= 0)\r\n                                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                                if (out.length === 0) return null;\r\n                                return out;\r\n                            }\r\n                            if (str !== null) out += str;\r\n                            str = '';\r\n                            if (!a.multi) break;\r\n                            if (this.stack.continue || this.stack.break) {\r\n                                if (out.length === 0) return null;\r\n                                return out;\r\n                            }\r\n                        }\r\n                        alias = '';\r\n                        state = ParseState.none;\r\n                        AliasesCached = null;\r\n                        start = true;\r\n                    }\r\n                    //space so new argument\r\n                    else if (c === ' ') {\r\n                        args.push(this.parseInline(arg));\r\n                        arg = '';\r\n                        start = false;\r\n                    }\r\n                    else {\r\n                        arg += c;\r\n                        start = false;\r\n                    }\r\n                    break;\r\n                case ParseState.aliasArgumentsDouble: //quoted alias argument\r\n                    if (c === '\"')\r\n                        state = ParseState.aliasArguments;\r\n                    arg += c;\r\n                    start = false;\r\n                    break;\r\n                case ParseState.aliasArgumentsSingle: //quoted alias argument\r\n                    if (c === '\\'')\r\n                        state = ParseState.aliasArguments;\r\n                    arg += c;\r\n                    start = false;\r\n                    break;\r\n                case ParseState.aliasArgumentsEscape:\r\n                    state = ParseState.aliasArguments;\r\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\r\n                        arg += c;\r\n                    else if (iComments && c == iCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if (bComments && c == bCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if ('\"\\'{'.indexOf(c) !== -1)\r\n                        arg += c;\r\n                    else\r\n                        arg += escChar + c;\r\n                    break;\r\n                case ParseState.path: //path found\r\n                    if (eEscape && c === escChar) {\r\n                        state = ParseState.pathEscape;\r\n                        start = false;\r\n                    }\r\n                    else if (c === '\\n' || (stacking && c === stackingChar)) {\r\n                        state = ParseState.none;\r\n                        str = this.ProcessPath(str);\r\n                        if (str !== null) out += str;\r\n                        str = '';\r\n                        start = true;\r\n                        if (this.stack.continue || this.stack.break) {\r\n                            if (out.length === 0) return null;\r\n                            return out;\r\n                        }\r\n                    }\r\n                    else if (idx === 1 && c === spChar) {\r\n                        state = ParseState.none;\r\n                        idx--;\r\n                        start = false;\r\n                    }\r\n                    else {\r\n                        str += c;\r\n                        start = false;\r\n                    }\r\n                    break;\r\n                case ParseState.pathEscape:\r\n                    state = ParseState.path;\r\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\r\n                        str += c;\r\n                    else if (iComments && c == iCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if (bComments && c == bCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if ('\"\\'{'.indexOf(c) !== -1)\r\n                        str += c;\r\n                    else\r\n                        str += escChar + c;\r\n                    break;\r\n                case ParseState.function:\r\n                    if (c === '{') {\r\n                        start = false;\r\n                        str += c;\r\n                        nest++;\r\n                    }\r\n                    else if (c === '}') {\r\n                        start = false;\r\n                        str += c;\r\n                        nest--;\r\n                    }\r\n                    else if (nest === 0 && eEscape && c === escChar) {\r\n                        state = ParseState.functionEscape;\r\n                        start = false;\r\n                    }\r\n                    else if (nest === 0 && (c === '\\n' || (stacking && c === stackingChar))) {\r\n                        state = ParseState.none;\r\n                        str = this.executeScript(cmdChar + str);\r\n                        if (typeof str === 'number') {\r\n                            if (str >= 0)\r\n                                this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                            if (out.length === 0) return null;\r\n                            return out;\r\n                        }\r\n                        if (str !== null) {\r\n                            out += sTrim + str + '\\n';\r\n                            /*\r\n                            if (str.startsWith(cmdChar))\r\n                                out += cmdChar + this.parseOutgoing(str.substr(1));\r\n                            else\r\n                                out += this.parseOutgoing(str);\r\n                            */\r\n                        }\r\n                        if (this.stack.continue || this.stack.break) {\r\n                            if (out.length === 0) return null;\r\n                            return out;\r\n                        }\r\n                        str = '';\r\n                        start = true;\r\n                    }\r\n                    else {\r\n                        str += c;\r\n                        start = false;\r\n                    }\r\n                    break;\r\n                case ParseState.functionEscape:\r\n                    state = ParseState.function;\r\n                    str += escChar + c;\r\n                    break;\r\n                case ParseState.paramsP:\r\n                    if (c === '{' && arg.length === 0) {\r\n                        state = ParseState.paramsPBlock;\r\n                        continue;\r\n                    }\r\n                    /*\r\n                    if (eEscape && c === escChar && arg.length === 0) {\r\n                        state = ParseState.paramsPEscape;\r\n                        continue;\r\n                    }\r\n                    */\r\n                    switch (c) {\r\n                        case paramChar:\r\n                            if (arg.length === 0) {\r\n                                if (eAlias && findAlias)\r\n                                    alias += paramChar;\r\n                                else\r\n                                    str += paramChar;\r\n                                state = ParseState.none;\r\n                                if (!eParamEscape)\r\n                                    idx--;\r\n                            }\r\n                            break;\r\n                        case '*':\r\n                            if (arg.length === 0) {\r\n                                if (this.stack.args) {\r\n                                    if (eAlias && findAlias)\r\n                                        alias += this.stack.args.slice(1).join(' ');\r\n                                    else\r\n                                        str += this.stack.args.slice(1).join(' ');\r\n                                    this.stack.used = this.stack.args.length;\r\n                                }\r\n                                else if (eAlias && findAlias)\r\n                                    alias += paramChar + '*';\r\n                                else\r\n                                    str += paramChar + '*';\r\n                                state = ParseState.none;\r\n                                break;\r\n                            }\r\n                        case '-':\r\n                            if (arg.length === 0) {\r\n                                _neg = true;\r\n                                break;\r\n                            }\r\n                            else if (_pos && arg.length == 1) {\r\n                                _neg = true;\r\n                                break;\r\n                            }\r\n                            else\r\n                                _fall = true;\r\n                        case '0':\r\n                        case '1':\r\n                        case '2':\r\n                        case '3':\r\n                        case '4':\r\n                        case '5':\r\n                        case '6':\r\n                        case '7':\r\n                        case '8':\r\n                        case '9':\r\n                            if (!_fall) {\r\n                                arg += c;\r\n                                break;\r\n                            }\r\n                        case 'x':\r\n                            if (!_fall && arg.length === 0) {\r\n                                _pos = true;\r\n                                break;\r\n                            }\r\n                        default:\r\n                            if (this.stack.args && arg.length > 0) {\r\n                                tmp = parseInt(arg, 10);\r\n                                if (_pos) {\r\n                                    if (_neg && this.stack.args.indices && tmp < this.stack.args.length)\r\n                                        tmp = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\r\n                                    else if (this.stack.args.indices && tmp < this.stack.args.length)\r\n                                        tmp = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\r\n                                    else if (_neg)\r\n                                        tmp = paramChar + 'x-' + tmp;\r\n                                    else\r\n                                        tmp = paramChar + 'x' + tmp;\r\n                                }\r\n                                else {\r\n                                    if (_neg && tmp < this.stack.args.length)\r\n                                        tmp = this.stack.args.slice(arg).join(' ');\r\n                                    else if (tmp < this.stack.args.length)\r\n                                        tmp = this.stack.args[tmp];\r\n                                    else if (_neg)\r\n                                        tmp = paramChar + '-' + tmp;\r\n                                    else\r\n                                        tmp = paramChar + tmp;\r\n                                    if (_neg)\r\n                                        this.stack.used = this.stack.args.length;\r\n                                    else if (arg > this.stack.used)\r\n                                        this.stack.used = parseInt(arg, 10);\r\n                                }\r\n                                if (eAlias && findAlias)\r\n                                    alias += tmp;\r\n                                else\r\n                                    str += tmp;\r\n                                idx--;\r\n                            }\r\n                            else {\r\n                                if (arg.length === 0 && this.loops.length > 0) {\r\n                                    tmp = c.charCodeAt(0) - 105;\r\n                                    if (tmp >= 0 && tmp < 18 && tmp < this.loops.length) {\r\n                                        if (eAlias && findAlias)\r\n                                            alias += this.loops[tmp];\r\n                                        else\r\n                                            str += this.loops[tmp];\r\n                                        state = ParseState.none;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                                if (eAlias && findAlias) {\r\n                                    alias += paramChar;\r\n                                    if (_neg)\r\n                                        alias += '-';\r\n                                    if (_pos)\r\n                                        alias += 'x';\r\n                                }\r\n                                else {\r\n                                    str += paramChar;\r\n                                    if (_neg)\r\n                                        str += '-';\r\n                                    if (_pos)\r\n                                        str += 'x';\r\n                                }\r\n                                idx = idx - arg.length - 1;\r\n                            }\r\n                            state = ParseState.none;\r\n                            arg = '';\r\n                            break;\r\n                    }\r\n                    break;\r\n                case ParseState.paramsPNamed:\r\n                    if (c.match(/[^a-zA-Z0-9_]/g)) {\r\n                        if (this.stack.named.hasOwnProperty(arg)) {\r\n                            if (eAlias && findAlias)\r\n                                alias += this.stack.named[arg];\r\n                            else\r\n                                str += this.stack.named[arg];\r\n                        }\r\n                        else if (eAlias && findAlias)\r\n                            alias += paramChar + arg;\r\n                        else\r\n                            str += paramChar + arg;\r\n                        idx--;\r\n                        state = ParseState.none;\r\n                        arg = '';\r\n                    }\r\n                    else\r\n                        arg += c;\r\n                    break;\r\n                case ParseState.paramsPBlock:\r\n                    if (c === '}' && nest === 0) {\r\n                        if (arg === 'i')\r\n                            tmp2 = this.loops[0];\r\n                        else if (arg === 'repeatnum')\r\n                            tmp2 = this.repeatnum;\r\n                        else if (this.stack.args && arg === '*') {\r\n                            tmp2 = this.stack.args.slice(1).join(' ');\r\n                            this.stack.used = this.stack.args.length;\r\n                        }\r\n                        else if (this.stack.named && this.stack.named.hasOwnProperty(arg))\r\n                            tmp2 = this.stack.named[arg];\r\n                        else {\r\n                            if (this.stack.args && !isNaN(arg)) {\r\n                                tmp = parseInt(arg, 10);\r\n                                if (tmp < 0) {\r\n                                    if (-tmp >= this.stack.args.length) {\r\n                                        if (eEval)\r\n                                            tmp2 = tmp;\r\n                                        else {\r\n                                            tmp2 = paramChar;\r\n                                            idx = idx - tmp.length - 2;\r\n                                        }\r\n                                    }\r\n                                    else {\r\n                                        tmp2 = this.stack.args.slice(tmp).join(' ');\r\n                                        this.stack.used = this.stack.args.length;\r\n                                    }\r\n                                }\r\n                                else if (tmp < this.stack.args.length) {\r\n                                    tmp2 = this.stack.args[tmp];\r\n                                    if (arg > this.stack.used)\r\n                                        this.stack.used = tmp;\r\n                                }\r\n                                else if (eEval)\r\n                                    tmp2 = tmp;\r\n                                else {\r\n                                    tmp2 = paramChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                            else if (this.stack.args && this.stack.args.indices && arg.match(/^x[-|+]?\\d+$/)) {\r\n                                tmp = parseInt(arg.substring(1), 10);\r\n                                if (tmp < 0) {\r\n                                    if (-tmp >= this.stack.args.length) {\r\n                                        tmp2 = paramChar;\r\n                                        idx = idx - tmp.length - 2;\r\n                                    }\r\n                                    else\r\n                                        tmp2 = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\r\n                                }\r\n                                else if (tmp < this.stack.args.length)\r\n                                    tmp2 = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\r\n                                else {\r\n                                    tmp2 = paramChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                            else {\r\n                                tmp = this.parseVariable(arg);\r\n                                if (tmp != null)\r\n                                    tmp2 = tmp;\r\n                                else if (eEval) {\r\n                                    tmp2 = this.evaluate(this.parseInline(arg));\r\n                                    if (iEval && typeof tmp2 === 'undefined')\r\n                                        tmp2 = null;\r\n                                    else\r\n                                        tmp2 = '' + tmp2;\r\n                                }\r\n                                else {\r\n                                    tmp2 = paramChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (tmp2 != null && eAlias && findAlias)\r\n                            alias += tmp2;\r\n                        else if (tmp2 != null)\r\n                            str += tmp2;\r\n                        state = 0;\r\n                        arg = '';\r\n                    }\r\n                    else if (c === '{') {\r\n                        nest++;\r\n                        arg += c;\r\n                    }\r\n                    else if (c === '}') {\r\n                        nest--;\r\n                        arg += c;\r\n                    }\r\n                    else\r\n                        arg += c;\r\n                    break;\r\n                /*\r\n                case ParseState.paramsPEscape:\r\n                    if (c === '{')\r\n                        tmp2 = paramChar+'{';\r\n                    else if (c === escChar)\r\n                        tmp2 = paramChar + escChar;\r\n                    else {\r\n                        tmp2 = paramChar + escChar;\r\n                        idx--;\r\n                    }\r\n                    if (eAlias && findAlias)\r\n                        alias += tmp2;\r\n                    else\r\n                        str += tmp2;\r\n                    state = ParseState.none;\r\n                    break;\r\n                */\r\n                case ParseState.paramsN:\r\n                    if (c === '{')\r\n                        state = ParseState.paramsNBlock;\r\n                    /*\r\n                    else if (eEscape && c === escChar)\r\n                        state = ParseState.paramsNEscape;\r\n                    */\r\n                    else if (c.match(/[^a-zA-Z_$]/g)) {\r\n                        state = ParseState.none;\r\n                        idx--;\r\n                        if (eAlias && findAlias)\r\n                            alias += nParamChar;\r\n                        else\r\n                            str += nParamChar;\r\n                    }\r\n                    else {\r\n                        arg = c;\r\n                        state = ParseState.paramsNNamed;\r\n                    }\r\n                    break;\r\n                case ParseState.paramsNNamed:\r\n                    if (c.match(/[^a-zA-Z0-9_]/g)) {\r\n                        if (this.stack.named && this.stack.named.hasOwnProperty(arg)) {\r\n                            if (eAlias && findAlias)\r\n                                alias += this.stack.named[arg];\r\n                            else\r\n                                str += this.stack.named[arg];\r\n                        }\r\n                        else if (this.client.variables.hasOwnProperty(arg)) {\r\n                            if (eAlias && findAlias)\r\n                                alias += this.client.variables[arg];\r\n                            else\r\n                                str += this.client.variables[arg];\r\n                        }\r\n                        else if (eAlias && findAlias)\r\n                            alias += nParamChar + arg;\r\n                        else\r\n                            str += nParamChar + arg;\r\n                        idx--;\r\n                        state = ParseState.none;\r\n                        arg = '';\r\n                    }\r\n                    else\r\n                        arg += c;\r\n                    break;\r\n                /*\r\n                                case ParseState.paramsNEscape:\r\n                                    if (c === '{')\r\n                                        tmp2 = `\\{`;\r\n                                    else if (c === escChar) \r\n                                        tmp2 = escChar;\r\n                                    else {\r\n                                        tmp2 = nParamChar + escChar;\r\n                                        idx--;\r\n                                    }\r\n                                    if (eAlias && findAlias)\r\n                                        alias += tmp2;\r\n                                    else\r\n                                        str += tmp2;\r\n                                    state = ParseState.none;\r\n                                    break;\r\n                                    */\r\n                case ParseState.paramsNBlock:\r\n                    if (c === '}' && nest === 0) {\r\n                        tmp2 = null;\r\n                        if (arg === 'i')\r\n                            tmp2 = this.loops[0];\r\n                        else if (arg === 'repeatnum')\r\n                            tmp2 = this.repeatnum;\r\n                        else if (this.stack.args && arg === '*') {\r\n                            tmp2 = this.stack.args.slice(1).join(' ');\r\n                            this.stack.used = this.stack.args.length;\r\n                        }\r\n                        else if (this.stack.named && this.stack.named.hasOwnProperty(arg))\r\n                            tmp2 = this.stack.named[arg];\r\n                        else {\r\n                            if (this.stack.args && !isNaN(arg)) {\r\n                                tmp = parseInt(arg, 10);\r\n                                if (tmp < 0) {\r\n                                    if (-tmp >= this.stack.args.length) {\r\n                                        if (eEval)\r\n                                            tmp2 = tmp;\r\n                                        else {\r\n                                            tmp2 = nParamChar;\r\n                                            idx = idx - arg.length - 2;\r\n                                        }\r\n                                    }\r\n                                    else {\r\n                                        tmp2 = this.stack.args.slice(tmp).join(' ');\r\n                                        this.stack.used = this.stack.args.length;\r\n                                    }\r\n                                }\r\n                                else if (tmp < this.stack.args.length) {\r\n                                    tmp2 = this.stack.args[tmp];\r\n                                    if (tmp > this.stack.used)\r\n                                        this.stack.used = tmp;\r\n                                }\r\n                                else if (eEval)\r\n                                    tmp2 = tmp;\r\n                                else {\r\n                                    tmp2 = nParamChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                            else if (this.stack.args && this.stack.args.indices && arg.match(/^x[-|+]?\\d+$/)) {\r\n                                tmp = parseInt(arg.substring(1), 10);\r\n                                if (tmp < 0) {\r\n                                    if (-tmp >= this.stack.args.length) {\r\n                                        tmp2 = nParamChar;\r\n                                        idx = idx - arg.length - 2;\r\n                                    }\r\n                                    else\r\n                                        tmp2 = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\r\n                                }\r\n                                else if (tmp < this.stack.args.length)\r\n                                    tmp2 = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\r\n                                else {\r\n                                    tmp2 = nParamChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                            else {\r\n                                c = this.parseVariable(arg);\r\n                                if (c != null)\r\n                                    tmp2 = c;\r\n                                else if (eEval) {\r\n                                    tmp2 = this.evaluate(this.parseInline(arg));\r\n                                    if (iEval && typeof tmp2 === 'undefined')\r\n                                        tmp2 = null;\r\n                                    else\r\n                                        tmp2 = '' + tmp2;\r\n                                }\r\n                                else {\r\n                                    tmp2 = nParamChar;\r\n                                    idx = idx - arg.length - 2;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (tmp2 != null && eAlias && findAlias)\r\n                            alias += tmp2;\r\n                        else if (tmp2 != null)\r\n                            str += tmp2;\r\n                        state = ParseState.none;\r\n                        arg = '';\r\n                    }\r\n                    else if (c === '{') {\r\n                        nest++;\r\n                        arg += c;\r\n                    }\r\n                    else if (c === '}') {\r\n                        nest--;\r\n                        arg += c;\r\n                    }\r\n                    else\r\n                        arg += c;\r\n                    break;\r\n                case ParseState.escape:\r\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\r\n                        tmp2 = c;\r\n                    else if (iComments && c == iCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if (bComments && c == bCommentsStr[0])\r\n                        tmp2 = c;\r\n                    else if ('\"\\'{'.indexOf(c) !== -1)\r\n                        tmp2 = c;\r\n                    else\r\n                        tmp2 = escChar + c;\r\n                    if (eAlias && findAlias)\r\n                        alias += tmp2;\r\n                    else\r\n                        str += tmp2;\r\n                    state = ParseState.none;\r\n                    break;\r\n                case ParseState.verbatim:\r\n                    if (c === '\\n') {\r\n                        state = ParseState.none;\r\n                        out += str + c;\r\n                        str = '';\r\n                        start = true;\r\n                    }\r\n                    else {\r\n                        str += c;\r\n                        start = false;\r\n                    }\r\n                    break;\r\n                case ParseState.comment:\r\n                    if (iComments && c === iCommentsStr[1])\r\n                        state = ParseState.inlineComment;\r\n                    else if (bComments && c === bCommentsStr[1])\r\n                        state = ParseState.blockComment;\r\n                    else {\r\n                        state = ParseState.none;\r\n                        if (eAlias && findAlias)\r\n                            alias += iCommentsStr[0];\r\n                        else\r\n                            str += iCommentsStr[0];\r\n                        idx--;\r\n                    }\r\n                    break;\r\n                case ParseState.inlineCommentStart:\r\n                    if (c === iCommentsStr[1])\r\n                        state = ParseState.inlineComment;\r\n                    else {\r\n                        state = ParseState.none;\r\n                        if (eAlias && findAlias)\r\n                            alias += iCommentsStr[0];\r\n                        else\r\n                            str += iCommentsStr[0];\r\n                        idx--;\r\n                    }\r\n                    break;\r\n                case ParseState.blockCommentStart:\r\n                    if (bComments && c === bCommentsStr[1])\r\n                        state = ParseState.blockCommentEnd;\r\n                    else {\r\n                        state = ParseState.none;\r\n                        if (eAlias && findAlias)\r\n                            alias += bCommentsStr[0];\r\n                        else\r\n                            str += bCommentsStr[0];\r\n                        idx--;\r\n                    }\r\n                    break;\r\n                case ParseState.inlineComment:\r\n                    if (c === '\\n') {\r\n                        state = ParseState.none;\r\n                        if (!start)\r\n                            idx--;\r\n                        else {\r\n                            alias = '';\r\n                            //new line so need to check for aliases again\r\n                            findAlias = true;\r\n                            start = true;\r\n                        }\r\n                    }\r\n                    break;\r\n                case ParseState.blockComment:\r\n                    if (bCommentsStr.length === 1) {\r\n                        if (c === bCommentsStr[0])\r\n                            state = ParseState.none;\r\n                    }\r\n                    else if (c === bCommentsStr[1])\r\n                        state = ParseState.blockCommentEnd;\r\n                    break;\r\n                case ParseState.blockCommentEnd:\r\n                    if (c === bCommentsStr[0])\r\n                        state = ParseState.none;\r\n                    else\r\n                        state = ParseState.blockComment;\r\n                    break;\r\n                default:\r\n                    if ((iComments || bComments) && c === iCommentsStr[0] && c === bCommentsStr[0]) {\r\n                        if (iComments && iCommentsStr.length === 1)\r\n                            state = ParseState.inlineComment;\r\n                        else if (bComments && bCommentsStr.length === 1)\r\n                            state = ParseState.blockComment;\r\n                        else\r\n                            state = ParseState.comment;\r\n                        continue;\r\n                    }\r\n                    else if (iComments && c === iCommentsStr[0]) {\r\n                        if (iCommentsStr.length === 1)\r\n                            state = ParseState.inlineComment;\r\n                        else\r\n                            state = ParseState.inlineCommentStart;\r\n                        continue;\r\n                    }\r\n                    else if (bComments && c === bCommentsStr[0]) {\r\n                        if (bCommentsStr.length === 1)\r\n                            state = ParseState.blockComment;\r\n                        else\r\n                            state = ParseState.blockCommentStart;\r\n                        continue;\r\n                    }\r\n                    else if (eEscape && c === escChar) {\r\n                        state = ParseState.escape;\r\n                        start = false;\r\n                        continue;\r\n                    }\r\n                    else if (eParam && c === paramChar) {\r\n                        state = ParseState.paramsP;\r\n                        _neg = false;\r\n                        _pos = false;\r\n                        _fall = false;\r\n                        arg = '';\r\n                        start = false;\r\n                    }\r\n                    else if (eNParam && c === nParamChar) {\r\n                        state = ParseState.paramsN;\r\n                        _neg = false;\r\n                        _pos = false;\r\n                        _fall = false;\r\n                        arg = '';\r\n                        start = false;\r\n                    }\r\n                    else if (!noFunctions && eCmd && start && c === cmdChar) {\r\n                        state = ParseState.function;\r\n                        start = false;\r\n                        if (alias.length) {\r\n                            sTrim = alias;\r\n                            alias = '';\r\n                        }\r\n                        else {\r\n                            sTrim = str || '';\r\n                            str = '';\r\n                        }\r\n                    }\r\n                    else if (eVerbatim && start && c === verbatimChar) {\r\n                        state = ParseState.verbatim;\r\n                        start = false;\r\n                    }\r\n                    else if (ePaths && start && c === spChar) {\r\n                        state = ParseState.path;\r\n                        start = false;\r\n                    }\r\n                    else if (c === '\"' && pd) {\r\n                        if (eAlias && findAlias)\r\n                            alias += c;\r\n                        else\r\n                            str += c;\r\n                        state = ParseState.doubleQuoted;\r\n                        start = false;\r\n                    }\r\n                    else if (c === '\\'' && ps) {\r\n                        if (eAlias && findAlias)\r\n                            alias += c;\r\n                        else\r\n                            str += c;\r\n                        state = ParseState.singleQuoted;\r\n                        start = false;\r\n                    }\r\n                    //\\f\\r\\t\\v\\u0020\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff\r\n                    else if (start && bTrim && (c === ' ' || c === '\\t' || c === '\\f' || c === '\\r' || c === '\\v' || c === '\\u0020' || c === '\\u00a0' || c === '\\u1680' || c === '\\u2000-' || c === '\\u200a' || c === '\\u2028' || c === '\\u2029' || c === '\\u202f' || c === '\\u205f' || c === '\\u3000' || c === '\\ufeff')) {\r\n                        if (eAlias && findAlias)\r\n                            alias += c;\r\n                        else\r\n                            str += c;\r\n                    }\r\n                    //if looking for an alias and a space check\r\n                    else if (eAlias && findAlias && c === ' ') {\r\n                        AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\r\n                        //are aliases enabled and does it match an alias?\r\n                        if (AliasesCached.length > 0) {\r\n                            //move to alias parsing\r\n                            state = ParseState.aliasArguments;\r\n                            //init args\r\n                            args.length = 0;\r\n                            arg = '';\r\n                            args.push(bTrim ? alias.trimStart() : alias);\r\n                        }\r\n                        else //else not an alias so normal space\r\n                        {\r\n                            str += alias + ' ';\r\n                            alias = '';\r\n                            AliasesCached = null;\r\n                        }\r\n                        //no longer look for an alias\r\n                        findAlias = false;\r\n                        start = false;\r\n                    }\r\n                    else if (c === '\\n' || (stacking && c === stackingChar)) {\r\n                        if (eAlias && findAlias && alias.length > 0) {\r\n                            AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\r\n                            //are aliases enabled and does it match an alias?\r\n                            if (AliasesCached.length > 0) {\r\n                                args.push(bTrim ? alias.trimStart() : alias);\r\n                                //move to alias parsing\r\n                                al = AliasesCached.length;\r\n                                for (a = 0; a < al; a++) {\r\n                                    str = this.ExecuteAlias(AliasesCached[a], args);\r\n                                    if (typeof str === 'number') {\r\n                                        if (str >= 0)\r\n                                            this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                                        if (out.length === 0) return null;\r\n                                        return out;\r\n                                    }\r\n                                    if (str !== null) out += str;\r\n                                    if (!a.multi) break;\r\n                                    if (this.stack.continue || this.stack.break) {\r\n                                        if (out.length === 0) return null;\r\n                                        return out;\r\n                                    }\r\n                                }\r\n                                str = '';\r\n                                //init args\r\n                                args.length = 0;\r\n                                arg = '';\r\n                            }\r\n                            else //else not an alias so normal space\r\n                            {\r\n                                str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\r\n                                if (typeof str === 'number') {\r\n                                    if (str >= 0)\r\n                                        this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                                    if (out.length === 0) return null;\r\n                                    return out;\r\n                                }\r\n                                if (str !== null) out += str + '\\n';\r\n                                str = '';\r\n                                AliasesCached = null;\r\n                            }\r\n                            //no longer look for an alias\r\n                        }\r\n                        else {\r\n                            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, str, str, false, true);\r\n                            if (typeof str === 'number') {\r\n                                if (str >= 0)\r\n                                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                                if (out.length === 0) return null;\r\n                                return out;\r\n                            }\r\n                            if (str !== null) out += str + '\\n';\r\n                            str = '';\r\n                        }\r\n                        if (this.stack.continue || this.stack.break) {\r\n                            if (out.length === 0) return null;\r\n                            return out;\r\n                        }\r\n                        alias = '';\r\n                        //new line so need to check for aliases again\r\n                        findAlias = true;\r\n                        start = true;\r\n                    }\r\n                    else if (eAlias && findAlias) {\r\n                        alias += c;\r\n                        start = false;\r\n                    }\r\n                    else {\r\n                        str += c;\r\n                        start = false;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        if (state === ParseState.escape)\r\n            str += escChar;\r\n        else if (state === ParseState.paramsNNamed && arg.length > 0) {\r\n            if (this.stack.named && this.stack.named[arg])\r\n                str += this.stack.named[arg];\r\n            else if (this.client.variables.hasOwnProperty(arg))\r\n                str += this.client.variables[arg];\r\n            else {\r\n                arg = this.parseInline(arg);\r\n                str += nParamChar;\r\n                if (arg != null) str += arg;\r\n            }\r\n        }\r\n        else if (state === ParseState.paramsP && arg.length > 0) {\r\n            if (this.stack.args) {\r\n                arg = parseInt(arg, 10);\r\n                if (_pos && this.stack.args.indices && arg < this.stack.args.length)\r\n                    str += this.stack.args.indices[arg] ? (this.stack.args.indices[arg][0] + ' ' + this.stack.args.indices[arg][1]) : '0 0';\r\n                else {\r\n                    if (_neg && arg < this.stack.args.length)\r\n                        str += this.stack.args.slice(arg).join(' ');\r\n                    else if (arg < this.stack.args.length)\r\n                        str += this.stack.args[arg];\r\n                    if (_neg)\r\n                        this.stack.used = this.stack.args.length;\r\n                    else if (arg > this.stack.used)\r\n                        this.stack.used = arg;\r\n                }\r\n            }\r\n            else {\r\n                arg = this.parseInline(arg);\r\n                str += paramChar;\r\n                if (_neg)\r\n                    str += '-';\r\n                if (_pos)\r\n                    str += 'x';\r\n                if (arg != null) str += arg;\r\n            }\r\n        }\r\n        else if (state === ParseState.paramsPBlock) {\r\n            arg = this.parseInline(arg);\r\n            str += paramChar + '{';\r\n            if (arg != null) str += arg;\r\n        }\r\n        else if (state === ParseState.paramsN && arg.length > 0) {\r\n            if (this.stack.named) {\r\n                if (this.stack.named.hasOwnProperty(arg)) {\r\n                    str += this.stack.named[arg];\r\n                }\r\n                else {\r\n                    arg = this.parseInline(arg);\r\n                    str += nParamChar;\r\n                    if (arg != null) str += arg;\r\n                }\r\n            }\r\n            else {\r\n                arg = this.parseInline(arg);\r\n                str += nParamChar;\r\n                if (arg != null) str += arg;\r\n            }\r\n        }\r\n        else if (state === ParseState.paramsNBlock) {\r\n            arg = this.parseInline(arg);\r\n            str += `${nParamChar}{`;\r\n            if (arg != null) str += arg;\r\n        }\r\n        else if (state === ParseState.path) {\r\n            str = this.ProcessPath(str);\r\n            if (str !== null) out += str;\r\n            str = '';\r\n        }\r\n        else if (state === ParseState.comment) {\r\n            str += iCommentsStr[0];\r\n            idx--;\r\n        }\r\n        else if (state === ParseState.inlineCommentStart) {\r\n            str += iCommentsStr[0];\r\n            idx--;\r\n        }\r\n        else if (state === ParseState.blockCommentStart) {\r\n            str += bCommentsStr[0];\r\n            idx--;\r\n        }\r\n\r\n        if (!noFunctions && state === ParseState.function) {\r\n            str = this.executeScript(cmdChar + str);\r\n            if (typeof str === 'number') {\r\n                if (str >= 0)\r\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n            if (str !== null) {\r\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\r\n                    let r = false;\r\n                    if (str.endsWith('\\n')) {\r\n                        str = str.substring(0, str.length - 1);\r\n                        r = true;\r\n                    }\r\n                    if (!str.endsWith(' '))\r\n                        str += ' ';\r\n                    if (this.stack.used < 1)\r\n                        str += this.stack.args.slice(1).join(' ');\r\n                    else\r\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\r\n                    this.stack.used = this.stack.args.length;\r\n                    if (r) str += '\\n';\r\n                }\r\n                out += sTrim + str;\r\n            }\r\n            else if (out.length === 0) return null;\r\n            if (this.stack.continue || this.stack.break) {\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n        }\r\n        else if (state === ParseState.verbatim) {\r\n            if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\r\n                let r = false;\r\n                if (str.endsWith('\\n')) {\r\n                    str = str.substring(0, str.length - 1);\r\n                    r = true;\r\n                }\r\n                if (!str.endsWith(' '))\r\n                    str += ' ';\r\n                if (this.stack.used < 1)\r\n                    str += this.stack.args.slice(1).join(' ');\r\n                else\r\n                    str += this.stack.args.slice(this.stack.used + 1).join(' ');\r\n                this.stack.used = this.stack.args.length;\r\n                if (r) str += '\\n';\r\n            }\r\n            out += str;\r\n        }\r\n        else if (alias.length > 0 && eAlias && findAlias) {\r\n            if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\r\n                let r = false;\r\n                if (str.endsWith('\\n')) {\r\n                    str = str.substring(0, str.length - 1);\r\n                    r = true;\r\n                }\r\n                if (!str.endsWith(' '))\r\n                    str += ' ';\r\n                if (this.stack.used < 1)\r\n                    str += this.stack.args.slice(1).join(' ');\r\n                else\r\n                    str += this.stack.args.slice(this.stack.used + 1).join(' ');\r\n                this.stack.used = this.stack.args.length;\r\n                if (r) str += '\\n';\r\n            }\r\n            if (str.length > 0)\r\n                alias += str;\r\n            AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\r\n            //are aliases enabled and does it match an alias?\r\n            if (AliasesCached.length > 0) {\r\n                //move to alias parsing\r\n                args.push(bTrim ? alias.trimStart() : alias);\r\n                al = AliasesCached.length;\r\n                for (a = 0; a < al; a++) {\r\n                    str = this.ExecuteAlias(AliasesCached[a], args);\r\n                    if (typeof str === 'number') {\r\n                        if (str >= 0)\r\n                            this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                        if (out.length === 0) return null;\r\n                        return out;\r\n                    }\r\n                    if (str !== null) out += str;\r\n                    else if (out.length === 0) return null;\r\n                    if (this.stack.continue || this.stack.break) {\r\n                        return out;\r\n                    }\r\n                    if (!a.multi) break;\r\n                }\r\n            }\r\n            else //else not an alias so normal space\r\n            {\r\n                str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\r\n                if (typeof str === 'number') {\r\n                    if (str >= 0)\r\n                        this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                    if (out.length === 0) return null;\r\n                    return out;\r\n                }\r\n                if (str !== null) out += str;\r\n                else if (out.length === 0) return null;\r\n                if (this.stack.continue || this.stack.break) {\r\n                    return out;\r\n                }\r\n            }\r\n            AliasesCached = null;\r\n        }\r\n        else if (alias.length > 0) {\r\n            if (str.length > 0)\r\n                alias += str;\r\n            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\r\n            if (typeof str === 'number') {\r\n                if (str >= 0)\r\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n            if (str !== null) {\r\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\r\n                    let r = false;\r\n                    if (str.endsWith('\\n')) {\r\n                        str = str.substring(0, str.length - 1);\r\n                        r = true;\r\n                    }\r\n                    if (!str.endsWith(' '))\r\n                        str += ' ';\r\n                    if (this.stack.used < 1)\r\n                        str += this.stack.args.slice(1).join(' ');\r\n                    else\r\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\r\n                    this.stack.used = this.stack.args.length;\r\n                    if (r) str += '\\n';\r\n                }\r\n                out += str;\r\n            }\r\n            else if (out.length === 0) return null;\r\n            if (this.stack.continue || this.stack.break) {\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n        }\r\n        else if (str.length > 0) {\r\n            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, str, str, false, true);\r\n            if (typeof str === 'number') {\r\n                if (str >= 0)\r\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n            if (str !== null) {\r\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\r\n                    let r = false;\r\n                    if (str.endsWith('\\n')) {\r\n                        str = str.substring(0, str.length - 1);\r\n                        r = true;\r\n                    }\r\n                    if (!str.endsWith(' '))\r\n                        str += ' ';\r\n                    if (this.stack.used < 1)\r\n                        str += this.stack.args.slice(1).join(' ');\r\n                    else\r\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\r\n                    if (r) str += '\\n';\r\n                }\r\n                out += str;\r\n            }\r\n            else if (out.length === 0) return null;\r\n            if (this.stack.continue || this.stack.break) {\r\n                if (out.length === 0) return null;\r\n                return out;\r\n            }\r\n        }\r\n\r\n        args.length = 0;\r\n        args = null;\r\n        arg = null;\r\n        alias = null;\r\n        return out;\r\n    }\r\n\r\n\r\n    public parseVariable(text) {\r\n        let c;\r\n        switch (text) {\r\n            case 'esc':\r\n                return '\\x1b';\r\n            case 'cr':\r\n                return '\\n';\r\n            case 'lf':\r\n                return '\\r';\r\n            case 'crlf':\r\n                return '\\r\\n';\r\n            case 'copied':\r\n                return window.$copied;\r\n            case 'copied.lower':\r\n                return window.$copied.toLowerCase();\r\n            case 'copied.upper':\r\n                return window.$copied.toUpperCase();\r\n            case 'copied.proper':\r\n                return ProperCase(window.$copied);\r\n            case 'i':\r\n                return this.loops[0];\r\n            case 'repeatnum':\r\n                return this.vStack['$repeatnum'] || this.repeatnum;\r\n            case 'character':\r\n                return window.$character;\r\n            case 'character.lower':\r\n                return window.$character.toLowerCase();\r\n            case 'character.upper':\r\n                return window.$character.toUpperCase();\r\n            case 'character.proper':\r\n                return ProperCase(window.$character);\r\n            case 'selected':\r\n            case 'selectedurl':\r\n            case 'selectedline':\r\n            case 'selectedword':\r\n            case 'selurl':\r\n            case 'selline':\r\n            case 'selword':\r\n            case 'action':\r\n            case 'trigger':\r\n                return this.vStack['$' + text] || window['$' + text] || '';\r\n            case 'selected.lower':\r\n            case 'selectedurl.lower':\r\n            case 'selectedline.lower':\r\n            case 'selectedword.lower':\r\n            case 'selurl.lower':\r\n            case 'selline.lower':\r\n            case 'selword.lower':\r\n                return (this.vStack['$' + text.substr(0, text.length - 6)] || window['$' + text.substr(0, text.length - 6)] || '').toLowerCase();\r\n            case 'selected.upper':\r\n            case 'selectedurl.upper':\r\n            case 'selectedline.upper':\r\n            case 'selectedword.upper':\r\n            case 'selurl.upper':\r\n            case 'selline.upper':\r\n            case 'selword.upper':\r\n                return (this.vStack['$' + text.substr(0, text.length - 6)] || window['$' + text.substr(0, text.length - 6)] || '').toUpperCase();\r\n            case 'selected.proper':\r\n            case 'selectedurl.proper':\r\n            case 'selectedline.proper':\r\n            case 'selectedword.proper':\r\n            case 'selurl.proper':\r\n            case 'selline.proper':\r\n            case 'selword.proper':\r\n                return ProperCase(this.vStack['$' + text.substr(0, text.length - 7)] || window['$' + text.substr(0, text.length - 7)]);\r\n            case 'random':\r\n                return mathjs().randomInt(0, 100);\r\n        }\r\n        if (WindowVariables.indexOf(text) !== -1)\r\n            return this.vStack['$' + text] || window['$' + text] || '';\r\n        if (this.loops.length && text.length === 1) {\r\n            let i = text.charCodeAt(0) - 105;\r\n            if (i >= 0 && i < 18 && i < this.loops.length)\r\n                return this.loops[i];\r\n        }\r\n        const re = new RegExp('^([a-zA-Z]+)\\\\((.*)\\\\)$', 'g');\r\n        let res = re.exec(text);\r\n        if (!res || !res.length) {\r\n            const data: FunctionEvent = { raw: text, name: text, args: [], handled: false, return: null };\r\n            this.client.emit('variable', data);\r\n            if (data.handled)\r\n                return data.return;\r\n            return null;\r\n        }\r\n        let sides;\r\n        let mod;\r\n        let args;\r\n        let min;\r\n        let max;\r\n        let escape = this.client.getOption('allowEscape') ? this.client.getOption('escapeChar') : '';\r\n        switch (res[1]) {\r\n            case 'time':\r\n                if (!moment) return new Date().toISOString();\r\n                if (res[2] && res[2].length > 0)\r\n                    return moment().format(this.stripQuotes(this.parseInline(res[2])));\r\n                return moment().format();\r\n            case 'clip':\r\n                if (res[2] && res[2].length > 0) {\r\n                    (<any>this.client).writeClipboard(this.stripQuotes(this.parseInline(res[2])));\r\n                    return null;\r\n                }\r\n                return (<any>this.client).readClipboard();\r\n            case 'lower':\r\n                return this.stripQuotes(this.parseInline(res[2]).toLowerCase());\r\n            case 'upper':\r\n                return this.stripQuotes(this.parseInline(res[2]).toUpperCase());\r\n            case 'proper':\r\n                return ProperCase(this.stripQuotes(this.parseInline(res[2])));\r\n            case 'eval':\r\n                args = this.evaluate(this.parseInline(res[2]));\r\n                if (this.client.getOption('ignoreEvalUndefined') && typeof args === 'undefined')\r\n                    return null;\r\n                return '' + args;\r\n            case 'dice':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid dice');\r\n                if (args.length === 1) {\r\n                    res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(args[0]);\r\n                    if (!res || res.length < 3) return null;\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = parseInt(args[0]);\r\n                    sides = args[1].trim();\r\n                    if (args.length > 2)\r\n                        mod = args[2].trim();\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dice');\r\n\r\n                if (sides === 'F' || sides === 'f')\r\n                    sides = 'F';\r\n                else if (sides !== '%')\r\n                    sides = parseInt(sides);\r\n\r\n                let sum = 0;\r\n                for (let i = 0; i < c; i++) {\r\n                    if (sides === 'F' || sides === 'f')\r\n                        sum += fudgeDice();\r\n                    else if (sides === '%')\r\n                        sum += ~~(Math.random() * 100.0) + 1.0;\r\n                    else\r\n                        sum += ~~(Math.random() * sides) + 1;\r\n                }\r\n                if (sides === '%')\r\n                    sum /= 100.0;\r\n                if (mod)\r\n                    return this.evaluate(sum + mod);\r\n                return '' + sum;\r\n            case 'diceavg':\r\n                //The average of any XdY is X*(Y+1)/2.\r\n                //(min + max) / 2 * a + m\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid dice for diceavg');\r\n                if (args.length === 1) {\r\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\r\n                    if (!res || res.length < 3) return null;\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = parseInt(args[0]);\r\n                    sides = args[1].trim();\r\n                    if (args.length > 2)\r\n                        mod = args[2].trim();\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for diceavg');\r\n                min = 1;\r\n                if (sides === 'F' || sides === 'f') {\r\n                    min = -1;\r\n                    max = 1;\r\n                }\r\n                else if (sides === '%') {\r\n                    min = 0;\r\n                    max = 1;\r\n                }\r\n                else\r\n                    max = parseInt(sides);\r\n\r\n                if (mod)\r\n                    return this.evaluate(((min + max) / 2 * c) + mod);\r\n                return '' + ((min + max) / 2 * c);\r\n            case 'dicemin':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid dice for dicemin');\r\n                if (args.length === 1) {\r\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\r\n                    if (!res || res.length < 3) return null;\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = parseInt(args[0]);\r\n                    sides = args[1].trim();\r\n                    if (args.length > 2)\r\n                        mod = args[2];\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dicemin');\r\n                min = 1;\r\n                if (sides === 'F' || sides === 'f')\r\n                    min = -1;\r\n                else if (sides === '%')\r\n                    min = 0;\r\n\r\n                if (mod)\r\n                    return this.evaluate((min * c) + mod);\r\n                return '' + (min * c);\r\n            case 'dicemax':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid dice for dicemax');\r\n                if (args.length === 1) {\r\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\r\n                    if (!res || res.length < 3) return null;\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = parseInt(args[0]);\r\n                    sides = args[1].trim();\r\n                    if (args.length > 2)\r\n                        mod = args[2].trim();\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for dicemax');\r\n\r\n                if (sides === 'F' || sides === 'f')\r\n                    max = 1;\r\n                else if (sides === '%')\r\n                    max = 1;\r\n                else\r\n                    max = parseInt(sides);\r\n                if (mod)\r\n                    return this.evaluate((max * c) + mod);\r\n                return '' + (max * c);\r\n            case 'zdicedev':\r\n            case 'dicedev':\r\n                const fun = res[1];\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid dice for ' + fun);\r\n                if (args.length === 1) {\r\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\r\n                    if (!res || res.length < 3) return null;\r\n                    c = parseInt(res[1]);\r\n                    sides = res[2];\r\n                    if (res.length > 3)\r\n                        mod = res[3];\r\n                }\r\n                else if (args.length < 4) {\r\n                    c = parseInt(args[0]);\r\n                    sides = args[1].trim();\r\n                    if (args.length > 2)\r\n                        mod = args[2].trim();\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for ' + fun);\r\n\r\n                if (sides === 'F' || sides === 'f')\r\n                    max = 6;\r\n                else if (sides === '%')\r\n                    max = 1;\r\n                else\r\n                    max = parseInt(sides);\r\n\r\n                //zmud formula seems to be 0 index based\r\n                if (fun === 'zdicedev')\r\n                    max--;\r\n                if (mod)\r\n                    return this.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod);\r\n                return '' + Math.sqrt(((max * max) - 1) / 12 * c);\r\n            case 'color':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for color');\r\n                else if (args.length === 1) {\r\n                    if (args[0] === 'bold')\r\n                        return '370';\r\n                    c = getAnsiColorCode(args[0]);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid fore color');\r\n                    return c.toString();\r\n                }\r\n                else if (args.length === 2) {\r\n                    if (args[0] === 'bold')\r\n                        c = 370;\r\n                    else {\r\n                        c = getAnsiColorCode(args[0]);\r\n                        if (c === -1)\r\n                            throw new Error('Invalid fore color');\r\n                        if (args[1] === 'bold')\r\n                            return (c * 10).toString();\r\n                    }\r\n                    sides = c.toString();\r\n                    c = getAnsiColorCode(args[1], true);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid back color');\r\n                    return sides + ',' + c.toString();\r\n                }\r\n                else if (args.length === 3) {\r\n                    if (args[0] === 'bold') {\r\n                        args.shift();\r\n                        args.push('bold');\r\n                    }\r\n                    if (args[2] !== 'bold')\r\n                        throw new Error('Only bold is supported as third argument for color');\r\n                    c = getAnsiColorCode(args[0]);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid fore color');\r\n                    sides = (c * 10).toString();\r\n                    c = getAnsiColorCode(args[1], true);\r\n                    if (c === -1)\r\n                        throw new Error('Invalid back color');\r\n                    return sides + ',' + c.toString();\r\n                }\r\n                throw new Error('Too many arguments');\r\n            case 'zcolor':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for zcolor');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for zcolor');\r\n                return getColorCode(parseInt(args[0], 10));\r\n            case 'ansi':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for ansi');\r\n                c = args.length;\r\n                mod = [];\r\n                min = {};\r\n                for (sides = 0; sides < c; sides++) {\r\n                    if (args[sides].trim() === 'current')\r\n                        mod.push(args[sides].trim());\r\n                    else {\r\n                        max = getAnsiCode(args[sides].trim());\r\n                        if (max === -1)\r\n                            throw new Error('Invalid color or style for ansi');\r\n                        //style\r\n                        if (max >= 0 && max < 30)\r\n                            min[max] = 1;\r\n                        //color\r\n                        else\r\n                            mod.push(args[sides]);\r\n                    }\r\n                }\r\n                // fore,back\r\n                if (mod.length > 2)\r\n                    throw new Error('Too many colors for ansi');\r\n                if (mod.length > 1) {\r\n                    if (mod[1] === 'current')\r\n                        mod[1] = '';\r\n                    else\r\n                        mod[1] = getAnsiCode(mod[1], true);\r\n                }\r\n                if (mod.length > 0) {\r\n                    if (min[1] && mod[0] === 'white')\r\n                        mod[0] = '';\r\n                    else if (mod[0] === 'current')\r\n                        mod[0] = '';\r\n                    else\r\n                        mod[0] = getAnsiCode(mod[0]);\r\n                }\r\n\r\n                min = [...Object.keys(min), ...mod]\r\n                if (!min.length)\r\n                    throw new Error('Invalid colors or styles for ansi');\r\n                //remove any current flags\r\n                min = min.filter(f => f !== '');\r\n                return `\\x1b[${min.join(';')}m`;\r\n            case 'random':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0) throw new Error('Invalid random');\r\n                if (args.length === 1)\r\n                    return mathjs().randomInt(0, parseInt(args[0], 10) + 1);\r\n                else if (args.length === 2)\r\n                    return mathjs().randomInt(parseInt(args[0], 10), parseInt(args[1], 10) + 1);\r\n                else\r\n                    throw new Error('Too many arguments for random');\r\n            case 'case': //case(index,n1,n2...)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for case');\r\n                c = this.evaluate(this.parseInline(args[0]));\r\n                if (typeof c !== 'number')\r\n                    return '';\r\n                if (c > 0 && c < args.length)\r\n                    return this.stripQuotes(args[c]);\r\n                return '';\r\n            case 'switch': //switch(exp,value...)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for switch');\r\n                if (args.length % 2 === 1)\r\n                    throw new Error('All expressions must have a value for switch');\r\n                sides = args.length;\r\n                for (c = 0; c < sides; c += 2) {\r\n                    if (this.evaluate(args[c]))\r\n                        return this.stripQuotes(args[c + 1]);\r\n                }\r\n                return '';\r\n            case 'if': //if(exp,true,false)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length < 3)\r\n                    throw new Error('Missing arguments for if');\r\n                if (args.length !== 3)\r\n                    throw new Error('Too many arguments for if');\r\n                if (this.evaluate(args[0]))\r\n                    return this.stripQuotes(args[1].trim());\r\n                return this.stripQuotes(args[2].trim());\r\n            case 'ascii': //ascii(string)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for ascii');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for ascii');\r\n                if (args[0].trim().length === 0)\r\n                    throw new Error('Invalid argument, empty string for ascii');\r\n                return args[0].trim().charCodeAt(0);\r\n            case 'char': //char(number)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for char');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for char');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for char');\r\n                return String.fromCharCode(c);\r\n            case 'begins'://(string1,string2)` return true if string 1 starts with string 2\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for begins');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for begins');\r\n                return this.stripQuotes(args[0]).startsWith(this.stripQuotes(args[1]));\r\n            case 'ends'://(string1, string2)` returns true if string 1 ends with string 2\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for ends');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for ends');\r\n                return this.stripQuotes(args[0]).endsWith(this.stripQuotes(args[1]));\r\n            case 'len'://(string)` returns the length of string\r\n                return this.stripQuotes(this.parseInline(res[2])).length;\r\n            case 'stripansi':\r\n                const ansiRegex = new RegExp('[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)|(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-nq-uy=><~]))', 'g')\r\n                return this.stripQuotes(this.parseInline(res[2])).replace(ansiRegex, '');\r\n            case 'pos'://(pattern,string)` returns the position pattern in string on 1 index scale, 0 if not found\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for pos');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for pos');\r\n                return this.stripQuotes(args[1]).indexOf(this.stripQuotes(args[0])) + 1;\r\n            case 'ipos'://(pattern,string)` returns the position pattern in string on 1 index scale, 0 if not found\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for ipos');\r\n                else if (args.length > 2)\r\n                    throw new Error('Too many arguments for ipos');\r\n                return this.stripQuotes(args[1]).toLowerCase().indexOf(this.stripQuotes(args[0]).toLowerCase()) + 1;\r\n            case 'regex'://(string,regex,var1,...,varN)\r\n                args = this.splitByQuotes(res[2], ',');\r\n                if (args.length < 2)\r\n                    throw new Error('Missing arguments for regex');\r\n                c = new RegExp(this.stripQuotes(args[1]), 'gd');\r\n                c = c.exec(this.stripQuotes(this.parseInline(args[0])));\r\n                args.shift();\r\n                args.shift();\r\n                if (c == null || c.length === 0)\r\n                    return 0;\r\n                if (args.length) {\r\n                    for (sides = 1; sides < c.length; sides++) {\r\n                        if (!args.length)\r\n                            break;\r\n                        this.client.variables[this.stripQuotes(this.parseInline(args[0]))] = c[sides];\r\n                        args.shift();\r\n                    }\r\n                    if (args.length)\r\n                        this.client.variables[this.stripQuotes(this.parseInline(args[0]))] = c[0].length;\r\n                }\r\n                if (!c.indices[0])\r\n                    return 1;\r\n                return c.indices[0][0] + 1;\r\n            case 'trim':\r\n                return this.stripQuotes(this.parseInline(res[2])).trim();\r\n            case 'trimleft':\r\n                return this.stripQuotes(this.parseInline(res[2])).trimLeft();\r\n            case 'trimright':\r\n                return this.stripQuotes(this.parseInline(res[2])).trimRight();\r\n            case 'bitand'://bitand(v1,v2)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitand');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitand');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitand');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bitand');\r\n                return c & sides;\r\n            case 'bitnot'://bitnot(v1)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitnot');\r\n                else if (args.length !== 1)\r\n                    throw new Error('Too many arguments for bitnot');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitnot');\r\n                return ~c;\r\n            case 'bitor': //bitor(v1,v2)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitor');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitor');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitor');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bitor');\r\n                return c | sides;\r\n            case 'bitset':\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitset');\r\n                else if (args.length > 3)\r\n                    throw new Error('Too many arguments for bitset');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitset');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bitset');\r\n                sides--;\r\n                mod = 1;\r\n                if (args.length === 3) {\r\n                    mod = parseInt(args[2], 10);\r\n                    if (isNaN(mod))\r\n                        throw new Error('Invalid argument \\'' + args[2] + '\\' must be a number for bitset');\r\n                }\r\n                return (c & (~(1 << sides))) | ((mod ? 1 : 0) << sides);\r\n            case 'bitshift'://bitshift(value,num)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitshift');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitshift');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitshift');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bitshift');\r\n                if (sides < 0)\r\n                    return c >> -sides;\r\n                return c << sides\r\n            case 'bittest'://bittest(i,bitnum)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bittest');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bittest');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bittest');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bittest');\r\n                sides--;\r\n                return ((c >> sides) % 2 != 0) ? 1 : 0;\r\n            case 'bitxor'://bitxor(v1,v2)\r\n                args = this.parseInline(res[2]).split(',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for bitxor');\r\n                else if (args.length !== 2)\r\n                    throw new Error('Too many arguments for bitxor');\r\n                c = parseInt(args[0], 10);\r\n                if (isNaN(c))\r\n                    throw new Error('Invalid argument \\'' + args[0] + '\\' must be a number for bitxor');\r\n                sides = parseInt(args[1], 10);\r\n                if (isNaN(sides))\r\n                    throw new Error('Invalid argument \\'' + args[1] + '\\' must be a number for bitxor');\r\n                return c ^ sides;\r\n            case 'number': //number(s)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for number');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for number');\r\n                args[0] = this.stripQuotes(args[0], true);\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\r\n                    return parseInt(args[0], 10);\r\n                else if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return parseFloat(args[0]);\r\n                else if (args[0] === \"true\")\r\n                    return 1;\r\n                else if (args[0] === \"false\")\r\n                    return 0;\r\n                return 0;\r\n            case 'isfloat'://isfloat(value)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for isfloat');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for isfloat');\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return 1;\r\n                return 0;\r\n            case 'isnumber': //isnumber(s)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for isnumber');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for isnumber');\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return 1;\r\n                return 0;\r\n            case 'string'://string(value)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for string');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for string');\r\n                return `\"${this.stripQuotes(args[0]), true}\"`;\r\n            case 'float'://float(value)\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for float');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for float');\r\n                args[0] = this.stripQuotes(args[0], true);\r\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\r\n                    return parseFloat(args[0]);\r\n                else if (args[0] === \"true\")\r\n                    return 1.0;\r\n                else if (args[0] === \"false\")\r\n                    return 0.0;\r\n                return 0;\r\n            case 'isdefined':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for isdefined');\r\n                else if (args.length > 1)\r\n                    throw new Error('Too many arguments for isdefined');\r\n                args[0] = this.stripQuotes(args[0], true);\r\n                if (this.client.variables.hasOwnProperty(args[0]))\r\n                    return 1;\r\n                return 0;\r\n            case 'defined':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for defined');\r\n                else if (args.length === 1) {\r\n                    args[0] = this.stripQuotes(args[0], true);\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0) return 0;\r\n                    //have to check each profile as the client only caches enabled items for speed\r\n                    for (; k < kl; k++) {\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                        sides = sides.find(i => {\r\n                            return i.pattern === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                        sides = sides.find(i => {\r\n                            return i.pattern === args[0] || i.name === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].macros);\r\n                        sides = sides.find(i => {\r\n                            return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\r\n                        });\r\n                        if (sides) return 1;\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                        sides = sides.find(i => {\r\n                            return i.caption === args[0] || i.name === args[0]\r\n                        });\r\n                        if (sides) return 1;\r\n                    }\r\n                    return this.client.variables.hasOwnProperty(args[0]);\r\n                }\r\n                else if (args.length === 2) {\r\n                    args[0] = this.stripQuotes(args[0], true);\r\n                    args[1] = this.stripQuotes(args[1], true).toLowerCase();\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0) return 0;\r\n                    //have to check each profile as the client only caches enabled items for speed\r\n                    for (; k < kl; k++) {\r\n                        switch (args[1]) {\r\n                            case 'alias':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                                sides = sides.find(i => {\r\n                                    return i.pattern === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'event':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                sides = sides.find(i => {\r\n                                    return i.type === TriggerType.Event && (i.pattern === args[0] || i.name === args[0]);\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'trigger':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                                sides = sides.find(i => {\r\n                                    return i.pattern === args[0] || i.name === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'macro':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].macros);\r\n                                sides = sides.find(i => {\r\n                                    return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            case 'button':\r\n                                sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].aliases);\r\n                                sides = sides.find(i => {\r\n                                    return i.caption === args[0] || i.name === args[0]\r\n                                });\r\n                                if (sides) return 1;\r\n                                return 0;\r\n                            //case 'variable':\r\n                            //case 'path':\r\n                            //case 'status':\r\n                            //case 'class':\r\n                            //case 'menu':                        \r\n                            //case 'module':\r\n                        }\r\n                    }\r\n                    if (args[1] === 'variable')\r\n                        return this.client.variables.hasOwnProperty(args[0]);\r\n                }\r\n                else\r\n                    throw new Error('Too many arguments for defined');\r\n                return 0;\r\n            case 'escape':\r\n                args = this.stripQuotes(this.parseInline(res[2]));\r\n                if (this.client.getOption('allowEscape')) {\r\n                    c = escape;\r\n                    if (escape === '\\\\')\r\n                        c += escape;\r\n                    if (this.client.getOption('parseDoubleQuotes'))\r\n                        c += '\"';\r\n                    if (this.client.getOption('parseSingleQuotes'))\r\n                        c += '\\'';\r\n                    if (this.client.getOption('commandStacking'))\r\n                        c += this.client.getOption('commandStackingChar');\r\n                    if (this.client.getOption('enableSpeedpaths'))\r\n                        c += this.client.getOption('speedpathsChar');\r\n                    if (this.client.getOption('enableCommands'))\r\n                        c += this.client.getOption('commandChar');\r\n                    if (this.client.getOption('enableVerbatim'))\r\n                        c += this.client.getOption('verbatimChar');\r\n                    if (this.client.getOption('enableDoubleParameterEscaping'))\r\n                        c += this.client.getOption('parametersChar');\r\n                    if (this.client.getOption('enableNParameters'))\r\n                        c += this.client.getOption('nParametersChar');\r\n                    return args.replace(new RegExp(`[${c}]`, 'g'), escape + '$&');\r\n                }\r\n                return args.replace(/[\\\\\"']/g, '\\$&');\r\n            case 'unescape':\r\n                args = this.stripQuotes(this.parseInline(res[2]));\r\n                if (this.client.getOption('allowEscape')) {\r\n                    c = escape;\r\n                    if (escape === '\\\\')\r\n                        c += escape;\r\n                    if (this.client.getOption('parseDoubleQuotes'))\r\n                        c += '\"';\r\n                    if (this.client.getOption('parseSingleQuotes'))\r\n                        c += '\\'';\r\n                    if (this.client.getOption('commandStacking'))\r\n                        c += this.client.getOption('commandStackingChar');\r\n                    if (this.client.getOption('enableSpeedpaths'))\r\n                        c += this.client.getOption('speedpathsChar');\r\n                    if (this.client.getOption('enableCommands'))\r\n                        c += this.client.getOption('commandChar');\r\n                    if (this.client.getOption('enableVerbatim'))\r\n                        c += this.client.getOption('verbatimChar');\r\n                    if (this.client.getOption('enableDoubleParameterEscaping'))\r\n                        c += this.client.getOption('parametersChar');\r\n                    if (this.client.getOption('enableNParameters'))\r\n                        c += this.client.getOption('nParametersChar');\r\n                    if (escape === '\\\\')\r\n                        return args.replace(new RegExp(`\\\\\\\\[${c}]`, 'g'), (m) => m.substr(1));\r\n                    return args.replace(new RegExp(`${escape}[${c}]`, 'g'), (m) => m.substr(1));\r\n                }\r\n                return args.replace(/\\\\[\\\\\"']/g, (m) => m.substr(1));\r\n            case 'alarm':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for alarm');\r\n                if (args.length > 3)\r\n                    throw new Error('Too many arguments for alarm');\r\n                args[0] = this.stripQuotes(args[0]);\r\n                sides = this.client.alarms;\r\n                max = sides.length;\r\n                if (max === 0)\r\n                    throw new Error('No alarms set.');\r\n                c = 0;\r\n                if (args.length === 1) {\r\n                    for (; c < max; c++) {\r\n                        //only main state counts here\r\n                        if (sides[c].type !== TriggerType.Alarm) continue;\r\n                        if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\r\n                            if (sides[c].suspended)\r\n                                return 0;\r\n                            return this.client.getRemainingAlarmTime(c);\r\n                        }\r\n                    }\r\n                }\r\n                else if (args.length === 2) {\r\n                    mod = parseInt(args[1], 10);\r\n                    if (isNaN(mod)) {\r\n                        args[1] = this.stripQuotes(args[1].trim());\r\n                        for (; c < max; c++) {\r\n                            //only main state counts here\r\n                            if (sides[c].type !== TriggerType.Alarm) continue;\r\n                            if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\r\n                                if (sides[c].profile.name.toUpperCase() !== args[1].toUpperCase())\r\n                                    continue;\r\n                                if (sides[c].suspended)\r\n                                    return 0;\r\n                                return this.client.getRemainingAlarmTime(c);\r\n                            }\r\n                        }\r\n                        throw Error('Alarm not found in profile: ' + args[1] + '.');\r\n                    }\r\n                    else {\r\n                        for (; c < max; c++) {\r\n                            //only main state counts here\r\n                            if (sides[c].type !== TriggerType.Alarm) continue;\r\n                            if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\r\n                                if (!sides[c].suspended)\r\n                                    this.client.setAlarmTempTime(c, mod);\r\n                                return mod;\r\n                            }\r\n                        }\r\n                        throw Error('Alarm not found.');\r\n                    }\r\n                }\r\n                else if (args.length === 3) {\r\n                    mod = parseInt(args[1], 10);\r\n                    if (isNaN(mod))\r\n                        throw new Error(\"Invalid time for alarm\");\r\n                    args[2] = this.stripQuotes(args[2].trim());\r\n                    for (; c < max; c++) {\r\n                        //only main state counts here\r\n                        if (sides[c].type !== TriggerType.Alarm) continue;\r\n                        if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\r\n                            if (sides[c].profile.name.toUpperCase() !== args[2].toUpperCase())\r\n                                continue;\r\n                            if (!sides[c].suspended)\r\n                                this.client.setAlarmTempTime(c, mod);\r\n                            return mod;\r\n                        }\r\n                    }\r\n                    throw Error('Could not set time, alarm not found in profile: ' + args[2] + '.');\r\n                }\r\n                return 0;\r\n            case 'state':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    throw new Error('Missing arguments for state');\r\n                if (args.length > 2)\r\n                    throw new Error('Too many arguments for state');\r\n                args[0] = this.stripQuotes(args[0]);\r\n                mod = null;\r\n                if (args.length === 1) {\r\n                    const keys = this.client.profiles.keys;\r\n                    let k = 0;\r\n                    const kl = keys.length;\r\n                    if (kl === 0)\r\n                        return null;\r\n                    if (kl === 1) {\r\n\r\n                        if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                            throw Error('No enabled profiles found!');\r\n                        sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                        sides = sides.find(t => {\r\n                            return t.name === args[0] || t.pattern === args[0];\r\n                        });\r\n                    }\r\n                    else {\r\n                        for (; k < kl; k++) {\r\n                            if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                                continue;\r\n                            sides = SortItemArrayByPriority(this.client.profiles.items[keys[k]].triggers);\r\n                            sides = sides.find(t => {\r\n                                return t.name === args[0] || t.pattern === args[0];\r\n                            });\r\n                            if (sides)\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n                else if (args.length === 2) {\r\n                    args[1] = this.stripQuotes(args[1].trim());\r\n                    if (this.client.profiles.contains(args[1]))\r\n                        mod = this.client.profiles.items[args[1].toLowerCase()];\r\n                    else\r\n                        throw new Error('Profile not found: ' + args[1]);\r\n                    sides = SortItemArrayByPriority(mod.triggers);\r\n                    sides = sides.find(t => {\r\n                        return t.name === args[0] || t.pattern === args[0];\r\n                    });\r\n                }\r\n                if (sides)\r\n                    return sides.triggers && sides.triggers.length ? sides.state : 0;\r\n                throw new Error('Trigger not found');\r\n            case 'isnull':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    return null;\r\n                if (args.length !== 1)\r\n                    throw new Error('Too many arguments for null');\r\n                return this.evaluate(args[0]) === null ? 1 : 0;\r\n            case 'prompt':\r\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n                if (args.length === 0)\r\n                    return window.prompt() || '';\r\n                if (args.length > 3)\r\n                    throw new Error('Too many arguments');\r\n                args = args.map(a => this.stripQuotes(a));\r\n                return window.prompt(...args) || '';\r\n            /*\r\n        case 'fileprompt':\r\n            args = this.splitByQuotes(this.parseInline(res[2]), ',');\r\n            if (args.length > 2)\r\n                throw new Error('Too many arguments');\r\n            args = args.map(a => this.stripQuotes(a));\r\n            let f = [\r\n                { name: 'All files (*.*)', extensions: ['*'] },\r\n            ];\r\n            if (args.length > 0 && args[0].trim().length > 0) {\r\n                f.unshift({\r\n                    name: args[0],\r\n                    extensions: args[0].split(',').map(a => a.trim())\r\n                })\r\n            }\r\n            var files = dialog.showOpenDialogSync({\r\n                filters: f,\r\n                properties: ['openFile', 'promptToCreate'],\r\n                defaultPath: args.length >= 2 ? parseTemplate(args[1]) : ''\r\n            });\r\n            if (files && files.length) return files[0];\r\n            return '';\r\n            */\r\n        }\r\n        const data: FunctionEvent = { raw: text, name: res[1], args: res[2] && res[2].length ? this.parseOutgoing(res[2]).split(',') : [], handled: false, return: null };\r\n        this.client.emit('variable', data);\r\n        if (data.handled)\r\n            return data.return;\r\n        return null;\r\n    }\r\n\r\n    public GetNamedArguments(str: string, args, append?: boolean) {\r\n        if (str === '*')\r\n            return args;\r\n        if (append == null) append = false;\r\n        if (str == null || str.length === 0)\r\n            return append ? args : [];\r\n        const n = str.split(',');\r\n        const nl = n.length;\r\n        const al = args.length;\r\n        //no values to process\r\n        if (nl === 0)\r\n            return append ? args : [];\r\n        let named;\r\n\r\n        if (append)\r\n            named = args.slice();\r\n        else\r\n            named = [];\r\n        for (let s = 0; s < nl; s++) {\r\n            n[s] = $.trim(n[s]);\r\n            if (n[s].length < 1) continue;\r\n            if (n[s].startsWith('$')) n[s] = n[s].substring(1);\r\n            if (!n[s].match(/^[a-zA-Z0-9_][a-zA-Z0-9_]+$/g)) continue;\r\n            if (!isValidIdentifier(n[s])) continue;\r\n            if (named[n[s]]) continue;\r\n            named[n[s]] = (s + 1 < al) ? args[s + 1] : '';\r\n        }\r\n        return named;\r\n    }\r\n\r\n    public ExecuteAlias(alias, args) {\r\n        if (!alias.enabled) return;\r\n        let ret; // = '';\r\n        if (alias.value.length)\r\n            switch (alias.style) {\r\n                case 1:\r\n                    this._stack.push({ loops: [], args: args, named: this.GetNamedArguments(alias.params, args), append: alias.append, used: 0 });\r\n                    ret = this.parseOutgoing(alias.value, null, null, true);\r\n                    this._stack.pop();\r\n                    break;\r\n                case 2:\r\n                    if ((this.client.getOption('echo') & 2) === 2)\r\n                        this.client.echo(alias.value, -7, -8, true, true);\r\n                    const named = this.GetNamedArguments(alias.params, args);\r\n                    if (named)\r\n                        ret = Object.keys(named).map(v => `let ${v} = this.input.stack.named[\"${v}\"];`).join('') + '\\n';\r\n                    else\r\n                        ret = '';\r\n                    /*jslint evil: true */\r\n                    const f = new Function('try { ' + ret + alias.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\r\n                    this._stack.push({ loops: [], args: args, named: named, append: alias.append, used: 0 });\r\n                    try {\r\n                        ret = f.apply(this.client, args);\r\n                    }\r\n                    catch (e) {\r\n                        throw e;\r\n                    }\r\n                    finally {\r\n                        this._stack.pop();\r\n                    }\r\n                    if (typeof ret === 'string')\r\n                        ret = this.parseOutgoing(ret, null, null, true);\r\n                    break;\r\n                default:\r\n                    ret = alias.value;\r\n                    break;\r\n            }\r\n        if (ret == null || ret === undefined)\r\n            return null;\r\n        ret = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, ret, ret, false, true);\r\n        if (ret == null || ret === undefined)\r\n            return null;\r\n        //Convert to string\r\n        if (typeof ret !== 'string')\r\n            ret = ret.toString();\r\n        if (ret.length === 0 && !this.client.getOption('returnNewlineOnEmptyValue'))\r\n            return null;\r\n        if (ret.endsWith('\\n'))\r\n            return ret;\r\n        return ret + '\\n';\r\n    }\r\n\r\n    public ProcessMacros(keycode, alt, ctrl, shift, meta) {\r\n        if (!keycode || (keycode > 9 && keycode < 19)) return false;\r\n        //not loaded yet so cant process so just bail\r\n        if(!this.client.profiles) return false;\r\n        //if(!this.client.getOption('enableMacros')) return false;\r\n        //Possible cache by modifier but  not sure if it it matters as there is a limit of 1 macro per key combo so at most there probably wont be more then 5 to maybe 20 macros per key\r\n        //const macros = this._MacroCache[`${keycode}_${mod}`] || (this._MacroCache[`${keycode}_${mod}`] = FilterArrayByKeyValue(FilterArrayByKeyValue(this.client.macros, 'key', keycode), 'modifiers', mod));\r\n        const macros = this._MacroCache[keycode] || (this._MacroCache[keycode] = FilterArrayByKeyValue(this.client.macros, 'key', keycode));\r\n        let m = 0;\r\n        const ml = macros.length;\r\n        let mod = MacroModifiers.None;\r\n        if (alt)\r\n            mod |= MacroModifiers.Alt;\r\n        if (ctrl)\r\n            mod |= MacroModifiers.Ctrl;\r\n        if (shift)\r\n            mod |= MacroModifiers.Shift;\r\n        if (meta)\r\n            mod |= MacroModifiers.Meta;\r\n        for (; m < ml; m++) {\r\n            if (!macros[m].enabled || mod !== macros[m].modifiers) continue;\r\n            if (this.ExecuteMacro(macros[m]))\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public ExecuteMacro(macro) {\r\n        if (!macro.enabled) return false;\r\n        let ret; // = '';\r\n        if (macro.value.length)\r\n            switch (macro.style) {\r\n                case 1:\r\n                    this._stack.push({ loops: [], args: 0, named: 0, used: 0 });\r\n                    try {\r\n                        ret = this.parseOutgoing(macro.value);\r\n                    }\r\n                    catch (e) {\r\n                        throw e;\r\n                    }\r\n                    finally {\r\n                        this._stack.pop();\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    if ((this.client.getOption('echo') & 2) === 2)\r\n                        this.client.echo(macro.value, -7, -8, true, true);\r\n                    /*jslint evil: true */\r\n                    const f = new Function('try { ' + macro.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\r\n                    this._stack.push({ loops: [], args: 0, named: 0, used: 0 });\r\n                    try {\r\n                        ret = f.apply(this.client);\r\n                    }\r\n                    catch (e) {\r\n                        throw e;\r\n                    }\r\n                    finally {\r\n                        this._stack.pop();\r\n                    }\r\n                    break;\r\n                default:\r\n                    ret = macro.value;\r\n                    break;\r\n            }\r\n        if (ret == null || ret === undefined)\r\n            return true;\r\n        //Convert to string\r\n        if (typeof ret !== 'string')\r\n            ret = ret.toString();\r\n        if (ret.length === 0 && !this.client.getOption('returnNewlineOnEmptyValue'))\r\n            return null;\r\n        if (macro.send) {\r\n            if (!ret.endsWith('\\n'))\r\n                ret += '\\n';\r\n            if (macro.chain && this.client.commandInput.value.endsWith(' ')) {\r\n                this.client.commandInput.value = this.client.commandInput.value + ret;\r\n                this.client.sendCommand(null, null, this.client.getOption('allowCommentsFromCommand'));\r\n            }\r\n            else\r\n                this.client.send(ret, true);\r\n        }\r\n        else if (macro.append)\r\n            this.client.commandInput.value = this.client.commandInput.value + ret;\r\n        return true;\r\n    }\r\n\r\n    public ProcessPath(str, replace?: boolean) {\r\n        if (str.length === 0)\r\n            return '';\r\n        let out: string[] = [];\r\n\r\n        let state = 0;\r\n        let cmd: string = '';\r\n        let num: string = '';\r\n        let idx = 0;\r\n        let c: string;\r\n        let i: number;\r\n        let t;\r\n        let p;\r\n        let n = 0;\r\n        const tl: number = str.length;\r\n\r\n        for (; idx < tl; idx++) {\r\n            c = str.charAt(idx);\r\n            i = str.charCodeAt(idx);\r\n            switch (state) {\r\n                case 1:\r\n                    if (i > 47 && i < 58)\r\n                        num += c;\r\n                    else if (c === '\\\\')\r\n                        state = 2;\r\n                    else {\r\n                        state = 0;\r\n                        cmd = c;\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    if (i > 47 && i < 58)\r\n                        cmd += c;\r\n                    else {\r\n                        cmd += '\\\\';\r\n                        idx--;\r\n                    }\r\n                    state = 0;\r\n                    break;\r\n                case 3:\r\n                    if (n === 0 && c === ')')\r\n                        state = 0;\r\n                    else {\r\n                        if (c === '(')\r\n                            n++;\r\n                        else if (c === ')')\r\n                            n--;\r\n                        cmd += c;\r\n                    }\r\n                    break;\r\n                case 4:\r\n                    if (n === 0 && c === '}')\r\n                        state = 0;\r\n                    else {\r\n                        if (c === '{')\r\n                            n++;\r\n                        else if (c === '}')\r\n                            n--;\r\n                        cmd += c;\r\n                    }\r\n                    break;\r\n                default:\r\n                    if (i > 47 && i < 58) {\r\n                        if (cmd.length > 0) {\r\n                            if (num.length === 0)\r\n                                t = 1;\r\n                            else\r\n                                t = parseInt(num, 10);\r\n                            for (p = 0; p < t; p++)\r\n                                out.push(cmd);\r\n                            cmd = '';\r\n                        }\r\n                        state = 1;\r\n                        num = c;\r\n                    }\r\n                    else if (c === '(') {\r\n                        state = 3;\r\n                        n = 0;\r\n                    }\r\n                    else if (c === '{') {\r\n                        state = 4;\r\n                        n = 0;\r\n                    }\r\n                    else if (c === '\\\\')\r\n                        state = 2;\r\n                    else\r\n                        cmd += c;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        if (cmd.length > 0) {\r\n            if (num.length === 0)\r\n                t = 1;\r\n            else\r\n                t = parseInt(num, 10);\r\n            for (p = 0; p < t; p++)\r\n                out.push(cmd);\r\n        }\r\n        if (replace && this._pathQueue.length) {\r\n            this._pathQueue[0] = {\r\n                id: str,\r\n                current: out,\r\n                previous: []\r\n            };\r\n        }\r\n        else\r\n            this._pathQueue.push({\r\n                id: str,\r\n                current: out,\r\n                previous: []\r\n            });\r\n        this.ExecutePath();\r\n        return null;\r\n    }\r\n\r\n    public ExecutePath() {\r\n        //if already running or no queue bail\r\n        if (this._pathTimeout || !this._pathQueue.length || this._pathPaused) return;\r\n        let delay = this.client.getOption('pathDelay');\r\n        if (delay < 0) delay = 0;\r\n        //being processing query\r\n        this._pathTimeout = setTimeout(() => {\r\n            const pPath = this.client.getOption('parseSpeedpaths');\r\n            const ePath = this.client.getOption('echoSpeedpaths');\r\n            let cnt = this.client.getOption('pathDelayCount');\r\n            if (cnt < 1) cnt = 1;\r\n            const current = this._pathQueue[0];\r\n            /*\r\n            if (!current.previous.length) {\r\n                if (this.client.telnet.echo && this.client.getOption('commandEcho'))\r\n                    this.client.echo(this.client.getOption('speedpathsChar') + current.id);\r\n                else\r\n                    this.client.echo('\\n');\r\n            }\r\n            */\r\n            while (cnt--) {\r\n                let cmd = current.current.shift();\r\n                current.previous.push(cmd);\r\n                if (pPath)\r\n                    this.client.sendBackground(cmd + '\\n', !ePath);\r\n                else\r\n                    this.client.send(cmd + '\\n', !ePath);\r\n                if (!current.current.length) break;\r\n            }\r\n            //if at the end remove\r\n            if (!current.current.length)\r\n                this._pathQueue.shift();\r\n            this._pathTimeout = null;\r\n            //step manually so do not call next block, allows commands to handle steeping instead of auto moving to next one\r\n            if (this._pathQueue.length && this._pathQueue[0].manual)\r\n                return;\r\n            //process next paths\r\n            this.ExecutePath();\r\n        }, delay);\r\n    }\r\n\r\n    public toggleScrollLock() {\r\n        this.scrollLock = !this.scrollLock;\r\n    }\r\n\r\n    /*\r\n    private hasTriggerType(types: TriggerTypes | SubTriggerTypes, type: TriggerType | SubTriggerTypes): boolean {\r\n        if (type === TriggerType.Alarm && (types & TriggerTypes.Alarm) == TriggerTypes.Alarm)\r\n            return true;\r\n        if (type === TriggerType.CommandInputPattern && (types & TriggerTypes.CommandInputPattern) == TriggerTypes.CommandInputPattern)\r\n            return true;\r\n        if (type === TriggerType.CommandInputRegular && (types & TriggerTypes.CommandInputRegular) == TriggerTypes.CommandInputRegular)\r\n            return true;\r\n        if (type === TriggerType.Event && (types & TriggerTypes.Event) == TriggerTypes.Event)\r\n            return true;\r\n        if (type === TriggerType.Pattern && (types & TriggerTypes.Pattern) == TriggerTypes.Pattern)\r\n            return true;\r\n        if (type === TriggerType.Regular && (types & TriggerTypes.Regular) == TriggerTypes.Regular)\r\n            return true;\r\n        if (type === TriggerType.LoopExpression && (types & TriggerTypes.LoopExpression) == TriggerTypes.LoopExpression)\r\n            return true;\r\n        //if (type === TriggerType.Expression && (types & TriggerTypes.Expression) == TriggerTypes.Expression)\r\n        //return true;            \r\n        return false;\r\n    }\r\n    */\r\n\r\n    private isSubTriggerType(type) {\r\n        if ((type & SubTriggerTypes.Skip) == SubTriggerTypes.Skip)\r\n            return true;\r\n        if ((type & SubTriggerTypes.Wait) == SubTriggerTypes.Wait)\r\n            return true;\r\n        if ((type & SubTriggerTypes.LoopPattern) == SubTriggerTypes.LoopPattern)\r\n            return true;\r\n        if ((type & SubTriggerTypes.LoopLines) == SubTriggerTypes.LoopLines)\r\n            return true;\r\n        if ((type & SubTriggerTypes.Duration) == SubTriggerTypes.Duration)\r\n            return true;\r\n        if ((type & SubTriggerTypes.WithinLines) == SubTriggerTypes.WithinLines)\r\n            return true;\r\n        if ((type & SubTriggerTypes.Manual) == SubTriggerTypes.Manual)\r\n            return true;\r\n        if ((type & SubTriggerTypes.ReParse) == SubTriggerTypes.ReParse)\r\n            return true;\r\n        if ((type & SubTriggerTypes.ReParsePattern) == SubTriggerTypes.ReParsePattern)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    private getTriggerType(type: TriggerType | SubTriggerTypes) {\r\n        if (type === TriggerType.Regular)\r\n            return TriggerTypes.Regular;\r\n        if (type === TriggerType.Alarm)\r\n            return TriggerTypes.Alarm;\r\n        return type;\r\n    }\r\n\r\n    public ExecuteTriggers(type: TriggerTypes, line?, raw?, frag?: boolean, ret?: boolean, subtypes?: boolean) {\r\n        if (!this.enableTriggers || line == null) return line;\r\n        if (ret == null) ret = false;\r\n        if (frag == null) frag = false;\r\n        //make sure raw is set\r\n        raw = raw || line;\r\n        this.buildTriggerCache();\r\n        let t = 0;\r\n        let pattern;\r\n        let changed = false;\r\n        let val;\r\n        //scope to get performance\r\n        const triggers = this._TriggerCache;\r\n        const tl = triggers.length;\r\n        const states = this._TriggerStates;\r\n        const rCache = this._TriggerRegExCache;\r\n        let tType;\r\n        for (; t < tl; t++) {\r\n            let trigger = triggers[t];\r\n            const parent = trigger;\r\n            //extra check in case error disabled it and do not want to keep triggering the error\r\n            if (!trigger.enabled) continue;\r\n            //safety check in case a state was deleted\r\n            if (!parent.triggers || !parent.triggers.length || trigger.state > parent.triggers.length)\r\n                parent.state = 0;\r\n            if (trigger.state !== 0 && parent.triggers && parent.triggers.length) {\r\n                //trigger states are 1 based as 0 is parent trigger\r\n                trigger = parent.triggers[trigger.state - 1];\r\n                //skip disabled states\r\n                while (!trigger.enabled && parent.state !== 0) {\r\n                    //advance state\r\n                    parent.state++;\r\n                    //if no more states start over and stop\r\n                    if (parent.state > parent.triggers.length) {\r\n                        parent.state = 0;\r\n                        //reset to first state\r\n                        trigger = parent;\r\n                        //stop checking\r\n                        break;\r\n                    }\r\n                    if (parent.state)\r\n                        trigger = parent.triggers[parent.state - 1];\r\n                    else\r\n                        trigger = parent;\r\n                    changed = true;\r\n                }\r\n                //changed state save\r\n                if (changed) {\r\n                    if (this.client.getOption('saveTriggerStateChanges'))\r\n                        this.client.saveProfiles();\r\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\r\n                }\r\n                //last check to be 100% sure enabled\r\n                if (!trigger.enabled) continue;\r\n            }\r\n            tType = this.getTriggerType(trigger.type);\r\n            if (trigger.type !== undefined && (type & tType) !== tType) {\r\n                if (!subtypes || (subtypes && !this.isSubTriggerType(trigger.type)))\r\n                    continue;\r\n            }\r\n            //manual can only be fired with #set\r\n            if (trigger.type === SubTriggerTypes.Manual) continue;\r\n            if (frag && !trigger.triggerPrompt) continue;\r\n            if (!frag && !trigger.triggerNewline && (trigger.triggerNewline !== undefined))\r\n                continue;\r\n            if (states[t]) {\r\n                if (states[t].type === SubTriggerTypes.Wait) {\r\n                    //time still has not passed\r\n                    if (states[t].time > Date.now())\r\n                        continue;\r\n                    delete states[t];\r\n                }\r\n                else if (states[t].type === SubTriggerTypes.Duration) {\r\n                    //trigger time has paused, delete it and advance\r\n                    if (states[t].time < Date.now()) {\r\n                        delete states[t];\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        //need to reparse as the state is no longer valid and the next state might be\r\n                        if (!states[t])\r\n                            states[t] = { reParse: true };\r\n                        else\r\n                            states[t].reParse = true;\r\n                        t = this.cleanUpTriggerState(t);\r\n                        continue;\r\n                    }\r\n                }\r\n                else if (states[t].type === SubTriggerTypes.Skip) {\r\n                    //skip until that many lines have passed\r\n                    if (states[t].lineCount > 0)\r\n                        continue;\r\n                    delete states[t];\r\n                }\r\n                else if (states[t].type === SubTriggerTypes.LoopLines) {\r\n                    //move on after line count\r\n                    if (states[t].lineCount < 1) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        //reparse as new state may be valid\r\n                        if (!states[t])\r\n                            states[t] = { reParse: true }\r\n                        else\r\n                            states[t].reParse = true;\r\n                        t = this.cleanUpTriggerState(t);\r\n                        continue;\r\n                    }\r\n                }\r\n                else if (states[t].type === SubTriggerTypes.WithinLines) {\r\n                    if (states[t].lineCount < 1) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        //reparse as new state may be valid\r\n                        if (!states[t])\r\n                            states[t] = { reParse: true }\r\n                        else\r\n                            states[t].reParse = true;\r\n                        t = this.cleanUpTriggerState(t);\r\n                        continue;\r\n                    }\r\n                }\r\n                /*\r\n                else if (states[t].type === TriggerType.LoopExpression) {\r\n                    //move on after line count\r\n                    if (states[t].loop != -1 && states[t].lineCount < 1) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        //reparse as new state may be valid\r\n                        if (!states[t])\r\n                            states[t] = { reParse: true }\r\n                        else\r\n                            states[t].reParse = true;\r\n                        t = this.cleanUpTriggerState(t);\r\n                        continue;\r\n                    }\r\n                }\r\n                */\r\n            }\r\n            try {\r\n                if (trigger.type === TriggerType.LoopExpression) {\r\n                    if (this.evaluate(this.parseInline(trigger.pattern))) {\r\n                        if (!states[t]) {\r\n                            const state = this.createTriggerState(trigger, false, parent);\r\n                            if (state)\r\n                                states[t] = state;\r\n                        }\r\n                        else if (states[t].loop !== -1 && states[t].lineCount < 1)\r\n                            continue;\r\n                        this._LastTriggered = (trigger.raw ? raw : line);\r\n                        val = this.ExecuteTrigger(trigger, [this._LastTriggered], ret, t, [this._LastTriggered], 0, parent);\r\n                    }\r\n                    else {\r\n                        //this.updateTriggerState(trigger, t);\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        continue;\r\n                    }\r\n                }\r\n                else if (trigger.verbatim) {\r\n                    if (!trigger.caseSensitive && (trigger.raw ? raw : line).toLowerCase() !== trigger.pattern.toLowerCase()) {\r\n                        //if reparse and if failed advance anyways\r\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\r\n                            this.advanceTrigger(trigger, parent, t);\r\n                            t = this.cleanUpTriggerState(t);\r\n                        }\r\n                        continue;\r\n                    }\r\n                    else if (trigger.caseSensitive && (trigger.raw ? raw : line) !== trigger.pattern) {\r\n                        //if reparse and if failed advance anyways\r\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\r\n                            this.advanceTrigger(trigger, parent, t);\r\n                            t = this.cleanUpTriggerState(t);\r\n                        }\r\n                        continue;\r\n                    }\r\n                    this._LastTriggered = (trigger.raw ? raw : line);\r\n                    val = this.ExecuteTrigger(trigger, [this._LastTriggered], ret, t, [this._LastTriggered], 0, parent);\r\n                }\r\n                else {\r\n                    let re;\r\n                    if (trigger.type === TriggerType.Pattern || trigger.type === TriggerType.CommandInputPattern || trigger.type === SubTriggerTypes.ReParsePattern)\r\n                        pattern = convertPattern(trigger.pattern, this.client);\r\n                    else\r\n                        pattern = trigger.pattern;\r\n                    if (trigger.caseSensitive)\r\n                        re = rCache['g' + pattern] || (rCache['g' + pattern] = new RegExp(pattern, 'gd'));\r\n                    else\r\n                        re = rCache['gi' + pattern] || (rCache['gi' + pattern] = new RegExp(pattern, 'gid'));\r\n                    //reset from last use always\r\n                    re.lastIndex = 0;\r\n                    const res = re.exec(trigger.raw ? raw : line);\r\n                    if (!res || !res.length) {\r\n                        //if reparse and if failed advance anyways\r\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\r\n                            this.advanceTrigger(trigger, parent, t);\r\n                            t = this.cleanUpTriggerState(t);\r\n                        }\r\n                        continue;\r\n                    }\r\n                    let args;\r\n                    this._LastTriggered = trigger.raw ? raw : line;\r\n                    if ((trigger.raw ? raw : line) === res[0] || !this.client.getOption('prependTriggeredLine'))\r\n                        args = res;\r\n                    else {\r\n                        args = [this._LastTriggered, ...res];\r\n                        args.indices = [[0, args[0].length], ...res.indices];\r\n                    }\r\n                    if (res.groups)\r\n                        Object.keys(res.groups).map(v => this.client.variables[v] = res.groups[v]);\r\n                    val = this.ExecuteTrigger(trigger, args, ret, t, [this._LastTriggered, re], res.groups, parent);\r\n                }\r\n                if (states[t] && states[t].reParse) {\r\n                    if (!states[t].type || states[t].type === SubTriggerTypes.ReParse || states[t].type === SubTriggerTypes.ReParsePattern)\r\n                        delete states[t];\r\n                    else\r\n                        delete states[t].reParse;\r\n                    t--;\r\n                }\r\n                else if (ret) return val;\r\n            }\r\n            catch (e) {\r\n                if (this.client.getOption('disableTriggerOnError')) {\r\n                    trigger.enabled = false;\r\n                    setTimeout(() => {\r\n                        this.client.saveProfiles();\r\n                        this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\r\n                    });\r\n                }\r\n                if (this.client.getOption('showScriptErrors'))\r\n                    this.client.error(e);\r\n                else\r\n                    this.client.debug(e);\r\n            }\r\n        }\r\n        return line;\r\n    }\r\n\r\n    public TestTrigger(trigger, parent, t, line?, raw?, frag?: boolean) {\r\n        let val;\r\n        let pattern;\r\n        try {\r\n            if (trigger.verbatim) {\r\n                if (!trigger.caseSensitive && (trigger.raw ? raw : line).toLowerCase() !== trigger.pattern.toLowerCase()) {\r\n                    //if reparse and if failed advance anyways\r\n                    if (!this._TriggerStates[t]) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        t = this.cleanUpTriggerState(t);\r\n                    }\r\n                    return t;\r\n                }\r\n                else if (trigger.caseSensitive && (trigger.raw ? raw : line) !== trigger.pattern) {\r\n                    //if reparse and if failed advance anyways\r\n                    if (!this._TriggerStates[t]) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        t = this.cleanUpTriggerState(t);\r\n                    }\r\n                    return t;\r\n                }\r\n                this._LastTriggered = (trigger.raw ? raw : line);\r\n                val = this.ExecuteTrigger(trigger, [this._LastTriggered], false, t, [this._LastTriggered], 0, parent);\r\n            }\r\n            else {\r\n                let re;\r\n                if (trigger.type === TriggerType.Pattern || trigger.type === TriggerType.CommandInputPattern || trigger.type === SubTriggerTypes.ReParsePattern)\r\n                    pattern = convertPattern(trigger.pattern, this.client);\r\n                else\r\n                    pattern = trigger.pattern;\r\n                if (trigger.caseSensitive)\r\n                    re = this._TriggerRegExCache['g' + pattern] || (this._TriggerRegExCache['g' + pattern] = new RegExp(pattern, 'gd'));\r\n                else\r\n                    re = this._TriggerRegExCache['gi' + pattern] || (this._TriggerRegExCache['gi' + pattern] = new RegExp(pattern, 'gid'));\r\n                //reset from last use always\r\n                re.lastIndex = 0;\r\n                const res = re.exec(trigger.raw ? raw : line);\r\n                if (!res || !res.length) {\r\n                    //if reparse and if failed advance anyways\r\n                    if (!this._TriggerStates[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\r\n                        this.advanceTrigger(trigger, parent, t);\r\n                        t = this.cleanUpTriggerState(t);\r\n                    }\r\n                    return t;\r\n                }\r\n                let args;\r\n                this._LastTriggered = (trigger.raw ? raw : line);\r\n                if ((trigger.raw ? raw : line) === res[0] || !this.client.getOption('prependTriggeredLine'))\r\n                    args = res;\r\n                else {\r\n                    args = [this._LastTriggered, ...res];\r\n                    args.indices = [[0, args[0].length], ...res.indices];\r\n                }\r\n                if (res.groups)\r\n                    Object.keys(res.groups).map(v => this.client.variables[v] = res.groups[v]);\r\n                val = this.ExecuteTrigger(trigger, args, false, t, [this._LastTriggered, re], res.groups, parent);\r\n            }\r\n            t = this.cleanUpTriggerState(t);\r\n        }\r\n        catch (e) {\r\n            if (this.client.getOption('disableTriggerOnError')) {\r\n                trigger.enabled = false;\r\n                setTimeout(() => {\r\n                    this.client.saveProfiles();\r\n                    this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\r\n                });\r\n            }\r\n            if (this.client.getOption('showScriptErrors'))\r\n                this.client.error(e);\r\n            else\r\n                this.client.debug(e);\r\n        }\r\n        return t;\r\n    }\r\n\r\n    public ExecuteTrigger(trigger, args, r: boolean, idx, regex?, named?, parent?: Trigger) {\r\n        if (r == null) r = false;\r\n        if (!trigger.enabled) return '';\r\n        if (this._TriggerStates[idx] && this._TriggerStates[idx].type === SubTriggerTypes.Duration)\r\n            delete this._TriggerStates[idx];\r\n        if (trigger.fired) {\r\n            trigger.fired = false;\r\n            this.advanceTrigger(trigger, parent, idx);\r\n            if (this._TriggerStates[idx])\r\n                this._TriggerStates[idx].reParse = true;\r\n            else\r\n                this._TriggerStates[idx] = { reParse: true };\r\n            return '';\r\n        }\r\n        this._LastTrigger = trigger;\r\n        let ret; // = '';\r\n        //remove temp and advance state before executing value in case it does a trigger on trigger to avoid double triggering\r\n        if (trigger.temp) {\r\n            if (parent.triggers.length) {\r\n                if (parent.state === 0) {\r\n                    //main trigger temp, replace with first state\r\n                    const item = parent.triggers.shift();\r\n                    item.triggers = parent.triggers;\r\n                    item.state = parent.state;\r\n                    item.name = parent.name;\r\n                    item.profile = parent.profile;\r\n                    //if removed temp shift state adjust\r\n                    if (item.state > item.triggers.length)\r\n                        item.state = 0;\r\n                    if (idx >= 0)\r\n                        this._TriggerCache[idx] = item;\r\n                    this.client.saveProfiles();\r\n                    const pIdx = parent.profile.triggers.indexOf(parent);\r\n                    parent.profile.triggers[pIdx] = item;\r\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, pIdx, item);\r\n                }\r\n                else {\r\n                    //remove only temp sub state\r\n                    parent.triggers.splice(parent.state - 1, 1);\r\n                    //if removed temp shift state adjust\r\n                    if (parent.state > parent.triggers.length)\r\n                        parent.state = 0;\r\n                    this.client.saveProfiles();\r\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\r\n                }\r\n            }\r\n            else {\r\n                if (idx >= 0)\r\n                    this._TriggerCache.splice(idx, 1);\r\n                if (this._TriggerStates[idx])\r\n                    this.clearTriggerState(idx);\r\n                this.client.removeTrigger(parent);\r\n            }\r\n        }\r\n        else if (parent.triggers.length)\r\n            this.advanceTrigger(trigger, parent, idx);\r\n        if ((this.client.getOption('echo') & 8) === 8)\r\n            this.client.echo('Trigger fired: ' + trigger.pattern, -7, -8, true, true);\r\n        if (trigger.value.length)\r\n            switch (trigger.style) {\r\n                case 1:\r\n                    this._stack.push({ loops: [], args: args, named: 0, used: 0, regex: regex });\r\n                    try {\r\n                        ret = this.parseOutgoing(trigger.value);\r\n                    }\r\n                    catch (e) {\r\n                        throw e;\r\n                    }\r\n                    finally {\r\n                        this._stack.pop();\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    if ((this.client.getOption('echo') & 2) === 2)\r\n                        this.client.echo(trigger.value, -7, -8, true, true);\r\n                    //do not cache temp triggers\r\n                    if (trigger.temp) {\r\n                        /*jslint evil: true */\r\n                        ret = new Function('try { ' + trigger.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\r\n                        ret = ret.apply(this.client, args);\r\n                    }\r\n                    else {\r\n                        if (!this._TriggerFunctionCache[idx]) {\r\n                            if (named)\r\n                                ret = Object.keys(named).map(v => `let ${v} = this.variables[\"${v}\"];`).join('') + '\\n';\r\n                            else\r\n                                ret = '';\r\n                            /*jslint evil: true */\r\n                            this._TriggerFunctionCache[idx] = new Function('try { ' + ret + trigger.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\r\n                        }\r\n                        this._stack.push({ loops: [], args: args, named: 0, used: 0, regex: regex, indices: args.indices });\r\n                        try {\r\n                            ret = this._TriggerFunctionCache[idx].apply(this.client, args);\r\n                        }\r\n                        catch (e) {\r\n                            throw e;\r\n                        }\r\n                        finally {\r\n                            this._stack.pop();\r\n                        }\r\n                    }\r\n                    if (typeof ret === 'string')\r\n                        ret = this.parseOutgoing(ret);\r\n                    break;\r\n                default:\r\n                    ret = trigger.value;\r\n                    break;\r\n            }\r\n        if (ret == null || ret === undefined)\r\n            return null;\r\n        if (r)\r\n            return ret;\r\n        //Convert to string\r\n        if (typeof ret !== 'string')\r\n            ret = ret.toString();\r\n        if (ret.length === 0 && !this.client.getOption('returnNewlineOnEmptyValue'))\r\n            return null;\r\n        if (!ret.endsWith('\\n'))\r\n            ret += '\\n';\r\n        if (this.client.connected)\r\n            this.client.telnet.sendData(ret);\r\n        if (this.client.telnet.echo && this.client.getOption('commandEcho')) {\r\n            setTimeout(() => {\r\n                this.client.echo(ret);\r\n            }, 1);\r\n        }\r\n    }\r\n\r\n    private advanceTrigger(trigger, parent, idx) {\r\n        if (this._TriggerStates[idx]) {\r\n            if (this._TriggerStates[idx].type === SubTriggerTypes.LoopPattern) {\r\n                this._TriggerStates[idx].loop--;\r\n                //stay on this state until loop is done\r\n                if (this._TriggerStates[idx].loop > 0)\r\n                    return;\r\n                this.clearTriggerState(idx);\r\n            }\r\n            //match within the # of lines so clear state and move on\r\n            else if (this._TriggerStates[idx].type === SubTriggerTypes.LoopLines) {\r\n                //keep matching until loop is over\r\n                if (this._TriggerStates[idx].lineCount > 0)\r\n                    return;\r\n                this.clearTriggerState(idx);\r\n            }\r\n            else if (this._TriggerStates[idx].type === SubTriggerTypes.WithinLines)\r\n                this.clearTriggerState(idx);\r\n            else if (this._TriggerStates[idx].type === TriggerType.LoopExpression) {\r\n                //infinite until expression is false\r\n                if (this._TriggerStates[idx].loop === -1)\r\n                    return;\r\n                //else if uses a line count\r\n                if (this._TriggerStates[idx].lineCount > 0)\r\n                    return;\r\n            }\r\n        }\r\n        parent.state++;\r\n        //1 based\r\n        if (parent.state > parent.triggers.length)\r\n            parent.state = 0;\r\n        //changed state save\r\n        if (this.client.getOption('saveTriggerStateChanges'))\r\n            this.client.saveProfiles();\r\n        this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\r\n        //is new subtype a reparse? if so reparse using current trigger instant\r\n        if (parent.state !== 0) {\r\n            const state = this.createTriggerState(parent.triggers[parent.state - 1]);\r\n            if (state)\r\n                this._TriggerStates[idx] = state;\r\n        }\r\n    }\r\n\r\n    public createTriggerState(trigger, reparse?, parent?) {\r\n        let params;\r\n        let state;\r\n        switch (trigger.type) {\r\n            case SubTriggerTypes.ReParse:\r\n            case SubTriggerTypes.ReParsePattern:\r\n                state = { reParse: true };\r\n                break;\r\n            case SubTriggerTypes.Duration:\r\n            case SubTriggerTypes.Wait:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 0;\r\n                }\r\n                else\r\n                    params = 0;\r\n                state = { time: Date.now() + params };\r\n                break;\r\n            case SubTriggerTypes.WithinLines:\r\n            case SubTriggerTypes.LoopLines:\r\n            case SubTriggerTypes.Skip:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 1;\r\n                }\r\n                else\r\n                    params = 1;\r\n                state = { lineCount: params + 1 };\r\n                break;\r\n            /*          \r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 1;\r\n                }\r\n                else\r\n                    params = 1;\r\n                state = { remoteCount: params + 1 };\r\n                break;\r\n            */\r\n            case SubTriggerTypes.LoopPattern:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 0;\r\n                }\r\n                else\r\n                    params = 0;\r\n                state = { loop: params };\r\n                break;\r\n            case TriggerType.LoopExpression:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 1;\r\n                    if (parent === trigger)\r\n                        state = { lineCount: params - 1 };\r\n                    else\r\n                        state = { lineCount: params };\r\n                }\r\n                else\r\n                    state = { loop: -1 };\r\n                break;\r\n        }\r\n        if (state)\r\n            state.type = trigger.type;\r\n        if (!state && reparse)\r\n            return { reParse: true };\r\n        else if (reparse)\r\n            state.reparse = true;\r\n        return state;\r\n    }\r\n\r\n    public updateTriggerState(trigger, idx) {\r\n        if (!this._TriggerStates[idx]) return;\r\n        let params;\r\n        switch (this._TriggerStates[idx].type) {\r\n            case SubTriggerTypes.Wait:\r\n            case SubTriggerTypes.Duration:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 0;\r\n                }\r\n                else\r\n                    params = 0;\r\n                this._TriggerStates[idx].time = Date.now() + params;\r\n                break;\r\n            case SubTriggerTypes.WithinLines:\r\n            case SubTriggerTypes.Skip:\r\n            case SubTriggerTypes.LoopLines:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 0;\r\n                }\r\n                else\r\n                    params = 0;\r\n                this._TriggerStates[idx].lineCount = params;\r\n                break;\r\n            /*\r\n                            params = trigger.params;\r\n                            if (params && params.length) {\r\n                                params = parseInt(params, 10);\r\n                                if (isNaN(params))\r\n                                    params = 0;\r\n                            }\r\n                            else\r\n                                params = 0;\r\n                            this._TriggerStates[idx].remoteCount = params;\r\n                            break;\r\n            */\r\n            case SubTriggerTypes.LoopPattern:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 0;\r\n                }\r\n                else\r\n                    params = 0;\r\n                this._TriggerStates[idx].loop = params;\r\n                break;\r\n            case TriggerType.LoopExpression:\r\n                params = trigger.params;\r\n                if (params && params.length) {\r\n                    params = parseInt(params, 10);\r\n                    if (isNaN(params))\r\n                        params = 1;\r\n                    this._TriggerStates[idx].lineCount = params + 1;\r\n                }\r\n                else\r\n                    this._TriggerStates[idx].loop = -1;\r\n                break;\r\n        }\r\n    }\r\n\r\n    public getTriggerState(idx) {\r\n        return this._TriggerStates[idx];\r\n    }\r\n\r\n    public cleanUpTriggerState(idx) {\r\n        if (this._TriggerStates[idx] && this._TriggerStates[idx].reParse) {\r\n            //remove only if reparse type of no type defined, else remove just the rePrase flag\r\n            if (!this._TriggerStates[idx].type || this._TriggerStates[idx].type === SubTriggerTypes.ReParse || this._TriggerStates[idx].type === SubTriggerTypes.ReParsePattern)\r\n                delete this._TriggerStates[idx];\r\n            else\r\n                delete this._TriggerStates[idx].reParse;\r\n            if (idx < 0)\r\n                idx++;\r\n            else\r\n                idx--;\r\n        }\r\n        return idx;\r\n    }\r\n\r\n    public clearTriggerState(idx) {\r\n        delete this._TriggerStates[idx];\r\n    }\r\n\r\n    public setTriggerState(idx, data) {\r\n        this._TriggerStates[idx] = data;\r\n    }\r\n\r\n    public clearTriggerCache() { this._TriggerCache = null; this._TriggerStates = {}; this._TriggerFunctionCache = {}; this._TriggerRegExCache = {}; }\r\n\r\n    public resetTriggerState(idx, oldState, oldFire?) {\r\n        if (idx === -1) return;\r\n        if (idx < 0 || idx >= this._TriggerCache.length) return;\r\n        let trigger = this._TriggerCache[idx];\r\n        let oTrigger;\r\n        const parent = trigger;\r\n        let reParse = false;\r\n        if (parent.state !== 0)\r\n            trigger = parent.triggers[parent.state - 1];\r\n        if (oldState === 0)\r\n            oTrigger = parent;\r\n        else\r\n            oTrigger = parent.triggers[oldState - 1];\r\n        if (oldState === parent.state) {\r\n            if (this._TriggerStates[idx]) {\r\n                if (!trigger.fired)\r\n                    this.updateTriggerState(trigger, idx);\r\n                else\r\n                    this.clearTriggerState(idx);\r\n            }\r\n            else {\r\n                if (!trigger.fired)\r\n                    this.updateTriggerState(trigger, idx);\r\n            }\r\n        }\r\n        else {\r\n            if (this._TriggerStates[idx]) {\r\n                if (!this._TriggerStates[idx].type || (this._TriggerStates[idx].type !== SubTriggerTypes.ReParsePattern && this._TriggerStates[idx].type !== SubTriggerTypes.ReParse))\r\n                    reParse = this._TriggerStates[idx].reParse;\r\n            }\r\n            this.clearTriggerState(idx);\r\n            if (!trigger.fired) {\r\n                const state = this.createTriggerState(trigger, reParse);\r\n                if (state)\r\n                    this._TriggerStates[idx] = state;\r\n            }\r\n            else\r\n                this._TriggerStates[idx] = { reParse: true };\r\n        }\r\n    }\r\n\r\n    public buildTriggerCache() {\r\n        if (this._TriggerCache == null) {\r\n            this._TriggerCache = this.client.triggers.filter((a) => {\r\n                if (a && a.enabled && a.triggers.length) {\r\n                    if (a.type !== TriggerType.Alarm) return true;\r\n                    //loop sub states if one is not alarm cache it for future\r\n                    for (let s = 0, sl = a.triggers.length; s < sl; s++)\r\n                        if (a.triggers[s].enabled && a.triggers[s].type !== TriggerType.Alarm)\r\n                            return true;\r\n                    return false;\r\n                }\r\n                return a.enabled && a.type !== TriggerType.Alarm;\r\n            });\r\n        }\r\n    }\r\n\r\n    public clearCaches() {\r\n        this._TriggerCache = null;\r\n        this._TriggerStates = {};\r\n        this._TriggerFunctionCache = {};\r\n        this._TriggerRegExCache = {};\r\n        this._gamepadCaches = null;\r\n        this._lastSuspend = -1;\r\n        this._MacroCache = {};\r\n    }\r\n\r\n    public triggerEvent(event: string, args?) {\r\n        if (!this.enableTriggers) return;\r\n        this.buildTriggerCache();\r\n        let t = 0;\r\n        if (!args)\r\n            args = [event];\r\n        else if (!Array.isArray(args))\r\n            args = [event, args];\r\n        else\r\n            args.unshift(event);\r\n        const tl = this._TriggerCache.length;\r\n        for (; t < tl; t++) {\r\n            let trigger = this._TriggerCache[t];\r\n            const parent = trigger;\r\n            let changed = false;\r\n            //in case it got disabled by something\r\n            if (!trigger.enabled) continue;\r\n            //safety check in case a state was deleted\r\n            if (trigger.state > parent.triggers.length)\r\n                trigger.state = 0;\r\n            if (trigger.state !== 0 && parent.triggers && parent.triggers.length) {\r\n                //trigger states are 1 based as 0 is parent trigger\r\n                trigger = parent.triggers[trigger.state - 1];\r\n                //skip disabled states\r\n                while (!trigger.enabled && parent.state !== 0) {\r\n                    //advance state\r\n                    parent.state++;\r\n                    //if no more states start over and stop\r\n                    if (parent.state > parent.triggers.length) {\r\n                        parent.state = 0;\r\n                        //reset to first state\r\n                        trigger = parent;\r\n                        //stop checking\r\n                        break;\r\n                    }\r\n                    if (parent.state)\r\n                        trigger = parent.triggers[parent.state - 1];\r\n                    else\r\n                        trigger = parent;\r\n                    changed = true;\r\n                }\r\n                //changed state save\r\n                if (changed) {\r\n                    if (this.client.getOption('saveTriggerStateChanges'))\r\n                        this.client.saveProfiles();\r\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\r\n                }\r\n                //last check to be 100% sure enabled\r\n                if (!trigger.enabled) continue;\r\n            }\r\n            if (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern) {\r\n                const val = this.adjustLastLine(this.client.display.lines.length, true);\r\n                const line = this.client.display.lines[val];\r\n                t = this.TestTrigger(trigger, parent, t, line, this.client.display.lines[val].raw || line, val === this.client.display.lines.length - 1);\r\n                continue;\r\n            }\r\n            if (trigger.type !== TriggerType.Event) continue;\r\n            if (trigger.caseSensitive && event !== trigger.pattern) continue;\r\n            if (!trigger.caseSensitive && event.toLowerCase() !== trigger.pattern.toLowerCase()) continue;\r\n            this._LastTriggered = event;\r\n            this.ExecuteTrigger(trigger, args, false, t, 0, 0, parent);\r\n            t = this.cleanUpTriggerState(t);\r\n        }\r\n    }\r\n\r\n    public executeWait(text, delay: number, eAlias?: boolean, stacking?: boolean, append?: boolean, noFunctions?: boolean, noComments?: boolean) {\r\n        if (!text || text.length === 0) return;\r\n        const s = { loops: this.loops.splice(0), args: 0, named: 0, used: this.stack.used, append: this.stack.append };\r\n        if (this.stack.args)\r\n            s.args = this.stack.args.slice();\r\n        if (this.stack.named)\r\n            s.named = this.stack.named.slice();\r\n\r\n        if (delay < 0)\r\n            delay = 0;\r\n        setTimeout(() => {\r\n            this._stack.push(s);\r\n            let ret = this.parseOutgoing(text, eAlias, stacking, append, noFunctions, noComments);\r\n            this._stack.pop();\r\n            if (ret == null || typeof ret === 'undefined' || ret.length === 0) return;\r\n            if (!ret.endsWith('\\n'))\r\n                ret = ret + '\\n';\r\n            this.client.send(ret, true);\r\n        }, delay);\r\n    }\r\n\r\n    public buildScript(str: string) {\r\n        if (!str) return '';\r\n        let lines;\r\n        /*\r\n        if (this.client.getOption('commandStacking') && this.client.getOption('commandStackingChar') && this.client.getOption('commandStackingChar').length > 0)\r\n            lines = str.split(new RegExp('\\n|' + this.client.getOption('commandStackingChar')));\r\n        else\r\n            lines = str.split('\\n');\r\n        */\r\n        if (this.client.getOption('commandStacking') && this.client.getOption('commandStackingChar') && this.client.getOption('commandStackingChar').length > 0)\r\n            lines = str.splitQuote('\\n' + this.client.getOption('commandStackingChar'));\r\n        else\r\n            lines = str.splitQuote('\\n');\r\n        let l = 0;\r\n        const ll = lines.length;\r\n        const code = [];\r\n        const b = [];\r\n        const cmdChar = this.client.getOption('commandChar');\r\n        for (; l < ll; l++) {\r\n            if (lines[l].trim().startsWith(cmdChar + 'wait ')) {\r\n                code.push('setTimeout(()=> {');\r\n                b.unshift(parseInt(lines[l].trim().substr(5), 10) || 0);\r\n            }\r\n            else {\r\n                code.push('client.sendCommand(\\'');\r\n                code.push(lines[l]);\r\n                code.push('\\\\n\\');');\r\n            }\r\n        }\r\n        const bl = b.length;\r\n        for (l = 0; l < bl; l++) {\r\n            code.push('}, ');\r\n            code.push(b[l]);\r\n            code.push(');');\r\n        }\r\n        return code.join('');\r\n    }\r\n\r\n    public stripQuotes(str: string, force?: boolean, forceSingle?: boolean) {\r\n        if (!str || str.length === 0)\r\n            return str;\r\n        if (force || this.client.getOption('parseDoubleQuotes'))\r\n            str = str.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\r\n                return e.replace(/\\\\\\\"/g, '\"');\r\n            });\r\n        if (forceSingle || this.client.getOption('parseSingleQuotes'))\r\n            str = str.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\r\n                return e.replace(/\\\\\\'/g, '\\'');\r\n            });\r\n        return str;\r\n    }\r\n\r\n    public splitByQuotes(str: string, sep: string, force?: boolean, forceSingle?: boolean) {\r\n        let t = 0;\r\n        let e = 0;\r\n        if (!str || str.length === 0)\r\n            return [];\r\n        if (force || this.client.getOption('parseDoubleQuotes')) {\r\n            t |= 2;\r\n            e |= this.client.getOption('allowEscape') ? 2 : 0;\r\n        }\r\n        if (forceSingle || this.client.getOption('parseSingleQuotes')) {\r\n            t |= 1;\r\n            e |= this.client.getOption('allowEscape') ? 1 : 0;\r\n        }\r\n        return splitQuoted(str, sep, t, e, this.client.getOption('escapeChar'));\r\n    }\r\n\r\n    public createTrigger(pattern: string, commands: string, profile?: string | Profile, options?, name?: string, subTrigger?: boolean) {\r\n        let trigger;\r\n        let sTrigger;\r\n        let reload = true;\r\n        let isNew = false;\r\n        if (!pattern && !name)\r\n            throw new Error(`Trigger '${name || ''}' not found`);\r\n        if (!profile) {\r\n            const keys = this.client.profiles.keys;\r\n            let k = 0;\r\n            const kl = keys.length;\r\n            if (kl === 0)\r\n                return;\r\n            if (kl === 1) {\r\n                if (!this.client.profiles.items[keys[0]].enabled || !this.client.profiles.items[keys[0]].enableTriggers)\r\n                    throw Error('No enabled profiles found!');\r\n                profile = this.client.profiles.items[keys[0]];\r\n                if (subTrigger) {\r\n                    if (!name) {\r\n                        if (!this.client.profiles.items[keys[k]].triggers.length)\r\n                            throw new Error(`No triggers exist`);\r\n                        trigger = this.client.profiles.items[keys[k]].triggers[this.client.profiles.items[keys[k]].triggers.length - 1];\r\n                    }\r\n                    else\r\n                        trigger = this.client.profiles.items[keys[k]].findAny('triggers', { name: name, pattern: name });\r\n                }\r\n                else if (name !== null)\r\n                    trigger = this.client.profiles.items[keys[k]].find('triggers', 'name', name);\r\n                else\r\n                    trigger = this.client.profiles.items[keys[k]].find('triggers', 'pattern', pattern);\r\n            }\r\n            else {\r\n                for (; k < kl; k++) {\r\n                    if (!this.client.profiles.items[keys[k]].enabled || !this.client.profiles.items[keys[k]].enableTriggers || this.client.profiles.items[keys[k]].triggers.length === 0)\r\n                        continue;\r\n                    if (subTrigger) {\r\n                        if (!name) {\r\n                            if (!this.client.profiles.items[keys[k]].triggers.length)\r\n                                throw new Error(`No triggers exist`);\r\n                            trigger = this.client.profiles.items[keys[k]].triggers[this.client.profiles.items[keys[k]].triggers.length - 1];\r\n                        }\r\n                        else\r\n                            trigger = this.client.profiles.items[keys[k]].findAny('triggers', { name: name, pattern: name });\r\n                    }\r\n                    else if (name !== null)\r\n                        trigger = this.client.profiles.items[keys[k]].find('triggers', 'name', name);\r\n                    else\r\n                        trigger = this.client.profiles.items[keys[k]].find('triggers', 'pattern', pattern);\r\n                    if (trigger) {\r\n                        profile = this.client.profiles.items[keys[k]];\r\n                        break;\r\n                    }\r\n                }\r\n                if (!profile)\r\n                    profile = this.client.activeProfile;\r\n            }\r\n        }\r\n        else if (typeof profile === 'string') {\r\n            if (this.client.profiles.contains(profile.toLowerCase()))\r\n                profile = this.client.profiles.items[profile.toLowerCase()];\r\n            else\r\n                throw new Error('Profile not found: ' + profile);\r\n            if (subTrigger) {\r\n                if (!name) {\r\n                    if (!(<Profile>profile).triggers.length)\r\n                        throw new Error(`No triggers exist`);\r\n                    trigger = (<Profile>profile).triggers[(<Profile>profile).triggers.length - 1];\r\n                }\r\n                else\r\n                    trigger = (<Profile>profile).findAny('triggers', { name: name, pattern: name });\r\n            }\r\n            else if (name !== null)\r\n                trigger = (<Profile>profile).find('triggers', 'name', name);\r\n            else\r\n                trigger = (<Profile>profile).find('triggers', 'pattern', pattern);\r\n        }\r\n        if (subTrigger) {\r\n            if (!trigger)\r\n                throw new Error(`Trigger '${name || ''}' not found`);\r\n            sTrigger\r\n            sTrigger = new Trigger();\r\n            sTrigger.pattern = pattern;\r\n            reload = false;\r\n            if (pattern !== null)\r\n                sTrigger.pattern = pattern;\r\n            if (commands !== null)\r\n                sTrigger.value = commands;\r\n            if (options) {\r\n                if (options.cmd)\r\n                    sTrigger.type = TriggerType.CommandInputRegular;\r\n\r\n                if (options.pattern)\r\n                    sTrigger.type = TriggerType.Pattern;\r\n                if (options.regular)\r\n                    sTrigger.type = TriggerType.Regular;\r\n                if (options.alarm)\r\n                    sTrigger.type = TriggerType.Alarm;\r\n                if (options.event)\r\n                    sTrigger.type = TriggerType.Event;\r\n                if (options.cmdpattern)\r\n                    sTrigger.type = TriggerType.CommandInputPattern;\r\n                if (options.loopexpression)\r\n                    sTrigger.type = TriggerType.LoopExpression;\r\n                //if(options.expression)\r\n                //sTrigger.type = TriggerType.Expression;                    \r\n                if (options.reparse)\r\n                    sTrigger.type = SubTriggerTypes.ReParse;\r\n                if (options.reparsepattern)\r\n                    sTrigger.type = SubTriggerTypes.ReParsePattern;\r\n                if (options.manual)\r\n                    sTrigger.type = SubTriggerTypes.Manual;\r\n                if (options.skip)\r\n                    sTrigger.type = SubTriggerTypes.Skip;\r\n                if (options.looplines)\r\n                    sTrigger.type = SubTriggerTypes.LoopLines;\r\n                if (options.looppattern)\r\n                    sTrigger.type = SubTriggerTypes.LoopPattern;\r\n                if (options.wait)\r\n                    sTrigger.type = SubTriggerTypes.Wait;\r\n                if (options.duration)\r\n                    sTrigger.type = SubTriggerTypes.Duration;\r\n                if (options.withinlines)\r\n                    sTrigger.type = SubTriggerTypes.WithinLines;\r\n\r\n                if (options.prompt)\r\n                    sTrigger.triggerPrompt = true;\r\n                if (options.nocr)\r\n                    sTrigger.triggerNewline = false;\r\n                if (options.case)\r\n                    sTrigger.caseSensitive = true;\r\n                if (options.raw)\r\n                    sTrigger.raw = true;\r\n                if (options.verbatim)\r\n                    sTrigger.verbatim = true;\r\n                if (options.disable)\r\n                    sTrigger.enabled = false;\r\n                else if (options.enable)\r\n                    sTrigger.enabled = true;\r\n                if (options.temporary || options.temp)\r\n                    sTrigger.temp = true;\r\n                if (options.params)\r\n                    sTrigger.params = options.params;\r\n                if (options.type) {\r\n                    if (this.isTriggerType(options.type))\r\n                        sTrigger.type = this.convertTriggerType(options.type);\r\n                    else\r\n                        throw new Error('Invalid trigger type');\r\n                }\r\n            }\r\n            trigger.triggers.push(sTrigger);\r\n            this.client.echo('Trigger sub state added.', -7, -8, true, true);\r\n        }\r\n        else {\r\n            if (!trigger) {\r\n                if (!pattern)\r\n                    throw new Error(`Trigger '${name || ''}' not found`);\r\n                trigger = new Trigger();\r\n                trigger.name = name || '';\r\n                trigger.pattern = pattern;\r\n                (<Profile>profile).triggers.push(trigger);\r\n                this.client.echo('Trigger added.', -7, -8, true, true);\r\n                isNew = true;\r\n            }\r\n            else\r\n                this.client.echo('Trigger updated.', -7, -8, true, true);\r\n            if (pattern !== null)\r\n                trigger.pattern = pattern;\r\n            if (commands !== null)\r\n                trigger.value = commands;\r\n            if (options) {\r\n                if (options.cmd)\r\n                    trigger.type = TriggerType.CommandInputRegular;\r\n                if (options.pattern)\r\n                    trigger.type = TriggerType.Pattern;\r\n                if (options.regular)\r\n                    trigger.type = TriggerType.Regular;\r\n                if (options.alarm)\r\n                    trigger.type = TriggerType.Alarm;\r\n                if (options.event)\r\n                    trigger.type = TriggerType.Event;\r\n                if (options.cmdpattern)\r\n                    trigger.type = TriggerType.CommandInputPattern;\r\n                if (options.loopexpression)\r\n                    trigger.type = TriggerType.LoopExpression;\r\n                //if(options.expression)\r\n                //trigger.type = TriggerType.Expression;\r\n\r\n                if (options.prompt)\r\n                    trigger.triggerPrompt = true;\r\n                if (options.nocr)\r\n                    trigger.triggerNewline = false;\r\n                if (options.case)\r\n                    trigger.caseSensitive = true;\r\n                if (options.raw)\r\n                    trigger.raw = true;\r\n                if (options.verbatim)\r\n                    trigger.verbatim = true;\r\n                if (options.disable)\r\n                    trigger.enabled = false;\r\n                else if (options.enable)\r\n                    trigger.enabled = true;\r\n                if (options.temporary || options.temp)\r\n                    trigger.temp = true;\r\n                if (options.params)\r\n                    trigger.params = options.params;\r\n                if (options.type) {\r\n                    if (this.isTriggerType(options.type, TriggerTypeFilter.Main))\r\n                        trigger.type = this.convertTriggerType(options.type);\r\n                    else\r\n                        throw new Error('Invalid trigger type');\r\n                }\r\n                trigger.priority = options.priority;\r\n            }\r\n            else\r\n                trigger.priority = 0;\r\n        }\r\n        this.client.saveProfiles();\r\n        if (reload)\r\n            this.client.clearCache();\r\n        if (isNew)\r\n            this.emit('item-added', 'trigger', (<Profile>profile).name, trigger);\r\n        else\r\n            this.emit('item-updated', 'trigger', (<Profile>profile).name, (<Profile>profile).triggers.indexOf(trigger), trigger);\r\n        profile = null;\r\n    }\r\n\r\n    private isTriggerType(type, filter?: TriggerTypeFilter) {\r\n        if (!filter) filter = TriggerTypeFilter.All;\r\n        switch (type.replace(/ /g, '').toUpperCase()) {\r\n            case 'REGULAREXPRESSION':\r\n            case 'COMMANDINPUTREGULAREXPRESSION':\r\n                return (filter & TriggerTypeFilter.Main) === TriggerTypeFilter.Main ? true : false;\r\n            case '0':\r\n            case '1':\r\n            case '2':\r\n            case '3':\r\n            case '8':\r\n            case '16':\r\n            //case '64':\r\n            case '128':\r\n            case 'REGULAR':\r\n            case 'COMMANDINPUTREGULAR':\r\n            case 'EVENT':\r\n            case 'ALARM':\r\n            case 'COMMAND':\r\n            case 'COMMANDINPUTPATTERN':\r\n            case 'LOOPEXPRSSION':\r\n                //case 'EXPRESSION':\r\n                return (filter & TriggerTypeFilter.Main) === TriggerTypeFilter.Main ? true : false;\r\n            case 'SKIP':\r\n            case '512':\r\n            case 'WAIT':\r\n            case '1024':\r\n            case 'LOOPPATTERN':\r\n            case '4096':\r\n            case 'LOOPLINES':\r\n            case '8192':\r\n            case 'DURATION':\r\n            case '16384':\r\n            case 'WITHINLINES':\r\n            case '32768':\r\n            case 'MANUAL':\r\n            case '65536':\r\n            case 'REPARSE':\r\n            case '131072':\r\n            case 'REPARSEPATTERN':\r\n            case '262144':\r\n                return (filter & TriggerTypeFilter.Sub) === TriggerTypeFilter.Sub ? true : false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private convertTriggerType(type) {\r\n        switch (type.replace(/ /g, '').toUpperCase()) {\r\n            case 'REGULAREXPRESSION':\r\n                return TriggerType.Regular;\r\n            case 'COMMANDINPUTREGULAREXPRESSION':\r\n                return TriggerType.CommandInputRegular;\r\n            case '0':\r\n            case '1':\r\n            case '2':\r\n            case '3':\r\n            case '8':\r\n            case '16':\r\n            case '128':\r\n                //case '64':\r\n                return TriggerType[parseInt(type, 10)];\r\n            case 'REGULAR':\r\n            case 'COMMANDINPUTREGULAR':\r\n            case 'EVENT':\r\n            case 'ALARM':\r\n            case 'COMMAND':\r\n            case 'COMMANDINPUTPATTERN':\r\n            case 'LOOPEXPRSSION':\r\n                //case 'EXPRESSION':\r\n                return TriggerType[type];\r\n            case '512':\r\n            case '1024':\r\n            case '4096':\r\n            case '8192':\r\n            case '16384':\r\n            case '32768':\r\n            case '65536':\r\n            case '131072':\r\n            case '262144':\r\n                return SubTriggerTypes[parseInt(type, 10)];\r\n            case 'SKIP':\r\n            case 'WAIT':\r\n            case 'LOOPPATTERN':\r\n            case 'LOOPLINES':\r\n            case 'DURATION':\r\n            case 'WITHINLINES':\r\n            case 'MANUAL':\r\n            case 'REPARSE':\r\n            case 'REPARSEPATTERN':\r\n                return SubTriggerTypes[type];\r\n        }\r\n        throw new Error('Invalid trigger type');\r\n    }\r\n\r\n    private colorPosition(n: number, fore, back, item) {\r\n        n = this.adjustLastLine(n);\r\n        if (!item.hasOwnProperty('yStart'))\r\n            this.client.display.colorSubStringByLine(n, fore, back, item.xStart, item.hasOwnProperty('xEnd') && item.xEnd >= 0 ? item.xEnd : null);\r\n        else {\r\n            const xEnd = item.hasOwnProperty('xEnd') && item.xEnd >= 0 ? item.xEnd : null;\r\n            const xStart = item.xStart;\r\n            let line = n - item.yStart;\r\n            let end = n;\r\n            if (item.hasOwnProperty('yEnd'))\r\n                end = n - item.yEnd;\r\n            while (line <= end) {\r\n                this.client.display.colorSubStringByLine(line, fore, back, xStart, xEnd);\r\n                line++;\r\n            }\r\n        }\r\n    }\r\n}", "/**\r\n * A class to parse color values\r\n * @author Stoyan Stefanov <sstoo@gmail.com>\r\n * @link   http://www.phpied.com/rgb-color-parser-in-javascript/\r\n * @license Use it if you like it\r\n */\r\nexport function RGBColor(color_string)\r\n{\r\n    this.ok = false;\r\n\r\n    // strip any leading #\r\n    if (color_string.charAt(0) == '#') { // remove # if any\r\n        color_string = color_string.substr(1,6);\r\n    }\r\n\r\n    color_string = color_string.replace(/ /g,'');\r\n    color_string = color_string.toLowerCase();\r\n\r\n    // before getting into regexps, try simple matches\r\n    // and overwrite the input\r\n    var simple_colors = {\r\n        aliceblue: 'f0f8ff',\r\n        antiquewhite: 'faebd7',\r\n        aqua: '00ffff',\r\n        aquamarine: '7fffd4',\r\n        azure: 'f0ffff',\r\n        beige: 'f5f5dc',\r\n        bisque: 'ffe4c4',\r\n        black: '000000',\r\n        blanchedalmond: 'ffebcd',\r\n        blue: '0000ff',\r\n        blueviolet: '8a2be2',\r\n        brown: 'a52a2a',\r\n        burlywood: 'deb887',\r\n        cadetblue: '5f9ea0',\r\n        chartreuse: '7fff00',\r\n        chocolate: 'd2691e',\r\n        coral: 'ff7f50',\r\n        cornflowerblue: '6495ed',\r\n        cornsilk: 'fff8dc',\r\n        crimson: 'dc143c',\r\n        cyan: '00ffff',\r\n        darkblue: '00008b',\r\n        darkcyan: '008b8b',\r\n        darkgoldenrod: 'b8860b',\r\n        darkgray: 'a9a9a9',\r\n        darkgreen: '006400',\r\n        darkkhaki: 'bdb76b',\r\n        darkmagenta: '8b008b',\r\n        darkolivegreen: '556b2f',\r\n        darkorange: 'ff8c00',\r\n        darkorchid: '9932cc',\r\n        darkred: '8b0000',\r\n        darksalmon: 'e9967a',\r\n        darkseagreen: '8fbc8f',\r\n        darkslateblue: '483d8b',\r\n        darkslategray: '2f4f4f',\r\n        darkturquoise: '00ced1',\r\n        darkviolet: '9400d3',\r\n        deeppink: 'ff1493',\r\n        deepskyblue: '00bfff',\r\n        dimgray: '696969',\r\n        dodgerblue: '1e90ff',\r\n        feldspar: 'd19275',\r\n        firebrick: 'b22222',\r\n        floralwhite: 'fffaf0',\r\n        forestgreen: '228b22',\r\n        fuchsia: 'ff00ff',\r\n        gainsboro: 'dcdcdc',\r\n        ghostwhite: 'f8f8ff',\r\n        gold: 'ffd700',\r\n        goldenrod: 'daa520',\r\n        gray: '808080',\r\n        green: '008000',\r\n        greenyellow: 'adff2f',\r\n        honeydew: 'f0fff0',\r\n        hotpink: 'ff69b4',\r\n        indianred : 'cd5c5c',\r\n        indigo : '4b0082',\r\n        ivory: 'fffff0',\r\n        khaki: 'f0e68c',\r\n        lavender: 'e6e6fa',\r\n        lavenderblush: 'fff0f5',\r\n        lawngreen: '7cfc00',\r\n        lemonchiffon: 'fffacd',\r\n        lightblue: 'add8e6',\r\n        lightcoral: 'f08080',\r\n        lightcyan: 'e0ffff',\r\n        lightgoldenrodyellow: 'fafad2',\r\n        lightgrey: 'd3d3d3',\r\n        lightgreen: '90ee90',\r\n        lightpink: 'ffb6c1',\r\n        lightsalmon: 'ffa07a',\r\n        lightseagreen: '20b2aa',\r\n        lightskyblue: '87cefa',\r\n        lightslateblue: '8470ff',\r\n        lightslategray: '778899',\r\n        lightsteelblue: 'b0c4de',\r\n        lightyellow: 'ffffe0',\r\n        lime: '00ff00',\r\n        limegreen: '32cd32',\r\n        linen: 'faf0e6',\r\n        magenta: 'ff00ff',\r\n        maroon: '800000',\r\n        mediumaquamarine: '66cdaa',\r\n        mediumblue: '0000cd',\r\n        mediumorchid: 'ba55d3',\r\n        mediumpurple: '9370d8',\r\n        mediumseagreen: '3cb371',\r\n        mediumslateblue: '7b68ee',\r\n        mediumspringgreen: '00fa9a',\r\n        mediumturquoise: '48d1cc',\r\n        mediumvioletred: 'c71585',\r\n        midnightblue: '191970',\r\n        mintcream: 'f5fffa',\r\n        mistyrose: 'ffe4e1',\r\n        moccasin: 'ffe4b5',\r\n        navajowhite: 'ffdead',\r\n        navy: '000080',\r\n        oldlace: 'fdf5e6',\r\n        olive: '808000',\r\n        olivedrab: '6b8e23',\r\n        orange: 'ffa500',\r\n        orangered: 'ff4500',\r\n        orchid: 'da70d6',\r\n        palegoldenrod: 'eee8aa',\r\n        palegreen: '98fb98',\r\n        paleturquoise: 'afeeee',\r\n        palevioletred: 'd87093',\r\n        papayawhip: 'ffefd5',\r\n        peachpuff: 'ffdab9',\r\n        peru: 'cd853f',\r\n        pink: 'ffc0cb',\r\n        plum: 'dda0dd',\r\n        powderblue: 'b0e0e6',\r\n        purple: '800080',\r\n        red: 'ff0000',\r\n        rosybrown: 'bc8f8f',\r\n        royalblue: '4169e1',\r\n        saddlebrown: '8b4513',\r\n        salmon: 'fa8072',\r\n        sandybrown: 'f4a460',\r\n        seagreen: '2e8b57',\r\n        seashell: 'fff5ee',\r\n        sienna: 'a0522d',\r\n        silver: 'c0c0c0',\r\n        skyblue: '87ceeb',\r\n        slateblue: '6a5acd',\r\n        slategray: '708090',\r\n        snow: 'fffafa',\r\n        springgreen: '00ff7f',\r\n        steelblue: '4682b4',\r\n        tan: 'd2b48c',\r\n        teal: '008080',\r\n        thistle: 'd8bfd8',\r\n        tomato: 'ff6347',\r\n        turquoise: '40e0d0',\r\n        violet: 'ee82ee',\r\n        violetred: 'd02090',\r\n        wheat: 'f5deb3',\r\n        white: 'ffffff',\r\n        whitesmoke: 'f5f5f5',\r\n        yellow: 'ffff00',\r\n        yellowgreen: '9acd32'\r\n    };\r\n    for (var key in simple_colors) {\r\n        if (color_string == key) {\r\n            color_string = simple_colors[key];\r\n        }\r\n    }\r\n    // end of simple type-in colors\r\n\r\n    // array of color definition objects\r\n    var color_defs = [\r\n        {\r\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\r\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 10),\r\n                    parseInt(bits[2], 10),\r\n                    parseInt(bits[3], 10)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{2})(\\w{2})(\\w{2})$/,\r\n            example: ['#00ff00', '336699'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 16),\r\n                    parseInt(bits[2], 16),\r\n                    parseInt(bits[3], 16)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{1})(\\w{1})(\\w{1})$/,\r\n            example: ['#fb0', 'f0f'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1] + bits[1], 16),\r\n                    parseInt(bits[2] + bits[2], 16),\r\n                    parseInt(bits[3] + bits[3], 16)\r\n                ];\r\n            }\r\n        }\r\n    ];\r\n\r\n    // search through the definitions to find a match\r\n    for (var i = 0, cl = color_defs.length; i < cl; i++) {\r\n        var re = color_defs[i].re;\r\n        var processor = color_defs[i].process;\r\n        var bits = re.exec(color_string);\r\n        if (bits) {\r\n            var channels = processor(bits);\r\n            this.r = channels[0];\r\n            this.g = channels[1];\r\n            this.b = channels[2];\r\n            this.ok = true;\r\n        }\r\n\r\n    }\r\n\r\n    // validate/cleanup values\r\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\r\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\r\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\r\n\r\n    // some getters\r\n    this.toRGB = function () {\r\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\r\n    };\r\n    this.toHex = function () {\r\n        var r = this.r.toString(16);\r\n        var g = this.g.toString(16);\r\n        var b = this.b.toString(16);\r\n        if (r.length == 1) r = '0' + r;\r\n        if (g.length == 1) g = '0' + g;\r\n        if (b.length == 1) b = '0' + b;\r\n        return '#' + r + g + b;\r\n    };\r\n\r\n    // help\r\n    /*\r\n    this.getHelpXML = function () {\r\n\r\n        var examples = [], i, l;\r\n        // add regexps\r\n        for (i = 0, l = color_defs.length; i < l; i++) {\r\n            var example = color_defs[i].example;\r\n            for (var j = 0, el = example.length; j < el; j++) {\r\n                examples[examples.length] = example[j];\r\n            }\r\n        }\r\n        // add type-in colors\r\n        for (var sc in simple_colors) {\r\n            examples[examples.length] = sc;\r\n        }\r\n\r\n        var xml = document.createElement('ul');\r\n        xml.setAttribute('id', 'rgbcolor-examples');\r\n        for (i = 0, el = examples.length; i < el; i++) {\r\n            try {\r\n                var list_item = document.createElement('li');\r\n                var list_color = new RGBColor(examples[i]);\r\n                var example_div = document.createElement('div');\r\n                example_div.style.cssText = 'margin: 3px;border: 1px solid black;background:' + list_color.toHex() + ';color:' + list_color.toHex();\r\n                example_div.appendChild(document.createTextNode('test'));\r\n                var list_item_value = document.createTextNode(' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex());\r\n                list_item.appendChild(example_div);\r\n                list_item.appendChild(list_item_value);\r\n                xml.appendChild(list_item);\r\n\r\n            } catch(e){}\r\n        }\r\n        return xml;\r\n\r\n    };\r\n    */\r\n\r\n}\r\n\r\n", "import { EventEmitter } from './events';\nimport { RGBColor } from './lib/rgbcolor';\nimport { ParserLine, FormatType, ParserOptions, FontStyle, LineFormat, LinkFormat, ImageFormat, Size } from './types';\nimport { stripQuotes, CharAllowedInURL, htmlDecode } from './library';\nimport { Display } from './display';\n\ninterface MXPBlock {\n    format: LineFormat | LinkFormat | ImageFormat;\n    text: string;\n}\n\n/**\n   * Enum for MXP tags.\n   * @readonly\n   * @enum {number}\n   * @typedef {number} MXPTag\n   */\nenum MXPTag {\n    None = 0,\n    B, BOLD, STRONG,\n    I, ITALIC, EM,\n    U, UNDERLINE,\n    S, STRIKEOUT, STRIKE,\n    C, COLOR, H, HIGH,\n    FONT, HR,\n    NOBR, P, BR, SBR,\n    A, SEND, EXPIRE,\n    VERSION, SUPPORT,\n    RESET, H1, H2, H3, H4, H5, H6,\n    V, VAR, USER, PASSWORD, Custom,\n    GAUGE, STAT\n}\n\n/**\n * MXP line tag types\n */\nenum lineType {\n    None = -1,\n    Open = 0,\n    Secure = 1,\n    Locked = 2,\n    Reset = 3,\n    TempSecure = 4,\n    LockOpen = 5,\n    LockSecure = 6,\n    LockLocked = 7,\n    RoomName = 10,\n    RoomDescription = 11,\n    RoomExits = 12,\n    WelcomeText = 19\n}\n\n/**\n * Enum for parser state.\n * @readonly\n * @enum {number}\n * @typedef {number} ParserState\n */\nenum ParserState {\n    None = 0,\n    Ansi = 1,\n    AnsiParams = 2,\n    XTermTitle = 3,\n    MXPTag = 4,\n    MXPTagQuoted = 5,\n    MXPTagDblQuoted = 6,\n    MXPEntity = 7,\n    MXPComment = 8,\n    MXPTagArg = 9,\n    URL = 10,\n    URLFound = 11,\n    MSPSound = 12,\n    MSPMusic = 13\n}\n\n/**\n   * Object to track current state of MXP\n   *\n   * @property {Boolean}  [on='']\t\t\t\t\t- MXP on for current block of process, determined based on line mode sent\n   * @property {Number}   [lineType=0]\t\t\t\t- Current line type, 0 to 99 based on MXP spec\n   * @property {Boolean}  [locked=false]\t\t\t- is the current line mode locked based on lineType\n   * @property {Boolean}  [paragraph=false]\t\t\t- is current block in a paragraph to ignore \\n\n   * @property {Boolean}  [noBreak=false]\t\t\t- Ignore the next \\n\n   * @property {Boolean}  [expanded=false]\t\t\t- element expanded so it knows to insert the new text before continuing to parse\n   * @property {Number}   [capture=0]\t\t\t\t- Capture any text processed while capture is one, supports nesting\n   * @property {Strung[]} [captured=[]]\t\t\t\t- Captured text buffers, an array of nested captures, as captures end the last one added is popped off, and capture is decreased by 1\n   * @property {Boolean}  [expanded=false]\t\t\t- line tag expanded\n   * @property {Boolean}  [gagged=false]\t\t\t- current block of text gagged from being displayed\n   */\nclass MXPState {\n    public on: boolean = false;\n    public lineType: (lineType | number) = 0;\n    public locked: boolean = false;\n    public paragraph: boolean = false;\n    public noBreak: boolean = false;\n    public expanded: boolean = false;\n    public lineExpanded: boolean = false;\n    public capture: number = 0;\n    public captured = [];\n    public gagged: boolean = false;\n}\n\n/**\n   * MXP Entity object\n   *\n   * @property {String}  [name='']\t\t\t\t\t- The name of the entity\n   * @property {String}  [value='']\t\t\t\t\t- The value of the entity\n   * @property {String}  [description='']\t\t- the description of the entity\n   * @property {Boolean} [publish=false]\t\t- Is the entity published to the public for users to access value\n   * @property {Boolean} [remote=false]\t\t\t- None standard, tells the parser where the entity is from for security reasons as local users should not be able to change server set entities\n   */\nclass Entity {\n    public name: string = '';\n    public value: string = '';\n    public description: string = '';\n    public publish: boolean = false;\n    public remote: boolean = false;\n    constructor(remote?: boolean) {\n        this.remote = remote == null ? false : remote;\n    }\n}\n\n/**\n * MXP Element object\n *\n * @property {String}  [name='']\t\t\t\t- The name of the element\n * @property {String}  [definition='']\t\t\t- The element definition to expand to\n * @property {String}  [closeDefinition='']\t\t- The close definition built from definition\n * @property {Object}  [attributes='']\t\t\t- Object to track attributes list\n * @property {Array}   [attributeIndexes=[]]\t- Array to link attributes to argument index\n * @property {Number}  [tag=-1]\t\t\t\t\t- Tag line, if set will present tagline codes to definition in format of <esc>[<tag>zDefinition\n * @property {String}  [flag='']\t\t\t\t- Element tag property, mostly client dependant, see MXP spec for full list of basic ones\n * @property {Boolean} [open=false]\t\t\t\t- Is this an open element that can be used on an open line type\n * @property {Boolean} [empty=false]\t\t\t- Is this an empty tag that doesn't have a CloseDefinition\n * @property {Boolean} [remote=false]\t\t\t- None standard, tells the parser where the entity is from for security reasons as local users should not be able to change server set elements\n * @property {Boolean} [gagged=false]\t\t\t- Is element gagged from display as a tag could cause a custom element to be processed but hidden\n */\nclass Element {\n    public name: string = '';\n    public definition: string = '';\n    public closeDefinition: string = '';\n    public attributes = {};\n    public attributeIndexes = [];\n    public tag: (lineType | number) = lineType.None;\n    public flag: string = '';\n    public open: boolean = false;\n    public empty: boolean = false;\n    public remote: boolean = false;\n    public gagged: boolean = false;\n    constructor(remote?: boolean) {\n        this.remote = remote == null ? false : remote;\n    }\n}\n\n/**\n * MXP Line Tag object\n *\n * @property {Number}  [index=-1]\t\t\t\t\t\t- The tag number (20-99) to change\n * @property {String}  [window='']\t\t\t\t\t- Specifies the name of a window to redirect the text to, unsupported\n * @property {Boolean} [gag=false]\t\t\t\t\t- Indicates that the text should be gagged from the main MUD window.\n * @property {String}  [fore='']\t\t\t\t\t\t- The text foreground color.\n * @property {String}  [back='']\t\t\t\t\t\t- The background color of the text.\n * @property {Boolean} [enabled=true]\t\t\t\t- Turn this tag on or off.\n * @property {Boolean} [remote=false]\t\t\t\t- None standard, tells the parser where the tag is from for security reasons as local users should not be able to change server set tag\n * @property {String}  [element='']\t\t\t\t\t- Was the tag created by an element, as it should use that elements def/closeDef\n * @property {String}  [definition='']\t\t\t- Was the tag supplied with its own colors, still link to element but these colors override any set by element\n * @property {String}  [closeDefinition='']\t- The close definition built from definition\n */\nclass Tag {\n    public index: (lineType | number) = lineType.None;\n    public window: string = '';\n    public gag: boolean = false;\n    public fore: string = '';\n    public back: string = '';\n    public enabled: boolean = true;\n    public remote: boolean = false;\n    public element: string = '';\n    public definition: string = '';\n    public closeDefinition: string = '';\n    constructor(index?: number, fore?: string, back?: string, remote?: boolean) {\n        if (index != null) this.index = index;\n        if (fore != null) this.fore = fore;\n        if (back != null) this.back = back;\n        if (remote != null) this.remote = remote;\n    }\n}\n\n/**\n * MXPStyle object, stores the current style for display block in a stack, new styles are build on prev and pushed on stack, as style are closed they are popped off\n  *\n * @property {MXPTag}    [tag=0]\t\t\t- The tag that applied this style\n * @property {String}    [custom='']\t\t- If tag is custom store its name to know the exact tag\n * @property {String}    [font='']\t\t\t- The font to apply to current display block\n * @property {String}    [fontSize='']\t    - The font size in any valid css format\n * @property {FontStyle} [style=_style]\t    - The fontStyle enum state, see fontStyle\n * @property {String}    [fore=_fore]\t\t- The foreground color, this overrides any ansi foreground set\n * @property {String}    [back=_back]\t\t- The background color, this overrides aay ansi background set\n * @property {Boolean}   [high=_high]\t\t- This will brighten what ever the current foreground color is by 50% even if it is an ansi set color\n * @property {Object}    [obj=null]\t\t\t- Store misc data that a tag may need for later processing\n */\nclass MXPStyle {\n    public tag: MXPTag = MXPTag.None;\n    public custom: string = '';\n    public font: string = null;\n    public fontSize: (string) = null;\n    public style: FontStyle = FontStyle.None;\n    public fore: string = '';\n    public back: string = '';\n    public high: boolean = false;\n    public obj: any = null;\n    public gagged: boolean = false;\n    public open: boolean = false;\n    public properties = null;\n    constructor(style?: FontStyle, fore?: string, back?: string, high?: boolean, open?: boolean) {\n        if (style != null) this.style = style;\n        if (fore != null) this.fore = fore;\n        if (back != null) this.back = back;\n        this.high = high || false;\n        this.open = open || false;\n    }\n\n}\n\n/**\n * An Ansi/MXP parser, requires requires the modules src/lib/rgbcolor for color processing and validation\n *\n * @author William\n * @copyright William 2013\n * @version 1.1\n * @requires module:src/lib/rgbcolor\n * @namespace Parser\n *\n * @todo WELCOME element - just tags text as welcome for redirection purposes, don't support redirection to other windows so don't worry about this\n * @todo <FRAME NAME ACTION(OPEN|CLOSE|REDIRECT) TITLE INTERNAL ALIGN(LEFT|RIGHT|BOTTOM|TOP) LEFT TOP WIDTH HEIGHT SCROLLING(yes|no) FLOATING>\n * @constructor\n *\n * @param {Object}\toptions\t\t\t\t\t\t\t\t\t\t\t\t\t- The options to start off with\n * @param {Boolean} [options.MXP=true]\t\t\t\t\t\t\t- Enable/disable MXP parsing\n * @param {Object}\toptions.window\t\t\t\t\t\t\t\t\t- The window view size, used for clearing screen and other ansi related systems\n * @param {Number}\t[options.window.height=0]\t\t\t\t- The window height in lines\n * @param {Number}\t[options.window.width=0]\t\t\t\t- The window width in characters\n * @param {Boolean} [options.flashing=false]\t\t\t\t- Enable/disable ansi blink\n *\n * @property {String}  [StyleVersion='']\t\t\t\t\t\t- The MXP cached version style set from the VERSION tag, used by a client to reply to a VERSION request\n * @property {Boolean} [displayControlCodes=false]\t- Display unreadable characters, code < 32 || 127\n * @property {Boolean} [emulateControlCodes=true]\t\t- Emulate control codes like escape, tabs, etc...\n * @property {Boolean} [EndOfLine=false]\t\t\t\t\t\t- Is the current parser state at end of line or on a fragment\n * @property {Number}  [textLength=0]\t\t\t\t\t\t\t\t- The current amount of text that has been parsed\n * @property {Boolean} [enableMXP=true]\t\t\t\t\t\t\t- Enable/disable MXP parsing\n * @property {Boolean} [enableMSP=true]\t\t\t\t\t\t\t- Enable/disable MSP parsing\n * @property {Boolean} window\t\t\t\t\t\t\t\t\t\t\t\t- The window size, used for clearing screen and other ansi related systems\n * @property {Number}  [options.window.height=0]\t\t- The window height in lines\n * @property {Number}  [options.window.width=0]\t\t\t- The window width in characters\n * @property {Boolean} [enableFlashing=false]\t\t\t\t- Enable/disable ansi blink\n * @property {Boolean} [emulateTerminal=false]\t\t\t- Enable/disable Terminal IBM/OEM (code page 437) extended characters, will convert them to the correct unicode character in an attempt to display like classic terminal\n */\nexport class Parser extends EventEmitter {\n\n    /** @private */\n    private parsing = [];\n    /** @private */\n    /* Web detection protocols that are just followed by a :*/\n    private protocols = [['m', 'a', 'i', 'l', 't', 'o'], ['s', 'k', 'y', 'p', 'e'], ['a', 'i', 'm'], ['c', 'a', 'l', 'l', 't', 'o'], ['g', 't', 'a', 'l', 'k'], ['i', 'm'], ['i', 't', 'm', 's'], ['m', 's', 'n', 'i', 'm'], ['t', 'e', 'l'], ['y', 'm', 's', 'g', 'r']];\n\n    /** @private */\n    private _ColorTable: string[] = null;\n    /** @private */\n    private _CurrentForeColor: (string | number) = 37;\n    /** @private */\n    private _CurrentBackColor: (string | number) = 40;\n    /** @private */\n    private _CurrentAttributes: FontStyle = FontStyle.None;\n    /** @private */\n    private _SplitBuffer: string = '';\n    /** @private */\n    private mxpState: MXPState = new MXPState();\n    /** @private */\n    private mxpStyles: MXPStyle[] = [];\n    /** @private */\n    private mxpEntities: any = {};\n    /** @private */\n    private mxpElements: any = {};\n    /** @private */\n    private mxpLines: Tag[] = [];\n    /** @private */\n    private iMXPDefaultMode: (lineType | number) = lineType.Open;\n\n    public displayControlCodes: boolean = false;\n    public emulateControlCodes: boolean = true;\n    public StyleVersion: string = '';\n    public EndOfLine: boolean = false;\n    public textLength: number = 0;\n    public rawLength: number = 0;\n    public enableMXP: boolean = true;\n    public DefaultImgUrl: string = '';\n    public enableDebug: boolean = false;\n    public showInvalidMXPTags: boolean = false;\n    public enableLinks: boolean = true;\n    public enableMSP: boolean = true;\n    public enableURLDetection: boolean = true;\n    public window: Size = new Size(0, 0);\n    public enableFlashing: boolean = false;\n    public emulateTerminal: boolean = false;\n    public enableBell: boolean = true;\n    public display: Display = null;\n    public tabWidth: number = 8;\n\n    public busy = false;\n\n    constructor(options?: ParserOptions) {\n        super();\n        if (options != null) {\n            if (options.DefaultImageURL)\n                this.DefaultImgUrl = options.DefaultImageURL;\n            if (options.enableMXP != null)\n                this.enableMXP = options.enableMXP;\n            if (options.enableDebug != null)\n                this.enableDebug = options.enableDebug;\n            if (options.showInvalidMXPTags != null)\n                this.showInvalidMXPTags = options.showInvalidMXPTags;\n\n            if (options.enableMSP != null)\n                this.enableMSP = options.enableMSP;\n            if (options.enableURLDetection != null)\n                this.enableURLDetection = options.enableURLDetection;\n            if (options.window != null)\n                this.window = options.window;\n            if (options.enableFlashing != null)\n                this.enableFlashing = options.enableFlashing;\n            if (options.emulateTerminal != null)\n                this.emulateTerminal = options.emulateTerminal;\n            if (options.enableBell != null)\n                this.enableBell = options.enableBell;\n            if (options.display != null)\n                this.display = options.display;\n            if (options.enableLinks)\n                this.enableLinks = options.enableLinks;\n        }\n    }\n\n    private getColors(mxp?: MXPStyle) {\n        if (typeof mxp === 'undefined')\n            mxp = this.GetCurrentStyle();\n        let f: (string | number);\n        let b: (string | number);\n        let fc: number = -1;\n        let bc: number = -1;\n\n        if (mxp.fore.length > 0) {\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold)\n                f = this.IncreaseColor(mxp.fore, 0.5);\n            else if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint)\n                f = this.DecreaseColor(mxp.fore, 0.5);\n            else\n                f = mxp.fore;\n        }\n        else if (typeof this._CurrentForeColor === 'string')\n            f = 'rgb(' + this._CurrentForeColor.replace(/;/g, ',') + ')';\n        else {\n            f = this._CurrentForeColor;\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold) {\n                if (f > 999)\n                    f /= 1000;\n                if (f >= 0 && f < 99)\n                    f *= 10;\n                fc = f;\n                if (f <= -16)\n                    f = this.IncreaseColor(this.GetColor(f), 0.5);\n            }\n            else if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint) {\n                if (f > 99 && f < 999)\n                    f /= 10;\n                if (f >= 0 && f < 999)\n                    f *= 100;\n                fc = f;\n                if (f <= -16)\n                    f = this.DecreaseColor(this.GetColor(f), 0.15);\n            }\n            else {\n                fc = f;\n            }\n        }\n\n        if (mxp.high) {\n            if (typeof f === 'number')\n                f = this.IncreaseColor(this.GetColor(f), 0.25);\n            else\n                f = this.IncreaseColor(f, 0.25);\n        }\n\n        if (mxp.back.length > 0)\n            b = mxp.back;\n        else if (typeof this._CurrentBackColor === 'string')\n            b = 'rgb(' + this._CurrentBackColor.replace(/;/g, ',') + ')';\n        else\n            b = bc = this._CurrentBackColor;\n\n        if ((this._CurrentAttributes & FontStyle.Inverse) === FontStyle.Inverse || (mxp.style & FontStyle.Inverse) === FontStyle.Inverse)\n            return { fore: b, back: f, foreCode: bc, backCode: fc };\n        return { fore: f, back: b, foreCode: fc, backCode: bc };\n    }\n\n    private getFormatBlock(offset) {\n        const mxp: MXPStyle = this.GetCurrentStyle();\n        const colors = this.getColors(mxp);\n        return {\n            formatType: FormatType.Normal,\n            offset: offset,\n            color: colors.fore || 0,\n            background: colors.back || 0,\n            size: mxp.fontSize || 0,\n            font: mxp.font || 0,\n            style: mxp.style | (this._CurrentAttributes & ~FontStyle.Bold),\n            unicode: false\n        };\n    }\n\n    private ResetColors() {\n        this._CurrentForeColor = 37;\n        this._CurrentBackColor = 40;\n        this._CurrentAttributes = FontStyle.None;\n    }\n\n    private ProcessAnsiColorParams(params: string[]) {\n        let p: number = 0;\n        const pl: number = params.length;\n        let i: number;\n        let rgb: string;\n        for (; p < pl; p++) {\n            i = +params[p] || 0;\n            switch (i) {\n                case 0: //Reset/None\n                    this.ResetColors();\n                    break;\n                case 1: //Bold\n                    this._CurrentAttributes |= FontStyle.Bold;\n                    //can only be bold or faint not both, so when you turn on bold turn off faint\n                    this._CurrentAttributes &= ~FontStyle.Faint;\n                    break;\n                case 2: //Faint\n                    this._CurrentAttributes |= FontStyle.Faint;\n                    //can only be bold or faint not both, so when you turn on faint turn off bold\n                    this._CurrentAttributes &= ~FontStyle.Bold;\n                    break;\n                case 3: //Italics\n                    this._CurrentAttributes |= FontStyle.Italic;\n                    break;\n                case 4: //Underscore\n                    this._CurrentAttributes |= FontStyle.Underline;\n                    //this._CurrentAttributes &= ~FontStyle.DoubleUnderline;\n                    break;\n                case 5: //Blink < 150 per min\n                    this._CurrentAttributes |= FontStyle.Slow;\n                    break;\n                case 6: //Blink Rapid >= 150 per min\n                    this._CurrentAttributes |= FontStyle.Rapid;\n                    break;\n                case 7: //Reverse\n                    this._CurrentAttributes |= FontStyle.Inverse;\n                    break;\n                case 8: //hidden / Concealed\n                    this._CurrentAttributes |= FontStyle.Hidden;\n                    break;\n                case 9: //strike through on\n                    this._CurrentAttributes |= FontStyle.Strikeout;\n                    break;\n                /*\n                10 primary(default) font\n                11 first alternative font\n                12 second alternative font\n                13 third alternative font\n                14 fourth alternative font\n                15 fifth alternative font\n                16 sixth alternative font\n                17 seventh alternative font\n                18 eighth alternative font\n                19 ninth alternative font\n                20 Fraktur(Gothic)\n                */\n                case 21:\n                    this._CurrentAttributes |= FontStyle.DoubleUnderline;\n                    //this._CurrentAttributes &= ~FontStyle.Underline;\n                    break;\n                case 22: //bold off\n                    this._CurrentAttributes &= ~FontStyle.Bold;\n                    this._CurrentAttributes &= ~FontStyle.Faint;\n                    break;\n                case 23: //italics off\n                    this._CurrentAttributes &= ~FontStyle.Italic;\n                    break;\n                case 24: //underline off\n                    this._CurrentAttributes &= ~FontStyle.Underline;\n                    this._CurrentAttributes &= ~FontStyle.DoubleUnderline;\n                    break;\n                case 25:\n                    this._CurrentAttributes &= ~FontStyle.Slow;\n                    break;\n                case 26:\n                    this._CurrentAttributes &= ~FontStyle.Rapid;\n                    break;\n                case 27: //inverse off\n                    this._CurrentAttributes &= ~FontStyle.Inverse;\n                    break;\n                case 28: //visible / concealed off\n                    this._CurrentAttributes &= ~FontStyle.Hidden;\n                    break;\n                case 29: //strike through off\n                    this._CurrentAttributes &= ~FontStyle.Strikeout;\n                    break;\n                case -11: //error color\n                case -7: //info color\n                case -3: //local echo\n                case 30: //set foreground color to black\n                case 31: //set foreground color to red\n                case 32: //set foreground color to green\n                case 33:  //set foreground color to yellow\n                case 34: //set foreground color to blue\n                case 35:  //set foreground color to magenta (purple)\n                case 36:  //set foreground color to cyan\n                case 37:  //set foreground color to white\n                    this._CurrentForeColor = i;\n                    break;\n                case 38:\n                    if (p + 2 < pl && params[p + 1] === '5') {\n                        this._CurrentForeColor = +params[p + 2];\n                        if (isNaN(this._CurrentForeColor))\n                            this._CurrentForeColor = 37;\n                        else {\n                            this._CurrentForeColor += 16;\n                            this._CurrentForeColor *= -1;\n                        }\n                        p += 2;\n                    }\n                    else if (p + 4 < pl && params[p + 1] === '2') {\n                        i = +params[p + 2] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb = i + ';';\n                        i = +params[p + 3] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i + ';';\n                        i = +params[p + 4] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i;\n                        this._CurrentForeColor = rgb;\n                        p += 4;\n                    }\n                    break;\n                case 39: //set foreground color to default)\n                    this._CurrentForeColor = -1;\n                    break;\n                case -12: //error color\n                case -8:\n                case -4:\n                case 40:\n                case 41:\n                case 42:\n                case 43:\n                case 44:\n                case 45:\n                case 46:\n                case 47:\n                    this._CurrentBackColor = i;\n                    break;\n                case 48:\n                    if (p + 2 < pl && params[p + 1] === '5') {\n                        this._CurrentBackColor = +params[p + 2];\n                        if (isNaN(this._CurrentBackColor))\n                            this._CurrentBackColor = 40;\n                        else {\n                            this._CurrentBackColor += 16;\n                            this._CurrentBackColor *= -1; //prevent overlap of protocols in color grabbing code\n                        }\n                        p += 2;\n                    }\n                    else if (p + 4 < pl && params[p + 1] === '2') {\n                        i = +params[p + 2] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb = i + ';';\n                        i = +params[p + 3] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i + ';';\n                        i = +params[p + 4] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i;\n                        this._CurrentBackColor = rgb;\n                        p += 4;\n                    }\n                    break;\n                case 49:\n                    this._CurrentBackColor = -2;\n                    break;\n                //zMUD log colors, seems zMUD uses the 50s for display info for bold colors, standards use it to control borders and other effects\n                //don't need zMUD colors here as we never need to open fonts, replace with the frames/overlined/etc... if it can be done in css\n                case 53: //Overlined believe this draws a line above text, opposite of underline\n                    this._CurrentAttributes |= FontStyle.Overline;\n                    break;\n                case 55: //Not overlined, turns off overlined\n                    this._CurrentAttributes &= ~FontStyle.Overline;\n                    break;\n                case 50: //Reserved\n                case 51: //Framed believe this adds a border all the way around block of text\n                case 52: //Encircled, not sure maybe draws a circle around text?\n                case 54: //Not framed or encircled, turns off framed/encircled\n                case 56: //Reserved\n                case 57: //Reserved\n                case 58: //Reserved\n                case 59: //Reserved\n                    this._CurrentForeColor = i - 20;\n                    this._CurrentAttributes |= FontStyle.Bold; //make bold\n                    break;\n                //xterm 16 but color\n                //Assume that xterm?s resources are set so that the ISO color codes are the first 8 of a set of 16.\n                //Then the aixterm colors are the bright versions of the ISO colors:\n                case 90:\n                case 91:\n                case 92:\n                case 93:\n                case 94:\n                case 95:\n                case 96:\n                case 97:\n                    this._CurrentForeColor = i;\n                    break;\n                case 100:\n                case 101:\n                case 102:\n                case 103:\n                case 104:\n                case 105:\n                case 106:\n                case 107:\n                    this._CurrentBackColor = i;\n                    break;\n            }\n        }\n    }\n\n    private buildColorTable() {\n        const _ColorTable: string[] = [];\n        let r;\n        let g;\n        let b;\n        let idx;\n        for (r = 0; r < 6; r++) {\n            for (g = 0; g < 6; g++) {\n                for (b = 0; b < 6; b++) {\n                    idx = 16 + (r * 36) + (g * 6) + b;\n                    _ColorTable[idx] = 'rgb(';\n                    if (r > 0)\n                        _ColorTable[idx] += r * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ',';\n                    if (g > 0)\n                        _ColorTable[idx] += g * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ',';\n                    if (b > 0)\n                        _ColorTable[idx] += b * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ')';\n                }\n            }\n        }\n        for (r = 232; r <= 255; r++)//grayscale\n        {\n            g = (r - 232) * 10 + 8;\n            _ColorTable[r] = ['rgb(', g, ',', g, ',', g, ')'].join('');\n        }\n        _ColorTable[0] = 'rgb(0,0,0)'; //black fore\n        _ColorTable[1] = 'rgb(128, 0, 0)'; //red fore\n        _ColorTable[2] = 'rgb(0, 128, 0)'; //green fore\n        _ColorTable[3] = 'rgb(128, 128, 0)'; //yellow fore\n        _ColorTable[4] = 'rgb(0, 0, 238)'; //blue fore\n        _ColorTable[5] = 'rgb(128, 0, 128)'; //magenta fore\n        _ColorTable[6] = 'rgb(0, 128, 128)'; //cyan fore\n        _ColorTable[7] = 'rgb(187, 187, 187)'; //white fore\n        _ColorTable[8] = 'rgb(128, 128, 128)'; //black  bold\n        _ColorTable[9] = 'rgb(255, 0, 0)'; //Red bold\n        _ColorTable[10] = 'rgb(0, 255, 0)'; //green bold\n        _ColorTable[11] = 'rgb(255, 255, 0)'; //yellow bold\n        _ColorTable[12] = 'rgb(92, 92, 255)'; //blue bold\n        _ColorTable[13] = 'rgb(255, 0, 255)'; //magenta bold\n        _ColorTable[14] = 'rgb(0, 255, 255)'; //cyan bold\n        _ColorTable[15] = 'rgb(255, 255, 255)'; //white bold\n        _ColorTable[256] = 'rgb(0, 0, 0)'; //black faint\n        _ColorTable[257] = 'rgb(118, 0, 0)'; //red  faint\n        _ColorTable[258] = 'rgb(0, 108, 0)'; //green faint\n        _ColorTable[259] = 'rgb(145, 136, 0)'; //yellow faint\n        _ColorTable[260] = 'rgb(0, 0, 167)'; //blue faint\n        _ColorTable[261] = 'rgb(108, 0, 108)'; //magenta faint\n        _ColorTable[262] = 'rgb(0, 108, 108)'; //cyan faint\n        _ColorTable[263] = 'rgb(161, 161, 161)'; //white faint\n        _ColorTable[264] = 'rgb(0, 0, 0)'; //BackgroundBlack\n        _ColorTable[265] = 'rgb(128, 0, 0)'; //red back\n        _ColorTable[266] = 'rgb(0, 128, 0)'; //greenback\n        _ColorTable[267] = 'rgb(128, 128, 0)'; //yellow back\n        _ColorTable[268] = 'rgb(0, 0, 238)'; //blue back\n        _ColorTable[269] = 'rgb(128, 0, 128)'; //magenta back\n        _ColorTable[270] = 'rgb(0, 128, 128)';  //cyan back\n        _ColorTable[271] = 'rgb(187, 187, 187)';  //white back\n\n        _ColorTable[272] = 'rgb(0,0,0)'; //InfoBackground\n        _ColorTable[273] = 'rgb(0, 255, 255)';  //InfoText\n        _ColorTable[274] = 'rgb(0,0,0)'; //LocalEchoBackground\n        _ColorTable[275] = 'rgb(255, 255, 0)';  //LocalEchoText\n        _ColorTable[276] = 'rgb(0, 0, 0)';  //DefaultBack\n        _ColorTable[277] = 'rgb(229, 229, 229)';  //DefaultFore\n\n        _ColorTable[278] = 'rgb(205, 0, 0)';  //ErrorFore\n        _ColorTable[279] = 'rgb(229, 229, 229)';  //ErrorBack\n\n        _ColorTable[280] = 'rgb(255,255,255)';  //DefaultBrightFore\n        this._ColorTable = _ColorTable;\n    }\n\n    public GetColor(code: number) {\n        if (this._ColorTable == null)\n            this.buildColorTable();\n        switch (code) {\n            case -12:\n                return this._ColorTable[279];  //ErrorBack\n            case -11:\n                return this._ColorTable[278];  //ErrorFore\n            case -10:\n                return this._ColorTable[280];  //DefaultBrightFore\n            case -8:\n                return this._ColorTable[272]; //InfoBackground\n            case -7:\n                return this._ColorTable[273];  //InfoText\n            case -4:\n                return this._ColorTable[274]; //LocalEchoBackground\n            case -3:\n                return this._ColorTable[275];  //LocalEchoText\n            case 49:\n            case -2:\n                return this._ColorTable[276];  //DefaultBack\n            case 39:\n            case -1:\n                return this._ColorTable[277];  //DefaultBack\n            case 0:\n            case 30: //set foreground color to black\n                return this._ColorTable[0];\n            case 1:\n            case 31: //set foreground color to red\n                return this._ColorTable[1];\n            case 2:\n            case 32: //set foreground color to green\n                return this._ColorTable[2];\n            case 3:\n            case 33:  //set foreground color to yellow\n                return this._ColorTable[3];\n            case 4:\n            case 34: //set foreground color to blue\n                return this._ColorTable[4];\n            case 5:\n            case 35:  //set foreground color to magenta (purple)\n                return this._ColorTable[5];\n            case 6:\n            case 36:  //set foreground color to cyan\n                return this._ColorTable[6];\n            case 7:\n            case 37:  //set foreground color to white\n                return this._ColorTable[7];\n            case 40:  //background black\n                return this._ColorTable[264];\n            case 41:  //background red\n                return this._ColorTable[265];\n            case 42:  //background green\n                return this._ColorTable[266];\n            case 43:  //background yellow\n                return this._ColorTable[267];\n            case 44:  //background blue\n                return this._ColorTable[268];\n            case 45:  //background magenta\n                return this._ColorTable[269];\n            case 46:  //cyan\n                return this._ColorTable[270];\n            case 47:  //white\n                return this._ColorTable[271];\n            case 8:\n            case 90:\n            case 100:\n            case 300: //set foreground color to black\n            case 400:\n                return this._ColorTable[8];\n            case 9:\n            case 91:\n            case 101:\n            case 310: //set foreground color to red\n            case 410:\n                return this._ColorTable[9];\n            case 10:\n            case 92:\n            case 102:\n            case 320: //set foreground color to green\n            case 420:\n                return this._ColorTable[10];\n            case 11:\n            case 93:\n            case 103:\n            case 330:  //set foreground color to yellow\n            case 430:\n                return this._ColorTable[11];\n            case 12:\n            case 94:\n            case 104:\n            case 340: //set foreground color to blue\n            case 440:\n                return this._ColorTable[12];\n            case 13:\n            case 95:\n            case 105:\n            case 350:  //set foreground color to magenta (purple)\n            case 450:\n                return this._ColorTable[13];\n            case 14:\n            case 96:\n            case 106:\n            case 360:  //set foreground color to cyan\n            case 460:\n                return this._ColorTable[14];\n            case 15:\n            case 97:\n            case 107:\n            case 370:  //set foreground color to white\n            case 470:\n                return this._ColorTable[15];\n            case 4000:\n            case 3000: //set foreground color to black\n                return this._ColorTable[256];\n            case 4100:\n            case 3100: //set foreground color to red\n                return this._ColorTable[257];\n            case 4200:\n            case 3200: //set foreground color to green\n                return this._ColorTable[258];\n            case 4300:\n            case 3300:  //set foreground color to yellow\n                return this._ColorTable[259];\n            case 4400:\n            case 3400: //set foreground color to blue\n                return this._ColorTable[260];\n            case 4500:\n            case 3500:  //set foreground color to magenta (purple)\n                return this._ColorTable[261];\n            case 4600:\n            case 3600:  //set foreground color to cyan\n                return this._ColorTable[262];\n            case 4700:\n            case 3700:  //set foreground color to white\n                return this._ColorTable[263];\n            default:\n                if (code <= -16) {\n                    code += 16;\n                    code *= -1;\n                }\n                if (code >= 0 && code < 281)\n                    return this._ColorTable[code];\n                return this._ColorTable[277];\n        }\n    }\n\n    public SetColor(code: number, color) {\n        if (this._ColorTable == null)\n            this.buildColorTable();\n        if (code < 0 || code >= this._ColorTable.length)\n            return;\n        color = new RGBColor(color);\n        if (!color.ok) return;\n        this._ColorTable[code] = color.toRGB();\n    }\n\n    private AddLine(line: string, raw: string, fragment: boolean, skip: boolean, formats: LineFormat[], remote: boolean) {\n        const data: ParserLine = { raw: raw, line: line, fragment: fragment, gagged: skip, formats: this.pruneFormats(formats, line.length, fragment), remote: remote };\n        this.emit('add-line', data);\n        this.EndOfLine = !fragment;\n    }\n\n    private pruneFormats(formats, textLen, fragment) {\n        //no formats or only 1 format\n        if (!formats || formats.length < 2) return formats;\n        const l = formats.length;\n        const nF = [];\n        for (let f = 0; f < l; f++) {\n            const format = formats[f];\n            let end;\n            if (f < l - 1) {\n                const nFormat = formats[f + 1];\n                //skip format until find one that has different offset\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\n                    continue;\n                end = nFormat.offset;\n                //empty link\n                if (format.formatType === FormatType.Link && end - format.offset === 0 && nFormat.formatType === FormatType.LinkEnd)\n                    continue;\n                //empty send\n                if (format.formatType === FormatType.MXPSend && end - format.offset === 0 && nFormat.formatType === FormatType.MXPSendEnd)\n                    continue;\n                //empty link\n                if (format.formatType === FormatType.MXPLink && end - format.offset === 0 && nFormat.formatType === FormatType.MXPLinkEnd)\n                    continue;\n            }\n            //trailing link with no text or empty format block and not fragment\n            else if (!fragment && format.offset === textLen && textLen !== 0 && ((format.formatType === FormatType.Normal && !format.hr) || format.formatType === FormatType.Link || format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink))\n                continue;\n            nF.push(format);\n        }\n        return nF;\n    }\n\n    private GetEntity(entity: string) {\n        if (entity === 'text')\n            return entity;\n        //custom entity\n        if (this.mxpEntities[entity]) {\n            //expanded it for processing\n            this.mxpState.expanded = true;\n            //return value to be processed as value could contain mxp tags and other entities\n            return this.mxpEntities[entity].value;\n        }\n        return entity;\n    }\n\n    private ClearMXPToTag(tag: MXPTag, custom?: string, secure?: boolean) {\n        if (custom == null) custom = '';\n        let tmp = new MXPStyle();\n        tmp.tag = MXPTag.None;\n        let ml = this.mxpStyles.length - 1;\n        for (; ml >= 0; ml--) {\n            if (this.mxpStyles[ml].tag !== tag && this.mxpStyles[ml].custom !== custom) {\n                if (!this.mxpStyles[ml].open && !secure) continue;\n                tmp = this.mxpStyles.splice(ml, 1)[0];\n            }\n            else\n                break;\n        }\n        //return the matching tag\n        if (ml >= 0 && this.mxpStyles.length > 0)\n            tmp = this.mxpStyles.splice(ml, 1)[0];\n        else if (this.mxpStyles.length === 0)\n            this.ResetMXP();\n        return tmp;\n    }\n\n    private ClearMXPOpen() {\n        let ml = this.mxpStyles.length;\n        while (ml--) {\n            if (!this.mxpStyles[ml].open) continue;\n            this.mxpStyles.splice(ml, 1);\n        }\n        if (this.mxpStyles.length === 0)\n            this.ResetMXP();\n    }\n\n    private getMXPOpenFormatBlocks() {\n        if (!this.mxpState.on) return [];\n        let m = 0;\n        const ml = this.mxpStyles.length;\n        const formats = [];\n        for (; m < ml; m++) {\n            if (this.mxpStyles[m].tag === MXPTag.A || this.mxpStyles[m].tag === MXPTag.SEND)\n                formats.push(Object.assign({}, this.mxpStyles[m].properties));\n        }\n        return formats;\n    }\n\n    private getMXPCloseFormatBlocks() {\n        if (!this.mxpState.on) return [];\n        let ml = this.mxpStyles.length;\n        const formats = [];\n        while (ml--) {\n            if (this.mxpStyles[ml].tag === MXPTag.A)\n                formats.push({ formatType: FormatType.MXPLinkEnd });\n            else if (this.mxpStyles[ml].tag === MXPTag.SEND)\n                formats.push({ formatType: FormatType.MXPSendEnd });\n        }\n        return formats;\n    }\n\n    private getMXPBlock(tag: string, args, remote, oTag?, blocks?): MXPBlock {\n        let tmp;\n        let arg;\n        let sArg;\n        let sArgs;\n        let color;\n        let x;\n        let xl = args.length;\n        let e;\n        let sl;\n        let s;\n        let href = '';\n        let hint = '';\n        let expire = '';\n        let prompt = false;\n        tag = tag.toUpperCase();\n        if (this.enableDebug) {\n            this.emit('debug', 'MXP Tag: ' + tag);\n            this.emit('debug', 'MXP Tag Args: ' + args);\n        }\n        switch (tag) {\n            case 'C':\n            case 'COLOR':\n                tmp = this.CloneCurrentStyle();\n                tmp.tag = MXPTag[tag];\n                tmp.open = true;\n                if (xl > 0) {\n                    arg = args[0].split('=');\n                    if (arg.length > 1) {\n                        color = new RGBColor(stripQuotes(arg[1]));\n                        if (!color.ok) return null;\n                        if (arg[0].toUpperCase() === 'BACK')\n                            tmp.back = color.toRGB();\n                        else\n                            tmp.fore = color.toRGB();\n                    }\n                    else {\n                        color = new RGBColor(stripQuotes(arg[0]));\n                        if (color.ok)\n                            tmp.fore = color.toRGB();\n                    }\n                }\n                if (xl > 1) {\n                    arg = args[1].split('=');\n                    if (arg.length > 1) {\n                        color = new RGBColor(stripQuotes(arg[1]));\n                        if (!color.ok) return null;\n                        if (arg[0].toUpperCase() === 'FORE')\n                            tmp.fore = color.toRGB();\n                        else\n                            tmp.back = color.toRGB();\n\n                    }\n                    else {\n                        color = new RGBColor(stripQuotes(arg[0]));\n                        if (color.ok)\n                            tmp.back = color.toRGB();\n                    }\n                }\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'B':\n            case 'BOLD':\n            case 'STRONG':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Bold;\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'FONT':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                for (x = 0; x < xl; x++) {\n                    arg = args[x].split('=');\n                    if (arg.length > 1) {\n                        switch (arg[0].toUpperCase()) {\n                            case 'SIZE':\n                                if (this.isNumber(arg[1]))\n                                    tmp.fontSize = arg[1] + 'pt';\n                                else\n                                    tmp.fontSize = arg[1] || 0;\n                                break;\n                            case 'COLOR':\n                                sArgs = arg[1].split(',');\n                                color = new RGBColor(stripQuotes(sArgs[0]));\n                                if (color.ok) tmp.fore = color.toRGB();\n                                for (s = 1, sl = sArgs.length; s < sl; s++) {\n                                    switch (sArgs[s].toLowerCase()) {\n                                        case 'bold':\n                                            tmp.style |= FontStyle.Bold;\n                                            break;\n                                        case 'italic':\n                                            tmp.style |= FontStyle.Italic;\n                                            break;\n                                        case 'underline':\n                                            tmp.style |= FontStyle.Underline;\n                                            break;\n                                        case 'blink':\n                                            tmp.style |= FontStyle.Slow;\n                                            break;\n                                        case 'inverse':\n                                            tmp.style |= FontStyle.Inverse;\n                                            break;\n                                        case 'hidden':\n                                            tmp.style |= FontStyle.Hidden;\n                                            break;\n                                        case 'strikeout':\n                                            tmp.style |= FontStyle.Strikeout;\n                                            break;\n                                        case 'overline':\n                                            tmp.style |= FontStyle.Overline;\n                                            break;\n                                        case 'doubleunderline':\n                                            tmp.style |= FontStyle.DoubleUnderline;\n                                            break;\n                                    }\n                                }\n                                break;\n                            case 'BACK':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) tmp.back = color.toRGB();\n                                break;\n                            case 'FACE':\n                                tmp.font = stripQuotes(arg[1]) || 0;\n                                break;\n                            default:\n                                if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                break;\n                        }\n                    }\n                    else if (x === 0) {\n                        tmp.font = stripQuotes(args[x]) || 0;\n                    }\n                    else if (x === 1) {\n                        if (this.isNumber(args[x]))\n                            tmp.fontSize = args[x] + 'pt';\n                        else\n                            tmp.fontSize = args[x] || 0;\n                    }\n                    else if (x === 2) {\n                        color = new RGBColor(stripQuotes(args[x]));\n                        if (color.ok) tmp.fore = color.toRGB();\n                    }\n                    else if (x === 3) {\n                        color = new RGBColor(stripQuotes(args[x]));\n                        if (color.ok) tmp.back = color.toRGB();\n                    }\n                }\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'H':\n            case 'HIGH':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.high = true;\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'I':\n            case 'ITALIC':\n            case 'EM':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Italic;\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'U':\n            case 'UNDERLINE':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Underline;\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case 'S':\n            case 'STRIKEOUT':\n                tmp = this.CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Strikeout;\n                tmp.custom = '';\n                this.mxpStyles.push(tmp);\n                return null;\n            case '/B':\n            case '/BOLD':\n            case '/STRONG':\n            case '/H':\n            case '/HIGH':\n            case '/I':\n            case '/ITALIC':\n            case '/EM':\n            case '/U':\n            case '/UNDERLINE':\n            case '/S':\n            case '/STRIKEOUT':\n            case '/C':\n            case '/COLOR':\n            case '/FONT':\n                this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                return null;\n        }\n        if (this.mxpState.lineType === lineType.Secure || this.mxpState.lineType === lineType.LockSecure || this.mxpState.lineType === lineType.TempSecure) {\n            switch (tag) {\n                case 'IMAGE':\n                    e = {\n                        formatType: FormatType.Image,\n                        name: '',\n                        url: this.DefaultImgUrl,\n                        t: '',\n                        h: '',\n                        w: '',\n                        hspace: '',\n                        vspace: '',\n                        align: 'bottom',\n                        ismap: false\n                    };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'FNAME':\n                                e.name = stripQuotes(arg[1]);\n                                break;\n                            case 'URL':\n                                e.url = stripQuotes(arg[1]);\n                                break;\n                            case 'TYPE':\n                            case 'T':\n                                if (arg[1].length > 0)\n                                    e.type = arg[1];\n                                break;\n                            case 'HEIGHT':\n                            case 'H':\n                                e.h = stripQuotes(arg[1]);\n                                break;\n                            case 'WIDTH':\n                            case 'W':\n                                e.w = stripQuotes(arg[1]);\n                                break;\n                            case 'HSPACE':\n                                e.hspace = arg[1];\n                                break;\n                            case 'VSPACE':\n                                e.vspace = arg[1];\n                                break;\n                            case 'ALIGN':\n                                e.align = arg[1].toLowerCase();\n                                break;\n                            case 'ISMAP':\n                                e.ismap = true;\n                                break;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.url = stripQuotes(args[x]);\n                                else if (x === 2 && args[x].length > 0)\n                                    e.type = args[x];\n                                else if (x === 3)\n                                    e.h = stripQuotes(args[x]);\n                                else if (x === 4)\n                                    e.w = stripQuotes(args[x]);\n                                else if (x === 5)\n                                    e.hspace = args[x];\n                                else if (x === 6)\n                                    e.vspace = args[x];\n                                else if (x === 7)\n                                    e.align = args[x].toLowerCase();\n                                break;\n                        }\n                    }\n                    return { format: e, text: null };\n                case '!AT':\n                case '!ATTLIST':\n                    if (args.length === 0) return null;\n                    e = args[0];\n                    //not defined or if not from the same origin and not open cant change it\n                    if (!this.mxpElements[e] || (this.mxpEntities[e].remote !== e.remote && !this.mxpEntities[e].open))\n                        return null;\n                    //clear out any old ones\n                    this.mxpElements[e].attributes = {};\n                    this.mxpElements[e].attributeIndexes = [];\n                    for (x = 1; x < xl; x++) {\n                        sArgs = args[x].split('=');\n                        if (sArgs.length > 1)\n                            this.mxpElements[e].attributes[sArgs[0].toLowerCase()] = sArgs[1];\n                        else\n                            this.mxpElements[e].attributes[sArgs[0].toLowerCase()] = '';\n                        this.mxpElements[e].attributeIndexes.push(sArgs[0].toLowerCase());\n                    }\n                    break;\n                case '!TAG':\n                    e = new Tag();\n                    e.remote = remote;\n                    for (x = 0; x < xl; x++) {\n                        //special case, as attribute list has = in it so test for it\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'WINDOWNAME':\n                                e.window = stripQuotes(arg[1]);\n                                break;\n                            case 'FORE':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) e.fore = color.toRGB();\n                                break;\n                            case 'BACK':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) e.back = color.toRGB();\n                                break;\n                            case 'GAG':\n                                e.gag = true;\n                                break;\n                            case 'ENABLE':\n                                e.enabled = true;\n                                break;\n                            case 'DISABLE':\n                                e.enabled = false;\n                                break;\n                            default:\n                                if (x === 0) {\n                                    tmp = +args[x];\n                                    if (!isNaN(tmp)) e.index = tmp;\n                                }\n                                else if (x === 1)\n                                    e.window = stripQuotes(args[x]);\n                                else if (x === 2) {\n                                    color = new RGBColor(stripQuotes(args[x]));\n                                    if (color.ok) e.fore = color.toRGB();\n                                }\n                                else if (x === 3) {\n                                    color = new RGBColor(stripQuotes(args[x]));\n                                    if (color.ok) e.back = color.toRGB();\n                                }\n                                break;\n                        }\n                    }\n                    if (e.fore.length > 0 && e.back.length > 0)\n                        e.definition = `<C \"${e.fore}\" \"${e.back}\">`;\n                    else if (e.fore.length > 0)\n                        e.definition = `<C \"${e.fore}\">`;\n                    else if (e.back.length > 0)\n                        e.definition = `<C BACK=\"${e.fore}\">`;\n                    if (e.definition.length > 0)\n                        e.closeDefinition = '</C>';\n                    if (this.mxpLines[e.index]) {\n                        //mud can over ride local, but local can not override remote\n                        if (e.remote || this.mxpLines[e.index].remote === e.remote)\n                            this.mxpLines[e.index] = e;\n                    }\n                    else\n                        this.mxpLines[e.index] = e;\n                    break;\n                case '!EL':\n                case '!ELEMENT':\n                    e = new Element(remote);\n                    for (x = 0; x < xl; x++) {\n                        //special case, as attribute list has = in it so test for it\n                        if (args[x].toUpperCase().startsWith('ATT=')) {\n                            arg = stripQuotes(args[x]).substring(4).split(' ');\n                            for (s = 0, sl = arg.length; s < sl; s++) {\n                                sArgs = stripQuotes(arg[s]).split('=');\n                                if (sArgs.length > 1)\n                                    e.attributes[sArgs[0].toLowerCase()] = stripQuotes(sArgs[1]);\n                                else\n                                    e.attributes[sArgs[0].toLowerCase()] = '';\n                                e.attributeIndexes.push(sArgs[0].toLowerCase());\n                            }\n                            continue;\n                        }\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'TAG':\n                                tmp = +arg[1];\n                                if (!isNaN(tmp)) e.tag = tmp;\n                                break;\n                            case 'FLAG':\n                                e.flag = stripQuotes(arg[1]);\n                                break;\n                            case 'OPEN':\n                                e.open = true;\n                                break;\n                            case 'DELETE':\n                                if (this.mxpElements[e.name] && (this.mxpEntities[e.name].remote === e.remote || this.mxpEntities[e.name].open))\n                                    delete this.mxpEntities[e.name];\n                                return null;\n                            case 'EMPTY':\n                                e.empty = true;\n                                break;\n                            /*\n                          case \"HIDDEN\":\n                            e.hidden = true;\n                            break;\n                            */\n                            case 'SECURE':\n                                e.open = false;\n                                break;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]).toUpperCase();\n                                else if (x === 1) {\n                                    e.definition = stripQuotes(args[x]);\n                                    e.closeDefinition = this.GetCloseTags(e.definition);\n                                    if (this.enableDebug) this.emit('debug', 'MXP close definition: ' + e.closeDefinition);\n                                }\n                                else if (x === 2) {\n                                    arg = args[x].substring(4).split(' ');\n                                    for (s = 0, sl = arg.length; s < sl; s++) {\n                                        sArgs = arg[s].split('=');\n                                        if (sArgs.length > 1)\n                                            e.attributes[sArgs[0]] = sArgs[1];\n                                        else\n                                            e.attributes[sArgs[0]] = '';\n                                        e.attributeIndexes.push(sArgs[0]);\n                                    }\n                                }\n                                else if (x === 3) {\n                                    tmp = +args[x];\n                                    if (!isNaN(tmp)) e.tag = tmp;\n                                }\n                                else if (x === 4)\n                                    e.flag = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (e.tag > 19 && e.tag < 100) {\n                        tmp = new Tag(e.tag);\n                        tmp.element = e.name;\n                        if (this.mxpLines[tmp.index]) {\n                            //mud can over ride local, but local can not override remote\n                            if (e.remote || this.mxpLines[tmp.index].remote === e.remote)\n                                this.mxpLines[tmp.index] = tmp;\n                        }\n                        else\n                            this.mxpLines[tmp.index] = tmp;\n                    }\n                    if (this.mxpElements[e.name]) {\n                        //can only override if from same origin (eg from mud, or from local) or if an open tag\n                        if (this.mxpElements[e.name].remote === e.remote || this.mxpEntities[e.name].open)\n                            this.mxpElements[e.name] = e;\n                    }\n                    else\n                        this.mxpElements[e.name] = e;\n                    break;\n                case '!EN':\n                case '!ENTITY':\n                    e = new Entity(remote);\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'DESC':\n                                e.description = stripQuotes(arg[1]);\n                                break;\n                            case 'PRIVATE':\n                                e.publish = false;\n                                break;\n                            case 'PUBLISH':\n                                e.publish = true;\n                                break;\n                            case 'DELETE':\n                                //can only modify if from same origin, eg mud can only mod mud, and user can only mod user\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote)\n                                    delete this.mxpEntities[e.name];\n                                return null;\n                            case 'ADD':\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote) {\n                                    if (!this.mxpEntities[e.name].value)\n                                        this.mxpEntities[e.name].value = e.value;\n                                    else\n                                        this.mxpEntities[e.name].value += '|' + e.value;\n                                    return null;\n                                }\n                                break;\n                            case 'REMOVE':\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote) {\n                                    if (this.mxpEntities[e.name].value) {\n                                        sArgs = this.mxpEntities[e.name].value.split('|');\n                                        sArg = [];\n                                        for (s = 0, sl = sArgs.length; s < sl; s++) {\n                                            if (sArgs[s] !== e.value)\n                                                sArg.push(sArgs[s]);\n                                        }\n                                        this.mxpEntities[e.name].value = sArg.join('|');\n                                    }\n                                }\n                                return null;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.value = stripQuotes(args[x]);\n                                else if (x === 2)\n                                    e.description = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (this.mxpEntities[e.name]) {\n                        if (this.mxpEntities[e.name].remote === e.remote)\n                            this.mxpEntities[e.name] = e;\n                    }\n                    else\n                        this.mxpEntities[e.name] = e;\n                    break;\n                case '/V':\n                case '/VAR':\n                    tmp = this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    e = new Entity(remote);\n                    if (this.mxpState.captured.length > 0)\n                        e.value = this.mxpState.captured.pop().join('');\n                    else\n                        e.value = '';\n                    this.mxpState.capture--;\n                    if (this.enableDebug) this.emit('debug', 'MXP captured: ' + e.value);\n                    args = tmp.obj;\n                    xl = args.length;\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'DESC':\n                                e.description = stripQuotes(arg[1]);\n                                break;\n                            case 'PRIVATE':\n                                e.publish = false;\n                                break;\n                            case 'PUBLISH':\n                                e.publish = true;\n                                break;\n                            case 'DELETE':\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote)\n                                    delete this.mxpEntities[e.name];\n                                return null;\n                            case 'ADD':\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote) {\n                                    if (!this.mxpEntities[e.name].value)\n                                        this.mxpEntities[e.name].value = e.value;\n                                    else\n                                        this.mxpEntities[e.name].value += '|' + e.value;\n                                    return null;\n                                }\n                                break;\n                            case 'REMOVE':\n                                if (this.mxpEntities[e.name] && this.mxpEntities[e.name].remote === e.remote) {\n                                    if (this.mxpEntities[e.name].value) {\n                                        sArgs = this.mxpEntities[e.name].value.split('|');\n                                        sArg = [];\n                                        for (s = 0, sl = sArgs.length; s < sl; s++) {\n                                            if (sArgs[s] !== e.value)\n                                                sArg.push(sArgs[s]);\n                                        }\n                                        this.mxpEntities[e.name].value = sArg.join('|');\n                                    }\n                                }\n                                return null;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.description = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (this.mxpEntities[e.name]) {\n                        if (this.mxpEntities[e.name].remote === e.remote)\n                            this.mxpEntities[e.name] = e;\n                    }\n                    else\n                        this.mxpEntities[e.name] = e;\n                    break;\n                case 'V':\n                case 'VAR':\n                    this.mxpState.captured.push([]);\n                    this.mxpState.capture++;\n                    tmp = this.CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    tmp.obj = args;\n                    tmp.custom = '';\n                    this.mxpStyles.push(tmp);\n                    return null;\n                case 'GAUGE':\n                    e = { value: 0, max: 1, caption: '', color: 0 };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'VALUE':\n                                    tmp = parseFloat(this.GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this.GetEntity(arg[1]);\n                                    e.value = tmp;\n                                    break;\n                                case 'MAX':\n                                    tmp = parseFloat(this.GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this.GetEntity(arg[1]);\n                                    e.max = tmp;\n                                    break;\n                                case 'CAPTION':  //volume\n                                    if (arg[1].length > 0)\n                                        e.caption = stripQuotes(arg[1]);\n                                    break;\n                                case 'COLOR':  //repeat\n                                    color = new RGBColor(stripQuotes(arg[1]));\n                                    if (color.ok) e.color = color.toRGB();\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            tmp = parseFloat(this.GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this.GetEntity(args[x]);\n                            e.value = tmp;\n                        }\n                        else if (x === 1) {\n                            tmp = parseFloat(this.GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this.GetEntity(args[x]);\n                            e.max = tmp;\n                        }\n                        else if (x === 2 && args[x].length > 0)\n                            e.caption = stripQuotes(args[x]);\n                        else if (x === 3 && args[x].length > 0) {\n                            color = new RGBColor(stripQuotes(arg[1]));\n                            if (color.ok) e.color = color.toRGB();\n                        }\n                    }\n                    this.mxpState.expanded = false;\n                    this.emit('gauge', e);\n                    break;\n                case 'STAT':\n                    e = { value: 0, max: 1, caption: '' };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'VALUE':\n                                    tmp = parseFloat(this.GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this.GetEntity(arg[1]);\n                                    e.value = tmp;\n                                    break;\n                                case 'MAX':\n                                    tmp = parseFloat(this.GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this.GetEntity(arg[1]);\n                                    e.max = tmp;\n                                    break;\n                                case 'CAPTION':  //volume\n                                    if (arg[1].length > 0)\n                                        e.caption = stripQuotes(arg[1]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            tmp = parseFloat(this.GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this.GetEntity(args[x]);\n                            e.value = tmp;\n                        }\n                        else if (x === 1) {\n                            tmp = parseFloat(this.GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this.GetEntity(args[x]);\n                            e.max = tmp;\n                        }\n                        else if (x === 2 && args[x].length > 0)\n                            e.caption = stripQuotes(args[x]);\n                    }\n                    this.mxpState.expanded = false;\n                    this.emit('stat', e);\n                    break;\n                case 'MUSIC':\n                    e = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'FNAME':\n                                    e.file = stripQuotes(arg[1]);\n                                    if (e.file.toLowerCase() === 'off') {\n                                        e.off = true;\n                                        e.file = '';\n                                    }\n                                    break;\n                                case 'V':  //volume\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 100;\n                                    e.volume = tmp;\n                                    break;\n                                case 'L':  //repeat\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.repeat = tmp;\n                                    break;\n                                case 'C':  //continue\n                                    e.continue = arg[1] !== '0';\n                                    break;\n                                case 'T':  //type\n                                    if (arg[1].length > 0)\n                                        e.type = arg[1];\n                                    break;\n                                case 'U':  //url\n                                    e.url = stripQuotes(arg[1]);\n                                    if (!e.url.endsWith('/') && e.url.length > 0)\n                                        e.url += '/';\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            e.file = stripQuotes(args[x]);\n                            if (e.file.toLowerCase() === 'off') {\n                                e.off = true;\n                                e.file = '';\n                            }\n                        }\n                        else if (x === 1) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 100;\n                            e.volume = tmp;\n                        }\n                        else if (x === 2) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.repeat = tmp;\n                        }\n                        else if (x === 3)\n                            e.continue = args[x] !== '0';\n                        else if (x === 4) {\n                            if (args[x].length > 0)\n                                e.type = args[x];\n                        }\n                        else if (x === 5) {\n                            e.url = stripQuotes(args[x]);\n                            if (!e.url.endsWith('/') && e.url.length > 0)\n                                e.url += '/';\n                        }\n                    }\n                    this.emit('music', e);\n                    break;\n                case 'SOUND':\n                    e = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'FNAME':\n                                    e.file = stripQuotes(arg[1]);\n                                    if (e.file.toLowerCase() === 'off') {\n                                        e.off = true;\n                                        e.file = '';\n                                    }\n                                    break;\n                                case 'V':  //volume\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 100;\n                                    e.volume = tmp;\n                                    break;\n                                case 'L':  //repeat\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.repeat = tmp;\n                                    break;\n                                case 'P':  //priority\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.priority = tmp;\n                                    break;\n                                case 'T':  //type\n                                    if (arg[1].length > 0)\n                                        e.type = arg[1];\n                                    break;\n                                case 'U':  //url\n                                    e.url = stripQuotes(arg[1]);\n                                    if (!e.url.endsWith('/') && e.url.length > 0)\n                                        e.url += '/';\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            e.file = stripQuotes(args[x]);\n                            if (e.file.toLowerCase() === 'off') {\n                                e.off = true;\n                                e.file = '';\n                            }\n                        }\n                        else if (x === 1) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 100;\n                            e.volume = tmp;\n                        }\n                        else if (x === 2) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.repeat = tmp;\n                        }\n                        else if (x === 3) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.priority = tmp;\n                        }\n                        else if (x === 4) {\n                            if (args[x].length > 0)\n                                e.type = args[x];\n                        }\n                        else if (x === 5) {\n                            e.url = stripQuotes(args[x]);\n                            if (!e.url.endsWith('/') && e.url.length > 0)\n                                e.url += '/';\n                        }\n                    }\n                    this.emit('sound', e);\n                    break;\n                case 'EXPIRE':\n                    //emit expire event to handle old links\n                    this.emit('expire-links', args);\n                    //expire any links in the current line that match\n                    this.cleanMXPExpired(blocks, args?.[0] || '');\n                    break;\n                case 'VERSION':\n                    if (xl > 0)\n                        this.StyleVersion = args[0];\n                    else\n                        this.emit('MXP-tag-reply', tag, []);\n                    break;\n                case 'USER':\n                case 'PASSWORD':\n                    this.emit('MXP-tag-reply', tag, args);\n                    break;\n                case 'SUPPORT':\n                    sArgs = [];\n                    if (xl > 0) {\n                        for (x = 0; x < xl; x++) {\n                            arg = stripQuotes(args[x]);\n                            if (arg.indexOf('.') === -1) {\n                                arg = arg.toUpperCase();\n                                switch (arg) {\n                                    //TODO re-enable once font size/face  are supported\n                                    //case 'FONT':\n                                    case 'IMAGE':\n                                    case 'HR':\n                                    case 'A':\n                                    case 'SEND':\n                                    case 'B':\n                                    case 'I':\n                                    case 'COLOR':\n                                    case 'C':\n                                    case 'EM':\n                                    case 'ITALIC':\n                                    case 'STRONG':\n                                    case 'BOLD':\n                                    case 'UNDERLINE':\n                                    case 'U':\n                                    case 'S':\n                                    case 'STRIKEOUT':\n                                    case 'STRIKE':\n                                    case 'H':\n                                    case 'HIGH':\n                                    case 'EXPIRE':\n                                    case 'VERSION':\n                                    case 'SUPPORT':\n                                    case 'NOBR':\n                                    case 'P':\n                                    case 'BR':\n                                    case 'SBR':\n                                    case 'SOUND':\n                                    case 'MUSIC':\n                                    case 'VAR':\n                                    case 'USER':\n                                    case 'PASSWORD':\n                                    case 'H1':\n                                    case 'H2':\n                                    case 'H3':\n                                    case 'H4':\n                                    case 'H5':\n                                    case 'H6':\n                                    case 'RESET':\n                                    case 'GAUGE':\n                                    case 'STAT':\n                                        sArgs.push('+' + name);\n                                        break;\n                                    default:\n                                        sArgs.push('-' + name);\n                                        break;\n                                }\n                            }\n                            else {\n                                arg = args[x].split('.');\n                                arg[0] = arg[0].toUpperCase();\n                                switch (arg[0]) {\n                                    case 'IMAGE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+image.fname');\n                                            sArgs.push('+image.url');\n                                            sArgs.push('+image.t');\n                                            sArgs.push('+image.h');\n                                            sArgs.push('+image.w');\n                                            sArgs.push('+image.hspace');\n                                            sArgs.push('+image.vspace');\n                                            sArgs.push('+image.align');\n                                            sArgs.push('+image.ismap');\n                                        }\n                                        break;\n                                    case 'SOUND':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+sound.v');\n                                            sArgs.push('+sound.l');\n                                            sArgs.push('+sound.p');\n                                            sArgs.push('+sound.t');\n                                            sArgs.push('+sound.u');\n                                        }\n                                        break;\n                                    case 'MUSIC':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+music.v');\n                                            sArgs.push('+music.l');\n                                            sArgs.push('+music.c');\n                                            sArgs.push('+music.t');\n                                            sArgs.push('+music.u');\n                                        }\n                                        break;\n                                    case 'A':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+a.href');\n                                            sArgs.push('+a.hint');\n                                            sArgs.push('+a.expire');\n                                        }\n                                        break;\n                                    case 'SEND':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+send.href');\n                                            sArgs.push('+send.hint');\n                                            sArgs.push('+send.prompt');\n                                            sArgs.push('+send.expire');\n                                        }\n                                        break;\n                                    case 'COLOR':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+color.fore');\n                                            sArgs.push('+color.back');\n                                        }\n                                        break;\n                                    case 'C':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+c.fore');\n                                            sArgs.push('+c.back');\n                                        }\n                                        break;\n                                    case 'FONT':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            //TODO switch to + when face and size supported\n                                            sArgs.push('-font.face');\n                                            sArgs.push('-font.size');\n                                            sArgs.push('+font.color');\n                                            sArgs.push('+font.back');\n                                        }\n                                        break;\n                                    case 'EXPIRE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else\n                                            sArgs.push('+expire.Name');\n                                        break;\n                                    case 'GAUGE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+gauge.max');\n                                            sArgs.push('+gauge.caption');\n                                            sArgs.push('+gauge.color');\n                                        }\n                                        break;\n                                    case 'STAT':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+stat.max');\n                                            sArgs.push('+stat.caption');\n                                        }\n                                        break;\n                                    default:\n                                        if (arg[1] !== '*')\n                                            sArgs.push('-' + arg[0] + '.' + arg[1]);\n                                        else\n                                            sArgs.push('-' + arg[0]);\n                                        break;\n                                }\n                            }\n                        }\n                    }\n                    else\n                        //TODO enable font once font face/size are supported\n                        sArgs = ['+A', '+SEND', '+B', '+I', '+COLOR', '+C', '+EM', '+ITALIC', '+STRONG', '+BOLD', '+UNDERLINE', '+U', '+S', '+STRIKEOUT', '+H', '+HIGH', '-FONT', '+EXPIRE', '+VERSION', '+SUPPORT', '+NOBR', '+P', '+BR', '+SBR', '+VAR', '+SOUND', '+MUSIC', '+USER', '+PASSWORD', '+RESET', '+STRIKE', '+H1', '+H2', '+H3', '+H4', '+H5', '+H6', '+IMAGE', '+STAT', '+GAUGE'];\n                    this.emit('MXP-tag-reply', tag, sArgs);\n                    break;\n                case 'A':\n                    tmp = this.CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'HREF':\n                                    href = stripQuotes(arg[1]);\n                                    break;\n                                case 'HINT':\n                                    hint = stripQuotes(arg[1]);\n                                    break;\n                                case 'EXPIRE':\n                                    expire = stripQuotes(arg[1]);\n                                    break;\n                                default:\n                                    if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0)\n                            href = stripQuotes(args[x]);\n                        else if (x === 1)\n                            hint = stripQuotes(args[x]);\n                        else if (x === 2)\n                            expire = stripQuotes(args[x]);\n                    }\n                    tmp.custom = '';\n                    tmp.properties = {\n                        formatType: FormatType.MXPLink,\n                        href: href,\n                        hint: hint,\n                        expire: expire\n                    };\n                    this.mxpStyles.push(tmp);\n                    if (hint.length === 0)\n                        hint = href;\n                    return {\n                        format: {\n                            formatType: FormatType.MXPLink,\n                            href: href,\n                            hint: hint,\n                            expire: expire\n                        },\n                        text: null\n                    };\n                case 'SEND':\n                    tmp = this.CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg[0] === 'PROMPT')\n                            prompt = true;\n                        else if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'HREF':\n                                    href = stripQuotes(arg[1]);\n                                    break;\n                                case 'HINT':\n                                    hint = stripQuotes(arg[1]);\n                                    break;\n                                case 'EXPIRE':\n                                    expire = stripQuotes(arg[1]);\n                                    break;\n                                case 'PROMPT':\n                                    prompt = true;\n                                    break;\n                                default:\n                                    if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0)\n                            href = stripQuotes(args[x]);\n                        else if (x === 1)\n                            hint = stripQuotes(args[x]);\n                        else if (x === 2)\n                            prompt = true;\n                        else if (x === 3)\n                            expire = stripQuotes(args[x]);\n                    }\n                    tmp.custom = '';\n                    this.mxpStyles.push(tmp);\n                    if (href.length === 0)\n                        href = '&text;';\n                    if (hint.length === 0)\n                        hint = href;\n                    const cmds = href.split('|');\n                    let tt;\n                    if (cmds.length > 1) {\n                        const caps = hint.split('|');\n                        if (caps.length === cmds.length + 1) {\n                            hint = caps[0];\n                            caps.shift();\n                            tt = '[\\'' + caps.join('\\',\\'') + '\\']';\n                        }\n                        href = '[\\'' + cmds.join('\\',\\'') + '\\']';\n                    }\n                    else\n                        href = '\\'' + href + '\\'';\n                    tmp.properties = {\n                        formatType: FormatType.MXPSend,\n                        href: href,\n                        hint: hint,\n                        expire: expire,\n                        prompt: prompt,\n                        tt: tt || ''\n                    };\n                    return {\n                        format: {\n                            formatType: FormatType.MXPSend,\n                            href: href,\n                            hint: hint,\n                            expire: expire,\n                            prompt: prompt,\n                            tt: tt || ''\n                        },\n                        text: null\n                    };\n                case 'H1':\n                case 'H2':\n                case 'H3':\n                case 'H4':\n                case 'H5':\n                case 'H6':\n                    tmp = this.CloneCurrentStyle();\n                    tmp.open = true;\n                    tmp.tag = MXPTag[tag];\n                    tmp.style |= FontStyle.Bold;\n                    tmp.custom = '';\n                    this.mxpStyles.push(tmp);\n                    return null;\n                case '/A':\n                    this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return {\n                        format: {\n                            formatType: FormatType.MXPLinkEnd\n                        }, text: null\n                    };\n                case '/SEND':\n                    this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return {\n                        format: {\n                            formatType: FormatType.MXPSendEnd\n                        }, text: null\n                    };\n                case '/H1':\n                case '/H2':\n                case '/H3':\n                case '/H4':\n                case '/H5':\n                case '/H6':\n                    this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return null;\n                case 'NOBR':\n                    this.mxpState.noBreak = true;\n                    return null;\n                case '/P':\n                    this.ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    this.mxpState.paragraph = false;\n                    return null;\n                case 'P':\n                    tmp = this.CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    tmp.custom = '';\n                    this.mxpStyles.push(tmp);\n                    this.mxpState.paragraph = true;\n                    return null;\n                case 'SBR':\n                    return {\n                        format: null, text: ' \\u200B'\n                    };\n                case 'RESET':\n                    this.ResetMXP();\n                    return null;\n                case 'HR':\n                    const mxp: MXPStyle = this.GetCurrentStyle();\n                    const colors = this.getColors(mxp);\n                    return {\n                        format: {\n                            formatType: FormatType.Normal,\n                            offset: 0,\n                            color: colors.fore,\n                            background: colors.back,\n                            size: mxp.fontSize,\n                            font: mxp.font,\n                            style: mxp.style | (this._CurrentAttributes & ~FontStyle.Bold),\n                            hr: true\n                        }, text: null\n                    };\n            }\n        }\n        if (this.mxpElements[tag]) {\n            e = this.mxpElements[tag];\n            //not open and not in correct lineType\n            if (!e.open && this.mxpState.lineType !== lineType.Secure && this.mxpState.lineType !== lineType.LockSecure && this.mxpState.lineType !== lineType.TempSecure)\n                return null;\n            tmp = this.CloneCurrentStyle();\n            tmp.open = e.open;\n            tmp.tag = MXPTag.Custom;\n            tmp.custom = e.name;\n            arg = e.definition;\n            sArgs = {};\n            //setup default values\n            for (s = 0, sl = e.attributeIndexes.length; s < sl; s++)\n                sArgs[e.attributeIndexes[s]] = e.attributes[e.attributeIndexes[s]];\n            //change any based on passed argument\n            for (x = 0; x < xl; x++) {\n                sArg = args[x].split('=');\n                sArg[0] = sArg[0].toLowerCase();\n                if (e.attributes[sArg[0]])\n                    sArgs[sArg[0]] = sArg[1];\n                else if (x < e.attributeIndexes.length)\n                    sArgs[e.attributeIndexes[x]] = sArg[0];\n            }\n            for (sArg in sArgs) {\n                if (!sArgs.hasOwnProperty(sArg)) continue;\n                arg = arg.replace('&' + sArg + ';', sArgs[sArg]);\n            }\n            if (!e.empty) {\n                this.mxpState.captured.push([]);\n                this.mxpState.capture++;\n            }\n            //mxpState.hidden = e.hidden;\n            if (e.tag > 19 && e.tag < 100 && this.mxpLines[e.tag].enabled && this.mxpLines[e.tag].definition.length > 0) {\n                arg = this.mxpLines[e.tag].definition + arg;\n                tmp.gagged = this.mxpLines[e.tag].gag;\n            }\n            this.mxpState.gagged = tmp.gagged;\n            this.mxpState.expanded = true;\n            //this.mxpStyles.push(tmp);\n            return { format: null, text: arg };\n        }\n        else if (tag.startsWith('/') && this.mxpElements[tag.substring(1)] && !this.mxpElements[tag.substring(1)].empty) {\n            tag = tag.substring(1);\n            e = this.mxpElements[tag];\n\n            //not open and not in correct lineType\n            if (!e.open && this.mxpState.lineType !== lineType.Secure && this.mxpState.lineType !== lineType.LockSecure && this.mxpState.lineType !== lineType.TempSecure)\n                return null;\n\n            //get captured text\n            if (!e.empty && this.mxpState.capture > 0) {\n                if (this.mxpState.captured.length > 0)\n                    sArg = this.mxpState.captured.pop().join('');\n                this.mxpState.capture--;\n            }\n\n            //tmp = this.ClearMXPToTag(MXPTag.Custom, tag);\n            arg = e.closeDefinition;\n\n            if (e.flag.length > 0) {\n                if (e.flag.length > 4 && e.flag.toLowerCase().startsWith('set '))\n                    this.emit('set-variable', e.flag.substring(4), sArg);\n                this.emit('MXP-flag', e.flag, sArg);\n            }\n            if (e.tag > 19 && e.tag < 100 && this.mxpLines[e.tag].enabled && this.mxpLines[e.tag].closeDefinition.length > 0)\n                arg += this.mxpLines[e.tag].closeDefinition;\n            this.mxpState.gagged = !e.gagged;\n            if (e.empty)\n                return null;\n            this.mxpState.expanded = true;\n            return { format: null, text: arg };\n        }\n        if (this.showInvalidMXPTags) {\n            switch (tag) {\n                case 'IMAGE':\n                case '!AT':\n                case '!ATTLIST':\n                case '!TAG':\n                case '!EL':\n                case '!ELEMENT':\n                case '!EN':\n                case '!ENTITY':\n                case '/V':\n                case '/VAR':\n                case 'V':\n                case 'VAR':\n                case 'GAUGE':\n                case 'STAT':\n                case 'MUSIC':\n                case 'SOUND':\n                case 'EXPIRE':\n                case 'VERSION':\n                case 'USER':\n                case 'PASSWORD':\n                case 'SUPPORT':\n                case 'A':\n                case 'SEND':\n                case 'H1':\n                case 'H2':\n                case 'H3':\n                case 'H4':\n                case 'H5':\n                case 'H6':\n                case '/A':\n                case '/SEND':\n                case '/H1':\n                case '/H2':\n                case '/H3':\n                case '/H4':\n                case '/H5':\n                case '/H6':\n                case 'NOBR':\n                case '/P':\n                case 'P':\n                case 'SBR':\n                case 'RESET':\n                case 'HR':\n                    return null;\n\n            }\n            return { format: null, text: '<' + oTag + '>' };\n        }\n        return null;\n    }\n\n    private cleanMXPExpired(blocks, args) {\n        if (!blocks || blocks.length === 0 || args === null)\n            return;\n        const bl = blocks.length;\n        for (let b = 0; b < bl; b++) {\n            let format = blocks[b];\n            //not a link move on\n            if (format.formatType !== FormatType.MXPSend && format.formatType !== FormatType.MXPLink)\n                continue;\n            //only clean if no argument or matching expire\n            if (args.length === 0 || format.expire === args) {\n                let eType, n = 0, f = 0;\n                //store current type for nest testing\n                let type = format.formatType;\n                //get end tag format type\n                if (format.formatType === FormatType.MXPLink)\n                    eType = FormatType.MXPLinkEnd;\n                else\n                    eType = FormatType.MXPSendEnd;\n                //set link to expired\n                format.formatType = FormatType.MXPExpired;\n                //loop remaining tags looking for send tag, ignoring any nested tags\n                for (; f < bl; f++) {\n                    if (blocks[f].formatType === eType) {\n                        //not nested so end tag, set to be skipped\n                        if (n === 0) {\n                            blocks[f].formatType = FormatType.MXPSkip;\n                            break;\n                        }\n                        else\n                            n--;\n                    }\n                    else if (blocks[f] === type)\n                        n++;\n                }\n                //if did not find end tag, malformed MXP continue on\n            }\n        }\n    }\n\n    private GetCloseTags(tag) {\n        if (typeof tag === 'undefined' || tag.length === 0)\n            return '';\n        let idx = 0;\n        const tl = tag.length;\n        const ts = [];\n        let str = [];\n        let c;\n        let state = 0;\n        for (; idx < tl; idx++) {\n            c = tag.charAt(idx);\n            switch (state) {\n                case 1:\n                    if (c === ' ') {\n                        ts.push(str.join(''));\n                        str = [];\n                        state = 2;\n                    }\n                    else if (c === '>') {\n                        ts.push(str.join(''));\n                        str = [];\n                        state = 0;\n                    }\n                    else\n                        str.push(c);\n                    break;\n                case 2:\n                    //ignore every thing til a >\n                    if (c === '>')\n                        state = 0;\n                    break;\n                default:\n                    //only care about tags\n                    if (c === '<')\n                        state = 1;\n                    break;\n            }\n        }\n        if (state === 1)\n            ts.push(str.join(''));\n        if (ts.length === 0)\n            return '';\n        return '</' + ts.reverse().join('></') + '>';\n    }\n\n    private CloneCurrentStyle() {\n        let tmp: MXPStyle;\n        if (this.mxpStyles.length === 0)\n            this.mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n        tmp = this.mxpStyles[this.mxpStyles.length - 1];\n        if (this.mxpLines[this.mxpState.lineType] && this.mxpLines[this.mxpState.lineType].enabled)\n            tmp.gagged = this.mxpLines[this.mxpState.lineType].gag;\n        return <MXPStyle>Object.assign({}, tmp);\n    }\n\n    private GetCurrentStyle() {\n        let tmp: MXPStyle;\n        if (this.mxpStyles.length === 0)\n            this.mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n        tmp = this.mxpStyles[this.mxpStyles.length - 1];\n        if (this.mxpLines[this.mxpState.lineType] && this.mxpLines[this.mxpState.lineType].enabled)\n            tmp.gagged = this.mxpLines[this.mxpState.lineType].gag;\n        return tmp;\n    }\n\n    public DecreaseColor(clr, p) {\n        const color = new RGBColor(clr);\n        if (!color.ok) return clr;\n        color.b -= Math.ceil(color.b * p);\n        if (color.b < 0)\n            color.b = 0;\n        color.g -= Math.ceil(color.g * p);\n        if (color.g < 0)\n            color.g = 0;\n        color.r -= Math.ceil(color.r * p);\n        if (color.r < 0)\n            color.r = 0;\n        return color.toRGB();\n    }\n\n    public IncreaseColor(clr, p) {\n        const color = new RGBColor(clr);\n        if (!color.ok) return clr;\n        color.b += Math.ceil(color.b * p);\n        if (color.b > 255)\n            color.b = 255;\n        color.g += Math.ceil(color.g * p);\n        if (color.g > 255)\n            color.g = 255;\n        color.r += Math.ceil(color.r * p);\n        if (color.r > 255)\n            color.r = 255;\n        return color.toRGB();\n    }\n\n    private MXPCapture(str) {\n        if (this.mxpState.capture < 1) return;\n        const il = this.mxpState.captured.length;\n        for (let i = 0; i < il; i++)\n            this.mxpState.captured[i].push(str);\n    }\n\n    private MXPDeCapture(cnt) {\n        if (this.mxpState.capture < 1) return;\n        const il = this.mxpState.captured.length;\n        for (let i = 0; i < il; i++) {\n            for (let p = 0; p < cnt; p++)\n                this.mxpState.captured[i].pop();\n        }\n    }\n\n    private isNumber(str) {\n        return (/^\\d+$/).test(str);\n    }\n\n    /**\n     * CurrentAnsiCode - return an ansi formatted code based on current ansi state\n     *\n     * @returns {String}\n     */\n    public CurrentAnsiCode() {\n        let ansi = '\\x1b[';\n        if (typeof this._CurrentForeColor === 'string')\n            ansi += '38;2;' + this._CurrentForeColor;\n        else if (this._CurrentForeColor <= -16)\n            ansi += '38;5;' + (this._CurrentForeColor * -1 - 16) + ';';\n        else\n            ansi += this._CurrentForeColor + ';';\n        if (typeof this._CurrentBackColor === 'string')\n            ansi += '48;2;' + this._CurrentBackColor;\n        else if (this._CurrentBackColor <= -16)\n            ansi += '38;5;' + (this._CurrentBackColor * -1 - 16) + ';';\n        else\n            ansi += this._CurrentBackColor + ';';\n        if (this._CurrentAttributes > 0) {\n            if ((this._CurrentAttributes & FontStyle.Inverse) === FontStyle.Inverse)\n                ansi += '7;';\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold)\n                ansi += '1;';\n            if ((this._CurrentAttributes & FontStyle.Italic) === FontStyle.Italic)\n                ansi += '3;';\n            if ((this._CurrentAttributes & FontStyle.Underline) === FontStyle.Underline)\n                ansi += '4;';\n            if ((this._CurrentAttributes & FontStyle.Slow) === FontStyle.Slow)\n                ansi += '5;';\n            if ((this._CurrentAttributes & FontStyle.Rapid) === FontStyle.Rapid)\n                ansi += '6;';\n            if ((this._CurrentAttributes & FontStyle.Strikeout) === FontStyle.Strikeout)\n                ansi += '9;';\n            if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint)\n                ansi += '2;';\n            if ((this._CurrentAttributes & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline)\n                ansi += '21;';\n            if ((this._CurrentAttributes & FontStyle.Overline) === FontStyle.Overline)\n                ansi += '53;';\n        }\n        return ansi + 'm';\n    }\n\n    public get parseQueueLength() {\n        return this.parsing.length;\n    }\n\n    public get parseQueueEndOfLine() {\n        if (this.parsing.length)\n            return this.parsing[this.parsing.length - 1][0].endsWith('\\n');\n        return false;\n    }\n\n    public parse(text: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\n        if (text == null || text.length === 0)\n            return text;\n        if (remote == null) remote = false;\n        //query data in case already parsing\n        if (this.parsing.length > 0 && !force) {\n            this.parsing.push([text, remote, prependSplit]);\n            return;\n        }\n        let _TermTitle = '';\n        let _TermTitleType = null;\n        let _AnsiParams = null;\n        let stringBuilder = [];\n        let formatBuilder = [];\n        let rawBuilder = [];\n        let state: ParserState = ParserState.None;\n        let pState: ParserState = ParserState.None;\n        let lineLength = 0;\n        let iTmp;\n        let mOffset = 0;\n        let _MXPTag;\n        let _MXPOTag;\n        let _MXPEntity;\n        let _MXPComment;\n        let _MXPArgs;\n        let skip = false;\n        this.busy = true;\n        this.parsing.unshift([text, remote, prependSplit]);\n        let format;\n        if (this._SplitBuffer.length > 0) {\n            if (prependSplit)\n                text = text + this._SplitBuffer;\n            else\n                text = this._SplitBuffer + text;\n            this._SplitBuffer = '';\n        }\n        //not end of line but text, so fragment, re-get and re-parse to ensure proper triggering\n        if (!this.EndOfLine && (this.textLength > 0 || this.rawLength > 0)) {\n            let lines = this.display.lines;\n            if (lines.length > 0) {\n                iTmp = this.display.lines[lines.length - 1].text;\n                _MXPComment = this.display.lines[lines.length - 1].raw;\n                formatBuilder.push.apply(formatBuilder, this.display.lines[lines.length - 1].formats);\n                //remove line but do not change selection as line will be re-added back at the end\n                this.display.removeLine(lines.length - 1, true);\n                format = formatBuilder[formatBuilder.length - 1];\n                if (format.formatType === FormatType.Link) {\n                    formatBuilder.pop();\n                    format = formatBuilder[formatBuilder.length - 1];\n                }\n                format.width = 0;\n                format.height = 0;\n                format.marginWidth = 0;\n                format.marginHeight = 0;\n                lineLength = format.offset;\n                if (format.offset !== 0) {\n                    stringBuilder.push(iTmp.substring(0, format.offset));\n                    iTmp = iTmp.substring(format.offset);\n                    if (this.mxpState.locked || this.mxpState.on)\n                        mOffset = iTmp.length;\n                    text = iTmp + text;\n                }\n                else {\n                    if (this.mxpState.locked || this.mxpState.on)\n                        mOffset = iTmp.length;\n                    text = iTmp + text;\n                }\n                if (_MXPComment.endsWith(iTmp))\n                    rawBuilder.push(_MXPComment.substr(0, _MXPComment.length - iTmp.length));\n                else\n                    rawBuilder.push(_MXPComment);\n            }\n            else\n                formatBuilder.push(format = this.getFormatBlock(lineLength));\n            lines = null;\n        }\n        else\n            formatBuilder.push(format = this.getFormatBlock(lineLength));\n        let idx = 0;\n        let tl = text.length;\n        let c: string;\n        let i: number;\n        const e: boolean = this.emulateControlCodes;\n        const d: boolean = this.displayControlCodes;\n        const f: boolean = this.emulateTerminal;\n        const u: boolean = this.enableURLDetection;\n        const s: boolean = this.enableMSP;\n        const tabWidth: number = this.tabWidth;\n        let lnk = 0;\n        let fLnk = 0;\n        let lnkOffset = 0;\n        let lLnk = 0;\n        let lNest = null;\n        let p;\n        const pl = this.protocols.length;\n        try {\n            for (idx = 0; idx < tl; idx++) {\n                c = text.charAt(idx);\n                i = text.charCodeAt(idx);\n                if (idx >= mOffset)\n                    rawBuilder.push(c);\n                this.rawLength++;\n                switch (state) {\n                    case ParserState.AnsiParams:\n                        if (\n                            c === 'C' ||  //Move cursor # spaces\n                            c === 'K' || //Clear screen Left/Right\n                            c === 's' || //save cursor position: non-standard\n                            c === 'u' ||  //save cursor position: non-standard\n                            c === 'l' ||  //XTerm ?#l Private Mode Reset/Reset Mode #l\n                            c === 'h' ||  //XTerm ?#h Private Mode/Set Mode #h\n                            c === 'A' ||  //Move cursor up N lines\n                            c === 'B' ||  //Move cursor down N lines\n                            c === 'D' ||  //Move cursor left N spaces\n                            c === 'E' ||  //Moves cursor to beginning of the line n (default 1) lines down (next line).\n                            c === 'F' ||  //Moves cursor to beginning of the line n (default 1) lines up (previous line).\n                            c === 'f' ||  //Moves the cursor to row n, column m. Both default to 1 if omitted. Same as CUP\n                            c === 'G' ||  //Moves the cursor to column n.\n                            c === 'H' ||  //Moves the cursor to row n, column m. The values are 1-based, and default to 1 (top left corner) if omitted. A sequence such as CSI ;5H is a synonym for CSI 1;5H as well as CSI 17;H is the same as CSI 17H and CSI 17;1H\n                            c === 'n' ||  //Reports the cursor position to the application as (as though typed at the keyboard) ESC[n;mR, where n is the row and m is the column. (May not work on MS-DOS.)\n                            c === 'S' ||  //Scroll whole page up by n (default 1) lines. New lines are added at the bottom. (not ANSI.SYS)\n                            c === 'T' ||  //Scroll whole page down by n (default 1) lines. New lines are added at the top. (not ANSI.SYS)\n                            c === 'r'//SET SCROLLING REGION\n                        ) {\n                            this.ClearMXPOpen();\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'z') //mxp\n                        {\n                            //incase they put in a ; like e[1;z, e[1;7z or even e[;1z\n                            _MXPTag = _AnsiParams.split(';');\n                            //we only want the last valid #\n                            //start as 0 in cause invalid # or code\n                            _AnsiParams = 0;\n                            for (let mt = _MXPTag.length - 1; mt >= 0; mt--) {\n                                if (_MXPTag[mt].length > 0) {\n                                    _AnsiParams = _MXPTag[0];\n                                    break;\n                                }\n                            }\n                            iTmp = +_AnsiParams;\n                            if (isNaN(iTmp)) iTmp = 0;\n                            this.mxpState.on = true;\n                            this.mxpState.noBreak = false;\n                            this.mxpState.paragraph = false;\n                            if (this.mxpState.lineType === lineType.Open)\n                                this.ClearMXPOpen();\n                            switch (iTmp) {\n                                case 2:\n                                    this.mxpState.on = false;\n                                    this.mxpState.locked = false;\n                                    this.mxpState.lineType = lineType.Locked;\n                                    this.ClearMXPOpen();\n                                    break;\n                                case 3:\n                                    this.ResetMXP();\n                                    break;\n                                case 4:\n                                    this.mxpState.lineType = lineType.TempSecure;\n                                    if (idx + 1 >= tl) {\n                                        this._SplitBuffer += c;\n                                        break;\n                                    }\n                                    const ct = text.charAt(idx + 1);\n                                    if (ct !== '<') {\n                                        this.mxpState.lineType = lineType.Open;\n                                        this.mxpState.on = false;\n                                    }\n                                    this.mxpState.locked = false;\n                                    this.ClearMXPOpen();\n                                    break;\n                                case 5:\n                                    this.iMXPDefaultMode = lineType.Open;\n                                    this.mxpState.locked = true;\n                                    this.mxpState.lineType = lineType.LockOpen;\n                                    this.ClearMXPOpen();\n                                    break;\n                                case 6:\n                                    this.iMXPDefaultMode = lineType.Secure;\n                                    this.mxpState.lineType = lineType.LockSecure;\n                                    this.mxpState.locked = true;\n                                    this.ClearMXPOpen();\n                                    break;\n                                case 7:\n                                    this.iMXPDefaultMode = lineType.Locked;\n                                    this.mxpState.lineType = lineType.LockLocked;\n                                    this.mxpState.locked = true;\n                                    this.ClearMXPOpen();\n                                    break;\n                                default:\n                                    //invalid line so reset\n                                    if (iTmp < 0 || iTmp > 99)\n                                        this.ClearMXPOpen();\n                                    else {\n                                        this.mxpState.lineType = iTmp;\n                                        this.mxpState.locked = false;\n                                        //custom element linked to tag so expanded it into the line\n                                        if (this.mxpLines[this.mxpState.lineType] && this.mxpLines[this.mxpState.lineType].enabled) {\n                                            //strBuilder.push(EndDisplayBlock());\n                                            //strBuilder.push(StartDisplayBlock(lineLength));\n                                            iTmp = '';\n                                            if (this.mxpLines[this.mxpState.lineType].element.length > 0)\n                                                iTmp += '<' + this.mxpLines[this.mxpState.lineType].element + '>';\n                                            if (this.mxpLines[this.mxpState.lineType].definition.length > 0)\n                                                iTmp += this.mxpLines[this.mxpState.lineType].definition;\n                                            if (iTmp.length > 0) {\n                                                text = text.splice(idx + 1, iTmp);\n                                                tl = text.length;\n                                            }\n                                        }\n                                    }\n                                    break;\n                            }\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'J')  //Clear screen Up/Down\n                        {\n                            this.ClearMXPOpen();\n                            if (_AnsiParams.length > 0) {\n                                if (+_AnsiParams === 2) {\n                                    lineLength = 0;\n                                    iTmp = this.window.height;\n                                    formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                    this.AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                    stringBuilder = [];\n                                    rawBuilder = [];\n                                    formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength), ...this.getMXPCloseFormatBlocks()];\n                                    for (let j = 0; j < iTmp; j++) {\n                                        this.AddLine('', '\\n', false, false, formatBuilder, remote);\n                                        this.MXPCapture('\\n');\n                                    }\n                                    this.textLength += iTmp;\n                                    this.mxpState.noBreak = false;\n                                }\n                            }\n                            formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'm') {\n                            this.ProcessAnsiColorParams(_AnsiParams.split(';'));\n                            formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            //malformed code\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this.mxpState.on && c === '\\n')\n                                this.ClearMXPOpen();\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _AnsiParams += c;\n                        }\n                        break;\n                    case ParserState.XTermTitle:\n                        if (i === 7) {\n                            this._SplitBuffer = '';\n                            this.emit('set-title', _TermTitle, _TermTitleType == null ? 0 : _TermTitleType);\n                            _TermTitle = '';\n                            _TermTitleType = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === ';' && _TermTitleType == null) {\n                            _TermTitleType = +_TermTitle;\n                            if (isNaN(_TermTitleType))\n                                _TermTitleType = 0;\n                            _TermTitle = '';\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\x1b') {\n                            if (this._SplitBuffer.charAt(this._SplitBuffer.length - 1) === '\\n')\n                                this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _TermTitle += c;\n                        }\n                        break;\n                    case ParserState.Ansi:\n                        if (c === '[') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            _AnsiParams = '';\n                            state = ParserState.AnsiParams;\n                        }\n                        /*\n                        else if(c === ']')\n                        {\n                          _SplitBuffer = '';\n                          state = ParserState.None;\n                        }\n                        */\n                        else if (c === ']') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            _TermTitle = '';\n                            state = ParserState.XTermTitle;\n                        }\n                        //Unsupported VT100 so skip them\n                        else if (\n                            c === 'D' || //Index ( down one line, scroll if at bottom )\n                            c === 'E' || //Next line ( move to column 1 of next line, scroll up if at bottom )\n                            c === 'M' || //Reverse index\t( up one line, scroll down if at top )\n                            c === '1' || //Graphic proc. option ON\n                            c === '2' || //Graphic proc. option OFF\n                            c === '7' || //Save cursor & attributes\n                            c === '8' || //Restore cursor & attributes\n                            c === '>' || //Keypad mode\t\tNumeric\n                            c === '=' || //Keypad mode\t\tApplication\n                            /*\n                            *LINE SIZE COMMANDS\n                            *<ESC>#3 Change current line to double-height top half\n                            *<ESC>#4 Change current line to double-height bottom half\n                            *<ESC>#5 Change current line to single-width single-height (normal)\n                            *<ESC>#6 Change current line to double-width single-height\n                            */\n                            c === '#'\n                        ) {\n                            if (d) {\n                                stringBuilder.push('\\u241B');\n                                if (i < 16) {\n                                    stringBuilder.push(String.fromCharCode(parseInt('240' + i.toString(16), 16)));\n                                    this.MXPCapture('&#x241B&#x240' + i.toString(16) + ';');\n                                }\n                                else {\n                                    stringBuilder.push(String.fromCharCode(parseInt('24' + i.toString(16), 16)));\n                                    this.MXPCapture('&#x241B&#x24' + i.toString(16) + ';');\n                                }\n                                lineLength += 2;\n                                this.textLength += 2;\n                                this.mxpState.noBreak = false;\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        break;\n                    case ParserState.MXPTag:\n                        if (_MXPTag === '!--') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            pState = ParserState.None;\n                            state = ParserState.MXPComment;\n                            _MXPComment = '<!--';\n                            _MXPTag = '';\n                            _MXPArgs = [];\n                        }\n                        else if (_MXPTag.endsWith('<!--')) {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            pState = state;\n                            state = ParserState.MXPComment;\n                            _MXPComment = '<!--';\n                            _MXPTag = _MXPTag.substring(0, _MXPTag.length - 4);\n                            _MXPArgs = [];\n                        }\n                        else if (c === '\"') {\n                            state = ParserState.MXPTagDblQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\'') {\n                            state = ParserState.MXPTagQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '&') {\n                            _MXPEntity = '';\n                            pState = state;\n                            state = ParserState.MXPEntity;\n                            this._SplitBuffer = '';\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this.mxpState.on && c === '\\n')\n                                this.ClearMXPOpen();\n                        }\n                        else if (c === ' ') {\n                            state = ParserState.MXPTagArg;\n                            _MXPArgs.push('');\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '>') {\n                            _MXPOTag = _MXPTag;\n                            _MXPTag = _MXPTag.toUpperCase();\n                            if (_MXPTag === 'HR' && (this.mxpState.lineType === lineType.Secure || this.mxpState.lineType === lineType.LockSecure || this.mxpState.lineType === lineType.TempSecure)) {\n                                if (lineLength > 0) {\n                                    lineLength = 0;\n                                    this.MXPCapture('\\n');\n                                    formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                    this.AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                    stringBuilder = [];\n                                    rawBuilder = [];\n                                    formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                }\n                                //skip = text.charAt(idx + 1) === '\\n';\n                                _MXPTag = this.getMXPBlock(_MXPTag, [], remote);\n                                if (_MXPTag && _MXPTag.format) {\n                                    _MXPTag.format.offset = lineLength;\n                                    formatBuilder.push(_MXPTag.format);\n                                    formatBuilder[0].hr = _MXPTag.format.hr;\n                                }\n                                formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                this.AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                this.textLength++;\n                                stringBuilder = [];\n                                rawBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                            }\n                            else if (_MXPTag === 'BR' && (this.mxpState.lineType === lineType.Secure || this.mxpState.lineType === lineType.LockSecure || this.mxpState.lineType === lineType.TempSecure)) {\n                                this.MXPCapture('\\n');\n                                formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                this.AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                skip = false;\n                                lineLength = 0;\n                                stringBuilder = [];\n                                rawBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                this.textLength++;\n                            }\n                            else if (_MXPTag === 'IMAGE' && (this.mxpState.lineType === lineType.Secure || this.mxpState.lineType === lineType.LockSecure || this.mxpState.lineType === lineType.TempSecure)) {\n                                _MXPTag = this.getMXPBlock(_MXPTag, _MXPArgs, remote);\n                                if (_MXPTag && _MXPTag.format !== null) {\n                                    formatBuilder.push(_MXPTag.format);\n                                    lineLength += _MXPTag.length;\n                                    this.textLength += _MXPTag.length;\n                                }\n                                formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            }\n                            else {\n                                _MXPTag = this.getMXPBlock(_MXPTag, [], remote, _MXPOTag, formatBuilder);\n                                if (this.mxpState.expanded) {\n                                    if (_MXPTag && _MXPTag.text !== null) text = text.splice(idx + 1, _MXPTag.text);\n                                    tl = text.length;\n                                    this.mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    _MXPTag = '';\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                if (_MXPTag) {\n                                    if (_MXPTag.format) {\n                                        _MXPTag.format.offset = lineLength;\n                                        formatBuilder.push(_MXPTag.format);\n                                    }\n                                    formatBuilder.push(format = this.getFormatBlock(lineLength));\n                                    if (_MXPTag.text !== null && _MXPTag.text.length > 0) {\n                                        stringBuilder.push(_MXPTag.text);\n                                        lineLength += _MXPTag.text.length;\n                                        this.textLength += _MXPTag.text.length;\n                                    }\n                                }\n                                else\n                                    formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        //Malformed broken so just display it\n                        else if (c === '<') {\n                            if (this.enableDebug)\n                                this.emit('debug', 'Malformed MXP Tag: ' + _MXPTag);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            stringBuilder.push('<' + _MXPTag);\n                            lineLength += _MXPTag.length + 1;\n                            this.textLength += _MXPTag.length + 1;\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPTag += c;\n                        }\n                        break;\n                    case ParserState.MXPTagQuoted:\n                        if (c === '\\'') {\n                            state = ParserState.MXPTagArg;\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPTagDblQuoted:\n                        if (c === '\"') {\n                            state = ParserState.MXPTagArg;\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPTagArg:\n                        if (c === '\\'') {\n                            state = ParserState.MXPTagQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\"') {\n                            state = ParserState.MXPTagDblQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this.mxpState.on && c === '\\n')\n                                this.ClearMXPOpen();\n                        }\n                        else if (c === ' ') {\n                            state = ParserState.MXPTagArg;\n                            _MXPArgs.push('');\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '>') {\n                            if (_MXPTag.toUpperCase() === 'IMAGE' && (this.mxpState.lineType === lineType.Secure || this.mxpState.lineType === lineType.LockSecure || this.mxpState.lineType === lineType.TempSecure)) {\n                                _MXPTag = this.getMXPBlock(_MXPTag, _MXPArgs, remote, _MXPTag);\n                                if (_MXPTag !== null && _MXPTag.format !== null) {\n                                    _MXPTag.format.offset = lineLength;\n                                    formatBuilder.push(_MXPTag.format);\n                                }\n                                formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            }\n                            else {\n                                _MXPTag = this.getMXPBlock(_MXPTag, _MXPArgs, remote, _MXPTag, formatBuilder);\n                                if (this.mxpState.expanded) {\n                                    if (_MXPTag !== null) text = text.splice(idx + 1, _MXPTag.text);\n                                    tl = text.length;\n                                    this.mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                if (_MXPTag !== null) {\n                                    if (_MXPTag !== null && _MXPTag.format) {\n                                        _MXPTag.format.offset = lineLength;\n                                        formatBuilder.push(_MXPTag.format);\n                                    }\n                                    formatBuilder.push(format = this.getFormatBlock(lineLength));\n                                    if (_MXPTag.text !== null) {\n                                        stringBuilder.push(_MXPTag.text);\n                                        lineLength += _MXPTag.text.length;\n                                        this.textLength += _MXPTag.text.length;\n                                    }\n                                }\n                                else\n                                    formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPEntity:\n                        if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            if (this.enableDebug) this.emit('debug', 'MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState === ParserState.MXPTag) {\n                                _MXPTag += '&' + _MXPEntity;\n                                state = pState;\n                            }\n                            else {\n                                _MXPEntity = this.GetEntity(_MXPEntity);\n                                if (this.mxpState.expanded) {\n                                    if (_MXPTag !== null)\n                                        text = text.splice(idx + 1, _MXPEntity);\n                                    tl = text.length;\n                                    this.mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                _MXPOTag = htmlDecode('&' + _MXPEntity);\n                                stringBuilder.push(_MXPOTag);\n                                this.MXPCapture('&' + _MXPEntity);\n                                lineLength += _MXPOTag.length;\n                                this.textLength += _MXPOTag.length;\n                                this.mxpState.noBreak = false;\n                                //Abnormal end, send as is\n                                state = ParserState.None;\n                                this._SplitBuffer = '';\n                                format.unicode = true;\n                            }\n                            if (this.mxpState.on && c === '\\n')\n                                this.ClearMXPOpen();\n                        }\n                        else if (c === ';') {\n                            if (this.enableDebug) this.emit('debug', 'MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState !== ParserState.MXPTag) {\n                                _MXPEntity = this.GetEntity(_MXPEntity);\n                                if (this.mxpState.expanded) {\n                                    text = text.splice(idx + 1, _MXPEntity);\n                                    tl = text.length;\n                                    this.mxpState.expanded = false;\n                                    state = pState;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                _MXPOTag = htmlDecode('&' + _MXPEntity + ';');\n                                stringBuilder.push(_MXPOTag);\n                                this.MXPCapture('&');\n                                this.MXPCapture(_MXPEntity);\n                                this.MXPCapture(';');\n                                lineLength += _MXPOTag.length;\n                                this.textLength += _MXPOTag.length;\n                                this.mxpState.noBreak = false;\n                                this._SplitBuffer = '';\n                            }\n                            else\n                                _MXPTag += '&' + _MXPEntity + ';';\n                            format.unicode = true;\n                            state = pState;\n                        }\n                        //malformed entity\n                        else if (c === '&') {\n                            if (this.enableDebug) this.emit('debug', 'Malformed MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState !== ParserState.MXPTag) {\n                                stringBuilder.push('&' + _MXPEntity);\n                                this.MXPCapture('&');\n                                this.MXPCapture(_MXPEntity);\n                                lineLength += _MXPEntity.length + 1;\n                                this.textLength += _MXPEntity.length + 1;\n                                this.mxpState.noBreak = false;\n                                this._SplitBuffer = '';\n                                idx--;\n                                rawBuilder.pop();\n                                this.rawLength--;\n                            }\n                            else\n                                _MXPTag += '&' + _MXPEntity;\n                            format.unicode = true;\n                            state = pState;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPEntity += c;\n                        }\n                        break;\n                    case ParserState.MXPComment:\n                        if (_MXPComment.endsWith('-->')) {\n                            if (this.enableDebug) this.emit('debug', 'MXP Comment: ' + _MXPComment);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            state = pState;\n                            if (state === ParserState.None)\n                                this._SplitBuffer = '';\n                            _MXPComment = '';\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            if (this.enableDebug) this.emit('debug', 'MXP Comment: ' + _MXPComment);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            state = pState;\n                            _MXPComment = '';\n                            if (this.mxpState.on && c === '\\n')\n                                this.ClearMXPOpen();\n                        }\n                        else\n                            _MXPComment += c;\n                        break;\n                    case ParserState.URL:\n                        if (idx > lnk + 2) {\n                            stringBuilder.pop();\n                            stringBuilder.pop();\n                            rawBuilder.pop();\n                            rawBuilder.pop();\n                            this.rawLength -= 2;\n                            lineLength -= 2;\n                            this.textLength -= 2;\n                            this.MXPDeCapture(2);\n                            idx = lnk;\n                            state = ParserState.None;\n                        }\n                        else if (c === '/') {\n                            stringBuilder.push(c);\n                            this.MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            if (idx === lnk + 2) {\n                                state = ParserState.URLFound;\n                                //Found :// so valid url\n                                lnk = stringBuilder.length - 4;\n                                lLnk = stringBuilder.length - 1;\n                                fLnk = formatBuilder.length;\n                                lnkOffset -= 2;\n                                while (lnk > 0 && CharAllowedInURL(stringBuilder[lnk], true)) {\n                                    lnk--;\n                                    lnkOffset--;\n                                }\n                                if (!CharAllowedInURL(stringBuilder[lnk], true)) {\n                                    lnk++;\n                                    lnkOffset++;\n                                }\n                                lNest = [];\n                                if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                    lNest.push(')');\n                                if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                    lNest.push(']');\n                            }\n                        }\n                        else if (idx > lnk + 1) {\n                            stringBuilder.pop();\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            lineLength--;\n                            this.textLength--;\n                            this.MXPDeCapture(1);\n                            idx = lnk;\n                            state = ParserState.None;\n                        }\n                        else {\n                            idx = lnk;\n                            state = ParserState.None;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                        }\n                        break;\n                    case ParserState.URLFound:\n                        if (!CharAllowedInURL(c, false)) {\n                            if (lLnk !== stringBuilder.length - 1) {\n                                _MXPComment += stringBuilder.slice(lnk).join('');\n                                if (this.enableDebug) this.emit('debug', 'URL Found: ' + _MXPComment);\n                                formatBuilder.splice(fLnk, 0,\n                                    {\n                                        formatType: FormatType.Link,\n                                        offset: lnkOffset,\n                                        href: _MXPComment\n                                    });\n                                formatBuilder.push({\n                                    formatType: FormatType.LinkEnd,\n                                    offset: lineLength,\n                                    href: _MXPComment\n                                });\n                                formatBuilder.push(format = this.getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                        }\n                        else {\n                            if (lNest.length > 1 && lNest[lNest.length - 1] === c) {\n                                lNest.pop();\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length > 0 && c === '(') {\n                                lNest.push(')');\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length > 0 && c === '[') {\n                                lNest.push(']');\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length === 1 && lNest[lNest.length - 1] === c) {\n                                if (lLnk !== stringBuilder.length - 1) {\n                                    _MXPComment += stringBuilder.slice(lnk).join('');\n                                    if (this.enableDebug) this.emit('debug', 'URL Found: ' + _MXPComment);\n                                    formatBuilder.splice(fLnk, 0,\n                                        {\n                                            formatType: FormatType.Link,\n                                            href: _MXPComment,\n                                            offset: lnkOffset\n                                        });\n                                    formatBuilder.push({\n                                        formatType: FormatType.LinkEnd,\n                                        href: _MXPComment,\n                                        offset: lineLength\n                                    });\n                                    formatBuilder.push(format = this.getFormatBlock(lineLength));\n                                }\n                                state = ParserState.None;\n                                idx--;\n                                rawBuilder.pop();\n                                this.rawLength--;\n                            }\n                            else {\n                                if (i > 255)\n                                    format.unicode = true;\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                            }\n                        }\n                        break;\n                    case ParserState.MSPSound:\n                        if (c === ')') {\n                            lnk = this.mxpState.lineType;\n                            this.mxpState.lineType = lineType.TempSecure;\n                            this.getMXPBlock('SOUND', _MXPArgs, remote);\n                            this.mxpState.lineType = lnk;\n                            state = ParserState.None;\n                            if (idx + 1 < tl && text.charAt(idx + 1) === '\\n') {\n                                idx++;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                this.mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                            else if (idx + 2 < tl && text[idx + 1] === '\\r' && text[idx + 2] === '\\n') {\n                                idx += 2;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                this.mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                        }\n                        else if (c === ' ')\n                            _MXPArgs.push('');\n                        else\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        break;\n                    case ParserState.MSPMusic:\n                        if (c === ')') {\n                            lnk = this.mxpState.lineType;\n                            this.mxpState.lineType = lineType.TempSecure;\n                            this.getMXPBlock('MUSIC', _MXPArgs, remote);\n                            this.mxpState.lineType = lnk;\n                            state = ParserState.None;\n                            if (idx + 1 < tl && text.charAt(idx + 1) === '\\n') {\n                                idx++;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                this.mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                            else if (idx + 2 < tl && text[idx + 1] === '\\r' && text[idx + 2] === '\\n') {\n                                idx += 2;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                                this.mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                        }\n                        else if (c === ' ')\n                            _MXPArgs.push('');\n                        else\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        break;\n                    default:\n                        if (e && i === 7) {\n                            if (f) {\n                                c = '\\u2407';\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                this.mxpState.noBreak = false;\n                            }\n                            else if (d) {\n                                stringBuilder.push(c);\n                                this.MXPCapture('&#x2407;');\n                                lineLength++;\n                                this.textLength++;\n                                this.mxpState.noBreak = false;\n                            }\n                            this.emit('bell');\n                        }\n                        else if (e && c === '\\b') {\n                            skip = false;\n                            //if there are characters on the line\n                            if (lineLength > 0) {\n                                if (stringBuilder.length) {\n                                    //clean up empty ones\n                                    while (stringBuilder[stringBuilder.length - 1].length === 0)\n                                        stringBuilder.pop();\n                                    if (stringBuilder[stringBuilder.length - 1].length === 1)\n                                        stringBuilder.pop();\n                                    else\n                                        stringBuilder[stringBuilder.length - 1] = stringBuilder[stringBuilder.length - 1].substring(0, stringBuilder[stringBuilder.length - 1].length - 1);\n                                }\n                                if (format.offset === lineLength)\n                                    format.offset--;\n                                lineLength--;\n                                this.textLength--;\n                            }\n                            if (d) {\n                                c = '\\u25D8';\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                            }\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (e && c === '\\t') {\n                            const _Tab = tabWidth - lineLength % tabWidth;\n                            if (_Tab > 0) {\n                                stringBuilder.push(Array(_Tab + 1).join(' '));\n                                this.MXPCapture(Array(_Tab + 1).join(' '));\n                                lineLength += _Tab;\n                                this.textLength += _Tab;\n                                this.mxpState.noBreak = false;\n                            }\n                        }\n                        else if (c === '\\n') {\n                            if (this.mxpState.noBreak || this.mxpState.paragraph) continue;\n                            if (!this.mxpState.locked) {\n                                //notify client that a tag is over, allow for tagging the 10,11,12,19 tag types for auto mapper tagging/welcome test/custom tags\n                                if (this.mxpState.lineType !== lineType.Open)\n                                    this.emit('MXP-tag-end', this.mxpState.lineType, stringBuilder.join(''), formatBuilder);\n                                //custom element linked to tag so expanded it into the line\n                                if (!this.mxpState.lineExpanded && this.mxpLines[this.mxpState.lineType] && this.mxpLines[this.mxpState.lineType].enabled) {\n                                    iTmp = '';\n                                    if (this.mxpLines[this.mxpState.lineType].element.length > 0)\n                                        iTmp += '</' + this.mxpLines[this.mxpState.lineType].element + '>';\n                                    if (this.mxpLines[this.mxpState.lineType].closeDefinition.length > 0)\n                                        iTmp += this.mxpLines[this.mxpState.lineType].closeDefinition;\n                                    if (iTmp.length > 0) {\n                                        text = text.splice(idx, iTmp);\n                                        tl = text.length;\n                                        idx--;\n                                        rawBuilder.pop();\n                                        this.rawLength--;\n                                        this.mxpState.lineExpanded = true;\n                                        continue;\n                                    }\n                                }\n                                this.mxpState.lineExpanded = false;\n                                formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                if (this.mxpState.on)\n                                    this.ClearMXPOpen();\n                                this.mxpState.on = false;\n                                if (this.mxpLines[this.mxpState.lineType] && this.mxpLines[this.mxpState.lineType].enabled && this.mxpLines[this.mxpState.lineType].gag)\n                                    skip = true;\n                                this.mxpState.lineType = this.iMXPDefaultMode;\n                                if (this.mxpState.lineType !== 2 && !this.enableMXP)\n                                    this.ResetMXP();\n                            }\n                            else {\n                                formatBuilder.push(...this.getMXPCloseFormatBlocks());\n                                if (this.mxpState.on)\n                                    this.ClearMXPOpen();\n                            }\n                            lineLength = 0;\n                            if (!skip)\n                                this.MXPCapture('\\n');\n                            this.AddLine(stringBuilder.join(''), rawBuilder.join(''), false, skip, formatBuilder, remote);\n                            skip = false;\n                            stringBuilder = [];\n                            rawBuilder = [];\n                            formatBuilder = [...this.getMXPOpenFormatBlocks(), format = this.getFormatBlock(lineLength)];\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (e && c === '\\r') {\n                            continue;\n                            /*\n                            if (this.mxpState.noBreak || this.mxpState.paragraph) continue;\n                            if (!this.mxpState.locked) {\n                                if (this.mxpState.on)\n                                    this.ClearMXPOpen();\n                                this.mxpState.on = false;\n                                this.mxpState.lineType = lineType.Open;\n                            }\n                            continue;\n                            */\n                        }\n                        else if (e && c === '\\x1b') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            state = ParserState.Ansi;\n                        }\n                        else if (i < 32 || i === 127) {\n                            if (f) {\n                                if (i === 1)\n                                    c = '\\u263A';\n                                else if (i === 2)\n                                    c = '\\u263B';\n                                else if (i === 3)\n                                    c = '\\u2665';\n                                else if (i === 4)\n                                    c = '\\u2666';\n                                else if (i === 5)\n                                    c = '\\u2663';\n                                else if (i === 6)\n                                    c = '\\u2660';\n                                else if (i === 7)\n                                    c = '\\u2407';\n                                else if (i === 8)\n                                    c = '\\u25D8';\n                                else if (i === 9)\n                                    c = '\\u25CB';\n                                else if (i === 10)\n                                    c = '\\u25D9';\n                                else if (i === 11)\n                                    c = '\\u2642';\n                                else if (i === 12)\n                                    c = '\\u2640';\n                                else if (i === 13)\n                                    c = '\\u266A';\n                                else if (i === 14)\n                                    c = '\\u266B';\n                                else if (i === 15)\n                                    c = '\\u263C';\n                                else if (i === 16)\n                                    c = '\\u25BA';\n                                else if (i === 17)\n                                    c = '\\u25C4';\n                                else if (i === 18)\n                                    c = '\\u2195';\n                                else if (i === 19)\n                                    c = '\\u203C';\n                                else if (i === 20)\n                                    c = '\\u00B6';\n                                else if (i === 21)\n                                    c = '\\u00A7';\n                                else if (i === 22)\n                                    c = '\\u25AC';\n                                else if (i === 23)\n                                    c = '\\u21A8';\n                                else if (i === 24)\n                                    c = '\\u2191';\n                                else if (i === 25)\n                                    c = '\\u2193';\n                                else if (i === 26)\n                                    c = '\\u2192';\n                                else if (i === 27)\n                                    c = '\\u2190';\n                                else if (i === 28)\n                                    c = '\\u221F';\n                                else if (i === 29)\n                                    c = '\\u2194';\n                                else if (i === 30)\n                                    c = '\\u25B2';\n                                else if (i === 31)\n                                    c = '\\u25BC';\n                                else if (i === 127)\n                                    c = '\\u2302';\n                                stringBuilder.push(c);\n                                this.MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                this.mxpState.noBreak = false;\n                            }\n                            else if (d) {\n                                i = 9216 + i;\n                                stringBuilder.push(String.fromCharCode(i));\n                                this.MXPCapture('&#');\n                                this.MXPCapture(i.toString());\n                                this.MXPCapture(';');\n                                lineLength++;\n                                this.textLength++;\n                                this.mxpState.noBreak = false;\n                            }\n                            else\n                                continue;\n                        }\n                        else if (c === ' ' || (this._CurrentAttributes > 0 && (this._CurrentAttributes & FontStyle.Hidden) === FontStyle.Hidden)) {\n                            stringBuilder.push(' ');\n                            this.MXPCapture(' ');\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (c === '<' && idx >= mOffset) {\n                            if (this.enableMXP && this.mxpState.on) {\n                                _MXPTag = '';\n                                _MXPArgs = [];\n                                this._SplitBuffer += c;  //store in split buffer incase split command\n                                state = ParserState.MXPTag;\n                            }\n                            else {\n                                stringBuilder.push('<');\n                                this.MXPCapture('&lt;');\n                                lineLength++;\n                                this.textLength++;\n                            }\n                        }\n                        else if (c === '>') {\n                            stringBuilder.push('>');\n                            this.MXPCapture('&gt;');\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (c === '&' && idx >= mOffset) {\n                            if (this.enableMXP && this.mxpState.on) {\n                                _MXPEntity = '';\n                                this._SplitBuffer += c;  //store in split buffer incase split command\n                                pState = state;\n                                state = ParserState.MXPEntity;\n                            }\n                            else {\n                                stringBuilder.push(c);\n                                lineLength++;\n                                this.textLength++;\n                                this.mxpState.noBreak = false;\n                            }\n                        }\n                        else if (c === '\"') {\n                            stringBuilder.push(c);\n                            this.MXPCapture('&quot;');\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (c === '\\'') {\n                            stringBuilder.push(c);\n                            this.MXPCapture('&apos;');\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (c === ':') {\n                            stringBuilder.push(c);\n                            this.MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                            if (u) {\n                                _MXPComment = '';\n                                let psk;\n                                let pFnd = false;\n                                for (p = 0; p < pl; p++) {\n                                    if (idx - this.protocols[p].length < 0)\n                                        continue;\n                                    psk = false;\n                                    const nl = this.protocols[p].length;\n                                    for (let n = 0; n < nl; n++) {\n                                        if (text[idx - (nl - n)] !== this.protocols[p][n]) {\n                                            psk = true;\n                                            break;\n                                        }\n                                    }\n                                    if (psk)\n                                        continue;\n                                    lnk = stringBuilder.length;\n                                    lnkOffset = lineLength;\n                                    fLnk = formatBuilder.length;\n                                    if (lnk > 1 + nl && stringBuilder[lnk - (2 + nl)].length === 1 && /\\S/.test(stringBuilder[lnk - (2 + nl)]) && stringBuilder[lnk - (2 + nl)] !== '(' && stringBuilder[lnk - (2 + nl)] !== '[')\n                                        continue;\n                                    lNest = [];\n                                    lnk = stringBuilder.length - (1 + nl);\n                                    lnkOffset -= (1 + nl);\n                                    lLnk = stringBuilder.length - 1;\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                        lNest.push(')');\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                        lNest.push(']');\n                                    state = ParserState.URLFound;\n                                    pFnd = true;\n                                    if (pFnd)\n                                        break;\n                                }\n                                if (!pFnd) {\n                                    state = ParserState.URL;\n                                    lnk = idx;\n                                    lnkOffset = lineLength;\n                                }\n                            }\n                        }\n                        else if (c === '.') {\n                            stringBuilder.push(c);\n                            this.MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                            if (u && idx - 3 >= 0) {\n                                _MXPComment = 'http://';\n                                if ((text[idx - 1] === 'w' || idx[lnk - 1] === 'W') &&\n                                    (text[idx - 2] === 'w' || idx[lnk - 2] === 'W') &&\n                                    (text[idx - 3] === 'w' || idx[lnk - 3] === 'W')\n                                ) {\n                                    lnk = stringBuilder.length;\n                                    lnkOffset = lineLength;\n                                    fLnk = formatBuilder.length;\n                                    if (lnk > 4 && stringBuilder[lnk - 5].length === 1 && /\\S/.test(stringBuilder[lnk - 5]) && stringBuilder[lnk - 5] !== '(' && stringBuilder[lnk - 5] !== '[')\n                                        continue;\n                                    lNest = [];\n                                    lnk = stringBuilder.length - 4;\n                                    lnkOffset -= 4;\n                                    lLnk = stringBuilder.length - 1;\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                        lNest.push(')');\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                        lNest.push(']');\n                                    state = ParserState.URLFound;\n                                }\n                            }\n                        }\n                        else if (s && lineLength === 0 && text.substring(idx, idx + 8) === '!!MUSIC(') {\n                            _MXPArgs = [''];\n                            state = ParserState.MSPMusic;\n                            idx += 7;\n                            this.mxpState.noBreak = false;\n                        }\n                        else if (s && lineLength === 0 && text.substring(idx, idx + 8) === '!!SOUND(') {\n                            _MXPArgs = [''];\n                            state = ParserState.MSPSound;\n                            idx += 7;\n                            this.mxpState.noBreak = false;\n                        }\n                        else {\n                            if (f && i > 127 && i < 255) {\n                                if (i === 128)\n                                    c = '\\u00C7';\n                                else if (i === 129)\n                                    c = '\\u00FC';\n                                else if (i === 130)\n                                    c = '\\u00E9';\n                                else if (i === 131)\n                                    c = '\\u00E2';\n                                else if (i === 132)\n                                    c = '\\u00E4';\n                                else if (i === 133)\n                                    c = '\\u00E0';\n                                else if (i === 134)\n                                    c = '\\u00E5';\n                                else if (i === 135)\n                                    c = '\\u00E7';\n                                else if (i === 136)\n                                    c = '\\u00EA';\n                                else if (i === 137)\n                                    c = '\\u00EB';\n                                else if (i === 138)\n                                    c = '\\u00E8';\n                                else if (i === 139)\n                                    c = '\\u00EF';\n                                else if (i === 140)\n                                    c = '\\u00EE';\n                                else if (i === 141)\n                                    c = '\\u00EC';\n                                else if (i === 142)\n                                    c = '\\u00C4';\n                                else if (i === 143)\n                                    c = '\\u00C5';\n                                else if (i === 144)\n                                    c = '\\u00C9';\n                                else if (i === 145)\n                                    c = '\\u00E6';\n                                else if (i === 146)\n                                    c = '\\u00C6';\n                                else if (i === 147)\n                                    c = '\\u00F4';\n                                else if (i === 148)\n                                    c = '\\u00F6';\n                                else if (i === 149)\n                                    c = '\\u00F2';\n                                else if (i === 150)\n                                    c = '\\u00FB';\n                                else if (i === 151)\n                                    c = '\\u00F9';\n                                else if (i === 152)\n                                    c = '\\u00FF';\n                                else if (i === 153)\n                                    c = '\\u00D6';\n                                else if (i === 154)\n                                    c = '\\u00DC';\n                                else if (i === 155)\n                                    c = '\\u00A2';\n                                else if (i === 156)\n                                    c = '\\u00A3';\n                                else if (i === 157)\n                                    c = '\\u00A5';\n                                else if (i === 158)\n                                    c = '\\u20A7';\n                                else if (i === 159)\n                                    c = '\\u0192';\n                                else if (i === 160)\n                                    c = '\\u00E1';\n                                else if (i === 161)\n                                    c = '\\u00ED';\n                                else if (i === 162)\n                                    c = '\\u00F3';\n                                else if (i === 163)\n                                    c = '\\u00FA';\n                                else if (i === 164)\n                                    c = '\\u00F1';\n                                else if (i === 165)\n                                    c = '\\u00D1';\n                                else if (i === 166)\n                                    c = '\\u00AA';\n                                else if (i === 167)\n                                    c = '\\u00BA';\n                                else if (i === 168)\n                                    c = '\\u00BF';\n                                else if (i === 169)\n                                    c = '\\u2310';\n                                else if (i === 170)\n                                    c = '\\u00AC';\n                                else if (i === 171)\n                                    c = '\\u00BD';\n                                else if (i === 172)\n                                    c = '\\u00BC';\n                                else if (i === 173)\n                                    c = '\\u00A1';\n                                else if (i === 174)\n                                    c = '\\u00AB';\n                                else if (i === 175)\n                                    c = '\\u00BB';\n                                else if (i === 176)\n                                    c = '\\u2591';\n                                else if (i === 177)\n                                    c = '\\u2592';\n                                else if (i === 178)\n                                    c = '\\u2593';\n                                else if (i === 179)\n                                    c = '\\u2502';\n                                else if (i === 180)\n                                    c = '\\u2524';\n                                else if (i === 181)\n                                    c = '\\u2561';\n                                else if (i === 182)\n                                    c = '\\u2562';\n                                else if (i === 183)\n                                    c = '\\u2556';\n                                else if (i === 184)\n                                    c = '\\u2555';\n                                else if (i === 185)\n                                    c = '\\u2563';\n                                else if (i === 186)\n                                    c = '\\u2551';\n                                else if (i === 187)\n                                    c = '\\u2557';\n                                else if (i === 188)\n                                    c = '\\u255D';\n                                else if (i === 189)\n                                    c = '\\u255C';\n                                else if (i === 190)\n                                    c = '\\u255B';\n                                else if (i === 191)\n                                    c = '\\u2510';\n                                else if (i === 192)\n                                    c = '\\u2514';\n                                else if (i === 193)\n                                    c = '\\u2534';\n                                else if (i === 194)\n                                    c = '\\u252C';\n                                else if (i === 195)\n                                    c = '\\u251C';\n                                else if (i === 196)\n                                    c = '\\u2500';\n                                else if (i === 197)\n                                    c = '\\u253C';\n                                else if (i === 198)\n                                    c = '\\u255E';\n                                else if (i === 199)\n                                    c = '\\u255F';\n                                else if (i === 200)\n                                    c = '\\u255A';\n                                else if (i === 201)\n                                    c = '\\u2554';\n                                else if (i === 202)\n                                    c = '\\u2569';\n                                else if (i === 203)\n                                    c = '\\u2566';\n                                else if (i === 204)\n                                    c = '\\u2560';\n                                else if (i === 205)\n                                    c = '\\u2550';\n                                else if (i === 206)\n                                    c = '\\u256C';\n                                else if (i === 207)\n                                    c = '\\u2567';\n                                else if (i === 208)\n                                    c = '\\u2568';\n                                else if (i === 209)\n                                    c = '\\u2564';\n                                else if (i === 210)\n                                    c = '\\u2565';\n                                else if (i === 211)\n                                    c = '\\u2559';\n                                else if (i === 212)\n                                    c = '\\u2558';\n                                else if (i === 213)\n                                    c = '\\u2552';\n                                else if (i === 214)\n                                    c = '\\u2553';\n                                else if (i === 215)\n                                    c = '\\u256B';\n                                else if (i === 216)\n                                    c = '\\u256A';\n                                else if (i === 217)\n                                    c = '\\u2518';\n                                else if (i === 218)\n                                    c = '\\u250C';\n                                else if (i === 219)\n                                    c = '\\u2588';\n                                else if (i === 220)\n                                    c = '\\u2584';\n                                else if (i === 221)\n                                    c = '\\u258C';\n                                else if (i === 222)\n                                    c = '\\u2590';\n                                else if (i === 223)\n                                    c = '\\u2580';\n                                else if (i === 224)\n                                    c = '\\u03B1';\n                                else if (i === 225)\n                                    c = '\\u03B2';\n                                else if (i === 226)\n                                    c = '\\u0393';\n                                else if (i === 227)\n                                    c = '\\u03C0';\n                                else if (i === 228)\n                                    c = '\\u03A3';\n                                else if (i === 229)\n                                    c = '\\u03C3';\n                                else if (i === 230)\n                                    c = '\\u00B5';\n                                else if (i === 231)\n                                    c = '\\u03C4';\n                                else if (i === 232)\n                                    c = '\\u03A6';\n                                else if (i === 233)\n                                    c = '\\u0398';\n                                else if (i === 234)\n                                    c = '\\u03A9';\n                                else if (i === 235)\n                                    c = '\\u03B4';\n                                else if (i === 236)\n                                    c = '\\u221E';\n                                else if (i === 237)\n                                    c = '\\u2205';\n                                else if (i === 238)\n                                    c = '\\u2208';\n                                else if (i === 239)\n                                    c = '\\u2229';\n                                else if (i === 240)\n                                    c = '\\u2261';\n                                else if (i === 241)\n                                    c = '\\u00B1';\n                                else if (i === 242)\n                                    c = '\\u2265';\n                                else if (i === 243)\n                                    c = '\\u2264';\n                                else if (i === 244)\n                                    c = '\\u2320';\n                                else if (i === 245)\n                                    c = '\\u2321';\n                                else if (i === 246)\n                                    c = '\\u00F7';\n                                else if (i === 247)\n                                    c = '\\u2248';\n                                else if (i === 248)\n                                    c = '\\u00B0';\n                                else if (i === 249)\n                                    c = '\\u2219';\n                                else if (i === 250)\n                                    c = '\\u00B7';\n                                else if (i === 251)\n                                    c = '\\u221A';\n                                else if (i === 252)\n                                    c = '\\u207F';\n                                else if (i === 253)\n                                    c = '\\u00B2';\n                                else if (i === 254)\n                                    c = '\\u25A0';\n                            }\n                            else if (i > 255)\n                                format.unicode = true;\n                            stringBuilder.push(c);\n                            this.MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this.mxpState.noBreak = false;\n                        }\n                        break;\n                }\n            }\n            if (this._SplitBuffer.length) {\n                this.rawLength -= this._SplitBuffer.length;\n                rawBuilder.splice(rawBuilder.length - this._SplitBuffer.length, this._SplitBuffer.length);\n            }\n            formatBuilder.push(...this.getMXPCloseFormatBlocks());\n            if (state === ParserState.URLFound) {\n                formatBuilder.splice(fLnk, 0,\n                    {\n                        formatType: FormatType.Link,\n                        offset: lnkOffset,\n                        href: _MXPComment += stringBuilder.slice(lnk).join('')\n                    });\n            }\n            this.AddLine(stringBuilder.join(''), rawBuilder.join(''), true, false, formatBuilder, remote);\n        }\n        catch (ex) {\n            if (this.enableDebug) this.emit('debug', ex);\n        }\n        this.busy = false;\n        this.emit('parse-done');\n        this.parsing.shift();\n        if (this.parsing.length > 0)\n            setTimeout(this.parseNext(), 0);\n    }\n\n    private parseNext() {\n        const iTmp = this.parsing.shift();\n        return () => { this.parse(iTmp[0], iTmp[1], true, iTmp[2]); };\n    }\n\n    public updateWindow(width, height) {\n        this.window = { width: width, height: height };\n    }\n\n    public Clear() {\n        this.ResetColors();\n        this.textLength = 0;\n        this._SplitBuffer = '';\n    }\n\n    public ClearMXP() {\n        this.mxpEntities = {};\n        this.ResetMXP();\n        this.mxpElements = {};\n        this.mxpState = new MXPState();\n    }\n\n    public ResetMXP() {\n        this.mxpStyles = [];\n        this.mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n    }\n\n    public ResetMXPLine() {\n        this.iMXPDefaultMode = lineType.Open;\n        this.mxpState.lineType = lineType.Open;\n    }\n\n    //public interface, as client can only access publicly marked entities\n    public GetPublicEntity(entity) {\n        if (this.mxpEntities[entity] && this.mxpEntities[entity].publish)\n            return this.mxpEntities[entity].value;\n        return entity;\n    }\n\n}", "import { EventEmitter } from \"./events\";\r\nimport { Parser } from \"./parser\";\r\nimport { Size, DisplayOptions, ParserLine, FormatType, FontStyle, Point } from \"./types\";\r\nimport { htmlEncode, formatUnit, getScrollbarWidth, debounce } from './library';\r\n\r\ndeclare let moment;\r\n\r\n/**\r\n * Contains parsed line data\r\n */\r\ninterface LineData {\r\n    text: string;       //the line text\r\n    formats: any[];     //the line formatting data\r\n    raw: string;        //the raw line data including all ansi codes\r\n    id: number;         //unique id for line\r\n    timestamp: number;  //timestamp the line was added\r\n}\r\n\r\nexport enum UpdateType {\r\n    none = 0,\r\n    update = 1 << 0,\r\n    display = 1 << 1,\r\n    trim = 1 << 2,\r\n    scrollEnd = 1 << 3,\r\n    updateWindow = 1 << 4,\r\n    rebuildLines = 1 << 5\r\n}\r\n\r\nexport enum TimeStampStyle {\r\n    None = 0,\r\n    Simple = 1,\r\n    Format = 2\r\n}\r\n\r\nexport class Display extends EventEmitter {\r\n    //#region Private properties\r\n    private _model: DisplayModel;\r\n    private _container: HTMLElement;\r\n    private _view: HTMLElement;\r\n    private _updating: UpdateType = UpdateType.none;\r\n    private _enableDebug: boolean = false;\r\n    private _character: HTMLElement;\r\n    private _charHeight: number;\r\n    private _charWidth: number;\r\n    private _innerHeight;\r\n    private _maxView: number = 0;\r\n    private _padding = [0, 0, 0, 0];\r\n    private _enableColors: boolean = true;\r\n    private _enableBackgroundColors: boolean = true;\r\n    private _hideTrailingEmptyLine = true;\r\n    private _styles: HTMLStyleElement;\r\n    private _maxLines: number = 500;\r\n    private _wordWrap = false;\r\n    private _indent: number = 4;\r\n    private _indentPadding: number = 0;\r\n    private _wrapAt: number = 0;\r\n\r\n    private _linkFunction;\r\n    private _mxpLinkFunction;\r\n    private _mxpSendFunction;\r\n    private _mxpTooltipFunction;\r\n    private _scrollAtEnd = false;\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    private _wResize;\r\n    private _selection;\r\n\r\n    private _lineCache: string[] = [];\r\n    private _expireCache: number[] = [];\r\n\r\n    private _timestamp: TimeStampStyle = TimeStampStyle.None;\r\n    private _timestampFormat: string = '[[]MM-DD HH:mm:ss.SSS[]] ';\r\n    private _timestampWidth: number = new Date().toISOString().length + 1;\r\n    private _mouseDown = false;\r\n    //#endregion\r\n    //#region Public properties\r\n    public scrollLock: boolean = false;\r\n\r\n    get showTimestamp() { return this._timestamp; }\r\n    set showTimestamp(value: TimeStampStyle) {\r\n        if (value === this._timestamp) return;\r\n        this._timestamp = value;\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this.buildStyleSheet();\r\n        this.doUpdate(UpdateType.display | UpdateType.update | UpdateType.rebuildLines);\r\n    }\r\n\r\n    get timestampFormat() { return this._timestampFormat; }\r\n    set timestampFormat(value: string) {\r\n        if (this._timestampFormat === value) return;\r\n        this._timestampFormat = value;\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this.doUpdate(UpdateType.display | UpdateType.rebuildLines | UpdateType.updateWindow | UpdateType.update);\r\n    }\r\n    z\r\n    get wordWrap(): boolean {\r\n        return this._wordWrap;\r\n    }\r\n\r\n    set wordWrap(value: boolean) {\r\n        if (value === this._wordWrap) return;\r\n        this._wordWrap = value;\r\n        this.buildStyleSheet();\r\n        this.doUpdate(UpdateType.update);\r\n    }\r\n\r\n    get wrapAt() { return this._wrapAt; }\r\n    set wrapAt(value: number) {\r\n        if (value === this._wrapAt) return;\r\n        this._wrapAt = value;\r\n        this.buildStyleSheet();\r\n        this.doUpdate(UpdateType.update | UpdateType.display);\r\n    }\r\n\r\n    get indent() { return this._indent; }\r\n    set indent(value: number) {\r\n        if (value === this._indent)\r\n            return;\r\n        this._indent = value;\r\n        this.buildStyleSheet();\r\n        this.doUpdate(UpdateType.update | UpdateType.display);\r\n    }\r\n\r\n    get linkFunction(): string {\r\n        return this._linkFunction || 'doLink';\r\n    }\r\n\r\n    set linkFunction(val: string) {\r\n        this._linkFunction = val;\r\n    }\r\n\r\n    get mxpLinkFunction(): string {\r\n        return this._mxpLinkFunction || 'doMXPLink';\r\n    }\r\n\r\n    set mxpLinkFunction(val: string) {\r\n        this._mxpLinkFunction = val;\r\n    }\r\n\r\n    get mxpSendFunction(): string {\r\n        return this._mxpSendFunction || 'doMXPSend';\r\n    }\r\n\r\n    set mxpSendFunction(val: string) {\r\n        this._mxpSendFunction = val;\r\n    }\r\n\r\n    get mxpTooltipFunction(): string {\r\n        return this._mxpTooltipFunction || 'doMXPTooltip';\r\n    }\r\n\r\n    set mxpTooltipFunction(val: string) {\r\n        this._mxpTooltipFunction = val;\r\n    }\r\n\r\n    get id() {\r\n        if (this._container) return this._container.id;\r\n        return '';\r\n    }\r\n\r\n    get container(): HTMLElement {\r\n        return this._container;\r\n    }\r\n\r\n    get lines(): LineData[] {\r\n        return this._model.lines;\r\n    }\r\n\r\n    get model() { return this._model; }\r\n    set model(value: DisplayModel) {\r\n        if (this._model === value) return;\r\n        //if model set remove all listeners\r\n        if (this._model)\r\n            this._model.removeAllListeners();\r\n        //set model and assign all the events needed\r\n        this._model = value;\r\n        this._model.on('debug', this.debug, this);\r\n        this._model.on('bell', () => { this.emit('bell'); });\r\n        this._model.on('add-line', data => { this.emit('add-line', data); });\r\n        this._model.on('add-line-done', data => { this.emit('add-line-done', data); });\r\n        this._model.on('line-added', (data, noUpdate) => {\r\n            this._lineCache.push(this.getLineHTML(data.idx));\r\n        });\r\n        this._model.on('expire-links', args => {\r\n            if (this._expireCache.length) {\r\n                for (let x = 0, xl = this._expireCache.length; x < xl; x++)\r\n                    this.rebuildLine(this._expireCache[x]);\r\n            }\r\n            this._expireCache = [];\r\n            this.emit('expire-links');\r\n        });\r\n        this._model.on('parse-done', () => {\r\n            this._view.insertAdjacentHTML('beforeend', this._lineCache.join(''));\r\n            this._lineCache = [];\r\n            this.doUpdate(UpdateType.display);\r\n            this.emit('parse-done');\r\n        });\r\n\r\n        this._model.on('set-title', (title, type) => {\r\n            this.emit('set-title', title, type);\r\n        });\r\n        this._model.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this._model.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this._model.on('MXP-tag-reply', (tag, args) => {\r\n            this.emit('MXP-tag-reply', tag, args);\r\n        });\r\n\r\n        this._model.on('expire-link-line', idx => {\r\n            this._expireCache.push(idx);\r\n            this.doUpdate(UpdateType.display);\r\n        });\r\n    }\r\n\r\n    get maxLines(): number { return this._maxLines; }\r\n    set maxLines(value: number) {\r\n        if (value !== this._maxLines) {\r\n            this._maxLines = value;\r\n            this.doUpdate(UpdateType.trim);\r\n        }\r\n    }\r\n\r\n    get enableDebug(): boolean {\r\n        return this._enableDebug;\r\n    }\r\n\r\n    get enableColors() { return this._enableColors; }\r\n    set enableColors(value) {\r\n        if (value === this._enableColors) return;\r\n        this._enableColors = value;\r\n        this.buildStyleSheet();\r\n    }\r\n\r\n    get enableBackgroundColors() { return this._enableBackgroundColors; }\r\n    set enableBackgroundColors(value) {\r\n        if (value === this._enableBackgroundColors) return;\r\n        this._enableBackgroundColors = value;\r\n        this.buildStyleSheet();\r\n    }\r\n\r\n    get hideTrailingEmptyLine() { return this._hideTrailingEmptyLine; }\r\n    set hideTrailingEmptyLine(value) {\r\n        if (value === this._hideTrailingEmptyLine) return;\r\n        this._hideTrailingEmptyLine = value;\r\n        this.doUpdate(UpdateType.display);\r\n    }\r\n\r\n    set enableDebug(enable: boolean) {\r\n        this._enableDebug = enable;\r\n        this._model.enableDebug = enable;\r\n    }\r\n\r\n    get tabWidth(): number {\r\n        return this._model.tabWidth;\r\n    }\r\n\r\n    set tabWidth(value) {\r\n        this._model.tabWidth = value;\r\n    }\r\n\r\n    get textLength(): number {\r\n        return this._model.textLength;\r\n    }\r\n\r\n    get EndOfLine(): boolean {\r\n        return this._model.EndOfLine;\r\n    }\r\n\r\n    get parseQueueLength(): number {\r\n        return this._model.parseQueueLength;\r\n    }\r\n\r\n    get parseQueueEndOfLine(): boolean {\r\n        return this._model.parseQueueEndOfLine;\r\n    }\r\n\r\n    get EndOfLineLength(): number {\r\n        if (this.lines.length === 0)\r\n            return 0;\r\n        return this.lines[this.lines.length - 1].text.length;\r\n    }\r\n\r\n    set enableFlashing(value: boolean) {\r\n        this._model.enableFlashing = value;\r\n    }\r\n    get enableFlashing(): boolean {\r\n        return this._model.enableFlashing;\r\n    }\r\n\r\n    set enableMXP(value: boolean) {\r\n        this._model.enableMXP = value;\r\n    }\r\n    get enableMXP(): boolean {\r\n        return this._model.enableMXP;\r\n    }\r\n\r\n    set showInvalidMXPTags(value: boolean) {\r\n        this._model.showInvalidMXPTags = value;\r\n    }\r\n    get showInvalidMXPTags(): boolean {\r\n        return this._model.showInvalidMXPTags;\r\n    }\r\n\r\n    set enableBell(value: boolean) {\r\n        this._model.enableBell = value;\r\n    }\r\n    get enableBell(): boolean {\r\n        return this._model.enableBell;\r\n    }\r\n\r\n    set enableURLDetection(value: boolean) {\r\n        this._model.enableURLDetection = value;\r\n    }\r\n    get enableURLDetection(): boolean {\r\n        return this._model.enableURLDetection;\r\n    }\r\n\r\n    set enableMSP(value: boolean) {\r\n        this._model.enableMSP = value;\r\n    }\r\n    get enableMSP(): boolean {\r\n        return this._model.enableMSP;\r\n    }\r\n\r\n    set displayControlCodes(value: boolean) {\r\n        this._model.displayControlCodes = value;\r\n    }\r\n    get displayControlCodes(): boolean {\r\n        return this._model.displayControlCodes;\r\n    }\r\n\r\n    set emulateTerminal(value: boolean) {\r\n        this._model.emulateTerminal = value;\r\n    }\r\n    get emulateTerminal(): boolean {\r\n        return this._model.emulateTerminal;\r\n    }\r\n\r\n    set emulateControlCodes(value: boolean) {\r\n        this._model.emulateControlCodes = value;\r\n    }\r\n    get emulateControlCodes(): boolean {\r\n        return this._model.emulateControlCodes;\r\n    }\r\n\r\n    set MXPStyleVersion(value: string) {\r\n        this._model.MXPStyleVersion = value;\r\n    }\r\n    get MXPStyleVersion(): string {\r\n        return this._model.MXPStyleVersion;\r\n    }\r\n\r\n    get WindowSize(): Size {\r\n        return new Size(this.WindowWidth, this.WindowHeight);\r\n    }\r\n\r\n    get WindowWidth(): number {\r\n        return Math.trunc(this._maxView / this._charWidth);\r\n    }\r\n\r\n    get WindowHeight(): number {\r\n        if (this._view.scrollWidth > this._view.clientWidth)\r\n            return Math.trunc((this._innerHeight - getScrollbarWidth() - this._padding[0] - this._padding[2]) / this._charHeight);\r\n        return Math.trunc((this._innerHeight - this._padding[0] - this._padding[2]) / this._charHeight);\r\n    }\r\n\r\n    get html(): string {\r\n        const l = this.lines.length;\r\n        const html: string[] = [];\r\n        for (let idx = 0; idx < l; idx++)\r\n            html.push(this.getLineHTML(idx));\r\n        return html.join('');\r\n    }\r\n\r\n    get text(): string {\r\n        return this._model.text;\r\n    }\r\n\r\n    get raw(): string {\r\n        return this._model.raw;\r\n    }\r\n\r\n    get scrollAtBottom() {\r\n        return this._scrollAtEnd;\r\n    }\r\n    //#endregion\r\n    constructor(container: string | JQuery | HTMLElement | DisplayOptions, options?: DisplayOptions) {\r\n        super();\r\n        if (!container)\r\n            throw new Error('Container must be a selector, element, jquery object or display options');\r\n        if (typeof container === 'object' && 'container' in container) {\r\n            options = Object.assign(options || {}, container);\r\n            container = options.container;\r\n            delete options.container;\r\n        }\r\n        if (typeof container === 'string') {\r\n            this._container = document.querySelector(container);\r\n            if (!this._container)\r\n                throw new Error('Invalid selector for display.');\r\n        }\r\n        else if (container instanceof $)\r\n            this._container = container[0];\r\n        else if (container instanceof HTMLElement)\r\n            this._container = container;\r\n        else\r\n            throw new Error('Container must be a selector, element or jquery object');\r\n        this._styles = document.createElement('style');\r\n        this._container.appendChild(this._styles);\r\n        this._character = document.createElement('span');\r\n        this._character.id = this.id + '-Character';\r\n        this._character.className = 'line';\r\n        this._character.innerHTML = '<span style=\"border-bottom: 1px solid rgb(0, 0, 0);\">W</span>';\r\n        this._character.style.visibility = 'hidden';\r\n        this._container.appendChild(this._character);\r\n\r\n        this._view = document.createElement('div');\r\n        this._view.className = 'view';\r\n        this._view.addEventListener('scroll', () => {\r\n            this._scrollAtEnd = this._view.clientHeight + this._view.scrollTop >= this._view.scrollHeight;\r\n        });\r\n        this._view.addEventListener('click', e => {\r\n            this.emit('click', e);\r\n        })\r\n        this._view.addEventListener('contextmenu', e => {\r\n            this.emit('contextmenu', e);\r\n        });\r\n        this._view.addEventListener('mousedown', e => {\r\n            this.emit('mousedown', e);\r\n            this._mouseDown = true\r\n        });\r\n        this._view.addEventListener('mouseup', e => {\r\n            this.emit('mouseup', e);\r\n            //only trigger if the mouse started in this element\r\n            if (this._mouseDown)\r\n                this.emit('selection-done');\r\n            this._mouseDown = false;\r\n        });\r\n        this._container.appendChild(this._view);\r\n\r\n        this._charHeight = parseFloat(window.getComputedStyle(this._character).height);\r\n        this._charWidth = parseFloat(window.getComputedStyle(this._character.firstElementChild).width);\r\n        if (!options)\r\n            options = { display: this };\r\n        else\r\n            options.display = this;\r\n        this.model = new DisplayModel(options);\r\n\r\n        this._wResize = (e) => {\r\n            if (this._scrollAtEnd)\r\n                this.scrollDisplay();\r\n            debounce(() => {\r\n                this.doUpdate(UpdateType.update | UpdateType.updateWindow);\r\n            }, 250, 'resize');\r\n        };\r\n        this._selection = e => {\r\n            if (this._mouseDown)\r\n                debounce(() => {\r\n                    this.emit('selection-changed');\r\n                }, 250, 'selection-changed');\r\n        };\r\n        window.addEventListener('resize', this._wResize.bind(this));\r\n        document.addEventListener(\"selectionchange\", this._selection.bind(this));\r\n\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            debounce(() => {\r\n                if (!this._resizeObserverCache || this._resizeObserverCache.width !== entries[0].contentRect.width || this._resizeObserverCache.height !== entries[0].contentRect.height) {\r\n                    if (this._scrollAtEnd)\r\n                        this.scrollDisplay();\r\n                    this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                    this.doUpdate(UpdateType.update | UpdateType.updateWindow);\r\n                    this.emit('resize');\r\n                }\r\n            }, 250, 'resize');\r\n        });\r\n        this._resizeObserver.observe(this._container);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    if (this._scrollAtEnd)\r\n                        this.scrollDisplay();\r\n                    this.doUpdate(UpdateType.update | UpdateType.updateWindow);\r\n                    this.emit('resize');\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._container, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this.updateFont();\r\n    }\r\n\r\n    public debug(msg) {\r\n        this.emit('debug', msg);\r\n    }\r\n\r\n    public scrollDisplay(): void {\r\n        if (!this.scrollLock)\r\n            this._view.scrollTop = this._view.scrollHeight;\r\n    };\r\n\r\n    public scrollTo(x: number, y: number) {\r\n        this._view.scrollTo(x, y);\r\n    }\r\n\r\n    public scrollToCharacter(x: number, y: number) {\r\n        this._view.scrollTo(x * this._charHeight, y * this._charWidth);\r\n    }\r\n\r\n    public scrollBy(x: number, y: number) {\r\n        this._view.scrollBy(x, y);\r\n    }\r\n\r\n    public scrollUp() {\r\n        this._view.scrollBy(0, -this._charHeight);\r\n    }\r\n\r\n    public scrollDown() {\r\n        this._view.scrollBy(0, this._charHeight);\r\n    }\r\n\r\n    public pageUp() {\r\n        this._view.scrollBy(0, -this._view.clientHeight)\r\n    }\r\n\r\n    public pageDown() {\r\n        this._view.scrollBy(0, this._view.clientHeight)\r\n    }\r\n\r\n    public trimLines() {\r\n        if (this._maxLines === -1)\r\n            return;\r\n        if (this.lines.length > this._maxLines) {\r\n            const amt = this.lines.length - this._maxLines;\r\n            let r = amt;\r\n            while (r-- > 0)\r\n                this._view.removeChild(this._view.firstChild);\r\n            this._model.removeLines(0, amt);\r\n        }\r\n    }\r\n\r\n    public append(txt: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this._model.append(txt, remote || false, force || false, prependSplit || false);\r\n    }\r\n\r\n    public CurrentAnsiCode() {\r\n        return this._model.CurrentAnsiCode();\r\n    }\r\n\r\n    public removeLine(line: number, noUpdate?: boolean) {\r\n        if (line < 0 || line >= this.lines.length) return;\r\n        this.emit('line-removed', line, this.lines[line].text);\r\n        const id = this._model.getLineID(line);\r\n        const elLine = document.querySelector(`[data-id=\"${id}\"]`);\r\n        this._view.removeChild(elLine);\r\n        this._model.removeLine(line);\r\n    }\r\n\r\n    public removeLines(line: number, amt: number) {\r\n        if (line < 0 || line >= this.lines.length) return;\r\n        if (amt < 1) amt = 1;\r\n        this.emit('lines-removed', line, this.lines.slice(line, line + amt - 1));\r\n        //const id = this._model.getLineID(line);\r\n        //const elLine = document.querySelector(`[data-id=\"${id}\"]`);\r\n        //this._view.removeChild(elLine);\r\n        this._view.replaceChildren(...[].slice.call(this._view.children, 0, line), ...[].slice.call(this._view.children, line + amt));\r\n        this._model.removeLines(line, amt);\r\n    }\r\n\r\n    private updateDisplay() {\r\n        //disable animation\r\n        this._view.classList.remove('animate');\r\n        this.doUpdate(UpdateType.trim);\r\n        if (this._hideTrailingEmptyLine && this.lines.length && this.lines[this.lines.length - 1].text.length === 0)\r\n            (<HTMLElement>this._view.lastChild).style.display = 'none';\r\n        this.doUpdate(UpdateType.scrollEnd | UpdateType.updateWindow);\r\n        //re-enable animation so they are all synced\r\n        this._view.classList.add('animate');\r\n    }\r\n\r\n    public updateWindow(width?, height?) {\r\n        if (width === undefined) {\r\n            width = this.WindowWidth;\r\n            height = this.WindowHeight;\r\n        }\r\n        this._model.updateWindow(width, height);\r\n        this.emit('update-window', width, height);\r\n    }\r\n\r\n    public clear() {\r\n        this._model.clear();\r\n        this._view.innerHTML = '';\r\n    }\r\n\r\n    public dispose() {\r\n        document.body.removeChild(this._character);\r\n        document.body.removeChild(this._styles);\r\n        while (this._container.firstChild)\r\n            this._view.removeChild(this._view.firstChild);\r\n        window.removeEventListener('resize', this._wResize);\r\n        document.removeEventListener(\"selectionchange\", this._selection);\r\n    }\r\n\r\n    private update() {\r\n        const scrollWidth = getScrollbarWidth();\r\n        this._maxView = this._view.clientWidth - this._padding[1] - this._padding[3] - scrollWidth - this._indentPadding;\r\n        if (this._timestamp !== TimeStampStyle.None)\r\n            this._maxView -= this._timestampWidth * this._charWidth;\r\n        this._innerHeight = this._view.clientHeight;\r\n    }\r\n\r\n    public updateFont(font?: string, size?: string) {\r\n        if (!font || font.length === 0)\r\n            font = '\"Courier New\", Courier, monospace';\r\n        else //fall back just incase\r\n            font += ', monospace';\r\n        if (!size || size.length === 0)\r\n            size = '1em';\r\n        if (font !== this._container.style.fontFamily || size !== this._container.style.fontSize) {\r\n            //set styles using raw javascript for minor speed\r\n            this._container.style.fontSize = size;\r\n            this._container.style.fontFamily = font;\r\n            this._character.style.fontSize = size;\r\n            this._character.style.fontFamily = font;\r\n            //recalculate height/width of characters so display can be calculated\r\n            this._charHeight = parseFloat(window.getComputedStyle(this._character).height);\r\n            this._charWidth = parseFloat(window.getComputedStyle(this._character.firstElementChild).width);\r\n            setTimeout(() => {\r\n                this._charHeight = parseFloat(window.getComputedStyle(this._character).height);\r\n                this._charWidth = parseFloat(window.getComputedStyle(this._character.firstElementChild).width);\r\n            }, 250);\r\n            this.buildStyleSheet();\r\n            this.doUpdate(UpdateType.scrollEnd | UpdateType.updateWindow | UpdateType.update);\r\n        }\r\n        const pc = window.getComputedStyle(this._view);\r\n        const padding = [\r\n            parseInt(pc.getPropertyValue('padding-top')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-right')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-bottom')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-left')) || 0\r\n        ];\r\n        if (padding[0] !== this._padding[0] ||\r\n            padding[1] !== this._padding[1] ||\r\n            padding[2] !== this._padding[2] ||\r\n            padding[3] !== this._padding[3]\r\n        ) {\r\n            this._padding = padding;\r\n            this.doUpdate(UpdateType.update);\r\n        }\r\n    }\r\n\r\n    private buildStyleSheet() {\r\n        let styles = ''; // `.background > span, .view > span, .line, .background-line { height: ${this._charHeight}px; line-height: ${this._charHeight - 2}px; }`;\r\n        if (!this._enableColors)\r\n            styles += '.view > span span {color: inherit !important;}';\r\n        if (!this._enableColors || !this._enableBackgroundColors)\r\n            styles += '.background > span span {background-color: inherit !important;}';\r\n        if (this._wordWrap)\r\n            styles += '.view {white-space: break-spaces; }';\r\n        else if (this._wrapAt > 0)\r\n            styles += `.view {white-space: break-spaces; } .line {width: ${this._wrapAt * this._charWidth}px !important;max-width:  ${this._wrapAt * this._charWidth}px;min-width:  ${this._wrapAt * this._charWidth}px;display: block;}`\r\n        if ((this._wordWrap || this._wrapAt > 0) && this._indent > 0)\r\n            styles += `.view {  padding-left: 0px !important; text-indent: ${this._indent * this._charWidth}px hanging; }`;\r\n        //styles += `.view { padding-left: ${this._indent * this._charWidth * 2}px;text-indent: -${this._indent * this._charWidth}px; }@-moz-document url-prefix() { .view {  padding-left: 0px !important; text-indent: ${this._indent * this._charWidth}px hanging; } }`;\r\n        styles += `.line > span { min-height: ${this._charHeight}}`;\r\n        if (this._timestamp !== TimeStampStyle.None)\r\n            styles += '.timestamp { display: inline-block; }';\r\n        //else\r\n        //styles += '.timestamp { display: none !important; }';\r\n        this._styles.innerHTML = styles;\r\n        if ((this._wordWrap || this._wrapAt > 0) && this._indent > 0)\r\n            this._indentPadding = parseFloat(window.getComputedStyle(this._view).paddingLeft) / 2;\r\n        else\r\n            this._indentPadding = 0;\r\n    }\r\n\r\n    public getLineHTML(idx?: number, start?: number, len?: number, inner?: boolean) {\r\n        if (idx === undefined || idx >= this.lines.length)\r\n            idx = this.lines.length - 1;\r\n        else if (idx < 0)\r\n            idx = 0;\r\n        if (start === undefined || start < 0)\r\n            start = 0;\r\n        if (len === undefined || len === -1)\r\n            len = this.lines[idx].text.length;\r\n        const parts: string[] = [];\r\n        let offset = 0;\r\n        let style: any = '';\r\n        let fCls: any = '';\r\n        const text = this.lines[idx].text;\r\n        const formats = this.lines[idx].formats;\r\n        const fLen = formats.length;\r\n        let right = false;\r\n        const id = this._model.getLineID(idx);\r\n        if (this._timestamp === TimeStampStyle.Format && moment)\r\n            parts.push('<span class=\"timestamp\" style=\"color:', this._model.GetColor(-7), ';background:', this._model.GetColor(-8), ';\"', fCls, '>', moment(this.lines[idx].timestamp).format(this._timestampFormat), '</span>');\r\n        else if (this._timestamp === TimeStampStyle.Simple)\r\n            parts.push('<span class=\"timestamp\" style=\"color:', this._model.GetColor(-7), ';background:', this._model.GetColor(-8), ';\"', fCls, '>', new Date(this.lines[idx].timestamp).toISOString(), ' </span>');\r\n        for (let f = 0; f < fLen; f++) {\r\n            const format = formats[f];\r\n            let nFormat;\r\n            let end;\r\n            const td: string[] = [];\r\n            //let oSize;\r\n            //let oFont;\r\n            if (f < fLen - 1) {\r\n                nFormat = formats[f + 1];\r\n                //skip empty blocks\r\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                    continue;\r\n                end = nFormat.offset;\r\n            }\r\n            else\r\n                end = text.length;\r\n            offset = format.offset;\r\n\r\n            if (end > len)\r\n                end = len;\r\n            if (offset < start)\r\n                offset = start;\r\n\r\n            if (format.formatType === FormatType.Normal) {\r\n                style = [];\r\n                fCls = [];\r\n                if (typeof format.background === 'number')\r\n                    style.push('background:', this._model.GetColor(format.background), ';');\r\n                else if (format.background)\r\n                    style.push('background:', format.background, ';');\r\n                if (typeof format.color === 'number')\r\n                    style.push('color:', this._model.GetColor(format.color), ';');\r\n                else if (format.color)\r\n                    style.push('color:', format.color, ';');\r\n                if (format.font)\r\n                    style.push('font-family: ', format.font, ';');\r\n                if (format.size)\r\n                    style.push('font-size: ', format.size, ';');\r\n                if (format.style !== FontStyle.None) {\r\n                    if ((format.style & FontStyle.Bold) === FontStyle.Bold)\r\n                        style.push('font-weight: bold;');\r\n                    if ((format.style & FontStyle.Italic) === FontStyle.Italic)\r\n                        style.push('font-style: italic;');\r\n                    if ((format.style & FontStyle.Overline) === FontStyle.Overline)\r\n                        td.push('overline ');\r\n                    if ((format.style & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline || (format.style & FontStyle.Underline) === FontStyle.Underline)\r\n                        td.push('underline ');\r\n                    if ((format.style & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline)\r\n                        style.push('border-bottom: 1px solid ', (typeof format.color === 'number' ? this._model.GetColor(format.color) : format.color), ';');\r\n                    else\r\n                        //style.push('padding-bottom: 1px;');\r\n                        style.push('border-bottom: 1px solid ', (typeof format.background === 'number' ? this._model.GetColor(format.background) : format.background), ';');\r\n                    if ((format.style & FontStyle.Rapid) === FontStyle.Rapid || (format.style & FontStyle.Slow) === FontStyle.Slow) {\r\n                        if (this.enableFlashing)\r\n                            fCls.push(' ansi-blink');\r\n                        else if ((format.style & FontStyle.DoubleUnderline) !== FontStyle.DoubleUnderline && (format.style & FontStyle.Underline) !== FontStyle.Underline)\r\n                            td.push('underline ');\r\n                    }\r\n                    if ((format.style & FontStyle.Strikeout) === FontStyle.Strikeout)\r\n                        td.push('line-through ');\r\n                    if (td.length > 0)\r\n                        style.push('text-decoration:', td.join('').trim(), ';');\r\n                }\r\n                else\r\n                    style.push('border-bottom: 1px solid ', (typeof format.background === 'number' ? this._model.GetColor(format.background) : format.background), ';');\r\n                //style.push('padding-bottom: 1px;');\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                style = style.join('').trim();\r\n                if (fCls.length !== 0)\r\n                    fCls = ' class=\"' + fCls.join('').trim() + '\"';\r\n                else\r\n                    fCls = '';\r\n                if (format.hr)\r\n                    parts.push('<span style=\"', style, 'min-width:100%;width:100%;\"', fCls, '><div style=\"position:relative;top: 50%;transform: translateY(-50%);height:4px;width:100%; background-color:', (typeof format.color === 'number' ? this._model.GetColor(format.color) : format.color), '\"></div></span>');\r\n                else if (end - offset !== 0)\r\n                    parts.push('<span style=\"', style, '\"', fCls, '>', htmlEncode(text.substring(offset, end)), '</span>');\r\n            }\r\n            else if (format.formatType === FormatType.Link) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"URLLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.href.replace(/\"/g, '&quot;'));\r\n                parts.push('\" onclick=\"', this.linkFunction, '(\\'', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), '\\');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.LinkEnd || format.formatType === FormatType.MXPLinkEnd || format.formatType === FormatType.MXPSendEnd) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('</a>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPLink) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"MXPLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.href.replace(/\"/g, '&quot;'));\r\n                parts.push('\"');\r\n                if (format.expire && format.expire.length)\r\n                    parts.push(` data-expire=\"${format.expire}\"`);\r\n                parts.push(' onclick=\"', this.mxpLinkFunction, '(this, \\'', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), '\\');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPSend) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"MXPLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.hint.replace(/\"/g, '&quot;'));\r\n                parts.push('\"');\r\n                if (format.expire && format.expire.length)\r\n                    parts.push(` data-expire=\"${format.expire}\"`);\r\n                parts.push(' onmouseover=\"', this.mxpTooltipFunction, '(this);\"');\r\n                parts.push(' onclick=\"', this.mxpSendFunction, '(event||window.event, this, ', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), ', ', format.prompt ? '1' : '0', ', ', format.tt.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), ');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPExpired && end - offset !== 0) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.Image) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                let tmp = '';\r\n                parts.push('<img src=\"');\r\n                if (format.url.length > 0) {\r\n                    parts.push(format.url);\r\n                    tmp += format.url;\r\n                    if (!format.url.endsWith('/')) {\r\n                        parts.push('/');\r\n                        tmp += '/';\r\n                    }\r\n                }\r\n                if (format.t.length > 0) {\r\n                    parts.push(format.t);\r\n                    tmp += format.t;\r\n                    if (!format.t.endsWith('/')) {\r\n                        parts.push('/');\r\n                        tmp += '/';\r\n                    }\r\n                }\r\n                tmp += format.name;\r\n                parts.push(format.name, '\"  style=\"');\r\n                if (format.w.length > 0)\r\n                    parts.push('width:', formatUnit(format.w, this._charWidth), ';');\r\n                if (format.h.length > 0)\r\n                    parts.push('height:', formatUnit(format.h, this._charHeight), ';');\r\n                switch (format.align.toLowerCase()) {\r\n                    case 'left':\r\n                        parts.push('float:left;');\r\n                        break;\r\n                    case 'right':\r\n                        parts.push('float:right;');\r\n                        right = true;\r\n                        break;\r\n                    case 'top':\r\n                    case 'middle':\r\n                    case 'bottom':\r\n                        parts.push('vertical-align:', format.align, ';');\r\n                        break;\r\n                }\r\n                if (format.hspace.length > 0 && format.vspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push(formatUnit(format.vspace, this._charWidth), ' ');\r\n                    parts.push(formatUnit(format.hspace, this._charHeight), ';');\r\n                }\r\n                else if (format.hspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push('0px ', formatUnit(format.hspace, this._charHeight), ';');\r\n                }\r\n                else if (format.vspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push(formatUnit(format.vspace, this._charWidth), ' 0px;');\r\n                }\r\n                parts.push('\"');\r\n                if (format.ismap) parts.push(' ismap onclick=\"return false;\"');\r\n                parts.push(`src=\"${tmp}\"/>`);\r\n            }\r\n        }\r\n        if (inner) {\r\n            if (right && len < this.lines[idx].text.length)\r\n                return parts.join('');\r\n            if (right)\r\n                return parts.join('') + '<br>';\r\n            if (len < this.lines[idx].text.length)\r\n                return parts.join('');\r\n            return parts.join('') + '<br>';\r\n        }\r\n        if (right && len < this.lines[idx].text.length)\r\n            return `<span data-id=\"${id}\" class=\"line\" style=\"min-width:100%\">${parts.join('')}</span>`;\r\n        if (right)\r\n            return `<span data-id=\"${id}\" class=\"line\" style=\"min-width:100%\">${parts.join('')}<br></span>`;\r\n        if (len < this.lines[idx].text.length)\r\n            return `<span data-id=\"${id}\" class=\"line\">${parts.join('')}</span>`;\r\n        return `<span  data-id=\"${id}\" class=\"line\">${parts.join('')}<br></span>`;\r\n    }\r\n\r\n    public getLineText(line, full?: boolean) {\r\n        //if line out of range, or if for what ever reason the line is missing data return empty string\r\n        if (line < 0 || line >= this.lines.length || !this.lines[line]) return '';\r\n        //get line from id in case lines where removed\r\n        return this.lines[line].text;\r\n    }\r\n\r\n    private rebuildLine(start: number) {\r\n        this.rebuildLines(start, start);\r\n    }\r\n\r\n    private rebuildLines(start?: number, end?: number) {\r\n        if (!this.lines.length) return;\r\n        if (start === undefined || start < 0)\r\n            start = 0;\r\n        if (end === undefined || end === -1 || end >= this.lines.length)\r\n            end = this.lines.length - 1;\r\n        let _html = [];\r\n        let line = start;\r\n        for (; line <= end; line++) {\r\n            _html.push(this.getLineHTML(line));\r\n        }\r\n\r\n        //if all lines can speed up and reduce load by setting all view at once\r\n        if (start === 0 && end === this.lines.length - 1)\r\n            this._view.innerHTML = _html.join('');\r\n        //if selection of lines will need to update each line one at atime to not break other lines\r\n        else {\r\n            this._view.replaceChildren(...[].slice.call(this._view.children, 0, start), ...[].slice.call(this._view.children, end + 1));\r\n            if (start === 0)\r\n                this._view.firstElementChild.insertAdjacentHTML('beforebegin', _html.join(''));\r\n            else {\r\n                this._view.children[start - 1].insertAdjacentHTML('afterend', _html.join(''));\r\n            }\r\n        }\r\n    }\r\n\r\n    private doUpdate(type?: UpdateType) {\r\n        if (!type) return;\r\n        this._updating |= type;\r\n        if (this._updating === UpdateType.none)\r\n            return;\r\n        window.requestAnimationFrame(() => {\r\n            if (this._updating === UpdateType.none)\r\n                return;\r\n            if ((this._updating & UpdateType.rebuildLines) === UpdateType.rebuildLines) {\r\n                this.rebuildLines();\r\n                this._updating &= ~UpdateType.rebuildLines;\r\n            }\r\n            if ((this._updating & UpdateType.update) === UpdateType.update) {\r\n                this.update();\r\n                this._updating &= ~UpdateType.update;\r\n            }\r\n            if ((this._updating & UpdateType.display) === UpdateType.display) {\r\n                this.updateDisplay();\r\n                this._updating &= ~UpdateType.display;\r\n            }\r\n            if ((this._updating & UpdateType.trim) === UpdateType.trim) {\r\n                this.trimLines();\r\n                this._updating &= ~UpdateType.trim;\r\n            }\r\n            if ((this._updating & UpdateType.scrollEnd) === UpdateType.scrollEnd) {\r\n                this.scrollDisplay();\r\n                this._updating &= ~UpdateType.scrollEnd;\r\n            }\r\n            if ((this._updating & UpdateType.updateWindow) === UpdateType.updateWindow) {\r\n                this.updateWindow();\r\n                this._updating &= ~UpdateType.updateWindow;\r\n            }\r\n            this.doUpdate(this._updating);\r\n        });\r\n    }\r\n\r\n    public colorSubStrByLine(idx: number, fore, back?, start?: number, len?: number, style?: FontStyle) {\r\n        this.colorSubStringByLine(idx, fore, back, start, (start || 0) + (len || 0), style);\r\n    }\r\n\r\n    public colorSubStringByLine(idx: number, fore, back?, start?: number, end?: number, style?: FontStyle) {\r\n        //only update if something changed\r\n        if (!this._model.colorSubStringByLine(idx, fore, back, start, end, style))\r\n            return;\r\n        this.rebuildLine(idx);\r\n    }\r\n\r\n    public removeStyleSubStrByLine(idx: number, style: FontStyle, start?: number, len?: number) {\r\n        this.removeStyleSubStringByLine(idx, style, start, (start || 0) + (len || 0));\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public removeStyleSubStringByLine(idx: number, style: FontStyle, start?: number, end?: number) {\r\n        //only update if something changed\r\n        if (!this._model.removeStyleSubStringByLine(idx, style, start, end))\r\n            return;\r\n        this.rebuildLine(idx);\r\n    }\r\n\r\n    public highlightSubStrByLine(idx: number, start?: number, len?: number) {\r\n        this.highlightStyleSubStringByLine(idx, start, (start || 0) + (len || 0));\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public highlightStyleSubStringByLine(idx: number, start?: number, end?: number, color?: boolean) {\r\n        //only update if something changed\r\n        if (!this._model.highlightStyleSubStringByLine(idx, start, end, color))\r\n            return;\r\n        this.rebuildLine(idx);\r\n    }\r\n\r\n    public SetColor(code: number, color) {\r\n        this._model.SetColor(code, color);\r\n    }\r\n\r\n    public ClearMXP() {\r\n        this._model.ClearMXP();\r\n    }\r\n\r\n    public ResetMXPLine() {\r\n        this._model.ResetMXPLine();\r\n    }\r\n\r\n    get hasSelection(): boolean {\r\n        const selection = window.getSelection();\r\n        if (selection.rangeCount > 0) {\r\n            const range = selection.getRangeAt(0);\r\n            return this._view.contains(range.commonAncestorContainer) && selection.toString().length !== 0;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    get selection(): string {\r\n        if (window.getSelection) {\r\n            const selection = window.getSelection();\r\n            if (selection.rangeCount > 0) {\r\n                const range = selection.getRangeAt(0);\r\n                if (this._view.contains(range.startContainer) || this._view.contains(range.endContainer)) {\r\n                    return selection.toString();\r\n                }\r\n            }\r\n        }\r\n        return '';\r\n    }\r\n\r\n    get selectionAsHTML(): string {\r\n        var range;\r\n        if (window.getSelection) {\r\n            var selection = window.getSelection();\r\n            if (selection.rangeCount > 0) {\r\n                range = selection.getRangeAt(0);\r\n                if (!this._view.contains(range.startContainer) && !this._view.contains(range.endContainer))\r\n                    return '';\r\n                var clonedSelection = range.cloneContents();\r\n                var div = document.createElement('div');\r\n                div.appendChild(clonedSelection);\r\n                return div.innerHTML;\r\n            }\r\n            else {\r\n                return '';\r\n            }\r\n        }\r\n        else if ((document as any).selection && (document as any).selection.createRange) {\r\n            range = (document as any).selection.createRange();\r\n            return range.htmlText;\r\n        }\r\n        else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    public selectAll() {\r\n        let range;\r\n        if (window.getSelection) {\r\n            if (window.getSelection().selectAllChildren)\r\n                window.getSelection().selectAllChildren(this._view);\r\n            else {\r\n                range = document.createRange();\r\n                range.selectNode(this._view);\r\n                window.getSelection().addRange(range);\r\n            }\r\n        }\r\n        else if ((document as any).selection) { //IE\r\n            range = (document.body as any).createTextRange();\r\n            range.moveToElementText(this._view);\r\n            range.select();\r\n        }\r\n    }\r\n\r\n    public clearSelection() {\r\n        const selection = window.getSelection();\r\n        if (selection.rangeCount > 0) {\r\n            const range = selection.getRangeAt(0);\r\n            if (this._view.contains(range.startContainer) || this._view.contains(range.endContainer)) {\r\n                selection.removeAllRanges();\r\n            }\r\n        }\r\n    }\r\n\r\n    public getLineOffset(x, y): Point {\r\n        const elements = document.elementsFromPoint(x, y);\r\n        let element;\r\n        for (let e = 0, el = elements.length; e < el; e++) {\r\n            if (this._view === elements[e]) break;\r\n            if (this._view.contains(elements[e])) {\r\n                element = elements[e];\r\n                break;\r\n            }\r\n        }\r\n        //not in view so fail\r\n        if (!element || !this._view.contains(element) && this._view != element)\r\n            return { x: -1, y: -1, lineID: -1 };\r\n        if (element.classList.contains('line'))\r\n            return { x: 0, y: this.model.getLineFromID(+element.dataset.id), lineID: +element.dataset.id };\r\n        const line = element.closest('.line') as HTMLElement;\r\n        if (line)\r\n            return { x: 0, y: this.model.getLineFromID(+line.dataset.id), lineID: +line.dataset.id };\r\n        return { x: -1, y: -1, lineID: -1 };\r\n    }\r\n\r\n    public getWordFromPosition(x, y): string {\r\n        // Get the element at the specified coordinates\r\n        const elements = document.elementsFromPoint(x, y);\r\n        let element;\r\n        for (let e = 0, el = elements.length; e < el; e++) {\r\n            if (this._view === elements[e]) return '';\r\n            if (this._view.contains(elements[e])) {\r\n                element = elements[e];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Check if the element exists and contains text\r\n        if (element && element.textContent) {\r\n            // Get the text content of the element\r\n            const text = element.textContent;\r\n\r\n            // Find the word boundaries around the specified position\r\n            let start = text.lastIndexOf(' ', x) + 1;\r\n            let end = text.indexOf(' ', x);\r\n            if (end === -1) {\r\n                end = text.length;\r\n            }\r\n\r\n            // Extract the word\r\n            const word = text.substring(start, end);\r\n\r\n            return word;\r\n        }\r\n\r\n        return '';\r\n    }\r\n}\r\n\r\nexport class DisplayModel extends EventEmitter {\r\n    private _lineID = 0;\r\n    private _parser: Parser;\r\n    public lines: LineData[] = [];\r\n    private lineIDs: number[] = [];\r\n    private _expire = {};\r\n    private _expire2 = [];\r\n\r\n    get enableDebug() {\r\n        return this._parser.enableDebug;\r\n    }\r\n\r\n    set enableDebug(value) {\r\n        this._parser.enableDebug = value;\r\n    }\r\n\r\n    get tabWidth(): number {\r\n        return this._parser.tabWidth;\r\n    }\r\n\r\n    set tabWidth(value) {\r\n        this._parser.tabWidth = value;\r\n    }\r\n\r\n    get textLength(): number {\r\n        return this._parser.textLength;\r\n    }\r\n\r\n    get EndOfLine(): boolean {\r\n        return this._parser.EndOfLine;\r\n    }\r\n\r\n    get parseQueueLength(): number {\r\n        return this._parser.parseQueueLength;\r\n    }\r\n\r\n    get parseQueueEndOfLine(): boolean {\r\n        return this._parser.parseQueueEndOfLine;\r\n    }\r\n\r\n    set enableFlashing(value: boolean) {\r\n        this._parser.enableFlashing = value;\r\n    }\r\n    get enableFlashing(): boolean {\r\n        return this._parser.enableFlashing;\r\n    }\r\n\r\n    set enableMXP(value: boolean) {\r\n        this._parser.enableMXP = value;\r\n    }\r\n    get enableMXP(): boolean {\r\n        return this._parser.enableMXP;\r\n    }\r\n\r\n    set showInvalidMXPTags(value: boolean) {\r\n        this._parser.showInvalidMXPTags = value;\r\n    }\r\n    get showInvalidMXPTags(): boolean {\r\n        return this._parser.showInvalidMXPTags;\r\n    }\r\n\r\n    set enableBell(value: boolean) {\r\n        this._parser.enableBell = value;\r\n    }\r\n    get enableBell(): boolean {\r\n        return this._parser.enableBell;\r\n    }\r\n\r\n    set enableURLDetection(value: boolean) {\r\n        this._parser.enableURLDetection = value;\r\n    }\r\n    get enableURLDetection(): boolean {\r\n        return this._parser.enableURLDetection;\r\n    }\r\n\r\n    set enableMSP(value: boolean) {\r\n        this._parser.enableMSP = value;\r\n    }\r\n    get enableMSP(): boolean {\r\n        return this._parser.enableMSP;\r\n    }\r\n\r\n    set displayControlCodes(value: boolean) {\r\n        this._parser.displayControlCodes = value;\r\n    }\r\n    get displayControlCodes(): boolean {\r\n        return this._parser.displayControlCodes;\r\n    }\r\n\r\n    set emulateTerminal(value: boolean) {\r\n        this._parser.emulateTerminal = value;\r\n    }\r\n    get emulateTerminal(): boolean {\r\n        return this._parser.emulateTerminal;\r\n    }\r\n\r\n    set emulateControlCodes(value: boolean) {\r\n        this._parser.emulateControlCodes = value;\r\n    }\r\n    get emulateControlCodes(): boolean {\r\n        return this._parser.emulateControlCodes;\r\n    }\r\n\r\n    set MXPStyleVersion(value: string) {\r\n        this._parser.StyleVersion = value;\r\n    }\r\n    get MXPStyleVersion(): string {\r\n        return this._parser.StyleVersion;\r\n    }\r\n\r\n    constructor(options: DisplayOptions) {\r\n        super();\r\n        this._parser = new Parser(options);\r\n        this._parser.on('debug', (msg) => { this.emit(msg); });\r\n\r\n        this._parser.on('bell', () => { this.emit('bell'); });\r\n\r\n        this._parser.on('add-line', (data: ParserLine) => {\r\n            this.addParserLine(data, true);\r\n        });\r\n\r\n        this._parser.on('expire-links', (args) => {\r\n            let lines;\r\n            let line;\r\n            let expire;\r\n            if (!args || args.length === 0) {\r\n                for (line in this._expire2) {\r\n                    if (!this._expire2.hasOwnProperty(line))\r\n                        continue;\r\n                    this.expireLineLinkFormat(this._expire2[line], +line);\r\n                }\r\n                for (expire in this._expire) {\r\n                    if (!this._expire.hasOwnProperty(expire))\r\n                        continue;\r\n                    lines = this._expire[expire];\r\n                    for (line in lines) {\r\n                        if (!lines.hasOwnProperty(line))\r\n                            continue;\r\n                        this.expireLineLinkFormat(lines[line], +line);\r\n                    }\r\n                }\r\n                this._expire2 = [];\r\n                this._expire = {};\r\n                this.emit('expire-links', args);\r\n            }\r\n            else if (this._expire[args]) {\r\n                lines = this._expire[args];\r\n                for (line in lines) {\r\n                    if (!lines.hasOwnProperty(line))\r\n                        continue;\r\n                    this.expireLineLinkFormat(lines[line], +line);\r\n                }\r\n                delete this._expire[args];\r\n                this.emit('expire-links', args);\r\n            }\r\n        });\r\n\r\n        this._parser.on('parse-done', () => {\r\n            this.emit('parse-done');\r\n        });\r\n\r\n        this._parser.on('set-title', (title, type) => {\r\n            this.emit('set-title', title, type);\r\n        });\r\n        this._parser.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this._parser.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this._parser.on('MXP-tag-reply', (tag, args) => {\r\n            this.emit('MXP-tag-reply', tag, args);\r\n        });\r\n\r\n    }\r\n\r\n    public addParserLine(data: ParserLine, noUpdate?: boolean) {\r\n        data.timestamp = Date.now();\r\n        this.emit('add-line', data);\r\n        if (data == null || typeof data === 'undefined' || data.line == null || typeof data.line === 'undefined')\r\n            return;\r\n        this.emit('add-line-done', data);\r\n        if (data.gagged)\r\n            return;\r\n        const line: LineData = {\r\n            text: (data.line === '\\n' || data.line.length === 0) ? '' : data.line,\r\n            raw: data.raw,\r\n            formats: data.formats,\r\n            id: this._lineID,\r\n            timestamp: data.timestamp\r\n        }\r\n        this.lines.push(line);\r\n        this.lineIDs.push(this._lineID);\r\n        this._lineID++;\r\n        this.buildLineExpires(this.lines.length - 1);\r\n        this.emit('line-added', data, noUpdate);\r\n    }\r\n\r\n    private expireLineLinkFormat(formats, idx: number) {\r\n        let f;\r\n        let fs;\r\n        let fl;\r\n        let fsl;\r\n        let type;\r\n        let eType;\r\n        let format;\r\n        let n = 0;\r\n        for (fs = 0, fsl = formats.length; fs < fsl; fs++) {\r\n            fl = this.lines[idx].formats.length;\r\n            f = formats[fs];\r\n            format = this.lines[idx].formats[f];\r\n            type = format.formatType;\r\n            if (format.formatType === FormatType.MXPLink)\r\n                eType = FormatType.MXPLinkEnd;\r\n            else\r\n                eType = FormatType.MXPSendEnd;\r\n            format.formatType = FormatType.MXPExpired;\r\n            f++;\r\n            for (; f < fl; f++) {\r\n                if (this.lines[idx].formats[f] === eType) {\r\n                    if (n === 0) {\r\n                        this.lines[idx].formats[f].formatType = FormatType.MXPSkip;\r\n                        break;\r\n                    }\r\n                    else\r\n                        n--;\r\n                }\r\n                else if (this.lines[idx].formats[f] === type)\r\n                    n++;\r\n            }\r\n        }\r\n        this.emit('expire-link-line', idx);\r\n    }\r\n\r\n    public clear() {\r\n        this._parser.Clear();\r\n        this.lines = [];\r\n        this._expire = {};\r\n        this._expire2 = [];\r\n        this.lineIDs = [];\r\n        this._lineID = 0;\r\n    }\r\n\r\n    public IncreaseColor(color, percent) {\r\n        return this._parser.IncreaseColor(color, percent);\r\n    }\r\n\r\n    public GetColor(color) {\r\n        return this._parser.GetColor(color);\r\n    }\r\n\r\n    public append(txt: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this._parser.parse(txt, remote || false, force || false, prependSplit || false);\r\n    }\r\n\r\n    public CurrentAnsiCode() {\r\n        return this._parser.CurrentAnsiCode();\r\n    }\r\n\r\n    public updateWindow(width?, height?) {\r\n        this._parser.updateWindow(width, height);\r\n    }\r\n\r\n    public SetColor(code: number, color) {\r\n        this._parser.SetColor(code, color);\r\n    }\r\n\r\n    public ClearMXP() {\r\n        this._parser.ClearMXP();\r\n    }\r\n\r\n    public ResetMXPLine() {\r\n        this._parser.ResetMXPLine();\r\n    }\r\n\r\n    get busy() {\r\n        return this._parser.busy;\r\n    }\r\n\r\n    public removeLine(line: number) {\r\n        this.lines.splice(line, 1);\r\n        this.lineIDs.splice(line, 1);\r\n        this._expire2.splice(line, 1);\r\n    }\r\n\r\n    public removeLines(line: number, amt: number) {\r\n        this.lines.splice(line, amt);\r\n        this.lineIDs.splice(line, amt);\r\n        this._expire2.splice(line, amt);\r\n        for (let ol in this._expire) {\r\n            if (!this._expire.hasOwnProperty(ol) || this._expire[ol].length === 0 || line >= this._expire[ol].length)\r\n                continue;\r\n            this._expire[ol].splice(line, amt);\r\n        }\r\n    }\r\n\r\n    public getLineID(line: number) {\r\n        if (line < 0 || line >= this.lineIDs.length) return -1;\r\n        return this.lineIDs[line];\r\n    }\r\n\r\n    public get getNextLineID() {\r\n        return this._lineID;\r\n    }\r\n\r\n    public getLineFromID(id) {\r\n        return this.lineIDs.indexOf(id);\r\n    }\r\n\r\n    private buildLineExpires(idx) {\r\n        if (idx === undefined)\r\n            idx = this.lines.length - 1;\r\n        const formats = this.lines[idx].formats;\r\n        for (const ol in this._expire) {\r\n            if (!this._expire.hasOwnProperty(ol))\r\n                continue;\r\n            if (this._expire[ol][idx])\r\n                delete this._expire[ol][idx];\r\n        }\r\n        delete this._expire2[idx];\r\n        let f = formats.length;\r\n        let format;\r\n        while (f--) {\r\n            format = formats[f];\r\n            if (format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink) {\r\n                if (format.expire && format.expire.length > 0) {\r\n                    if (!this._expire[format.expire])\r\n                        this._expire[format.expire] = [];\r\n                    if (!this._expire[format.expire][idx])\r\n                        this._expire[format.expire][idx] = [];\r\n                    this._expire[format.expire][idx].push(f);\r\n                }\r\n                else {\r\n                    if (!this._expire2[idx])\r\n                        this._expire2[idx] = [];\r\n                    this._expire2[idx].push(f);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //color like javascript.substr using 0 index and length\r\n    public colorSubStrByLine(idx: number, fore, back?, start?: number, len?: number, style?: FontStyle) {\r\n        return this.colorSubStringByLine(idx, fore, back, start, start + len, style);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public colorSubStringByLine(idx: number, fore, back?, start?: number, end?: number, style?: FontStyle) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n        if (start === end)\r\n            return false;\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                format.color = fore || format.color;\r\n                format.background = back || format.background;\r\n                format.style |= style || FontStyle.None;\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: fore || 0,\r\n                    background: back || 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: style || FontStyle.None,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: fore || format.color,\r\n                        background: back || format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style | (style || FontStyle.None),\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                else {\r\n                    format.color = fore || format.color;\r\n                    format.background = back || format.background;\r\n                    format.style |= (style || FontStyle.None);\r\n                }\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this.pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public removeStyleSubStrByLine(idx: number, style: FontStyle, start?: number, len?: number) {\r\n        return this.removeStyleSubStringByLine(idx, style, start, start + len);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public removeStyleSubStringByLine(idx: number, style: FontStyle, start?: number, end?: number) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                format.style &= ~(style || FontStyle.None);\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: 0,\r\n                    background: 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: FontStyle.None,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style & ~(style || FontStyle.None),\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                else {\r\n                    format.style &= ~(style || FontStyle.None);\r\n                }\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this.pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public highlightSubStrByLine(idx: number, start?: number, len?: number) {\r\n        return this.highlightStyleSubStringByLine(idx, start, start + len);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public highlightStyleSubStringByLine(idx: number, start?: number, end?: number, color?: boolean) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                    if (typeof format.color === 'number')\r\n                        format.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                    else\r\n                        format.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                }\r\n                else\r\n                    format.style |= FontStyle.Bold;\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: color ? 370 : 0,\r\n                    background: 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: color ? FontStyle.None : FontStyle.Bold,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    nFormat = {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    }\r\n                    if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                        if (typeof format.color === 'number')\r\n                            nFormat.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                        else\r\n                            nFormat.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                    }\r\n                    else\r\n                        nFormat.style |= FontStyle.Bold;\r\n                    formats.splice(f + 1, 0, nFormat);\r\n                    len++;\r\n                }\r\n                else if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                    if (typeof format.color === 'number')\r\n                        format.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                    else\r\n                        format.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                }\r\n                else\r\n                    format.style |= FontStyle.Bold;\r\n\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this.pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private pruneFormats(formats, textLen) {\r\n        //no formats or only 1 format\r\n        if (!formats || formats.length < 2) return formats;\r\n        const l = formats.length;\r\n        const nF = [];\r\n        for (let f = 0; f < l; f++) {\r\n            const format = formats[f];\r\n            let end;\r\n            if (f < l - 1) {\r\n                const nFormat = formats[f + 1];\r\n                //old links that have expired so no longer needed clean\r\n                //if (format.formatType === FormatType.MXPSkip) continue;\r\n                //skip format until find one that has different offset\r\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                    continue;\r\n                end = nFormat.offset;\r\n                //empty link\r\n                if (format.formatType === FormatType.Link && end - format.offset === 0 && nFormat.formatType === FormatType.LinkEnd)\r\n                    continue;\r\n                //empty send\r\n                if (format.formatType === FormatType.MXPSend && end - format.offset === 0 && nFormat.formatType === FormatType.MXPSendEnd)\r\n                    continue;\r\n                //empty link\r\n                if (format.formatType === FormatType.MXPLink && end - format.offset === 0 && nFormat.formatType === FormatType.MXPLinkEnd)\r\n                    continue;\r\n                //same data but offset is higher, set next block current offset, clear width and continue;\r\n                if (\r\n                    format.formatType === nFormat.formatType &&\r\n                    format.color === nFormat.color &&\r\n                    format.background === nFormat.background &&\r\n                    format.size === nFormat.size &&\r\n                    format.font === nFormat.font &&\r\n                    format.style === nFormat.style &&\r\n                    format.unicode === nFormat.unicode\r\n                ) {\r\n                    nFormat.offset = format.offset;\r\n                    nFormat.width = 0;\r\n                    continue;\r\n                }\r\n            }\r\n            //trailing link with no text or empty format block and not fragment\r\n            else if (format.offset === textLen && textLen !== 0 && ((format.formatType === FormatType.Normal && !format.hr) || format.formatType === FormatType.Link || format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink))\r\n                continue;\r\n            nF.push(format);\r\n        }\r\n        return nF;\r\n    }\r\n\r\n    get text(): string {\r\n        return this.lines.map(line => line.text).join('\\n');\r\n    }\r\n\r\n    get raw(): string {\r\n        return this.lines.map(line => line.raw).join('');\r\n    }\r\n\r\n    public getText(line, start, end?) {\r\n        if (line < 0 || line >= this.lines.length) return '';\r\n        if (start < 0) start = 0;\r\n        if (typeof end === 'undefined' || end > this.lines[line].text.length)\r\n            return this.lines[line].text.substring(start);\r\n        return this.lines[line].text.substring(start, end);\r\n    }\r\n}\r\n", "{\n  \"name\": \"oimud\",\n  \"productName\": \"oiMUD\",\n  \"icon\": \"./assets/icons/oiMUD.png.png\",\n  \"website\": \"https://github.com/icewolfz/oiMUD\",\n  \"homepage\": \"https://github.com/icewolfz/oiMUD\",\n  \"url\": \"https://github.com/icewolfz/oiMUD/issues\",\n  \"version\": \"0.0.1-alpha\",\n  \"main\": \"index.htm\",\n  \"description\": \"A MUD websocket client.\",\n  \"author\": \"Icewolfz\",\n  \"email\": \"icewolfz@users.noreply.github.com\",\n  \"license\": \"Personal\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/icewolfz/oiMUD.git\"\n  },\n  \"private\": true,\n  \"scripts\": {\n    \"tslint\": \"tsc -p . --listEmittedFiles  --noEmit\",\n    \"build:all\": \"node build.js -a --test\",\n    \"build:all-debug\": \"node build.js -a -d\",\n    \"build:css-debug\": \"node build.js -css -d\"\n  },\n  \"devDependencies\": {\n    \"@types/jquery\": \"^3.5.31\",\n    \"esbuild\": \"0.24.0\",\n    \"eslint\": \"^9.12.0\",\n    \"eslint-plugin-html\": \"^8.1.2\",\n    \"sass\": \"^1.79.4\"\n  },\n  \"dependencies\": {\n    \"@types/jstorage\": \"^0.3.33\",\n    \"jquery\": \"^3.7.1\",\n    \"mathjs\": \"^13.2.0\",\n    \"moment\": \"^2.30.1\"\n  }\n}\n", "//MSP = 90 // MUD Sound Protocol (MSP)(unofficial)\n/**\n * Implementation of the MSP (MUD Sound Protocol) and GMCP Client.Media module for oiMUD as a plugin\n *\n * @author Icewolfz\n * @copyright Icewolfz 2013\n * @version 1.2\n * MSP requires the modules {@link module:telnet}.\n * MSP requires the modules {@link module:src/lib/buzz}.\n * @requires module:src/lib/buzz\n * @requires module:telnet\n * @namespace MSP\n * @constructor\n *\n * @property {Object} [server=false]\t- Weather the server willing to do MSP\n * @property {Object} [enabled=true]\t- Is MSP module enabled\n *\n * @todo make Music/Sound play music either using soundmanager2(larger but more compatible) or buzz (HTML5 old)\n */\ndeclare global {\n    interface Window {\n        MSP: MSP;\n    }\n}\n\nimport * as buzz from './../lib/buzz.js'\n\nimport { EventEmitter } from './../events';\nimport { stripQuotes } from './../library';\nimport { TelnetOption } from './../telnet';\nimport { Client } from './../client';\nimport { Plugin } from '../plugin';\nimport { AnsiColorCode } from '../ansi';\nimport { FunctionEvent, MenuItem } from '../types';\n\nenum ParseMode {\n    default = 0,\n    inline = 1,\n    strict = 2\n}\n\ninterface MSPData {\n    off: boolean;\n    file?: string;\n    url?: string;\n    volume?: number;\n    repeat?: number;\n    priority?: number;\n    type?: string;\n    continue?: boolean;\n}\n\nclass SoundState extends EventEmitter {\n    public _file: string = '';\n    private _repeats: number = 1;\n    private _volume: number = 100;\n    private _priority: number = 50;\n    private _retries: number = 0;\n\n    public current: number = 0;\n    public sound = null;\n    public playing: boolean = false;\n    public url: string = '';\n    public continue: boolean = true;\n    public maxErrorRetries: number = 0;\n\n    set file(file: string) {\n        if (!this.continue)\n            this.close();\n        this._file = file;\n    }\n    get file(): string {\n        return this._file;\n    }\n\n    set repeats(repeats: number) {\n        if (repeats >= -1)\n            this._repeats = repeats;\n        else\n            this._repeats = 1;\n        this.current = 0;\n    }\n\n    get repeats(): number {\n        return this._repeats;\n    }\n\n    set volume(volume: number) {\n        if (volume >= 0 && volume <= 100)\n            this._volume = volume;\n        else\n            this._volume = 1;\n    }\n\n    get volume(): number {\n        return this._volume;\n    }\n\n    set priority(priority: number) {\n        if (priority >= 0 && priority <= 100)\n            this._priority = priority;\n        else\n            this._priority = 50;\n    }\n\n    get priority(): number {\n        return this._priority;\n    }\n\n    public play() {\n        this.playing = true;\n        if (this._repeats > 0 && this.current < this._repeats) {\n            this.current++;\n            this.close();\n            this.open().then(() => {\n                //reset to 0 as it was successful in prep of next sound\n                this._retries = 0;\n                this.sound.setVolume(this._volume).play();\n                if (this.current < this._repeats) {\n                    this.sound.bind('ended abort', (e) => {\n                        this.play();\n                    });\n                }\n                else\n                    this.sound.bind('ended abort', (e) => {\n                        this.playing = false;\n                        this.emit('ended');\n                    });\n                if (this.sound.isEnded())\n                    this.playing = false;\n            }).catch(err => {\n                //only retry until reaches max error retries to prevent infinite looping\n                if (this._retries < this.maxErrorRetries) {\n                    //reduce current as failed to play\n                    this.current--;\n                    this.play();\n                    this._retries++;\n                }\n                //if at max retries do nothing and reset to 0\n                else\n                    this._retries = 0;\n            });\n        }\n        else if (this._repeats === -1) {\n            this.close();\n            this.open().then(() => {\n                //reset to 0 as it was successful in prep of next sound\n                this._retries = 0;\n                this.sound.setVolume(this._volume).loop().play();\n                if (this.sound.isEnded())\n                    this.playing = false;\n            }).catch(err => {\n                //only retry until reaches max error retries to prevent infinite looping\n                if (this._retries < this.maxErrorRetries) {\n                    this.play();\n                    this._retries++;\n                }\n                //if at max retries do nothing and reset to 0\n                else\n                    this._retries = 0;\n            });\n        }\n        else\n            this.playing = false;\n    }\n\n    public async open() {\n        this.close();\n        return new Promise((resolve, reject) => {\n            this.sound = (new buzz.sound as any)(this.url + this._file);\n            this.sound.bind('loadeddata', (e) => {\n                this.emit('playing', { file: this._file, sound: this.sound, state: this, duration: buzz.toTimer(this.sound.getDuration()) });\n                resolve(1);\n            });\n            this.sound.bind('error', (e) => {\n                if (e && e.currentTarget && e.currentTarget.error) {\n                    switch (e.currentTarget.error.code) {\n                        case 1:\n                            this.emit('error', new Error(`MSP - Aborted: ${this.url}${this._file}`));\n                            break;\n                        case 2:\n                            this.emit('error', new Error(`MSP - Network error: ${this.url}${this._file}`));\n                            break;\n                        case 3:\n                            this.emit('error', new Error(`MSP - Could not decode: ${this.url}${this._file}`));\n                            break;\n                        case 4:\n                            this.emit('error', new Error(`MSP - Source not supported: ${this.url}${this._file}`));\n                            break;\n                    }\n                }\n                else if (e && e.currentTarget && e.currentTarget.networkState === 3)\n                    this.emit('error', new Error(`MSP - Source not found or unable to play: ${this.url}${this._file}`));\n                else\n                    this.emit('error', new Error('MSP - Unknown error'));\n                reject();\n            });\n            this.emit('opened');\n        });\n    }\n\n    public close() {\n        if (this.sound) {\n            this.stop();\n            delete this.sound;\n            this.sound = null;\n        }\n        else if (this.playing)\n            this.playing = false;\n        this.emit('closed');\n    }\n\n    public stop() {\n        if (this.sound)\n            this.sound.stop();\n        this.playing = false;\n        this.emit('stopped');\n    }\n}\n\nexport interface MSPOptions {\n    client: Client;\n    forcedDefaultMusicURL?: string;\n    forcedDefaultSoundURL?: string;\n}\n\n/**\n * Implementation of the MSP (MUD Sound Protocol)\n *\n * @author William\n * @copyright William 2013\n * @version 1.1\n * MSP requires the modules {@link module:telnet}.\n * MSP requires the modules {@link module:buzz}.\n * @requires module:buzz\n * @requires module:telnet\n * @namespace MSP\n * @constructor\n *\n * @property {Object} [server=false]\t- Weather the server willing to do MSP\n * @property {Object} [enabled=true]\t- Is MSP module enabled\n */\nexport class MSP extends Plugin {\n    private _enabled: boolean = true;\n    private _enableSound: boolean = true;\n    private _maxErrorRetries: number = 1;\n    public server: boolean = false;\n    public enableDebug: boolean = false;\n\n    public defaultSoundURL: string = '';\n    public defaultMusicURL: string = '';\n    public forcedDefaultMusicURL: string = 'http://' + window.location.hostname + '/sounds/';\n    public forcedDefaultSoundURL: string = 'http://' + window.location.hostname + '/sounds/';\n    public defaultSoundExt: string = '.m4a';\n    public defaultMusicExt: string = '.m4a';\n    public MusicState: SoundState = new SoundState();\n    public SoundState: SoundState = new SoundState();\n    public parseMode: ParseMode = ParseMode.default;\n\n    constructor(options?: MSPOptions | Client) {\n        super(options instanceof Client ? options : options?.client);\n        if (options && !(options instanceof Client)) {\n            if ('forcedDefaultMusicURL' in options)\n                this.forcedDefaultMusicURL = options.forcedDefaultMusicURL;\n            if ('forcedDefaultSoundURL' in options)\n                this.forcedDefaultSoundURL = options.forcedDefaultSoundURL;\n        }\n        this.MusicState.on('playing', (data) => { data.type = 1; this.emit('playing', data); });\n        this.SoundState.on('playing', (data) => { data.type = 0; this.emit('playing', data); });\n        this.MusicState.on('error', (err) => { this.emit('error', err); });\n        this.SoundState.on('error', (err) => { this.emit('error', err); });\n        this.MusicState.maxErrorRetries = this._maxErrorRetries;\n        this.SoundState.maxErrorRetries = this._maxErrorRetries;\n    }\n\n    public remove() {\n        if (!this.client) return;\n        this.client.removeListenersFromCaller(this);\n        let idx = this.client.telnet.GMCPSupports.indexOf('Client.Media 1');\n        this.client.telnet.GMCPSupports.splice(idx, 1);\n    }\n\n    public initialize() {\n        if (!this.client) return;\n        this.client.telnet.GMCPSupports.push('Client.Media 1');\n        this.client.on('connecting', () => this.reset(), this);\n        this.client.on('close', () => this.reset(), this);\n        this.client.on('received-option', this.processOption, this);\n        this.client.on('received-GMCP', this.processGMCP, this);\n        this.client.on('music', this.music, this);\n        this.client.on('sound', this.sound, this);\n        this.client.on('options-loaded', this.loadOptions, this);\n        this.client.on('option-loaded', this.setOption, this);\n        this.client.on('function', this.processFunction, this);\n        this.on('playing', (data) => {\n            if (!this.client) return;\n            this.debug('MSP ' + (data.type ? 'Music' : 'Sound') + ' Playing ' + data.file + ' for ' + data.duration);\n            this.debug(data);\n            if (!this.client.getOption('notifyMSPPlay')) return;\n            this.client.echo((data.type ? 'Music' : 'Sound') + ' Playing ' + data.file + ' for ' + data.duration, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\n        });\n        this.on('debug', e => this.client.debug(e), this);\n        this.on('error', e => this.client.error(e), this);\n        this.loadOptions();\n    }\n\n    public get menu() {\n        return [];\n    }\n\n    public get settings(): MenuItem[] {\n        return [];\n    }\n\n    public loadOptions() {\n        this.enableDebug = this.client.getOption('enableDebug');\n        this.enabled = this.client.getOption('enableMSP');\n        this.enableSound = this.client.getOption('enableSound');\n        this.maxErrorRetries = this.client.getOption('mspMaxRetriesOnError');\n    }\n\n    public setOption(option, value) {\n        switch (option) {\n            case 'enableMSP':\n                this.enabled = this.client.getOption('enableMSP');\n                break;\n            case 'mspMaxRetriesOnError':\n                this.maxErrorRetries = this.client.getOption('mspMaxRetriesOnError');\n                break;\n            case 'enableSound':\n            case 'enableDebug':\n                this[option] = value;\n                break;\n        }\n    }\n\n    /**\n     * enable or disable MSP\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get enabled() { return this._enabled; }\n    set enabled(value) {\n        if (value === this._enabled) return;\n        this._enabled = value;\n        this.MusicState?.close();\n        this.SoundState?.close();\n    }\n\n    /**\n     * the number of retries to try before stopping when an error happens MSP\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get maxErrorRetries() { return this._maxErrorRetries; }\n    set maxErrorRetries(value) {\n        if (value === this._maxErrorRetries) return;\n        this._maxErrorRetries = value;\n        if (this.MusicState)\n            this.MusicState.maxErrorRetries = value;\n        if (this.SoundState)\n            this.SoundState.maxErrorRetries = value;\n    }\n\n\n    /**\n     * enable or disable enableSound, allow processing of msp\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get enableSound() { return this._enableSound; }\n    set enableSound(value) {\n        if (value === this._enableSound) return;\n        this._enableSound = value;\n        this.MusicState?.close();\n        this.SoundState?.close();\n    }\n\n    /**\n     * getArguments - process a line of text and extract any arguments and return\n     * them as an object for consuming and handle it due to being a web browser can't\n     * save sounds, so they either need a url or be on the local http server using\n     * the default url set\n     *\n     * @param {String} text the line of text extract arguments from\n     * @param {Number} type the type of arguments to process, 0 SOUND, 1 MUSIC\n     * @returns {Object} return a MUSIC or SOUND argument object\n     */\n    private getArguments(text: string, type: number) {\n        const e: MSPData = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n        const args = [];\n        let state: number = 0;\n        let str = [];\n        let x: number = 0;\n        let xl: number = text.length;\n        let c: string;\n        let arg;\n        let tmp;\n        for (; x < xl; x++) {\n            c = text.charAt(x);\n            switch (state) {\n                case 1:\n                    if (c === '\\'') {\n                        state = 0;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n                    break;\n                case 2:\n                    if (c === '\\'') {\n                        state = 0;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n                    break;\n                default:\n                    if (c === ' ') {\n                        args.push(str.join(''));\n                        str = [];\n                    }\n                    else if (c === '\\'') {\n                        state = 1;\n                        str.push(c);\n                    }\n                    else if (c === '\\'') {\n                        state = 2;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n\n                    break;\n            }\n        }\n        if (str.length > 0) {\n            args.push(str.join(''));\n            str = [];\n        }\n        x = 0;\n        xl = args.length;\n        this.debug('MSP arguments found: ' + args);\n        for (x = 0; x < xl; x++) {\n            arg = args[x].split('=');\n            if (arg.length > 1) {\n                switch (arg[0].toUpperCase()) {\n                    case 'FNAME':\n                        e.file = stripQuotes(arg[1]);\n                        if (e.file.toLowerCase() === 'off') {\n                            e.off = true;\n                            e.file = '';\n                        }\n                        break;\n                    case 'V': //volume\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 100;\n                        e.volume = tmp;\n                        break;\n                    case 'L': //repeat\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 1;\n                        e.repeat = tmp;\n                        break;\n                    //Sound only\n                    case 'P': //priority\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 1;\n                        e.priority = tmp;\n                        break;\n                    //Music only\n                    case 'C': //continue\n                        e.continue = arg[1] !== '0';\n                        break;\n                    case 'T': //type\n                        if (arg[1].length > 0)\n                            e.type = arg[1];\n                        break;\n                    case 'U': //url\n                        e.url = stripQuotes(arg[1]);\n                        if (!e.url.endsWith('/') && e.url.length > 0)\n                            e.url += '/';\n                        break;\n                }\n            }\n            else if (x === 0) {\n                e.file = stripQuotes(args[x]);\n                if (e.file.toLowerCase() === 'off') {\n                    e.off = true;\n                    e.file = '';\n                }\n            }\n            else if (x === 1) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 100;\n                e.volume = tmp;\n            }\n            else if (x === 2) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 1;\n                e.repeat = tmp;\n            }\n            else if (x === 3 && type === 1)\n                e.continue = args[x] !== '0';\n            else if (x === 3) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 1;\n                e.priority = tmp;\n            }\n            else if (x === 4) {\n                if (args[x].length > 0)\n                    e.type = args[x];\n            }\n            else if (x === 5) {\n                e.url = stripQuotes(args[x]);\n                if (!e.url.endsWith('/') && e.url.length > 0)\n                    e.url += '/';\n            }\n        }\n        this.debug(e);\n        return e;\n    }\n\n    public reset() {\n        this.server = false;\n    }\n\n    /**\n     * music - process music object and player/stop based on object options\n     *\n     * @param {Object} data Music argument object, contains all settings\n     */\n    public music(data: MSPData) {\n        if (!this.enabled && !this.enableSound) return false;\n        if (!data.file || data.file.length === 0) {\n            if (data.off && data.url && data.url.length > 0)\n                this.defaultMusicURL = data.url;\n            else if (data.off)\n                this.MusicState.stop();\n            return;\n        }\n        else if (data.off) {\n            this.MusicState.stop();\n            return;\n        }\n        this.MusicState.volume = data.volume;\n        this.MusicState.repeats = data.repeat;\n        this.MusicState.continue = data.continue;\n        const old = this.MusicState.file;\n\n        if (data.file.lastIndexOf('.') === -1)\n            this.MusicState.file = data.file + this.defaultMusicExt;\n        else\n            this.MusicState.file = data.file;\n        if (data.url && data.url.length > 0)\n            this.MusicState.url = data.url;\n        else if (this.forcedDefaultMusicURL && this.forcedDefaultMusicURL.length > 0)\n            this.MusicState.url = this.forcedDefaultMusicURL;\n        else if (this.defaultMusicURL && this.defaultMusicURL.length > 0)\n            this.MusicState.url = this.defaultMusicURL;\n        else\n            this.MusicState.url = '';\n        if (this.MusicState.url.length > 0 && !this.MusicState.url.endsWith('/'))\n            this.MusicState.url += '/';\n        if (data.type && data.type.length > 0) {\n            this.MusicState.url += data.type;\n            if (this.MusicState.url.length > 0 && !this.MusicState.url.endsWith('/'))\n                this.MusicState.url += '/';\n        }\n        if (old !== this.MusicState.file || !data.continue || !this.MusicState.playing) {\n            if (this.enableSound)\n                this.MusicState.play();\n            else\n                this.emit('playing', { type: 1, file: this.MusicState.file, sound: this.MusicState.sound, state: this.MusicState, duration: '--:--' });\n        }\n    }\n\n    /**\n     * sound - process music object and player/stop based on object options\n     *\n     * @param {Object} data Sound argument object, contains all settings\n     * @todo make it play/stop sound\n     */\n    public sound(data: MSPData) {\n        if (!this.enabled && !this.enableSound) return false;\n        if (!data.file || data.file.length === 0) {\n            if (data.off && data.url && data.url.length > 0)\n                this.defaultSoundURL = data.url;\n            else if (data.off)\n                this.SoundState.stop();\n            return;\n        }\n        else if (data.off) {\n            this.SoundState.stop();\n            return;\n        }\n        //if playing and new priority is lower, do not play new sound\n        if (this.SoundState.playing && data.priority < this.SoundState.priority)\n            return false;\n\n        this.SoundState.volume = data.volume;\n        this.SoundState.repeats = data.repeat;\n        this.SoundState.priority = data.priority;\n        if (data.file.lastIndexOf('.') === -1)\n            this.SoundState.file = data.file + this.defaultSoundExt;\n        else\n            this.SoundState.file = data.file;\n        if (data.url && data.url.length > 0)\n            this.SoundState.url = data.url;\n        else if (this.forcedDefaultSoundURL && this.forcedDefaultSoundURL.length > 0)\n            this.SoundState.url = this.forcedDefaultSoundURL;\n        else if (this.defaultSoundURL && this.defaultSoundURL.length > 0)\n            this.SoundState.url = this.defaultSoundURL;\n        else\n            this.SoundState.url = '';\n        if (this.SoundState.url.length > 0 && !this.SoundState.url.endsWith('/'))\n            this.SoundState.url += '/';\n        if (data.type && data.type.length > 0) {\n            this.SoundState.url += data.type;\n            if (this.SoundState.url.length > 0 && !this.SoundState.url.endsWith('/'))\n                this.SoundState.url += '/';\n        }\n        if (this.enableSound)\n            this.SoundState.play();\n        else\n            this.emit('playing', { type: 0, file: this.SoundState.file, sound: this.SoundState.sound, state: this.SoundState, duration: '--:--' });\n    }\n\n    /**\n     * processOption - process telnet options, if its MSP handle it and correctly reply yes we support MSP or no don't\n     *\n     * @param {Object} data Telnet#replyToOption event object\n     */\n    public processOption(data: TelnetOption) {\n        if (data.option === 90) {\n            this.debug('<MSP>');\n            if (data.verb === 253) {\n                this.server = true;\n                if (this.enabled) {\n                    this.debug('REPLY: <IAC><WILL><MSP>');\n                    data.telnet.sendData([255, 251, 90], true);\n                }\n                else {\n                    this.debug('REPLY: <IAC><DONT><MSP>');\n                    data.telnet.sendData([255, 254, 90], true);\n                }\n            }\n            else if (data.verb === 254) {\n                this.server = false;\n                this.debug('REPLY: <IAC><WONT><MSP>');\n                data.telnet.sendData([255, 252, 90], true);\n            }\n            else if (data.verb === 251) {\n                this.server = true;\n                if (this.enabled) {\n                    this.debug('REPLY: <IAC><DO><MSP>');\n                    data.telnet.sendData([255, 253, 90], true);\n                }\n                else {\n                    this.debug('REPLY: <IAC><DONT><MSP>');\n                    data.telnet.sendData([255, 254, 90], true);\n                }\n            }\n            else if (data.verb === 252) {\n                this.server = false;\n                this.debug('REPLY: <IAC><DONT><MSP>');\n                data.telnet.sendData([255, 254, 90], true);\n            }\n            data.handled = true;\n        }\n    }\n\n    /**\n     * processGMCP - process incoming GMCP for Client.Media events\n     * @param {string} mod Client#received-GMCP module\n     * @param {Object} data Client#received-GMCP data object\n     */\n    public async processGMCP(mod: string, data: any) {\n        switch (mod) {\n            case 'Client.Media.Default':\n                if (data.type === 'sound' || !data.type)\n                    this.sound({ off: true, url: data.url });\n                else if (data.type === 'music')\n                    this.music({ off: true, url: data.url });\n                break;\n            //as we don't support loading and caching of media ignore this\n            case 'Client.Media.Load':\n                break;\n            case 'Client.Media.Play':\n                //start off with default values\n                const sound: MSPData = { off: false, file: data.name, url: '', volume: 50, repeat: 1, priority: 50, type: '', continue: true };\n                //process incoming data and set as needed\n                if (data.hasOwnProperty('url'))\n                    sound.url = data.url;\n                if (data.hasOwnProperty('tag'))\n                    sound.type = data.tag;\n                if (data.hasOwnProperty('volume'))\n                    sound.volume = data.volume;\n                if (data.hasOwnProperty('loops'))\n                    sound.repeat = data.loops;\n                if (data.hasOwnProperty('priority'))\n                    sound.priority = data.priority;\n                if (data.type === 'sound' || !data.type)\n                    this.sound(sound);\n                else if (data.type === 'music') {\n                    if (data.hasOwnProperty('continue') && (data.continue === 'false' || !data.continue))\n                        sound.continue = false;\n                    this.music(sound);\n                }\n                break;\n            case 'Client.Media.Stop':\n                if (data.type === 'sound' || !data.type)\n                    this.sound({ off: true });\n                else if (data.type === 'music')\n                    this.music({ off: true });\n                break;\n        }\n    }\n\n    /**\n     * debug - emit debug event if enabledDebug on\n     * @param {string | object} e The debug message or an object of data \n     */\n    public debug(e) {\n        if (!this.enableDebug) return;\n        this.emit('debug', e);\n    }\n\n    /**\n     * Process function event to execute custom text functions\n     * @param data {FunctionEvent} The data about the function to execute\n     */\n    public processFunction(data: FunctionEvent) {\n        let args;\n        let tmp;\n        let i;\n        if (!data) return;\n        switch (data.name.toLowerCase()) {\n            case 'soundinfo':\n                if (this.SoundState.playing)\n                    this.client.echo('Playing Sound - ' + this.SoundState.file + ' - ' + buzz.toTimer(this.SoundState.sound.getTime()) + '/' + buzz.toTimer(this.SoundState.sound.getDuration()), -7, -8, true, true);\n                else\n                    this.client.echo('No sound currently playing.', -7, -8, true, true);\n                data.handled = true;\n                break;\n            case 'musicinfo':\n                if (this.MusicState.playing)\n                    this.client.echo('Playing Music - ' + this.MusicState.file + ' -  ' + buzz.toTimer(this.MusicState.sound.getTime()) + '/' + buzz.toTimer(this.MusicState.sound.getDuration()), -7, -8, true, true);\n                else\n                    this.client.echo('No music currently playing.', -7, -8, true, true);\n                data.handled = true;\n                break;\n            case 'playmusic':\n            case 'playm':\n                args = this.client.input.parseOutgoing(data.args.join(' '), false);\n                tmp = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                i = args.lastIndexOf('/');\n                if (i === -1)\n                    tmp.file = args;\n                else {\n                    tmp.file = args.substring(i + 1);\n                    tmp.url = args.substring(0, i + 1);\n                }\n                this.music(tmp);\n                data.handled = true;\n                break;\n            case 'playsound':\n            case 'plays':\n                args = this.client.input.parseOutgoing(data.args.join(' '), false);\n                tmp = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                i = args.lastIndexOf('/');\n                if (i === -1)\n                    tmp.file = args;\n                else {\n                    tmp.file = args.substring(i + 1);\n                    tmp.url = args.substring(0, i + 1);\n                }\n                this.sound(tmp);\n                data.handled = true;\n                break;\n            case 'stopmusic':\n            case 'stopm':\n                this.MusicState.close();\n                data.handled = true;\n                break;\n            case 'stopsound':\n            case 'stops':\n                this.SoundState.close();\n                data.handled = true;\n                break;\n            case 'stopallsound':\n            case 'stopa':\n                this.MusicState.close();\n                this.SoundState.close();\n                data.handled = true;\n                break;\n\n        }\n    }\n}", "import { Client } from \"./client\";\r\nimport { EventEmitter } from './events.js';\r\nimport { MenuItem } from './types';\r\n\r\nexport abstract class Plugin extends EventEmitter {\r\n    #client;\r\n    public get client() { return this.#client; }\r\n    public set client(value: Client) {\r\n        if (value === this.#client) return;\r\n        this.remove();\r\n        this.#client = value;\r\n        this.initialize();\r\n    }\r\n\r\n    constructor(client: Client) {\r\n        super();\r\n        this.#client = client;\r\n    }\r\n\r\n    public abstract remove(): void;\r\n    public abstract initialize(): void;\r\n    abstract get menu(): MenuItem[];\r\n    abstract get settings(): MenuItem[];\r\n}", "import { Plugin } from '../plugin';\r\nimport { MenuItem, FunctionEvent } from '../types';\r\nimport { Client } from '../client';\r\nimport { Ansi, AnsiColorCode } from '../ansi';\r\nimport { openFileDialog, readFile, StringToUint8Array } from '../library'\r\n\r\nexport class Test extends Plugin {\r\n    /**\r\n     * Contains a list of functions\r\n     * @type {object}\r\n     * @memberof Tests\r\n     */\r\n    public functions: object = {};\r\n    private _event;\r\n\r\n    constructor(client: Client) {\r\n        super(client);\r\n        this._event = data => this.processFunction(data);\r\n        this.functions['testfile'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let n = this.client.getOption('enableCommands');\r\n                    this.client.setOption('enableCommands', true);\r\n                    let i = new Date().getTime();\r\n                    console.time('testfile parse');\r\n                    this.client.sendCommand(contents, null, this.client.getOption('allowCommentsFromCommand'));\r\n                    console.timeEnd('testfile parse');\r\n                    let p = new Date().getTime();\r\n                    this.client.setOption('enableCommands', n);\r\n                    this.client.print(`Time: ${p - i}\\n`, true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testfiler'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let n = this.client.getOption('enableCommands');\r\n                    this.client.setOption('enableCommands', true);\r\n                    let i = new Date().getTime();\r\n                    console.time('testfiler parse');\r\n                    this.client.telnet.receivedData(StringToUint8Array(contents), true, true);\r\n                    console.timeEnd('testfiler parse');\r\n                    let p = new Date().getTime();\r\n                    this.client.setOption('enableCommands', n);\r\n                    this.client.print(`Time: ${p - i}\\n`, true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testspeedfile'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testspeedfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testspeedfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testspeedfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let avg = 0;\r\n                    let max = 0;\r\n                    let min = 0;\r\n                    let items = [];\r\n                    let p;\r\n                    console.time(`testspeedfile`);\r\n                    for (let i = 0; i < 10; i++) {\r\n                        const start = new Date().getTime();\r\n                        console.time(`testspeedfile parse ${i}`);\r\n                        this.client.sendCommand(contents, null, this.client.getOption('allowCommentsFromCommand'));\r\n                        console.timeEnd(`testspeedfile parse ${i}`);\r\n                        const end = new Date().getTime();\r\n                        p = end - start;\r\n                        avg += p;\r\n                        if (p > max) max = p;\r\n                        if (!min || p < min) min = p;\r\n                        items.push(`${i} - ${p}`);\r\n                    }\r\n                    console.timeEnd(`testspeedfile`);\r\n                    items.push(`Total - ${avg}`);\r\n                    items.push(`Average - ${avg / 10}`);\r\n                    items.push(`Min - ${min}`);\r\n                    items.push(`Max - ${max}`);\r\n                    this.client.print(items.join('\\n') + '\\n', true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testspeedfiler'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testspeedfiler');\r\n            openFileDialog().then(files => {\r\n                console.time('testspeedfile readFile');\r\n                readFile(files[0]).then(contents => {\r\n                    console.timeEnd('testspeedfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let avg = 0;\r\n                    let max = 0;\r\n                    let min = 0;\r\n                    let items = [];\r\n                    let p;\r\n                    console.time(`testspeedfile`);\r\n                    for (let i = 0; i < 10; i++) {\r\n                        const start = new Date().getTime();\r\n                        console.time(`testspeedfile parse ${i}`);\r\n                        this.client.telnet.receivedData(StringToUint8Array(contents), true, true);\r\n                        console.timeEnd(`testspeedfile parse ${i}`);\r\n                        const end = new Date().getTime();\r\n                        p = end - start;\r\n                        avg += p;\r\n                        if (p > max) max = p;\r\n                        if (!min || p < min) min = p;\r\n                        items.push(`${i} - ${p}`);\r\n                    }\r\n                    console.timeEnd(`testspeedfile`);\r\n                    items.push(`Total - ${avg}`);\r\n                    items.push(`Average - ${avg / 10}`);\r\n                    items.push(`Min - ${min}`);\r\n                    items.push(`Max - ${max}`);\r\n                    this.client.print(items.join('\\n') + '\\n', true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n\r\n        this.functions['testlist'] = () => {\r\n            let sample = 'Test commands:\\n';\r\n            let t;\r\n            for (t in this.functions) {\r\n                if (!this.functions.hasOwnProperty(t)) continue;\r\n                sample += `\\t${this.client.getOption('commandChar') + t}\\n`;\r\n            }\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testcolors'] = () => {\r\n            let r;\r\n            let sample = 'Colors and Styles\\n-------------------------------------------------------------------------------------------\\n';\r\n            for (r = 30; r < 38; r++) {\r\n                sample += '\\x1b[' + r + ';0m' + r + '\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1mBold\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';53mOverline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1;2;3;4;5;9;21;53mAll\\x1b[0m';\r\n                sample += '\\x1b[0m\\n';\r\n            }\r\n            for (r = 40; r < 48; r++) {\r\n                sample += '\\x1b[' + r + ';0m' + r + '\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1mBold\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';53mOverline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1;2;3;4;5;9;21;53mAll\\x1b[0m';\r\n                sample += '\\x1b[0m\\n';\r\n            }\r\n            sample += '-------------------------------------------------------------------------------------------\\n';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testcolorsdetails'] = () => {\r\n            let sample = '';\r\n            if (this.client.telnet.prompt)\r\n                sample = '\\n';\r\n            sample += 'Table for 16-color terminal escape sequences.\\n';\r\n            sample += '\\n';\r\n            sample += 'Background        | Foreground colors\\n';\r\n            sample += '------------------------------------------------------------------------------------\\n';\r\n            for (let bg = 40; bg <= 47; bg++) {\r\n                let a;\r\n                for (a in Ansi) {\r\n                    if (typeof Ansi[a] !== 'number') continue;\r\n                    if (a === 'Rapid') continue;\r\n                    //-16\r\n                    if (a === 'None')\r\n                        sample += '\\x1B[0m ' + AnsiColorCode[(bg - 10)].toString().padEnd(16) + ' | ';\r\n                    else\r\n                        sample += '\\x1B[0m ' + a.padEnd(16) + ' | ';\r\n                    //-7\r\n                    for (let fg = 30; fg <= 37; fg++) {\r\n                        if (a === 'None')\r\n                            sample += '\\x1B[' + bg + 'm\\x1B[' + fg + 'm ' + ('[' + fg + 'm').padEnd(7);\r\n                        else\r\n                            sample += '\\x1B[' + bg + 'm\\x1B[' + Ansi[a] + ';' + fg + 'm ' + ('[' + Ansi[a] + ';' + fg + 'm').padEnd(7);\r\n                    }\r\n                    sample += '\\x1B[0m\\n';\r\n                }\r\n                /*\r\n                for (int bold = 0; bold <= 9; bold++)\r\n                {\r\n                    if (bold == 6)\r\n                        continue;\r\n                    if (bold == 0)\r\n                        sample += \"\\x001B[0m \" + string.Format(\"{0, -10}\", \"ESC[\" + bg.ToString() + \"m\") + \" | \";\r\n                    else\r\n                        sample += \"\\x001B[0m \" + string.Format(\"{0, -10}\", ((Ansi)bold).ToString()) + \" | \";\r\n                    for (int fg = 30; fg <= 37; fg++)\r\n                    {\r\n                        if (bold == 0)\r\n                            sample += \"\\x001B[\" + bg.ToString() + \"m\\x001B[\" + fg.ToString() + \"m [\" + fg.ToString() + \"m  \";\r\n                        else\r\n                            sample += \"\\x001B[\" + bg.ToString() + \"m\\x001B[\" + bold.ToString() + \";\" + fg.ToString() + \"m [\" + bold.ToString() + \";\" + fg.ToString() + \"m\";\r\n                    }\r\n                    sample += \"\\x001B[0m\\n\";\r\n                }\r\n                */\r\n                sample += '------------------------------------------------------------------------------------\\n';\r\n            }\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testxterm'] = title => {\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let c;\r\n            let sample = '';\r\n            if (typeof title !== 'undefined' && title.length > 0) {\r\n                sample += 'Set Title: ';\r\n                sample += title;\r\n                sample += '\\x1B]0;';\r\n                sample += title;\r\n                sample += '\\u0007\\n';\r\n            }\r\n            sample += 'System colors:\\n';\r\n\r\n            for (c = 0; c < 8; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n';\r\n            for (c = 8; c < 16; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n\\n';\r\n            sample += 'Color cube, 6x6x6:\\n';\r\n\r\n            for (g = 0; g < 6; g++) {\r\n                for (r = 0; r < 6; r++) {\r\n                    for (b = 0; b < 6; b++) {\r\n                        c = (16 + (r * 36) + (g * 6) + b);\r\n                        sample += '\\x1B[48;5;' + c + 'm  ';\r\n                    }\r\n                    sample += '\\x1B[0m ';\r\n                }\r\n                sample += '\\n';\r\n            }\r\n            sample += 'Grayscale ramp:\\n';\r\n\r\n            for (c = 232; c < 256; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:disable\r\n        this.functions['testmxp'] = () => {\r\n            let sample = 'Text Formatting\\n';\r\n            sample += '\\t\\x1B[6z';\r\n            sample += '<!--Test-->&lt;!--Test--&gt;\\n';\r\n            sample += '\\t<!--Test>-->&lt;!--Test&gt;--&gt;\\n';\r\n            sample += '\\t<STRONG>STRONG</STRONG>\\n';\r\n            sample += '\\t<BOLD>BOLD</BOLD>\\n';\r\n            sample += '\\t<B>B</B>\\n';\r\n            sample += '\\t<I>I</I>\\n';\r\n            sample += '\\t<ITALIC>ITALIC</ITALIC>\\n';\r\n            sample += '\\t<EM>EM</EM>\\n';\r\n            sample += '\\t<U>U</U>\\n';\r\n            sample += '\\t<UNDERLINE>UNDERLINE</UNDERLINE>\\n';\r\n            sample += '\\t<S>S</S>\\n';\r\n            sample += '\\t<STRIKEOUT>STRIKEOUT</STRIKEOUT>\\n';\r\n            sample += '\\t<H>H</H>\\n';\r\n            sample += '\\t<HIGH>HIGH</HIGH>\\n';\r\n            sample += '\\t<C RED>C RED</C>\\n';\r\n            sample += '\\t<COLOR #F00>COLOR #F00</COLOR>\\n';\r\n            sample += '\\t<C Maroon>C Maroon</C>\\n';\r\n            sample += '\\t<COLOR #800000>COLOR #800000</COLOR>\\n';\r\n            sample += '\\t<H><C Maroon>H C Maroon</C></H>\\n';\r\n            sample += '\\t<H><COLOR #800000>H COLOR #800000</COLOR></H>\\n';\r\n            sample += '\\tRun <send PROMPT>#testmxpcolors</send> for a detailed list.\\n';\r\n            sample += '\\t<FONT \"Times New Roman\">FONT \"Times New Roman\"</FONT>\\n';\r\n            sample += '\\t<FONT \"Webdings\">FONT \"Webdings\"</FONT>\\n';\r\n            sample += '\\t<FONT COLOR=Red,Blink>FONT COLOR=Red,Blink</FONT>\\n';\r\n            sample += '\\t<FONT \"Times New Roman\" 24 RED GREEN>FONT \"Times New Roman\" 24 RED GREEN</FONT>\\n';\r\n            sample += 'Line Spacing\\n';\r\n            sample += '\\tNOBR<NOBR>\\n';\r\n            sample += ' Continued<NOBR>\\n';\r\n            sample += ' More\\n';\r\n            sample += '\\t<P>P\\n';\r\n            sample += '\\t1\\n';\r\n            sample += '\\t2\\n';\r\n            sample += '\\t3\\n';\r\n            sample += '\\t4</P>\\n';\r\n            sample += '\\tBR Line<BR>Break\\n';\r\n            sample += '\\tSBR Soft<SBR>Break\\n';\r\n            sample += 'Links\\n';\r\n            sample += '\\t<A \"http://shadowmud.com\">Click here for ShadowMUD</A> \\n';\r\n            sample += '\\t<send>test command</send>\\n';\r\n            sample += '\\t<send href=\"command2\">test command2</send>\\n';\r\n            sample += '\\t<send \"command1|command2|command3\" hint=\"click to see menu|Item 1|Item 2|Item 3\">this is a menu link</SEND>\\n';\r\n            sample += '\\t<SEND \"sample\" PROMPT EXPIRE=prompt>Prompt sample</SEND>\\n';\r\n            sample += '\\t<send PROMPT href=\"#testmxpexpire\">&lt;EXPIRE&gt; - #testmxpexpire</send> \\n';\r\n            sample += 'Horizontal Rule\\n';\r\n            sample += '<hr>\\n';\r\n            sample += '<hr>Text After\\n';\r\n            sample += 'Text Before<hr>\\n';\r\n            sample += '<c red blue><hr></c>\\n';\r\n            sample += 'Text Before<hr>Text After\\n';\r\n            sample += 'Custom Element\\n';\r\n            sample += '\\t<!ELEMENT help \\'<send href=\"help &text;\">\\'>&lt;!ELEMENT help \\'&lt;send href=\"help &amp;text;\"&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;help&gt;test&lt;/help&gt; = <help>test</help>\\n';\r\n            sample += '\\t<!ELEMENT redbu \\'<c red><b><u>\\'>&lt;!ELEMENT redbu \\'&lt;c red&gt;&lt;b&gt;&lt;u&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;redbu&gt;test&lt;/redbu&gt; = <redbu>test</redbu>\\n';\r\n            sample += 'Entities\\n';\r\n            sample += '\\t&#243;&brvbar;&copy;&plusmn;&sup3;&para;&frac34;&infin;&Dagger;&dagger;&spades;&clubs;&hearts;&diams;\\n';\r\n            sample += 'Custom Entity\\n';\r\n            sample += '\\t<!ENTITY version \"' + this.client.version + '\">&lt;!ENTITY version \"' + this.client.version + '\"&gt;\\n';\r\n            sample += '\\t&amp;version; = &version;\\n';\r\n            sample += '\\t&lt;V Hp&gt;<V Hp>100</V>&lt;/V&gt; &amp;Hp; = &Hp; &amp;hp; = &hp;\\n';\r\n            sample += '\\t&lt;VAR Sp&gt;<VAR Sp>200</VAR>&lt;/VAR&gt; &amp;Sp; = &Sp; &amp;sp; = &sp;\\n';\r\n            sample += 'Image\\n';\r\n            sample += 'default      <image connected.png URL=\"./images/\" w=48 h=48>\\n';\r\n            sample += 'align left <image connected.png URL=\"./images/\" align=left w=48 h=48> align left\\n';\r\n            sample += 'align right  <image connected.png URL=\"./images/\" align=right w=48 h=48> align right\\n';\r\n            sample += 'align top    <image connected.png URL=\"./images/\" align=top w=48 h=48> align top \\n';\r\n            sample += 'align middle <image connected.png URL=\"./images/\" align=middle w=48 h=48> align middle\\n';\r\n            sample += 'align bottom <image connected.png URL=\"./images/\" align=bottom w=48 h=48> align bottom\\n';\r\n            sample += 'map          <send showmap><image connected.png URL=\"./images/\" ismap w=48 h=48></send>\\n';\r\n            sample += '<STAT Hp version Test>';\r\n            sample += '<GAUGE Hp version Test>';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxp2'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += '<!-- Elements to support the Auto mapper -->';\r\n            sample += '<!ELEMENT RName \\'<FONT COLOR=Red><B>\\' FLAG=\"RoomName\">';\r\n            sample += '<!ELEMENT RDesc FLAG=\\'RoomDesc\\'>';\r\n            sample += '<!ELEMENT RExits \\'<FONT COLOR=Blue>\\' FLAG=\\'RoomExit\\'>';\r\n            sample += '<!-- The next element is used to define a room exit link that sends ';\r\n            sample += 'the exit direction to the MUD if the user clicks on it -->';\r\n            sample += '<!ELEMENT Ex \\'<SEND>\\'>';\r\n            sample += '<!ELEMENT Chat \\'<FONT COLOR=Gray>\\' OPEN>';\r\n            sample += '<!ELEMENT Gossip \\'<FONT COLOR=Cyan>\\' OPEN>';\r\n            sample += '<!-- in addition to standard HTML Color specifications, you can use ';\r\n            sample += 'color attribute names such as blink -->';\r\n            sample += '<!ELEMENT ImmChan \\'<FONT COLOR=Red,Blink>\\'>';\r\n            sample += '<!ELEMENT Auction \\'<FONT COLOR=Purple>\\' OPEN>';\r\n            sample += '<!ELEMENT Group \\'<FONT COLOR=Blue>\\' OPEN>';\r\n            sample += '<!-- the next elements deal with the MUD prompt -->';\r\n            sample += '<!ELEMENT Prompt FLAG=\"Prompt\">';\r\n            sample += '<!ELEMENT Hp FLAG=\"Set hp\">';\r\n            sample += '<!ELEMENT MaxHp FLAG=\"Set maxhp\">';\r\n            sample += '<!ELEMENT Mana FLAG=\"Set mana\">';\r\n            sample += '<!ELEMENT MaxMana FLAG=\"Set maxmana\">';\r\n            sample += '<!-- now the MUD text -->';\r\n            sample += '<RName>The Main Temple</RName>\\n';\r\n            sample += '<RDesc>This is the main hall of the MUD where everyone starts.\\n';\r\n            sample += 'Marble arches lead south into the town, and there is a <i>lovely</i>\\n';\r\n            sample += '<send \"drink &text;\">fountain</send> in the center of the temple,</RDesc>\\n';\r\n            sample += '<RExits>Exits: <Ex>N</Ex>, <Ex>S</Ex>, <Ex>E</Ex>, <Ex>W</Ex></RExits>\\n\\n';\r\n            sample += '<Prompt>[<Hp>100</Hp>/<MaxHp>120</MaxHp>hp <Mana>50</Mana>/<MaxMana>55</MaxMana>mana]</Prompt>\\n<hr>';\r\n            sample += '<!ELEMENT boldtext \\'<COLOR &col;><B>\\' ATT=\\'col=red\\'>';\r\n            sample += '<boldtext>This is bold red</boldtext>\\n';\r\n            sample += '<boldtext col=blue>This is bold blue text</boldtext>\\n';\r\n            sample += '<boldtext blue>This is also bold blue text</boldtext>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:enable\r\n        this.functions['testmxpexpire'] = () => {\r\n            this.client.print('\\t\\x1B[6z<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\n', true);\r\n            this.client.print('\\t\\x1B[6z\\x1b[36m<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\x1b[0m\\n', true);\r\n            this.client.print('\\t\\x1B[6z\\x1b[46;30m<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\x1b[0m\\n', true);\r\n            this.client.print('\\t\\x1B[6z<SEND \"sample\" PROMPT EXPIRE=prompt>Expire \\x1b[36msample\\x1b[0m</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire \\x1b[36msample2\\x1b[0m</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire \\x1b[36msample3\\x1b[0m</SEND>\\x1B[0z\\n', true);\r\n        };\r\n\r\n        this.functions['testmxpcolors'] = () => {\r\n            const colors = ['IndianRed', 'LightCoral', 'Salmon', 'DarkSalmon', 'LightSalmon',\r\n                'Crimson', 'Red', 'FireBrick', 'DarkRed', 'Pink', 'LightPink', 'HotPink', 'DeepPink',\r\n                'MediumVioletRed', 'PaleVioletRed', 'LightSalmon', 'Coral', 'Tomato', 'OrangeRed',\r\n                'DarkOrange', 'Orange', 'Gold', 'Yellow', 'LightYellow', 'LemonChiffon',\r\n                'LightGoldenrodYellow', 'PapayaWhip', 'Moccasin', 'PeachPuff', 'PaleGoldenrod',\r\n                'Khaki', 'DarkKhaki', 'Lavender', 'Thistle', 'Plum', 'Violet', 'Orchid', 'Fuchsia',\r\n                'Magenta', 'MediumOrchid', 'MediumPurple', 'BlueViolet', 'DarkViolet',\r\n                'DarkOrchid', 'DarkMagenta', 'Purple', 'Indigo', 'SlateBlue', 'DarkSlateBlue',\r\n                'MediumSlateBlue', 'GreenYellow', 'Chartreuse', 'LawnGreen', 'Lime', 'LimeGreen',\r\n                'PaleGreen', 'LightGreen', 'MediumSpringGreen', 'SpringGreen', 'MediumSeaGreen',\r\n                'SeaGreen', 'ForestGreen', 'Green', 'DarkGreen', 'YellowGreen', 'OliveDrab',\r\n                'Olive', 'DarkOliveGreen', 'MediumAquamarine', 'DarkSeaGreen', 'LightSeaGreen',\r\n                'DarkCyan', 'Teal', 'Aqua', 'Cyan', 'LightCyan', 'PaleTurquoise', 'Aquamarine',\r\n                'Turquoise', 'MediumTurquoise', 'DarkTurquoise', 'CadetBlue', 'SteelBlue',\r\n                'LightSteelBlue', 'PowderBlue', 'LightBlue', 'SkyBlue', 'LightSkyBlue',\r\n                'DeepSkyBlue', 'DodgerBlue', 'CornflowerBlue', 'MediumSlateBlue', 'RoyalBlue',\r\n                'Blue', 'MediumBlue', 'DarkBlue', 'Navy', 'MidnightBlue', 'Cornsilk',\r\n                'BlanchedAlmond', 'Bisque', 'NavajoWhite', 'Wheat', 'BurlyWood', 'Tan',\r\n                'RosyBrown', 'SandyBrown', 'Goldenrod', 'DarkGoldenrod', 'Peru', 'Chocolate',\r\n                'SaddleBrown', 'Sienna', 'Brown', 'Maroon', 'White', 'Snow', 'Honeydew',\r\n                'MintCream', 'Azure', 'AliceBlue', 'GhostWhite', 'WhiteSmoke', 'Seashell',\r\n                'Beige', 'OldLace', 'FloralWhite', 'Ivory', 'AntiqueWhite', 'Linen',\r\n                'LavenderBlush', 'MistyRose', 'Gainsboro', 'LightGrey', 'Silver', 'DarkGray',\r\n                'Gray', 'DimGray', 'LightSlateGray', 'SlateGray', 'DarkSlateGray', 'Black'];\r\n            let sample = '\\x1B[6z';\r\n            const cl = colors.length - 1;\r\n            for (let c = 0; c < cl; c++) {\r\n                sample += '' + colors[c] + ': ';\r\n                sample += Array(22 - colors[c].length).join(' ');\r\n                sample += '<C ' + colors[c] + '>Fore</C> ';\r\n                sample += '<C black ' + colors[c] + '>Back</C> ';\r\n                sample += '<h><C ' + colors[c] + '>High</C></h> ';\r\n                sample += '<b><C ' + colors[c] + '>Bold</C></b> ';\r\n                sample += '<C ' + colors[c] + '>\\x1b[1mAnsiBold\\x1b[0m ';\r\n                sample += '\\x1b[2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[53mOverline\\x1b[0m';\r\n                sample += '</C>\\n';\r\n            }\r\n            sample += 'Black: ';\r\n            sample += Array(17).join(' ');\r\n            sample += '<C Black silver>Fore</C> ';\r\n            sample += '<C silver Black>Back</C> ';\r\n            sample += '<h><C Black silver>High</C></h> ';\r\n            sample += '<b><C Black silver>Bold</C></b> ';\r\n            sample += '<C Black silver>\\x1b[1mAnsiBold\\x1b[0m ';\r\n            sample += '\\x1b[2mFaint\\x1b[0m ';\r\n            sample += '\\x1b[3mItalic\\x1b[0m ';\r\n            sample += '\\x1b[4mUnderline\\x1b[0m ';\r\n            sample += '\\x1b[5mFlash\\x1b[0m ';\r\n            sample += '\\x1b[7mInverse\\x1b[0m ';\r\n            sample += '\\x1b[8mConceal\\x1b[0m ';\r\n            sample += '\\x1b[9mStrikeout\\x1b[0m ';\r\n            sample += '\\x1b[21mDoubleUnderline\\x1b[0m ';\r\n            sample += '\\x1b[53mOverline\\x1b[0m';\r\n            sample += '</C>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxpelements'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += 'Custom Element\\n';\r\n            sample += '\\t<!ELEMENT help \\'<send href=\"help &text;\">\\'>&lt;!ELEMENT help \\'&lt;send href=\"help &amp;text;\"&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;help&gt;test&lt;/help&gt; = <help>test</help>\\n';\r\n            sample += '\\t<!ELEMENT redbu \\'<c red><b><u>\\'>&lt;!ELEMENT redbu \\'&lt;c red&gt;&lt;b&gt;&lt;u&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;redbu&gt;test&lt;/redbu&gt; = <redbu>test</redbu>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxpLines'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += '<!ELEMENT Auction \\'<FONT COLOR=red>\\' TAG=20 OPEN>';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>';\r\n            sample += '<!ELEMENT Auction TAG=20>\\n';\r\n            sample += '<!TAG 20 Fore=red>\\n';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>\\n';\r\n            sample += '\\x1B[6z<!TAG 20 Fore=blue>\\n';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmapper'] = () => {\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 0, dir: '', area: '' },\r\n                area: 'Doc Build Samples Area',\r\n                exits: {\r\n                    south: { num: 87723359, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -329701270, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 1',\r\n                num: 1968208336,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 1968208336, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'wood',\r\n                exits: {\r\n                    south: { num: 1916648905, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -1688332036, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 1968208336, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 2',\r\n                num: -329701270,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -329701270, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'jungle',\r\n                exits: {\r\n                    south: { num: -348853133, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: -329701270, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 3',\r\n                num: -1688332036,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -1688332036, dir: 'south', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'grass',\r\n                exits: {\r\n                    north: { num: -1688332036, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: 2072768994, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 1916648905, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                }, name: 'Sample room 6',\r\n                num: -348853133,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -348853133, dir: 'west', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'desert',\r\n                exits: {\r\n                    north: { num: -329701270, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: 210551156, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -348853133, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 87723359, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 5',\r\n                num: 1916648905,\r\n                indoors: 1\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 1916648905, dir: 'west', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'tundra',\r\n                exits: {\r\n                    north: { num: 1968208336, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: -1674322715, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 87723359, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 4',\r\n                num: 87723359,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 87723359, dir: 'south', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'water',\r\n                exits: {\r\n                    north: { num: 87723359, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 210551156, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 7',\r\n                num: -1674322715,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -1674322715, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'jungle',\r\n                exits: {\r\n                    north: { num: 1916648905, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 2072768994, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: -1674322715, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 8',\r\n                num: 210551156,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 210551156, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                exits: {\r\n                    north: { num: -348853133, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 210551156, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 9',\r\n                num: 2072768994,\r\n                indoors: 0\r\n            });\r\n        };\r\n\r\n        this.functions['testfansi'] = () => {\r\n            let sample = '';\r\n            let i;\r\n            sample = String.fromCharCode(1);\r\n            for (i = 3; i <= 6; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 14; i <= 26; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 28; i <= 31; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 127; i <= 254; i++)\r\n                sample += String.fromCharCode(i);\r\n            sample += '\\n';\r\n            const dcc = this.client.display.displayControlCodes;\r\n            this.client.display.displayControlCodes = true;\r\n            if (!this.client.display.emulateTerminal) {\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = true;\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = false;\r\n            }\r\n            else {\r\n                this.client.display.emulateTerminal = false;\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = true;\r\n                this.client.print(sample, true);\r\n            }\r\n            this.client.display.displayControlCodes = dcc;\r\n        };\r\n\r\n        this.functions['testcontrolchars'] = () => {\r\n            let i;\r\n            let sample = '1:  ' + String.fromCharCode(1) + ',';\r\n            for (i = 3; i <= 9; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 11; i <= 27; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 28; i <= 31; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 127; i <= 254; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            sample += '\\n';\r\n            const dcc = this.client.display.displayControlCodes;\r\n            this.client.display.displayControlCodes = true;\r\n            this.client.print(sample, true)\r\n            this.client.display.displayControlCodes = dcc;\r\n        }\r\n\r\n        //spell-checker:disable\r\n        this.functions['testurldetect'] = () => {\r\n            let sample = '\\x1B[0mhttp://www.google.com\\n';\r\n            sample += '\\thttp://www.google.com\\x1B[44m\\n';\r\n            sample += 'http://www.google.com\\n';\r\n            sample += '\\ttry this http://www.google.com\\n';\r\n            sample += 'http://www.google.com try this\\n';\r\n            sample += '\\ttry this http://www.google.com try this\\n';\r\n            sample += '\\x1B[36mhttp://www.google.com\\n';\r\n            sample += '\\t\\x1B[0mhttp://www.google.com\\n';\r\n            sample += 'http://www.google.com\\x1B[44m\\n';\r\n            sample += '\\thttp://www.google.com\\n';\r\n            sample += 'try this http://www.google.com\\n';\r\n            sample += '\\thttp://www.google.com try this\\n';\r\n            sample += 'try this http://www.google.com try this\\n';\r\n            sample += '\\t\\x1B[36mhttp://www.google.com\\n';\r\n            sample += '\\thttps://localhost telnet://localhost\\n';\r\n            sample += '\\tnews://test.edu/default.asp?t=1#1111 torrent://localhost/\\n';\r\n            sample += '\\tftp://localhost gopher://localhost im://talk\\n';\r\n            sample += '\\tmailto:address@localhost irc://<host>[:<port>]/[<channel>[?<password>]]\\n';\r\n            sample += 'awww... www.google.com awww.com\\n';\r\n            sample += 'www.google.com www.google.com\\x1B[0m';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:enable\r\n\r\n        this.functions['testxtermrgb'] = () => {\r\n            let sample = '';\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let i = 0;\r\n            for (r = 0; r < 256; r += 16) {\r\n                for (g = 0; g < 256; g += 16) {\r\n                    for (b = 0; b < 256; b += 16) {\r\n                        sample += '\\x1B[48;2;' + r + ';' + g + ';' + b + 'm  ';\r\n                        if (i % 63 === 0)\r\n                            sample += '\\n';\r\n                        i++;\r\n                    }\r\n                }\r\n            }\r\n            sample += '\\x1B[0m';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testsize'] = () => {\r\n            const ws = this.client.display.WindowSize;\r\n            let sample = ws.width + 'x' + ws.height + ' ';\r\n            ws.width -= sample.length;\r\n            for (let w = 0; w < ws.width; w++)\r\n                sample += 'w';\r\n            for (let h = 1; h < ws.height; h++)\r\n                sample += '\\n' + h;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testspeed'] = () => {\r\n            const sample = [];\r\n            const commands = this.client.getOption('commandChar') + ['testmxpcolors', 'testmxp', 'testcolors', 'testcolorsdetails', 'testxterm', 'testxtermrgb'].join('\\n' + this.client.getOption('commandChar'));\r\n            const e = this.client.getOption('enableCommands');\r\n            this.client.setOption('enableCommands', true);\r\n            let avg = 0;\r\n            let max = 0;\r\n            let min = 0;\r\n            let t;\r\n            for (let i = 0; i < 10; i++) {\r\n                const start = new Date().getTime();\r\n                this.client.sendCommand(commands);\r\n                const end = new Date().getTime();\r\n                t = end - start;\r\n                avg += t;\r\n                if (t > max) max = t;\r\n                if (!min || t < min) min = t;\r\n                sample.push(`${i} - ${t}`);\r\n            }\r\n            sample.push(`Total - ${avg}`);\r\n            sample.push(`Average - ${avg / 10}`);\r\n            sample.push(`Min - ${min}`);\r\n            sample.push(`Max - ${max}`);\r\n            this.client.print(sample.join('\\n') + '\\n', true);\r\n            this.client.setOption('enableCommands', e);\r\n        };\r\n\r\n        this.functions['testperiod'] = () => {\r\n            if (window['periodID']) {\r\n                clearInterval(window['periodID']);\r\n                delete window['period'];\r\n                delete window['periodID'];\r\n                return;\r\n            }\r\n            window['period'] = 0;\r\n            window['periodID'] = setInterval(() => {\r\n                if (window['period'] % 3 === 1)\r\n                    this.client.sendCommand('#testcolors');\r\n                else if (window['period'] % 3 === 2)\r\n                    this.client.sendCommand('#testxterm');\r\n                else\r\n                    this.client.sendCommand('#testlist');\r\n                window['period']++;\r\n            }, 2000);\r\n        };\r\n\r\n        this.functions['testutf8'] = () => {\r\n            const sample = `Armenian\r\n\u0531 \u0532 \u0533 \u0534 \u0535 \u0536 \u0537 \u0538 \u0539 \u053A \u053B \u053C \u053D \u053E \u053F \u0540 \u0541 \u0542 \u0543 \u0544 \u0545 \u0546 \u0547 \u0548 \u0549 \u054A \u054B \u054C \u054D \u054E \u054F \u0550 \u0551 \u0552 \u0553 \u0554 \u0555 \u0556 \u0559 \u055A \u055B \u055C \u055D \u055E \u055F \u0561 \u0562 \u0563 \u0564 \u0565 \u0566 \u0567 \u0568 \u0569 \u056A \u056B \u056C \u056D \u056E \u056F \u0570 \u0571 \u0572 \u0573 \u0574 \u0575 \u0576 \u0577 \u0578 \u0579 \u057A \u057B \u057C \u057D \u057E \u057F \u0580 \u0581 \u0582 \u0583 \u0584 \u0585 \u0586 \u0587 \u0589\r\nHebrew\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DC \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\r\nArabic\r\n\u060C \u061B \u061F \u0621 \u0622 \u0623 \u0624 \u0625 \u0626 \u0627 \u0628 \u0629 \u062A \u062B \u062C \u062D \u062E \u062F \u0630 \u0631 \u0632 \u0633 \u0634 \u0635 \u0636 \u0637 \u0638 \u0639 \u063A \u0640 \u0641 \u0642 \u0643 \u0644 \u0645 \u0646 \u0647 \u0648 \u0649 \u064A \u064B \u064C \u064D \u064E \u064F \u0650 \u0651 \u0652 \u0660 \u0661 \u0662 \u0663 \u0664 \u0665 \u0666 \u0667 \u0668 \u0669 \u066A \u066B \u066C \u066D \u0670 \u0671 \u0672 \u0673 \u0674 \u0675 \u0676 \u0677 \u0678 \u0679 \u067A \u067B \u067C \u067D \u067E \u067F \u0680 \u0681 \u0682 \u0683 \u0684 \u0685 \u0686 \u0687 \u0688 \u0689 \u068A \u068B \u068C \u068D \u068E \u068F \u0690 \u0691 \u0692 \u0693 \u0694 \u0695 \u0696 \u0697 \u0698 \u0699 \u069A \u069B \u069C \u069D \u069E \u069F \u06A0 \u06A1 \u06A2 \u06A3 \u06A4 \u06A5 \u06A6 \u06A7 \u06A8 \u06A9 \u06AA \u06AB \u06AC \u06AD \u06AE \u06AF \u06B0 \u06B1 ...\r\nDevanagari\r\n\u0901 \u0902 \u0903 \u0905 \u0906 \u0907 \u0908 \u0909 \u090A \u090B \u090C \u090D \u090E \u090F \u0910 \u0911 \u0912 \u0913 \u0914 \u0915 \u0916 \u0917 \u0918 \u0919 \u091A \u091B \u091C \u091D \u091E \u091F \u0920 \u0921 \u0922 \u0923 \u0924 \u0925 \u0926 \u0927 \u0928 \u0929 \u092A \u092B \u092C \u092D \u092E \u092F \u0930 \u0931 \u0932 \u0933 \u0934 \u0935 \u0936 \u0937 \u0938 \u0939 \u093C \u093D \u093E \u093F \u0940 \u0941 \u0942 \u0943 \u0944 \u0945 \u0946 \u0947 \u0948 \u0949 \u094A \u094B \u094C \u094D \u0950 \u0951 \u0952 \u0953 \u0954 \u0958 \u0959 \u095A \u095B \u095C \u095D \u095E \u095F \u0960 \u0961 \u0962 \u0963 \u0964 \u0965 \u0966 \u0967 \u0968 \u0969 \u096A \u096B \u096C \u096D \u096E \u096F \u0970\r\nArmenian\r\n\u0531 \u0532 \u0533 \u0534 \u0535 \u0536 \u0537 \u0538 \u0539 \u053A \u053B \u053C \u053D \u053E \u053F \\x1b[33m\u0540 \u0541 \u0542 \u0543 \u0544 \u0545 \u0546 \u0547 \u0548 \u0549 \u054A \u054B \u054C \u054D \u054E \u054F \u0550 \u0551 \u0552 \\x1b[34m\u0553 \u0554 \u0555 \u0556 \u0559 \u055A \u055B \u055C \u055D \u055E \u055F \u0561 \u0562 \u0563 \u0564 \u0565 \u0566 \u0567 \u0568 \u0569 \u056A \u056B \u056C \u056D \u056E \u056F \u0570\\x1b[35m \u0571 \u0572 \u0573 \u0574 \u0575 \u0576 \u0577 \u0578 \u0579 \u057A \u057B \u057C \u057D \u057E \u057F \u0580 \u0581 \u0582 \u0583 \u0584 \u0585 \u0586 \u0587 \u0589\\x1b[0m\r\nHebrew\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E\\x1b[33m \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DC\\x1b[34m \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\\x1b[0m\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E\\x1b[33m \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DCa\\x1b[34m \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\\x1b[0m\r\nArabic\r\n\u060C \u061B \u061F \u0621 \u0622 \u0623 \u0624 \u0625 \u0626 \u0627 \u0628 \u0629 \u062A \u062B \u062C \u062D \u062E \u062F \u0630 \u0631 \u0632 \u0633 \u0634 \u0635 \u0636 \u0637 \u0638 \u0639\\x1b[34m \u063A \u0640 \u0641 \u0642 \u0643 \u0644 \u0645 \u0646 \u0647 \u0648 \u0649 \u064A \u064B \u064C \u064D \u064E \u064F \u0650 \u0651 \u0652 \u0660 \u0661 \u0662 \u0663 \u0664 \u0665 \u0666 \u0667 \u0668 \u0669 \u066A \u066B \u066C \u066D \u0670 \u0671 \u0672 \u0673 \u0674 \u0675 \u0676 \u0677 \u0678 \u0679 \u067A \u067B \u067C \u067D \u067E \u067F \u0680 \u0681 \u0682 \u0683 \u0684 \u0685 \u0686 \u0687 \u0688 \u0689 \u068A \u068B \u068C \u068D \u068E \u068F \u0690 \u0691 \u0692 \u0693 \u0694 \u0695 \u0696 \u0697 \u0698 \u0699 \u069A \u069B \u069C \u069D \u069E \u069F \u06A0 \u06A1 \u06A2 \u06A3 \u06A4 \u06A5 \u06A6 \\x1b[33m\u06A7 \u06A8 \u06A9 \u06AA \u06AB \u06AC \u06AD \u06AE \u06AF \u06B0 \u06B1 ...\\x1b[0m\r\nDevanagari\r\n\u0901 \u0902 \u0903 \u0905 \u0906 \u0907 \u0908 \u0909 \u090A \u090B \u090C \u090D \u090E \u090F \u0910 \u0911 \u0912 \u0913 \u0914 \u0915 \u0916 \u0917 \u0918 \u0919 \u091A \u091B \u091C \u091D \u091E \u091F \u0920 \u0921 \u0922 \u0923 \u0924 \u0925 \u0926 \u0927 \u0928 \u0929 \u092A \\x1b[33m\u092B \u092C \u092D \u092E \u092F \u0930 \u0931 \u0932 \u0933 \u0934 \u0935 \u0936 \u0937 \u0938 \u0939 \u093C \u093D \u093E \u093F \u0940 \u0941 \u0942 \u0943 \u0944 \u0945 \u0946 \u0947 \u0948 \u0949 \u094A \u094B \u094C \u094D \u0950 \u0951 \u0952 \u0953 \u0954 \u0958 \u0959 \u095A \u095B\\x1b[34m \u095C \u095D \u095E \u095F \u0960 \u0961 \u0962 \u0963 \u0964 \u0965 \u0966 \u0967 \u0968 \u0969 \u096A \u096B \u096C \u096D \u096E \u096F \u0970\\x1b[0m`;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testunicodeemoji'] = () => {\r\n            let sample = '';\r\n            //https://apps.timwhitlock.info/emoji/tables/unicode\r\n            var emojiRange = [\r\n                [0x1F601, 0x1F64F],//Emoticons ( 1F601 - 1F64F ) \r\n                [0x2702, 0x27B0], //Dingbats ( 2702 - 27B0 ) \r\n                [0x1F680, 0x1F6C0], //Transport and map symbols ( 1F680 - 1F6C0 ) \r\n                //[0x24C2, 0x1F251], //Enclosed characters ( 24C2 - 1F251 ) \r\n                [0x1F600, 0x1F636],  //Additional emoticons ( 1F600 - 1F636 )\r\n                [0x1F681, 0x1F6C5], //Additional transport and map symbols ( 1F681 - 1F6C5 ) \r\n                [0x1F30D, 0x1F567] //Other additional symbols ( 1F30D - 1F567 ) \r\n            ];\r\n            var n = 0;\r\n            for (var i = 0; i < emojiRange.length; i++) {\r\n                var range = emojiRange[i];\r\n                for (var x = range[0]; x < range[1]; x++) {\r\n                    sample += String.fromCodePoint(x);\r\n                    n++;\r\n                    if (n == 36) {\r\n                        sample += '\\n';\r\n                        n = 0;\r\n                    }\r\n                }\r\n                sample += '\\x1B[4z<hr>';\r\n                n = 0\r\n            }\r\n            let sample2 = '\\x1B[4z<hr>' + `\u00A9\u00AE\u203C\u2049#\u20E38\u20E39\u20E37\u20E30\u20E36\u20E35\u20E34\u20E33\u20E32\u20E31\u20E3\u2122\u2139\u2194\u2195\u2196\u2197\u2198\u2199\u21A9\u21AA\u231A\u231B\u23E9\u23EA\u23EB\u23EC\u23F0\u23F3\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FD\u25FE\u2600\u2601\u260E\u2611\u2614\u2615\r\n\u261D\u263A\u2648\u2649\u264A\u264B\u264C\u264D\u264E\u264F\u2650\u2651\u2652\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2693\u26A0\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\r\n\u26FA\u26FD\u2934\u2935\u2B05\u2B06\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299\uD83C\uDC04\uD83C\uDCCF\uD83C\uDF00\uD83C\uDF01\uD83C\uDF02\uD83C\uDF03\uD83C\uDF04\uD83C\uDF05\uD83C\uDF06\uD83C\uDF07\uD83C\uDF08\uD83C\uDF09\uD83C\uDF0A\uD83C\uDF0B\uD83C\uDF0C\uD83C\uDF0F\uD83C\uDF11\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\r\n\uD83C\uDF19\uD83C\uDF1B\uD83C\uDF1F\uD83C\uDF20\uD83C\uDF30\uD83C\uDF31\uD83C\uDF34\uD83C\uDF35\uD83C\uDF37\uD83C\uDF38\uD83C\uDF39\uD83C\uDF3A\uD83C\uDF3B\uD83C\uDF3C\uD83C\uDF3D\uD83C\uDF3E\uD83C\uDF3F\uD83C\uDF40\uD83C\uDF41\uD83C\uDF42\uD83C\uDF43\uD83C\uDF44\uD83C\uDF45\uD83C\uDF46\uD83C\uDF47\uD83C\uDF48\uD83C\uDF49\uD83C\uDF4A\uD83C\uDF4C\uD83C\uDF4D\uD83C\uDF4E\uD83C\uDF4F\uD83C\uDF51\r\n\uD83C\uDF52\uD83C\uDF53\uD83C\uDF54\uD83C\uDF55\uD83C\uDF56\uD83C\uDF57\uD83C\uDF58\uD83C\uDF59\uD83C\uDF5A\uD83C\uDF5B\uD83C\uDF5C\uD83C\uDF5D\uD83C\uDF5E\uD83C\uDF5F\uD83C\uDF60\uD83C\uDF61\uD83C\uDF62\uD83C\uDF63\uD83C\uDF64\uD83C\uDF65\uD83C\uDF66\uD83C\uDF67\uD83C\uDF68\uD83C\uDF69\uD83C\uDF6A\uD83C\uDF6B\uD83C\uDF6C\uD83C\uDF6D\uD83C\uDF6E\uD83C\uDF6F\uD83C\uDF70\uD83C\uDF71\uD83C\uDF72\r\n\uD83C\uDF73\uD83C\uDF74\uD83C\uDF75\uD83C\uDF76\uD83C\uDF77\uD83C\uDF78\uD83C\uDF79\uD83C\uDF7A\uD83C\uDF7B\uD83C\uDF80\uD83C\uDF81\uD83C\uDF82\uD83C\uDF83\uD83C\uDF84\uD83C\uDF85\uD83C\uDF86\uD83C\uDF87\uD83C\uDF88\uD83C\uDF89\uD83C\uDF8A\uD83C\uDF8B\uD83C\uDF8C\uD83C\uDF8D\uD83C\uDF8E\uD83C\uDF8F\uD83C\uDF90\uD83C\uDF91\uD83C\uDF92\uD83C\uDF93\uD83C\uDFA0\uD83C\uDFA1\uD83C\uDFA2\uD83C\uDFA3\uD83C\uDFA4\r\n\uD83C\uDFA5\uD83C\uDFA6\uD83C\uDFA7\uD83C\uDFA8\uD83C\uDFA9\uD83C\uDFAA\uD83C\uDFAB\uD83C\uDFAC\uD83C\uDFAD\uD83C\uDFAE\uD83C\uDFAF\uD83C\uDFB0\uD83C\uDFB1\uD83C\uDFB2\uD83C\uDFB3\uD83C\uDFB4\uD83C\uDFB5\uD83C\uDFB6\uD83C\uDFB7\uD83C\uDFB8\uD83C\uDFB9\uD83C\uDFBA\uD83C\uDFBB\uD83C\uDFBC\uD83C\uDFBD\uD83C\uDFBE\uD83C\uDFBF\uD83C\uDFC0\uD83C\uDFC1\uD83C\uDFC2\uD83C\uDFC3\uD83C\uDFC4\r\n\uD83C\uDFC6\uD83C\uDFC8\uD83C\uDFCA\uD83C\uDFE0\uD83C\uDFE1\uD83C\uDFE2\uD83C\uDFE3\uD83C\uDFE5\uD83C\uDFE6\uD83C\uDFE7\uD83C\uDFE8\uD83C\uDFE9\uD83C\uDFEA\uD83C\uDFEB\uD83C\uDFEC\uD83C\uDFED\uD83C\uDFEE\uD83C\uDFEF\uD83C\uDFF0\uD83D\uDC0C\uD83D\uDC0D\uD83D\uDC0E\uD83D\uDC11\uD83D\uDC12\uD83D\uDC14\uD83D\uDC17\uD83D\uDC18\uD83D\uDC19\uD83D\uDC1A\uD83D\uDC1B\uD83D\uDC1C\uD83D\uDC1D\r\n\uD83D\uDC1E\uD83D\uDC1F\uD83D\uDC20\uD83D\uDC21\uD83D\uDC22\uD83D\uDC23\uD83D\uDC24\uD83D\uDC25\uD83D\uDC26\uD83D\uDC27\uD83D\uDC28\uD83D\uDC29\uD83D\uDC2B\uD83D\uDC2C\uD83D\uDC2D\uD83D\uDC2E\uD83D\uDC2F\uD83D\uDC30\uD83D\uDC31\uD83D\uDC32\uD83D\uDC33\uD83D\uDC34\uD83D\uDC35\uD83D\uDC36\uD83D\uDC37\uD83D\uDC38\uD83D\uDC39\uD83D\uDC3A\uD83D\uDC3B\uD83D\uDC3C\uD83D\uDC3D\uD83D\uDC3E\r\n\uD83D\uDC40\uD83D\uDC42\uD83D\uDC43\uD83D\uDC44\uD83D\uDC45\uD83D\uDC46\uD83D\uDC47\uD83D\uDC48\uD83D\uDC49\uD83D\uDC4A\uD83D\uDC4B\uD83D\uDC4C\uD83D\uDC4D\uD83D\uDC4E\uD83D\uDC4F\uD83D\uDC50\uD83D\uDC51\uD83D\uDC52\uD83D\uDC53\uD83D\uDC54\uD83D\uDC55\uD83D\uDC56\uD83D\uDC57\uD83D\uDC58\uD83D\uDC59\uD83D\uDC5A\uD83D\uDC5B\uD83D\uDC5C\uD83D\uDC5D\uD83D\uDC5E\uD83D\uDC5F\uD83D\uDC60\uD83D\uDC61\uD83D\uDC62\r\n\uD83D\uDC63\uD83D\uDC64\uD83D\uDC66\uD83D\uDC67\uD83D\uDC68\uD83D\uDC69\uD83D\uDC6A\uD83D\uDC6B\uD83D\uDC6E\uD83D\uDC6F\uD83D\uDC70\uD83D\uDC71\uD83D\uDC72\uD83D\uDC73\uD83D\uDC74\uD83D\uDC75\uD83D\uDC76\uD83D\uDC77\uD83D\uDC78\uD83D\uDC79\uD83D\uDC7A\uD83D\uDC7B\uD83D\uDC7C\uD83D\uDC7D\uD83D\uDC7E\uD83D\uDC7F\uD83D\uDC80\uD83D\uDC81\uD83D\uDC82\uD83D\uDC83\uD83D\uDC84\uD83D\uDC85\uD83D\uDC86\r\n\uD83D\uDC87\uD83D\uDC88\uD83D\uDC89\uD83D\uDC8A\uD83D\uDC8B\uD83D\uDC8C\uD83D\uDC8D\uD83D\uDC8E\uD83D\uDC8F\uD83D\uDC90\uD83D\uDC91\uD83D\uDC92\uD83D\uDC93\uD83D\uDC94\uD83D\uDC95\uD83D\uDC96\uD83D\uDC97\uD83D\uDC98\uD83D\uDC99\uD83D\uDC9A\uD83D\uDC9B\uD83D\uDC9C\uD83D\uDC9D\uD83D\uDC9E\uD83D\uDC9F\uD83D\uDCA0\uD83D\uDCA1\uD83D\uDCA2\uD83D\uDCA3\uD83D\uDCA4\uD83D\uDCA5\uD83D\uDCA6\uD83D\uDCA7\r\n\uD83D\uDCA8\uD83D\uDCA9\uD83D\uDCAA\uD83D\uDCAB\uD83D\uDCAC\uD83D\uDCAE\uD83D\uDCAF\uD83D\uDCB0\uD83D\uDCB1\uD83D\uDCB2\uD83D\uDCB3\uD83D\uDCB4\uD83D\uDCB5\uD83D\uDCB8\uD83D\uDCB9\uD83D\uDCBA\uD83D\uDCBB\uD83D\uDCBC\uD83D\uDCBD\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDCC0\uD83D\uDCC1\uD83D\uDCC2\uD83D\uDCC3\uD83D\uDCC4\uD83D\uDCC5\uD83D\uDCC6\uD83D\uDCC7\uD83D\uDCC8\uD83D\uDCC9\uD83D\uDCCA\uD83D\uDCCB\r\n\uD83D\uDCCC\uD83D\uDCCD\uD83D\uDCCE\uD83D\uDCCF\uD83D\uDCD0\uD83D\uDCD1\uD83D\uDCD2\uD83D\uDCD3\uD83D\uDCD4\uD83D\uDCD5\uD83D\uDCD6\uD83D\uDCD7\uD83D\uDCD8\uD83D\uDCD9\uD83D\uDCDA\uD83D\uDCDB\uD83D\uDCDC\uD83D\uDCDD\uD83D\uDCDE\uD83D\uDCDF\uD83D\uDCE0\uD83D\uDCE1\uD83D\uDCE2\uD83D\uDCE3\uD83D\uDCE4\uD83D\uDCE5\uD83D\uDCE6\uD83D\uDCE7\uD83D\uDCE8\uD83D\uDCE9\uD83D\uDCEA\uD83D\uDCEB\uD83D\uDCEE\uD83D\uDCF0\r\n\uD83D\uDCF1\uD83D\uDCF2\uD83D\uDCF3\uD83D\uDCF4\uD83D\uDCF6\uD83D\uDCF7\uD83D\uDCF9\uD83D\uDCFA\uD83D\uDCFB\uD83D\uDCFC\uD83D\uDD03\uD83D\uDD0A\uD83D\uDD0B\uD83D\uDD0C\uD83D\uDD0D\uD83D\uDD0E\uD83D\uDD0F\uD83D\uDD10\uD83D\uDD11\uD83D\uDD12\uD83D\uDD13\uD83D\uDD14\uD83D\uDD16\uD83D\uDD17\uD83D\uDD18\uD83D\uDD19\uD83D\uDD1A\uD83D\uDD1B\uD83D\uDD1C\uD83D\uDD1D\uD83D\uDD1E\uD83D\uDD1F\uD83D\uDD20\r\n\uD83D\uDD21\uD83D\uDD22\uD83D\uDD23\uD83D\uDD24\uD83D\uDD25\uD83D\uDD26\uD83D\uDD27\uD83D\uDD28\uD83D\uDD29\uD83D\uDD2A\uD83D\uDD2B\uD83D\uDD2E\uD83D\uDD2F\uD83D\uDD30\uD83D\uDD31\uD83D\uDD32\uD83D\uDD33\uD83D\uDD34\uD83D\uDD35\uD83D\uDD36\uD83D\uDD37\uD83D\uDD38\uD83D\uDD39\uD83D\uDD3A\uD83D\uDD3B\uD83D\uDD3C\uD83D\uDD3D\uD83D\uDD50\uD83D\uDD51\uD83D\uDD52\uD83D\uDD53\uD83D\uDD54\uD83D\uDD55\r\n\uD83D\uDD56\uD83D\uDD57\uD83D\uDD58\uD83D\uDD59\uD83D\uDD5A\uD83D\uDD5B\uD83D\uDDFB\uD83D\uDDFC\uD83D\uDDFD\uD83D\uDDFE\uD83D\uDDFF`;\r\n            this.client.print(sample, true);\r\n            this.client.print(sample2, true);\r\n        };\r\n\r\n        this.functions['testlines'] = () => {\r\n            const maxLines = this.client.display.maxLines;\r\n            let sample = '';\r\n            const id = this.client.display.model.getNextLineID;\r\n            for (let h = 0; h < maxLines; h++)\r\n                sample += `Line: ${h}, LineID: ${id + h}\\n`;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testscreen'] = () => {\r\n            let sample = 'Window innerWidth: ' + window.innerWidth;\r\n            sample += '\\nWindow innerHeight: ' + window.innerHeight;\r\n            sample += '\\nDocument clientWidth: ' + document.body.clientWidth;\r\n            sample += '\\nDocument clientHeight: ' + document.body.clientHeight;\r\n            sample += '\\nDisplay clientWidth: ' + this.client.display.container.clientWidth;\r\n            sample += '\\nDisplay clientHeight: ' + this.client.display.container.clientHeight;\r\n            sample += '\\nScreen orientation: ' + screen?.orientation?.type;\r\n            this.client.print(sample, true);\r\n        }\r\n    }\r\n\r\n    public remove(): void {\r\n        if (!this.client) return;\r\n        this.client.off('function', this._event);\r\n    }\r\n\r\n    public initialize(): void {\r\n        if (!this.client) return;\r\n        this.client.on('function', this._event);\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [];\r\n    }\r\n\r\n    public get settings(): MenuItem[] {\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Process function event to execute custom text functions\r\n     * @param data {FunctionEvent} The data about the function to execute\r\n     */\r\n    public processFunction(data: FunctionEvent) {\r\n        let name;\r\n        //const data = { name: fun, args: args, raw: raw, handled: false, return: null };\r\n        if (!data) return;\r\n        name = data.name.toLowerCase();\r\n        //old name() format\r\n        if (name.endsWith('()'))\r\n            name = name.substring(0, name.length - 2);\r\n        if (this.functions[name]) {\r\n            console.time(name);\r\n            this.functions[name].apply(this, data || {});\r\n            console.timeEnd(name);\r\n            data.handled = true;\r\n        }\r\n    }\r\n}", "import \"../css/mapper.css\";\r\nimport { EventEmitter } from \"../events\";\r\nimport { copyText } from \"../library\";\r\nimport * as PF from './../lib/pathfinding3D.js'\r\nimport { Map, Room, RoomDetails } from \"../map\";\r\n\r\ndeclare let fileSaveAs;\r\n\r\ninterface MouseData {\r\n    x: number;\r\n    y: number;\r\n    button: number;\r\n    state: boolean;\r\n}\r\n\r\nexport enum UpdateType { none = 0, draw = 1 }\r\n\r\ninterface MapOptions {\r\n    container?: string | JQuery | HTMLElement;\r\n    map?: Map;\r\n}\r\n\r\nexport class MapDisplay extends EventEmitter {\r\n    private _container: HTMLElement;\r\n    private _canvas: HTMLCanvasElement;\r\n    private _context: CanvasRenderingContext2D;\r\n    private MousePrev: MouseData;\r\n    private Mouse: MouseData;\r\n    private MouseDown: MouseData;\r\n    private MouseDrag: MouseData = { x: 0, y: 0, button: 0, state: false };\r\n    private drag: boolean = false;\r\n    private vscroll: number = 0;\r\n    private hscroll: number = 0;\r\n    private markers = {};\r\n    private markedRooms;\r\n    private _updating: UpdateType = UpdateType.none;\r\n    private _rTimeout = 0;\r\n    private $drawCache;\r\n    private $focused = false;\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    public active: Room;\r\n    private _selected: Room;\r\n    public _showLegend: boolean = false;\r\n    public _splitArea: boolean = false;\r\n    public _fillWalls: boolean = false;\r\n    public _enabled: boolean = true;\r\n    public _follow: boolean = true;\r\n    public commandDelay: number = 500;\r\n    public commandDelayCount: number = 5;\r\n    private _scale: number = 1.0;\r\n    private _mapperNavDown = false;\r\n    private _pointerCache: PointerEvent[] = [];\r\n    private _pointerDistance: number = -1;\r\n    private _showNav: boolean = true;\r\n\r\n    private _map: Map;\r\n\r\n    get showNavigation() { return this._showNav; }\r\n    set showNavigation(value) {\r\n        if (value === this._showNav) return;\r\n        this._showNav = value;\r\n        this._container.querySelectorAll('.MapperNavButton').forEach((e: HTMLElement) => {\r\n            e.style.display = this._showNav ? '' : 'none';\r\n        });\r\n        this._canvas.style.top = this._showNav ? '' : '0';\r\n        this._canvas.style.left = this._showNav ? '' : '0';\r\n        this._canvas.style.right = this._showNav ? '' : '0';\r\n        this._canvas.style.bottom = this._showNav ? '' : '0';\r\n        this._resizeCanvas();\r\n    }\r\n    get selected() { return this._selected; }\r\n    set selected(value: Room) {\r\n        this.emit('room-before-selected', this._selected ? this._selected.clone() : null);\r\n        this._selected = value.clone();\r\n        this.emit('room-selected', value.clone());\r\n        this.doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    get container() { return this._container; }\r\n\r\n    set scale(value: number) {\r\n        if (value < 25)\r\n            value = 25;\r\n        if (value > 300)\r\n            value = 300;\r\n        if (this._scale !== value) {\r\n            this._scale = value / 100;\r\n            this.emit('setting-changed', 'scale', value);\r\n            this.$drawCache = 0;\r\n            this.doUpdate(UpdateType.draw);\r\n        }\r\n    }\r\n    get scale(): number { return Math.round(this._scale * 100); }\r\n    set enabled(value: boolean) {\r\n        if (this._enabled !== value) {\r\n            this._enabled = value;\r\n            this.emit('setting-changed', 'enabled', value);\r\n        }\r\n    }\r\n    get enabled(): boolean { return this._enabled; }\r\n    set follow(value: boolean) {\r\n        if (this._follow !== value) {\r\n            this._follow = value;\r\n            this.emit('setting-changed', 'follow', value);\r\n        }\r\n    }\r\n    get follow(): boolean { return this._follow; }\r\n\r\n    set showLegend(value: boolean) {\r\n        if (this._showLegend !== value) {\r\n            this._showLegend = value;\r\n            this.$drawCache = 0;\r\n            this.doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'legend', value);\r\n        }\r\n    }\r\n    get showLegend(): boolean { return this._showLegend; }\r\n\r\n    set splitArea(value: boolean) {\r\n        if (this._splitArea !== value) {\r\n            this._splitArea = value;\r\n            this.$drawCache = 0;\r\n            this.doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'split', value);\r\n        }\r\n    }\r\n\r\n    get splitArea(): boolean { return this._splitArea; }\r\n\r\n    set fillWalls(value: boolean) {\r\n        if (this._fillWalls !== value) {\r\n            this._fillWalls = value;\r\n            this.$drawCache = 0;\r\n            this.doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'fill', value);\r\n        }\r\n    }\r\n\r\n    get fillWalls(): boolean { return this._fillWalls; }\r\n\r\n    constructor(container: string | JQuery | HTMLElement | MapOptions, options?: MapOptions) {\r\n        super();\r\n        if (!container)\r\n            throw new Error('Container must be a selector, element, jquery object or Map options');\r\n        if (typeof container === 'object' && 'container' in container) {\r\n            options = Object.assign(options || {}, container);\r\n            container = options.container;\r\n            delete options.container;\r\n        }\r\n        else if (!options)\r\n            options = {};\r\n        if (typeof container === 'string') {\r\n            this._container = document.querySelector(container);\r\n            if (!this._container)\r\n                throw new Error('Invalid selector for display.');\r\n        }\r\n        else if (container instanceof $)\r\n            this._container = container[0];\r\n        else if (container instanceof HTMLElement)\r\n            this._container = container;\r\n        else\r\n            throw new Error('Container must be a selector, element or jquery object');\r\n\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            //debounce(() => {\r\n            if (!this._resizeObserverCache || this._resizeObserverCache.height !== entries[0].contentRect.height || this._resizeObserverCache.width !== entries[0].contentRect.width) {\r\n                this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                this._resizeCanvas();\r\n            }\r\n            //}, 50, 'resize');\r\n        });\r\n        this._resizeObserver.observe(this._container);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    this._resizeCanvas()\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._container, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n\r\n        this._canvas = document.createElement('canvas');\r\n        this._canvas.id = this._container.id + '-canvas';\r\n        this._canvas.classList.add('map-canvas');\r\n        this._canvas.style.touchAction = \"none\";\r\n        this._canvas.tabIndex = 1;\r\n        this._resizeCanvas()\r\n        this._container.appendChild(this._canvas);\r\n\r\n        this._container.insertAdjacentHTML('afterbegin', `<div class=\"MapperNavButton\" title=\"Scroll northwest\" style=\"top:4px;left:4px;background-position: 0px 0px;\" data-x=\"-1\" data-y=\"-1\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll north\" style=\"top:4px;left:50%;background-position: -22px 0px;margin-left:-11px;\" data-x=\"0\" data-y=\"-1\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll northeast\" style=\"top:4px;left:100%;background-position: -44px 0px;margin-left:-26px;\" data-x=\"1\" data-y=\"-1\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll west\" style=\"top:50%;left:4px;background-position: 0px -22px;margin-top:-11px;\" data-x=\"-1\" data-y=\"0\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll east\" style=\"top:50%;left:100%;background-position: -44px -22px;margin-top:-11px;margin-left:-26px;\" data-x=\"1\" data-y=\"0\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll southwest\" style=\"bottom:4px;left:4px;background-position: 0px -44px;\" data-x=\"-1\" data-y=\"1\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll south\" style=\"bottom:4px;left:50%;background-position: -22px -44px;margin-left:-11px;\" data-x=\"0\" data-y=\"1\"></div>\r\n        <div class=\"MapperNavButton\" title=\"Scroll southeast\" style=\"bottom:4px;left:100%;background-position: -44px -44px;margin-left:-26px;\" data-x=\"1\" data-y=\"1\"></div>`);\r\n        this._container.querySelectorAll('.MapperNavButton').forEach(e => {\r\n            e.addEventListener('wheel', (e: WheelEvent) => {\r\n                this._mapperNavDown = true;\r\n                const target = (e.currentTarget || e.target) as HTMLElement;\r\n                if (e.deltaY >= 0)\r\n                    this.mapperNavClick(-parseInt(target.dataset.x, 10), -parseInt(target.dataset.y, 10));\r\n                else\r\n                    this.mapperNavClick(parseInt(target.dataset.x, 10), parseInt(target.dataset.y, 10));\r\n                this._mapperNavDown = false;\r\n            }, { passive: true });\r\n            e.addEventListener('mouseleave', () => this._mapperNavDown = false);\r\n            e.addEventListener('mouseup', () => this._mapperNavDown = false);\r\n            e.addEventListener('mousedown', e => {\r\n                this._mapperNavDown = true;\r\n                const target = (e.currentTarget || e.target) as HTMLElement;\r\n                this.mapperNavClick(parseInt(target.dataset.x, 10), parseInt(target.dataset.y, 10));\r\n            });\r\n        });\r\n\r\n        this._context = this._canvas.getContext('2d');\r\n        this._context.mozImageSmoothingEnabled = false;\r\n        this._context.webkitImageSmoothingEnabled = false;\r\n        this._context.imageSmoothingEnabled = false;\r\n\r\n        this._canvas.addEventListener('pointerdown', e => {\r\n            this._pointerCache.push(e);\r\n            //if (this._pointerCache.length === 2)\r\n            //this._pointerDistance = Math.hypot(this._pointerCache[0].clientX - this._pointerCache[1].clientX, this._pointerCache[0].clientY - this._pointerCache[1].clientY);\r\n        });\r\n        this._canvas.addEventListener('pointermove', e => {\r\n            const index = this._pointerCache.findIndex(\r\n                (cached) => cached.pointerId === e.pointerId,\r\n            );\r\n            this._pointerCache[index] = e;\r\n            if (this._pointerCache.length === 2) {\r\n                // Calculate the distance between the two pointers\r\n                const curDiff = Math.abs(this._pointerCache[0].clientX - this._pointerCache[1].clientX);\r\n\r\n                if (this._pointerDistance > 0) {\r\n                    if (curDiff > this._pointerDistance) {\r\n                        // The distance between the two pointers has increased\r\n                        if (this.scale < 300)\r\n                            this.scale += 1;\r\n                    }\r\n                    if (curDiff < this._pointerDistance) {\r\n                        if (this.scale > 25)\r\n                            this.scale -= 1;\r\n                    }\r\n                }\r\n\r\n                // Cache the distance for the next move event\r\n                this._pointerDistance = curDiff;\r\n            }\r\n        });\r\n\r\n        const pointerUp = e => {\r\n            // Remove this event from the target's cache\r\n            const index = this._pointerCache.findIndex(\r\n                (cachedEv) => cachedEv.pointerId === e.pointerId,\r\n            );\r\n            this._pointerCache.splice(index, 1);\r\n            if (this._pointerCache.length < 2) {\r\n                this._pointerDistance = -1;\r\n            }\r\n        };\r\n        this._canvas.addEventListener('pointerup', pointerUp);\r\n        this._canvas.addEventListener('pointercancel', pointerUp);\r\n        this._canvas.addEventListener('pointerout', pointerUp);\r\n        this._canvas.addEventListener('pointerleave', pointerUp);\r\n\r\n\r\n        this._canvas.addEventListener('touchstart', e => {\r\n            this.Mouse = this.getMapMousePos(e);\r\n            this.MouseDown = this.getMapMousePos(e);\r\n            this.MouseDrag.state = true;\r\n            this.drag = e.touches.length === 1;\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('touchmove', e => {\r\n            this.MousePrev = this.Mouse;\r\n            this.Mouse = this.getMapMousePos(event);\r\n            if (this.drag) {\r\n                this.MouseDrag.x += this.MousePrev.x - this.Mouse.x;\r\n                this.MouseDrag.y += this.MousePrev.y - this.Mouse.y;\r\n                const x = Math.floor(this.MouseDrag.x / 32 / this._scale);\r\n                const y = Math.floor(this.MouseDrag.y / 32 / this._scale);\r\n                if (x > 0 || x < 0 || y < 0 || y > 0) {\r\n                    this.MouseDrag.x -= x * 32 * this._scale;\r\n                    this.MouseDrag.y -= y * 32 * this._scale;\r\n                    this.scrollBy(x, y);\r\n                }\r\n                this._canvas.style.cursor = 'move';\r\n            }\r\n            e.preventDefault();\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('touchend', e => {\r\n            this.Mouse = this.getMapMousePos(e);\r\n            if (!this.MouseDown)\r\n                this.MouseDown = this.getMapMousePos(e);\r\n            if (this.Mouse.button === 0 && Math.floor(this.Mouse.x / 32 / this._scale) === Math.floor(this.MouseDown.x / 32 / this._scale) && Math.floor(this.Mouse.y / 32 / this._scale) === Math.floor(this.MouseDown.y / 32 / this._scale)) {\r\n                const x = this.Mouse.x;\r\n                const y = this.Mouse.y;\r\n                const room = this.findActiveRoomByCoords(x, y);\r\n                if (!this.selected || (room && room.num !== this.selected.num))\r\n                    this.selected = room;\r\n            }\r\n            this.MouseDrag.state = false;\r\n            this.drag = false;\r\n            this._canvas.style.cursor = 'default;'\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('mousemove', event => {\r\n            this.MousePrev = this.Mouse;\r\n            this.Mouse = this.getMapMousePos(event);\r\n            if (this.drag) {\r\n                this.MouseDrag.x += this.MousePrev.x - this.Mouse.x;\r\n                this.MouseDrag.y += this.MousePrev.y - this.Mouse.y;\r\n                const x = Math.floor(this.MouseDrag.x / 32 / this._scale);\r\n                const y = Math.floor(this.MouseDrag.y / 32 / this._scale);\r\n                if (x > 0 || x < 0 || y < 0 || y > 0) {\r\n                    this.MouseDrag.x -= x * 32 * this._scale;\r\n                    this.MouseDrag.y -= y * 32 * this._scale;\r\n                    this.scrollBy(x, y);\r\n                }\r\n                this._canvas.style.cursor = 'move';\r\n            }\r\n            event.preventDefault();\r\n        });\r\n        this._canvas.addEventListener('mousedown', event => {\r\n            this.Mouse = this.getMapMousePos(event);\r\n            this.MouseDown = this.getMapMousePos(event);\r\n            this.MouseDrag.state = true;\r\n            this.drag = this.MouseDown.button === 0;\r\n        });\r\n        this._canvas.addEventListener('mouseup', event => {\r\n            this.Mouse = this.getMapMousePos(event);\r\n            if (!this.MouseDown)\r\n                this.MouseDown = this.getMapMousePos(event);\r\n            if (this.Mouse.button === 0 && Math.floor(this.Mouse.x / 32 / this._scale) === Math.floor(this.MouseDown.x / 32 / this._scale) && Math.floor(this.Mouse.y / 32 / this._scale) === Math.floor(this.MouseDown.y / 32 / this._scale)) {\r\n                const x = this.Mouse.x;\r\n                const y = this.Mouse.y;\r\n                const room = this.findActiveRoomByCoords(x, y);\r\n                if (!this.selected || (room && room.num !== this.selected.num))\r\n                    this.selected = room;\r\n            }\r\n            this.MouseDrag.state = false;\r\n            this.drag = false;\r\n            this._canvas.style.cursor = 'default;'\r\n        });\r\n        this._canvas.addEventListener('wheel', e => {\r\n            if (e.deltaY >= 0)\r\n                this.scale -= 5;\r\n            else\r\n                this.scale += 5;\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('mouseenter', event => {\r\n            this.Mouse = this.getMapMousePos(event);\r\n        });\r\n        this._canvas.addEventListener('mouseleave', event => {\r\n            this.Mouse = this.getMapMousePos(event);\r\n            if (this.drag) {\r\n                this.doUpdate(UpdateType.draw);\r\n                this.drag = false;\r\n                $(this._canvas).css('cursor', 'default');\r\n            }\r\n        });\r\n        this._canvas.addEventListener('contextmenu', event => {\r\n            event.preventDefault();\r\n            const m = this.getMapMousePos(event);\r\n            this.emit('context-menu', this.findActiveRoomByCoords(m.x, m.y).clone());\r\n            return false;\r\n        });\r\n        this._canvas.addEventListener('click', event => {\r\n            event.preventDefault();\r\n            this.MouseDrag.state = false;\r\n            this.drag = false;\r\n            $(this._canvas).css('cursor', 'default');\r\n        });\r\n        this._canvas.addEventListener('dblclick', event => {\r\n            event.preventDefault();\r\n            this.Mouse = this.getMapMousePos(event);\r\n            this.MouseDown = this.getMapMousePos(event);\r\n            this.MouseDrag.state = true;\r\n            this.drag = true;\r\n            $(this._canvas).css('cursor', 'move');\r\n        });\r\n        this._canvas.onselectstart = () => { return false; };\r\n        this._canvas.addEventListener('focus', (e) => {\r\n            this.setFocus(true);\r\n        });\r\n        this._canvas.addEventListener('blur', (e) => {\r\n            this.setFocus(false);\r\n        });\r\n        this._canvas.addEventListener('keydown', (e) => {\r\n            if (!this.$focused) return;\r\n            switch (e.which) {\r\n                case 27:\r\n                    e.preventDefault();\r\n                    this.MouseDrag.state = false;\r\n                    this.drag = false;\r\n                    $(this._canvas).css('cursor', 'default');\r\n                    break;\r\n                case 38: //up\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, -1);\r\n                    break;\r\n                case 40: //down\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, 1);\r\n                    break;\r\n                case 37: //left\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 0);\r\n                    break;\r\n                case 39: //right\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 0);\r\n                    break;\r\n                case 110:\r\n                case 46: //delete\r\n                    e.preventDefault();\r\n                    this.emit('delete-selected');\r\n                    break;\r\n                case 97: //num1\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 1);\r\n                    break;\r\n                case 98: //num2\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, 1);\r\n                    break;\r\n                case 99: //num3\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 1);\r\n                    break;\r\n                case 100: //num4\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 0);\r\n                    break;\r\n                case 101: //num5\r\n                    e.preventDefault();\r\n                    this.focusCurrentRoom();\r\n                    break;\r\n                case 102: //num6\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 0);\r\n                    break;\r\n                case 103: //num7\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, -1);\r\n                    break;\r\n                case 104: //num8\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, -1);\r\n                    break;\r\n                case 105: //num9\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, -1);\r\n                    break;\r\n                case 107: //+\r\n                    e.preventDefault();\r\n                    this.setLevel(this.active.z + 1);\r\n                    break;\r\n                case 109: //-\r\n                    e.preventDefault();\r\n                    this.setLevel(this.active.z - 1);\r\n                    break;\r\n                case 111: // /\r\n                    e.preventDefault();\r\n                    this.setZone(this.active.zone - 1);\r\n                    break;\r\n                case 106: // *\r\n                    e.preventDefault();\r\n                    this.setZone(this.active.zone + 1);\r\n                    break;\r\n            }\r\n        });\r\n        this._map = options.map;\r\n        this.reset();\r\n        this.refresh();\r\n    }\r\n\r\n    public getMapMousePos(evt): MouseData {\r\n        const rect = this._canvas.getBoundingClientRect();\r\n        if (evt.touches && evt.touches.length)\r\n            return {\r\n                x: evt.touches[0].clientX - rect.left,\r\n                y: evt.touches[0].clientY - rect.top,\r\n                button: 0,\r\n                state: false\r\n            };\r\n\r\n        return {\r\n            x: evt.clientX - rect.left,\r\n            y: evt.clientY - rect.top,\r\n            button: evt.button,\r\n            state: false\r\n        };\r\n    }\r\n\r\n    public scrollBy(x: number, y: number) {\r\n        this.vscroll += x;\r\n        this.hscroll += y;\r\n        this.doUpdate(UpdateType.draw);\r\n        this.emit('setting-changed', 'vscroll', this.vscroll);\r\n        this.emit('setting-changed', 'hscroll', this.hscroll);\r\n    }\r\n\r\n    public scrollTo(x: number, y: number) {\r\n        this.vscroll = x;\r\n        this.hscroll = y;\r\n        this.doUpdate(UpdateType.draw);\r\n        this.emit('setting-changed', 'vscroll', this.vscroll);\r\n        this.emit('setting-changed', 'hscroll', this.hscroll);\r\n    }\r\n\r\n    public findActiveRoomByCoords(rx: number, ry: number) {\r\n        let x = this.vscroll - (this._canvas.width / 32 / 2 / this._scale);\r\n        let y = this.hscroll - (this._canvas.height / 32 / 2 / this._scale);\r\n        let ox = 15.5 * this._scale;\r\n        let oy = 15.5 * this._scale;\r\n        if (this._canvas.width % 2 !== 0)\r\n            ox = 15 * this._scale;\r\n        if (this._canvas.height % 2 !== 0)\r\n            oy = 15 * this._scale;\r\n        x += (rx - ox) / 32 / this._scale;\r\n        y += (ry - oy) / 32 / this._scale;\r\n        x = Math.floor(x);\r\n        y = Math.floor(y);\r\n        if (this._splitArea)\r\n            return this.map.getRoom({ x: x, y: y, z: this.active.z, zone: this.active.zone, area: this.active.area }) || new Room();\r\n        return this.map.getRoom({ x: x, y: y, z: this.active.z, zone: this.active.zone }) || new Room();\r\n    }\r\n\r\n    public draw(canvas?: HTMLCanvasElement, context?: CanvasRenderingContext2D, ex?: boolean) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!canvas)\r\n                canvas = this._canvas;\r\n            if (!context)\r\n                context = this._context;\r\n            if (!ex) ex = false;\r\n            //cant get map canvas bail\r\n            if (!canvas || !context || !this._map) {\r\n                reject();\r\n                return;\r\n            }\r\n\r\n            const x = this.vscroll - (canvas.width / 32 / 2 / this._scale);\r\n            const y = this.hscroll - (canvas.height / 32 / 2 / this._scale);\r\n            const z = this.active.z || 0;\r\n            const area = this.active.area || '';\r\n            const zone = this.active.zone || 0;\r\n            let ox = 15.5 * this._scale;\r\n            let oy = 15.5 * this._scale;\r\n            if (canvas.width % 2 !== 0)\r\n                ox = 15 * this._scale;\r\n            if (canvas.height % 2 !== 0)\r\n                oy = 15 * this._scale;\r\n\r\n            context.font = '8pt Arial';\r\n            const s = new Date().getTime();\r\n            const $w = canvas.width / 32 / this._scale + 1;\r\n            const $h = canvas.height / 32 / this._scale + 1;\r\n            const $x = x - 1;\r\n            const $y = y - 1;\r\n            const rooms: Room[] = Object.values(this._map.Rooms).filter(room => {\r\n                if (room.zone !== zone || room.z !== z) return false;\r\n                if (this._splitArea && room.area !== area) return false;\r\n                if (((0 <= (room.x - $x) && (room.x - $x) <= $w) && (0 <= (room.y - $y) && (room.y - $y) <= $h) || (0 <= (room.x - $x) && (room.x - $x) <= $w) && (0 <= (room.y - $y + 1) && (room.y - $y + 1) <= $h) || (0 <= (room.x - $x + 1) && (room.x - $x + 1) <= $w) && (0 <= (room.y - $y + 1) && (room.y - $y + 1) <= $h) || (0 <= (room.x - $x + 1) && (room.x - $x + 1) <= $w) && (0 <= (room.y - $y) && (room.y - $y) <= $h)))\r\n                    return true;\r\n                return false;\r\n            });\r\n\r\n\r\n            this.emit('debug', 'Mapper: Draw - room query time: ' + (new Date().getTime() - s));\r\n            const d = new Date().getTime();\r\n            if (ex) {\r\n                context.fillStyle = '#eae4d6';\r\n                context.fillRect(0, 0, canvas.width, canvas.height);\r\n            }\r\n            else\r\n                context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n            this.emit('debug', 'Mapper: Draw - room calculations time: ' + (new Date().getTime() - s));\r\n            for (let r = 0, rl = rooms.length; r < rl; r++) {\r\n                const room = rooms[r];\r\n                this.DrawRoom(context, (room.x - x) * 32 * this._scale + ox, (room.y - y) * 32 * this._scale + oy, room, ex, this._scale);\r\n            }\r\n\r\n            this.emit('debug', 'Mapper: Draw - display time: ' + (new Date().getTime() - d));\r\n            this.emit('debug', 'Mapper: Draw - final time: ' + (new Date().getTime() - s));\r\n            this.DrawLegend(context, 1, -4, 0);\r\n            resolve(true);\r\n        });\r\n    }\r\n\r\n    public reset(type?) {\r\n        if (this._map && (!type || type === 1)) {\r\n            this._map.current = new Room();\r\n            this.emit('current-changed', this._map.current);\r\n        }\r\n        if (!type) {\r\n            this.setActive(new Room());\r\n            this.selected = new Room();\r\n        }\r\n    }\r\n\r\n    public refresh() {\r\n        this.$drawCache = 0;\r\n        this.doUpdate(UpdateType.draw);\r\n        this.emit('refresh');\r\n    }\r\n\r\n    public focusCurrentRoom() {\r\n        if (this._map.current.num) {\r\n            this.setActive(this._map.current.clone());\r\n            this.emit('active-room-changed', this.active.clone());\r\n        }\r\n        this.focusActiveRoom();\r\n    }\r\n\r\n    public focusActiveRoom() {\r\n        this.scrollTo(this.active.x + 1, this.active.y + 1);\r\n    }\r\n\r\n    public setActive(room) {\r\n        this.active = room.clone();\r\n        this.emit('active-room-changed', this.active);\r\n    }\r\n\r\n    public get current() { return this._map.current; }\r\n    public set current(value) {\r\n        this.emit('path-cleared');\r\n        if (!value || !value.num) value = this.selected;\r\n        this._map.current = value.clone();\r\n        this.markers = {};\r\n        this.markedRooms = 0;\r\n    }\r\n\r\n    public setArea(area: string) {\r\n        this.active.area = area;\r\n        if (this._map.current.num !== null && this._map.current.area === this.active.area) {\r\n            this.setActive(this._map.current.clone());\r\n            this.focusActiveRoom();\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n        else {\r\n            const room = this._map.getRoom({ area: area });\r\n            if (room) {\r\n                this.active = room.clone();\r\n                this.setActive(this.active);\r\n                this.focusActiveRoom();\r\n                this.emit('setting-changed', 'active', this.active);\r\n            }\r\n        }\r\n    }\r\n\r\n    public setLevel(level: number) {\r\n        if (level !== this.active.z) {\r\n            this.active.z = level;\r\n            this.doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n    }\r\n\r\n    public setZone(zone: number) {\r\n        if (zone !== this.active.zone) {\r\n            this.active.zone = zone;\r\n            this.doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n    }\r\n\r\n    public removeRoom(room) {\r\n        if (this._map.roomExists({ num: room.num })) {\r\n            this._map.removeRoom(room);\r\n            this.emit('remove-done', room);\r\n            if (room.num === this._map.current.num) {\r\n                this._map.current = new Room();\r\n                this.emit('current-changed', this._map.current);\r\n                this.clearPath();\r\n            }\r\n            else if (this.markers[room.num])\r\n                this.clearPath();\r\n            if (room.num === this.active.num)\r\n                this.setActive(new Room());\r\n            if (room.num === this.selected.num)\r\n                this.selected = new Room();\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    public clearSelectedRoom() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-selected', es)\r\n        if (es.preventDefault) return;\r\n        this.removeRoom(this.selected);\r\n    }\r\n\r\n    public clearCurrentRoom() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-current', es)\r\n        if (es.preventDefault) return;\r\n        this.removeRoom(this._map.current);\r\n    }\r\n\r\n    public clearArea() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-area', es)\r\n        if (es.preventDefault) return;\r\n        this._map.removeRooms({ area: this.active.area });\r\n        this.emit('clear-area-done', this.active.area);\r\n        this.reset();\r\n        this.refresh();\r\n    }\r\n\r\n    public clearAll() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-all', es)\r\n        if (es.preventDefault) return;\r\n        this._map.removeAllRooms();\r\n        this.emit('clear-done');\r\n        this.reset();\r\n        this.refresh();\r\n        this.focusActiveRoom();\r\n    }\r\n\r\n    public set map(map: Map) {\r\n        this._map = map;\r\n        map.on('current-changed', room => {\r\n            this.clearPath();\r\n            this.emit('current-changed', this._map.current);\r\n            if (this.selected && this.selected.num === room.num)\r\n                this.emit('room-selected', room.clone());\r\n            if (this.follow)\r\n                this.focusCurrentRoom();\r\n            else\r\n                this.setActive(room.clone());\r\n            this.refresh();\r\n        });\r\n        map.on('before-room-changed', room => {\r\n            if (room)\r\n                delete this.$drawCache[(room.background ? room.background : room.env) + ',' + room.indoors + ',' + room.exitsID + ',' + room.details];\r\n        });\r\n        map.on('room-changed', room => {\r\n            if (this.selected && this.selected.num === room.num)\r\n                this.selected = room;\r\n            if (this.follow)\r\n                this.focusCurrentRoom();\r\n            else\r\n                this.setActive(this.current.clone());\r\n            this.refresh();\r\n        });\r\n        map.on('rooms-changed', rooms => {\r\n            if (this.selected && this.selected.num) {\r\n                const idx = rooms.findIndex(room => room.num === this.selected.num);\r\n                if (idx !== -1)\r\n                    this.selected = rooms[idx];\r\n            }\r\n            if (this.follow)\r\n                this.focusCurrentRoom();\r\n            else\r\n                this.setActive(this.current.clone());\r\n            this.refresh();\r\n        });\r\n        this.refresh();\r\n    }\r\n    public get map() { return this._map; }\r\n\r\n    public set rooms(rooms: object | Room[]) {\r\n        this._map.Rooms = rooms;\r\n    }\r\n    public get rooms() { return this._map.Rooms; }\r\n\r\n    public roomExists(x, y, z, zone, area?) {\r\n        if (area)\r\n            return this._map.roomExists({ x: x, y: y, z: z, zone: zone || 0, area: area });\r\n        return this._map.roomExists({ x: x, y: y, z: z, zone: zone || 0 });\r\n    }\r\n\r\n    public setRoom(room: Room) {\r\n        this._map.setRoom(room);\r\n    }\r\n\r\n    public DrawLegend(ctx, x, y, nc) {\r\n        if (!this._showLegend) return;\r\n        ctx.strokeStyle = 'black';\r\n        if (!nc) {\r\n            ctx.fillStyle = '#eae4d6';\r\n            //ctx.clearRect(x + 30, y + 35, 130, 145);\r\n            ctx.fillRect(x + 30, y + 35, 130, 175);\r\n        }\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeRect(x + 30, y + 35, 130, 175);\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillText('Dock', x + 50, y + 50);\r\n        ctx.fillStyle = 'chocolate';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 45, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Pier', x + 50, y + 65);\r\n        ctx.fillStyle = 'gray';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 60, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Water Source', x + 50, y + 80);\r\n        ctx.fillStyle = 'aqua';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 75, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bank', x + 50, y + 95);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'goldenrod';\r\n        ctx.beginPath();\r\n        ctx.fillText('$', x + 38, y + 95);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Shop', x + 50, y + 110);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'purple';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u23CF', x + 38, y + 110);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Hospital', x + 50, y + 125);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'blue';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2665', x + 38, y + 125);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bar & Restaurant', x + 50, y + 140);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2617', x + 38, y + 140);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bar', x + 50, y + 155);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u266A', x + 38, y + 155);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Restaurant', x + 50, y + 170);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2616', x + 38, y + 170);\r\n        ctx.closePath();\r\n\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Train', x + 50, y + 185);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'red';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u260D', x + 38, y + 185);\r\n        ctx.closePath();\r\n\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Stable', x + 50, y + 200);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'rgb(153, 102, 0)';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2658', x + 38, y + 200);\r\n        ctx.closePath();\r\n\r\n    }\r\n\r\n    private translate(ctx, amt, scale) {\r\n        if (scale === 2) return;\r\n        //if (scale < 1) {\r\n        const o = amt - amt * scale;\r\n        ctx.translate(amt * scale + o, amt * scale + o);\r\n        /*\r\n    }\r\n    else if (scale % 0.25 === 0)\r\n        ctx.translate(amt, amt);\r\n    else\r\n        ctx.translate(amt * scale, amt * scale);\r\n        */\r\n    }\r\n\r\n    public DrawRoom(ctx, x, y, room, ex, scale?) {\r\n        if (!this.$drawCache)\r\n            this.$drawCache = {};\r\n        if (!scale) scale = this._scale;\r\n        const key = (room.background ? room.background : room.env) + ',' + room.indoors + ',' + room.exitsID + ',' + room.details;\r\n\r\n        if (!this.$drawCache[key]) {\r\n            this.$drawCache[key] = document.createElement('canvas');\r\n            this.$drawCache[key].classList.add('map-canvas');\r\n            this.$drawCache[key].height = 32 * scale;\r\n            this.$drawCache[key].width = 32 * scale;\r\n            const tx = this.$drawCache[key].getContext('2d');\r\n            this.translate(tx, 0.5, scale);\r\n            tx.beginPath();\r\n            let f = false;\r\n            if (room.background) {\r\n                tx.fillStyle = room.background;\r\n                f = true;\r\n            }\r\n            else if (room.env) {\r\n                switch (room.env) {\r\n                    case 'wood':\r\n                        tx.fillStyle = '#966F33';\r\n                        f = true;\r\n                        break;\r\n                    case 'jungle':\r\n                        tx.fillStyle = '#347C2C';\r\n                        f = true;\r\n                        break;\r\n                    case 'forest':\r\n                        tx.fillStyle = '#4E9258';\r\n                        f = true;\r\n                        break;\r\n                    case 'grass':\r\n                    case 'grassland':\r\n                    case 'plains':\r\n                    case 'prairie':\r\n                    case 'savannah':\r\n                        tx.fillStyle = '#4AA02C';\r\n                        f = true;\r\n                        break;\r\n                    case 'desert':\r\n                    case 'dirt':\r\n                    case 'dirtroad':\r\n                    case 'beach':\r\n                    case 'sand':\r\n                    case 'sanddesert':\r\n                        tx.fillStyle = '#C2B280';\r\n                        f = true;\r\n                        break;\r\n                    case 'snow':\r\n                        tx.fillStyle = '#F0F8FF';\r\n                        f = true;\r\n                        break;\r\n                    case 'tundra':\r\n                    case 'icesheet':\r\n                        tx.fillStyle = '#368BC1';\r\n                        f = true;\r\n                        break;\r\n                    case 'underwater':\r\n                    case 'water':\r\n                    case 'lake':\r\n                    case 'river':\r\n                        tx.fillStyle = '#EBF4FA';\r\n                        f = true;\r\n                        break;\r\n                    case 'ocean':\r\n                        tx.fillStyle = '#C2DFFF';\r\n                        f = true;\r\n                        break;\r\n                    case 'bog':\r\n                    case 'city':\r\n                    case 'cliff':\r\n                    case 'highmountain':\r\n                    case 'hills':\r\n                    case 'mountain':\r\n                    case 'swamp':\r\n                        f = false;\r\n                        break;\r\n                    case 'farmland':\r\n                        f = true;\r\n                        tx.fillStyle = '#A9DFBF';\r\n                        break;\r\n                    case 'rockdesert':\r\n                        tx.fillStyle = '#6E2C00';\r\n                        f = true;\r\n                        break;\r\n                    case 'pavedroad':\r\n                        tx.fillStyle = '#D0D3D4';\r\n                        f = true;\r\n                        break;\r\n                    case 'cobble':\r\n                    case 'rocky':\r\n                    case 'stone':\r\n                        tx.fillStyle = '#D5DBDB';\r\n                        f = true;\r\n                        break;\r\n                    default:\r\n                        f = false;\r\n                        break;\r\n                }\r\n            }\r\n            else\r\n                f = false;\r\n            tx.strokeStyle = 'black';\r\n            tx.lineWidth = 0.6 * scale;\r\n            if (!room.indoors) {\r\n                tx.arc(16 * scale, 16 * scale, 8 * scale, 0, Math.PI * 2, false);\r\n                if (f) tx.fill();\r\n                tx.stroke();\r\n            }\r\n            else {\r\n                if (f) tx.fillRect(8 * scale, 8 * scale, 16 * scale, 16 * scale);\r\n                tx.strokeRect(8 * scale, 8 * scale, 16 * scale, 16 * scale);\r\n            }\r\n            tx.closePath();\r\n\r\n            tx.beginPath();\r\n            tx.fillStyle = '#cccccc';\r\n            if (room.exits.north) {\r\n                tx.moveTo(16 * scale, 0 * scale);\r\n                tx.lineTo(16 * scale, 8 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(9 * scale, 0 * scale, 14 * scale, 4 * scale);\r\n            if (room.exits.northwest) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(0 * scale, 0 * scale);\r\n                    tx.lineTo(10 * scale, 10 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(0 * scale, 0 * scale);\r\n                    tx.lineTo(8 * scale, 8 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(2 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                tx.fillRect(0 * scale, 2 * scale, 4 * scale, 2 * scale);\r\n                if (!room.exits.north)\r\n                    tx.fillRect(4 * scale, 0 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.west)\r\n                    tx.fillRect(0 * scale, 4 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.northeast) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(32 * scale, 0 * scale);\r\n                    tx.lineTo(22 * scale, 10 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(32 * scale, 0 * scale);\r\n                    tx.lineTo(24 * scale, 8 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(28 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                tx.fillRect(28 * scale, 2 * scale, 4 * scale, 2 * scale);\r\n                tx.clearRect(30 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.north)\r\n                    tx.fillRect(23 * scale, 0 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.east)\r\n                    tx.fillRect(28 * scale, 4 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.east) {\r\n                tx.moveTo(24 * scale, 16 * scale);\r\n                tx.lineTo(32 * scale, 16 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(28 * scale, 9 * scale, 4 * scale, 14 * scale);\r\n            if (room.exits.west) {\r\n                tx.moveTo(0 * scale, 16 * scale);\r\n                tx.lineTo(8 * scale, 16 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(0 * scale, 9 * scale, 4 * scale, 14 * scale);\r\n            if (room.exits.south) {\r\n                tx.moveTo(16 * scale, 24 * scale);\r\n                tx.lineTo(16 * scale, 32 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(9 * scale, 28 * scale, 14 * scale, 4 * scale);\r\n            if (room.exits.southeast) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(32 * scale, 32 * scale);\r\n                    tx.lineTo(22 * scale, 22 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(32 * scale, 32 * scale);\r\n                    tx.lineTo(24 * scale, 24 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(28 * scale, 28 * scale, 4 * scale, 2 * scale);\r\n                tx.fillRect(28 * scale, 30 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.south)\r\n                    tx.fillRect(23 * scale, 28 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.east)\r\n                    tx.fillRect(28 * scale, 23 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.southwest) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(0 * scale, 32 * scale);\r\n                    tx.lineTo(10 * scale, 22 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(0 * scale, 32 * scale);\r\n                    tx.lineTo(8 * scale, 24 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(0 * scale, 28 * scale, 4 * scale, 2 * scale);\r\n                tx.fillRect(2 * scale, 30 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.south)\r\n                    tx.fillRect(4 * scale, 28 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.west)\r\n                    tx.fillRect(0 * scale, 23 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            tx.closePath();\r\n            tx.stroke();\r\n            tx.fillStyle = 'black';\r\n            tx.strokeStyle = 'black';\r\n            if (room.exits.up) {\r\n                tx.beginPath();\r\n                tx.moveTo(1 * scale, 11 * scale);\r\n                tx.lineTo(7 * scale, 11 * scale);\r\n                tx.lineTo(4 * scale, 8 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if (room.exits.down) {\r\n                tx.beginPath();\r\n                tx.moveTo(1 * scale, 21 * scale);\r\n                tx.lineTo(7 * scale, 21 * scale);\r\n                tx.lineTo(4 * scale, 24 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if (room.exits.out) {\r\n                tx.beginPath();\r\n                tx.moveTo(26 * scale, 8 * scale);\r\n                tx.lineTo(29 * scale, 11 * scale);\r\n                tx.lineTo(26 * scale, 14 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n\r\n            }\r\n            if (room.exits.enter) {\r\n                tx.beginPath();\r\n                tx.moveTo(29 * scale, 19 * scale);\r\n                tx.lineTo(26 * scale, 22 * scale);\r\n                tx.lineTo(29 * scale, 25 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if ((room.details & RoomDetails.Dock) === RoomDetails.Dock) {\r\n                tx.fillStyle = 'chocolate';\r\n                tx.beginPath();\r\n                tx.arc(20 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Pier) === RoomDetails.Pier) {\r\n                tx.fillStyle = 'gray';\r\n                tx.beginPath();\r\n                tx.arc(12 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.WaterSource) === RoomDetails.WaterSource) {\r\n                tx.fillStyle = 'aqua';\r\n                tx.beginPath();\r\n                tx.arc(12 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            tx.scale(scale, scale);\r\n            if ((room.details & RoomDetails.Bank) === RoomDetails.Bank) {\r\n                tx.fillStyle = 'goldenrod';\r\n                tx.beginPath();\r\n                tx.fillText('$', 9, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Shop) === RoomDetails.Shop) {\r\n                tx.fillStyle = 'purple';\r\n                tx.beginPath();\r\n                tx.fillText('\\u23CF', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Hospital) === RoomDetails.Hospital) {\r\n                tx.fillStyle = 'blue';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2665', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Trainer) === RoomDetails.Trainer) {\r\n                tx.fillStyle = 'red';\r\n                tx.beginPath();\r\n                tx.fillText('\\u260D', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Stable) === RoomDetails.Stable) {\r\n                tx.fillStyle = 'rgb(153, 102, 0)';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2658', 7, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Restaurant) === RoomDetails.Restaurant && (room.details & RoomDetails.Bar) === RoomDetails.Bar) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2617', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Bar) === RoomDetails.Bar) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u266A', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Restaurant) === RoomDetails.Restaurant) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2616', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            tx.setTransform(1, 0, 0, 1, 0, 0);\r\n            this.translate(tx, -0.5, scale);\r\n        }\r\n        //this.translate(ctx, -0.5, scale);\r\n        ctx.drawImage(this.$drawCache[key], x | 0, y | 0);\r\n        //this.translate(ctx, 0.5, scale);\r\n        this.DrawDoor(ctx, x + 12 * scale, y - 2 * scale, 8 * scale, 3 * scale, room.exits.north);\r\n        this.DrawDoor(ctx, x + 31 * scale, y + 12 * scale, 3 * scale, 8 * scale, room.exits.east);\r\n        this.DrawDoor(ctx, x - 1 * scale, y + 12 * scale, 3 * scale, 8 * scale, room.exits.west);\r\n        this.DrawDoor(ctx, x + 12 * scale, y + 30 * scale, 8 * scale, 3 * scale, room.exits.south);\r\n        this.DrawDDoor(ctx, x, y, 5 * scale, 5 * scale, room.exits.northwest);\r\n        this.DrawDDoor(ctx, x + 32 * scale, y, -5 * scale, 5 * scale, room.exits.northeast);\r\n        this.DrawDDoor(ctx, x + 32 * scale, y + 32 * scale, -5 * scale, -5 * scale, room.exits.southeast);\r\n        this.DrawDDoor(ctx, x, y + 32 * scale, 5 * scale, -5 * scale, room.exits.southwest);\r\n\r\n        if (!ex && this.selected.num === room.num) {\r\n            if (this.$focused) {\r\n                ctx.fillStyle = 'rgba(135, 206, 250, 0.5)';\r\n                ctx.strokeStyle = 'LightSkyBlue';\r\n            }\r\n            else {\r\n                ctx.fillStyle = 'rgba(142, 142, 142, 0.5)';\r\n                ctx.strokeStyle = 'rgba(142, 142, 142, 0.5)';\r\n            }\r\n            ctx.fillRoundedRect(x, y, 32 * scale, 32 * scale, 8 * scale);\r\n            ctx.strokeRoundedRect(x, y, 32 * scale, 32 * scale, 8 * scale);\r\n        }\r\n        if (this.markers[room.num] === 2)\r\n            this.drawMarker(ctx, x, y, 'green', scale);\r\n        else if (this.markers[room.num] === 3)\r\n            this.drawMarker(ctx, x, y, 'blue', scale);\r\n        else if (this.markers[room.num])\r\n            this.drawMarker(ctx, x, y, 'yellow', scale);\r\n        if (!ex && room.num === this._map.current.num)\r\n            this.drawMarker(ctx, x, y, 'red', scale);\r\n    }\r\n\r\n    public drawMarker(ctx, x, y, color, scale) {\r\n        if (!color) color = 'yellow';\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color;\r\n        ctx.strokeStyle = 'black';\r\n        ctx.arc(x + 16 * scale, y + 16 * scale, 4 * scale, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n    }\r\n\r\n    public DrawDoor(ctx, x, y, w, h, exit) {\r\n        if (!exit || !exit.isdoor) return;\r\n        ctx.beginPath();\r\n        ctx.clearRect(x, y, w, h);\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeStyle = 'black';\r\n        /*\r\n        if (exit.islocked) {\r\n            ctx.fillStyle = 'red';\r\n            ctx.fillRect(x, y, w, h);\r\n            ctx.strokeRect(x, y, w, h);\r\n        }\r\n        else\r\n        */\r\n        if (exit.isclosed)\r\n            ctx.fillRect(x, y, w, h);\r\n        else\r\n            ctx.strokeRect(x, y, w, h);\r\n        ctx.closePath();\r\n    }\r\n\r\n    public DrawDDoor(ctx, x, y, w, h, exit) {\r\n        if (!exit || !exit.isdoor) return;\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeStyle = 'black';\r\n        ctx.moveTo(x, y);\r\n        ctx.lineTo(x + w, y);\r\n        ctx.lineTo(x, y + h);\r\n        ctx.lineTo(x, y);\r\n        /*\r\n        if (exit.islocked) {\r\n            ctx.fillStyle = 'red';\r\n            ctx.fill();\r\n            ctx.stroke();\r\n        }\r\n        else\r\n        */\r\n        if (exit.isclosed)\r\n            ctx.fill();\r\n        else\r\n            ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    public PointInRect(x, y, x1, x2, y1, y2) {\r\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2))\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    public getRoom(id) {\r\n        return this._map.Rooms[id];\r\n    }\r\n\r\n    public getRooms(filter?): Room[] {\r\n        if (!filter)\r\n            return Object.values(this._map.Rooms);\r\n        return this._map.getRooms(filter);\r\n    }\r\n\r\n    public showPath(destRoom?: Room) {\r\n        if (!destRoom || !destRoom.num)\r\n            destRoom = this.selected;\r\n        if (this._map.current.num == null || destRoom.num == null)\r\n            return;\r\n        if (this._splitArea && this._map.current.area !== destRoom.area)\r\n            return;\r\n        if (this._map.current.zone !== destRoom.zone)\r\n            return;\r\n        let rooms;\r\n        if (this._splitArea)\r\n            rooms = this.getRooms({ area: this._map.current.area, zone: this._map.current.zone });\r\n        else\r\n            rooms = this.getRooms({ zone: this._map.current.zone });\r\n        let room;\r\n        let id;\r\n        const roomsC: Room[][][] = [];\r\n        let ox = null;\r\n        let oy = 0;\r\n        let oz = 0;\r\n        let w = 0;\r\n        let h = 0;\r\n        let d = 0;\r\n        let r;\r\n        let rl;\r\n        let x;\r\n        let y;\r\n        let z;\r\n        let cx;\r\n        let cy;\r\n        let cz;\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            if (ox == null) {\r\n                ox = room.x;\r\n                w = room.x + 1;\r\n                oy = room.y;\r\n                h = room.y + 1;\r\n                oz = room.z;\r\n                d = room.z + 1;\r\n                continue;\r\n            }\r\n            if (room.x < ox) ox = room.x; else if (room.x > w) w = room.x;\r\n            if (room.y < oy) oy = room.y; else if (room.y > h) h = room.y;\r\n            if (room.z < oz) oz = room.z; else if (room.z > d) d = room.z;\r\n        }\r\n\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            if (room == null) continue;\r\n            if (!roomsC[room.y - oy]) roomsC[room.y - oy] = [];\r\n            if (!roomsC[room.y - oy][room.x - ox]) roomsC[room.y - oy][room.x - ox] = [];\r\n            roomsC[room.y - oy][room.x - ox][room.z - oz] = room;\r\n        }\r\n\r\n        w = Math.sqrt(Math.pow(w - ox, 2)) + 1;\r\n        h = Math.sqrt(Math.pow(oy - h, 2)) + 1;\r\n        d = Math.sqrt(Math.pow(oz - d, 2)) + 1;\r\n        const matrix = [];\r\n\r\n        for (y = 0; y < h; y++) {\r\n            matrix[y] = [];\r\n            for (x = 0; x < w; x++) {\r\n                matrix[y][x] = [];\r\n                for (z = 0; z < d; z++)\r\n                    matrix[y][x][z] = 0;\r\n            }\r\n        }\r\n\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            x = (room.x - ox);\r\n            y = (room.y - oy);\r\n            z = (room.z - oz);\r\n            if (room.exits.northwest)\r\n                matrix[y][x][z] |= 1;\r\n            if (room.exits.north)\r\n                matrix[y][x][z] |= 128;\r\n            if (room.exits.northeast)\r\n                matrix[y][x][z] |= 64;\r\n            if (room.exits.west)\r\n                matrix[y][x][z] |= 2;\r\n            if (room.exits.east)\r\n                matrix[y][x][z] |= 32;\r\n            if (room.exits.southwest)\r\n                matrix[y][x][z] |= 4;\r\n            if (room.exits.south)\r\n                matrix[y][x][z] |= 8;\r\n            if (room.exits.southeast)\r\n                matrix[y][x][z] |= 16;\r\n            if (room.exits.up)\r\n                matrix[y][x][z] |= 512;\r\n            if (room.exits.down)\r\n                matrix[y][x][z] |= 256;\r\n        }\r\n        const grid = new PF.Grid(w, h, d, matrix);\r\n\r\n        const finder = new PF.AStarFinder({ allowDiagonal: true, dontCrossCorners: false });\r\n        x = (this._map.current.x - ox);\r\n        y = (this._map.current.y - oy);\r\n        z = (this._map.current.z - oz);\r\n        cx = (destRoom.x - ox);\r\n        cy = (destRoom.y - oy);\r\n        cz = (destRoom.z - oz);\r\n        const fPath = finder.findPath(x, y, z, cx, cy, cz, grid);\r\n        rl = fPath.length;\r\n        this.markers = {};\r\n        this.markedRooms = [this._map.current, destRoom];\r\n        for (r = 0; r < rl; r++) {\r\n            x = Math.floor(fPath[r][0]);\r\n            y = Math.floor(fPath[r][1]);\r\n            z = Math.floor(fPath[r][2]);\r\n            if (roomsC[y] && roomsC[y][x] && roomsC[y][x][z]) {\r\n                if (roomsC[y][x][z].num === this._map.current.num)\r\n                    this.markers[roomsC[y][x][z].num] = 2;\r\n                else if (roomsC[y][x][z].num === destRoom.num)\r\n                    this.markers[roomsC[y][x][z].num] = 3;\r\n                else\r\n                    this.markers[roomsC[y][x][z].num] = 1;\r\n            }\r\n        }\r\n        this.emit('path-shown');\r\n        this.doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public clearPath() {\r\n        this.emit('path-cleared');\r\n        this.markers = {};\r\n        this.markedRooms = 0;\r\n        this.doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public get hasMarked() {\r\n        return this.markedRooms && this.markedRooms.length !== 0;\r\n    }\r\n\r\n    public get markedStart() {\r\n        if (!this.markedRooms) return 0;\r\n        return this.markedRooms[0];\r\n    }\r\n\r\n    public get markedEnd() {\r\n        if (!this.markedRooms) return 0;\r\n        return this.markedRooms[1];\r\n    }\r\n\r\n    public getMarkedPath() {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this.markedRooms)\r\n                this.getPath().then(resolve).catch(reject);\r\n            else\r\n                this.getPath(this.markedRooms[1], this.markedRooms[0]).then(resolve).catch(reject);\r\n        });\r\n    }\r\n\r\n    public getPath(destRoom?: Room, startRoom?: Room) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!destRoom || !destRoom.num)\r\n                destRoom = this.selected;\r\n            if (!startRoom || !startRoom.num)\r\n                startRoom = this._map.current;\r\n            if (startRoom.num == null || destRoom.num == null) {\r\n                reject('Invalid start or end room.');\r\n                return;\r\n            }\r\n            if (this._splitArea && startRoom.area !== destRoom.area) {\r\n                reject('Start and end rooms must be in same the area.');\r\n                return;\r\n            }\r\n            if (startRoom.zone !== destRoom.zone) {\r\n                reject('Start and end rooms must be in the same zone.');\r\n                return;\r\n            }\r\n            let rooms;\r\n            if (this._splitArea)\r\n                rooms = this.getRooms({ area: startRoom.area, zone: startRoom.zone });\r\n            else\r\n                rooms = this.getRooms({ zone: startRoom.zone });\r\n            let room;\r\n            let id;\r\n            let ox = null;\r\n            let oy = 0;\r\n            let oz = 0;\r\n            let w = 0;\r\n            let h = 0;\r\n            let d = 0;\r\n            let r;\r\n            let rl;\r\n            let x;\r\n            let y;\r\n            let z;\r\n            let cx;\r\n            let cy;\r\n            let cz;\r\n            let x2;\r\n            let y2;\r\n            let z2;\r\n            for (id in rooms) {\r\n                if (!rooms.hasOwnProperty(id)) continue;\r\n                room = rooms[id];\r\n                if (ox == null) {\r\n                    ox = room.x;\r\n                    w = room.x + 1;\r\n                    oy = room.y;\r\n                    h = room.y + 1;\r\n                    oz = room.z;\r\n                    d = room.z + 1;\r\n                    continue;\r\n                }\r\n                if (room.x < ox) ox = room.x; else if (room.x > w) w = room.x;\r\n                if (room.y < oy) oy = room.y; else if (room.y > h) h = room.y;\r\n                if (room.z < oz) oz = room.z; else if (room.z > d) d = room.z;\r\n            }\r\n\r\n            w = Math.sqrt(Math.pow(w - ox, 2)) + 1;\r\n            h = Math.sqrt(Math.pow(oy - h, 2)) + 1;\r\n            d = Math.sqrt(Math.pow(oz - d, 2)) + 1;\r\n            const matrix = [];\r\n\r\n            for (y = 0; y < h; y++) {\r\n                matrix[y] = [];\r\n                for (x = 0; x < w; x++) {\r\n                    matrix[y][x] = [];\r\n                    for (z = 0; z < d; z++)\r\n                        matrix[y][x][z] = 0;\r\n                }\r\n            }\r\n\r\n            for (id in rooms) {\r\n                if (!rooms.hasOwnProperty(id)) continue;\r\n                room = rooms[id];\r\n                x = (room.x - ox);\r\n                y = (room.y - oy);\r\n                z = (room.z - oz);\r\n                if (room.exits.northwest)\r\n                    matrix[y][x][z] |= 1;\r\n                if (room.exits.north)\r\n                    matrix[y][x][z] |= 128;\r\n                if (room.exits.northeast)\r\n                    matrix[y][x][z] |= 64;\r\n                if (room.exits.west)\r\n                    matrix[y][x][z] |= 2;\r\n                if (room.exits.east)\r\n                    matrix[y][x][z] |= 32;\r\n                if (room.exits.southwest)\r\n                    matrix[y][x][z] |= 4;\r\n                if (room.exits.south)\r\n                    matrix[y][x][z] |= 8;\r\n                if (room.exits.southeast)\r\n                    matrix[y][x][z] |= 16;\r\n                if (room.exits.up)\r\n                    matrix[y][x][z] |= 512;\r\n                if (room.exits.down)\r\n                    matrix[y][x][z] |= 256;\r\n            }\r\n            const grid = new PF.Grid(w, h, d, matrix);\r\n\r\n            const finder = new PF.AStarFinder({ allowDiagonal: true, dontCrossCorners: false });\r\n            x = (startRoom.x - ox);\r\n            y = (startRoom.y - oy);\r\n            z = (startRoom.z - oz);\r\n            cx = (destRoom.x - ox);\r\n            cy = (destRoom.y - oy);\r\n            cz = (destRoom.z - oz);\r\n            const fPath = finder.findPath(x, y, z, cx, cy, cz, grid);\r\n            rl = fPath.length;\r\n            const walk = [];\r\n            for (r = 0; r < rl - 1; r++) {\r\n                x = Math.floor(fPath[r][0]);\r\n                y = Math.floor(fPath[r][1]);\r\n                z = Math.floor(fPath[r][2]);\r\n                x2 = Math.floor(fPath[r + 1][0]);\r\n                y2 = Math.floor(fPath[r + 1][1]);\r\n                z2 = Math.floor(fPath[r + 1][2]);\r\n\r\n                if (z - 1 === z2)\r\n                    walk.push('down');\r\n                else if (z + 1 === z2)\r\n                    walk.push('up');\r\n                else if (x - 1 === x2 && y - 1 === y2)\r\n                    walk.push('northwest');\r\n                else if (x === x2 && y - 1 === y2)\r\n                    walk.push('north');\r\n                else if (x + 1 === x2 && y - 1 === y2)\r\n                    walk.push('northeast');\r\n\r\n                else if (x - 1 === x2 && y + 1 === y2)\r\n                    walk.push('southwest');\r\n                else if (x === x2 && y + 1 === y2)\r\n                    walk.push('south');\r\n                else if (x + 1 === x2 && y + 1 === y2)\r\n                    walk.push('southeast');\r\n                else if (x - 1 === x2 && y === y2)\r\n                    walk.push('west');\r\n                else\r\n                    walk.push('east');\r\n            }\r\n            resolve(walk);\r\n        });\r\n    }\r\n\r\n    public walkPath(destRoom?: Room, startRoom?: Room) {\r\n        this.getPath(destRoom, startRoom).then(walk => {\r\n            this.SendCommands(walk);\r\n        }).catch(() => { });\r\n    }\r\n\r\n    public walkMarkedPath() {\r\n        const destRoom = this.markedRooms ? this.markedRooms[1] : 0;\r\n        const startRoom = this.markedRooms ? this.markedRooms[0] : 0;\r\n        return new Promise((resolve, reject) => {\r\n            this.getPath(destRoom, startRoom).then(walk => {\r\n                this.SendCommands(walk);\r\n            }).catch(() => { });\r\n        });\r\n    }\r\n\r\n    public SendCommands(cmds) {\r\n        let tmp;\r\n        let cnt = this.commandDelayCount;\r\n        if (cnt < 0) cnt = 1;\r\n        if (cmds.length > cnt) {\r\n            tmp = cmds.slice(cnt);\r\n            cmds = cmds.slice(0, cnt);\r\n            setTimeout(() => { this.SendCommands(tmp); }, this.commandDelay);\r\n        }\r\n        this.emit('send-commands', cmds.join('\\n') + '\\n');\r\n    }\r\n\r\n    private doUpdate(type?: UpdateType) {\r\n        if (!type) return;\r\n        this._updating |= type;\r\n        if (this._updating === UpdateType.none || this._rTimeout)\r\n            return;\r\n        this._rTimeout = window.requestAnimationFrame(() => {\r\n            if ((this._updating & UpdateType.draw) === UpdateType.draw) {\r\n                this.draw().catch(() => { });\r\n                this._updating &= ~UpdateType.draw;\r\n            }\r\n            this._rTimeout = 0;\r\n            this.doUpdate(this._updating);\r\n        });\r\n    }\r\n\r\n    private setFocus(value) {\r\n        if (this.$focused === value) return;\r\n        this.$focused = value;\r\n        this.doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public updateOptions(options) {\r\n        if (!options) return;\r\n        for (let option in options) {\r\n            if (!Object.prototype.hasOwnProperty.call(options, option))\r\n                continue;\r\n            if (option in this)\r\n                this[option] = options[option];\r\n        }\r\n    }\r\n\r\n    private _resizeCanvas() {\r\n        if (!this._context || this.container.clientHeight === 0 || this.container.clientWidth === 0) return;\r\n        //buffer the current canvas state as when resizing canvases are cleared so we want to restore it after resizing\r\n        //let temp = this._context.getImageData(0, 0, this._canvas.width, this._canvas.height);\r\n        //create a temp canvas to store current state\r\n        const tempCanvas = document.createElement('canvas');\r\n        tempCanvas.width = this._canvas.width;\r\n        tempCanvas.height = this._canvas.height\r\n        //create context to access data\r\n        const tempContext = tempCanvas.getContext(\"2d\");\r\n        //draw current state to temp\r\n        tempContext.drawImage(this._canvas, 0, 0);\r\n        //resize canvas\r\n        if (this._showNav) {\r\n            this._canvas.width = this.container.clientWidth - 60;\r\n            this._canvas.height = this.container.clientHeight - 60;\r\n        }\r\n        else {\r\n            const computedStyle = window.getComputedStyle(this._canvas);\r\n            const borderLeftWidth = parseFloat(computedStyle.borderLeftWidth);\r\n            const borderRightWidth = parseFloat(computedStyle.borderRightWidth);\r\n            const borderTopWidth = parseFloat(computedStyle.borderTopWidth);\r\n            const borderBottomWidth = parseFloat(computedStyle.borderBottomWidth);\r\n\r\n            this._canvas.width = this.container.clientWidth - borderLeftWidth - borderRightWidth;\r\n            this._canvas.height = this.container.clientHeight - borderTopWidth - borderBottomWidth;\r\n        }\r\n        //this._context.putImageData(temp, 0, 0)\r\n        //restore stae\r\n        this._context.drawImage(tempCanvas, 0, 0);\r\n        //redraw to ensure any new exposed areas are drawn\r\n        this.doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    private mapperNavClick(x, y) {\r\n        if (!this._mapperNavDown) return;\r\n        this.scrollBy(x, y);\r\n        setTimeout(() => { this.mapperNavClick(x, y); }, 100);\r\n    }\r\n\r\n    public copyPath(separator?) {\r\n        separator = separator || client.getOption('commandStackingChar') || ';';\r\n        this.getPath().then((walk: string[]) => {\r\n            copyText(walk.join(separator || '\\n'));\r\n            this.emit('debug', 'Directions: ' + walk);\r\n        }).catch(err => this.emit('error', err));\r\n    }\r\n\r\n    public copyMarkedPath(separator?) {\r\n        separator = separator || client.getOption('commandStackingChar') || ';';\r\n        this.getMarkedPath().then((walk: string[]) => {\r\n            copyText(walk.join(separator || '\\n'));\r\n            this.emit('debug', 'Directions: ' + walk);\r\n        }).catch(err => this.emit('error', err));\r\n    }\r\n\r\n    public copySpeedpath() {\r\n        this.getPath().then((walk: string[]) => {\r\n            let cnt = 0;\r\n            let cmd = '';\r\n            let cmds = [client.getOption('speedpathsChar') || '!'];\r\n            const wl = walk.length;\r\n            for (let w = 0; w < wl; w++) {\r\n                if (cmd.length && cmd !== walk[w]) {\r\n                    cmds.push(cnt);\r\n                    cmds.push(cmd);\r\n                    cnt = 0;\r\n                }\r\n                cnt++;\r\n                cmd = walk[w];\r\n            }\r\n            cmds.push(cnt);\r\n            cmds.push(cmd);\r\n            copyText(cmds.join(''));\r\n            this.emit('debug', 'Speedpath: ' + cmds);\r\n        }).catch(err => this.emit('error', err))\r\n    }\r\n\r\n    public copyMarkedSpeedpath() {\r\n        this.getMarkedPath().then((walk: string[]) => {\r\n            let cnt = 0;\r\n            let cmd = '';\r\n            let cmds = [client.getOption('speedpathsChar') || '!'];\r\n            const wl = walk.length;\r\n            for (let w = 0; w < wl; w++) {\r\n                if (cmd.length && cmd !== walk[w]) {\r\n                    cmds.push(cnt);\r\n                    cmds.push(cmd);\r\n                    cnt = 0;\r\n                }\r\n                cnt++;\r\n                cmd = walk[w];\r\n            }\r\n            cmds.push(cnt);\r\n            cmds.push(cmd);\r\n            copyText(cmds.join(''));\r\n            this.emit('debug', 'Speedpath: ' + cmds);\r\n        }).catch(err => this.emit('error', err))\r\n    }\r\n\r\n    public exportImage(scaled?) {\r\n        const rooms = this.getRooms({ area: this.active.area, z: this.active.z, zone: this.active.zone });\r\n        let x = null, y = 0, w = 0, h = 0, r;\r\n        const rl = rooms.length;\r\n        let room, cx, cy;\r\n        const t = this.active.area === null || !this._splitArea ? '' : this.active.area;\r\n        const scale = scaled ? this._scale : 1.0;\r\n        for (r = 0; r < rl; r++) {\r\n            room = rooms[r];\r\n            if (room === null) continue;\r\n            if (x === null) {\r\n                x = room.x;\r\n                w = room.x + 1;\r\n                y = room.y;\r\n                h = room.y + 1;\r\n                continue;\r\n            }\r\n            if (room.x < x) x = room.x; else if (room.x > w) w = room.x;\r\n            if (room.y < y) y = room.y; else if (room.y > h) h = room.y;\r\n        }\r\n        this._context.font = 'italic bold 16pt Georgia';\r\n        var fx = this._context.measureText(t).width;\r\n        var rectWidth = Math.ceil(Math.sqrt(Math.pow(w - x, 2)) * 32 * scale + 60 + 32);\r\n        var rectHeight = Math.ceil(Math.sqrt(Math.pow(y - h, 2)) * 32 * scale + 60 + 32);\r\n        if (rectWidth < fx) rectWidth = fx + 60;\r\n        if (this._showLegend) {\r\n            rectWidth += 155;\r\n            if (rectHeight < 200) rectHeight = 200;\r\n        }\r\n        const tempCanvas = document.createElement('canvas');\r\n        tempCanvas.id = 'mapper-export';\r\n        tempCanvas.style.height = rectHeight + 'px';\r\n        tempCanvas.style.width = rectWidth + 'px';\r\n        tempCanvas.width = rectWidth;\r\n        tempCanvas.height = rectHeight;\r\n\r\n\r\n        var ctx;\r\n        if (tempCanvas && tempCanvas.getContext)\r\n            ctx = tempCanvas.getContext('2d');\r\n        else {\r\n            this.emit('error', 'Mapper image export: Error generating map!');\r\n            return;\r\n        }\r\n        ctx.strokeStyle = 'black';\r\n        ctx.fillStyle = '#eae4d6';\r\n        ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);\r\n\r\n        ctx.font = '8pt Arial';\r\n        for (r = 0; r < rl; r++) {\r\n            room = rooms[r];\r\n            //no room\r\n            if (room === null) continue;\r\n            cx = (room.x - x) * 32 * scale + 30.5;\r\n            cy = (room.y - y) * 32 * scale + 30.5;\r\n            this.DrawRoom(ctx, cx, cy, room, true, scale);\r\n        }\r\n        ctx.save();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.fillStyle = 'black';\r\n        ctx.font = 'italic bold 16pt Georgia';\r\n        fx = rectWidth / 2 - fx / 2;\r\n        ctx.fillText(t, fx, 20);\r\n        ctx.translate(rectWidth - 25, rectHeight - 25);\r\n        ctx.font = 'italic bold 12pt Georgia';\r\n        ctx.fillText('N', 3, -5);\r\n        ctx.beginPath();\r\n        ctx.moveTo(10, 0);\r\n        ctx.lineTo(5, 15);\r\n        ctx.lineTo(10, 20);\r\n        ctx.lineTo(15, 15);\r\n        ctx.lineTo(10, 0);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        ctx.restore();\r\n        this.DrawLegend(ctx, rectWidth - 185, -10, 1);\r\n\r\n        tempCanvas.toBlob((blob) => {\r\n            var reader = new FileReader();\r\n            reader.addEventListener('loadend', (evt) => {\r\n                fileSaveAs.show(evt.target.result, this._splitArea && t.length ? ('OoMUD.' + t + '.png') : ('OoMUD.png'), 'image/png');\r\n            });\r\n            reader.readAsArrayBuffer(blob);\r\n        });\r\n    }\r\n\r\n    public exportCurrentImage() {\r\n        var tempCanvas = document.createElement('canvas');\r\n        var context = tempCanvas.getContext('2d');\r\n        tempCanvas.width = this._canvas.width;\r\n        tempCanvas.height = this._canvas.height;\r\n        this.draw(tempCanvas, context, true).then(() => {\r\n            tempCanvas.toBlob((blob) => {\r\n                var reader = new FileReader();\r\n                reader.addEventListener('loadend', (evt) => {\r\n                    fileSaveAs.show(evt.target.result, 'OoMUD.current.png', 'image/png');\r\n                });\r\n                reader.readAsArrayBuffer(blob);\r\n            });\r\n        });\r\n    }\r\n\r\n    public exportArea() {\r\n        fileSaveAs.show(JSON.stringify(this.getRooms({ area: this.active.area })), this._splitArea ? ('OoMUD.' + this.active.area + '.map.txt') : ('OoMUD.map.txt'), 'text/plain');\r\n    }\r\n\r\n    public exportAll() {\r\n        fileSaveAs.show(JSON.stringify(this.map.Rooms), 'OoMUD.map.txt', 'text/plain');\r\n    }\r\n}", "import { EventEmitter } from './events';\r\nimport { copy } from \"./library\";\r\n\r\ndeclare let localforage;\r\n\r\nexport enum ImportType {\r\n    Merge = 0,\r\n    Replace = 1\r\n}\r\n\r\nexport enum RoomDetails {\r\n    None = 0,\r\n    Dock = 1,\r\n    Pier = 2,\r\n    Bank = 4,\r\n    Shop = 8,\r\n    Hospital = 16,\r\n    Bar = 32,\r\n    Restaurant = 64,\r\n    WaterSource = 128,\r\n    Trainer = 256,\r\n    Stable = 512\r\n}\r\n\r\nexport const RoomExits = {\r\n    out: 4096,\r\n    enter: 2048,\r\n    unknown: 1024,\r\n    up: 512,\r\n    down: 256,\r\n    north: 128,\r\n    northeast: 64,\r\n    east: 32,\r\n    southeast: 16,\r\n    south: 8,\r\n    southwest: 4,\r\n    west: 2,\r\n    northwest: 1,\r\n    none: 0\r\n};\r\n\r\nexport class Room {\r\n    public num: string = null;\r\n    public x: number = 0;\r\n    public y: number = 0;\r\n    public z: number = 0;\r\n    public area: string = '';\r\n    public zone: number = 0;\r\n    public notes?: string;\r\n    public background?: string;\r\n    public env?: string;\r\n    public details?: RoomDetails = RoomDetails.None;\r\n    public indoors?: number;\r\n    public exits?: any = {};\r\n    public name?: string;\r\n\r\n    constructor(data?) {\r\n        if (data) {\r\n            for (let prop in data) {\r\n                if (!data.hasOwnProperty(prop)) continue;\r\n                this[prop] = data[prop];\r\n            }\r\n        }\r\n    }\r\n\r\n    get exitsID() {\r\n        return Object.keys(this.exits).map(exit => RoomExits[exit]).reduce((a, c) => a | c, 0);\r\n    }\r\n\r\n    public clone() {\r\n        return new Room(copy(this));\r\n    }\r\n}\r\n\r\nexport class Map extends EventEmitter {\r\n    private _rooms: object;\r\n    private _areas: string[];\r\n    private _zone: number;\r\n    private _keys: string[];\r\n    private _keysZones: string[];\r\n    private _current: Room;\r\n    public changed = false;\r\n\r\n    public get current() { return this._current; }\r\n    public set current(value) {\r\n        this._current = value;\r\n        this.emit('current-changed', value);\r\n    }\r\n\r\n    public get Rooms() { return this._rooms; }\r\n    public set Rooms(value: object | Room[]) {\r\n        if (Array.isArray(value)) {\r\n            const or = value;\r\n            const rooms = {};\r\n            for (var r = 0, rl = or.length; r < rl; r++)\r\n                rooms[or[r].num] = or[r];\r\n            this._rooms = rooms;\r\n        }\r\n        else\r\n            this._rooms = value || {};\r\n        this.buildKeys();\r\n        this._keys.forEach(key => {\r\n            this._rooms[key] = this.normalizeRoom(this._rooms[key]);\r\n            if (this._rooms[key].zone > this._zone)\r\n                this._zone = this._rooms[key].zone;\r\n            if (this._areas.indexOf(this._rooms[key].area) === -1)\r\n                this._areas.push(this._rooms[key].area);\r\n        });\r\n        this._areas.sort();\r\n    }\r\n    public get Areas() {\r\n        if (!this._areas) this.buildAreas();\r\n        return this._areas;\r\n    }\r\n    public get zone() { return this._zone; }\r\n    public set zone(value) { this._zone = value || 0; }\r\n\r\n    public get count() { return this._keys.length; }\r\n\r\n    constructor() {\r\n        super();\r\n        this._rooms = {};\r\n        this._areas = [];\r\n        this._zone = 0;\r\n        this._keys = [];\r\n        this._keysZones = [];\r\n        this._current = new Room();\r\n    }\r\n\r\n    static load() {\r\n        return new Promise((resolve, reject) => {\r\n            localforage.getItem('nMapperData').then((value: any) => {\r\n                const map = new Map()\r\n                if (value && value.Rooms)\r\n                    map.Rooms = value.Rooms;\r\n                resolve(map);\r\n\r\n            }).catch(reject);\r\n        })\r\n    }\r\n\r\n    public save() {\r\n        this.changed = false;\r\n        return localforage.setItem('nMapperData', { Rooms: this._rooms, Areas: this.Areas, Keys: this._keys });\r\n    }\r\n\r\n    public getRoom(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        roomLoop:\r\n        for (let k = 0, kl = keys.length; k < kl; k++) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            return room;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public getRooms(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        const rooms = [];\r\n        roomLoop:\r\n        for (let k = 0, kl = keys.length; k < kl; k++) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            rooms.push(room);\r\n        }\r\n        return rooms;\r\n    }\r\n\r\n    public roomExists(filter) {\r\n        const keys = this._keysZones;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        if (keys.findIndex(key => {\r\n            let room = this._rooms[key];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    return false;\r\n            }\r\n            return true;\r\n        }) !== -1)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    public removeRoom(room) {\r\n        if (typeof room === 'string')\r\n            room = this._rooms[room];\r\n        if (!room) return;\r\n        if (this.Rooms[room.num]) {\r\n            let idx = this._keys.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keys.splice(idx, 1);\r\n            idx = this._keysZones.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keysZones.splice(idx, 1);\r\n            delete this._rooms[room.num];\r\n            this.changed = true;\r\n            this.emit('rooms-removed', [room]);\r\n            if (!this.getRoom({ area: room.area })) {\r\n                let idx = this._areas.indexOf(room.area);\r\n                this._areas.splice(idx, 1);\r\n                this.emit('areas-removed', [room.area]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public removeRooms(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        const rooms = [];\r\n        let idx;\r\n        let areas = {};\r\n        roomLoop:\r\n        for (let k = keys.length - 1; k >= 0; k--) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            rooms.push(room);\r\n            idx = this._keys.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keys.splice(idx, 1);\r\n            idx = this._keysZones.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keysZones.splice(idx, 1);\r\n            areas[room.area] = true;\r\n            delete this._rooms[room.num];\r\n        }\r\n        if (rooms.length) {\r\n            this.changed = true;\r\n            this.emit('rooms-removed', rooms);\r\n            for (let area in areas) {\r\n                if (!this.getRoom({ area: area })) {\r\n                    let idx = this._areas.indexOf(area);\r\n                    this._areas.splice(idx, 1);\r\n                }\r\n            }\r\n            this.emit('areas-removed', Object.keys(areas));\r\n        }\r\n    }\r\n\r\n    public removeAllRooms() {\r\n        const rooms = this._keys.map(key => this._rooms[key]);\r\n        const areas = this._areas;\r\n        this._rooms = {};\r\n        this._keys = [];\r\n        this._keysZones = [];\r\n        this._areas = [];\r\n        this._zone = 0;\r\n        this.current = new Room();\r\n        this.changed = true;\r\n        this.emit('rooms-removed', rooms);\r\n        this.emit('areas-removed', areas);\r\n    }\r\n\r\n    public setRoom(room: Room) {\r\n        if (!room) return;\r\n        this.changed = true;\r\n        room = this.normalizeRoom(room);\r\n        this.emit('before-room-changed', this._rooms[room.num]);\r\n        this._rooms[room.num] = room;\r\n        if (room.zone > this._zone)\r\n            this._zone = room.zone;\r\n        this.buildKeys();\r\n        this.addArea(room.area);\r\n        this.emit('room-changed', this._rooms[room.num]);\r\n        return this._rooms[room.num];\r\n    }\r\n\r\n    public addArea(area) {\r\n        if (!area) return 0;\r\n        if (this._areas.indexOf(area) !== -1) return;\r\n        this._areas.push(area);\r\n        this._areas.sort();\r\n        this.emit('areas-added', [area]);\r\n    }\r\n\r\n    public getFreeZone(zone) {\r\n        if (!zone) zone = 0;\r\n        if (zone > this.zone)\r\n            return zone;\r\n        return ++this.zone;\r\n    }\r\n\r\n    private normalizeRoom(r) {\r\n        const id = '' + (r.num || r.ID);\r\n        const room = {\r\n            area: r.Area || r.area || '',\r\n            details: r.Details || r.details || RoomDetails.None,\r\n            name: r.Name || r.name || '',\r\n            env: r.Env || r.env || r.environment || '',\r\n            x: +r.X || +r.x || 0,\r\n            y: +r.Y || +r.y || 0,\r\n            z: +r.Z || +r.z || 0,\r\n            zone: +r.Zone || +r.zone || 0,\r\n            indoors: +r.Indoors || +r.indoors || 0,\r\n            background: r.Background || r.background || '',\r\n            notes: r.Notes || r.notes || '',\r\n            num: id ? '' + id : null,\r\n            exits: r.exits || {}\r\n        };\r\n        if (room.exits) {\r\n            let exit;\r\n            let dest;\r\n            for (exit in room.exits) {\r\n                if (!room.exits.hasOwnProperty(exit)) continue;\r\n                dest = room.exits[exit].DestID || room.exits[exit].num || null;\r\n                room.exits[exit] = {\r\n                    num: dest ? '' + dest : null,\r\n                    isdoor: +room.exits[exit].IsDoor || +room.exits[exit].isdoor || null,\r\n                    isclosed: +room.exits[exit].IsClosed || +room.exits[exit].isclosed || null\r\n                };\r\n            }\r\n        }\r\n        return new Room(room);\r\n    }\r\n\r\n    private buildKeys() {\r\n        this._keys = Object.keys(this._rooms).sort((a, b) => {\r\n            const aRoom = this._rooms[a];\r\n            const bRoom = this._rooms[b];\r\n            if (aRoom.x > bRoom.x) return 1;\r\n            if (aRoom.x < bRoom.x) return -1;\r\n            if (aRoom.y > bRoom.y) return 1;\r\n            if (aRoom.y < bRoom.y) return -1;\r\n            if (aRoom.z > bRoom.z) return 1;\r\n            if (aRoom.z < bRoom.z) return -1;\r\n            if (aRoom.zone > bRoom.zone) return 1;\r\n            if (aRoom.zone < bRoom.zone) return -1;\r\n            return a.localeCompare(b);\r\n        });\r\n        this._keysZones = this._keys.slice().sort((a, b) => {\r\n            const aRoom = this._rooms[a];\r\n            const bRoom = this._rooms[b];\r\n            if (aRoom.zone > bRoom.zone) return 1;\r\n            if (aRoom.zone < bRoom.zone) return -1;\r\n            return a.localeCompare(b);\r\n        });\r\n    }\r\n\r\n    private buildAreas() {\r\n        this._areas = [];\r\n        this._keys.forEach(key => {\r\n            if (this._areas.indexOf(this._rooms[key].area) === -1)\r\n                this._areas.push(this._rooms[key].area);\r\n        });\r\n        this._areas.sort();\r\n    }\r\n\r\n    private _cancel;\r\n    public cancelImport() {\r\n        this._cancel = true;\r\n    }\r\n\r\n    public async import(data, type: ImportType) {\r\n        if (!data || data === null || typeof data == 'undefined') {\r\n            return;\r\n        }\r\n        this._cancel = false;\r\n        if (!Array.isArray(data))\r\n            data = Object.values(data);\r\n        if (type === ImportType.Replace)\r\n            this.removeAllRooms();\r\n        this.emit('import-progress', 0);\r\n        const rl = data.length;\r\n        let room;\r\n        const areas = {};\r\n        this._areas.forEach(area => areas[area] = true);\r\n        const rooms = [];\r\n        for (let r = 0; r < rl; r++) {\r\n            if (this._cancel)\r\n                break;\r\n            this.emit('import-progress', Math.floor(r / rl * 100));\r\n            if (data[r] === null) continue;\r\n            room = this.normalizeRoom(data[r]);\r\n            this._rooms[room.num] = room;\r\n            if (room.zone > this._zone)\r\n                this._zone = room.zone;\r\n            areas[room.area] = true;\r\n            rooms.push(room);\r\n        }\r\n        this.emit('rooms-changed', rooms);\r\n        this._areas = Object.keys(areas);\r\n        this._areas.sort();\r\n        this.emit('areas-added', Object.keys(areas));\r\n        this.buildKeys();\r\n        this.changed = true;\r\n        if (this._cancel)\r\n            this.emit('import-canceled');\r\n        else\r\n            this.emit('import-complete');\r\n\r\n    }\r\n}\r\n", "import { EventEmitter } from \"../events\";\r\nimport { debounce } from \"../library\";\r\n\r\nexport interface DialogOptions {\r\n    title?: string;\r\n    width?: string | number;\r\n    height?: string | number;\r\n    minWidth?: string | number;\r\n    minHeight?: string | number;\r\n    x?: string | number;\r\n    y?: string | number;\r\n    id?: string;\r\n    buttons?: DialogButtons;\r\n    resizable?: boolean;\r\n    moveable?: boolean;\r\n    maximizable?: boolean;\r\n    noAdaptive?: boolean;\r\n    maximized?: boolean;\r\n    showModal?: boolean;\r\n    show?: boolean | number;\r\n    center?: boolean;\r\n    keepCentered?: boolean;\r\n    noFooter?: boolean;\r\n    position?: Position;\r\n    closeable?: boolean;\r\n}\r\n\r\nenum ResizeType {\r\n    None = 0,\r\n    Right = 1 << 0,\r\n    Bottom = 1 << 1,\r\n    Left = 1 << 2,\r\n    Top = 1 << 3,\r\n}\r\n\r\nenum Position {\r\n    Left = 1 << 0,\r\n    Right = 1 << 1,\r\n    Top = 1 << 2,\r\n    Bottom = 1 << 3,\r\n    CenterVertical = 1 << 4,\r\n    CenterHorizontal = 1 << 5,\r\n    Center = Position.CenterHorizontal | Position.CenterVertical\r\n}\r\n\r\nexport enum DialogButtons {\r\n    None = 0,\r\n    Ok = 1 << 0,\r\n    Cancel = 1 << 1,\r\n    Yes = 1 << 2,\r\n    No = 1 << 3,\r\n    YesNo = Yes | No,\r\n    Standard = Ok | Cancel\r\n}\r\n\r\nexport enum DialogIcon {\r\n    question = 1,\r\n    info = 2,\r\n    error = 3,\r\n    exclamation = 4\r\n}\r\n\r\nexport class Dialog extends EventEmitter {\r\n    private _dialog;\r\n    private _body;\r\n    private _footer;\r\n    private _header;\r\n    private _title;\r\n    private _id;\r\n    private _state = { x: 0, y: 0, height: 0, width: 0, zIndex: 100, maximized: false, show: 0 };\r\n    private _resize = { x: 0, y: 0, height: 0, width: 0, type: ResizeType.None, minHeight: 150, minWidth: 300, borderHeight: 1, borderWidth: 1 };\r\n    private _dragPosition = { x: 0, y: 0 };\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    private _windowResize = () => {\r\n        //if window resized ensure top left corner is visible\r\n        debounce(() => {\r\n            if (this.keepCentered || (this._state.show === 2 && !this.moveable))\r\n                this.center();\r\n            else\r\n                this.makeVisible();\r\n            if (this._footer.style.display !== 'none')\r\n                this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n            this.emit('resizing');\r\n        }, 250, this._id + 'dialogResize');\r\n    };\r\n\r\n    private resizeDoDrag = e => {\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.clientY - this._resize.y;\r\n            if (t > window.innerWidth - 16) t = window.innerHeight - 16;\r\n            this._dialog.style.height = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                this._dialog.style.height = this._resize.minHeight + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + \"px\";\r\n            t = e.clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                this._dialog.style.width = this._resize.minWidth + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + \"px\";\r\n            t = e.clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + \"px\";\r\n        }\r\n        if (this._footer.style.display !== 'none')\r\n            this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n        this.emit('resizing');\r\n    };\r\n\r\n    private resizeTouchDrag = e => {\r\n        if (!e.touches.length) return;\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.touches[0].clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.touches[0].clientY - this._resize.y;\r\n            if (t > window.innerWidth) t = window.innerHeight;\r\n            this._dialog.style.height = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.touches[0].clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                this._dialog.style.height = this._resize.minHeight + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + \"px\";\r\n            t = e.touches[0].clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.touches[0].clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                this._dialog.style.width = this._resize.minWidth + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + \"px\";\r\n            t = e.touches[0].clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + \"px\";\r\n        }\r\n        if (this._footer.style.display !== 'none')\r\n            this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n        this.emit('resizing');\r\n    };\r\n\r\n    private resizeStopDrag = e => {\r\n        document.documentElement.removeEventListener(\"mousemove\", this.resizeDoDrag);\r\n        document.documentElement.removeEventListener(\"mouseup\", this.resizeStopDrag);\r\n        document.documentElement.removeEventListener(\"touchmove\", this.resizeTouchDrag);\r\n        document.documentElement.removeEventListener(\"touchend\", this.resizeStopDrag);\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this._body.style.pointerEvents = '';\r\n        this.emit('resized', this._state);\r\n    }\r\n\r\n    private dragMouseDown = e => {\r\n        if (this.maximized) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        document.documentElement.addEventListener('mouseup', this.dragMouseUp);\r\n        document.documentElement.addEventListener('mousemove', this.dragMouseMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private dragTouchStart = e => {\r\n        if (this.maximized) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        document.documentElement.addEventListener('touchend', this.dragMouseUp);\r\n        document.documentElement.addEventListener('touchmove', this.dragTouchMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private dragMouseMove = e => {\r\n        let x = this._dragPosition.x - e.clientX;\r\n        let y = this._dragPosition.y - e.clientY;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        let size = this._size;\r\n        if (this._state.x < 16 - size.width)\r\n            this._state.x = 16 - size.width;\r\n        if (this._state.y < 16 - size.height)\r\n            this._state.y = 16 - size.height;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private dragTouchMove = e => {\r\n        if (!e.touches.length) return;\r\n        let x = this._dragPosition.x - e.touches[0].clientX;\r\n        let y = this._dragPosition.y - e.touches[0].clientY;\r\n        this._dragPosition.x = e.touches[0].clientX;\r\n        this._dragPosition.y = e.touches[0].clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        let size = this._size;\r\n        if (this._state.x < 16 - size.width)\r\n            this._state.x = 16 - size.width;\r\n        if (this._state.y < 16 - size.height)\r\n            this._state.y = 16 - size.height;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private dragMouseUp = () => {\r\n        document.documentElement.removeEventListener('mouseup', this.dragMouseUp);\r\n        document.documentElement.removeEventListener('mousemove', this.dragMouseMove);\r\n        document.documentElement.removeEventListener('touchend', this.dragMouseUp);\r\n        document.documentElement.removeEventListener('touchmove', this.dragTouchMove);\r\n        this._header.style.cursor = '';\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this.emit('moved', this._state);\r\n    };\r\n\r\n    public keepCentered: boolean = false;\r\n    public moveable: boolean = true;\r\n    public resizable: boolean = true;\r\n    private _maximizable: boolean = true;\r\n    private _closable: boolean = true;\r\n\r\n    public get maximizable() { return this._maximizable; }\r\n    public set maximizable(value) {\r\n        if (value === this._maximizable) return;\r\n        this._maximizable = value;\r\n        if (this.maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n    }\r\n\r\n    public get closeable() { return this._closable; }\r\n    public set closeable(value) {\r\n        if (value === this._closable) return;\r\n        this._closable = value;\r\n        if (this._closable)\r\n            this._dialog.querySelector(`#${this._id}-header-close`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-header-close`).style.display = 'none';\r\n    }\r\n\r\n    public set maximized(value: boolean) {\r\n        if (this._state.maximized === value) return;\r\n        this._state.maximized = value;\r\n    }\r\n    public get maximized(): boolean {\r\n        return this._state.maximized;\r\n    }\r\n\r\n    constructor(options?: DialogOptions) {\r\n        super();\r\n        if (options && 'type' in options && options.type == 1) {\r\n            this._dialog = document.createElement('div');\r\n            this._dialog.open = false;\r\n        }\r\n        else\r\n            this._dialog = document.createElement('dialog');\r\n\r\n        if (typeof this._dialog.showModal !== \"function\") {\r\n            this._dialog.showModal = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 2;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n                if (!this._dialog._keydown) {\r\n                    this._dialog._keydown = e => {\r\n                        if (e.key === 'Escape' && e.srcElement.tagName !== 'TEXTAREA' && e.srcElement.tagName !== 'INPUT' && e.srcElement.tagName !== 'SELECT') {\r\n                            this._dialog.returnValue = 'canceled';\r\n                            this.close();\r\n                        }\r\n                    }\r\n                }\r\n                if (!this._dialog.backdrop_) {\r\n                    this._dialog.backdrop_ = document.createElement('div');\r\n                    this._dialog.backdrop_.className = 'backdrop';\r\n                    this._dialog.backdrop_MouseEvent = function (e) {\r\n                        if (!this.hasAttribute('tabindex')) {\r\n                            var fake = document.createElement('div');\r\n                            this.insertBefore(fake, this.firstChild);\r\n                            fake.tabIndex = -1;\r\n                            fake.focus();\r\n                            this.removeChild(fake);\r\n                        }\r\n                        else\r\n                            this.focus();\r\n                        var redirectedEvent = document.createEvent('MouseEvents');\r\n                        redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\r\n                            e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\r\n                            e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\r\n                        this.dispatchEvent(redirectedEvent);\r\n                        e.stopPropagation();\r\n                    }\r\n                    this._dialog.backdrop_.addEventListener('mouseup', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('mousedown', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('click', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                }\r\n                this._dialog.parentNode.insertBefore(this._dialog.backdrop_, this._dialog.nextSibling);\r\n                window.document.addEventListener('keydown', this._dialog._keydown);\r\n            };\r\n        }\r\n        //poly fill functions if not found to fake dialog\r\n        if (typeof this._dialog.show !== \"function\") {\r\n            this._dialog.show = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 1;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n            };\r\n        }\r\n        if (typeof this._dialog.close !== \"function\") {\r\n            this._dialog.close = () => {\r\n                this._dialog.style.display = '';\r\n                this._dialog.style.visibility = '';\r\n                this._dialog.open = false;\r\n                this._state.show = 0;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n                window.removeEventListener('resize', this._windowResize);\r\n                this.emit('closed');\r\n            };\r\n        }\r\n        this._dialog.dialog = this;\r\n        if (options && 'id' in options && options.id && options.id.length)\r\n            this._id = options.id;\r\n        else if (!this._id || !this._id.length)\r\n            this._id = 'dialog' + new Date().getTime();\r\n        this._dialog.id = this._id;\r\n        this._dialog.style.zIndex = '100';\r\n        this._dialog.style.margin = '0';\r\n        this._dialog.classList.add('dialog');\r\n        if (!options || !options.noAdaptive)\r\n            this._dialog.classList.add('adaptive');\r\n        if (options && 'moveable' in options)\r\n            this.moveable = options.moveable;\r\n        if (options && 'resizable' in options)\r\n            this.resizable = options.resizable;\r\n        if (options && 'maximizable' in options)\r\n            this._maximizable = options.maximizable;\r\n        if (typeof options?.height === 'number')\r\n            this._dialog.style.height = options.height + 'px';\r\n        else if (options?.height && options?.height.length > 0)\r\n            this._dialog.style.height = options.height;\r\n        else\r\n            this._dialog.style.height = '480px';\r\n\r\n        if (typeof options?.minHeight === 'number')\r\n            this._dialog.style.minHeight = options.minHeight + 'px';\r\n        else if (options?.minHeight && options?.minHeight.length > 0)\r\n            this._dialog.style.minHeight = options.minHeight;\r\n        else\r\n            this._dialog.style.minHeight = '150px';\r\n\r\n        if (typeof options?.minWidth === 'number')\r\n            this._dialog.style.minWidth = options.minWidth + 'px';\r\n        else if (options?.minWidth && options?.minWidth.length > 0)\r\n            this._dialog.style.minWidth = options.minWidth;\r\n        else\r\n            this._dialog.style.minWidth = '300px';\r\n\r\n        if (typeof options?.width === 'number')\r\n            this._dialog.style.width = options.width + 'px';\r\n        else if (options?.width && options?.width.length > 0)\r\n            this._dialog.style.width = options.width;\r\n        else\r\n            this._dialog.style.width = '640px';\r\n        if (typeof options?.y === 'number')\r\n            this._dialog.style.top = options.y + 'px';\r\n        else if (options?.y && options?.y.length > 0)\r\n            this._dialog.style.top = options.y;\r\n        else\r\n            this._dialog.style.top = '0';\r\n        if (typeof options?.x === 'number')\r\n            this._dialog.style.left = options.x + 'px';\r\n        else if (options?.x && options?.x.length > 0)\r\n            this._dialog.style.left = options.x;\r\n        else\r\n            this._dialog.style.left = '0';\r\n        let footer = '';\r\n        if (options && (options.buttons & DialogButtons.Cancel) === DialogButtons.Cancel)\r\n            footer += `<button id=\"${this._id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Cancel dialog\">Cancel</button>`\r\n        if (options && (options.buttons & DialogButtons.Ok) === DialogButtons.Ok)\r\n            footer += `<button id=\"${this._id}-ok\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Confirm dialog\">Ok</button>`;\r\n        if (options && (options.buttons & DialogButtons.No) === DialogButtons.No)\r\n            footer += `<button id=\"${this._id}-no\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"No\">No</button>`\r\n        if (options && (options.buttons & DialogButtons.Yes) === DialogButtons.Yes)\r\n            footer += `<button id=\"${this._id}-yes\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Yes\">Yes</button>`;\r\n        this._dialog.innerHTML = `<div class=\"dialog-header\">\r\n        <button id=\"${this._id}-header-close\" style=\"padding: 4px;\" type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" title=\"Close window\"></button>\r\n        <button type=\"button\" class=\"btn btn-light float-end maximize\" id=\"${this._id}-max\" title=\"Maximize window\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-arrows-fullscreen\"></i></button>\r\n        <div>${options?.title || ''}</div>\r\n    </div>\r\n    <div class=\"dialog-body\"></div>\r\n    <div class=\"dialog-footer\">${footer}</div>`;\r\n        this._dialog.querySelector(`#${this._id}-header-close`).addEventListener('click', () => {\r\n            this.close();\r\n        });\r\n        this._dialog.querySelector(`#${this._id}-max`).addEventListener('click', () => {\r\n            if (!this.maximized)\r\n                this.maximize();\r\n            else\r\n                this.restore();\r\n        });\r\n        this._dialog.addEventListener('close', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('closing', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            this._dialog.dataset.show = '' + this._state.show;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            window.removeEventListener('resize', this._windowResize);\r\n            this.emit('closed', this._dialog.returnValue);\r\n        });\r\n        this._dialog.addEventListener('cancel', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('canceling', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //prevent closing ig in edit field, note this does not stop chrome from closing dialog if esc is pressed multiple times\r\n            if (document.activeElement && (document.activeElement.tagName === 'TEXTAREA' ||\r\n                document.activeElement.tagName === 'iNPUT' ||\r\n                document.activeElement.tagName === 'SELECT')\r\n            ) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //left true sometimes so lets just always make it false to ensure modal dialogs open right\r\n            this._dialog.open = false;\r\n            document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            this._dialog.dataset.show = '' + this._state.show;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            window.removeEventListener('resize', this._windowResize);\r\n            if (this._dialog.returnValue !== 'ok')\r\n                this.emit('canceled');\r\n        });\r\n        document.body.appendChild(this._dialog);\r\n\r\n        if (this._maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n        if (options && 'closeable' in options)\r\n            this.closeable = options.closeable;\r\n        if (options && (options.buttons & DialogButtons.Cancel) === DialogButtons.Cancel)\r\n            this._dialog.querySelector(`#${this._id}-cancel`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Cancel };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'cancel';\r\n                this.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.No) === DialogButtons.No)\r\n            this._dialog.querySelector(`#${this._id}-no`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.No };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'no';\r\n                this.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.Ok) === DialogButtons.Ok)\r\n            this._dialog.querySelector(`#${this._id}-ok`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Ok };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'ok';\r\n                this._dialog.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.Yes) === DialogButtons.Yes)\r\n            this._dialog.querySelector(`#${this._id}-yes`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Yes };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'yes';\r\n                this._dialog.close();\r\n            });\r\n        this._body = this._dialog.querySelector('[class=\"dialog-body\"]');\r\n        this._title = this._dialog.querySelector('[class=\"dialog-header\"] div');\r\n        this._footer = this._dialog.querySelector('[class=\"dialog-footer\"]');\r\n        this._header = this._dialog.querySelector('[class=\"dialog-header\"]');\r\n\r\n        if (this.resizable) {\r\n            this._dialog.classList.add('resizable');\r\n            var right = document.createElement(\"div\");\r\n            right.className = \"resizer-right\";\r\n            this._dialog.appendChild(right);\r\n            right.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right) }, false);\r\n            right.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right) }, { passive: true });\r\n\r\n            var bottom = document.createElement(\"div\");\r\n            bottom.className = \"resizer-bottom\";\r\n            this._dialog.appendChild(bottom);\r\n            bottom.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Bottom) }, false);\r\n            bottom.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Bottom) }, { passive: true });\r\n\r\n            var corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-se\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right | ResizeType.Bottom) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right | ResizeType.Bottom) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-ne\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right | ResizeType.Top) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-nw\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left | ResizeType.Top) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-sw\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left | ResizeType.Bottom) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left | ResizeType.Bottom) }, { passive: true });\r\n\r\n            var left = document.createElement(\"div\");\r\n            left.className = \"resizer-left\";\r\n            this._dialog.appendChild(left);\r\n            left.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left) }, false);\r\n            left.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left) }, { passive: true });\r\n\r\n            var top = document.createElement(\"div\");\r\n            top.className = \"resizer-top\";\r\n            this._dialog.appendChild(top);\r\n            top.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Top) }, false);\r\n            top.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Top) }, { passive: true });\r\n        }\r\n\r\n        if (this.moveable) {\r\n            this._dialog.addEventListener('mousedown', () => {\r\n                this.focus();\r\n            })\r\n            this._header.addEventListener('mousedown', this.dragMouseDown);\r\n            this._header.addEventListener('touchstart', this.dragTouchStart, { passive: true });\r\n        }\r\n\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = this._resize.x = parseInt(styles.left, 10);;\r\n        this._state.width = this._resize.width = parseInt(styles.width, 10);\r\n        this._state.y = this._resize.y = parseInt(styles.top, 10);;\r\n        this._state.height = this._resize.height = parseInt(styles.height, 10);\r\n        if (options && 'noFooter' in options && options.noFooter)\r\n            this.hideFooter();\r\n        if (options && 'maximized' in options && options.maximized)\r\n            this.maximize();\r\n        if (options && 'showModal' in options && options.showModal)\r\n            this.showModal();\r\n        else if (options && 'show' in options && options.show) {\r\n            if (options.show === 2)\r\n                this.showModal();\r\n            else\r\n                this.show();\r\n        }\r\n        if ((options && 'keepCentered' in options && options.keepCentered))\r\n            this.keepCentered = options.keepCentered;\r\n        if (this.keepCentered || (options && 'center' in options && options.center))\r\n            this.center();\r\n        if (options && 'position' in options && options.position > 0)\r\n            this.position(options.position);\r\n        this._windowResize();\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            //debounce(() => {\r\n            if (!this._resizeObserverCache || this._resizeObserverCache.height !== entries[0].contentRect.height) {\r\n                this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                if (this._footer.style.display !== 'none')\r\n                    this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n            }\r\n            //}, 50, 'resize');\r\n        });\r\n        this._resizeObserver.observe(this._footer);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    if (this._footer.style.display !== 'none')\r\n                        this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._footer, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n    }\r\n\r\n    private initResize(e, type) {\r\n        if (this.maximized) return;\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._resize.x = e.clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        this._resize.borderHeight = e.offsetY + parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = e.offsetX + parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        document.documentElement.addEventListener(\"mousemove\", this.resizeDoDrag, false);\r\n        document.documentElement.addEventListener(\"mouseup\", this.resizeStopDrag, false);\r\n    }\r\n\r\n    private initResizeTouch(e, type) {\r\n        if (!e.touches.length || this.maximized) return;\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._resize.x = e.touches[0].clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.touches[0].clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        var rect = e.target.getBoundingClientRect();\r\n        var x = e.targetTouches[0].clientX - rect.x;\r\n        var y = e.targetTouches[0].clientY - rect.y;\r\n        this._resize.borderHeight = y + parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = x + parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        document.documentElement.addEventListener(\"touchmove\", this.resizeTouchDrag, false);\r\n        document.documentElement.addEventListener(\"touchend\", this.resizeStopDrag, false);\r\n    }\r\n\r\n    public get id() {\r\n        return this._id;\r\n    }\r\n\r\n    public set id(value) {\r\n        if (this._id === value) return;\r\n        this._id = value;\r\n        if (this._dialog) {\r\n            this._dialog.id = this._id;\r\n            let el = this._dialog.querySelector(`#${this._id}-cancel`);\r\n            if (el) el.id = this._id + '-cancel';\r\n            el = this._dialog.querySelector(`#${this._id}-ok`);\r\n            if (el) el.id = this._id + '-ok';\r\n            el = this._dialog.querySelector(`#${this._id}-max`);\r\n            if (el) el.id = this._id + '-max';\r\n            el = this._dialog.querySelector(`#${this._id}-header-close`);\r\n            if (el) el.id = this._id + '-header-close';\r\n        }\r\n    }\r\n\r\n    public get title() {\r\n        return this._title.innerHTML;\r\n    }\r\n    public set title(value) {\r\n        this._title.innerHTML = value;\r\n    }\r\n\r\n    public showModal() {\r\n        if (!this._dialog.parentElement)\r\n            document.body.appendChild(this._dialog);\r\n        this.makeVisible(true);\r\n        this._dialog.returnValue = '';\r\n        if (this._dialog.open) {\r\n            this.focus();\r\n            return;\r\n        }\r\n        this._dialog.showModal();\r\n        this._state.show = 2;\r\n        this._dialog.dataset.show = '' + this._state.show;\r\n        window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', true);\r\n        this.focus();\r\n    }\r\n\r\n    public show() {\r\n        if (!this._dialog.parentElement)\r\n            document.body.appendChild(this._dialog);\r\n        this.makeVisible(true);\r\n        this._dialog.returnValue = '';\r\n        if (this._dialog.open) {\r\n            this.focus();\r\n            return;\r\n        }\r\n        this._dialog.show();\r\n        this._state.show = 1;\r\n        this._dialog.dataset.show = '' + this._state.show;\r\n        window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', false);\r\n        this.focus();\r\n    }\r\n\r\n    public get opened() {\r\n        return this._dialog.open;\r\n    }\r\n\r\n    public close(returnValue?) {\r\n        if (!this._dialog.open) return;\r\n        if (this._dialog.backdrop_)\r\n            this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n        if (this._dialog._keydown)\r\n            window.document.removeEventListener('keydown', this._dialog._keydown);\r\n        if (returnValue)\r\n            this._dialog.returnValue = returnValue;\r\n        this._dialog.close();\r\n    }\r\n\r\n    public get header() {\r\n        return this._header;\r\n    }\r\n    public get body() {\r\n        return this._body;\r\n    }\r\n    public get footer() {\r\n        return this._footer;\r\n    }\r\n    public get dialog() {\r\n        return this._dialog;\r\n    }\r\n\r\n    public get left() {\r\n        return this._dialog.style.left;\r\n    }\r\n    public set left(value) {\r\n        this._dialog.style.left = value;\r\n    }\r\n\r\n    public get top() {\r\n        return this._dialog.style.top;\r\n    }\r\n    public set top(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get width() {\r\n        return this._dialog.style.width;\r\n    }\r\n    public set width(value) {\r\n        this._dialog.style.width = value;\r\n    }\r\n\r\n    public get height() {\r\n        return this._dialog.style.height;\r\n    }\r\n    public set height(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get windowState() {\r\n        return this._state;\r\n    }\r\n\r\n    private _width() {\r\n        let w = this.dialog.offsetWidth || this._dialog.clientWidth;\r\n        if (!w) {\r\n            const styles = document.defaultView.getComputedStyle(this._dialog);\r\n            w = w || parseInt(styles.width, 10);\r\n        }\r\n        return w;\r\n    }\r\n\r\n    private _height() {\r\n        let h = this.dialog.offsetHeight || this._dialog.clientHeight;\r\n        if (!h) {\r\n            const styles = document.defaultView.getComputedStyle(this._dialog);\r\n            h = h || parseInt(styles.height, 10);\r\n        }\r\n        return h;\r\n    }\r\n\r\n    private get _size() {\r\n        let w = this.dialog.offsetWidth || this._dialog.clientWidth;\r\n        let h = this.dialog.offsetHeight || this._dialog.clientHeight;\r\n        if (!w || !h) {\r\n            const styles = document.defaultView.getComputedStyle(this._dialog);\r\n            w = w || parseInt(styles.width, 10);\r\n            h = h || parseInt(styles.height, 10);\r\n        }\r\n        return { width: w, height: h };\r\n    }\r\n\r\n    public center() {\r\n        this.position(Position.Center);\r\n    }\r\n\r\n    public position(position: Position) {\r\n        if (position < 1) return;\r\n        //styles2.width\r\n        let size = this._size;\r\n        if ((position & Position.Top) === Position.Top)\r\n            this._state.y = 0;\r\n        else if ((position & Position.Bottom) === Position.Bottom)\r\n            this._state.y = window.innerHeight - size.height;\r\n        else if ((position & Position.CenterVertical) === Position.CenterVertical)\r\n            this._state.y = (window.innerHeight / 2 - size.height / 2);\r\n\r\n        if ((position & Position.Left) === Position.Left)\r\n            this._state.x = 0;\r\n        else if ((position & Position.Right) === Position.Right)\r\n            this._state.x = window.innerWidth - size.width;\r\n        else if ((position & Position.CenterHorizontal) === Position.CenterHorizontal)\r\n            this._state.x = (window.innerWidth / 2 - size.width / 2);\r\n\r\n        this._dialog.style.left = this._state.x + 'px';\r\n        this._dialog.style.top = this._state.y + 'px';\r\n        this._state.width = size.width;\r\n        this._state.height = size.height;\r\n        this.emit('moved', this._state);\r\n    }\r\n\r\n    public maximize() {\r\n        if (this.maximized) return;\r\n        this.maximized = true;\r\n        this._dialog.classList.add('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-angle-contract');\r\n        this.emit('maximized');\r\n    }\r\n\r\n    public restore() {\r\n        if (!this.maximized) return;\r\n        this.maximized = false;\r\n        this._dialog.classList.remove('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-angle-contract');\r\n        this.emit('restored');\r\n    }\r\n\r\n    private getMaxZIndex(forceReset?: boolean) {\r\n        const dialogs = document.getElementsByTagName('dialog');\r\n        let d = 0;\r\n        const dl = dialogs.length;\r\n        let i = parseInt(this._dialog.style.zIndex, 10);;\r\n        const order = [];\r\n        for (; d < dl; d++) {\r\n            if (!dialogs[d].style.zIndex || !dialogs[d].style.zIndex.length) continue;\r\n            let z = parseInt(dialogs[d].style.zIndex, 10);\r\n            if (z > i)\r\n                i = z;\r\n            order.push({ z: z, idx: d, show: parseInt(dialogs[d].dataset.show || '', 10) || 0 });\r\n        }\r\n        this._state.zIndex = i;\r\n        if (forceReset || this._state.zIndex > 1000) {\r\n            this._state.zIndex = 100;\r\n            d = 0;\r\n            //show by show type then old z-index, we do this to ensure modal style dialogs are on top\r\n            order.sort((a, b) => ((a.show > b.show) ? 1 : (a.z < b.z) ? -1 : (a.z > b.z ? 1 : 0)))\r\n            for (; d < dl; d++) {\r\n                if ((<any>dialogs[order[d]]).backdrop_)\r\n                    (<any>dialogs[order[d]]).backdrop_.style.zIndex = '' + (this._state.zIndex++);\r\n                dialogs[order[d].idx].style.zIndex = '' + (this._state.zIndex++);\r\n            }\r\n        }\r\n    }\r\n\r\n    public showFooter() {\r\n        this._footer.style.display = '';\r\n        this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n    }\r\n\r\n    public hideFooter() {\r\n        this._footer.style.display = 'none';\r\n        this._body.style.bottom = '0';\r\n    }\r\n\r\n    public focus() {\r\n        this._dialog.focus();\r\n        this.getMaxZIndex();\r\n        this._dialog.style.zIndex = '' + ++this._state.zIndex;\r\n        this.emit('focus');\r\n    }\r\n\r\n    public makeVisible(full?, silent?) {\r\n        var rect = this._dialog.getBoundingClientRect();\r\n        if (full) {\r\n            if (rect.right > window.innerWidth) {\r\n                this._state.x = window.innerWidth - this._state.width - 16;\r\n                if (rect.left < 0) this._state.x = 0;\r\n                this._dialog.style.left = this._state.x + \"px\";\r\n            }\r\n            if (rect.bottom > window.innerHeight) {\r\n                this._state.y = window.innerHeight - this._state.height - 16;\r\n                if (rect.top < 0) this._state.y = 0;\r\n                this._dialog.style.top = this._state.y + \"px\";\r\n            }\r\n        }\r\n        else {\r\n            if (rect.left > window.innerWidth - 16) {\r\n                this._state.x = (window.innerWidth - 16);\r\n                this._dialog.style.left = this._state.x + \"px\";\r\n            }\r\n            if (rect.top > window.innerHeight - 16) {\r\n                this._state.y = (window.innerHeight - 16);\r\n                this._dialog.style.top = this._state.y + \"px\";\r\n            }\r\n        }\r\n        if (!silent)\r\n            this.emit('moved', this._state);\r\n    }\r\n\r\n    public resetState(options: DialogOptions) {\r\n        if (typeof options?.height === 'number')\r\n            this._dialog.style.height = options.height + 'px';\r\n        else if (options?.height && options?.height.length > 0)\r\n            this._dialog.style.height = options.height;\r\n        else\r\n            this._dialog.style.height = '480px';\r\n\r\n        if (typeof options?.minHeight === 'number')\r\n            this._dialog.style.minHeight = options.minHeight + 'px';\r\n        else if (options?.minHeight && options?.minHeight.length > 0)\r\n            this._dialog.style.minHeight = options.minHeight;\r\n        else\r\n            this._dialog.style.minHeight = '150px';\r\n\r\n        if (typeof options?.minWidth === 'number')\r\n            this._dialog.style.minWidth = options.minWidth + 'px';\r\n        else if (options?.minWidth && options?.minWidth.length > 0)\r\n            this._dialog.style.minWidth = options.minWidth;\r\n        else\r\n            this._dialog.style.minWidth = '300px';\r\n\r\n        if (typeof options?.width === 'number')\r\n            this._dialog.style.width = options.width + 'px';\r\n        else if (options?.width && options?.width.length > 0)\r\n            this._dialog.style.width = options.width;\r\n        else\r\n            this._dialog.style.width = '640px';\r\n        if (typeof options?.y === 'number')\r\n            this._dialog.style.top = options.y + 'px';\r\n        else if (options?.y && options?.y.length > 0)\r\n            this._dialog.style.top = options.y;\r\n        else\r\n            this._dialog.style.top = '0';\r\n        if (typeof options?.x === 'number')\r\n            this._dialog.style.left = options.x + 'px';\r\n        else if (options?.x && options?.x.length > 0)\r\n            this._dialog.style.left = options.x;\r\n        else\r\n            this._dialog.style.left = '0';\r\n\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = this._resize.x = parseInt(styles.left, 10);;\r\n        this._state.width = this._resize.width = parseInt(styles.width, 10);\r\n        this._state.y = this._resize.y = parseInt(styles.top, 10);;\r\n        this._state.height = this._resize.height = parseInt(styles.height, 10);\r\n        if (options && 'maximized' in options && options.maximized)\r\n            this.maximize();\r\n        else\r\n            this.restore();\r\n        if (this.keepCentered || (options && 'center' in options && options.center))\r\n            this.center();\r\n        if (options && 'position' in options && options.position > 0)\r\n            this.position(options.position);\r\n        this._windowResize();\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        this._body.innerHTML = contents;\r\n        args = args || {};\r\n        const scripts: HTMLScriptElement[] = this._body.querySelectorAll('script');\r\n        for (let s = 0, sl = scripts.length; s < sl; s++) {\r\n            /*jslint evil: true */\r\n            let script = new Function('body', 'dialog', ...Object.keys(args), scripts[s].textContent);\r\n            script.apply(client, [this._body, this, ...Object.values(args), this]);\r\n        }\r\n    }\r\n}\r\n\r\nexport class AlertDialog extends Dialog {\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.exclamation) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Ok } : title);\r\n        this.body.classList.add('d-flex', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        if (message)\r\n            this.body.innerHTML = `<div class=\"text-center\" style=\"width: 64px;height:64px;font-size: 40px;\">${getIcon(icon || DialogIcon.exclamation)}</div><div class=\"ms-3 align-self-center flex-fill\">${message}</div></div>`;\r\n    }\r\n}\r\n\r\n\r\nexport class ConfirmDialog extends Dialog {\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon, buttons?: DialogButtons) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.question) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: buttons === undefined ? DialogButtons.YesNo : buttons } : title);\r\n        this.body.classList.add('d-flex', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        if (message)\r\n            this.body.innerHTML = `<div class=\"text-center\" style=\"width: 64px;height:64px;font-size: 40px;\">${getIcon(icon || DialogIcon.question)}</div><div class=\"ms-3 align-self-center flex-fill\">${message}</div></div>`;\r\n    }\r\n}\r\n\r\nexport class ProgressDialog extends Dialog {\r\n    private _progress;\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.question) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Cancel, closeable: false } : title);\r\n        this.body.classList.add('text-center', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        this.body.innerHTML = `<div class=\"align-self-center flex-fill\" id=\"progress-message\" style=\"padding:0 5px\">${message || ''}</div></div><div class=\"progress\" role=\"progressbar\" aria-label=\"${title}\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"margin: 5px;\"><div class=\"progress-bar\" style=\"width: 0%\"></div></div>`;\r\n        this._progress = this.body.querySelector('.progress-bar');\r\n    }\r\n\r\n    public set label(value) {\r\n        this._progress.innerHTML = value;\r\n    }\r\n    public get label() { return this._progress.innerHTML; }\r\n    public set progress(value: number) {\r\n        if (value < 0) value = 0;\r\n        if (value > 100) value = 100;\r\n        this._progress.style.width = value + '%';\r\n    }\r\n    public get progress() {\r\n        return parseInt(this._progress.style.width, 10);\r\n    }\r\n\r\n    public get message() { return this.body.querySelector('#progress-message').textContent; }\r\n    public set message(value) { this.body.querySelector('#progress-message').textContent = value; }\r\n}\r\n\r\nfunction getIcon(icon: string | DialogIcon) {\r\n    if (typeof icon === 'string')\r\n        return icon + ' ';\r\n    switch (icon) {\r\n        case DialogIcon.error:\r\n            return '<i class=\"fa-regular fa-circle-xmark\"></i> ';\r\n        case DialogIcon.exclamation:\r\n            return '<i class=\"fa-solid fa-circle-exclamation\"></i> ';\r\n        case DialogIcon.question:\r\n            return '<i class=\"fa-regular fa-circle-question\"></i> '\r\n    }\r\n    return '<i class=\"fa-solid fa-circle-info\"></i> ';\r\n}\r\n\r\nwindow.confirm_box = (title, message?, icon?, buttons?) => {\r\n    return new Promise((resolve, reject) => {\r\n        const confirm = new ConfirmDialog(title, message, icon, buttons);\r\n        confirm.showModal();\r\n        confirm.on('button-click', e => resolve(e));\r\n        confirm.on('canceled', () => reject(null));\r\n        confirm.on('closed', reason => reason === 'Yes' ? 0 : reject(null));\r\n    });\r\n\r\n}\r\nwindow.alert_box = (title, message?, icon?) => {\r\n    new AlertDialog(title, message, icon).showModal();\r\n}\r\nwindow.progress_box = (title, message?, icon?) => {\r\n    return new ProgressDialog(title, message, icon);\r\n}\r\n\r\nwindow.Dialog = Dialog;", "declare let client;\ndeclare let bootstrap;\n\nimport { showDialog, toggleButtons } from \"./interface\";\n\nexport function closeMenu() {\n    const instance = bootstrap.Offcanvas.getInstance(document.getElementById('clientMenu'));\n    if (!instance) return\n    instance.hide();\n}\n\nexport function showMenu() {\n    bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('clientMenu')).show();\n}\n\nexport function initMenu() {\n    document.getElementById('btn-menu').addEventListener('click', showMenu);\n    client.on('connected', () => {\n        let el = document.getElementById('menu-connect');\n        let text = document.querySelector('#menu-connect a span');\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\n        el.title = 'Disconnect';\n        el.classList.add('active');\n        text.textContent = 'Disconnect';\n        icon.classList.add('fa-plug-circle-xmark');\n        icon.classList.remove('fa-plug');\n    });\n    client.on('closed', () => {\n        let el = document.getElementById('menu-connect');\n        let text = document.querySelector('#menu-connect a span');\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\n        el.title = 'Connect';\n        el.classList.remove('active');\n        text.textContent = 'Connect';\n        icon.classList.remove('fa-plug-circle-xmark');\n        icon.classList.add('fa-plug');\n    })\n    client.on('scroll-lock', updateScrollLock);\n    document.querySelector('#menu-connect a').addEventListener('click', e => {\n        if (client.connected)\n            client.close();\n        else {\n            client.connect();\n            closeMenu();\n        }\n    });\n    document.querySelector('#menu-clear a').addEventListener('click', e => {\n        client.clear();\n        closeMenu()\n    });\n    document.querySelector('#menu-lock a').addEventListener('click', e => {\n        client.toggleScrollLock();\n        closeMenu();\n    });\n    document.querySelector('#menu-editor a').addEventListener('click', e => {\n        closeMenu();\n        document.getElementById('btn-adv-editor').click();\n    });\n    document.querySelector('#menu-about a').addEventListener('click', e => {\n        showDialog('about');\n        closeMenu();\n    });\n    document.querySelector('#menu-settings a').addEventListener('click', e => {\n        showDialog('settings');\n        closeMenu();\n    });\n    document.querySelector('#menu-profiles a').addEventListener('click', e => {\n        showDialog('profiles');\n        closeMenu();\n    });\n    document.querySelector('#menu-fullscreen a').addEventListener('click', e => {\n        var doc: any = window.document;\n        var docEl: any = doc.documentElement;\n\n        var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;\n        var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;\n        let el = document.getElementById('menu-fullscreen');\n        let icon = document.querySelector('#menu-fullscreen svg') || document.querySelector('#menu-fullscreen i');\n        let text = document.querySelector('#menu-fullscreen a span');\n        if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {\n            el.title = 'Exit fullscreen';\n            text.textContent = 'Exit fullscreen';\n            requestFullScreen.call(docEl);\n            icon.classList.add('fa-minimize');\n            icon.classList.remove('fa-maximize');\n        }\n        else {\n            el.title = 'Enter fullscreen';\n            text.textContent = 'Enter fullscreen';\n            cancelFullScreen.call(doc);\n            icon.classList.add('fa-maximize');\n            icon.classList.remove('fa-minimize');\n        }\n        closeMenu();\n    });\n    document.querySelector('#menu-buttons a').addEventListener('click', e => {\n        toggleButtons();\n        let button = document.querySelector('#menu-buttons') as HTMLElement;\n        if (client.getOption('showButtons')) {\n            button.title = 'Hide buttons';\n            button.classList.add('active');\n            document.querySelector('#menu-buttons a span').textContent = 'Hide buttons';\n        }\n        else {\n            button.title = 'Show buttons';\n            button.classList.remove('active');\n            document.querySelector('#menu-buttons a span').textContent = 'Show buttons';\n        }\n        closeMenu();\n    });\n    updateScrollLock();\n\n    let pl = client.plugins.length;\n    let s;\n    let sl;\n    const list = document.querySelector('#clientMenu ul')\n    for (let p = 0; p < pl; p++) {\n        if (!client.plugins[p].menu) continue;\n        if (client.plugins[p].menu.length) {\n            sl = client.plugins[p].menu.length;\n            for (s = 0; s < sl; s++) {\n                let item = client.plugins[p].menu[s];\n                let code;\n                let id = 'menu-' + (item.name || s).toLowerCase().replace(/ /g, '-');\n                if (item.name === '-')\n                    code = '<li><hr class=\"dropdown-divider\"></li>';\n                else if (typeof item.action === 'string')\n                    code = `<li id=\"menu-${id}\" class=\"nav-item\" title=\"${item.name || ''}\"><a class=\"nav-link\" href=\"#${item.action}\">${item.icon || ''}<span>${item.name || ''}</span></a></li>`;\n                else\n                    code = `<li id=\"menu-${id}\" class=\"nav-item\" title=\"${item.name || ''}\"><a class=\"nav-link\" href=\"javascript:void(0)\">${item.icon || ''}<span>${item.name || ''}</span></a></li>`;\n                if ('position' in item) {\n                    if (typeof item.position === 'string') {\n                        if (list.querySelector(item.position))\n                            list.querySelector(item.position).insertAdjacentHTML('afterend', code);\n                    }\n                    else if (item.position >= 0 && item.position < list.children.length) {\n                        list.children[item.position].insertAdjacentHTML('afterend', code);\n                    }\n                    else\n                        list.insertAdjacentHTML('beforeend', code);\n                }\n                else\n                    list.insertAdjacentHTML('beforeend', code);\n                if (item.name === '-') continue;\n                if (typeof item.action === 'function')\n                    document.querySelector(`#menu-${id} a`).addEventListener('click', e => {\n                        const ie = { client: client, preventDefault: false };\n                        item.action(ie);\n                        if (ie.preventDefault) return;\n                        closeMenu();\n                    });\n            }\n        }\n    }\n    let button = document.querySelector('#menu-buttons') as HTMLElement;\n    if (client.getOption('showButtons')) {\n        button.title = 'Hide buttons';\n        button.classList.add('active');\n        document.querySelector('#menu-buttons a span').textContent = 'Hide buttons';\n    }\n    else {\n        button.title = 'Show buttons';\n        button.classList.remove('active');\n        document.querySelector('#menu-buttons a span').textContent = 'Show buttons';\n    }\n}\n\nfunction updateScrollLock() {\n    let el = document.getElementById('menu-lock');\n    let text = document.querySelector('#menu-lock a span');\n    let icon = document.querySelector('#menu-lock svg') || document.querySelector('#menu-lock i');\n    if (client.scrollLock) {\n        el.title = 'Unlock display';\n        el.classList.add('active');\n        text.textContent = 'Unlock display';\n        icon.classList.add('fa-unlock');\n        icon.classList.remove('fa-lock');\n    }\n    else {\n        el.title = 'Lock display';\n        el.classList.remove('active');\n        text.textContent = 'Lock display';\n        icon.classList.remove('fa-unlock');\n        icon.classList.add('fa-lock');\n    }\n}\n", "import \"../css/tinymce.css\";\r\nimport { EventEmitter } from \"../events\";\r\nimport { RGBColor } from '../lib/rgbcolor';\r\nimport { insertValue, htmlEncode, getColors, copyText, openFileDialog, readFile, pasteText, pinkfishToHTML } from '../library'\r\nimport { Dialog } from \"./dialog\";\r\n\r\nexport class AdvEditor extends EventEmitter {\r\n    private _element;\r\n    private _simple = true;\r\n    private _colors;\r\n    private _ColorTable;\r\n    private _init = false;\r\n    //private _colorCodes;\r\n    private colorNames = {\r\n        'No color': 'Default',\r\n        'BLACK': 'Black',\r\n        'RED': 'Maroon',\r\n        'GREEN': 'Green',\r\n        'ORANGE': 'Olive',\r\n        'BLUE': 'Navy',\r\n        'MAGENTA': 'Purple',\r\n        'WHITE': 'Silver',\r\n        'CYAN': 'Teal',\r\n        'BOLD BLACK': 'Grey',\r\n        'BOLD RED': 'Red',\r\n        'BOLD GREEN': 'Lime',\r\n        'YELLOW': 'Yellow',\r\n        'BOLD YELLOW': 'Yellow',\r\n        'BOLD BLUE': 'Blue',\r\n        'BOLD MAGENTA': 'Fuchsia',\r\n        'BOLD CYAN': 'Aqua',\r\n        'BOLD': 'White',\r\n        'BOLD WHITE': 'White',\r\n        'RGB000': 'Black',\r\n        'RGB001': 'Navy Blue',\r\n        'RGB002': 'Dark Blue',\r\n        'RGB003': 'Blue',\r\n        'RGB004': 'Blue',\r\n        'RGB005': 'Blue',\r\n        'RGB010': 'Dark Green',\r\n        'RGB011': 'Deep Sky Blue',\r\n        'RGB012': 'Deep Sky Blue',\r\n        'RGB013': 'Deep Sky Blue',\r\n        'RGB014': 'Cobalt/Dodger Blue',\r\n        'RGB015': 'Dodger Blue',\r\n        'RGB020': 'Green',\r\n        'RGB021': 'Spring Green',\r\n        'RGB022': 'Turquoise',\r\n        'RGB023': 'Deep Sky Blue',\r\n        'RGB024': 'Deep Sky Blue',\r\n        'RGB025': 'Dodger Blue',\r\n        'RGB030': 'Green',\r\n        'RGB031': 'Spring Green',\r\n        'RGB032': 'Dark Cyan',\r\n        'RGB033': 'Light Sea Green',\r\n        'RGB034': 'Deep Sky Blue',\r\n        'RGB035': 'Deep Sky Blue',\r\n        'RGB040': 'Green',\r\n        'RGB041': 'Spring Green',\r\n        'RGB042': 'Spring Green',\r\n        'RGB043': 'Cyan',\r\n        'RGB044': 'Dark Turquoise',\r\n        'RGB045': 'Turquoise',\r\n        'RGB050': 'Green',\r\n        'RGB051': 'Spring Green',\r\n        'RGB052': 'Spring Green',\r\n        'RGB053': 'Medium Spring Green',\r\n        'RGB054': 'Cyan',\r\n        'RGB055': 'Cyan',\r\n        'RGB100': 'Dark Red',\r\n        'RGB101': 'Deep Pink',\r\n        'RGB102': 'Purple',\r\n        'RGB103': 'Purple',\r\n        'RGB104': 'Purple',\r\n        'RGB105': 'Blue Violet',\r\n        'RGB110': 'Orange',\r\n        'RGB111': 'Dark Grey',\r\n        'RGB112': 'Medium Purple',\r\n        'RGB113': 'Slate Blue',\r\n        'RGB114': 'Slate Blue',\r\n        'RGB115': 'Royal Blue',\r\n        'RGB120': 'Chartreuse',\r\n        'RGB121': 'Dark Sea Green',\r\n        'RGB122': 'Pale Turquoise',\r\n        'RGB123': 'Steel Blue',\r\n        'RGB124': 'Steel Blue',\r\n        'RGB125': 'Cornflower Blue',\r\n        'RGB130': 'Chartreuse',\r\n        'RGB131': 'Dark Sea Green',\r\n        'RGB132': 'Cadet Blue',\r\n        'RGB133': 'Cadet Blue',\r\n        'RGB134': 'Sky Blue',\r\n        'RGB135': 'Steel Blue',\r\n        'RGB140': 'Chartreuse',\r\n        'RGB141': 'Pale Green',\r\n        'RGB142': 'Sea Green',\r\n        'RGB143': 'Aquamarine',\r\n        'RGB144': 'Medium Turquoise',\r\n        'RGB145': 'Steel Blue',\r\n        'RGB150': 'Chartreuse',\r\n        'RGB151': 'Sea Green',\r\n        'RGB152': 'Sea Green',\r\n        'RGB153': 'Sea Green',\r\n        'RGB154': 'Aquamarine',\r\n        'RGB155': 'Dark Slate Gray',\r\n        'RGB200': 'Dark Red',\r\n        'RGB201': 'Deep Pink',\r\n        'RGB202': 'Dark Magenta',\r\n        'RGB203': 'Dark Magenta',\r\n        'RGB204': 'Dark Violet',\r\n        'RGB205': 'Purple',\r\n        'RGB210': 'Orange',\r\n        'RGB211': 'Light Pink',\r\n        'RGB212': 'Plum',\r\n        'RGB213': 'Medium Purple',\r\n        'RGB214': 'Medium Purple',\r\n        'RGB215': 'Slate Blue',\r\n        'RGB220': 'Yellow',\r\n        'RGB221': 'Wheat',\r\n        'RGB222': 'Grey',\r\n        'RGB223': 'Light Slate Grey',\r\n        'RGB224': 'Medium Purple',\r\n        'RGB225': 'Light Slate Blue',\r\n        'RGB230': 'Yellow',\r\n        'RGB231': 'Dark Olive Green',\r\n        'RGB232': 'Dark Sea Green',\r\n        'RGB233': 'Light Sky Blue',\r\n        'RGB234': 'Light Sky Blue',\r\n        'RGB235': 'Sky Blue',\r\n        'RGB240': 'Chartreuse',\r\n        'RGB241': 'Dark Olive Green',\r\n        'RGB242': 'Pale Green',\r\n        'RGB243': 'Dark Sea Green',\r\n        'RGB244': 'Dark Slate Gray',\r\n        'RGB245': 'Sky Blue',\r\n        'RGB250': 'Chartreuse',\r\n        'RGB251': 'Light Green',\r\n        'RGB252': 'Light Green',\r\n        'RGB253': 'Pale Green',\r\n        'RGB254': 'Aquamarine',\r\n        'RGB255': 'Dark Slate Gray',\r\n        'RGB300': 'Red',\r\n        'RGB301': 'Deep Pink',\r\n        'RGB302': 'Medium Violet Red',\r\n        'RGB303': 'Magenta',\r\n        'RGB304': 'Dark Violet',\r\n        'RGB305': 'Purple',\r\n        'RGB310': 'Dark Orange',\r\n        'RGB311': 'Indian Red',\r\n        'RGB312': 'Hot Pink',\r\n        'RGB313': 'Medium Orchid',\r\n        'RGB314': 'Medium Orchid',\r\n        'RGB315': 'Medium Purple',\r\n        'RGB320': 'Dark Goldenrod',\r\n        'RGB321': 'Light Salmon',\r\n        'RGB322': 'Rosy Brown',\r\n        'RGB323': 'Grey',\r\n        'RGB324': 'Medium Purple',\r\n        'RGB325': 'Medium Purple',\r\n        'RGB330': 'Gold',\r\n        'RGB331': 'Dark Khaki',\r\n        'RGB332': 'Navajo White',\r\n        'RGB333': 'Grey',\r\n        'RGB334': 'Light Steel Blue',\r\n        'RGB335': 'Light Steel Blue',\r\n        'RGB340': 'Yellow',\r\n        'RGB341': 'Dark Olive Green',\r\n        'RGB342': 'Dark Sea Green',\r\n        'RGB343': 'Dark Sea Green',\r\n        'RGB344': 'Light Cyan',\r\n        'RGB345': 'Light Sky Blue',\r\n        'RGB350': 'Green Yellow',\r\n        'RGB351': 'Dark Olive Green',\r\n        'RGB352': 'Pale Green',\r\n        'RGB353': 'Dark Sea Green',\r\n        'RGB354': 'Dark Sea Green',\r\n        'RGB355': 'Pale Turquoise',\r\n        'RGB400': 'Crimson/Red',\r\n        'RGB401': 'Deep Pink',\r\n        'RGB402': 'Deep Pink',\r\n        'RGB403': 'Magenta',\r\n        'RGB404': 'Magenta',\r\n        'RGB405': 'Magenta',\r\n        'RGB410': 'Dark Orange',\r\n        'RGB411': 'Indian Red',\r\n        'RGB412': 'Hot Pink',\r\n        'RGB413': 'Hot Pink',\r\n        'RGB414': 'Orchid',\r\n        'RGB415': 'Medium Orchid',\r\n        'RGB420': 'Orange',\r\n        'RGB421': 'Light Salmon/Bronze',\r\n        'RGB422': 'Light Pink',\r\n        'RGB423': 'Pink',\r\n        'RGB424': 'Plum',\r\n        'RGB425': 'Violet',\r\n        'RGB430': 'Gold',\r\n        'RGB431': 'Light Goldenrod',\r\n        'RGB432': 'Tan',\r\n        'RGB433': 'Misty Rose',\r\n        'RGB434': 'Thistle',\r\n        'RGB435': 'Plum',\r\n        'RGB440': 'Yellow',\r\n        'RGB441': 'Khaki',\r\n        'RGB442': 'Light Goldenrod',\r\n        'RGB443': 'Light Yellow',\r\n        'RGB444': 'Grey',\r\n        'RGB445': 'Light Steel Blue',\r\n        'RGB450': 'Yellow',\r\n        'RGB451': 'Dark Olive Green',\r\n        'RGB452': 'Dark Olive Green',\r\n        'RGB453': 'Dark Sea Green',\r\n        'RGB454': 'Honeydew',\r\n        'RGB455': 'Light Cyan',\r\n        'RGB500': 'Red',\r\n        'RGB501': 'Deep Pink',\r\n        'RGB502': 'Deep Pink',\r\n        'RGB503': 'Deep Pink',\r\n        'RGB504': 'Magenta',\r\n        'RGB505': 'Magenta',\r\n        'RGB510': 'Orangered',\r\n        'RGB511': 'Indian Red',\r\n        'RGB512': 'Indian Red',\r\n        'RGB513': 'Hot Pink',\r\n        'RGB514': 'Hot Pink',\r\n        'RGB515': 'Medium Orchid',\r\n        'RGB520': 'Dark Orange',\r\n        'RGB521': 'Salmon',\r\n        'RGB522': 'Light Coral',\r\n        'RGB523': 'Pale Violet Red',\r\n        'RGB524': 'Orchid',\r\n        'RGB525': 'Orchid',\r\n        'RGB530': 'Orange',\r\n        'RGB531': 'Sandy Brown',\r\n        'RGB532': 'Light Salmon',\r\n        'RGB533': 'Light Pink',\r\n        'RGB534': 'Pink',\r\n        'RGB535': 'Plum',\r\n        'RGB540': 'Gold',\r\n        'RGB541': 'Light Goldenrod',\r\n        'RGB542': 'Light Goldenrod',\r\n        'RGB543': 'Navajo White',\r\n        'RGB544': 'Misty Rose',\r\n        'RGB545': 'Thistle',\r\n        'RGB550': 'Yellow',\r\n        'RGB551': 'Light Goldenrod',\r\n        'RGB552': 'Khaki',\r\n        'RGB553': 'Wheat',\r\n        'RGB554': 'Corn Silk',\r\n        'RGB555': 'White',\r\n        'mono00': 'Grey 3',\r\n        'mono01': 'Grey 7',\r\n        'mono02': 'Grey 11',\r\n        'mono03': 'Grey 15',\r\n        'mono04': 'Grey 19',\r\n        'mono05': 'Grey 23',\r\n        'mono06': 'Grey 27',\r\n        'mono07': 'Grey 30',\r\n        'mono08': 'Grey 35',\r\n        'mono09': 'Grey 39',\r\n        'mono10': 'Grey 32',\r\n        'mono11': 'Grey 46',\r\n        'mono12': 'Grey 50',\r\n        'mono13': 'Grey 54',\r\n        'mono14': 'Grey 58',\r\n        'mono15': 'Grey 62',\r\n        'mono16': 'Grey 66',\r\n        'mono17': 'Grey 70',\r\n        'mono18': 'Grey 74',\r\n        'mono19': 'Grey 78',\r\n        'mono20': 'Grey 82',\r\n        'mono21': 'Grey 85',\r\n        'mono22': 'Grey 89',\r\n        'mono23': 'Grey 93'\r\n    };\r\n\r\n    private _colorDialog: Dialog;\r\n\r\n    constructor(element: string | JQuery | HTMLElement, enabledAdvanced?: boolean) {\r\n        super();\r\n        if (!element)\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        if (typeof element === 'string') {\r\n            this._element = document.querySelector(element);\r\n            if (!this._element)\r\n                throw new Error('Invalid selector for AdvEditor.');\r\n        }\r\n        else if (element instanceof $)\r\n            this._element = element[0];\r\n        else if (element instanceof HTMLElement)\r\n            this._element = element;\r\n        else\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        this.simple = !enabledAdvanced;\r\n    }\r\n\r\n    get id() {\r\n        if (this._element) return this._element.id;\r\n        return '';\r\n    }\r\n\r\n    get element(): HTMLElement {\r\n        return this._element;\r\n    }\r\n\r\n    get simple() { return this._simple; }\r\n    set simple(value) {\r\n        if (value === this._simple) return;\r\n        this._simple = value;\r\n        if (TINYMCE && !this.tinymceExist) return;\r\n        //was disabled\r\n        if (value)\r\n            this.remove();\r\n        else\r\n            this.initialize();\r\n    }\r\n    public clear() {\r\n        if (TINYMCE && !this.isSimple)\r\n            tinymce.activeEditor.setContent('');\r\n        else\r\n            this._element.value = '';\r\n    }\r\n    public get value() {\r\n        if (!this.isSimple)\r\n            return this.getFormattedText().replace(/(?:\\r)/g, '')\r\n        return this._element.value;\r\n    }\r\n    public set value(value) {\r\n        if (this.isSimple)\r\n            this._element.value = value;\r\n        else\r\n            tinymce.activeEditor.setContent(value);\r\n    }\r\n\r\n    public insert(value) {\r\n        if (!this.isSimple) {\r\n            value = htmlEncode(value);\r\n            value = value.replace(/ /g, '&nbsp;');\r\n            value = value.replace(/\\t/g, '&nbsp;&nbsp;&nbsp;');\r\n            value = value.replace(/(?:\\r\\n|\\r|\\n)/g, '<br/>');\r\n            var content = this.getText();\r\n            if (content === '\\n') {\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.setContent(value);\r\n                });\r\n            }\r\n            else {\r\n                if (!content.endsWith('\\n'))\r\n                    value = '<br>' + value;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.dom.add(tinymce.activeEditor.getBody(), 'span', {}, value);\r\n                });\r\n            }\r\n\r\n        }\r\n        else\r\n            insertValue(this._element, value); {\r\n        }\r\n\r\n    }\r\n\r\n    get tinymceExist() {\r\n        return TINYMCE && typeof (tinymce) !== 'undefined';\r\n    }\r\n\r\n    get isSimple(): boolean {\r\n        return this._simple || !this.tinymceExist;\r\n    }\r\n\r\n    private loadColors() {\r\n        var _dColors = getColors();\r\n        var c, color, r, g, b, idx, _bold = [], bl;\r\n        this._ColorTable = [];\r\n        this._colors = {};\r\n        var clientColors = client.getOption('colors') || [];\r\n        color = new RGBColor(clientColors[0] || _dColors[0]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BLACK';\r\n        this._ColorTable.push(color, 'BLACK');\r\n\r\n        color = new RGBColor(clientColors[1] || _dColors[1]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'RED';\r\n        this._ColorTable.push(color, 'RED');\r\n\r\n        color = new RGBColor(clientColors[2] || _dColors[2]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'GREEN';\r\n        this._ColorTable.push(color, 'GREEN');\r\n\r\n        color = new RGBColor(clientColors[3] || _dColors[3]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'ORANGE';\r\n        this._ColorTable.push(color, 'ORANGE');\r\n\r\n        color = new RGBColor(clientColors[4] || _dColors[4]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BLUE';\r\n        this._ColorTable.push(color, 'BLUE');\r\n        color = new RGBColor(clientColors[5] || _dColors[5]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'MAGENTA';\r\n        this._ColorTable.push(color, 'MAGENTA');\r\n        color = new RGBColor(clientColors[6] || _dColors[6]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'CYAN';\r\n        this._ColorTable.push(color, 'CYAN');\r\n        color = new RGBColor(clientColors[7] || _dColors[7]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'WHITE';\r\n        this._ColorTable.push(color, 'WHITE');\r\n\r\n        color = new RGBColor(clientColors[8] || _dColors[8]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'mono11';\r\n        this._ColorTable.push(color, 'BOLD BLACK');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[9] || _dColors[9]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^RED';\r\n        this._ColorTable.push(color, 'BOLD RED');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[10] || _dColors[10]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^GREEN';\r\n        this._ColorTable.push(color, 'BOLD GREEN');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[11] || _dColors[11]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^YELLOW';\r\n        this._ColorTable.push(color, 'BOLD YELLOW');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[11] || _dColors[11]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'YELLOW';\r\n        this._ColorTable.push(color, 'YELLOW');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[12] || _dColors[12]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^BLUE';\r\n        this._ColorTable.push(color, 'BOLD BLUE');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[13] || _dColors[13]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^MAGENTA';\r\n        this._ColorTable.push(color, 'BOLD MAGENTA');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[14] || _dColors[14]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^CYAN';\r\n        this._ColorTable.push(color, 'BOLD CYAN');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[15] || _dColors[15]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^WHITE';\r\n        this._ColorTable.push(color, 'BOLD WHITE');\r\n        //_bold.push(color);\r\n\r\n        for (r = 0; r < 6; r++) {\r\n            for (g = 0; g < 6; g++) {\r\n                for (b = 0; b < 6; b++) {\r\n                    idx = `RGB${r}${g}${b}`;\r\n                    color = '';\r\n                    c = 0;\r\n                    c = r * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = g * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = b * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    color = color.toUpperCase();\r\n                    //_ColorTable.push(color);\r\n                    //_ColorTable.push(idx);\r\n                    if (!this._colors[color])\r\n                        this._colors[color] = idx;\r\n                    this.colorList.push({ color: idx, hex: '#' + color, rgb: { r: r * 40 + 55, g: g * 40 + 55, b: b * 40 + 55 } });\r\n                }\r\n            }\r\n        }\r\n\r\n        for (r = 232; r <= 255; r++) {\r\n            g = (r - 232) * 10 + 8;\r\n            if (g < 16)\r\n                g = '0' + g.toString(16).toUpperCase();\r\n            else\r\n                g = g.toString(16).toUpperCase();\r\n            g = g + g + g;\r\n            //_ColorTable.push(g);\r\n            if (r < 242) {\r\n                //_ColorTable.push(\"mono0\" + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono0' + (r - 232);\r\n            }\r\n            else {\r\n                //_ColorTable.push(\"mono\" + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono' + (r - 232);\r\n            }\r\n        }\r\n        //this._colorCodes = invert(this._colors);\r\n        for (b = 0, bl = _bold.length; b < bl; b++) {\r\n            this._colors['B' + _bold[b]] = this._colors[this.nearestHex('#' + _bold[b]).substr(1)].toUpperCase();\r\n        }\r\n        this._colors['BFFFFFF'] = 'RGB555';\r\n        tinymce.activeEditor.options.set('color_map', this._ColorTable);\r\n    }\r\n\r\n    private initPlugins() {\r\n        if (!TINYMCE) return\r\n        const _editor = this;\r\n        tinymce.PluginManager.add('pinkfishtextcolor', function (editor, url) {\r\n            type ColorFormat = 'forecolor' | 'hilitecolor';\r\n\r\n            const fallbackColor = '#000000';\r\n            const _colors = ['000000', 'BLACK', '800000', 'RED', '008000', 'GREEN', '808000', 'ORANGE', '0000EE', 'BLUE', '800080', 'MAGENTA', '008080', 'CYAN', 'BBBBBB', 'WHITE', '808080', 'BOLD BLACK', 'FF0000', 'BOLD RED', '00FF00', 'BOLD GREEN', 'FFFF00', 'YELLOW', '5C5CFF', 'BOLD BLUE', 'FF00FF', 'BOLD MAGENTA', '00FFFF', 'BOLD CYAN', 'FFFFFF', 'BOLD WHITE'];\r\n\r\n            let _lastButton;\r\n\r\n            interface Cell<T> {\r\n                get: () => T;\r\n                set: (value: T) => void;\r\n            }\r\n\r\n            const Cell = <T>(initial: T): Cell<T> => {\r\n                let value = initial;\r\n\r\n                const get = () => {\r\n                    return value;\r\n                };\r\n\r\n                const set = (v: T) => {\r\n                    value = v;\r\n                };\r\n\r\n                return {\r\n                    get,\r\n                    set\r\n                };\r\n            };\r\n\r\n            let _forecolor = Cell(fallbackColor);\r\n            let _backcolor = Cell(fallbackColor);\r\n\r\n            const getCurrentColor = (editor, format: ColorFormat) => {\r\n                let color: string | undefined;\r\n\r\n                editor.dom.getParents(editor.selection.getStart(), (elm) => {\r\n                    let value;\r\n\r\n                    if ((value = elm.style[format === 'forecolor' ? 'color' : 'background-color'])) {\r\n                        color = color ? color : value;\r\n                    }\r\n                });\r\n\r\n                return color;\r\n            };\r\n\r\n            const applyFormat = (editor, format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.apply(format, { value });\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const removeFormat = (editor, format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const registerCommands = (editor) => {\r\n                editor.addCommand('mceApplyPinkfishcolor', (format, value) => {\r\n                    applyFormat(editor, format, value);\r\n                });\r\n\r\n                editor.addCommand('mceRemovePinkfishcolor', (format) => {\r\n                    removeFormat(editor, format);\r\n                });\r\n\r\n                editor.addCommand('mceSetPinkfishcolor', (name, color) => {\r\n                    if (_lastButton) {\r\n                        setIconColor(_lastButton, name === 'forecolor' ? 'pinkfishforecolor' : name, color);\r\n                        (name === 'forecolor' ? _forecolor : _backcolor).set(color);\r\n                    }\r\n                });\r\n            };\r\n\r\n            const getAdditionalColors = (hasCustom: boolean) => {\r\n                const type: 'choiceitem' = 'choiceitem';\r\n                const remove = {\r\n                    type,\r\n                    text: 'Remove color',\r\n                    icon: 'color-swatch-remove-color',\r\n                    value: 'remove'\r\n                };\r\n                const custom = {\r\n                    type,\r\n                    text: 'Custom color',\r\n                    icon: 'color-picker',\r\n                    value: 'custom'\r\n                };\r\n                return hasCustom ? [\r\n                    remove,\r\n                    custom\r\n                ] : [remove];\r\n            };\r\n\r\n            const applyColor = (editor, format, value, onChoice: (v: string) => void) => {\r\n                if (value === 'custom') {\r\n                    _editor.openColorDialog(format, '');\r\n                } else if (value === 'remove') {\r\n                    onChoice('');\r\n                    editor.execCommand('mceRemovePinkfishcolor', format);\r\n                } else {\r\n                    onChoice(value);\r\n                    editor.execCommand('mceApplyPinkfishcolor', format, value);\r\n                }\r\n            };\r\n\r\n            const mapColors = (colorMap: string[]) => {\r\n                const colors = [];\r\n\r\n                for (let i = 0; i < colorMap.length; i += 2) {\r\n                    colors.push({\r\n                        text: colorMap[i + 1],\r\n                        value: '#' + colorMap[i],\r\n                        type: 'choiceitem'\r\n                    });\r\n                }\r\n\r\n                return colors;\r\n            }\r\n\r\n            const getColors = (colors, hasCustom: boolean) => mapColors(_colors).concat(getAdditionalColors(hasCustom));\r\n\r\n            const getFetch = (colors, hasCustom: boolean) => (callback) => {\r\n                callback(getColors(colors, hasCustom));\r\n            };\r\n\r\n            const setIconColor = (splitButtonApi, name: string, newColor: string) => {\r\n                const id = name === 'pinkfishforecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\r\n                splitButtonApi.setIconFill(id, newColor);\r\n            };\r\n\r\n            const registerTextColorButton = (editor, name: string, format: ColorFormat, tooltip: string, lastColor) => {\r\n                editor.ui.registry.addSplitButton(name, {\r\n                    tooltip,\r\n                    presets: 'color',\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    select: (value) => {\r\n                        const optCurrentRgb = new RGBColor(getCurrentColor(editor, format) || '').toHex();\r\n                        return optCurrentRgb.toLowerCase() === value.toLowerCase();\r\n                    },\r\n                    columns: 5,\r\n                    fetch: getFetch(_colors, true),\r\n                    onAction: (_splitButtonApi) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, lastColor.get(), () => { });\r\n                    },\r\n                    onItemAction: (_splitButtonApi, value) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, value, (newColor) => {\r\n                            lastColor.set(newColor);\r\n                            editor.fire('TextColorChange', {\r\n                                name,\r\n                                color: newColor\r\n                            });\r\n                        });\r\n                    },\r\n                    onSetup: (splitButtonApi) => {\r\n                        setIconColor(splitButtonApi, name, lastColor.get());\r\n\r\n                        const handler = (e) => {\r\n                            if (e.name === name) {\r\n                                setIconColor(splitButtonApi, e.name, e.color);\r\n                            }\r\n                        };\r\n\r\n                        editor.on('TextColorChange', handler);\r\n\r\n                        return () => {\r\n                            editor.off('TextColorChange', handler);\r\n                        };\r\n                    }\r\n                });\r\n            };\r\n\r\n            const registerTextColorMenuItem = (editor, name: string, format: ColorFormat, text: string) => {\r\n                editor.ui.registry.addNestedMenuItem(name, {\r\n                    text,\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    getSubmenuItems: () => [\r\n                        {\r\n                            type: 'fancymenuitem',\r\n                            fancytype: 'colorswatch',\r\n                            onAction: (data) => {\r\n                                applyColor(editor, format, data.value, () => { });\r\n                            }\r\n                        }\r\n                    ]\r\n                });\r\n            };\r\n\r\n            registerCommands(editor);\r\n            registerTextColorButton(editor, 'pinkfishforecolor', 'forecolor', 'Text color', _forecolor);\r\n            registerTextColorButton(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color', _backcolor);\r\n\r\n            registerTextColorMenuItem(editor, 'pinkfishforecolor', 'forecolor', 'Text color');\r\n            registerTextColorMenuItem(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color');\r\n        });\r\n        tinymce.PluginManager.add('pinkfish', function (editor) {\r\n\r\n            editor.addCommand('mceApplyFormat', (format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    if (value)\r\n                        editor.formatter.apply(format, { value: value });\r\n                    else\r\n                        editor.formatter.apply(format);\r\n                    _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            editor.addCommand('mceRemoveFormat', (format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            function buttonPostRender(buttonApi, format) {\r\n                editor.on('init', () => {\r\n                    editor.formatter.formatChanged(format, function (state) {\r\n                        buttonApi.setActive(state);\r\n                    });\r\n                });\r\n            }\r\n\r\n            function toggleFormat(format) {\r\n                if (!format || typeof format !== 'string') format = this.settings.format;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).removeClass('animate');\r\n                    this.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.execCommand('mceToggleFormat', false, format);\r\n                    this.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).addClass('animate');\r\n                });\r\n            }\r\n\r\n\r\n            editor.ui.registry.addIcon('overline', '<i class=\"mce-i-overline\"></i>');\r\n            editor.ui.registry.addIcon('dblunderline', '<i class=\"mce-i-dblunderline\"></i>');\r\n            editor.ui.registry.addIcon('flash', '<i class=\"mce-i-flash\"></i>');\r\n            editor.ui.registry.addIcon('reverse', '<i class=\"mce-i-reverse\"></i>');\r\n            editor.ui.registry.addIcon('pasteformatted', '<i class=\"mce-i-pasteformatted\"></i>');\r\n            editor.ui.registry.addIcon('copyformatted', '<i class=\"mce-i-copyformatted\"></i>');\r\n\r\n            editor.ui.registry.addSplitButton('send', {\r\n                icon: 'send',\r\n                tooltip: 'Send to mud',\r\n                onAction: () => {\r\n                    client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                    if (client.getOption('editorClearOnSend'))\r\n                        tinymce.activeEditor.setContent('');\r\n                    if (client.getOption('editorCloseOnSend'))\r\n                        _editor.emit('close');\r\n                },\r\n                onItemAction: (api, value) => {\r\n                    switch (value) {\r\n                        case 'formatted':\r\n                            client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'text':\r\n                            client.sendCommand(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'formattednoecho':\r\n                            client.sendBackground(_editor.getFormattedText().replace(/(?:\\r)/g, ''), true);\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'textnoecho':\r\n                            client.sendBackground(_editor.getText().replace(/(?:\\r)/g, ''), true);\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'formattedverbatim':\r\n                            client.send(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'textverbatim':\r\n                            client.send(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'rawformatted':\r\n                            client.sendRaw(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'rawtext':\r\n                            client.sendRaw(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                    }\r\n                },\r\n                fetch: callback => {\r\n                    callback([\r\n                        {\r\n                            text: 'Formatted as commands',\r\n                            value: 'formatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands',\r\n                            value: 'text',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted as commands (No echo)',\r\n                            value: 'formattednoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands (No echo)',\r\n                            value: 'textnoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted verbatim (No echo)',\r\n                            value: 'formattedverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text verbatim (No echo)',\r\n                            value: 'textverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw formatted (No echo)',\r\n                            value: 'rawformatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw text (No echo)',\r\n                            value: 'rawtext',\r\n                            type: 'choiceitem'\r\n                        }\r\n                    ]);\r\n                }\r\n            });\r\n            editor.ui.registry.addButton('append', {\r\n                icon: 'browse',\r\n                tooltip: 'Append file...',\r\n                onAction: () => _editor.appendFile()\r\n            });\r\n            editor.ui.registry.addButton('clear', {\r\n                icon: 'remove',\r\n                tooltip: 'Clear',\r\n                onAction: () => _editor.clear()\r\n            });\r\n            editor.ui.registry.addButton('pasteformatted', {\r\n                icon: 'pasteformatted',\r\n                tooltip: 'Paste formatted',\r\n                onAction: buttonApi => {\r\n                    pasteText().then(text => {\r\n                        _editor.insertFormatted(text || '');\r\n                    }).catch(err => {\r\n                        if (client.enableDebug)\r\n                            client.debug(err);\r\n                        if (err.message && err.message === 'Permission not granted!')\r\n                            alert('Paste permission not granted.');\r\n                        else\r\n                            alert('Paste not supported.');\r\n                    });\r\n                }\r\n            });\r\n            editor.ui.registry.addButton('pasteastext', {\r\n                icon: 'paste-text',\r\n                tooltip: 'Paste as text',\r\n                onAction: buttonApi => {\r\n                    pasteText().then(text => {\r\n                        tinymce.activeEditor.execCommand('mceInsertContent', false, (text || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                    }).catch(err => {\r\n                        if (client.enableDebug)\r\n                            client.debug(err);\r\n                        if (err.message && err.message === 'Permission not granted!')\r\n                            alert('Paste permission not granted.');\r\n                        else\r\n                            alert('Paste not supported.');\r\n                    });\r\n                }\r\n            });\r\n\r\n            editor.ui.registry.addButton('copyformatted', {\r\n                icon: 'copyformatted',\r\n                tooltip: 'Copy formatted',\r\n                onAction: buttonApi => copyText(_editor.getFormattedSelection().replace(/(?:\\r)/g, ''))\r\n            });\r\n\r\n            editor.ui.registry.addToggleButton('overline', {\r\n                icon: 'overline',\r\n                tooltip: 'Overline',\r\n                format: 'overline',\r\n                onAction: buttonApi => toggleFormat('overline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'overline')\r\n            });\r\n            editor.ui.registry.addToggleButton('dblunderline', {\r\n                icon: 'dblunderline',\r\n                tooltip: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onAction: buttonApi => toggleFormat('dblunderline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'dblunderline')\r\n            });\r\n            editor.ui.registry.addToggleButton('flash', {\r\n                tooltip: 'Flash',\r\n                format: 'flash',\r\n                icon: 'flash',\r\n                onAction: buttonApi => toggleFormat('flash'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'flash')\r\n            });\r\n            editor.ui.registry.addToggleButton('reverse', {\r\n                icon: 'reverse',\r\n                tooltip: 'Reverse',\r\n                format: 'reverse',\r\n                onAction: buttonApi => toggleFormat('reverse'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'reverse')\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('style', {\r\n                text: 'Style',\r\n                menu: [\r\n                    {\r\n                        image: 'overline',\r\n                        text: 'Overline',\r\n                        format: 'overline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }, {\r\n                        image: 'dblunderline',\r\n                        text: 'Double Underline',\r\n                        format: 'dblunderline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        text: 'Flash',\r\n                        format: 'flash',\r\n                        image: 'flash',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        image: 'reverse',\r\n                        text: 'Reverse',\r\n                        format: 'reverse',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }\r\n                ]\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('overline', {\r\n                image: 'overline',\r\n                text: 'Overline',\r\n                format: 'overline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('dblunderline', {\r\n                image: 'dblunderline',\r\n                text: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('flash', {\r\n                text: 'Flash',\r\n                format: 'flash',\r\n                image: 'flash',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n            editor.ui.registry.addMenuItem('reverse', {\r\n                image: 'reverse',\r\n                text: 'Reverse',\r\n                format: 'reverse',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.on('Change', () => {\r\n                _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n            });\r\n            editor.addShortcut('ctrl+s', 'Strikethrough', () => {\r\n                toggleFormat('strikethrough');\r\n            });\r\n            editor.addShortcut('ctrl+o', 'Overline', () => {\r\n                toggleFormat('overline');\r\n            });\r\n            editor.addShortcut('ctrl+d', 'Double Underline', () => {\r\n                toggleFormat('dblunderline');\r\n            });\r\n            editor.addShortcut('ctrl+f', 'Flash', () => {\r\n                toggleFormat('flash');\r\n            });\r\n            editor.addShortcut('ctrl+r', 'Reverse', () => {\r\n                toggleFormat('reverse');\r\n            });\r\n        });\r\n    }\r\n\r\n    private clearReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (!$(this).data('reverse'))\r\n                    return;\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                var back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    fore = $(this).parent().css('color');\r\n                    back = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'black')\r\n                    back = '';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                if ($(this).children().length)\r\n                    this.clearReverse($(this).children(), true);\r\n            }\r\n        );\r\n    }\r\n\r\n    private addReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                var back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    back = $(this).parent().css('color');\r\n                    fore = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'rgba(0, 0, 0, 0)')\r\n                    back = 'black';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                if ($(this).children().length) {\r\n                    this.clearReverse($(this).children(), true);\r\n                    this.addReverse($(this).children(), true);\r\n                }\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                $(this).data('reverse', true);\r\n\r\n            }\r\n        );\r\n    }\r\n\r\n    private colorCell(color, idx) {\r\n        var cell = '<td class=\"mce-grid-cell' + (color === 'transparent' ? ' mce-colorbtn-trans' : '') + '\">';\r\n        cell += '<div id=\"' + idx + '\"';\r\n        cell += ' data-mce-color=\"' + color + '\"';\r\n        cell += ' role=\"option\"';\r\n        cell += ' tabIndex=\"-1\"';\r\n        cell += ' style=\"background-color: ' + (color === 'transparent' ? color : '#' + color) + '\"';\r\n        if (this.colorNames[idx])\r\n            cell += ' title=\"' + idx + ', ' + this.colorNames[idx] + '\">';\r\n        else\r\n            cell += ' title=\"' + idx + '\">';\r\n        if (color === 'transparent') cell += '&#215;';\r\n        cell += '</div>';\r\n        cell += '</td>';\r\n        return cell;\r\n    }\r\n\r\n    private openColorDialog(type, color) {\r\n        if (!this._colorDialog) {\r\n            this._colorDialog = new Dialog({ noFooter: true, title: '<i class=\"fas fa-palette\"></i> Pick color', center: true, resizable: false, moveable: false, maximizable: false, width: 380, height: 340 });\r\n            this._colorDialog.body.style.alignItems = 'center';\r\n            this._colorDialog.body.style.display = 'flex';\r\n            let c;\r\n            let cl;\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let idx;\r\n            var html = '<table style=\"margin : auto !important;\" class=\"mce-grid mce-grid-border mce-colorbutton-grid\" role=\"list\" cellspacing=\"0\"><tbody><tr>';\r\n            for (c = 0, cl = this._ColorTable.length; c < cl; c += 2) {\r\n                html += this.colorCell(this._ColorTable[c], this._ColorTable[c + 1]);\r\n                if (c / 2 % 6 === 5)\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n            }\r\n            html += '<td class=\"mce-grid-cell\"></td>';\r\n            html += this.colorCell('transparent', 'No color');\r\n            html += '</tr><tr><td></td></tr>';\r\n            var html2 = '';\r\n            for (r = 0; r < 6; r++) {\r\n                if (g < 3)\r\n                    html += '<tr>';\r\n                else\r\n                    html2 += '<tr>';\r\n                for (g = 0; g < 6; g++) {\r\n                    for (b = 0; b < 6; b++) {\r\n                        idx = `RGB${r}${g}${b}`;\r\n                        color = '';\r\n                        c = 0;\r\n                        c = r * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = g * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = b * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        color = color.toUpperCase();\r\n                        if (g < 3)\r\n                            html += this.colorCell(color, idx);\r\n                        else\r\n                            html2 += this.colorCell(color, idx);\r\n                    }\r\n                    if (g === 2)\r\n                        html += '</tr>';\r\n                    else if (g < 3)\r\n                        html += '<td class=\"mce-grid-cell\"></td>';\r\n                    else if (g < 5)\r\n                        html2 += '<td class=\"mce-grid-cell\"></td>';\r\n                }\r\n                if (g < 3)\r\n                    html += '</tr>';\r\n                else\r\n                    html2 += '</tr>';\r\n            }\r\n            html += html2;\r\n            html += '<tr><td></td></tr><tr>';\r\n            for (r = 232; r <= 255; r++) {\r\n                g = (r - 232) * 10 + 8;\r\n                if (g < 16)\r\n                    g = '0' + g.toString(16).toUpperCase();\r\n                else\r\n                    g = g.toString(16).toUpperCase();\r\n                g = g + g + g;\r\n                html += this.colorCell(g, color);\r\n                if (r === 237 || r === 249)\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n                if (r === 243)\r\n                    html += '</tr><tr>';\r\n            }\r\n            html += '</tr></tbody></table>';\r\n            html += `<style>\r\n.mce-colorbtn-trans div {line-height: 14px;overflow: hidden;}\r\n.mce-grid td.mce-grid-cell div{border:1px solid #c5c5c5;width:15px;height:15px;margin:0;cursor:pointer}.mce-grid td.mce-grid-cell div:focus{border-color:#91bbe9}.mce-grid td.mce-grid-cell div[disabled]{cursor:not-allowed}            \r\n.mce-grid{border-spacing:2px;border-collapse:separate}.mce-grid a{display:block;border:1px solid transparent}.mce-grid a:hover,.mce-grid a:focus{border-color:#91bbe9}.mce-grid-border{margin:0 4px 0 4px}.mce-grid-border a{border-color:#c5c5c5;width:13px;height:13px}.mce-grid-border a:hover,.mce-grid-border a.mce-active{border-color:#91bbe9;background:#bdd6f2}            \r\n            </style>`;\r\n            this._colorDialog.body.innerHTML = html;\r\n            let cells = this._colorDialog.body.querySelectorAll('div');\r\n            for (c = 0, cl = cells.length; c < cl; c++)\r\n                cells[c].addEventListener('click', e => {\r\n                    color = (e.currentTarget as HTMLElement).dataset.mceColor;\r\n                    if (color === 'transparent')\r\n                        tinymce.activeEditor.execCommand('mceRemoveFormat', this._colorDialog.dialog.dataset.type);\r\n                    else\r\n                        tinymce.activeEditor.execCommand('mceApplyFormat', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    tinymce.activeEditor.execCommand('mceSetTextcolor', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    this._colorDialog.close();\r\n                });\r\n        }\r\n        this._colorDialog.dialog.dataset.type = type;\r\n        this._colorDialog.showModal();\r\n    }\r\n\r\n    private appendFile() {\r\n        openFileDialog('Append file(s)', true).then(files => {\r\n            for (var f = 0, fl = files.length; f < fl; f++)\r\n                readFile(files[f]).then((contents: any) => {\r\n                    this.insert(contents);\r\n                }).catch(client.error);\r\n        }).catch(() => { });\r\n    }\r\n\r\n    private insertFormatted(text) {\r\n        if (this.isSimple)\r\n            insertValue(this._element, text);\r\n        else\r\n            tinymce.activeEditor.execCommand('insertHTML', false, pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'));\r\n    }\r\n\r\n    public setFormatted(text) {\r\n        if (this.isSimple)\r\n            this._element.value = text;\r\n        else {\r\n            tinymce.activeEditor.getBody().innerHTML = pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>');\r\n            //tinymce.activeEditor.setContent(pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'), { format: 'html' });\r\n        }\r\n    }\r\n\r\n    private buildHTMLStack(els) {\r\n        var tag, $el, t, tl;\r\n        var stack = [];\r\n        var tags;\r\n        for (var e = 0, el = els.length; e < el; e++) {\r\n            $el = $(els[e]);\r\n            tag = $el.prop('tagName');\r\n            if (tag === 'EM' || tag === 'I')\r\n                tag = 'ITALIC';\r\n            else if (tag === 'STRONG' || tag === 'B')\r\n                tag = 'BOLD';\r\n            if (!tag)\r\n                stack.push('\"' + $el.text() + '\"');\r\n            else if (tag === 'SPAN') {\r\n                tags = [];\r\n                if (els[e].className != '') {\r\n                    tag = els[e].className.toUpperCase().split(/\\s+/g);\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t] === 'NOFLASH')\r\n                            tags.push('FLASH');\r\n                        else if (tag[t].length > 0)\r\n                            tags.push(tag[t]);\r\n                    }\r\n                }\r\n                if ($el.css('text-decoration') === 'line-through')\r\n                    tags.push('STRIKEOUT');\r\n                if ($el.css('text-decoration') === 'underline')\r\n                    tags.push('UNDERLINE');\r\n                if ($el.data('mce-style')) {\r\n                    tag = $el.data('mce-style').toUpperCase().split(';');\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].endsWith('INHERIT') || tag[t].endsWith('BLACK'))\r\n                            continue;\r\n                        tag[t] = tag[t].trim();\r\n                        tag[t] = tag[t].replace('BACKGROUND:', 'BACKGROUND-COLOR:');\r\n                        if (tag[t].length > 0)\r\n                            tags.push(tag[t]);\r\n                    }\r\n                }\r\n                else if ($el.css('color') || $el.css('background-color') || $el.css('background')) {\r\n                    tag = [];\r\n                    if ($el.css('color'))\r\n                        tag.push('COLOR: ' + new RGBColor($el.css('color')).toHex().toUpperCase());\r\n                    if ($el.css('background-color'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background-color')).toHex().toUpperCase());\r\n                    if ($el.css('background'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background')).toHex().toUpperCase());\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].length > 0)\r\n                            tags.push(tag[t].trim());\r\n                    }\r\n                }\r\n                tl = tags.length;\r\n                for (t = 0; t < tl; t++) {\r\n                    if (!tags[t].length) continue;\r\n                    stack.push(tags[t].trim());\r\n                }\r\n                stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                for (t = tl - 1; t >= 0; t--) {\r\n                    if (!tags[t].length) continue;\r\n                    stack.push('/' + tags[t].trim());\r\n                }\r\n            }\r\n            else if (tag == 'BR' && $el.data('mce-bogus'))\r\n                stack.push('RESET');\r\n            else {\r\n                stack.push(tag);\r\n                stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                stack.push('/' + tag);\r\n            }\r\n        }\r\n        return stack;\r\n    }\r\n\r\n    public getFormattedSelection() {\r\n        //build all previous nodes to ensure all formatting is captures\r\n        var nodes = tinymce.activeEditor.dom.getParents(tinymce.activeEditor.selection.getNode());\r\n        var n = 0, nl = nodes.length;\r\n        var start = '<html>';\r\n        var end = '</html>';\r\n        for (; n < nl; n++) {\r\n            var tag = nodes[n].tagName;\r\n            if (tag === 'EM' || tag === 'I' || tag === 'STRONG' || tag === 'B') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'SPAN') {\r\n                start += '<' + tag;\r\n                if (nodes[n].className != '')\r\n                    start += ' class=\"' + nodes[n].className + '\"';\r\n                var style = '';\r\n                if (nodes[n].style.textDecoration != '')\r\n                    style += 'text-decoration:' + nodes[n].style.textDecoration + ';';\r\n                if (nodes[n].style.color != '')\r\n                    style += 'color:' + nodes[n].style.color + ';';\r\n                if (nodes[n].style.background != '')\r\n                    style += 'background:' + nodes[n].style.background + ';';\r\n                if (nodes[n].style.backgroundColor != '')\r\n                    style += 'background-color:' + nodes[n].style.backgroundColor + ';';\r\n                if (style.length > 0)\r\n                    start += ' style=\"' + style + '\"';\r\n                if (nodes[n].dataset && nodes[n].dataset.mceStyle)\r\n                    start += ' data-mce-style=\"' + nodes[n].dataset.mceStyle + '\"';\r\n                start += ' >';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'BODY') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n                break;\r\n            }\r\n        }\r\n        return this.formatHtml($(start + tinymce.activeEditor.selection.getContent({ format: 'raw' }).replace(/<\\/div><div>/g, '<br>') + end));\r\n    }\r\n\r\n    public getFormattedText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return this.formatHtml($('<html>' + this.getRaw() + '</html>'));\r\n        //return this.formatHtml($('<html>' + this.getRaw().replace(/<\\/div><div>/g, '<br>') + '</html>'));\r\n    }\r\n\r\n    public getText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'text' });\r\n    }\r\n\r\n    // eslint-disable-next-line no-unused-vars\r\n    public getHTML() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'html' });\r\n    }\r\n\r\n    public getRaw() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'raw' });\r\n    }\r\n\r\n    private formatHtml(text) {\r\n        var data = this.buildHTMLStack(text);\r\n        var buffer = [];\r\n        var codes = [];\r\n        var color, d, dl, rgb;\r\n        if (DEBUG && client.getOption('enableDebug'))\r\n            client.debug('Advanced Editor Get Raw HTML: ' + this.getRaw());\r\n        for (d = data.length - 1; d >= 0; d--) {\r\n            if (!data[d].startsWith('\"') && data[d] != 'BR' && data[d] != 'RESET')\r\n                data.pop();\r\n            else\r\n                break;\r\n        }\r\n        if (data[0] === 'DIV')\r\n            data.shift();\r\n\r\n        for (d = 0, dl = data.length; d < dl; d++) {\r\n            switch (data[d]) {\r\n                case 'BOLD':\r\n                case 'ITALIC':\r\n                case 'UNDERLINE':\r\n                case 'STRIKEOUT':\r\n                case 'DBLUNDERLINE':\r\n                case 'OVERLINE':\r\n                case 'FLASH':\r\n                case 'REVERSE':\r\n                    codes.push('%^' + data[d] + '%^');\r\n                    buffer.push('%^' + data[d] + '%^');\r\n                    break;\r\n                case '/DBLUNDERLINE':\r\n                case '/OVERLINE':\r\n                case '/FLASH':\r\n                case '/REVERSE':\r\n                case '/UNDERLINE':\r\n                case '/BOLD':\r\n                case '/ITALIC':\r\n                case '/STRIKEOUT':\r\n                    codes.pop();\r\n                    this.cleanReset(buffer);\r\n                    buffer.push('%^RESET%^');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'SPAN':\r\n                case '/SPAN':\r\n                case '/BR':\r\n                case '/DIV':\r\n                    break;\r\n                case 'DIV':\r\n                case 'BR':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    buffer.push('\\n');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'RESET':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                default:\r\n                    if (data[d].startsWith('COLOR: #')) {\r\n                        color = data[d].substr(8);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this.nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n                    }\r\n                    else if (data[d].startsWith('COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(7)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this.nearestHex('#' + color).substr(1);\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n\r\n                    }\r\n                    else if (data[d].startsWith('/COLOR: ')) {\r\n                        codes.pop();\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: #')) {\r\n                        color = data[d].substr(19);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this.nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(18)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this.nearestHex('#' + color).substr(1);\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('/BACKGROUND-COLOR: ')) {\r\n                        codes.pop();\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('\"'))\r\n                        buffer.push(data[d].substring(1, data[d].length - 1));\r\n                    break;\r\n            }\r\n        }\r\n        return buffer.join('');\r\n    }\r\n\r\n    private cleanReset(buffer) {\r\n        let b = buffer.length - 1;\r\n        for (; b >= 0; b--) {\r\n            if (buffer[b].startsWith('%^'))\r\n                buffer.pop();\r\n            else\r\n                return buffer;\r\n        }\r\n        return buffer;\r\n    }\r\n\r\n    //{ color: 'red', hex: '#EA4235', rgb: { r: 234, g: 66, b: 53 } },\r\n    private colorList = [];\r\n\r\n    private nearestHex(hex) {\r\n        var _editor = this;\r\n        //https://codereview.stackexchange.com/questions/132225/given-hexadecimal-rgb-color-find-the-closest-predefined-color\r\n        var hexToRgb = function (hex) {\r\n            var shortRegEx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n            //hex = hex.replace(shortRegEx, \"$1$1$2$2$3$3\");\r\n            hex = hex.replace(shortRegEx, function (full, r, g, b) {\r\n                return [r, r, g, g, b, b].join();\r\n            });\r\n            var longRegEx = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})?/i;\r\n            var rgbArray = longRegEx.exec(hex);\r\n            var rgbObj = rgbArray ? {\r\n                r: parseInt(rgbArray[1], 16),\r\n                g: parseInt(rgbArray[2], 16),\r\n                b: parseInt(rgbArray[3], 16)\r\n            } : null;\r\n            return rgbObj;\r\n        };\r\n\r\n        var closestHexFromRgb = function (rgbObj) {\r\n            if (!rgbObj) {\r\n                throw new Error('The hex you provided is not formatted correctly. Please try in a format such as \\'#FFF\\' or \\'#DDFFDD\\'.');\r\n            }\r\n\r\n            var minDistance = Number.MAX_SAFE_INTEGER;\r\n            var nearestHex = null;\r\n\r\n            for (var i = 0; i < _editor.colorList.length; i++) {\r\n                var currentColor = _editor.colorList[i];\r\n                var distance = Math.sqrt(\r\n                    Math.pow((rgbObj.r - currentColor.rgb.r), 2) +\r\n                    Math.pow((rgbObj.g - currentColor.rgb.g), 2) +\r\n                    Math.pow((rgbObj.b - currentColor.rgb.b), 2)\r\n                );\r\n                if (distance < minDistance) {\r\n                    minDistance = distance;\r\n                    nearestHex = currentColor.hex;\r\n                }\r\n            }\r\n            return nearestHex;\r\n        };\r\n\r\n        return closestHexFromRgb(hexToRgb(hex));\r\n\r\n    }\r\n\r\n    public remove() {\r\n        tinymce.remove(`#${this._element.id}`);\r\n    }\r\n\r\n    public initialize() {\r\n        if (this.isSimple) return;\r\n        this.initPlugins();\r\n        tinymce.init({\r\n            license_key: 'gpl',\r\n            custom_colors: false,\r\n            selector: `textarea#${this._element.id}`,\r\n            height: 500,\r\n            menubar: false,\r\n            browser_spellcheck: true,\r\n            //contextmenu: false,\r\n            resize: true,\r\n            statusbar: false,\r\n            nowrap: true,\r\n            force_br_newlines: true,\r\n            forced_root_block: 'div',\r\n            plugins: 'pinkfish insertdatetime pinkfishtextcolor nonbreaking',\r\n            color_picker_callback: (editor, color, format) => { this.openColorDialog(format, color || ''); },\r\n            color_picker_caption: 'More&hellip;',\r\n            textcolor_rows: '3',\r\n            textcolor_cols: '8',\r\n            toolbar: 'send | append | undo redo | pinkfishforecolor pinkfishbackcolor | italic underline strikethrough overline dblunderline flash reverse | clear | copy copyformatted | insertdatetime',\r\n            toolbar_mode: 'sliding',\r\n            content_css: 'css/tinymce.content.min.css',\r\n            formats: {\r\n                bold: { inline: 'strong', exact: true, links: true, remove_similar: true },\r\n                italic: { inline: 'em', exact: true, links: true, remove_similar: true },\r\n                overline: { inline: 'span', 'classes': 'overline', links: true, remove_similar: true },\r\n                dblunderline: { inline: 'span', 'classes': 'dblunderline', links: true, remove_similar: true },\r\n                flash: { inline: 'span', 'classes': 'flash', links: true, remove_similar: true },\r\n                reverse: { inline: 'span', 'classes': 'reverse', links: true, remove_similar: true },\r\n                underline: { inline: 'span', 'classes': 'underline', links: true, remove_similar: true },\r\n                strikethrough: { inline: 'span', 'classes': 'strikeout', links: true, remove_similar: true },\r\n                //forecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                //hilitecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n                //forecolor: { block: 'span', attributes: { 'data-color': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                //hilitecolor: { block: 'span', attributes: { 'data-backcolor': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n            },\r\n            init_instance_callback: (editor) => {\r\n                editor.shortcuts.add('ctrl+shift+c', 'Copy formatted', () => copyText(this.getFormattedSelection().replace(/(?:\\r)/g, '')));\r\n                /*\r\n                editor.shortcuts.add('ctrl+shift+p', 'Paste formatted', () => {\r\n                    //insertFormatted(clipboard.readText('selection') || '');\r\n                });\r\n                editor.shortcuts.add('ctrl+alt+p', 'Paste as text', () => {\r\n                    //tinymce.activeEditor.execCommand('mceInsertContent', false, (clipboard.readText('selection') || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                });\r\n                */\r\n                editor.on('PastePreProcess', e => {\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced Before Editor PastePreProcess: ' + e.content);\r\n                    this.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    e.content = e.content.replace(/<\\/p>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/h[1-6]>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/li>/g, '<br>');\r\n                    e.content = e.content.replace(/ background: #000000;/g, '');\r\n                    e.content = e.content.replace(/background: #000000;/g, '');\r\n                    e.content = e.content.replace(/ background-color: #000000;/g, '');\r\n                    e.content = e.content.replace(/background-color: #000000;/g, '');\r\n                    e.content = e.content.replace(/ color: #BBBBBB;/g, '');\r\n                    e.content = e.content.replace(/color: #BBBBBB;/g, '');\r\n                    var regex = /<pre(.*?)>((.|\\s)*)<\\/pre>/mgi;\r\n                    var m;\r\n                    while ((m = regex.exec(e.content)) !== null) {\r\n                        if (m.index === regex.lastIndex) {\r\n                            regex.lastIndex++;\r\n                        }\r\n                        e.content = e.content.substring(0, m.index) + e.content.substring(m.index, regex.lastIndex).replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;') + e.content.substring(regex.lastIndex);\r\n                    }\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced After Editor PastePreProcess: ' + e.content);\r\n                });\r\n                editor.on('PastePreProcess', () => {\r\n                    this.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                });\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-size', client.getOption('cmdfontSize'));\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-family', client.getOption('cmdfont') + ', monospace');\r\n                if (tinymce.activeEditor.formatter)\r\n                    tinymce.activeEditor.formatter.register('flash', { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true });\r\n                else\r\n                    tinymce.activeEditor.settings.formats['flash'] = { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true };\r\n                this.loadColors();\r\n                this.setFormatted(this._element.value);\r\n                editor.on('click', e => {\r\n                    this.emit('click', e);\r\n                })\r\n                this.emit('editor-init');\r\n                this._init = true;\r\n            },\r\n            paste_data_images: false,\r\n            paste_webkit_styles: 'color background background-color text-decoration',\r\n            valid_elements: 'strong/b,em/i,u,span[style|class],strike/s,br',\r\n            valid_styles: {\r\n                '*': 'color,background,background-color,text-decoration,font-weight'\r\n            },\r\n            color_map: this._ColorTable,\r\n        });\r\n    }\r\n\r\n    public focus() {\r\n        if (this.isSimple)\r\n            this._element.focus();\r\n        else if (this._init && TINYMCE && tinymce.activeEditor && tinymce.activeEditor.initialized)\r\n            tinymce.activeEditor.focus();\r\n    }\r\n}", "import { Dialog, DialogButtons, AlertDialog, ConfirmDialog, DialogIcon } from \"./dialog\";\r\nimport { capitalize, clone, openFileDialog, readFile } from '../library';\r\nimport { Settings, SettingList } from \"../settings\";\r\nimport { RGBColor } from '../lib/rgbcolor';\r\nimport { removeHash } from \"./interface\";\r\n\r\ndeclare let fileSaveAs;\r\n\r\nexport class SettingsDialog extends Dialog {\r\n    private _menu;\r\n    private _page;\r\n    public settings: Settings;\r\n    constructor() {\r\n        super(({ title: '<i class=\"fas fa-cogs\"></i> Settings', keepCentered: true, resizable: false, moveable: false, center: true, maximizable: false }));\r\n        this.body.style.padding = '10px';\r\n        this.buildMenu();\r\n        let footer = '';\r\n        footer += `<button id=\"${this.id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Cancel dialog\"><i class=\"bi bi-x-lg\"></i><span class=\"icon-only\"> Cancel</span></button>`;\r\n        footer += `<button id=\"${this.id}-save\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Confirm dialog\"><i class=\"bi bi-save\"></i><span class=\"icon-only\"> Save</span></button>`;\r\n        footer += `<button id=\"${this.id}-reset\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Reset settings\"><i class=\"bi bi-arrow-clockwise\"></i><span class=\"icon-only\"> Reset</span></button>`\r\n        footer += `<button id=\"${this.id}-reset-all\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Reset All settings\"><i class=\"bi bi-arrow-repeat\"></i><span class=\"icon-only\"> Reset All</span></button>`\r\n        footer += '<div class=\"vr float-start\" style=\"margin-right: 4px;height: 29px;\"></div>';\r\n        footer += `<button id=\"${this.id}-export\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Export settings\"><i class=\"bi bi-box-arrow-up\"></i><span class=\"icon-only\"> Export</span></button>`;\r\n        footer += `<button id=\"${this.id}-import\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Import settings\"><i class=\"bi bi-box-arrow-in-down\"></i><span class=\"icon-only\"> Import</span></button>`;\r\n        this.footer.innerHTML = footer;\r\n        this.footer.querySelector(`#${this.id}-cancel`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            this.close();\r\n        });\r\n        this.footer.querySelector(`#${this.id}-export`).addEventListener('click', () => {\r\n            var data = clone(this.settings);\r\n            data.version = 2;\r\n            fileSaveAs.show(JSON.stringify(data), 'oiMUD.settings.txt', 'text/plain');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-import`).addEventListener('click', () => {\r\n            openFileDialog('Import settings').then(files => {\r\n                readFile(files[0]).then((contents: any) => {\r\n                    try {\r\n                        var data = JSON.parse(contents);\r\n                        var s, sl;\r\n                        if (data.version === 1) {\r\n                            for (s = 0, sl = SettingList.length; s < sl; s++) {\r\n                                this.settings[SettingList[s][0]] = data[SettingList[s][0]];\r\n                            }\r\n                            //TODO not supported, should be sent to mapper to import\r\n                            this.emit('import-rooms', data.rooms);\r\n                        }\r\n                        else if (data.version === 2 && !data.profiles) {\r\n                            for (s = 0, sl = SettingList.length; s < sl; s++) {\r\n                                this.settings[SettingList[s][0]] = data[SettingList[s][0]];\r\n                            }\r\n                        }\r\n                        else\r\n                            setTimeout(function () {\r\n                                new AlertDialog('Invalid file', 'Unable to import file, not a valid settings file', DialogIcon.exclamation).showModal();\r\n                            }, 50);\r\n                        this.loadPageSettings();\r\n                    }\r\n                    catch (err) {\r\n                        setTimeout(function () {\r\n                            new AlertDialog('Error importing', 'Error importing file.', DialogIcon.error).showModal();\r\n                        }, 50);\r\n                        client.error(err);\r\n                    }\r\n                }).catch(client.error);\r\n            }).catch(() => { });\r\n        });\r\n\r\n        this.footer.querySelector(`#${this.id}-reset`).addEventListener('click', () => {\r\n            if (this._page === 'settings-colors') {\r\n                const confirm = new ConfirmDialog('Reset colors', 'Reset colors?');\r\n                confirm.on('button-click', e => {\r\n                    if (e.button === DialogButtons.Yes) {\r\n                        var c;\r\n                        var colors = this.settings.colors = [];\r\n                        for (c = 0; c < 16; c++)\r\n                            this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n                        for (c = 256; c < 280; c++)\r\n                            this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n                        this.body.querySelector(`#colorScheme`).value = 0;\r\n                    }\r\n                })\r\n                confirm.showModal();\r\n            }\r\n            else if (this._page && this._page !== 'settings' && this._page.length) {\r\n                const pages = this._page.split('-');\r\n                let title = capitalize(pages[pages.length - 1].match(/([A-Z]|^[a-z])[a-z]+/g).join(' '));\r\n                const confirm = new ConfirmDialog(`Reset ${title} settings`, `Reset ${title} settings?`);\r\n                confirm.on('button-click', e => {\r\n                    if (e.button === DialogButtons.Yes) {\r\n                        const forms: HTMLInputElement[] = this.body.querySelectorAll('input,select,textarea');\r\n                        for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                            this.settings[forms[f].id] = Settings.defaultValue(forms[f].id);\r\n                            if (forms[f].type === 'checkbox')\r\n                                forms[f].checked = this.settings[forms[f].id];\r\n                            else\r\n                                forms[f].value = this.settings[forms[f].id];\r\n                        }\r\n                    }\r\n                })\r\n                confirm.showModal();\r\n            }\r\n            else {\r\n                const confirm = new ConfirmDialog('Reset all settings', 'Reset all settings?');\r\n                confirm.on('button-click', e => {\r\n                    if (e.button === DialogButtons.Yes)\r\n                        this.settings.reset();\r\n                })\r\n                confirm.showModal();\r\n            }\r\n        })\r\n\r\n        this.footer.querySelector(`#${this.id}-reset-all`).addEventListener('click', () => {\r\n            const confirm = new ConfirmDialog('Reset all settings', 'Reset all settings?');\r\n            confirm.on('button-click', e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this.settings.reset();\r\n            })\r\n            confirm.showModal();\r\n        })\r\n        this.footer.querySelector(`#${this.id}-save`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            for (var s in this.settings) {\r\n                if (!this.settings.hasOwnProperty(s)) continue\r\n                Settings.setValue(s, this.settings[s]);\r\n            }\r\n            client.clearCache();\r\n            client.loadOptions();\r\n            this.close();\r\n        })\r\n        this.settings = new Settings();\r\n        this.on('closed', () => {\r\n            removeHash(this._page);\r\n        });\r\n        this.on('canceled', () => {\r\n            removeHash(this._page);\r\n        });\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        super.setBody(this.dialog.dataset.path === 'settings' ? SettingsDialog.menuTemplate : contents, args);\r\n        this._page = this.dialog.dataset.path;\r\n        const pages = this._page.split('-');\r\n        let breadcrumb = '';\r\n        let last = pages.length - 1;\r\n        if (pages.length === 1)\r\n            breadcrumb += '<li><i class=\"float-start fas fa-cogs\" style=\"padding: 2px;margin-right: 2px;\"></i></li>';\r\n        else\r\n            breadcrumb += '<li><a href=\"#' + pages.slice(0, 1).join('-') + '\"><i class=\"float-start fas fa-cogs\" style=\"padding: 2px;margin-right: 2px;\"></i></a></li>';\r\n        for (let p = 0, pl = pages.length; p < pl; p++) {\r\n            let title = capitalize(pages[p].match(/([A-Z]|^[a-z])[a-z]+/g).join(' '));\r\n            if (p === last)\r\n                breadcrumb += '<li class=\"breadcrumb-item active\">' + title + '</li>';\r\n            else\r\n                breadcrumb += '<li class=\"breadcrumb-item\" aria-current=\"page\"><a href=\"#' + pages.slice(0, p + 1).join('-') + '\">' + title + '</a></li>';\r\n        }\r\n        this.title = '<ol class=\"float-start breadcrumb\">' + breadcrumb + '</ol>';\r\n        if (this._page === 'settings') {\r\n            if (this._menu)\r\n                this._menu.style.display = 'none';\r\n            this.body.style.left = '';\r\n            if (this.footer.querySelector(`#${this.id}-reset`))\r\n                this.footer.querySelector(`#${this.id}-reset`).style.display = 'none';\r\n            SettingsDialog.addPlugins(this.body.querySelector('div.contents'));\r\n        }\r\n        else {\r\n            if (this._menu)\r\n                this._menu.style.display = '';\r\n            if (this.footer.querySelector(`#${this.id}-reset`))\r\n                this.footer.querySelector(`#${this.id}-reset`).style.display = '';\r\n            this.body.style.left = '200px';\r\n        }\r\n        this.body.scrollTop = 0;\r\n        this.loadPageSettings();\r\n    }\r\n\r\n    private buildMenu() {\r\n        this.dialog.insertAdjacentHTML(\"beforeend\", SettingsDialog.menuTemplate.replace(' style=\"top:0;position: absolute;left:0;bottom:49px;right:0;\"', ''));\r\n        this._menu = this.dialog.querySelector('.contents');\r\n        this._menu.classList.add('settings-menu');\r\n        SettingsDialog.addPlugins(this._menu);\r\n        if (this._page === 'settings')\r\n            this._menu.style.display = 'none';\r\n        this.body.style.left = '200px';\r\n    }\r\n\r\n    private loadPageSettings() {\r\n        const forms: HTMLInputElement[] = this.body.querySelectorAll('input,select,textarea');\r\n        if (this._page === 'settings-colors') {\r\n            var c;\r\n            var colors = this.settings.colors || [];\r\n            for (c = 0; c < 16; c++)\r\n                this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n            for (c = 256; c < 280; c++)\r\n                this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n            for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                forms[f].addEventListener('change', e => {\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    let value = target.value;\r\n                    let id = parseInt(target.id.substring(5), 10);\r\n                    var colors = this.settings.colors || [];\r\n                    if (!colors[id] || colors[id].length === 0) {\r\n                        if (this.getDefaultColor(id) !== value)\r\n                            colors[id] = value;\r\n                    }\r\n                    else if (this.getDefaultColor(id) !== value)\r\n                        delete colors[id];\r\n                    else\r\n                        colors[id] = value;\r\n                    this.settings.colors = colors;\r\n                });\r\n                forms[f].addEventListener('input', e => {\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    let value = target.value;\r\n                    let id = parseInt(target.id.substring(5), 10);\r\n                    if (!this.settings.colors[id] || this.settings.colors[id].length === 0) {\r\n                        if (this.getDefaultColor(id) !== value)\r\n                            this.settings.colors[id] = value;\r\n                    }\r\n                    else if (this.getDefaultColor(id) !== value)\r\n                        delete this.settings.colors[id];\r\n                    else\r\n                        this.settings.colors[id] = value;\r\n\r\n                })\r\n            }\r\n        }\r\n        else {\r\n            for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                if (forms[f].type === 'radio') {\r\n                    forms[f].checked = '' + this.settings[forms[f].name] === forms[f].value;\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.checked)\r\n                            this.settings[target.name] = this.convertType(target.value, typeof this.settings[target.name]);\r\n                    });\r\n                }\r\n                else if (forms[f].type === 'checkbox') {\r\n                    if (forms[f].dataset.enum === 'true') {\r\n                        const name = forms[f].name || forms[f].id.substring(0, forms[f].id.lastIndexOf('-'));\r\n                        const value = +forms[f].id.substring(forms[f].id.lastIndexOf('-') + 1);\r\n                        forms[f].checked = (this.settings[name] & value) === value;\r\n                    }\r\n                    else\r\n                        forms[f].checked = this.settings[forms[f].id];\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.dataset.enum === 'true') {\r\n                            const name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\r\n                            const enums = this.body.querySelectorAll(`[name=${name}]`);\r\n                            let value = 0;\r\n                            for (let e = 0, el = enums.length; e < el; e++) {\r\n                                if (enums[e].checked)\r\n                                    value |= +enums[e].value;\r\n                            }\r\n                            this.settings[name] = value;\r\n                        }\r\n                        else\r\n                            this.settings[target.id] = target.checked || false;\r\n                    });\r\n                }\r\n                else {\r\n                    forms[f].value = this.settings[forms[f].id];\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this.setValue(target.id, target.value);\r\n                    });\r\n                    forms[f].addEventListener('input', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this.setValue(target.id, target.value);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public setColor(id, color?) {\r\n        if (!color || typeof color === 'undefined' || color.length === 0)\r\n            this.body.querySelector('#' + id).value = '';\r\n        else\r\n            this.body.querySelector('#' + id).value = this.colorHex(color);\r\n    }\r\n\r\n    public colorHex(color) {\r\n        if (!color) return false;\r\n        color = new RGBColor(color);\r\n        if (!color.ok)\r\n            return '';\r\n        return color.toHex();\r\n    };\r\n\r\n    public getDefaultColor(code) {\r\n        if (code === 0) return 'rgb(0,0,0)'; //black fore\r\n        if (code === 1) return 'rgb(128, 0, 0)';//red fore\r\n        if (code === 2) return 'rgb(0, 128, 0)';//green fore\r\n        if (code === 3) return 'rgb(128, 128, 0)';//yellow fore\r\n        if (code === 4) return 'rgb(0, 0, 128)';//blue fore\r\n        if (code === 5) return 'rgb(128, 0, 128)';//magenta fore\r\n        if (code === 6) return 'rgb(0, 128, 128)';//cyan fore\r\n        if (code === 7) return 'rgb(192, 192, 192)';//white fore\r\n        if (code === 8) return 'rgb(128, 128, 128)';//black  bold\r\n        if (code === 9) return 'rgb(255, 0, 0)'; //Red bold\r\n        if (code === 10) return 'rgb(0, 255, 0)'; //green bold\r\n        if (code === 11) return 'rgb(255, 255, 0)';//yellow bold\r\n        if (code === 12) return 'rgb(0, 0, 255)';//blue bold\r\n        if (code === 13) return 'rgb(255, 0, 255)';//magenta bold\r\n        if (code === 14) return 'rgb(0, 255, 255)';//cyan bold\r\n        if (code === 15) return 'rgb(255, 255, 255)';//white bold\r\n        if (code === 256) return 'rgb(0, 0, 0)';//black faint\r\n        if (code === 257) return 'rgb(118, 0, 0)';//red  faint\r\n        if (code === 258) return 'rgb(0, 108, 0)';//green faint\r\n        if (code === 259) return 'rgb(145, 136, 0)';//\"rgb(108, 108, 0)\";//yellow faint\r\n        if (code === 260) return 'rgb(0, 0, 108)';//blue faint\r\n        if (code === 261) return 'rgb(108, 0, 108)';//magenta faint\r\n        if (code === 262) return 'rgb(0, 108, 108)';//cyan faint\r\n        if (code === 263) return 'rgb(160, 160, 160)';//white faint\r\n        if (code === 264) return 'rgb(0, 0, 0)'; //BackgroundBlack\r\n        if (code === 265) return 'rgb(128, 0, 0)';//red back\r\n        if (code === 266) return 'rgb(0, 128, 0)';//greenback\r\n        if (code === 267) return 'rgb(128, 128, 0)';//yellow back\r\n        if (code === 268) return 'rgb(0, 0, 128)';//blue back\r\n        if (code === 269) return 'rgb(128, 0, 128)';//magenta back\r\n        if (code === 270) return 'rgb(0, 128, 128)';//cyan back\r\n        if (code === 271) return 'rgb(192, 192, 192)';//white back\r\n        if (code === 272) return 'rgb(0,0,0)'; //iceMudInfoBackground\r\n        if (code === 273) return 'rgb(0, 255, 255)';//iceMudInfoText\r\n        if (code === 274) return 'rgb(0,0,0)'; //LocalEchoBackground\r\n        if (code === 275) return 'rgb(255, 255, 0)';//LocalEchoText\r\n        if (code === 276) return 'rgb(0, 0, 0)';//DefaultBack\r\n        if (code === 277) return 'rgb(192, 192, 192)';//DefaultFore\r\n        if (code === 278) return 'rgb(128, 0, 0)';//ErrorFore\r\n        if (code === 279) return 'rgb(192, 192, 192)';//ErrorBack\r\n        if (code === 280) return 'rgb(255,255,255)';//DefaultBrightFore\t\r\n        return '';\r\n    }\r\n\r\n    public setValue(option, value) {\r\n        if (value == 'false') value = false;\r\n        if (value == 'true') value = true;\r\n        if (value == 'null') value = null;\r\n        if (value == 'undefined') value = undefined;\r\n        if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n            value = parseFloat(value);\r\n        this.settings[option] = this.convertType(value, typeof this.settings[option]);\r\n    }\r\n\r\n    public convertType(value, type) {\r\n        if (typeof value === type)\r\n            return value;\r\n        switch (type) {\r\n            case 'number':\r\n                if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n                    return parseFloat(value);\r\n                return Number(value);\r\n            case 'boolean':\r\n                return Boolean(value);\r\n            case 'string':\r\n                return '' + value;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    static addPlugins(menu) {\r\n        let pl = client.plugins.length;\r\n        let s;\r\n        let sl;\r\n        for (let p = 0; p < pl; p++) {\r\n            if (!client.plugins[p].settings) continue;\r\n            if (client.plugins[p].settings.length) {\r\n                sl = client.plugins[p].settings.length;\r\n                for (s = 0; s < sl; s++) {\r\n                    let item = client.plugins[p].settings[s];\r\n                    if (typeof item.action !== 'string') continue;\r\n                    let code = `<a href=\"#${item.action}\" class=\"list-group-item list-group-item-action\">${item.icon || ''}${item.name || ''}</a>`;\r\n                    if ('position' in item) {\r\n                        if (typeof item.position === 'string') {\r\n                            if (menu.querySelector(item.position)) {\r\n                                menu.querySelector(item.position).insertAdjacentHTML('afterend', code);\r\n                                continue;\r\n                            }\r\n                        }\r\n                        else if (item.position >= 0 && item.position < menu.children.length) {\r\n                            menu.children[item.position].insertAdjacentHTML('afterend', code);\r\n                            continue;\r\n                        }\r\n                    }\r\n                    menu.insertAdjacentHTML('beforeend', code);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static get menuTemplate() {\r\n        return `<div class=\"contents list-group list-group-flush\" style=\"top:0;position: absolute;left:0;bottom:49px;right:0;\">` +\r\n            `<a href=\"#settings-general\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-cogs\"></i> General</a>` +\r\n            `<a href=\"#settings-display\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-display\"></i> Display</a>` +\r\n            `<a href=\"#settings-colors\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-palette\"></i> Colors</a>` +\r\n            `<a href=\"#settings-commandLine\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-terminal\"></i> Command line</a>` +\r\n            `<a href=\"#settings-tabCompletion\" class=\"list-group-item list-group-item-action\"><i class=\"fa-solid fa-arrow-right-to-bracket\"></i> Tab completion</a>` +\r\n            `<a href=\"#settings-telnet\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-network-wired\"></i> Telnet</a>` +\r\n            `<a href=\"#settings-scripting\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-code\"></i> Scripting</a>` +\r\n            `<a href=\"#settings-specialCharacters\" class=\"list-group-item list-group-item-action\"><i class=\"fa-regular fa-file-code\"></i> Special characters</a>` +\r\n            `<a href=\"#settings-advanced\" class=\"list-group-item list-group-item-action\"><i class=\"fa-solid fa-sliders\"></i> Advanced</a>` +\r\n            `</div>`;\r\n    }\r\n}", "//spellchecker:ignore\nimport \"../css/splitter.css\";\nimport { EventEmitter } from '../events';\n\nexport interface SplitterOptions {\n    container?: any;\n    orientation?: Orientation;\n    parent?: any;\n    id?: string;\n    panel1?: HTMLElement;\n    panel2?: HTMLElement;\n    anchor?: PanelAnchor;\n}\n\nexport enum Orientation {\n    horizontal, vertical\n}\n\nexport enum PanelAnchor {\n    panel1 = 1, panel2 = 2\n}\n\n/**\n * Splitter display control\n *\n * @export\n * @class Splitter\n * @extends {EventEmitter}\n */\nexport class Splitter extends EventEmitter {\n    private $el: HTMLElement;\n    private $parent: HTMLElement;\n    private $panel1: HTMLElement;\n    private $panel2: HTMLElement;\n    private $orientation: Orientation;\n    private $panel1MinSize = 200;\n    private $panel2MinSize = 200;\n    private $splitterWidth = 4;\n    private $dragBar: HTMLElement;\n    private $ghostBar: HTMLElement;\n    private $splitterDistance = 200;\n    private $dragging = false;\n    private $id;\n    private $collapsed = 0;\n    private $resizeObserver;\n    private $resizeObserverCache;\n    private $observer: MutationObserver;\n    private $anchor: PanelAnchor;\n\n    public live = true;\n\n    private $elBounds;\n\n    public hide() {\n        this.$el.style.display = 'none';\n    }\n\n    public show() {\n        this.$el.style.display = '';\n    }\n\n    constructor(options?: SplitterOptions) {\n        super();\n        if (options && options.id)\n            this.$id = options.id;\n        if (options) {\n            this.$panel1 = options.panel1;\n            this.$panel2 = options.panel2;\n        }\n        if (options && options.container)\n            this.parent = options.container.container ? options.container.container : options.container;\n        else if (options && options.parent)\n            this.parent = options.parent;\n        else\n            this.parent = document.body;\n        if (options) {\n            if ('anchor' in options)\n                this.$anchor = options.anchor;\n            else\n                this.$anchor = PanelAnchor.panel2;\n            this.orientation = options.orientation || Orientation.horizontal;\n        }\n        else {\n            this.$anchor = PanelAnchor.panel2;\n            this.orientation = Orientation.horizontal;\n        }\n    }\n\n    get id() { return this.$id || this.parent.id; }\n    set id(value) {\n        if (value === this.$id) return;\n        this.$id = value;\n        this.$el.id = this.id + '-splitter';\n        this.$panel1.id = this.id + '-splitter-panel1';\n        this.$panel2.id = this.id + '-splitter-panel2';\n        this.$dragBar.id = this.id + '-splitter-drag-bar';\n        if (this.$ghostBar)\n            this.$ghostBar.id = this.id + '-ghost-bar';\n    }\n\n    set parent(parent) {\n        if (typeof parent === 'string') {\n            if ((<string>parent).startsWith('#'))\n                this.$parent = document.getElementById((<string>parent).substr(1));\n            else\n                this.$parent = document.getElementById(parent);\n        }\n        else if (parent instanceof $)\n            this.$parent = parent[0];\n        else if (parent instanceof HTMLElement)\n            this.$parent = parent;\n        if (!this.$parent)\n            this.$parent = document.body;\n        this.createControl();\n    }\n\n    get parent(): HTMLElement { return this.$parent; }\n\n    get panel1(): HTMLElement { return this.$panel1; }\n\n    get panel2(): HTMLElement { return this.$panel2; }\n\n    get anchor(): PanelAnchor { return this.$anchor; }\n    set anchor(value: PanelAnchor) {\n        if (this.$anchor === value) return;\n        this.$anchor = 2;\n        this.updatePanels();\n    }\n\n    set SplitterDistance(value) {\n        if (this.$splitterDistance === value)\n            return;\n        this.$splitterDistance = value;\n        this.updatePanels();\n        this.emit('splitter-moved', value);\n    }\n    get SplitterDistance() { return this.$splitterDistance; }\n\n    set Panel1MinSize(value) {\n        if (this.$panel1MinSize === value)\n            return;\n        this.$panel1MinSize = value;\n        if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel1.clientWidth < value)\n                this.$splitterDistance = this.parent.clientWidth - this.$panel1MinSize;\n        }\n        else if (this.$panel1.clientHeight < value)\n            this.$splitterDistance = this.parent.clientHeight - this.$panel1MinSize;\n        this.updatePanels();\n    }\n    get Panel1MinSize() { return this.$panel1MinSize; }\n\n    set Panel2MinSize(value) {\n        if (this.$panel2MinSize === value)\n            return;\n        this.$panel2MinSize = value;\n        if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel2.clientWidth < value)\n                this.$splitterDistance = value;\n        }\n        else if (this.$panel2.clientHeight < value)\n            this.$splitterDistance = value;\n        this.updatePanels();\n    }\n    get Panel2MinSize() { return this.$panel2MinSize; }\n\n    get orientation(): Orientation { return this.$orientation; }\n    set orientation(value: Orientation) {\n        if (value === this.$orientation) return;\n        this.$orientation = value;\n        this.updatePanels();\n    }\n\n    get panel1Collapsed() { return this.$collapsed === 1; }\n    set panel1Collapsed(value) {\n        if (value) {\n            if (this.$collapsed === 1) return;\n            this.$collapsed = 1;\n            this.panel1.dataset.collapsed = 'true';\n            this.panel2.dataset.collapsed = 'false';\n            this.emit('collapsed', 1);\n            this.updatePanels();\n        }\n        else if (this.$collapsed === 1) {\n            this.$collapsed = 0;\n            delete this.panel1.dataset.collapsed;\n            delete this.panel2.dataset.collapsed;\n            this.emit('collapsed', 0);\n            this.updatePanels();\n        }\n    }\n\n    get panel2Collapsed() { return this.$collapsed === 2; }\n    set panel2Collapsed(value) {\n        if (value) {\n            if (this.$collapsed === 2) return;\n            this.$collapsed = 2;\n            this.panel1.dataset.collapsed = 'false';\n            this.panel2.dataset.collapsed = 'true';\n            this.emit('collapsed', 2);\n            this.updatePanels();\n        }\n        else if (this.$collapsed === 2) {\n            this.$collapsed = 0;\n            delete this.panel1.dataset.collapsed;\n            delete this.panel2.dataset.collapsed;\n            this.emit('collapsed', 0);\n            this.updatePanels();\n        }\n    }\n\n    private updatePanels() {\n        if (this.$orientation === Orientation.horizontal) {\n            this.$panel1.style.left = '0';\n            this.$panel1.style.top = '0';\n            this.$panel1.style.right = '0';\n\n            this.$panel2.style.left = '0';\n            this.$panel2.style.top = '';\n            this.$panel2.style.right = '0';\n            this.$panel2.style.bottom = '0';\n\n            this.$dragBar.style.left = '0';\n            this.$dragBar.style.right = '0';\n            if (this.$anchor === PanelAnchor.panel1) {\n                this.$dragBar.style.bottom = '';\n                this.$dragBar.style.top = (this.$splitterDistance) + 'px';\n            }\n            else {\n                this.$dragBar.style.top = '';\n                this.$dragBar.style.bottom = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            this.$dragBar.style.height = this.$splitterWidth + 'px';\n            this.$dragBar.style.cursor = 'ns-resize';\n\n            if (this.$collapsed === 1) {\n                this.$panel1.style.display = 'none';\n                this.$panel2.style.display = '';\n                this.$panel2.style.top = '0';\n                this.$panel2.style.height = '';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$collapsed === 2) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.bottom = '0';\n                this.$panel1.style.height = '';\n                this.$panel2.style.display = 'none';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$anchor === PanelAnchor.panel1) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.height = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.top = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$panel2.style.height = '';\n                this.$dragBar.style.display = '';\n            }\n            else {\n                this.$panel1.style.display = '';\n                this.$panel1.style.bottom = this.$splitterDistance + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.height = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$dragBar.style.display = '';\n            }\n\n            this.$el.classList.remove('vertical');\n            this.$el.classList.add('horizontal');\n        }\n        else {\n            this.$panel1.style.left = '0';\n            this.$panel1.style.top = '0';\n            this.$panel1.style.bottom = '0';\n            this.$panel1.classList.remove('horizontal');\n            this.$panel1.classList.add('vertical');\n\n            this.$panel2.style.left = '';\n            this.$panel2.style.top = '0';\n            this.$panel2.style.right = '0';\n            this.$panel2.style.bottom = '0';\n            if (this.$anchor === PanelAnchor.panel1) {\n                this.$dragBar.style.right = '';\n                this.$dragBar.style.left = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            else {\n                this.$dragBar.style.left = '';\n                this.$dragBar.style.right = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            this.$dragBar.style.top = '0';\n            this.$dragBar.style.bottom = '0';\n            this.$dragBar.style.width = this.$splitterWidth + 'px';\n            this.$dragBar.style.cursor = 'ew-resize';\n\n            if (this.$collapsed === 1) {\n                this.$panel1.style.display = 'none';\n                this.$panel2.style.display = '';\n                this.$panel2.style.left = '0';\n                this.$panel2.style.width = '';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$collapsed === 2) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.right = '0';\n                this.$panel1.style.width = '';\n                this.$panel2.style.display = 'none';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$anchor === PanelAnchor.panel1) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.width = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.left = this.$splitterDistance - this.$splitterWidth + 'px';\n                this.$panel2.style.width = '';\n                this.$dragBar.style.display = '';\n            }\n            else {\n                this.$panel1.style.display = '';\n                this.$panel1.style.right = this.$splitterDistance + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.width = this.$splitterDistance - this.$splitterWidth + 'px';\n                this.$dragBar.style.display = '';\n            }\n            this.$el.classList.remove('horizontal');\n            this.$el.classList.add('vertical');\n\n        }\n    }\n\n    private createControl() {\n        this.$el = document.createElement('div');\n        this.$el.id = this.id + '-splitter';\n        this.$el.classList.add('splitter');\n        if (!this.$panel1) {\n            this.$panel1 = document.createElement('div');\n            this.$panel1.id = this.id + '-splitter-panel1';\n        }\n        this.$panel1.classList.add('splitter-panel', 'splitter-panel-1');\n        this.$el.appendChild(this.$panel1);\n        if (!this.$panel2) {\n            this.$panel2 = document.createElement('div');\n            this.$panel2.id = this.id + '-splitter-panel2';\n        }\n        this.$panel2.classList.add('splitter-panel', 'splitter-panel-2');\n        this.$el.appendChild(this.$panel2);\n        this.$dragBar = document.createElement('div');\n        this.$dragBar.id = this.id + '-splitter-drag-bar';\n        this.$dragBar.classList.add('spitter-drag-bar');\n        this.$el.appendChild(this.$dragBar);\n        this.$dragBar.tabIndex = 1;\n        this.$dragBar.addEventListener('mousedown', (e) => {\n            this.$dragBar.focus();\n            e.preventDefault();\n            this.$dragging = true;\n            this.$ghostBar = document.createElement('div');\n            this.$ghostBar.id = this.id + '-ghost-bar';\n            this.$ghostBar.classList.add('splitter-ghost-bar');\n            let bnd = this.$panel2.getBoundingClientRect();\n            if (this.$anchor === PanelAnchor.panel1)\n                bnd = this.$panel1.getBoundingClientRect();\n            if (this.$orientation === Orientation.horizontal) {\n                this.$ghostBar.style.left = '0';\n                if (this.$anchor === PanelAnchor.panel1)\n                    this.$ghostBar.style.top = (bnd.bottom - this.$elBounds.top) + 'px';\n                else\n                    this.$ghostBar.style.top = (bnd.top - this.$elBounds.top - this.$splitterWidth) + 'px';\n                this.$ghostBar.style.right = '0';\n                this.$ghostBar.style.bottom = '';\n                this.$ghostBar.style.width = '';\n                this.$ghostBar.style.height = this.$splitterWidth + 'px';\n                this.$ghostBar.style.cursor = 'ns-resize';\n            }\n            else {\n                if (this.$anchor === PanelAnchor.panel1)\n                    this.$ghostBar.style.left = (bnd.right - this.$elBounds.left) + 'px';\n                else\n                    this.$ghostBar.style.left = (bnd.left - this.$elBounds.left - this.$splitterWidth) + 'px';\n                this.$ghostBar.style.top = '0';\n                this.$ghostBar.style.bottom = '0';\n                this.$ghostBar.style.right = '';\n                this.$ghostBar.style.height = '';\n                this.$ghostBar.style.width = this.$splitterWidth + 'px';\n                this.$ghostBar.style.cursor = 'ew-resize';\n            }\n            (<any>this.$ghostBar).move = (ge) => {\n                let l;\n                if (this.$orientation === Orientation.horizontal && this.$anchor === PanelAnchor.panel1) {\n                    l = ge.pageY - this.$elBounds.top;\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.$ghostBar.style.top = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                        this.$ghostBar.style.top = (this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth) + 'px';\n                    else\n                        this.$ghostBar.style.top = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize + this.$splitterWidth)\n                            this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                        else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                            this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = l - 2 + this.$splitterWidth;\n                    }\n                }\n                else if (this.$orientation === Orientation.horizontal) {\n                    l = ge.pageY - this.$elBounds.top;\n                    if (l < this.$panel1MinSize)\n                        this.$ghostBar.style.top = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                        this.$ghostBar.style.top = (this.parent.clientHeight - this.$panel2MinSize) + 'px';\n                    else\n                        this.$ghostBar.style.top = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize)\n                            this.SplitterDistance = this.parent.clientHeight - this.$panel1MinSize;\n                        else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                            this.SplitterDistance = this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = this.parent.clientHeight - l + 2;\n                    }\n                }\n                else if (this.$orientation === Orientation.vertical && this.$anchor === PanelAnchor.panel1) {\n                    l = ge.pageX - this.$elBounds.left;\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.$ghostBar.style.left = this.$panel1MinSize + 'px';\n                    else if (l >= this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                        this.$ghostBar.style.left = (this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth) + 'px';\n                    else\n                        this.$ghostBar.style.left = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize + this.$splitterWidth)\n                            this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                        else if (l >= this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                            this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = l - 2 + this.$splitterWidth;\n                    }\n                }\n                else {\n                    l = ge.pageX - this.$elBounds.left;\n                    if (l < this.$panel1MinSize)\n                        this.$ghostBar.style.left = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                        this.$ghostBar.style.left = (this.parent.clientWidth - this.$panel2MinSize) + 'px';\n                    else\n                        this.$ghostBar.style.left = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize)\n                            this.SplitterDistance = this.parent.clientWidth - this.$panel1MinSize;\n                        else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                            this.SplitterDistance = this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = this.parent.clientWidth - l + 2;\n                    }\n                }\n                this.emit('splitter-moving', l);\n            };\n            this.$el.appendChild(this.$ghostBar);\n            document.addEventListener('mousemove', (<any>this.$ghostBar).move);\n        });\n        this.$dragBar.addEventListener('dblclick', (e) => {\n            this.emit('dblclick', e);\n        });\n        window.addEventListener('resize', () => {\n            this.resize();\n        });\n        document.addEventListener('mouseup', (e) => {\n            if (!this.$dragging) return;\n            e.preventDefault();\n            e.stopPropagation();\n            e.cancelBubble = true;\n            let l;\n            if (this.$orientation === Orientation.horizontal) {\n                l = e.pageY - this.$elBounds.top;\n                if (this.$anchor === PanelAnchor.panel1) {\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                        this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n                    else\n                        this.SplitterDistance = l - 2 + this.$splitterWidth;\n                }\n                else if (l < this.$panel1MinSize)\n                    this.SplitterDistance = this.parent.clientHeight - this.$panel1MinSize - 2;\n                else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                    this.SplitterDistance = this.$panel2MinSize;\n                else\n                    this.SplitterDistance = this.parent.clientHeight - l + 2;\n            }\n            else {\n                l = e.pageX - this.$elBounds.left;\n                if (this.$anchor === PanelAnchor.panel1) {\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                    else if (l > this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                        this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n                    else\n                        this.SplitterDistance = l - 2 + this.$splitterWidth;\n                }\n                else if (l < this.$panel1MinSize)\n                    this.SplitterDistance = this.parent.clientWidth - this.$panel1MinSize - 2;\n                else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                    this.SplitterDistance = this.$panel2MinSize;\n                else\n                    this.SplitterDistance = this.parent.clientWidth - l + 2;\n            }\n            this.$el.removeChild(this.$ghostBar);\n            document.removeEventListener('mousemove', (<any>this.$ghostBar).move);\n            this.$ghostBar = null;\n            this.$dragging = false;\n        });\n        this.parent.appendChild(this.$el);\n        setTimeout(() => {\n            this.$elBounds = this.$el.getBoundingClientRect();\n        }, 10);\n\n        this.$resizeObserver = new ResizeObserver((entries, observer) => {\n            if (entries.length === 0) return;\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\n                return;\n            if (!this.$resizeObserverCache || this.$resizeObserverCache.width !== entries[0].contentRect.width || this.$resizeObserverCache.height !== entries[0].contentRect.height) {\n                this.$resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\n                this.resize();\n            }\n        });\n        this.$resizeObserver.observe(this.$el);\n        this.$observer = new MutationObserver((mutationsList) => {\n            let mutation;\n            for (mutation of mutationsList) {\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\n                    if (mutation.oldValue === 'display: none;')\n                        this.resize();\n                }\n            }\n        });\n        this.$observer.observe(this.$el, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\n    }\n\n    public resize() {\n        if (this.$orientation === Orientation.horizontal && this.$anchor === PanelAnchor.panel1) {\n            if (this.$panel2.clientHeight && this.$panel2.clientHeight < this.$panel2MinSize && this.$panel1.clientHeight > this.$panel1MinSize)\n                this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n        }\n        else if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel1.clientHeight && this.$panel1.clientHeight < this.$panel1MinSize && this.$panel2.clientHeight > this.$panel2MinSize)\n                this.SplitterDistance = this.$panel1MinSize;\n        }\n        else if (this.$orientation === Orientation.vertical && this.$anchor === PanelAnchor.panel1) {\n            if (this.$panel2.clientWidth && this.$panel2.clientWidth < this.$panel2MinSize && this.$panel1.clientWidth > this.$panel1MinSize)\n                this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n        }\n        else if (this.$panel1.clientWidth < this.$panel1MinSize && this.$panel2.clientWidth > this.$panel2MinSize)\n            this.SplitterDistance = this.$panel1MinSize;\n        this.$elBounds = this.$el.getBoundingClientRect();\n    }\n}\n", "import \"../css/nav.css\";\r\nimport \"../css/profiles.css\";\r\nimport { Dialog, DialogButtons, DialogIcon } from \"./dialog\";\r\nimport { Splitter, Orientation, PanelAnchor } from \"./splitter\";\r\nimport { capitalize, openFileDialog, readFile, keyCodeToChar, keyCharToCode, scrollChildIntoView, debounce, FilterArrayByKeyValue, htmlEncode } from '../library';\r\nimport { removeHash, updateHash } from \"./interface\";\r\nimport { ProfileCollection, MacroDisplay, Profile, Alias, Trigger, Button, Macro, Context } from \"../profile\";\r\n\r\ndeclare let confirm_box;\r\ndeclare let fileSaveAs;\r\ndeclare let alert_box;\r\n\r\nexport class ProfilesDialog extends Dialog {\r\n    private _menu;\r\n    private _contents;\r\n    private _splitter;\r\n    private _page;\r\n    private _contentPage;\r\n    public profiles: ProfileCollection;\r\n    private _profilesChanged = false;\r\n    private _errorField;\r\n    private _current = {\r\n        profile: null,\r\n        profileName: '',\r\n        item: null,\r\n        parent: null,\r\n        itemIdx: -1,\r\n        collection: '',\r\n        itemSubIdx: -1\r\n    }\r\n    private _canClose: boolean = false;\r\n    private _small: boolean = false;\r\n\r\n    public set errorField(value) {\r\n        this._errorField = value;\r\n    }\r\n    public get errorField() { return this._errorField; }\r\n\r\n    public get current() { return this._current; }\r\n\r\n    public set changed(value) {\r\n        if (value === this._profilesChanged) return;\r\n        this._profilesChanged = value;\r\n        this.footer.querySelector(`#${this.id}-save`).disabled = !value;\r\n        this.footer.querySelector(`#${this.id}-apply`).disabled = !value;\r\n\r\n    }\r\n    public get changed() { return this._profilesChanged }\r\n\r\n    public get contents() { return this._contents; }\r\n\r\n    constructor() {\r\n        super(Object.assign({}, client.getOption('windows.profiles') || { center: true }, { title: 'i class=\"fas fa-users\"></i> Profiles', minWidth: 410 }));\r\n        this.on('resized', e => {\r\n            if (e.width < 430) {\r\n                if (this._small) return;\r\n                const item = this.header.querySelector('.breadcrumb');\r\n                item.classList.add('breadcrumb-sm');\r\n                this._small = true;\r\n            }\r\n            else if (this._small) {\r\n                const item = this.header.querySelector('.breadcrumb');\r\n                item.classList.remove('breadcrumb-sm');\r\n                this._small = false;\r\n            }\r\n            client.setOption('windows.profiles', e);\r\n        })\r\n        client.on('profiles-loaded', () => {\r\n            if (!this.profiles) {\r\n                this.profiles = client.profiles.clone();\r\n                this.profiles.SortByPriority();\r\n                this._buildMenu();\r\n            }\r\n        });\r\n        client.on('profiles-updated', () => {\r\n\r\n        });\r\n        client.on('initialized', () => {\r\n            if (!this.profiles) {\r\n                this.profiles = client.profiles.clone();\r\n                this.profiles.SortByPriority();\r\n                this._buildMenu();\r\n            }\r\n        });\r\n        this.body.style.padding = '10px';\r\n        this._splitter = new Splitter({ id: 'profile', parent: this.body, orientation: Orientation.vertical, anchor: PanelAnchor.panel1 });\r\n        if (client.getOption('profiles.split') >= 200)\r\n            this._splitter.SplitterDistance = client.getOption('profiles.split');\r\n        this._splitter.on('splitter-moved', distance => {\r\n            client.setOption('profiles.split', distance);\r\n        })\r\n        this._menu = this._splitter.panel1;\r\n        this._menu.style.overflow = 'hidden';\r\n        this._menu.style.overflowY = 'auto';\r\n        this._contents = this._splitter.panel2;\r\n        this._contents.style.overflow = 'auto';\r\n        this._contents.style.padding = '10px';\r\n        this._contents.style.paddingLeft = '14px';\r\n        if (client.profiles) {\r\n            this.profiles = client.profiles.clone();\r\n            this.profiles.SortByPriority();\r\n            this._buildMenu();\r\n        }\r\n        let footer = '';\r\n        footer += `<button id=\"${this.id}-back\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Go back\"><i class=\"bi bi-arrow-left\"></i><span class=\"icon-only\"> Back</span></button>`;\r\n        footer += `<button id=\"btn-profile-menu\" class=\"btn-sm float-start btn btn-outline-secondary\" type=\"button\" aria-controls=\"profile-menu\" title=\"Show menu\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" style=\"margin-right: 4px;\"><i class=\"fa-solid fa-bars\"></i></button>`;\r\n        footer += `<ul id=\"${this.id}-dropdown-menu\" class=\"dropdown-menu\" style=\"overflow: auto;\">`;\r\n        footer += `<li id=\"${this.id}-add-profile\"><a class=\"dropdown-item\">Add profile</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-empty-profile\"><a class=\"dropdown-item\">Add empty profile</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-sep\"><hr class=\"dropdown-divider\"></li>`;\r\n        footer += `<li id=\"${this.id}-add-alias\"><a class=\"dropdown-item\">Add alias</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-macro\"><a class=\"dropdown-item\">Add macro</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-trigger\"><a class=\"dropdown-item\">Add trigger</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-button\"><a class=\"dropdown-item\">Add button</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-sep2\"><hr class=\"dropdown-divider\"></li>`;\r\n        footer += `<li id=\"${this.id}-add-default-buttons\"><a class=\"dropdown-item\">Add default buttons</a></li>`;\r\n        footer += `<li id=\"${this.id}-add-default-macros\"><a class=\"dropdown-item\">Add default macros</a></li>`;\r\n        footer += '<li><hr class=\"dropdown-divider\"></li>';\r\n        footer += `<li id=\"${this.id}-export-current\"><a class=\"dropdown-item\">Export current profile</a></li>`;\r\n        footer += `<li id=\"${this.id}-export\"><a class=\"dropdown-item\">Export profiles</a></li>`;\r\n        footer += `<li id=\"${this.id}-import\"><a class=\"dropdown-item\">Import profiles</a></li>`;\r\n        footer += '<li><hr class=\"dropdown-divider\"></li>';\r\n        footer += `<li id=\"${this.id}-refresh\"><a class=\"dropdown-item\">Refresh</a></li>`;\r\n        footer += '</ul>';\r\n        footer += '<span id=\"profile-page-buttons\"></span>';\r\n        footer += `<button id=\"${this.id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Close dialog\"><i class=\"bi bi-x-lg\"></i><span class=\"icon-only\"> Cancel</span></button>`;\r\n        footer += `<button id=\"${this.id}-save\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Save changes\" disabled><i class=\"bi bi-save\"></i><span class=\"icon-only\"> Save</span></button>`;\r\n        footer += `<button id=\"${this.id}-apply\" type=\"button\" class=\"btn-sm float-end btn btn-secondary\" title=\"Apply changes\" disabled><i class=\"bi bi-check-lg\"></i><span class=\"icon-only\"> Apply</span></button>`;\r\n        this.footer.innerHTML = footer;\r\n        this.footer.classList.add('dropup');\r\n\r\n        document.getElementById('btn-profile-menu').addEventListener('shown.bs.dropdown', () => {\r\n            setTimeout(() => {\r\n                let el = this.footer.querySelector('#' + this.id + '-dropdown-menu');\r\n                let rect = el.getBoundingClientRect();\r\n                if (rect.y < 10)\r\n                    el.style.height = (rect.height + rect.y - 10) + 'px';\r\n                if (rect.bottom > document.body.clientHeight - 10)\r\n                    el.style.height = (document.body.clientHeight - rect.y - 10) + 'px';\r\n            }, 0);\r\n        })\r\n\r\n        document.getElementById('btn-profile-menu').addEventListener('hidden.bs.dropdown', () => {\r\n            let el = this.footer.querySelector('#' + this.id + '-dropdown-menu');\r\n            el.style.height = '';\r\n        });\r\n        this.footer.querySelector(`#${this.id}-cancel`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            this.close();\r\n        });\r\n        this.footer.querySelector(`#${this.id}-back`).addEventListener('click', () => {\r\n            this._goBack();\r\n        });\r\n        this.on('closed', () => {\r\n            client.setOption('windows.profiles', this.windowState);\r\n            removeHash(this._page);\r\n        });\r\n        this.on('canceled', () => {\r\n            client.setOption('windows.profiles', this.windowState);\r\n            removeHash(this._page);\r\n        });\r\n        this.on('moved', e => {\r\n            client.setOption('windows.profiles', e);\r\n        })\r\n        this.on('maximized', () => {\r\n            client.setOption('windows.profiles', this.windowState);\r\n        });\r\n        this.on('restored', () => {\r\n            client.setOption('windows.profiles', this.windowState);\r\n        });\r\n        this.on('shown', () => {\r\n            client.setOption('windows.profiles', this.windowState);\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-profile a`).addEventListener('click', () => {\r\n            this._createProfile(true);\r\n        });\r\n\r\n        this.footer.querySelector(`#${this.id}-add-empty-profile a`).addEventListener('click', () => {\r\n            this._createProfile(false);\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-alias a`).addEventListener('click', () => {\r\n            this._addItem('aliases');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-macro a`).addEventListener('click', () => {\r\n            this._addItem('macros');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-trigger a`).addEventListener('click', () => {\r\n            this._addItem('triggers');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-button a`).addEventListener('click', () => {\r\n            this._addItem('buttons');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-default-buttons a`).addEventListener('click', () => {\r\n            const items = Profile.DefaultButtons;\r\n            let il = items.length;\r\n            for (let i = 0; i < il; i++)\r\n                this._addItem('buttons', items[i]);\r\n\r\n        });\r\n        this.footer.querySelector(`#${this.id}-add-default-macros a`).addEventListener('click', () => {\r\n            const items = Profile.DefaultMacros;\r\n            let il = items.length;\r\n            for (let i = 0; i < il; i++)\r\n                this._addItem('macros', items[i]);\r\n        });\r\n        this.footer.querySelector(`#${this.id}-export-current a`).addEventListener('click', () => {\r\n            const data = {\r\n                version: 2, profiles: {}\r\n            };\r\n            data.profiles[this._current.profileName] = this._current.profile.clone(2);\r\n            fileSaveAs.show(JSON.stringify(data), `oiMUD.${this._current.profileName}.txt`, 'text/plain');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-export a`).addEventListener('click', () => {\r\n            const data = {\r\n                version: 2, profiles: this.profiles.clone(2)\r\n            };\r\n            fileSaveAs.show(JSON.stringify(data), 'oiMUD.profiles.txt', 'text/plain');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-import a`).addEventListener('click', () => {\r\n            openFileDialog('Import profile(s)').then(files => {\r\n                readFile(files[0]).then((contents: any) => {\r\n                    try {\r\n                        var data = JSON.parse(contents);\r\n                        if (data.version == 2) {\r\n                            if (data.profiles) {\r\n                                var keys = Object.keys(data.profiles);\r\n                                var n, i, k = 0, kl = keys.length;\r\n                                for (; k < kl; k++) {\r\n                                    n = keys[k];\r\n                                    i = 0;\r\n                                    while (this.profiles.contains(n)) {\r\n                                        if (i === 0)\r\n                                            n = keys[k] + ' Copy';\r\n                                        else\r\n                                            n = keys[k] + ' Copy (' + i + ')';\r\n                                        i++;\r\n                                    }\r\n                                    //set the new name\r\n                                    data.profiles[keys[k]].name = n;\r\n                                    //load the profile\r\n                                    const p = Profile.load(data.profiles[keys[k]]);\r\n                                    //add to collection\r\n                                    this.profiles.add(p);\r\n                                }\r\n                                //no profiles so just bail\r\n                                if (kl === 0) return;\r\n                                this.changed = true;\r\n                                //rebuild the menu as could have added multiple profiles or not and this ensures ordered correctly by priority\r\n                                this._buildMenu();\r\n                                //reselect current item\r\n                                this._expandPath(this._page);\r\n                            }\r\n                        }\r\n                        else\r\n                            setTimeout(function () {\r\n                                alert_box('Invalid file', 'Unable to import file, not a valid profile file', DialogIcon.exclamation)\r\n                            }, 50);\r\n                    }\r\n                    catch (err) {\r\n                        setTimeout(function () {\r\n                            alert_box('Error importing', 'Error importing file.', DialogIcon.error);\r\n                        }, 50);\r\n                        client.error(err);\r\n                    }\r\n                }).catch(client.error);\r\n            }).catch(() => { });\r\n        });\r\n        this.footer.querySelector(`#${this.id}-refresh a`).addEventListener('click', () => {\r\n            this._buildMenu();\r\n            this.setBody(this._page);\r\n        });\r\n\r\n        this.footer.querySelector(`#${this.id}-save`).addEventListener('click', () => {\r\n            if (this._errorField) {\r\n                this._errorField.focus();\r\n                return;\r\n            }\r\n            this._save();\r\n            this.close();\r\n        });\r\n        this.footer.querySelector(`#${this.id}-apply`).addEventListener('click', () => {\r\n            if (this._errorField) {\r\n                this._errorField.focus();\r\n                return;\r\n            }\r\n            this._save();\r\n        });\r\n    }\r\n\r\n    private _getItem(collection, index, idPrefix, hrefPrefix, indent?) {\r\n        if (!collection || collection.length === 0) return '';\r\n        let menu = '';\r\n        indent = indent || 0;\r\n        let padding = indent * 20 + 16;\r\n        menu += `<li class=\"nav-item\" title=\"${htmlEncode(GetDisplay(collection[index]))}\" id=\"${idPrefix + '-' + (collection[index].useName ? this.sanitizeID(collection[index].name.toLowerCase()) : index)}\">`;\r\n        if (collection[index].items && collection[index].items.length) {\r\n            menu += `<a style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\"><i class=\"align-middle float-start bi bi-chevron-right\"></i> <input data-page=\"${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\" type=\"checkbox\" class=\"form-check-input\" id=\"enabled-${idPrefix}-${this.sanitizeID(collection[index].name.toLowerCase())}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\r\n            menu += this._getItems(collection[index].items, idPrefix + '-' + this.sanitizeID(collection[index].name.toLowerCase()), hrefPrefix + '/' + encodeURIComponent(collection[index].name.toLowerCase()), indent + 1);\r\n        }\r\n        else if (collection[index].useName)\r\n            menu += `<a style=\"padding-left: ${padding}px\" class=\"nav-link text-dark \" href=\"#${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\"><i class=\"align-middle float-start no-icon\"></i> <input data-page=\"${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\" type=\"checkbox\" class=\"form-check-input\" id=\"enabled-${idPrefix}-${this.sanitizeID(collection[index].name.toLowerCase())}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\r\n        else\r\n            menu += `<a style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#${hrefPrefix}/${index}\"><i class=\"align-middle float-start no-icon\"></i><input type=\"checkbox\" class=\"form-check-input\" data-page=\"${hrefPrefix}/${index}\" id=\"enabled-${idPrefix}-${index}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\r\n        menu += '</li>';\r\n        return menu;\r\n    }\r\n\r\n    private _getItems(collection, idPrefix, hrefPrefix, indent?) {\r\n        if (!collection || collection.length === 0) return '';\r\n        let menu = '';\r\n        for (let c = 0, cl = collection.length; c < cl; c++) {\r\n            menu += this._getItem(collection, c, idPrefix, hrefPrefix, indent);\r\n        }\r\n        return '<ul class=\"dropdown-menu dropdown-inline\">' + menu + '</ul>';\r\n    }\r\n\r\n    private _buildMenu() {\r\n        let nav = '';\r\n        for (let k = 0, kl = this.profiles.keys.length; k < kl; k++) {\r\n            nav += this._profile(this.profiles.keys[k]);\r\n        }\r\n        this._menu.innerHTML = '<ul class=\"nav\" id=\"profile-menu\">' + nav + '</ul>'\r\n        let items = this._menu.querySelectorAll('a');\r\n        for (let i = 0, il = items.length; i < il; i++) {\r\n            this._profileEvents(items[i]);\r\n        }\r\n    }\r\n\r\n    private _profileEvents(item) {\r\n        let items = item.querySelectorAll('.bi-chevron-right');\r\n        let i, il;\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].addEventListener('click', e => {\r\n                e.target.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\r\n                e.target.classList.toggle('bi-chevron-right');\r\n                e.target.classList.toggle('bi-chevron-down');\r\n                //e.stopPropagation();\r\n                //e.cancelBubble = true;\r\n                e.preventDefault();\r\n            });\r\n        items = item.querySelectorAll('input');\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].addEventListener('change', e => {\r\n                const data = e.target.dataset.page.split('/');\r\n                const value = e.target.checked;\r\n                switch (data.length) {\r\n                    case 2:\r\n                        if (!value && this.profiles.keys.filter(k => this.profiles.enabled(k)).length === 1) {\r\n                            alert_box('Cannot disable', 'One profile must always be enabled.');\r\n                            e.target.checked = true;\r\n                            return;\r\n                        }\r\n                        this._menu.querySelector(`#enabled-${this.sanitizeID(data[1])}`).checked = value;\r\n                        this._menu.querySelector(`#enabled-${this.sanitizeID(data[1])}-switch`).checked = value;\r\n                        if (this._page === e.target.dataset.page)\r\n                            this._contents.querySelector('#enabled').checked = value;\r\n                        this.profiles.items[data[1]].enabled = value;\r\n                        this.changed = true;\r\n                        break;\r\n                    case 3:\r\n                        this._menu.querySelector(`#enabled-${this.sanitizeID(data[1])}-${data[2]}`).checked = value;\r\n                        if (this._page === `profiles/${data[1]}`)\r\n                            this._contents.querySelector('#enable' + capitalize(data[2])).checked = value;\r\n                        this.profiles.items[data[1]]['enable' + capitalize(data[2])] = value;\r\n                        this.changed = true;\r\n                        break;\r\n                    case 4:\r\n                        this._menu.querySelector(`#enabled-${this.sanitizeID(data[1])}-${data[2]}-${data[3]}`).checked = value;\r\n                        if (this._page === e.target.dataset.page)\r\n                            this._contents.querySelector('#enabled').checked = value;\r\n                        else if (this._page === `profiles/${data[1]}/${data[2]}`)\r\n                            this._contents.querySelector('#check-' + data[3]).checked = value;\r\n                        this.profiles.items[data[1]][data[2]][+data[3]].enabled = value;\r\n                        this.changed = true;\r\n                        break;\r\n                }\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n            });\r\n        items = item.querySelectorAll('.list-badge-button');\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].addEventListener('click', (e: MouseEvent) => {\r\n                this._deleteProfile((e.target as HTMLElement).parentElement.dataset.profile);\r\n                e.preventDefault();\r\n            });\r\n    }\r\n\r\n    public _profile(profile) {\r\n        let nav = `<li class=\"nav-item\" data-profile=\"${profile}\" title=\"${capitalize(profile)}\" id=\"${this.sanitizeID(profile)}\">`;\r\n        nav += `<a class=\"nav-link text-dark\" href=\"#profiles/${encodeURIComponent(profile)}\">`;\r\n        if (profile !== 'default')\r\n            nav += `<span class=\"list-badge-button badge text-bg-danger\" data-profile=\"${profile}\"><i class=\"bi bi-trash\"></i></span>`;\r\n        nav += `<i class=\"align-middle float-start bi bi-chevron-right\"></i> `;\r\n        nav += this._item(capitalize(profile), 'enabled-' + profile, this.profiles.items[profile].enabled);\r\n        nav += `</a>`;\r\n        nav += this._getItems([{\r\n            name: 'Aliases',\r\n            items: this.profiles.items[profile].aliases,\r\n            useName: true,\r\n            enabled: this.profiles.items[profile].enableAliases,\r\n        },\r\n        {\r\n            name: 'Macros',\r\n            items: this.profiles.items[profile].macros,\r\n            useName: true,\r\n            enabled: this.profiles.items[profile].enableMacros\r\n        },\r\n        {\r\n            name: 'Triggers',\r\n            items: this.profiles.items[profile].triggers,\r\n            useName: true,\r\n            enabled: this.profiles.items[profile].enableTriggers\r\n        },\r\n        {\r\n            name: 'Buttons',\r\n            items: this.profiles.items[profile].buttons,\r\n            useName: true,\r\n            enabled: this.profiles.items[profile].enableButtons\r\n        }], this.sanitizeID(profile), 'profiles/' + encodeURIComponent(profile), 1);\r\n        nav += '</li>';\r\n        return nav;\r\n    }\r\n\r\n    public _item(title, id, enabled) {\r\n        return `<span><input type=\"checkbox\" data-page=\"profiles/${title.toLowerCase()}\" class=\"form-check-input\" id=\"${this.sanitizeID(id)}\"${enabled ? ' checked' : ''}> ${title}</span><div class=\"form-check form-switch\"><input type=\"checkbox\" class=\"form-check-input\" id=\"${id}-switch\"${enabled ? ' checked' : ''}> ${title}</div>`;\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        if (!this.profiles) {\r\n            setTimeout(() => {\r\n                this.setBody(contents, args);\r\n            }, 100);\r\n            return;\r\n        }\r\n        if (this._errorField) {\r\n            setTimeout(() => this._errorField.focus(), 100);\r\n            window.location.hash = this._page;\r\n            return;\r\n        }\r\n        /*\r\n        args = args || {};\r\n        const scripts: HTMLScriptElement[] = this._contents.querySelectorAll('script');\r\n        for (let s = 0, sl = scripts.length; s < sl; s++) {\r\n            let script = new Function('body', 'dialog', ...Object.keys(args), scripts[s].textContent);\r\n            script.apply(client, [this._contents, this, ...Object.values(args), this]);\r\n        }\r\n        */\r\n        this._page = this.dialog.dataset.path;\r\n        if (this._page === 'profiles')\r\n            this.dialog.dataset.panel = 'left';\r\n        else\r\n            this.dialog.dataset.panel = 'right';\r\n        const pages = this._page.split('/');\r\n        let breadcrumb = '';\r\n        let last = pages.length - 1;\r\n        if (pages.length === 1)\r\n            breadcrumb += '<li><i class=\"float-start fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i></li>';\r\n        else\r\n            breadcrumb += '<li><a href=\"#' + pages.slice(0, 1).join('-') + '\"><i class=\"float-start fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i></a></li>';\r\n        if (pages.length < 4)\r\n            for (let p = 0, pl = pages.length; p < pl; p++) {\r\n                let title = capitalize(pages[p]);\r\n                if (p === last)\r\n                    breadcrumb += '<li class=\"breadcrumb-item active\">' + title + '</li>';\r\n                else\r\n                    breadcrumb += '<li class=\"breadcrumb-item\" aria-current=\"page\"><a href=\"#' + pages.slice(0, p + 1).join('/') + '\">' + title + '</a></li>';\r\n            }\r\n\r\n        let k, kl, p;\r\n        this._expandPath(pages);\r\n        this.footer.querySelector('#profile-page-buttons').innerHTML = '';\r\n        this.footer.querySelector(`#${this.id}-export-current`).style.display = '';\r\n        this.title = `<ol class=\"breadcrumb${this._small ? ' breadcrumb-sm' : ''}\" style=\"overflow: hidden;white-space: nowrap;text-overflow: ellipsis;flex-wrap: nowrap;\">${breadcrumb}</ol>`;\r\n        this._contents.scrollTop = 0;\r\n        if (!this._setCurrent(pages))\r\n            return;\r\n        if (pages.length < 2) {\r\n            this.footer.querySelector(`#${this.id}-export-current`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-sep`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-alias`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-macro`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-trigger`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-button`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-sep2`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-default-buttons`).style.display = 'none';\r\n            this.footer.querySelector(`#${this.id}-add-default-macros`).style.display = 'none';\r\n            this._splitter.panel2Collapsed = true;\r\n            this.footer.querySelector(`#${this.id}-back`).style.display = 'none';\r\n        }\r\n        else {\r\n            this.footer.querySelector(`#${this.id}-add-sep`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-alias`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-macro`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-trigger`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-button`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-back`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-sep2`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-default-buttons`).style.display = '';\r\n            this.footer.querySelector(`#${this.id}-add-default-macros`).style.display = '';\r\n            this._splitter.panel2Collapsed = false;\r\n        }\r\n        if (pages.length === 2) {\r\n            if (this._contentPage !== 'properties') {\r\n                this._loadPage('properties').then(contents => {\r\n                    this._contentPage = 'properties';\r\n                    this._setContents(contents);\r\n                    const forms = this._contents.querySelectorAll('input');\r\n                    this._contents.querySelector('#name').disabled = this._current.profileName === 'default';\r\n                    for (let f = 0, fl = forms.length; f < fl; f++)\r\n                        if (forms[f].type === 'checkbox') {\r\n                            forms[f].checked = this._current.profile[forms[f].id];\r\n                            forms[f].addEventListener('change', e => {\r\n                                const value = e.target.checked;\r\n                                if (e.target.id === 'enabled') {\r\n\r\n                                    if (!value && this.profiles.keys.filter(k => this.profiles.enabled(k)).length === 1) {\r\n                                        alert_box('Cannot disable', 'One profile must always be enabled.');\r\n                                        e.target.checked = true;\r\n                                        return;\r\n                                    }\r\n                                    this._menu.querySelector(`#enabled-${this.sanitizeID(this._current.profileName)}`).checked = value;\r\n                                    this._menu.querySelector(`#enabled-${this.sanitizeID(this._current.profileName)}-switch`).checked = value;\r\n                                    if (this._page === e.target.dataset.page)\r\n                                        this._contents.querySelector('#enabled').checked = value;\r\n                                    this.profiles.items[this._current.profileName].enabled = value;\r\n                                }\r\n                                else {\r\n                                    this._current.profile[e.target.id] = value;\r\n                                    this._menu.querySelector(`#enabled-${this.sanitizeID(this._current.profileName)}-${e.target.id.substring(6).toLowerCase()}`).checked = value;\r\n                                    this.changed = true;\r\n                                }\r\n                                this.changed = true;\r\n                            });\r\n                        }\r\n                        else {\r\n                            forms[f].value = this._current.profile[forms[f].id];\r\n                            forms[f].addEventListener('change', e => {\r\n                                const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                                if (target.id === 'name') {\r\n                                    debounce(() => {\r\n                                        let err = this._renameProfile(target.value);\r\n                                        if (err === true) {\r\n                                            forms[f].classList.remove('is-invalid');\r\n                                            this._errorField = null;\r\n                                        }\r\n                                        else {\r\n                                            forms[f].classList.add('is-invalid');\r\n                                            this._errorField = forms[f];\r\n                                            this._contents.querySelector('#name-feedback').textContent = err;\r\n                                        }\r\n                                        this._sortProfiles();\r\n                                    }, 200, 'renameProfile');\r\n                                }\r\n                                else {\r\n                                    this._current.profile[target.id] = target.value;\r\n                                    debounce(() => this._sortProfiles(), 200, 'sortProfiles');\r\n                                }\r\n                                this.changed = true;\r\n                            });\r\n                            forms[f].addEventListener('input', e => {\r\n                                const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                                if (target.id === 'name') {\r\n                                    debounce(() => {\r\n                                        let err = this._renameProfile(target.value);\r\n                                        if (err === true) {\r\n                                            forms[f].classList.remove('is-invalid');\r\n                                            this._errorField = null;\r\n                                        }\r\n                                        else {\r\n                                            forms[f].classList.add('is-invalid');\r\n                                            this._errorField = forms[f];\r\n                                            this._contents.querySelector('#name-feedback').textContent = err;\r\n                                        }\r\n                                        this._sortProfiles();\r\n                                    }, 200, 'renameProfile');\r\n                                }\r\n                                else {\r\n                                    this._current.profile[target.id] = target.value;\r\n                                    debounce(() => this._sortProfiles(), 200, 'sortProfiles');\r\n                                }\r\n                                this.changed = true;\r\n                            });\r\n                        }\r\n                }\r\n                ).catch(() => {\r\n                });\r\n            }\r\n            else {\r\n                this._contents.querySelector('#name').disabled = this._current.profileName === 'default';\r\n                const forms = this._contents.querySelectorAll('input');\r\n                for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                    if (forms[f].type === 'checkbox')\r\n                        forms[f].checked = this._current.profile[forms[f].id];\r\n                    else\r\n                        forms[f].value = this._current.profile[forms[f].id];\r\n                }\r\n            }\r\n            if (this._current.profileName !== 'default') {\r\n                let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove profile\"><i class=\"bi bi-trash\"></i></button>`;\r\n                this.footer.querySelector('#profile-page-buttons').innerHTML = b;\r\n                this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', (e: MouseEvent) => {\r\n                    if (this._errorField)\r\n                        this._errorField = null;\r\n                    this._deleteProfile(this._current.profileName);\r\n                });\r\n            }\r\n        }\r\n        else if (pages.length === 3) {\r\n            let pp = '';\r\n            if (this._current.item.length === 0) {\r\n                p = '<h1 id=\"empty\" style=\"width: 100%;text-align:center\">No ' + this._current.collection + '.</h1>';\r\n                p += `<button id=\"${this.id}-add-contents\" type=\"button\" class=\"btn-sm float-start btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\"><i class=\"bi bi-plus-lg\"></i> Add ${this._getItemType()}</button>`\r\n            }\r\n            else {\r\n                p = '';\r\n                for (k = 0, kl = this._current.item.length; k < kl; k++) {\r\n                    p += `<a data-profile =\"${this._current.profileName}\" id=\"item-${k}\" data-index=\"${k}\" href=\"#profiles/${encodeURIComponent(this._current.profileName)}/${this._current.collection}/${k}\" class=\"list-group-item list-group-item-action\">`\r\n                    p += `<span data-index=\"${k}\" class=\"list-badge-button badge text-bg-danger\"><i class=\"bi bi-trash\"></i></span>`;\r\n                    p += `<div class=\"form-check-inline form-switch\" style=\"margin: 0;\">`;\r\n                    p += `<input type=\"checkbox\" class=\"form-check-input\" id=\"check-${k}\" data-profile=\"${this._current.profileName}\" data-index=\"${k}\" data-field=\"enabled\" data-items=\"${this._current.collection}\"${this._current.item[k].enabled ? ' checked=\"checked\"' : ''}>`\r\n                    p += `</div>${htmlEncode(GetDisplay(this._current.item[k]))}</a>`;\r\n                }\r\n                pp = `<button id=\"${this.id}-add-contents\" type=\"button\" class=\"btn-sm btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\" style=\"margin-bottom: 5px;width:100%;\"><i class=\"bi bi-plus-lg\"></i> Add ${this._getItemType()}</button>`;\r\n            }\r\n            let b = `<button id=\"${this.id}-add\" type=\"button\" class=\"btn-sm float-start btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\"><i class=\"bi bi-plus-lg\"></i></button>`;\r\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\r\n            this._setContents(pp + '<div class=\"list-group\">' + p + '</div>');\r\n            let items = this._contents.querySelectorAll('.list-badge-button');\r\n            for (let i = 0, il = items.length; i < il; i++)\r\n                items[i].addEventListener('click', e => {\r\n                    this._removeItem(+e.target.parentElement.dataset.index);\r\n                    e.stopPropagation();\r\n                    e.cancelBubble = true;\r\n                    e.preventDefault();\r\n                });\r\n            this._contentPage = null;\r\n            this.footer.querySelector(`#${this.id}-add`).addEventListener('click', () => {\r\n                this._addItem();\r\n            });\r\n            if (this._contents.querySelector(`#${this.id}-add-contents`))\r\n                this._contents.querySelector(`#${this.id}-add-contents`).addEventListener('click', () => {\r\n                    this._addItem();\r\n                });\r\n\r\n            items = this._contents.querySelectorAll('input');\r\n            for (let i = 0, il = items.length; i < il; i++)\r\n                items[i].addEventListener('change', (e: MouseEvent) => {\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    const value = target.checked;\r\n                    this._menu.querySelector(`#enabled-${this.sanitizeID(this._current.profileName)}-${this._current.collection}-${target.dataset.index}`).checked = value;\r\n                    this._current.profile[this._current.collection][+target.dataset.index].enabled = value;\r\n                    this.changed = true;\r\n                });\r\n\r\n        }\r\n        else if (pages.length === 4) {\r\n            let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove ${this._getItemType()}\"><i class=\"bi bi-trash\"></i></button>`;\r\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\r\n            this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', e => {\r\n                this._removeItem(this._current.itemIdx, 0, true);\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n                e.preventDefault();\r\n            });\r\n            for (let p = 0, pl = pages.length; p < pl; p++) {\r\n                if (p === last)\r\n                    breadcrumb += '<li class=\"breadcrumb-item active\">' + htmlEncode(GetDisplay(this._current.item)) + '</li>';\r\n                else\r\n                    breadcrumb += '<li class=\"breadcrumb-item\" aria-current=\"page\"><a href=\"#' + pages.slice(0, p + 1).join('/') + '\">' + capitalize(pages[p]) + '</a></li>';\r\n            }\r\n            this.title = `<ol class=\"breadcrumb${this._small ? ' breadcrumb-sm' : ''}\" style=\"overflow: hidden;white-space: nowrap;text-overflow: ellipsis;flex-wrap: nowrap;\">${breadcrumb}</ol>`;\r\n            if (this._contentPage !== this._current.collection) {\r\n                this._contentPage = this._current.collection;\r\n                this._loadPage(this._current.collection).then(contents => {\r\n                    this._setContents(contents);\r\n                    this._loadItem(true);\r\n                }).catch(() => { });\r\n            }\r\n            else\r\n                this._loadItem();\r\n\r\n        }\r\n        else if (pages.length === 5) {\r\n            let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove ${this._getItemType()}\"><i class=\"bi bi-trash\"></i></button>`;\r\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\r\n            this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', e => {\r\n                this._removeItem(this._current.itemIdx, 0, true);\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n                e.preventDefault();\r\n            });\r\n            let last = pages.length - 1;\r\n            for (let p = 0, pl = pages.length; p < pl; p++) {\r\n                if (p === last - 1)\r\n                    breadcrumb += '<li class=\"breadcrumb-item\"><a href=\"#' + pages.slice(0, p + 1).join('/') + '\">' + htmlEncode(GetDisplay(this._current.parent)) + '</a></li>';\r\n                else if (p === last)\r\n                    breadcrumb += '<li class=\"breadcrumb-item active\">' + htmlEncode(GetDisplay(this._current.item)) + '</li>';\r\n                else\r\n                    breadcrumb += '<li class=\"breadcrumb-item\" aria-current=\"page\"><a href=\"#' + pages.slice(0, p + 1).join('/') + '\">' + capitalize(pages[p]) + '</a></li>';\r\n            }\r\n            this.title = `<ol class=\"breadcrumb${this._small ? ' breadcrumb-sm' : ''}\" style=\"overflow: hidden;white-space: nowrap;text-overflow: ellipsis;flex-wrap: nowrap;\">${breadcrumb}</ol>`;\r\n            if (this._contentPage !== this._current.collection) {\r\n                this._contentPage = this._current.collection;\r\n                this._loadPage(this._current.collection).then(contents => this._setContents(contents)).catch(() => {\r\n                    this._loadItem(true);\r\n                });\r\n            }\r\n            else\r\n                this._loadItem();\r\n        }\r\n        else {\r\n            let b = `<button id=\"btn-${this.id}-add-profile\" type=\"button\" class=\"btn-sm btn btn-outline-secondary\" title=\"Add profile\"><i class=\"bi bi-plus-lg\"></i></button>`;\r\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\r\n            this.footer.querySelector(`#btn-${this.id}-add-profile`).addEventListener('click', () => {\r\n                this._createProfile(true);\r\n            });\r\n            this._contentPage = null;\r\n            this._setContents('');\r\n        }\r\n    }\r\n\r\n    private _setCurrent(pages) {\r\n        if (!pages)\r\n            return false;\r\n        this._current.itemIdx = this._current.itemSubIdx = -1;\r\n        this._current.parent = null;\r\n        if (pages.length > 1) {\r\n            this._current.profileName = pages[1];\r\n            if (!this.profiles.contains(this._current.profileName)) {\r\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Profile ${this._current.profileName} not found.</h1>`);\r\n                this._contentPage = null;\r\n                return false;\r\n            }\r\n            this._current.profile = this.profiles.items[this._current.profileName];\r\n        }\r\n        if (pages.length > 2) {\r\n            this._current.collection = pages[2];\r\n            if (!this._current.profile[this._current.collection]) {\r\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">${capitalize(this._current.collection)} not found in ${this._current.profileName}.</h1>`);\r\n                this._contentPage = null;\r\n                return false;\r\n            }\r\n            this._current.item = this._current.profile[pages[2]];\r\n        }\r\n        if (pages.length > 3) {\r\n            this._current.itemIdx = +pages[3];\r\n            if (this._current.itemIdx < 0 || this._current.itemIdx >= this._current.item.length) {\r\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">${capitalize(this._getItemType())} not found.</h1>`);\r\n                this._contentPage = null;\r\n                return;\r\n            }\r\n            this._current.item = this._current.profile[pages[2]][this._current.itemIdx];\r\n        }\r\n        if (pages.length > 4) {\r\n            this._current.itemSubIdx = +pages[4];\r\n            if (!this._current.item.triggers) {\r\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Invalid trigger.</h1>`);\r\n                this._contentPage = null;\r\n                return;\r\n            }\r\n            if (this._current.itemSubIdx < 0 || this._current.itemSubIdx >= this._current.item.triggers.length) {\r\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Trigger state not found.</h1>`);\r\n                this._contentPage = null;\r\n                return;\r\n            }\r\n            this._current.parent = this._current.item;\r\n            this._current.item = this._current.item.triggers[this._current.itemSubIdx];\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private _loadPage(page) {\r\n        return new Promise((resolve, reject) => {\r\n            $.ajax({\r\n                url: 'dialogs/profiles-' + page + '.htm',\r\n                cache: false,\r\n                type: 'GET',\r\n            })\r\n                .done((data) => {\r\n                    data = data.replace(/{profileURL}/g, encodeURIComponent(this._current.profileName)).replace(/{profile}/g, this._current.profileName)\r\n                    resolve(data);\r\n                })\r\n                .fail(function () {\r\n                    reject('');\r\n                });\r\n        });\r\n    }\r\n\r\n    private _setContents(contents) {\r\n        this._contents.innerHTML = contents;\r\n        const scripts: HTMLScriptElement[] = this._contents.querySelectorAll('script');\r\n        const args = {\r\n            client: client,\r\n            item: this._current.item,\r\n            FilterArrayByKeyValue: FilterArrayByKeyValue,\r\n            keyCharToCode: keyCharToCode,\r\n            keyCodeToChar: keyCodeToChar,\r\n            profile: this._current.profile,\r\n            profileName: this._current.profileName,\r\n            parent: this._current.parent,\r\n            current: this._current,\r\n            GetDisplay: GetDisplay,\r\n            Trigger: Trigger,\r\n            debounce: debounce,\r\n            updateHash: updateHash,\r\n            DialogButtons: DialogButtons\r\n        };\r\n        this.emit('content-changing');\r\n        for (let s = 0, sl = scripts.length; s < sl; s++) {\r\n            /*jslint evil: true */\r\n            let script = new Function('body', 'dialog', ...Object.keys(args), 'try { ' + scripts[s].textContent + '}catch(e){client.error(e)}');\r\n            script.apply(client, [this._contents, this, ...Object.values(args), this]);\r\n        }\r\n        this.emit('content-changed');\r\n    }\r\n\r\n    private _loadItem(events?) {\r\n        const forms: HTMLInputElement[] = this._contents.querySelectorAll('input,select,textarea');\r\n\r\n        for (let f = 0, fl = forms.length; f < fl; f++) {\r\n            if (!(forms[f].id in this._current.item) && forms[f].dataset.enum !== 'true')\r\n                continue;\r\n            if (forms[f].type === 'checkbox') {\r\n                if (forms[f].dataset.enum === 'true') {\r\n                    const name = forms[f].name || forms[f].id.substring(0, forms[f].id.lastIndexOf('-'));\r\n                    const value = +forms[f].id.substring(forms[f].id.lastIndexOf('-') + 1);\r\n                    forms[f].checked = (this._current.item[name] & value) === value;\r\n                }\r\n                else\r\n                    forms[f].checked = this._current.item[forms[f].id];\r\n                if (events)\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.style.display === 'none') return;\r\n                        if (target.dataset.enum === 'true') {\r\n                            const name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\r\n                            const enums = this.body.querySelectorAll(`[name=${name}]`);\r\n                            let value = 0;\r\n                            for (let e = 0, el = enums.length; e < el; e++) {\r\n                                if (enums[e].checked)\r\n                                    value |= +enums[e].value;\r\n                            }\r\n                            this._current.item[name] = value;\r\n                        }\r\n                        else {\r\n                            this._current.item[target.id] = target.checked || false;\r\n                            if (target.id === 'enabled')\r\n                                this._menu.querySelector(`#enabled-${this.sanitizeID(this._current.profileName)}-${this._current.collection}-${this._current.itemIdx}`).checked = this._current.item[target.id];\r\n                        }\r\n                        this.changed = true;\r\n                        this._updateItemMenu();\r\n                    });\r\n            }\r\n            else {\r\n                forms[f].value = this._current.item[forms[f].id];\r\n                if (events) {\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.style.display === 'none') return;\r\n                        this.setValue(this._current.item, target.id, target.value);\r\n                        this.changed = true;\r\n                        this._updateItemMenu();\r\n                    });\r\n                    forms[f].addEventListener('input', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.style.display === 'none') return;\r\n                        this.setValue(this._current.item, target.id, target.value);\r\n                        this.changed = true;\r\n                        this._updateItemMenu();\r\n                    });\r\n                }\r\n                let c = this.changed;\r\n                forms[f].dispatchEvent(new Event('change'));\r\n                this.changed = c;\r\n            }\r\n        }\r\n        this.emit('item-loaded', this._current);\r\n    }\r\n\r\n    private _updateItemMenu(currentItem?, profile?, collection?, index?) {\r\n        profile = profile || this._current.profileName;\r\n        collection = collection || this._current.collection;\r\n        if (typeof index !== 'number')\r\n            index = this._current.itemIdx;\r\n        const currentParent = this._current.parent;\r\n        currentItem = currentItem || this._current.item;\r\n        debounce(() => {\r\n            let item = this.body.querySelector(`#${this.sanitizeID(profile)}-${collection}-${index}`);\r\n            if (!item) return;\r\n            let display\r\n            display = GetDisplay(currentParent || currentItem);\r\n            item.title = display;\r\n            item.firstChild.childNodes[2].textContent = ' ' + display;\r\n            let bc = this.header.querySelector('ol').children;\r\n            if (bc.length > 4) {\r\n                if (bc[4].children.length)\r\n                    bc[4].children[0].textContent = display;\r\n                else\r\n                    bc[4].textContent = display;\r\n            }\r\n            if (bc.length > 5) {\r\n                bc[5].textContent = GetDisplay(currentItem);\r\n            }\r\n        }, 200, 'updateItemMenu');\r\n    }\r\n\r\n    private _expandPath(pages, select?) {\r\n        if (!Array.isArray(pages))\r\n            pages = pages.split('/');\r\n        let id;\r\n        let el;\r\n        let expand;\r\n        let po = 0;\r\n        if (pages[0] === 'profiles')\r\n            po = 1;\r\n        let last = pages.length - 1;\r\n        for (let p = po, pl = pages.length; p < pl; p++) {\r\n            id = this.sanitizeID(pages.slice(po, p + 1).join('-'));\r\n            el = document.getElementById(id);\r\n            if (!el) continue;\r\n            if (p === last) {\r\n                setTimeout(() => {\r\n                    const items = this._menu.querySelectorAll('.active');\r\n                    for (let i = 0, il = items.length; i < il; i++)\r\n                        items[i].classList.remove('active');\r\n                    scrollChildIntoView(this._menu, el);\r\n                    el.classList.add('active');\r\n                    if (select)\r\n                        el.firstChild.click();\r\n                }, 100);\r\n            }\r\n            else {\r\n                expand = el.querySelector('.dropdown-menu');\r\n                if (!expand || expand.classList.contains('show')) continue;\r\n                el = el.querySelector('i');\r\n                if (el) {\r\n                    el.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\r\n                    el.classList.toggle('bi-chevron-right');\r\n                    el.classList.toggle('bi-chevron-down');\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private _goBack() {\r\n        if (this._errorField) {\r\n            this._errorField.focus();\r\n            return;\r\n        }\r\n        const pages = this._page.split('/');\r\n        if (pages.length === 5)\r\n            updateHash(pages.slice(0, pages.length - 2).join('/'), this._page);\r\n        else\r\n            updateHash(pages.slice(0, pages.length - 1).join('/'), this._page);\r\n    }\r\n\r\n    private _createProfile(defaults: boolean) {\r\n        let i = this.profiles.length;\r\n        let name = 'NewProfile' + i;\r\n        while (this.profiles.contains(name)) {\r\n            i++;\r\n            name = 'NewProfile' + i\r\n        }\r\n        const profile = new Profile(name, defaults);\r\n        name = name.toLowerCase();\r\n        this.profiles.add(profile);\r\n        this.profiles.SortByPriority();\r\n        let menuItem = this._profile(name);\r\n        i = this.profiles.keys.indexOf(name);\r\n        const menu = document.getElementById('profile-menu');\r\n        if (i === -1 || i >= menu.children.length)\r\n            i = menu.children.length - 1;\r\n        if (i < 0) i = 0;\r\n        menu.children[i].insertAdjacentHTML(\"afterend\", menuItem);\r\n        this._profileEvents(menu.children[i + 1]);\r\n        this.changed = true;\r\n        updateHash('profiles/' + name, this._page);\r\n    }\r\n\r\n    private _deleteProfile(profile) {\r\n        if (!profile) return false;\r\n        confirm_box('Remove profile?', `Delete \"${profile}\"?`).then(e => {\r\n            if (e.button === DialogButtons.Yes) {\r\n                this.profiles.remove(profile);\r\n                this._menu.querySelector('#' + profile).remove();\r\n                if (this._page.startsWith('profiles/' + profile))\r\n                    updateHash('profiles', this._page);\r\n                this.changed = true;\r\n            }\r\n        });\r\n    }\r\n\r\n    private _renameProfile(name, oldProfile?) {\r\n        if (!name) return 'Name can not be empty!';\r\n        oldProfile = (oldProfile || this._current.profileName).toLowerCase();\r\n        name = name.toLowerCase();\r\n        if (name === oldProfile) return true;\r\n        if (this.profiles.contains(name))\r\n            return 'A profile named ' + name + ' already exists!';\r\n        this.profiles.remove(oldProfile);\r\n        this._current.profile.name = name;\r\n        this._current.profileName = name;\r\n        this.profiles.add(this._current.profile);\r\n        const oldID = this.sanitizeID(oldProfile);\r\n        const newID = this.sanitizeID(name);\r\n        let items;\r\n        items = this.body.querySelector(`#${oldID} a`);\r\n        items.children[2].childNodes[1].textContent = ' ' + capitalize(name);\r\n        document.querySelector(`#${oldID} a`).children[3].childNodes[1].textContent = ' ' + capitalize(name);\r\n        items = this.body.querySelector(`#${oldID}`);\r\n        items.id = newID;\r\n        items.title = name;\r\n        this._replaceProfileName(this._menu.firstChild, oldProfile, name);\r\n        this._replaceProfileName(this._contents, oldProfile, name);\r\n        this.header.querySelector('ol').children[2].textContent = capitalize(name);\r\n        return true;\r\n    }\r\n\r\n    private _replaceProfileName(container, oldName, newName) {\r\n        let items;\r\n        let i, il;\r\n        const oldID = this.sanitizeID(oldName);\r\n        const newID = this.sanitizeID(newName);\r\n        items = container.querySelectorAll(`[id*=\"-${oldID}-\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].id = items[i].id.replace(`-${oldID}-`, `-${newID}-`);\r\n        items = container.querySelectorAll(`[id$=\"-${oldID}\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].id = items[i].id.replace(`-${oldID}`, `-${newID}`);\r\n        items = container.querySelectorAll(`[id^=\"${oldID}-\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].id = items[i].id.replace(`${oldID}-`, `${newID}-`);\r\n        items = container.querySelectorAll(`[data-profile=\"${oldID}\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].dataset.profile = newID;\r\n        const oldPath = encodeURIComponent(oldName);\r\n        const newPath = encodeURIComponent(newName);\r\n        items = container.querySelectorAll(`[href*=\"/${oldPath}/\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].href = items[i].getAttribute('href').replace(`/${oldPath}/`, `/${newPath}/`);\r\n        items = container.querySelectorAll(`[href$=\"/${oldPath}\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].href = items[i].getAttribute('href').replace(`/${oldPath}`, `/${newPath}`);\r\n        items = container.querySelectorAll(`[href^=\"${oldPath}/\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].href = items[i].getAttribute('href').replace(`${oldPath}/`, `${newPath}/`);\r\n        items = container.querySelectorAll(`[data-path*=\"/${oldPath}/\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].dataset.path = items[i].dataset.path.replace(`/${oldPath}`, `/${newPath}`);\r\n        items = container.querySelectorAll(`[data-page*=\"/${oldPath}/\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].dataset.page = items[i].dataset.page.replace(`/${oldPath}/`, `/${newPath}/`);\r\n        items = container.querySelectorAll(`[data-page$=\"/${oldPath}\"]`);\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].dataset.page = items[i].dataset.page.replace(`/${oldPath}`, `/${newPath}`);\r\n    }\r\n\r\n    private _sortProfiles() {\r\n        this.profiles.SortByPriority();\r\n        const menu = this._menu.firstChild;\r\n        const items = Array.from(menu.children);\r\n        items.sort((a: HTMLElement, b: HTMLElement) => {\r\n            let ap = this.profiles.items[a.dataset.profile].priority\r\n            let bp = this.profiles.items[b.dataset.profile].priority\r\n            if (ap > bp)\r\n                return -1;\r\n            if (ap < bp)\r\n                return 1;\r\n            if (a.dataset.profile === 'default')\r\n                return -1;\r\n            if (b.dataset.profile === 'default')\r\n                return 1;\r\n            ap = a.dataset.profile;\r\n            bp = b.dataset.profile;\r\n            if (ap > bp)\r\n                return 1;\r\n            if (ap < bp)\r\n                return -1;\r\n            return 0;\r\n        })\r\n\r\n        items.forEach(item => menu.appendChild(item));\r\n    }\r\n\r\n    private _save() {\r\n        if (!this.changed) return true;\r\n        if (this._errorField) {\r\n            this._errorField.focus();\r\n            return false;\r\n        }\r\n        this.profiles.save().then(() => {\r\n            client.loadProfiles().then(() => {\r\n\r\n            });\r\n        })\r\n        this.changed = false;\r\n        return true;\r\n    }\r\n\r\n    public close() {\r\n        if (!this._canClose) {\r\n            this.confirmSave().then(r => {\r\n                if (r)\r\n                    if (!this._save()) return;\r\n                this._canClose = true;\r\n                this.close();\r\n            }).catch(() => {\r\n                this._canClose = false;\r\n            });\r\n        }\r\n        else\r\n            super.close();\r\n    }\r\n\r\n    public reload() {\r\n        if (!this._setCurrent(this._page.split('/')))\r\n            return\r\n        this._loadItem();\r\n        this._updateItemMenu();\r\n    }\r\n\r\n    private confirmSave() {\r\n        return new Promise((resolve, reject) => {\r\n            if (this._profilesChanged) {\r\n                confirm_box('Save changes?', `Save changes to profiles?`, null, DialogButtons.YesNo | DialogButtons.Cancel).then(e => {\r\n                    if (e.button === DialogButtons.Yes)\r\n                        resolve(true);\r\n                    else if (e.button === DialogButtons.No)\r\n                        resolve(false);\r\n                    else\r\n                        reject();\r\n                }).catch(e => {\r\n                    reject();\r\n                });\r\n            }\r\n            else\r\n                resolve(true);\r\n        });\r\n    }\r\n\r\n    private sanitizeID(name) {\r\n        return name.toLowerCase().replace(/[^a-z0-9:.-]+/gi, '_');\r\n    }\r\n\r\n    private _getItemType(collection?) {\r\n        collection = collection || this._current.collection;\r\n        if (!collection) return;\r\n        if (collection === 'aliases') return 'alias';\r\n        return collection.substring(0, collection.length - 1);\r\n    }\r\n\r\n    private _addItem(collection?, item?) {\r\n        if (!collection) collection = this._current.collection;\r\n        if (!collection) return;\r\n        var index = this._current.profile[collection].length;\r\n        let menuItem;\r\n        if (!item) {\r\n            if (collection === 'aliases')\r\n                item = new Alias();\r\n            else if (collection === 'triggers')\r\n                item = new Trigger();\r\n            else if (collection === 'buttons')\r\n                item = new Button();\r\n            else if (collection === 'macros')\r\n                item = new Macro();\r\n            else if (collection === 'context')\r\n                item = new Context();\r\n        }\r\n        this._current.profile[collection].push(item);\r\n        let m = this._menu.querySelector(`#${this.sanitizeID(this._current.profileName)}-${collection}`);\r\n        if (index === 0) {\r\n            menuItem = this._getItem([{\r\n                name: capitalize(collection),\r\n                items: this._current.profile[collection],\r\n                useName: true,\r\n                enabled: this._current.profile[collection],\r\n            }], 0, this.sanitizeID(this._current.profileName), 'profiles/' + encodeURIComponent(this._current.profileName), 1);\r\n            var newNode = document.createElement('div');\r\n            newNode.innerHTML = menuItem;\r\n            if (m.replaceWith)\r\n                m.replaceWith(newNode.firstChild);\r\n            else if (m.replaceChild)\r\n                m.parentNode.replaceChild(newNode.firstChild, m);\r\n            else\r\n                m.outerHTML = menuItem;\r\n            m = this._menu.querySelector(`#${this.sanitizeID(this._current.profileName)}-${collection}`);\r\n            this._profileEvents(m);\r\n        }\r\n        else {\r\n            menuItem = this._getItem(this._current.profile[collection], index, `${this.sanitizeID(this._current.profileName)}-${collection}`, `profiles/${encodeURIComponent(this._current.profileName)}/${collection}`, 2);\r\n            m = m.querySelector('ul');\r\n            m.insertAdjacentHTML(\"beforeend\", menuItem);\r\n            m = this._menu.querySelector(`#${this.sanitizeID(this._current.profileName)}-${collection}`);\r\n            this._profileEvents(m.lastChild);\r\n        }\r\n        updateHash(`profiles/${encodeURIComponent(this._current.profileName)}/${collection}/${index}`, this._page);\r\n        this.changed = true;\r\n    }\r\n\r\n    private _removeItem(index, collection?, back?) {\r\n        if (!collection) collection = this._current.collection;\r\n        if (!collection) return;\r\n        confirm_box('Remove profile?', `Delete ${this._getItemType()}?`).then(e => {\r\n            if (e.button === DialogButtons.Yes) {\r\n                const id = `${this.sanitizeID(this._current.profileName)}-${collection}`;\r\n                const items = this._current.profile[collection];\r\n                items.splice(index, 1);\r\n                this._menu.querySelector(`#${id}-${index}`).remove();\r\n                if (this._current.itemIdx === -1)\r\n                    this.setBody(this._page);\r\n\r\n\r\n                if (items.length === 0) {\r\n                    this._menu.querySelector(`#${id} i`).remove();\r\n                    this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\r\n                }\r\n                else {\r\n                    const menuItems = this._menu.querySelector(`#${id} ul`);\r\n                    let i = menuItems.children.length;\r\n                    const href = `#profiles/${encodeURIComponent(this._current.profileName)}/${collection}/`;\r\n                    for (; index < i; index++) {\r\n                        const item = menuItems.children[index];\r\n                        item.id = `${id}-${index}`;\r\n                        item.firstChild.href = `${href}${index}`;\r\n                        item.firstChild.children[1].id = `enabled-${id}-${index}`;\r\n                    }\r\n                }\r\n                this.changed = true;\r\n                if (back)\r\n                    this._goBack();\r\n            }\r\n        });\r\n    }\r\n\r\n    public setValue(obj, prop, value) {\r\n        if (value == 'false') value = false;\r\n        if (value == 'true') value = true;\r\n        if (value == 'null') value = null;\r\n        if (value == 'undefined') value = undefined;\r\n        if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n            value = parseFloat(value);\r\n        obj[prop] = this.convertType(value, typeof obj[prop]);\r\n    }\r\n\r\n    public convertType(value, type) {\r\n        if (typeof value === type)\r\n            return value;\r\n        switch (type) {\r\n            case 'number':\r\n                if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n                    return parseFloat(value);\r\n                return Number(value);\r\n            case 'boolean':\r\n                return Boolean(value);\r\n            case 'string':\r\n                return '' + value;\r\n        }\r\n        return value;\r\n    }\r\n\r\n}\r\n\r\nexport function GetDisplay(arr) {\r\n    if (arr.displaytype === 1) {\r\n        /*jslint evil: true */\r\n        const f = new Function('item', 'keyCodeToChar', 'MacroDisplay', arr.display);\r\n        return f(arr, keyCodeToChar, MacroDisplay);\r\n    }\r\n    if ($.isFunction(arr.display))\r\n        return arr.display(arr);\r\n    if ($.isFunction(arr[arr.display]))\r\n        return arr[arr.display](arr);\r\n    if (!arr[arr.display])\r\n        return arr['name'];\r\n    return arr[arr.display];\r\n}", "import { EventEmitter } from \"../events\";\r\nimport { MenuItem } from \"../types\";\r\n\r\nexport class Contextmenu extends EventEmitter {\r\n    private _items: MenuItem[];\r\n    private _menu;\r\n    private _id;\r\n\r\n    constructor(items?: MenuItem[], id?) {\r\n        super();\r\n        this._items = items || [];\r\n        this._id = id || new Date().getTime();\r\n        this._createMenu();\r\n    }\r\n\r\n    private _createMenu() {\r\n        if (!this._menu) {\r\n            let menu: any = `<ul id=\"${this._id}\" class=\"dropdown-menu show\">`;\r\n            for (var i = 0, il = this._items.length; i < il; i++) {\r\n                menu += `<li><a class=\"dropdown-item\" data-index=\"${i}\" href=\"#\">${this._items[i].name}</a></li>`;\r\n            }\r\n            menu += '</ul>';\r\n            document.body.insertAdjacentHTML('afterend', menu);\r\n            this._menu = document.getElementById(this._id);\r\n        }\r\n        let items = this._menu.querySelectorAll('li a');\r\n        for (let i = 0, il = items.length; i < il; i++) {\r\n            items[i].addEventListener('click', e => {\r\n                let index = +e.currentTarget.dataset.index;\r\n                if (typeof this._items[index].action === 'function')\r\n                    (this._items[index].action as any)(this._items[i], e);\r\n                this._cleanUp();\r\n            });\r\n        }\r\n    }\r\n\r\n    private _cleanUp = () => {\r\n        window.removeEventListener('click', this._cleanUp);\r\n        window.removeEventListener('mousedown', this._mouseup);\r\n        window.removeEventListener('keydown', this._cleanUp);\r\n        if (this._menu)\r\n            this._menu.remove();\r\n    }\r\n    private _mouseup = e => {\r\n        if(this._menu.contains(e.srcElement)) return;\r\n        this._cleanUp()\r\n    }\r\n\r\n    public close() {\r\n        this._cleanUp();\r\n    }\r\n\r\n    public show(x, y) {\r\n        this._menu.style.left = x + 'px';\r\n        this._menu.style.top = y + 'px';\r\n        this._menu.style.display = 'block';\r\n        this._menu.style.position = 'absolute';\r\n        setTimeout(() => {\r\n            window.addEventListener('click', this._cleanUp);\r\n            window.addEventListener('mousedown', this._mouseup);\r\n            window.addEventListener('keydown', this._cleanUp);\r\n        }, 100);\r\n    }\r\n\r\n    static popup(items, x, y) {\r\n        new Contextmenu(items).show(x, y);\r\n    }\r\n}", "import \"../css/interface.css\";\nimport { initMenu } from './menu';\nimport { Client } from '../client';\nimport { Dialog, DialogButtons } from \"./dialog\";\nimport { openFileDialog, readFile, debounce, copyText, pasteText, setSelectionRange, offset } from '../library';\nimport { AdvEditor } from './adv.editor';\nimport { SettingsDialog } from './settingsdialog';\nimport { ProfilesDialog } from \"./profilesdialog\";\nimport { Contextmenu } from './contextmenu';\nimport \"../css/buttons.css\";\ndeclare global {\n    interface Window {\n        initializeInterface;\n        readClipboard;\n        writeClipboard;\n        readClipboardHTML;\n        doLink;\n        doMXPLink;\n        doMXPSend;\n        MXPMenuHandler;\n        doMXPTooltip;\n    }\n    let client: Client;\n}\ndeclare let confirm_box;\n\n//cache the objects once made for later use\nlet editor: AdvEditor;\nlet editorDialog: Dialog;\nlet _currentIcon = -1;\n\n//TODO these are set for context menu\nlet _selword = '';\nlet _selurl = '';\nlet _selline = '';\nlet lastMouse;\n\n//#region MXP display hooks\nfunction doLink(url) {\n    confirm_box('Open?', `Open '${url}'?`).then(e => {\n        if (e.button === DialogButtons.Yes) {\n            window.open(url);\n            if (client.getOption('CommandonClick'))\n                client.commandInput.focus();\n        }\n    });\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction doMXPLink(el, url) {\n    if (url.startsWith('OoMUD://') || url.startsWith('jiMUD://') || url.startsWith('client://'))\n        doMXPSend(0, el, url.substring(8));\n    else {\n        confirm_box('Open?', `Open '${url}'?`).then(e => {\n            if (e.button === DialogButtons.Yes) {\n                window.open(url);\n                if (client.getOption('CommandonClick'))\n                    client.commandInput.focus();\n            }\n        });\n    }\n}\n\nfunction doMXPSend(e, el, url, pmt?, tt?) {\n    var im = el.querySelector('img[ismap]');\n    var extra = '';\n    if (im) {\n        var os = offset(im);\n        var x = Math.floor(e.clientX - os.left);\n        var y = Math.floor(e.clientY - os.top);\n        extra = '?' + x + ',' + y;\n    }\n    if (url.constructor === Array || url.__proto__.constructor === Array || Object.prototype.toString.call(url) === '[object Array]') {\n        let items = [];\n        for (var i = 0, il = url.length; i < il; i++) {\n            url[i] = url[i].replace('&text;', el.textContent);\n            if (i < tt.length)\n                items.push({\n                    name: tt[i],\n                    action: item => MXPMenuHandler(item.cmd, item.pmt),\n                    pmt: pmt,\n                    cmd: url[i] + extra\n                });\n            else\n                items.push({\n                    name: url[i],\n                    action: item => MXPMenuHandler(item.cmd, item.pmt),\n                    pmt: pmt,\n                    cmd: url[i] + extra\n                });\n        }\n        Contextmenu.popup(items, e.clientX, e.clientY);\n    }\n    else if (pmt) {\n        url = url.replace('&text;', el.textContent) + extra;\n        client.commandInput.value = url;\n        setSelectionRange(client.commandInput, url.length, url.length);\n    }\n    else\n        client.send(url.replace('&text;', el.textContent) + extra + '\\n', true);\n    setTimeout(() => {\n        if (client.getOption('CommandonClick'))\n            client.commandInput.focus();\n    }, 0);\n}\n\nfunction MXPMenuHandler(cmd, pmt) {\n    if (pmt) {\n        client.commandInput.value = cmd;\n        setSelectionRange(client.commandInput, cmd.length, cmd.length);\n    }\n    else\n        client.send(cmd, true);\n    setTimeout(() => {\n        if (client.getOption('CommandonClick'))\n            client.commandInput.focus();\n    }, 0);\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction doMXPTooltip(el) {\n    el.title = el.title.replace('&text;', el.textContent);\n}\nwindow.doLink = doLink;\nwindow.doMXPLink = doMXPLink;\nwindow.doMXPSend = doMXPSend;\nwindow.MXPMenuHandler = MXPMenuHandler;\nwindow.doMXPTooltip = doMXPTooltip;\n//#endregion\n\nexport function initializeInterface() {\n    let options;\n    _setIcon(0);\n    initMenu();\n    //#region global scripting functions\n    //not supported bu add stubs to prevent errors from imported scripts\n    window.readClipboard = () => pasteText();\n    window.readClipboardHTML = () => pasteText();\n    (client as any).readClipboard = window.readClipboard;\n    (client as any).readClipboardHTML = window.readClipboardHTML;\n\n    window.writeClipboard = (txt, html) => copyText(txt);\n    (client as any).writeClipboard = window.writeClipboard;\n\n    (client as any).closeWindow = window => {\n        switch (window) {\n            case 'editor':\n            case 'help':\n            case 'about':\n                closeDialog(window);\n                break;\n            case 'profiles':\n            case 'profiles-manager':\n            case 'profile-manager':\n            case 'manager':\n                closeDialog('profiles');\n                break;\n            case 'prefs':\n            case 'options':\n            case 'preferences':\n                closeDialog('settings');\n                break;\n            case 'history':\n            case 'command-history':\n                closeDialog('history');\n                break;\n            default:\n                client.emit('close-window', window);\n                break;\n        }\n    };\n    //#endregion\n    //#region global variables for scripting\n    ['repeatnum', 'i'].forEach((a) => {\n        Object.defineProperty(window, a, {\n            get: function () {\n                if (!client) return undefined;\n                return client.repeatnum;\n            },\n            configurable: true\n        });\n    });\n\n    Object.defineProperty(window, '$selected', {\n        get: function () {\n            if (!client) return '';\n            return client.display.selection;\n        },\n        configurable: true\n    });\n\n    //Not supported but return blank to prevent errors on scripts that use it\n    Object.defineProperty(window, '$copied', {\n        get: function () {\n            return '';\n        },\n        configurable: true\n    });\n\n    Object.defineProperty(window, '$selword', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$selword'] || _selword || (lastMouse ? client.display.getWordFromPosition(lastMouse.pageX, lastMouse.pageY) : '');\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selurl', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selurl'] || _selurl || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            var parent = lastMouse.srcElement.parentNode;\n            if (parent && parent.classList && parent.classList.contains('URLLink'))\n                return parent.title;\n            else if (parent && parent.classList && parent.classList.contains('MXPLink') && parent.dataset && parent.dataset.href && parent.dataset.href.length > 0)\n                return parent.dataset.href;\n            return '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selline', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selline'] || _selline || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            var pos = client.display.getLineOffset(lastMouse.pageX, lastMouse.pageY);\n            if (pos.y < 0 || pos.y >= client.display.lines.length)\n                return '';\n            return client.display.getLineText(pos.y, true);\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedword', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$selectedword'] || _selword || (lastMouse ? client.display.getWordFromPosition(lastMouse.pageX, lastMouse.pageY) : '');\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedurl', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selectedurl'] || _selurl || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            var parent = lastMouse.srcElement.parentNode;\n            if (parent && parent.classList && parent.classList.contains('URLLink'))\n                return parent.title;\n            else if (parent && parent.classList && parent.classList.contains('MXPLink') && parent.dataset && parent.dataset.href && parent.dataset.href.length > 0)\n                return parent.dataset.href;\n            return '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedline', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selectedline'] || _selline || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            var pos = client.display.getLineOffset(lastMouse.pageX, lastMouse.pageY);\n            if (pos.y < 0 || pos.y >= client.display.lines.length)\n                return '';\n            return client.display.getLineText(pos.y, true);\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$action', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$action'] || (client.input.lastTriggerExecuted ? client.input.lastTriggerExecuted.value : '') || '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$trigger', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$trigger'] || client.input.lastTriggered || '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$caption', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$caption'] || '';\n        },\n        configurable: true\n    });\n    //#endregion\n    //#region client events\n    client.input.on('history-navigate', () => {\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n            resizeCommandInput();\n    });\n    client.on('options-loaded', () => {\n        client.commandInput.removeEventListener('input', resizeCommandInput);\n        client.commandInput.removeEventListener('change', resizeCommandInput);\n        initCommandInput();\n        updateCommandInput();\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n            resizeCommandInput();\n        if (editorDialog) {\n            editorDialog.resetState(client.getOption('windows.editor') || { center: true });\n            if (editor.simple != client.getOption('simpleEditor')) {\n                let value = '';\n                if (!editor.isSimple)\n                    value = editor.getFormattedText().replace(/(?:\\r)/g, '');\n                editor.simple = client.getOption('simpleEditor');\n                if (!editor.isSimple) {\n                    editorDialog.hideFooter();\n                    editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                }\n                else {\n                    editor.value = value;\n                    editorDialog.showFooter();\n                    editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to advanced';\n                    setTimeout(() => editor.focus(), 100);\n                }\n            }\n        }\n        if (_dialogs.history) _dialogs.history.resetState(client.getOption('windows.history') || { center: true, width: 400, height: 275 });\n        if (_dialogs.profiles) _dialogs.profiles.resetState(client.getOption('windows.profiles') || { center: true, width: 400, height: 275 });\n    });\n    client.on('set-title', title => {\n        window.document.title = title;\n    });\n    client.on('connected', () => _setIcon(1));\n    client.on('closed', () => _setIcon(0));\n    client.on('received-data', () => {\n        if (!client.active && client.connected)\n            _setIcon(2);\n    })\n    client.on('focus', () => {\n        if (client.connected)\n            _setIcon(1);\n        else\n            _setIcon(0);\n    })\n    client.on('print', () => {\n        if (!client.active && client.connected)\n            _setIcon(2);\n    });\n    client.display.on('selection-done', e => {\n        if (client.getOption('AutoCopySelectedToClipboard') && client.display.hasSelection) {\n            copyText(client.display.selection);\n            client.display.clearSelection();\n        }\n    });\n    client.on('profiles-loaded', () => {\n        buildButtons();\n    });\n    client.on('notify', (title, message, options) => {\n        if (!client.getOption('enableNotifications') || !(\"Notification\" in window)) return;\n        options = options || { silent: true };\n        if (!Object.prototype.hasOwnProperty.call(options, 'silent'))\n            options.silent = true;\n        switch (_currentIcon) {\n            case 1:\n                options.icon = options.icon || 'images/connected.png';\n                break;\n            case 2:\n                options.icon = options.icon || 'images/active.png';\n                break;\n            default:\n                options.icon = options.icon || 'images/disconnected.png';\n                break;\n        }\n        if (message) {\n            options.body = message;\n            if (options.body.length > 127)\n                options.body = options.body.substr(0, 127) + '...';\n        }\n        if (Notification.permission === 'granted') {\n            var notify = new window.Notification(title, options);\n            notify.onclick = () => {\n                client.emit('notify-clicked', title, message);\n                client.raise('notify-clicked', [title, message]);\n            };\n            notify.onclose = () => {\n                client.emit('notify-closed', title, message);\n                client.raise('notify-closed', [title, message]);\n            };\n        } else if (Notification.permission !== \"denied\") {\n            Notification.requestPermission().then((permission) => {\n                if (permission === \"granted\") {\n                    var notify = new window.Notification(title, options);\n                    notify.onclick = () => {\n                        client.emit('notify-clicked', title, message);\n                        client.raise('notify-clicked', [title, message]);\n                    };\n                    notify.onclose = () => {\n                        client.emit('notify-closed', title, message);\n                        client.raise('notify-closed', [title, message]);\n                    };\n                }\n                else\n                    client.echo('Notification permission denied.', -7, -8, true, true);\n            });\n        }\n        else\n            client.echo('Notification permission denied.', -7, -8, true, true);\n    });\n    client.on('window', (window, args, name) => {\n        switch (window) {\n            case 'editor':\n            case 'help':\n            case 'about':\n                if (args === 'close')\n                    closeDialog(window);\n                else\n                    showDialog(window);\n                break;\n            case 'profiles':\n            case 'profiles-manager':\n            case 'profile-manager':\n            case 'manager':\n                if (args === 'close')\n                    closeDialog('profiles');\n                else\n                    showDialog('profiles');\n                break;\n            case 'prefs':\n            case 'options':\n            case 'preferences':\n                if (args === 'close')\n                    closeDialog('settings');\n                else\n                    showDialog('settings');\n                break;\n            case 'history':\n            case 'command-history':\n                if (args === 'close')\n                    closeDialog('history');\n                else\n                    showDialog('history');\n                break;\n        }\n    });\n    //setup advanced editor footer button\n    document.getElementById('btn-adv-editor').addEventListener('click', e => {\n        showDialog('editor');\n    });\n    //#endregion\n    //restore advanced editor\n    options = client.getOption('windows.editor');\n    if (options && options.show)\n        document.getElementById('btn-adv-editor').click();\n    options = client.getOption('windows.history');\n    if (options && options.show)\n        showDialog('history');\n    options = client.getOption('windows.profiles');\n    if (options && options.show)\n        showDialog('profiles');\n\n    document.getElementById('btn-command-history').addEventListener('show.bs.dropdown', function () {\n        document.body.appendChild(document.getElementById('command-history-menu'));\n        let h = '';\n        const menu = document.getElementById('command-history-menu');\n        let history = client.commandHistory;\n        for (let i = 0, il = history.length; i < il; i++)\n            h += `<li id=\"command-history-item-${i}\"><a data-index=\"${i}\" class=\"dropdown-item\" href=\"javascript:void(0)\">${history[i]}</a></li>`;\n        if (history.length) {\n            h += '<li><hr class=\"dropdown-divider\"></li>';\n            h += `<li><a id=\"history-clear\" class=\"dropdown-item\" href=\"javascript:void(0)\">Clear history</a></li>`;\n        }\n        h += `<li><a id=\"history-show\" class=\"dropdown-item\" href=\"javascript:void(0)\">Show history window...</a></li>`;\n        menu.innerHTML = h;\n        if (history.length)\n            menu.querySelector('#history-clear').addEventListener('click', () => {\n                confirm_box('Clear history?', `Clear all history`).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        client.clearCommandHistory()\n                    }\n                });\n            });\n        menu.querySelector('#history-show').addEventListener('click', () => showDialog('history'));\n        const items = document.querySelectorAll('[id^=\"command-history-item\"] a');\n        for (let i = 0, il = items.length; i < il; i++) {\n            items[i].addEventListener('click', e => {\n                var cmd = client.commandHistory[parseInt((e.currentTarget as HTMLElement).dataset.index, 10)];\n                client.AddCommandToHistory(cmd);\n                client.sendCommand(cmd, null, client.getOption('allowCommentsFromCommand'));\n            });\n        }\n    });\n    document.getElementById('btn-command-history').addEventListener('hidden.bs.dropdown', function () {\n        document.getElementById('btn-command-history').parentElement.appendChild(document.getElementById('command-history-menu'));\n    });\n    client.commandInput.removeEventListener('input', resizeCommandInput);\n    client.commandInput.removeEventListener('change', resizeCommandInput);\n    initCommandInput();\n    updateCommandInput();\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n        resizeCommandInput();\n    //#region window events\n    window.addEventListener('keydown', (event) => {\n        if (event.which === 33) //page up\n            client.display.pageUp();\n        else if (event.which === 34) //page up\n            client.display.pageDown();\n    });\n\n    window.addEventListener('error', (e) => {\n        const { message, filename, lineno, colno, error } = e;\n        //not important so ignore it to prevent error spamming when reizing\n        if (message.includes(\"ResizeObserver loop completed with undelivered notifications\")) \n            return;\n        if (client) {\n            if (error)\n                client.error(error);\n            else if (message.startsWith('Uncaught Error: '))\n                client.error(`${message.substr(16)}`);\n            else\n                client.error(`${message}`);\n            if (client.getOption('enableDebug')) {\n                client.error('Url: ' + filename);\n                client.error('Line: ' + lineno);\n                client.error('Column: ' + colno);\n                client.error(error);\n            }\n        }\n        else {\n            console.error('Message: ' + message);\n            console.error('Url: ' + filename);\n            console.error('Line: ' + lineno);\n            console.error('Column: ' + colno);\n            console.error(error);\n        }\n        return true;\n    });\n\n    window.addEventListener('mousemove', event => {\n        lastMouse = event;\n    });\n    window.addEventListener('hashchange', hashChange, false);\n    window.addEventListener('load', hashChange);\n    //#endregion\n\n\n    client.on('command-history-changed', history => {\n        _loadHistory();\n    });\n    showButtons();\n}\n\nexport function removeHash(string) {\n    if (!string || string.length === 0) return;\n    string = string.trim();\n    if (string.startsWith('#'))\n        string = string.substring(1);\n    var hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => s.trim() !== string);\n    window.location.hash = hashes.join(',');\n}\n\nexport function addHash(string) {\n    if (!string || string.length === 0) return;\n    string = string.trim();\n    if (string.startsWith('#'))\n        string = string.substring(1);\n    var hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => s.trim() !== string);\n    hashes.push(string);\n    window.location.hash = hashes.join(',');\n}\n\nexport function updateHash(add: string | string[], remove?: string | string[]) {\n    if (!Array.isArray(add))\n        add = [add];\n    remove = remove || [];\n    if (!Array.isArray(remove))\n        remove = [remove];\n    //remove add, new to ensure no dups\n    remove = remove.concat(...add);\n    var hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => !remove.includes(s.trim()));\n    hashes = hashes.concat(...add);\n    window.location.hash = hashes.join(',');\n}\n\nfunction hashChange() {\n    if (!window.location.hash || window.location.hash.length < 2) return;\n    var dialogs = decodeURI(window.location.hash.substring(1)).split(',').map(s => s.trim());\n    for (let d = dialogs.length - 1; d >= 0; d--)\n        switch (dialogs[d]) {\n            case 'about':\n                showDialog('about');\n                break;\n            case 'editor':\n                document.getElementById('btn-adv-editor').click();\n                break;\n            default:\n                if (dialogs[d] === 'history' || dialogs[d].startsWith('settings') || dialogs[d].startsWith('profiles'))\n                    showDialog(dialogs[d]);\n                else\n                    client.emit('window', dialogs[d]);\n                break;\n        }\n}\n\nlet _dialogs: any = {};\nexport function showDialog(name: string) {\n    switch (name) {\n        case 'about':\n            if (!_dialogs.about) {\n                _dialogs.about = new Dialog(({ title: '<i class=\"bi-info-circle\"></i> About', noFooter: true, resizable: false, center: true, maximizable: false }));\n                _dialogs.about.on('closed', () => {\n                    delete _dialogs.about;\n                    removeHash(name);\n                });\n                _dialogs.about.on('canceled', () => {\n                    delete _dialogs.about;\n                    removeHash(name);\n                });\n            }\n            loadDialog(_dialogs.about, name, 1, true).catch(e => {\n                client.error(e);\n            });\n            return _dialogs.about;\n        case 'history':\n            if (!_dialogs.history) {\n                _dialogs.history = new Dialog(Object.assign({}, client.getOption('windows.history') || { center: true, width: 400, height: 275 }, { title: '<i class=\"bi bi-clock-history\"></i> Command history', id: 'command-history' }));\n                _dialogs.history.on('closed', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                    delete _dialogs.history;\n                    removeHash(name);\n                });\n                _dialogs.history.on('canceled', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                    removeHash('history');\n                    delete _dialogs.history;\n                    removeHash(name);\n                });\n                _dialogs.history.on('resized', e => {\n                    client.setOption('windows.history', e);\n                });\n                _dialogs.history.on('moved', e => {\n                    client.setOption('windows.history', e);\n                })\n                _dialogs.history.on('maximized', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                _dialogs.history.on('restored', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                _dialogs.history.on('shown', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                let footer = '';\n                footer += `<button id=\"${_dialogs.history.id}-clear\" type=\"button\" class=\"btn-sm float-end btn btn-danger\" title=\"Clear history\"><i class=\"bi bi-trash\"></i><span class=\"icon-only\"> Clear</span></button>`;\n                footer += `<button id=\"${_dialogs.history.id}-send\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Send\"><i class=\"bi bi-send-fill\"></i><span class=\"icon-only\"> Send</span></button>`;\n                footer += `<button id=\"${_dialogs.history.id}-refresh\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Refresh\"><i class=\"bi bi-arrow-repeat\"></i><span class=\"icon-only\"> Refresh</span></button>`\n                _dialogs.history.footer.innerHTML = footer;\n                _dialogs.history.body.innerHTML = `<select id=\"history-list\" multiple=\"multiple\" class=\"form-select\"></select>`;\n\n                _dialogs.history.body.querySelector('#history-list').addEventListener('dblclick', e => {\n                    const cmd = e.currentTarget.value;\n                    client.AddCommandToHistory(cmd);\n                    client.sendCommand(cmd, false, client.getOption('allowCommentsFromCommand'));\n                    _dialogs.history.close();\n                });\n                _dialogs.history.body.querySelector('#history-list').addEventListener('change', e => {\n                    client.setHistoryIndex(e.currentTarget.selectedIndex);\n                    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).style.display = history.length && _dialogs.history.body.querySelector('#history-list').selectedIndex !== -1 ? '' : 'none';\n                });\n\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-refresh`).addEventListener('click', () => _loadHistory())\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).addEventListener('click', () => {\n                    const list = _dialogs.history.body.querySelector('#history-list');\n                    let cmds = []\n                    for (let l = 0, ll = list.options.length; l < ll; l++) {\n                        if (list.options[l].selected) {\n                            cmds.push(list.options[l].value);\n                        }\n                    }\n                    for (let c = 0, cl = cmds.length; c < cl; c++) {\n                        client.AddCommandToHistory(cmds[c]);\n                        client.sendCommand(cmds[c], false, client.getOption('allowCommentsFromCommand'));\n                    }\n                });\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-clear`).addEventListener('click', () => {\n                    confirm_box('Clear history?', `Clear all history`).then(e => {\n                        if (e.button === DialogButtons.Yes) {\n                            client.clearCommandHistory();\n                        }\n                    });\n                });\n            }\n            _loadHistory();\n            _dialogs.history.show();\n            return _dialogs.history;\n        case 'editor':\n            if (!editorDialog) {\n                editorDialog = new Dialog(Object.assign({}, client.getOption('windows.editor') || { center: true }, { title: '<i class=\"fas fa-edit\"></i> Advanced editor', id: 'adv-editor' }));\n                editorDialog.on('resized', e => {\n                    client.setOption('windows.editor', e);\n                });\n                editorDialog.on('moved', e => {\n                    client.setOption('windows.editor', e);\n                })\n                editorDialog.on('maximized', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                });\n                editorDialog.on('restored', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                });\n                editorDialog.on('shown', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    editor.initialize();\n                });\n                editorDialog.on('closing', () => {\n                    editor.remove();\n                });\n                editorDialog.on('closed', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    removeHash('editor');\n                });\n                editorDialog.on('canceling', () => {\n                    editor.remove();\n                });\n                editorDialog.on('canceled', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    removeHash('editor');\n                });\n                editorDialog.on('focus', () => editor.focus());\n                const textarea = document.createElement('textarea');\n                textarea.classList.add('form-control', 'form-control-sm');\n                textarea.id = 'adv-editor-txt';\n                editorDialog.body.appendChild(textarea);\n                editorDialog.body.style.overflow = 'hidden';\n                if (!editor) editor = new AdvEditor(textarea, !client.getOption('simpleEditor'));\n                editor.on('close', () => {\n                    editorDialog.close();\n                });\n                editor.on('editor-init', () => editor.focus());\n                editor.on('click', () => editorDialog.focus());\n                editorDialog.dialog.editor = editor;\n                if (TINYMCE && tinymce)\n                    editorDialog.header.querySelector('#adv-editor-max').insertAdjacentHTML('afterend', '<button type=\"button\" class=\"btn btn-light float-end\" id=\"adv-editor-switch\" title=\"Switch to advanced\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-shuffle\"></i></button>');\n                editorDialog.footer.innerHTML = `<button id=\"btn-adv-editor-clear\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Clear editor\"><i class=\"bi bi-journal-x\"></i><span class=\"icon-only\"> Clear</span></button>\n                    <button id=\"btn-adv-editor-append\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Append file...\"><i class=\"bi bi-box-arrow-in-down\"></i><span class=\"icon-only\"> Append file...</span></button>\n                    <button id=\"btn-adv-editor-send\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Send\"><i class=\"bi bi-send-fill\"></i><span class=\"icon-only\"> Send</span></button>`;\n                if (!editor.isSimple)\n                    editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                editorDialog.header.querySelector('#adv-editor-switch').addEventListener('click', () => {\n                    client.setOption('simpleEditor', !editor.simple);\n                    let value = '';\n                    if (!editor.isSimple)\n                        value = editor.getFormattedText().replace(/(?:\\r)/g, '');\n                    editor.simple = !editor.simple;\n                    if (!editor.isSimple) {\n                        editorDialog.hideFooter();\n                        editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                    }\n                    else {\n                        editor.value = value;\n                        editorDialog.showFooter();\n                        editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to advanced';\n                        setTimeout(() => editor.focus(), 100);\n                    }\n                });\n                document.getElementById('btn-adv-editor-append').addEventListener('click', () => {\n                    openFileDialog('Append file', false).then(files => {\n                        readFile(files[0]).then((contents: any) => {\n                            editor.insert(contents);\n                        }).catch(client.error);\n                    }).catch(() => { });\n                });\n                document.getElementById('btn-adv-editor-send').addEventListener('click', () => {\n                    client.sendCommand(editor.value());\n                    if (client.getOption('editorClearOnSend'))\n                        editor.clear();\n                    if (client.getOption('editorCloseOnSend'))\n                        editorDialog.close();\n                });\n                document.getElementById('btn-adv-editor-clear').addEventListener('click', () => {\n                    editor.clear();\n                    editor.focus();\n                });\n                if (!editor.isSimple)\n                    editorDialog.hideFooter();\n            }\n            editorDialog.show();\n            if (editor.isSimple)\n                editor.focus();\n            return editorDialog;\n    }\n    if (name.startsWith('settings')) {\n        if (!_dialogs.settings) {\n            _dialogs.settings = new SettingsDialog();\n            _dialogs.settings.on('closed', () => {\n                delete _dialogs.settings;\n            });\n            _dialogs.settings.on('canceled', () => {\n                delete _dialogs.settings;\n            });\n        }\n        if (name === 'settings') {\n            _dialogs.settings.dialog.dataset.path = name;\n            _dialogs.settings.dialog.dataset.fullPath = name;\n            _dialogs.settings.dialog.dataset.hash = window.location.hash;\n            _dialogs.settings.setBody('', { client: client });\n            _dialogs.settings.showModal();\n        }\n        else\n            loadDialog(_dialogs.settings, name, 2, false).catch(e => {\n                client.error(e);\n            });\n        return _dialogs.settings;\n    }\n    if (name.startsWith('profiles')) {\n        if (!_dialogs.profiles) {\n            _dialogs.profiles = new ProfilesDialog();\n            _dialogs.profiles.on('closed', () => {\n                delete _dialogs.profiles;\n            });\n            _dialogs.profiles.on('canceled', () => {\n                delete _dialogs.profiles;\n            });\n        }\n        _dialogs.profiles.dialog.dataset.path = name;\n        _dialogs.profiles.dialog.dataset.fullPath = name;\n        _dialogs.profiles.dialog.dataset.hash = window.location.hash;\n        _dialogs.profiles.setBody('', { client: client });\n        _dialogs.profiles.show();\n        return _dialogs.profiles;\n    }\n}\n\nexport function loadDialog(dialog: Dialog, path, show?, showError?) {\n    return new Promise((resolve, reject) => {\n        var subpath = path.split('/');\n        $.ajax({\n            url: 'dialogs/' + subpath[0] + '.htm',\n            cache: false,\n            type: 'GET',\n        })\n            .done(function (data) {\n                dialog.dialog.dataset.path = subpath[0];\n                dialog.dialog.dataset.fullPath = path;\n                dialog.dialog.dataset.hash = window.location.hash;\n                dialog.setBody(data, { client: client });\n                if (show == 1)\n                    dialog.show();\n                else if (show === 2)\n                    dialog.showModal();\n                resolve(data);\n            })\n            .fail(function (err) {\n                if (showError && client.enableDebug)\n                    dialog.setBody(`<h1 style=\"width: 100%;text-align:center\">Error loading ${path}</h1> ${err.statusText}`);\n                else if (showError)\n                    dialog.setBody(`<h1 style=\"width: 100%;text-align:center\">Error loading ${path}</h1>`);\n                else\n                    dialog.setBody('');\n                reject(path + ': ' + subpath.statusText);\n            });\n    });\n}\n\nexport function closeDialog(dialog) {\n    if (_dialogs[dialog])\n        _dialogs[dialog].close();\n    else if (dialog === 'editor') {\n        if (editorDialog)\n            editorDialog.close();\n    }\n}\n\nfunction _loadHistory() {\n    if (!_dialogs.history) return;\n    const list: HTMLSelectElement = document.getElementById('history-list') as HTMLSelectElement;\n    list.innerHTML = '';\n    let history = client.commandHistory;\n    var fragment = document.createDocumentFragment();\n    for (var i = 0, l = history.length; i < l; i++) {\n        var opt = document.createElement('option');\n        opt.appendChild(document.createTextNode(history[i]));\n        opt.value = history[i];\n        fragment.append(opt);\n    }\n    list.appendChild(fragment);\n    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-clear`).style.display = history.length ? '' : 'none';\n    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).style.display = history.length && list.selectedIndex !== -1 ? '' : 'none';\n}\n\nfunction resizeCommandInput() {\n    debounce(() => {\n        _resizeCommandInput();\n    }, 250, 'resizeCommand');\n}\n\nasync function initCommandInput() {\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars')) {\n        client.commandInput.addEventListener('input', resizeCommandInput);\n        client.commandInput.addEventListener('change', resizeCommandInput);\n    }\n    if (client.getOption('commandWordWrap')) {\n        document.getElementById('commandMeasure').style.whiteSpace = 'pre-wrap';\n        document.getElementById('commandMeasure').style.overflowWrap = 'anywhere';\n    }\n    else {\n        document.getElementById('commandMeasure').style.whiteSpace = '';\n        document.getElementById('commandMeasure').style.overflowWrap = '';\n    }\n    if (client.getOption('commandScrollbars')) {\n        document.getElementById('commandMeasure').style.overflow = 'auto';\n        client.commandInput.style.overflow = 'auto';\n    }\n    else {\n        document.getElementById('commandMeasure').style.overflow = '';\n        client.commandInput.style.overflow = '';\n    }\n}\n\nlet commandInputResize: any = {};\nfunction updateCommandInput() {\n    const measure = document.getElementById('commandMeasure');\n    document.body.appendChild(measure);\n    const cmd = client.commandInput.parentElement;\n    const cmdSize = window.getComputedStyle(cmd);\n    measure.style.fontSize = client.commandInput.style.fontSize;\n    measure.style.fontFamily = client.commandInput.style.fontFamily;\n    measure.style.width = client.commandInput.offsetWidth + 'px';\n    const oldMeasure = measure.innerHTML;\n    measure.innerHTML = 'W';\n    let minHeight = client.getOption('commandMinLines');\n    const height = measure.offsetHeight;\n    minHeight = height * (minHeight < 1 ? 1 : minHeight);\n    let padding = parseFloat(cmdSize.borderTopWidth) || 0;\n    padding += parseFloat(cmdSize.borderBottomWidth) || 0;\n    padding += parseFloat(cmdSize.paddingTop) || 0;\n    padding += parseFloat(cmdSize.paddingBottom) || 0;\n    let inset = cmdSize.inset.split(' ');\n    padding += (parseFloat(inset[0]) || 0) * 2;\n    measure.innerHTML = oldMeasure;\n    cmd.style.height = (height + padding) + 'px';\n    /*\n    TODO need to rethink this logic and in _resizeCommandInput, as the current interface has 3 layers the nav group, then input group, then the input itself\n    may need to walk the chain up til body or until it finds shared container with display and resize each one based on positions/paddings/margins\n    */\n    client.commandInput.parentElement.style.height = height + 'px';\n    client.commandInput.closest('nav').style.height = height + 6 + 'px';\n    client.display.container.style.bottom = (height + padding) + 'px';\n\n    commandInputResize = {\n        measure: measure,\n        cmd: cmd,\n        cmdSize: cmdSize,\n        height: height,\n        padding: padding,\n        minHeight: minHeight\n    }\n}\n\nfunction _resizeCommandInput() {\n    const measure = commandInputResize.measure;\n    const cmd = commandInputResize.cmd;\n    measure.innerHTML = client.commandInput.value + '\\n';\n    let height = measure.offsetHeight;\n    if (height < commandInputResize.minHeight)\n        height = commandInputResize.minHeight;\n    const padding = commandInputResize.padding;\n    cmd.style.height = (height + padding) + 'px';\n    client.commandInput.parentElement.style.height = height + 'px';\n    client.commandInput.closest('nav').style.height = height + 6 + 'px';\n    client.display.container.style.bottom = (height + padding) + 'px';\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction _setIcon(ico) {\n    if (_currentIcon === ico)\n        return;\n    _currentIcon = ico;\n    let icon = 'disconnected';\n    switch (ico) {\n        case 1:\n            icon = 'connected';\n            break;\n        case 2:\n            icon = 'active';\n            break;\n    }\n    document.getElementById('icon1').remove();\n    document.getElementById('icon2').remove();\n    document.getElementById('icon3').remove();\n    document.querySelector('head').insertAdjacentHTML('afterbegin', `<link id=\"icon1\" rel=\"shortcut icon\" href=\"images/${icon}.ico\" />\n        <link id=\"icon2\" rel=\"icon\" href=\"images/${icon}.ico\" />\n        <link id=\"icon3\" rel=\"icon\" type=\"image/x-icon\" href=\"images/${icon}.png\" />`);\n}\n\nexport function toggleButtons() {\n    client.setOption('showButtons', !client.getOption('showButtons'));\n    showButtons();\n}\n\nfunction createButton(button, index) {\n    var c = '';\n    var tt = '';\n    var caption = button.caption;\n    var bh = 0;\n    if (caption.substring(0, 3) === 'fa-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fas ' + caption[0] + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fas ' + caption[0] + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fas-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fas fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fas fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'far-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"far fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"far fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fab-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fab fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fab fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 7) === 'http://' || caption.substring(0, 7) === 'https://')\n        caption = '<img src=\"' + caption + '\" style=\"max-width: ' + button.width + 'px;max-height:' + button.height + 'px\"/>';\n    else {\n        if (!button.iconOnly)\n            caption = button.caption;\n        tt = button.caption;\n    }\n    if (button.icon && button.icon.length) {\n        var icon = button.icon;\n        if (icon.substring(0, 3) === 'fa-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fas ' + icon[0] + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fas ' + icon[0] + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'fas-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fas fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fas fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'far-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"far fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"far fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'fab-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fab fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fab fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (button.icon.length) {\n            icon = '<img src=\"' + icon + '\" style=\"max-width: ' + button.width + 'px;max-height:' + button.height + 'px\"/>';\n        }\n        if (button.iconOnly)\n            caption = icon;\n        else\n            caption = icon + caption;\n    }\n    c += '<button';\n    c += ' data-index=\"' + index + '\"';\n    if (button.name && button.name.length !== 0)\n        c += ' id=\"button-' + button.name + '\"';\n    c += ' class=\"user-button\" style=\"';\n    if (button.left === -1 && button.right === -1 && button.top === -1 && button.bottom === -1) {\n        c += 'position: static;margin-right:2px;margin-top:2px;';\n    }\n    else {\n        if (button.left >= 0)\n            c += 'left:' + (button.left || 0) + 'px;';\n        if (button.top >= 0)\n            c += 'top:' + (button.top || 0) + 'px;';\n        if (button.bottom >= 0)\n            c += 'bottom:' + (button.bottom || 0) + 'px;';\n        if (button.right >= 0)\n            c += 'right:' + (button.right || 0) + 'px;';\n        if (button.right === -1 && button.left === -1)\n            c += 'right:0px;';\n        if (button.bottom === -1 && button.top === -1)\n            c += 'top:0px;';\n    }\n    if (button.width)\n        c += 'width: ' + button.width + 'px;';\n    else if (bh === 26)\n        c += 'min-width: 26px;';\n    if (button.height)\n        c += 'height: ' + button.height + 'px;';\n    c += '\" title=\"' + tt + '\" draggable=\"true\" data-index=\"' + index + '\">' + caption + '</button>';\n    return c;\n}\n\nfunction showButtons() {\n    if (client.getOption('showButtons'))\n        document.getElementById('buttons').style.visibility = 'visible';\n    else\n        document.getElementById('buttons').style.visibility = '';\n}\n\nfunction buildButtons() {\n    var c = '';\n    var buttons = client.buttons;\n    var b, bl;\n    for (b = 0, bl = buttons.length; b < bl; b++) {\n        if (!buttons[b].enabled) continue;\n        c += createButton(buttons[b], b);\n    }\n    document.getElementById('buttons').innerHTML = c;\n    const items = document.querySelectorAll('#buttons button');\n    for (let i = 0, il = items.length; i < il; i++) {\n        items[i].addEventListener('click', e => {\n            ExecuteButton(e.currentTarget, +(e.currentTarget as HTMLElement).dataset.index);\n        });\n        dragButton(items[i]);\n    }\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction ExecuteButton(el, idx) {\n    if (idx < 0) return false;\n    if (el.dataset.moving === 'true') {\n        delete el.dataset.moving;\n        return;\n    }\n    var buttons = client.buttons;\n    if (idx >= buttons.length) return false;\n    var button = buttons[idx];\n    if (!button.enabled) return false;\n    var ret;// = \"\";\n    switch (button.style) {\n        case 1:\n            ret = client.parseOutgoing(button.value);\n            break;\n        case 2:\n            /*jslint evil: true */\n            var f = new Function('try { ' + button.value + '} catch (e) { if(this.options.showScriptErrors) this.error(e);}');\n            ret = f.apply(client);\n            break;\n        default:\n            ret = button.value;\n            break;\n    }\n    if (ret === null || typeof ret == 'undefined')\n        return true;\n    if (button.send) {\n        if (!ret.endsWith('\\n'))\n            ret += '\\n';\n        if (button.chain) {\n            if (client.commandInput.value.endsWith(' ')) {\n                client.commandInput.value += ret;\n                client.sendCommand();\n                return true;\n            }\n        }\n        if (client.connected)\n            client.send(ret);\n        if (client.telnet.echo && client.getOption('commandEcho'))\n            client.echo(ret);\n    }\n    else if (button.append)\n        client.commandInput.value += ret;\n    return true;\n}\n\nfunction dragButton(elmnt) {\n    var pos3 = 0, pos4 = 0;\n    var delay;\n    if (document.getElementById(elmnt.id + 'header')) {\n        // if present, the header is where you move the DIV from:\n        document.getElementById(elmnt.id + 'header').onmousedown = dragMouseDown;\n    } else {\n        // otherwise, move the DIV from anywhere inside the DIV:\n        elmnt.onmousedown = dragMouseDown;\n        elmnt.ontouchstart = dragTouchStart;\n        elmnt.onmouseleave = dragMouseleave;\n    }\n\n    function dragMouseDown(e) {\n        e = e || window.event;\n        if (e.buttons !== 1) return;\n        e.preventDefault();\n        var b = elmnt.getBoundingClientRect();\n        pos3 = e.pageX - b.left;\n        pos4 = e.pageY - b.top;\n        document.onmouseup = closeDragButton;\n        delay = setTimeout(function () {\n            document.onmousemove = elementDrag;\n            delay = null;\n        }, 500);\n    }\n\n    function dragMouseleave() {\n        if (delay)\n            closeDragButton();\n    }\n\n    function elementDrag(e) {\n        e = e || window.event;\n        e.preventDefault();\n        // calculate the new cursor position:\n\n        // set the element's new position:\n        elmnt.style.position = 'absolute';\n        elmnt.style.top = (e.pageY - pos4) + 'px';\n        elmnt.style.left = (e.pageX - document.body.clientWidth - pos3) + 'px';\n        elmnt.dataset.moving = 'true';\n    }\n\n    function dragTouchStart(e) {\n        e = e || window.event;\n        if (!e.touches.length) return;\n        //e.preventDefault();\n        var b = elmnt.getBoundingClientRect();\n        pos3 = e.touches[0].pageX - b.left;\n        pos4 = e.touches[0].pageY - b.top;\n        document.ontouchend = closeDragButton;\n        delay = setTimeout(function () {\n            document.ontouchmove = elementMove;\n            delay = null;\n        }, 500);\n    }\n\n    function elementMove(e) {\n        e = e || window.event;\n        e.preventDefault();\n        // calculate the new cursor position:\n\n        // set the element's new position:\n        elmnt.style.position = 'absolute';\n        if (!e.touches.length) return;\n        elmnt.style.top = (e.touches[0].pageY - pos4) + 'px';\n        elmnt.style.left = (e.touches[0].pageX - document.body.clientWidth - pos3) + 'px';\n        elmnt.dataset.moving = 'true';\n    }\n\n    function closeDragButton() {\n        // stop moving when mouse button is released:\n        var b = elmnt.getBoundingClientRect();\n        var idx = parseInt(elmnt.dataset.index, 10);\n        if (idx < 0) return;\n        var buttons = client.buttons;\n        if (idx >= buttons.length) return;\n        var button = buttons[idx];\n        if (!button.enabled) return;\n        if (button.left === -1 && button.right === -1 && button.top === -1 && button.bottom === -1) {\n            button.top = b.top || -1;\n            button.right = document.body.clientWidth - b.right || -1;\n        }\n        else {\n            if (button.left >= 0)\n                button.left = (document.body.clientWidth - b.left) || -1;\n            if (button.top >= 0)\n                button.top = b.top || -1;\n            if (button.bottom >= 0)\n                button.bottom = b.bottom || -1;\n            if (button.right >= 0)\n                button.right = document.body.clientWidth - b.right || -1;\n            if (button.right === -1 && button.left === -1)\n                button.right = document.body.clientWidth - b.right || -1;\n            if (button.bottom === -1 && button.top === -1)\n                button.top = b.top || -1;\n        }\n\n        document.onmouseup = null;\n        document.onmousemove = null;\n        document.ontouchend = null;\n        document.ontouchmove = null;\n        clearTimeout(delay);\n        client.saveProfiles();\n    }\n}\n\nwindow.initializeInterface = initializeInterface;", "<div class=\"offcanvas offcanvas-start\" data-bs-scroll=\"true\" data-bs-backdrop=\"false\" tabindex=\"-1\" id=\"mapper-menu\" aria-labelledby=\"mapper-menu-Label\" style=\"position: absolute;\"><div class=\"offcanvas-body\"><button type=\"button\" class=\"btn btn-close text-reset btn-danger btn-close text-reset\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\" style=\"position: absolute;right: 5px;top: 5px;\"></button><ul class=\"navbar-nav justify-content-end flex-grow-1\"><li id=\"mapper-enable\" class=\"nav-item\" title=\"Enable\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"bi bi-map\"></i>&nbsp;<span>Enabled</span></a></li><li id=\"mapper-legend\" class=\"nav-item\" title=\"Show legend\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-map-marker\"></i>&nbsp;<span>Show legend</span></a></li><li id=\"mapper-room\" class=\"nav-item\" title=\"Show room properties\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-list-alt\"></i>&nbsp;<span>Show room properties</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-refresh\" class=\"nav-item\" title=\"Refresh\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-refresh\"></i>&nbsp;<span>Refresh</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-split\" class=\"nav-item\" title=\"Split areas\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-object-ungroup\"></i>&nbsp;<span>Split areas</span></a></li><li id=\"mapper-fill\" class=\"nav-item\" title=\"Fill walls\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-building\"></i>&nbsp;<span>Fill walls</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-remove\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#remove-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"remove-submenu\"><i class=\"fa fa-eraser\"></i>&nbsp;<span>Remove</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"remove-submenu\"><li class=\"nav-item\" id=\"mapper-remove-selected\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Remove selected room</a></li><li class=\"nav-item\" id=\"mapper-remove-current\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Remove current room</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-remove-current-area\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Remove current area</a></li><li id=\"mapper-remove-all\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Remove all</a></li></ul></li><li id=\"mapper-export\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#export-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"export-submenu\"><i class=\"fa fa-exchange\"></i>&nbsp;<span>Export/Import</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"export-submenu\"><li id=\"mapper-export-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Export as image</a></li><li id=\"mapper-export-scaled-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Export as scaled image</a></li><li id=\"mapper-export-current-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Export current view as image</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-export-current-area\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Export current area</a></li><li id=\"mapper-export-all\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Export all</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-import-merge\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Import and merge</a></li><li id=\"mapper-import-replace\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Import and replace</a></li></ul></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-export\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#actions-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"actions-submenu\"><i class=\"fa-solid fa-shoe-prints\"></i>&nbsp;<span>Actions</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"actions-submenu\"><li id=\"mapper-follow\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Follow</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-focus\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Focus on current room</a></li><li id=\"mapper-set-current\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Set selected as current</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-highlight-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Highlight path</a></li><li id=\"mapper-clear-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Clear path</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-walk-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Walk path</a></li><li id=\"mapper-walk-highlighted-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Walk highlighted path</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-copy-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy path</a></li><li id=\"mapper-copy-stacked\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy as stacked</a></li><li id=\"mapper-copy-speedpath\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy as speedpath</a></li><li id=\"mapper-copy-highlighted-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy highlighted path</a></li><li id=\"mapper-copy-highlighted-stacked\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy highlighted as stacked</a></li><li id=\"mapper-copy-highlighted-speedpath\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\" style=\"padding-left: 40px;\">Copy highlighted as speedpath</a></li></ul></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-about\" class=\"nav-item\" title=\"About map\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"bi-info-circle\"></i>&nbsp;<span>About</span></a></li></ul></div></div>", "<div class=\"dialog-header\"><button id=\"mapper-room-close\" style=\"padding: 4px;\" type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" title=\"Hide properties\"></button><div><i class=\"fa fa-list-alt\"></i>&nbsp;Room properties</div></div><div class=\"accordion\" id=\"mapper-room-accordion\"><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-general\" aria-expanded=\"true\" aria-controls=\"General\">General </button></h2><div id=\"mapper-room-general\" class=\"accordion-collapse collapse show\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding: 5px;\"><div class=\"mb-3\"><label for=\"mapper-room-name\">Name</label><input type=\"text\" class=\"form-control\" id=\"mapper-room-name\" placeholder=\"\"></div><div class=\"mb-3\"><label for=\"mapper-room-background\">Background</label><input type=\"text\" class=\"form-control\" id=\"mapper-room-background\" placeholder=\"\"></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-location\" aria-expanded=\"true\" aria-controls=\"mapper-room-location\">Location </button></h2><div id=\"mapper-room-location\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding: 5px;\"><div class=\"mb-3\"><label for=\"mapper-room-area\" class=\"form-label\">Area</label><select id=\"mapper-room-area\" class=\"form-select\"></select></div><div class=\"mb-3\"><label for=\"mapper-room-x\" class=\"form-label\">X</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-x\"></div><div class=\"mb-3\"><label for=\"mapper-room-y\" class=\"form-label\">Y</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-y\"></div><div class=\"mb-3\"><label for=\"mapper-room-z\" class=\"form-label\">Z</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-z\"></div><div class=\"mb-3\"><label for=\"mapper-room-zone\" class=\"form-label\">Zone</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-zone\"></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-details\" aria-expanded=\"true\" aria-controls=\"mapper-room-details\">Details </button></h2><div id=\"mapper-room-details\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding: 5px;\"><div class=\"form-check form-switch\"><input type=\"checkbox\" class=\"form-check-input\" id=\"mapper-room-indoors\"><label class=\"form-check-label\" for=\"mapper-room-indoors\">Indoors</label></div><div class=\"mb-3\"><label for=\"font\" class=\"form-label\">Terrain</label><div class=\"input-group\"><input id=\"mapper-room-env\" type=\"text\" class=\"form-control\" aria-label=\"Room terrain\"><button type=\"button\" class=\"btn btn-outline-secondary dropdown-toggle dropdown-toggle-split\" style=\"border: var(--bs-border-width) solid var(--bs-border-color);\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\"><span class=\"visually-hidden\">Toggle Dropdown</span></button><ul id=\"mapper-room-terrains\" class=\"dropdown-menu dropdown-menu-end\" style=\"height: 200px;overflow: auto;\"><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">beach</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">bog</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">city</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">cliff</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">cobble</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">desert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">dirt</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">dirtroad</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">farmland</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">forest</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">grass</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">grassland</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">highmountain</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">hills</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">icesheet</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">jungle</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">lake</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">mountain</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">ocean</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">pavedroad</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">plains</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">prairie</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">river</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">rockdesert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">rocky</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">sand</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">sanddesert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">savannah</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">stone</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">swamp</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">tundra</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">underwater</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">water</a></li></ul></div></div><div><label for=\"font\" class=\"form-label\">Details</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"1\" id=\"mapper-room-details-1\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-1\">Dock</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"2\" id=\"mapper-room-details-2\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-2\">Pier</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"4\" id=\"mapper-room-details-4\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-4\">Bank</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"8\" id=\"mapper-room-details-8\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-8\">Shop</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"16\" id=\"mapper-room-details-16\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-16\">Hospital</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"32\" id=\"mapper-room-details-32\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-32\">Bar</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"64\" id=\"mapper-room-details-64\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-64\">Restaurant</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"128\" id=\"mapper-room-details-128\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-128\">WaterSource</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"256\" id=\"mapper-room-details-256\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-256\">Trainer</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"512\" id=\"mapper-room-details-512\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-512\">Stable</label></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-notes\" aria-expanded=\"true\" aria-controls=\"mapper-room-notes\">Notes </button></h2><div id=\"mapper-room-notes\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding: 5px;\"><textarea class=\"form-control\" rows=\"10\" style=\"width: 100%;\" id=\"mapper-room-notes\"></textarea></div></div></div></div>", "import \"../css/mapper.css\";\r\nimport { Client } from './../client';\r\nimport { Plugin } from '../plugin';\r\nimport { MenuItem } from '../types';\r\nimport { MapDisplay } from '../interface/mapdisplay';\r\nimport { Map, Room, RoomDetails, ImportType } from '../map';\r\nimport { Dialog, DialogButtons, ProgressDialog } from '../interface/dialog';\r\nimport { removeHash } from '../interface/interface';\r\nimport { debounce, readFile, openFileDialog } from \"../library\";\r\nimport { Splitter, Orientation } from \"../interface/splitter\";\r\n\r\n//store menu and room editor as htm file for easier editing\r\n// @ts-ignore\r\nimport mapperMenu from '../html/mapper.menu.htm'\r\n// @ts-ignore\r\nimport mapperRoom from '../html/mapper.room.htm'\r\n\r\ndeclare let bootstrap;\r\ndeclare let confirm_box;\r\ndeclare let alert_box;\r\ndeclare let progress_box;\r\n\r\ninterface MapperOptions {\r\n    client: Client;\r\n}\r\n\r\nexport class Mapper extends Plugin {\r\n    private _map: Map;\r\n    private _clientContainer;\r\n    private miniMap: MapDisplay;\r\n    private _dialog: Dialog;\r\n    private _dialogMap: MapDisplay;\r\n    private _dialogSplitter: Splitter;\r\n    private _dialogProgress: ProgressDialog;\r\n\r\n    constructor(options?: MapperOptions | Client) {\r\n        super(options instanceof Client ? options : options?.client);\r\n        if (options && !(options instanceof Client)) {\r\n\r\n        }\r\n        //this.miniMap = new MapDisplay(document.createElement('div'));\r\n        //document.body.appendChild(this.miniMap.container);\r\n        //this.miniMap.container.classList.add('mini-map');\r\n        this._clientContainer = document.getElementById('client-container');\r\n        //this._clientContainer.style.left = '205px';\r\n        Map.load().then((map: Map) => {\r\n            this.map = map;\r\n        }).catch(err => this.client.error(err));\r\n    }\r\n\r\n    public remove(): void {\r\n        if (!this.client) return;\r\n        this.client.removeListenersFromCaller(this);\r\n        let idx = this.client.telnet.GMCPSupports.indexOf('Room 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n    }\r\n    public initialize(): void {\r\n        if (!this.client) return;\r\n        this.client.telnet.GMCPSupports.push('Room 1');\r\n        this.client.on('received-GMCP', this.processGMCP, this);\r\n        this.client.on('window', window => {\r\n            if (window === 'mapper') this.show();\r\n        });\r\n        this.on('debug', e => this.client.debug(e), this);\r\n        this.on('error', e => this.client.error(e), this);\r\n        let options = client.getOption('windows.mapper');\r\n        if (options && options.show)\r\n            this.show();\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [\r\n            {\r\n                name: '-',\r\n                position: 5\r\n            },\r\n            {\r\n                name: ' Show mapper',\r\n                action: e => { this.show() },\r\n                icon: '<i class=\"bi bi-map\"></i>',\r\n                position: 6\r\n            }]\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return []\r\n    }\r\n\r\n    get map() { return this._map; }\r\n    set map(map) {\r\n        this._map = map;\r\n        if (this._dialogMap)\r\n            this._dialogMap.map = map;\r\n        this.emit('map-loaded');\r\n        //this.miniMap.map = this._map;\r\n    }\r\n\r\n    /**\r\n     * processGMCP - process incoming GMCP for Room events\r\n     * @param {string} mod Client#received-GMCP module\r\n     * @param {Object} data Client#received-GMCP data object\r\n     */\r\n    public async processGMCP(mod: string, data: any) {\r\n        if (!this.client.getOption('mapper.enabled')) return;\r\n        switch (mod) {\r\n            case 'Room.Info':\r\n                this.processData(data);\r\n                break;\r\n            case 'Room.WrongDir':\r\n                break;\r\n        }\r\n    }\r\n\r\n    public processData(data) {\r\n        if (!this._map) {\r\n            setTimeout(() => {\r\n                this.processData(data);\r\n            }, 10);\r\n            return;\r\n        }\r\n        try {\r\n\r\n            let room = this._map.getRoom({ ID: '' + data.num });;\r\n            if (!room) {\r\n                room = new Room();\r\n                room.zone = this._map.current.zone;\r\n                if (this._map.current.num !== null) {\r\n                    switch (data.prevroom.dir) {\r\n                        case 'west':\r\n                            room.x--;\r\n                            break;\r\n                        case 'east':\r\n                            room.x++;\r\n                            break;\r\n                        case 'north':\r\n                            room.y--;\r\n                            break;\r\n                        case 'south':\r\n                            room.y++;\r\n                            break;\r\n                        case 'northeast':\r\n                            room.y--;\r\n                            room.x++;\r\n                            break;\r\n                        case 'northwest':\r\n                            room.y--;\r\n                            room.x--;\r\n                            break;\r\n                        case 'southeast':\r\n                            room.y++;\r\n                            room.x++;\r\n                            break;\r\n                        case 'southwest':\r\n                            room.y++;\r\n                            room.x--;\r\n                            break;\r\n                        case 'up':\r\n                            room.z++;\r\n                            break;\r\n                        case 'down':\r\n                            room.z--;\r\n                            break;\r\n                        //out means you leave a zone\r\n                        case 'out':\r\n                            room.zone = this._map.current.zone - 1;\r\n                            break;\r\n                        //enter or unknown exits new zone\r\n                        default:\r\n                            //if (val.area == currentRoom.area)\r\n                            room.zone = this._map.current.zone + 1;\r\n                            break;\r\n                    }\r\n                    room.x += this._map.current.x;\r\n                    room.y += this._map.current.y;\r\n                    room.z += this._map.current.z;\r\n                }\r\n                if (data.area === this._map.current.area) {\r\n                    if (this._map.roomExists({ x: room.x, y: room.y, z: room.z, zone: this._map.current.zone, area: this._map.current.area }) || data.prevroom.zone) {\r\n                        room.zone = this._map.getFreeZone(this._map.current.zone);\r\n                        this.updateCurrent(room, data);\r\n                    }\r\n                    else {\r\n                        this.updateCurrent(room, data);\r\n                    }\r\n                }\r\n                else if (this._map.roomExists({ x: room.x, y: room.y, z: room.z, zone: this._map.current.zone }) || data.prevroom.zone) {\r\n                    room.zone = this._map.getFreeZone(this._map.current.zone);\r\n                    this.updateCurrent(room, data);\r\n                }\r\n                else {\r\n                    this.updateCurrent(room, data);\r\n                }\r\n            }\r\n            else {\r\n                this.updateCurrent(room, data);\r\n            }\r\n            this._map.save().catch(err => this.client.error(err));\r\n        }\r\n        catch (e) {\r\n            this.emit('error', e);\r\n        }\r\n    }\r\n\r\n    private updateCurrent(room, data) {\r\n        room.num = data.num;\r\n        room.area = data.area;\r\n        room.name = data.name;\r\n        room.env = data.environment;\r\n        room.indoors = data.indoors;\r\n        let exit;\r\n        for (exit in data.exits)\r\n            room.exits[exit] = data.exits[exit];\r\n        //start with none\r\n        room.details = RoomDetails.None;\r\n        if (typeof data.details === 'number')\r\n            room.details = data.details;\r\n        else\r\n            for (let x = 0; x < data.details.length; x++) {\r\n                switch (data.details[x]) {\r\n                    case 'dock':\r\n                        room.details |= RoomDetails.Dock;\r\n                        break;\r\n                    case 'pier':\r\n                        room.details |= RoomDetails.Pier;\r\n                        break;\r\n                    case 'bank':\r\n                        room.details |= RoomDetails.Bank;\r\n                        break;\r\n                    case 'shop':\r\n                        room.details |= RoomDetails.Shop;\r\n                        break;\r\n                    case 'hospital':\r\n                        room.details |= RoomDetails.Hospital;\r\n                        break;\r\n                    case 'bar':\r\n                        room.details |= RoomDetails.Bar;\r\n                        break;\r\n                    case 'restaurant':\r\n                        room.details |= RoomDetails.Restaurant;\r\n                        break;\r\n                    case 'watersource':\r\n                        room.details |= RoomDetails.WaterSource;\r\n                        break;\r\n                    case 'trainer':\r\n                    case 'training':\r\n                    case 'advance':\r\n                        room.details |= RoomDetails.Trainer;\r\n                        break;\r\n                    case 'stable':\r\n                        room.details |= RoomDetails.Stable;\r\n                        break;\r\n                }\r\n            }\r\n        room = this._map.setRoom(room);\r\n        this._map.current = room.clone();\r\n        this.emit('current-changed', this._map.current);\r\n    }\r\n\r\n    /**\r\n     * debug - emit debug event if enabledDebug on\r\n     * @param {string | object} e The debug message or an object of data \r\n     */\r\n    public debug(e) {\r\n        this.emit('debug', e);\r\n    }\r\n\r\n    public refresh() {\r\n        //this.miniMap.refresh();\r\n    }\r\n\r\n    public createDialog() {\r\n        if (this._dialog) return;\r\n        this._dialog = new Dialog(Object.assign({}, client.getOption('windows.mapper') || { center: true }, { title: '<i class=\"bi bi-map\"></i><select id=\"mapper-area\" class=\"form-select form-select-sm me-2 mb-1\" title=\"Select Area\"></select>', id: 'win-mapper', noFooter: true, minHeight: 350 }));\r\n        this._dialog.on('resized', e => {\r\n            this.client.setOption('windows.mapper', e);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('moved', e => {\r\n            this.client.setOption('windows.mapper', e);\r\n        })\r\n        this._dialog.on('maximized', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('restored', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('shown', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            this.client.setOption('showMapper', this._dialog.windowState.show !== 0);\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n        this._dialog.on('closing', () => {\r\n\r\n        });\r\n        this._dialog.on('closed', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            removeHash('mapper');\r\n        });\r\n        this._dialog.on('canceling', () => {\r\n\r\n        });\r\n        this._dialog.on('canceled', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            removeHash('mapper');\r\n        });\r\n        this._dialog.on('resizing', () => {\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n\r\n        const toolbar = document.createElement('nav');\r\n        toolbar.id = 'mapper-toolbar';\r\n        toolbar.classList.add('navbar', 'bg-light', 'align-items-center');\r\n        toolbar.innerHTML = `<form class=\"container-fluid justify-content-start\"><button id=\"btn-mapper-menu\" class=\"me-2 mb-1 btn-sm btn btn-outline-secondary\" type=\"button\" aria-controls=\"mapper-menu\" title=\"Show menu\" aria-expanded=\"false\" data-bs-toggle=\"offcanvas\" data-bs-target=\"#mapper-menu\" aria-controls=\"mapper-menu\"><i class=\"fa-solid fa-bars\"></i></button><button id=\"btn-mapper-focus\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Focus on current room\"><i class=\"fa fa-crosshairs\"></i></button><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-level\" class=\"mt-1 me-1\">Level: </label><input id=\"mapper-level\" class=\"form-control form-control-sm\" type=\"number\" title=\"Map Level\"></div><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-zone\" class=\"mt-1 me-1\">Zone: </label><input id=\"mapper-zone\" class=\"form-control form-control-sm\" type=\"number\" title=\"Map Zone\"></div><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-zoom\" class=\"me-1\">Zoom: </label><input id=\"mapper-zoom\" class=\"form-range\" type=\"range\" min=\"25\" max=\"300\" step=\"5\"\"><label id=\"mapper-zoom-display\">100%</label></div></form>`;\r\n        this._dialog.body.appendChild(toolbar);\r\n        this._dialog.body.insertAdjacentHTML('afterbegin', mapperMenu);\r\n        this._dialog.body.querySelector('#mapper-enable a').addEventListener('click', () => {\r\n            this._dialogMap.enabled = !this._dialogMap.enabled;\r\n            if (this._dialogMap.enabled)\r\n                this._dialog.body.querySelector('#mapper-enable').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-enable').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-legend a').addEventListener('click', () => {\r\n            this._dialogMap.showLegend = !this._dialogMap.showLegend;\r\n            if (this._dialogMap.showLegend)\r\n                this._dialog.body.querySelector('#mapper-legend').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-legend').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-room a').addEventListener('click', () => {\r\n            this._dialogSplitter.panel2Collapsed = !this._dialogSplitter.panel2Collapsed;\r\n            if (this._dialogSplitter.panel2Collapsed) {\r\n                this._dialog.dialog.dataset.panel = \"left\";\r\n                this._dialog.body.querySelector('#mapper-room').classList.remove('active');\r\n                this._dialog.body.querySelector('#mapper-room').title = 'Show room properties';\r\n                this._dialog.body.querySelector('#mapper-room a span').textContent = 'Show room properties';\r\n            }\r\n            else {\r\n                this._dialog.dialog.dataset.panel = \"right\";\r\n                this._dialog.body.querySelector('#mapper-room').classList.add('active');\r\n                this._dialog.body.querySelector('#mapper-room').title = 'Hide room properties';\r\n                this._dialog.body.querySelector('#mapper-room a span').textContent = 'Hide room properties';\r\n            }\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            this.client.setOption('mapper.room', !this._dialogSplitter.panel2Collapsed);\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-refresh a').addEventListener('click', () => {\r\n            this._dialogMap.refresh();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-split a').addEventListener('click', () => {\r\n            this._dialogMap.splitArea = !this._dialogMap.splitArea;\r\n            if (this._dialogMap.splitArea)\r\n                this._dialog.body.querySelector('#mapper-split').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-split').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-fill a').addEventListener('click', () => {\r\n            this._dialogMap.fillWalls = !this._dialogMap.fillWalls;\r\n            if (this._dialogMap.fillWalls)\r\n                this._dialog.body.querySelector('#mapper-fill').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-fill').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-follow a').addEventListener('click', () => {\r\n            this._dialogMap.follow = !this._dialogMap.follow;\r\n            if (this._dialogMap.follow)\r\n                document.getElementById('mapper-follow').classList.add('active');\r\n            else\r\n                document.getElementById('mapper-follow').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-focus a').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-set-current a').addEventListener('click', () => {\r\n            this._dialogMap.current = this._dialogMap.selected;\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#btn-mapper-focus').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            closeMenu();\r\n        });\r\n\r\n\r\n        this._dialog.body.querySelector('#mapper-highlight-path a').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            this._dialogMap.showPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-clear-path a').addEventListener('click', () => {\r\n            this._dialogMap.clearPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-walk-path a').addEventListener('click', () => {\r\n            this._dialogMap.walkPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-walk-highlighted-path a').addEventListener('click', () => {\r\n            this._dialogMap.walkMarkedPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-path a').addEventListener('click', () => {\r\n            this._dialogMap.copyPath('\\n');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-stacked a').addEventListener('click', () => {\r\n            this._dialogMap.copyPath(this.client.getOption('commandStackingChar'));\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-speedpath a').addEventListener('click', () => {\r\n            this._dialogMap.copySpeedpath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-path a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedPath('\\n');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-stacked a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedPath(this.client.getOption('commandStackingChar'));\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-remove-selected a').addEventListener('click', () => {\r\n            confirm_box('Remove selected room?', `Are you sure you want to remove selected room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearSelectedRoom();\r\n            });\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-remove-current a').addEventListener('click', () => {\r\n            confirm_box('Remove current room?', `Are you sure you want to remove current room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearCurrentRoom();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-remove-current-area a').addEventListener('click', () => {\r\n            confirm_box('Remove current area?', `Are you sure you want to remove all rooms from current area?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearArea();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-remove-all a').addEventListener('click', () => {\r\n            confirm_box('Remove all rooms and areas?', `Are you sure you want to remove all rooms?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearAll();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportImage();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-scaled-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportImage(true);\r\n            closeMenu();\r\n        });        \r\n        this._dialog.body.querySelector('#mapper-export-current-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportCurrentImage();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-current-area a').addEventListener('click', () => {\r\n            this._dialogMap.exportArea();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-all a').addEventListener('click', () => {\r\n            this._dialogMap.exportAll();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-import-merge a').addEventListener('click', () => {\r\n            openFileDialog('Import map and merge', false).then(files => {\r\n                readFile(files[0]).then((data: any) => {\r\n                    this._dialogProgress = progress_box('Importing map');\r\n                    this._dialogProgress.on('canceled', () => {\r\n                        this.map.cancelImport();\r\n                    });\r\n                    this._dialogProgress.on('closed', reason => {\r\n                        if (reason === 'canceled')\r\n                            this.map.cancelImport();\r\n                    });\r\n                    this._dialogProgress.on('shown', () => {\r\n                        this.map.import(JSON.parse(data), ImportType.Merge);    \r\n                    });\r\n                    this._dialogProgress.showModal();\r\n                }).catch(client.error);\r\n            }).catch(() => { });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-import-replace a').addEventListener('click', () => {\r\n            confirm_box('Import and Replace?', `Are you sure you want to remove all rooms and replace them?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    openFileDialog('Import map and replace', false).then(files => {\r\n                        readFile(files[0]).then((data: any) => {\r\n                            this._dialogProgress = progress_box('Importing map');\r\n                            this._dialogProgress.showModal();\r\n                            this.map.import(JSON.parse(data), ImportType.Replace);\r\n                        }).catch(client.error);\r\n                    }).catch(() => { });\r\n            });\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-speedpath a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedSpeedpath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-about a').addEventListener('click', () => {\r\n            alert_box({ title: '<i class=\"fa-solid fa-circle-info\"></i> Map information', width: 300, height: 200, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Ok }, `Areas: ${this._map.Areas.length}<br>Rooms: ${this._map.count}<br>Highest zone: ${this._map.zone}`, 2);\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialogMap = new MapDisplay(document.createElement('div'), { map: this._map });\r\n\r\n        this._dialogMap.on('error', e => this.client.error(e), this);\r\n\r\n        this._dialogMap.on('remove-selected', () => {\r\n            confirm_box('Remove selected room?', `Are you sure you want to remove selected room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearSelectedRoom();\r\n            });\r\n        });\r\n\r\n        this._dialogMap.on('active-room-changed', room => {\r\n            const area = document.getElementById('mapper-area') as HTMLSelectElement;\r\n            if (!room.area || room.area.length === 0) {\r\n                if (area.options.length)\r\n                    area.value = area.options[0].value;\r\n            }\r\n            else {\r\n                if (!area.querySelectorAll(`option[value=\"${room.area.replace(/\"/g, '&quot;')}\"]`).length) {\r\n                    area.insertAdjacentHTML('beforeend', `<option value=\"${room.area.replace(/\"/g, '&quot;')}\">${room.area}</option>`);\r\n                    document.getElementById('mapper-room-area').insertAdjacentHTML('beforeend', `<option value=\"${room.area.replace(/\"/g, '&quot;')}\">${room.area}</option>`);\r\n                }\r\n                area.value = room.area;\r\n            }\r\n            (document.getElementById('mapper-level') as HTMLInputElement).value = room.z;\r\n            (document.getElementById('mapper-zone') as HTMLInputElement).value = room.zone;\r\n            room = room.clone();\r\n            room.ID = room.num;\r\n            delete room.num;\r\n            this.client.setOption('mapper.active', room);\r\n        });\r\n\r\n        this._dialogMap.on('setting-changed', (setting, value) => {\r\n            if (setting === 'active') {\r\n                (document.getElementById('mapper-area') as HTMLInputElement).value = value.area;\r\n                (document.getElementById('mapper-level') as HTMLInputElement).value = value.z;\r\n                (document.getElementById('mapper-zone') as HTMLInputElement).value = value.zone;\r\n            }\r\n            else if (setting === 'scale') {\r\n                (document.getElementById('mapper-zoom') as HTMLInputElement).value = value;\r\n                document.getElementById('mapper-zoom-display').textContent = value + '%';\r\n            }\r\n            this.client.setOption(`mapper.${setting}`, value);\r\n        });\r\n\r\n        document.getElementById('mapper-area').addEventListener('change', e => {\r\n            this._dialogMap.setArea((e.currentTarget as HTMLSelectElement).value);\r\n        });\r\n        document.getElementById('mapper-level').addEventListener('change', e => {\r\n            this._dialogMap.setLevel(parseInt((e.currentTarget as HTMLInputElement).value, 10));\r\n        });\r\n        document.getElementById('mapper-zone').addEventListener('change', e => {\r\n            this._dialogMap.setZone(parseInt((e.currentTarget as HTMLInputElement).value, 10));\r\n        });\r\n\r\n        this._dialogSplitter = new Splitter({ id: 'mapper', parent: this._dialog.body, orientation: Orientation.vertical });\r\n        this._dialogSplitter.on('splitter-moved', (e) => {\r\n            this.client.setOption('mapper.roomWidth', e);\r\n        });\r\n        this._dialogSplitter.panel2Collapsed = true;\r\n        if (this.client.getOption('mapper.room'))\r\n            this._dialog.body.querySelector('#mapper-room a').click();\r\n        this._dialogSplitter.SplitterDistance = client.getOption('mapper.roomWidth');\r\n        this._dialogSplitter.panel2.innerHTML = mapperRoom;\r\n        document.getElementById('mapper-room-close').addEventListener('click', () => {\r\n            this._dialog.body.querySelector('#mapper-room a').click();\r\n        });\r\n        document.getElementById('mapper-room-accordion').querySelectorAll('input,textarea,select,.accordion-body button').forEach((f: HTMLInputElement) => {\r\n            f.disabled = true;\r\n            if (f.tagName === 'BUTTON') return;\r\n            if (f.type === 'checkbox') {\r\n                f.addEventListener('change', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    const name = f.name || (f.id).substring(12);\r\n                    if (target.dataset.enum === 'true') {\r\n                        const name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\r\n                        const enums = document.getElementById('mapper-room-accordion').querySelectorAll(`[name=${name}]`);\r\n                        let value = 0;\r\n                        for (let e = 0, el = enums.length; e < el; e++) {\r\n                            if ((enums[e] as HTMLInputElement).checked)\r\n                                value |= +(enums[e] as HTMLInputElement).value;\r\n                        }\r\n                        this._dialogMap.selected[name] = value;\r\n                    }\r\n                    else\r\n                        this._dialogMap.selected[name] = target.checked;\r\n                    this._map.setRoom(this._dialogMap.selected);\r\n                    this._map.save().catch(err => this.client.error(err));\r\n                });\r\n            }\r\n            else {\r\n                f.addEventListener('change', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const name = f.name || f.id.substring(12);\r\n                    debounce(() => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this._dialogMap.selected[name] = target.value;\r\n                        this._map.setRoom(this._dialogMap.selected);\r\n                        this._map.save().catch(err => this.client.error(err));\r\n                    }, 100, name);\r\n                });\r\n                f.addEventListener('input', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const name = f.name || f.id.substring(12);\r\n                    debounce(() => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this._dialogMap.selected[name] = target.value;\r\n                        this._map.setRoom(this._dialogMap.selected);\r\n                    }, 100, name);\r\n                });\r\n            }\r\n        });\r\n        this._dialogMap.on('room-selected', room => {\r\n            document.getElementById('mapper-room-accordion').querySelectorAll('input,textarea,select,.accordion-body button').forEach((f: HTMLInputElement) => {\r\n                if (room === null || room.num === null) {\r\n                    f.disabled = true;\r\n                    if (f.tagName === 'BUTTON') return;\r\n                    if (f.type === 'checkbox')\r\n                        f.checked = false;\r\n                    else\r\n                        f.value = '';\r\n                }\r\n                else {\r\n                    f.disabled = false;\r\n                    if (f.tagName === 'BUTTON') return;\r\n                    const name = f.name || (f.id).substring(12);\r\n                    if (f.type === 'checkbox') {\r\n                        if (f.dataset.enum === 'true') {\r\n                            const value = +f.value;\r\n                            f.checked = (room[name] & value) === value;\r\n                        }\r\n                        else\r\n                            f.checked = room[name];\r\n                    }\r\n                    else\r\n                        f.value = room[name];\r\n                }\r\n            });\r\n            const selected = room;\r\n            const current = this._map.current;\r\n            this.updateMenu('#mapper-remove-selected a', selected === null || selected.num === null);\r\n            this.updateMenu('#mapper-set-current a', selected === null || selected.num === null);\r\n            this.updateMenu('#mapper-highlight-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-walk-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-stacked a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-speedpath a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n        });\r\n        this._dialogMap.on('current-changed', room => {\r\n            const selected = this._dialogMap.selected;\r\n            const current = room;\r\n            this.updateMenu('#mapper-remove-current a', current === null || current.num === null);\r\n            this.updateMenu('#mapper-remove-selected a', selected === null || selected.num === null);\r\n            this.updateMenu('#mapper-set-current a', selected === null || selected.num === null);\r\n            this.updateMenu('#mapper-highlight-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-walk-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-stacked a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this.updateMenu('#mapper-copy-speedpath a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n        });\r\n\r\n        this._dialogMap.on('path-shown', () => {\r\n            this.updateMenu('#mapper-highlight-path a', false);\r\n            this.updateMenu('#mapper-walk-path a', false);\r\n            this.updateMenu('#mapper-walk-highlighted-path a', false);\r\n            this.updateMenu('#mapper-clear-path a', false);\r\n            this.updateMenu('#mapper-copy-highlighted-path a', false);\r\n            this.updateMenu('#mapper-copy-highlighted-stacked a', false);\r\n            this.updateMenu('#mapper-copy-highlighted-speedpath a', false);\r\n        });\r\n\r\n        this._dialogMap.on('path-cleared', () => {\r\n            this.updateMenu('#mapper-clear-path a', true);\r\n            this.updateMenu('#mapper-walk-highlighted-path a', true);\r\n            this.updateMenu('#mapper-copy-highlighted-path a', true);\r\n            this.updateMenu('#mapper-copy-highlighted-stacked a', true);\r\n            this.updateMenu('#mapper-copy-highlighted-speedpath a', true);\r\n        });\r\n\r\n        const el = this._dialog.body.querySelector('#mapper-room-env')\r\n        let items = this._dialog.body.querySelectorAll('#mapper-room-terrains .active');\r\n        let i, il;\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].classList.remove('active');\r\n        items = this._dialog.body.querySelectorAll('#mapper-room-terrains .dropdown-item');\r\n        for (i = 0, il = items.length; i < il; i++) {\r\n            items[i].addEventListener('click', function () {\r\n                el.value = this.textContent;\r\n                el.dispatchEvent(new Event('change'));\r\n            });\r\n        }\r\n        el.nextElementSibling.addEventListener('show.bs.dropdown', event => {\r\n            let items = this._dialog.body.querySelectorAll('#mapper-room-terrains .dropdown-item');\r\n            for (i = 0, il = items.length; i < il; i++) {\r\n                items[i].classList.remove('active');\r\n                if (el.value === items[i].textContent)\r\n                    items[i].classList.add('active');\r\n            };\r\n        });\r\n\r\n        this._dialogSplitter.panel1.append(this._dialogMap.container);\r\n        this._dialogMap.container.classList.add('map');\r\n\r\n        this._dialogMap.active = client.getOption('mapper.active');\r\n        this._dialogMap.active.num = this._dialogMap.active.num || (this._dialogMap.active as any).ID;\r\n        this._dialogMap.commandDelay = client.getOption('commandDelay');\r\n        this._dialogMap.commandDelayCount = client.getOption('commandDelayCount');\r\n\r\n        this._dialogMap.on('debug', msg => {\r\n            this.client.debug(msg);\r\n        });\r\n        (document.getElementById('mapper-level') as HTMLInputElement).value = '' + this._dialogMap.active.z;\r\n        (document.getElementById('mapper-zone') as HTMLInputElement).value = '' + this._dialogMap.active.zone;\r\n        document.getElementById('mapper-zoom').addEventListener('input', e => {\r\n            this._dialogMap.scale = +(e.currentTarget as HTMLInputElement).value;\r\n        });\r\n\r\n        const initMapper = () => {\r\n            const m = this._map.Areas.length;\r\n            const area = document.getElementById('mapper-area') as HTMLSelectElement;\r\n            area.addEventListener('mouseup', e => {\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n            });\r\n            area.addEventListener('touchstart', e => {\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n            }, { passive: true });\r\n            area.addEventListener('mousedown', e => {\r\n                e.stopPropagation();\r\n                e.cancelBubble = true;\r\n            });\r\n            let h = '';\r\n            for (var i = 0; i < m; i++)\r\n                h += `<option value=\"${this._map.Areas[i].replace(/\"/g, '&quot;')}\">${this._map.Areas[i]}</option>`;\r\n            area.innerHTML = h;\r\n            document.getElementById('mapper-room-area').innerHTML = h;\r\n            if (!this._dialogMap.active.area) {\r\n                this._dialogMap.active.area = this.client.getOption('MapperArea');\r\n                if (this._dialogMap.active.area !== null && typeof this._dialogMap.active.area != 'undefined')\r\n                    area.value = this._dialogMap.active.area;\r\n            }\r\n            if (!this._dialogMap.active.area && area.options.length)\r\n                this._dialogMap.active.area = area.options[0].value;\r\n            this._dialogMap.setArea(this._dialogMap.active.area);\r\n            this._dialogMap.refresh();\r\n\r\n            this._dialogMap.enabled = this.client.getOption('mapper.enabled');\r\n            if (this._dialogMap.enabled)\r\n                document.getElementById('mapper-enable').classList.add('active');\r\n\r\n            this._dialogMap.showLegend = this.client.getOption('mapper.legend');\r\n            if (this._dialogMap.showLegend)\r\n                document.getElementById('mapper-legend').classList.add('active');\r\n\r\n            this._dialogMap.follow = this.client.getOption('mapper.follow');\r\n            if (this._dialogMap.follow)\r\n                document.getElementById('mapper-follow').classList.add('active');\r\n\r\n            this._dialogMap.splitArea = this.client.getOption('mapper.split');\r\n            if (this._dialogMap.splitArea)\r\n                document.getElementById('mapper-split').classList.add('active');\r\n\r\n            this._dialogMap.fillWalls = this.client.getOption('mapper.fill');\r\n            if (this._dialogMap.fillWalls)\r\n                document.getElementById('mapper-fill').classList.add('active');\r\n\r\n            if (this._dialogMap.follow)\r\n                this._dialogMap.focusCurrentRoom();\r\n            this._dialogMap.scale = this.client.getOption('mapper.scale');\r\n            this._map.on('rooms-removed', rooms => {\r\n                this._map.save();\r\n            });\r\n\r\n            this._map.on('areas-removed', areas => {\r\n                const area = document.getElementById('mapper-area') as HTMLSelectElement;\r\n                const roomArea = document.getElementById('mapper-room-area') as HTMLSelectElement;\r\n                if (this._map.Areas.length === 0) {\r\n                    area.innerHTML = '';\r\n                    roomArea.innerHTML = '';\r\n                }\r\n                else {\r\n                    for (var i = area.length - 1; i >= 0; i--) {\r\n                        if (areas.indexOf(area.options[i].value) !== -1)\r\n                            area.remove(i);\r\n                    }\r\n                    for (var i = roomArea.length - 1; i >= 0; i--) {\r\n                        if (areas.indexOf(roomArea.options[i].value) !== -1)\r\n                            roomArea.remove(i);\r\n                    }\r\n                }\r\n            });\r\n            this._map.on('areas-added', areas => {\r\n                //TODO recode to insert the area at correct index instead of rebuilding full list\r\n                let h = '';\r\n                const m = this._map.Areas.length;\r\n                for (let i = 0; i < m; i++)\r\n                    h += `<option value=\"${this._map.Areas[i].replace(/\"/g, '&quot;')}\">${this._map.Areas[i]}</option>`;\r\n                document.getElementById('mapper-area').innerHTML = h;\r\n                document.getElementById('mapper-room-area').innerHTML = h;\r\n                (document.getElementById('mapper-area') as HTMLSelectElement).value = this._dialogMap.active.area;\r\n            });\r\n\r\n            this._map.on('import-progress', progress => {\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.progress = progress;\r\n            });\r\n            this._map.on('import-complete', () => {\r\n                client.sendGMCP('Room.Info');\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.close();\r\n                this._dialogProgress = null;\r\n                this._dialogMap.refresh();\r\n                this._map.save();\r\n            });\r\n            this._map.on('import-canceled', () => {\r\n                client.sendGMCP('Room.Info');\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.close();\r\n                this._dialogProgress = null;\r\n                this._dialogMap.refresh();\r\n                this._map.save();\r\n            });            \r\n        }\r\n\r\n        this.on('map-loaded', () => {\r\n            initMapper();\r\n        });\r\n        if (this.map)\r\n            initMapper();\r\n    }\r\n\r\n    public show() {\r\n        this.createDialog();\r\n        this._dialog.show();\r\n    }\r\n\r\n    private updateMenu(selector, disabled) {\r\n        if (disabled)\r\n            this._dialog.body.querySelector(selector).classList.add('disabled');\r\n        else\r\n            this._dialog.body.querySelector(selector).classList.remove('disabled');\r\n    }\r\n}\r\n\r\nfunction closeMenu() {\r\n    const instance = bootstrap.Offcanvas.getInstance(document.getElementById('mapper-menu'));\r\n    if (!instance) return\r\n    instance.hide();\r\n}\r\n", "import \"./css/client.css\";\r\nimport { EventEmitter } from './events';\r\nimport { Telnet } from './telnet';\r\nimport { AnsiColorCode } from './ansi';\r\nimport { SortItemArrayByPriority, selectAll, getParameterByName } from './library';\r\nimport { Settings } from './settings';\r\nimport { Input } from './input';\r\nimport { ProfileCollection, Alias, Trigger, Alarm, Macro, Profile, Button, Context, TriggerType, SubTriggerTypes } from './profile';\r\nimport { Display } from './display';\r\nimport { Plugin } from './plugin';\r\nimport { version } from '../package.json'\r\n\r\n//import core plugins\r\nimport { MSP } from './plugins/msp';\r\nimport { Test } from './plugins/test';\r\nimport { Mapper } from './plugins/mapper';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        Client;\r\n        client: Client;\r\n        oiMUD: Client;\r\n        Display;\r\n        Test;\r\n        Dialog;\r\n    }\r\n}\r\ndeclare let moment;\r\ndeclare let localforage;\r\n\r\ninterface ClientOptions {\r\n    display: HTMLInputElement | JQuery | string;\r\n    commandInput: HTMLTextAreaElement | JQuery | string;\r\n    host?: string;\r\n    port?: number;\r\n    scheme?: string;\r\n    protocol?: string;\r\n}\r\n\r\ninterface ItemCache {\r\n    alarmPatterns: any[];\r\n    alarms: Trigger[];\r\n    triggers: Trigger[];\r\n    aliases: Alias[];\r\n    macros: Macro[];\r\n    buttons: Button[];\r\n    contexts: Context[];\r\n    defaultContext: boolean;\r\n}\r\n\r\n/**\r\n * Mud client\r\n *\r\n * @export\r\n * @class Client\r\n * @extends {EventEmitter}\r\n */\r\nexport class Client extends EventEmitter {\r\n    //#region Private properties\r\n    private _enableDebug: boolean = false;\r\n    private _input: Input;\r\n    private _telnet: Telnet;\r\n    private _itemCache: ItemCache = {\r\n        triggers: null,\r\n        aliases: null,\r\n        macros: null,\r\n        buttons: null,\r\n        contexts: null,\r\n        defaultContext: null,\r\n        alarms: null,\r\n        alarmPatterns: []\r\n    }\r\n    private _alarm;\r\n    private _commandInput: HTMLTextAreaElement;\r\n    private _display: Display;\r\n    private _profiles: ProfileCollection;\r\n    private _variables = {};\r\n    private _plugins: Plugin[];\r\n    private _options: any = {};\r\n    //#endregion\r\n    //#region Public properties\r\n    public active: boolean = true;\r\n    public connecting: boolean = false;\r\n    public version: string = version;\r\n    public connectTime: number = 0;\r\n    public disconnectTime: number = 0;\r\n    public lastSendTime: number = 0;\r\n    public defaultTitle = 'oiMUD';\r\n    public errored: boolean = false;\r\n    //#endregion\r\n    //#region Public setter/getters\r\n    public get telnet(): Telnet { return this._telnet; }\r\n    public get variables() { return this._variables; }\r\n    public get commandInput(): HTMLTextAreaElement { return this._commandInput; }\r\n    public get display(): Display { return this._display; }\r\n    public get profiles(): ProfileCollection { return this._profiles; }\r\n    public get plugins(): Plugin[] { return this._plugins; }\r\n    public get options(): Settings { return this._options; }\r\n    public get input(): Input { return this._input; }\r\n\r\n\r\n    set simpleAlarms(value) {\r\n        this.setOption('simpleAlarms', value);\r\n    }\r\n\r\n    get simpleAlarms() { return this.getOption('simpleAlarms'); }\r\n\r\n    set enableParsing(value) {\r\n        this.setOption('enableParsing', value);\r\n        this._input.enableParsing = value;\r\n    }\r\n\r\n    get enableParsing() { return this.getOption('enableParsing'); }\r\n\r\n    set enableTriggers(value) {\r\n        this.setOption('enableTriggers', value);\r\n        this._input.enableTriggers = value;\r\n        this.startAlarms();\r\n    }\r\n\r\n    get enableTriggers() { return this.getOption('enableTriggers'); }\r\n\r\n    get enableDebug(): boolean {\r\n        return this._enableDebug;\r\n    }\r\n\r\n    set enableDebug(enable: boolean) {\r\n        this._enableDebug = enable;\r\n        this._telnet.enableDebug = enable;\r\n        this._display.enableDebug = enable;\r\n    }\r\n\r\n    get host(): string {\r\n        return this._telnet.host;\r\n    }\r\n    set host(host: string) {\r\n        this._telnet.host = host;\r\n    }\r\n\r\n    get port(): number {\r\n        return this._telnet.port;\r\n    }\r\n    set port(port: number) {\r\n        this._telnet.port = port;\r\n    }\r\n\r\n    get connected(): boolean {\r\n        return this._telnet.connected;\r\n    }\r\n\r\n    public get activeProfile() {\r\n        return this._profiles.active;\r\n    };\r\n\r\n    public get commandHistory() {\r\n        return this._input.commandHistory;\r\n    }\r\n\r\n    public get indices() {\r\n        return this._input.indices;\r\n    }\r\n\r\n    public get repeatnum() {\r\n        return this._input.repeatnum;\r\n    }\r\n\r\n    get aliases(): Alias[] {\r\n        if (this._itemCache.aliases)\r\n            return this._itemCache.aliases;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableAliases)\r\n                this._itemCache.aliases = [];\r\n            else\r\n                this._itemCache.aliases = SortItemArrayByPriority(this.profiles.items[keys[k]].aliases);\r\n            return this._itemCache.aliases;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableAliases || this.profiles.items[keys[k]].aliases.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].aliases));\r\n        }\r\n        this._itemCache.aliases = tmp;\r\n        return this._itemCache.aliases;\r\n    }\r\n\r\n    get macros(): Macro[] {\r\n        if (this._itemCache.macros)\r\n            return this._itemCache.macros;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableMacros)\r\n                this._itemCache.macros = [];\r\n            else\r\n                this._itemCache.macros = SortItemArrayByPriority(this.profiles.items[keys[k]].macros);\r\n            return this._itemCache.macros;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableMacros || this.profiles.items[keys[k]].macros.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].macros));\r\n        }\r\n        this._itemCache.macros = tmp;\r\n        return this._itemCache.macros;\r\n    }\r\n\r\n    get triggers(): Trigger[] {\r\n        if (this._itemCache.triggers)\r\n            return this._itemCache.triggers;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                this._itemCache.triggers = [];\r\n            else\r\n                this._itemCache.triggers = SortItemArrayByPriority(this.profiles.items[keys[0]].triggers);\r\n            return this._itemCache.triggers;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].triggers));\r\n        }\r\n        this._itemCache.triggers = tmp;\r\n        return this._itemCache.triggers;\r\n    }\r\n\r\n    public removeTrigger(trigger: Trigger) {\r\n        const keys = this.profiles.keys;\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        let idx = -1;\r\n        if (kl === 0)\r\n            return;\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                return;\r\n            idx = this.profiles.items[keys[k]].triggers.indexOf(trigger);\r\n        }\r\n        else\r\n            for (; k < kl && idx !== -1; k++) {\r\n                if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                    continue;\r\n                idx = this.profiles.items[keys[k]].triggers.indexOf(trigger);\r\n                //found trigger bail, or it will keep looking and k index will be wrong profile\r\n                if (idx !== -1)\r\n                    break;\r\n            }\r\n        //check to be sure trigger found\r\n        if (idx === -1)\r\n            return;\r\n        this.profiles.items[keys[k]].triggers.splice(idx, 1);\r\n        this._itemCache.triggers = null;\r\n        //an alarm or has sub types see if cached\r\n        if ((trigger.triggers.length || trigger.type === TriggerType.Alarm) && this._itemCache.alarms) {\r\n            idx = this._itemCache.alarms.indexOf(trigger);\r\n            if (idx !== -1) {\r\n                this._itemCache.alarms.splice(idx, 1);\r\n                this._itemCache.alarmPatterns.splice(idx, 1);\r\n            }\r\n        }\r\n        this.saveProfiles();\r\n        this.emit('item-removed', 'trigger', keys[k], idx);\r\n    }\r\n\r\n    get alarms(): Trigger[] {\r\n        if (this._itemCache.alarms)\r\n            return this._itemCache.alarms;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                this._itemCache.alarms = [];\r\n            else\r\n                this._itemCache.alarms = SortItemArrayByPriority(this.profiles.items[keys[k]].triggers).filter((a: Trigger) => {\r\n                    //has sub triggers of type alarm so cache them for future use as well\r\n                    if (a && a.enabled && a.triggers.length) {\r\n                        if (a.type === TriggerType.Alarm) return true;\r\n                        //loop sub states if one is alarm cache it for future\r\n                        for (let s = 0, sl = a.triggers.length; s < sl; s++)\r\n                            if (a.triggers[s].enabled && a.triggers[s].type === TriggerType.Alarm)\r\n                                return true;\r\n                        return false;\r\n                    }\r\n                    return a && a.enabled && a.type === TriggerType.Alarm;\r\n                });\r\n            this._itemCache.alarms.reverse();\r\n            return this._itemCache.alarms;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].triggers));\r\n        }\r\n        this._itemCache.alarms = tmp.filter((a) => {\r\n            //has sub triggers of type alarm so cache them for future use as well\r\n            if (a && a.enabled && a.triggers.length) {\r\n                if (a.type === TriggerType.Alarm) return true;\r\n                //loop sub states if one is alarm cache it for future\r\n                for (let s = 0, sl = a.triggers.length; s < sl; s++)\r\n                    if (a.triggers[s].enabled && a.triggers[s].type === TriggerType.Alarm)\r\n                        return true;\r\n                return false;\r\n            }\r\n            return a && a.enabled && a.type === TriggerType.Alarm;\r\n        });\r\n        this._itemCache.alarms.reverse();\r\n        return this._itemCache.alarms;\r\n    }\r\n\r\n    get buttons(): Button[] {\r\n        if (this._itemCache.buttons)\r\n            return this._itemCache.buttons;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableButtons)\r\n                this._itemCache.buttons = [];\r\n            else\r\n                this._itemCache.buttons = SortItemArrayByPriority(this.profiles.items[keys[k]].buttons);\r\n            return this._itemCache.buttons;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableButtons || this.profiles.items[keys[k]].buttons.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].buttons));\r\n        }\r\n        this._itemCache.buttons = tmp;\r\n        return this._itemCache.buttons;\r\n    }\r\n\r\n    get contexts(): Context[] {\r\n        if (this._itemCache.contexts)\r\n            return this._itemCache.contexts;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableContexts)\r\n                this._itemCache.contexts = [];\r\n            else\r\n                this._itemCache.contexts = SortItemArrayByPriority(this.profiles.items[keys[k]].contexts);\r\n            return this._itemCache.contexts;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableContexts || this.profiles.items[keys[k]].contexts.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].contexts));\r\n        }\r\n        this._itemCache.contexts = tmp;\r\n        return this._itemCache['contexts'];\r\n    }\r\n\r\n    get defaultContext(): boolean {\r\n        if (this._itemCache.defaultContext !== null)\r\n            return this._itemCache.defaultContext;\r\n        this._itemCache.defaultContext = this.profiles.defaultContext;\r\n        return this._itemCache.defaultContext;\r\n    }\r\n\r\n    //#endregion    \r\n\r\n    public addPlugin(plugin: Plugin) {\r\n        if (!plugin) return;\r\n        this.plugins.push(plugin);\r\n        plugin.initialize();\r\n    }\r\n\r\n    public removePlugin(plugin: Plugin) {\r\n        if (!this.plugins.length) return;\r\n        const idx = this.plugins.indexOf(plugin);\r\n        if (idx !== -1) {\r\n            plugin.remove();\r\n            this.plugins.splice(idx, 1);\r\n        }\r\n    }\r\n\r\n    public getVariable(name: string) {\r\n        return this.variables[name];\r\n    }\r\n\r\n    public setVariable(name: string, value) {\r\n        this.variables[name] = value;\r\n    }\r\n\r\n    public setVariables(variables) {\r\n        const names = Object.keys(variables);\r\n        if (names.length === 0) return;\r\n        const nl = names.length;\r\n        let name;\r\n        for (let n = 0; n < nl; n++) {\r\n            name = names[n];\r\n            this.variables[name] = variables[name];\r\n        }\r\n    }\r\n\r\n    public hasVariable(name: string) {\r\n        return this.variables.hasOwnProperty(name);\r\n    }\r\n\r\n    public removeVariable(name: string) {\r\n        if (!this.variables.hasOwnProperty(name))\r\n            return;\r\n        delete this.variables[name];\r\n    }\r\n\r\n    public setHistoryIndex(index) {\r\n        this._input.setHistoryIndex(index);\r\n    }\r\n\r\n    public clearCommandHistory() {\r\n        this._input.clearCommandHistory();\r\n    }\r\n\r\n    public AddCommandToHistory(txt) {\r\n        this._input.AddCommandToHistory(txt);\r\n    }\r\n\r\n    public loadProfiles() {\r\n        return new Promise((resolve) => {\r\n            ProfileCollection.load().then((profiles: ProfileCollection) => {\r\n                this._profiles = profiles;\r\n                //ensure default exist and is loaded\r\n                if (!this.profiles.contains('default')) {\r\n                    this.profiles.add(Profile.Default);\r\n                    this.saveProfiles();\r\n                }\r\n                this.clearCache();\r\n                this.startAlarms();\r\n                this.emit('profiles-loaded');\r\n                resolve(this._profiles);\r\n            });\r\n        });\r\n    }\r\n\r\n    public removeProfile(profile) {\r\n        if (!profile) return;\r\n        this.profiles.remove(profile);\r\n        this.clearCache();\r\n        this.startAlarms();\r\n        this.emit('profile-removed', profile);\r\n    }\r\n\r\n    public saveProfiles() {\r\n        this._profiles.save();\r\n        this.clearCache();\r\n        this.emit('profiles-updated');\r\n    }\r\n\r\n    public toggleProfile(profile: string) {\r\n        this.profiles.toggle(profile);\r\n        this.saveProfiles();\r\n        this.clearCache();\r\n        this.startAlarms();\r\n        this.emit('profile-toggled', profile, this.profiles[profile].enabled);\r\n    }\r\n\r\n    public startAlarms() {\r\n        const al = this.alarms.length;\r\n        if ((al === 0 || !this.getOption('enableTriggers')) && this._alarm) {\r\n            clearInterval(this._alarm);\r\n            this._alarm = null;\r\n        }\r\n        else if (al && !this._alarm)\r\n            this._alarm = setInterval((client) => { client.process_alarms(); }, 1000, this);\r\n    }\r\n\r\n    public setAlarmState(idx, state: boolean) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        for (const p in pattern) {\r\n            if (!pattern.hasOwnProperty(p)) continue;\r\n            if (state) {\r\n                pattern[p].startTime += Date.now() - pattern[p].suspended;\r\n                pattern[p].prevTime += Date.now() - pattern[p].suspended;\r\n                if (pattern[p].tempTime)\r\n                    pattern[p].tempTime += Date.now() - pattern[p].suspended;\r\n                pattern[p].suspended = 0;\r\n            }\r\n            else\r\n                pattern[p].suspended = Date.now();\r\n        }\r\n    }\r\n\r\n    public setAlarmTempTime(idx, temp: number) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[0])\r\n            pattern[0].setTempTime(temp);\r\n    }\r\n\r\n    public restartAlarmState(idx, oldState, newState) {\r\n        if (oldState === newState)\r\n            return;\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[oldState])\r\n            pattern[oldState].restart = Date.now();\r\n        if (pattern[newState])\r\n            pattern[newState].restart = Date.now();\r\n    }\r\n\r\n    public getRemainingAlarmTime(idx) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return 0;\r\n        if (!this.alarms[idx].enabled)\r\n            return 0;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[0]) {\r\n            const alarm = pattern[0];\r\n            const now = Date.now();\r\n            const dNow = new Date();\r\n            let future = now;\r\n            let fend = future + 90000000;\r\n            let mod = 1000;\r\n            if (alarm.seconds !== -1)\r\n                mod = 1000;\r\n            else if (alarm.minutes !== -1)\r\n                mod = 60000;\r\n            else if (alarm.hours !== -1)\r\n                mod = 3600000;\r\n            if (alarm.tempTime) {\r\n                if (alarm.tempTime - now > 0)\r\n                    return alarm.tempTime - now;\r\n                return 0;\r\n            }\r\n            else {\r\n                while (future < fend) {\r\n                    if (this.alarm_match(alarm, future, dNow))\r\n                        return future - now;\r\n                    future += mod;\r\n                    dNow.setTime(dNow.getTime() + mod);\r\n                }\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    public updateAlarms() {\r\n        if (this._itemCache.alarmPatterns) {\r\n            const old = this._itemCache.alarmPatterns;\r\n            const oAlarms = this.alarms;\r\n            this._itemCache.alarmPatterns = [];\r\n            this._itemCache.alarms = null;\r\n            const al = this.alarms.length;\r\n            let idx = -1;\r\n            for (let a = 0; a < al; a++) {\r\n                idx = oAlarms.indexOf(this.alarms[a]);\r\n                if (idx !== -1)\r\n                    this._itemCache.alarmPatterns[a] = old[idx];\r\n            }\r\n        }\r\n        this.startAlarms();\r\n    }\r\n\r\n    public process_alarms() {\r\n        if (!this.getOption('enableTriggers'))\r\n            return;\r\n        let a = 0;\r\n        let changed = false;\r\n        const al = this.alarms.length;\r\n        if (al === 0 && this._alarm) {\r\n            clearInterval(this._alarm);\r\n            this._alarm = null;\r\n            return;\r\n        }\r\n        const patterns = this._itemCache.alarmPatterns;\r\n        const now = Date.now();\r\n        const alarms = this.alarms;\r\n        const dNow = new Date();\r\n        for (a = al - 1; a >= 0; a--) {\r\n            let trigger = alarms[a];\r\n            const parent = trigger;\r\n            //not enabled skip\r\n            if (!trigger.enabled) continue;\r\n            //safety check in case a state was deleted\r\n            if (trigger.state > trigger.triggers.length)\r\n                trigger.state = 0;\r\n            //get sub state\r\n            if (trigger.state !== 0 && trigger.triggers && trigger.triggers.length) {\r\n                //trigger states are 1 based as 0 is parent trigger\r\n                trigger = trigger.triggers[trigger.state - 1];\r\n                //skip disabled states\r\n                while (!trigger.enabled && parent.state !== 0) {\r\n                    //advance state\r\n                    parent.state++;\r\n                    //if no more states start over and stop\r\n                    if (parent.state > parent.triggers.length) {\r\n                        parent.state = 0;\r\n                        //reset to first state\r\n                        trigger = trigger.triggers[parent.state - 1];\r\n                        //stop checking\r\n                        break;\r\n                    }\r\n                    if (parent.state)\r\n                        trigger = trigger.triggers[parent.state - 1];\r\n                    else\r\n                        trigger = parent;\r\n                    changed = true;\r\n                }\r\n                if (changed) {\r\n                    if (this.getOption('saveTriggerStateChanges'))\r\n                        this.saveProfiles();\r\n                    this.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent));\r\n                }\r\n                //last check to be 100% sure enabled\r\n                if (!trigger.enabled) continue;\r\n            }\r\n            //reparse type\r\n            if (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern) {\r\n                const val = this._input.adjustLastLine(this.display.lines.length, true);\r\n                const line = this.display.lines[val];\r\n                a = this._input.TestTrigger(trigger, parent, a, line, this.display.lines[val].raw || line, val === this.display.lines.length - 1);\r\n                continue;\r\n            }\r\n            //not an alarm either has sub alarms or was updated\r\n            if (trigger.type !== TriggerType.Alarm) continue;\r\n            let alarm = patterns[a];\r\n            //not found build cache\r\n            if (!alarm) {\r\n                try {\r\n                    patterns[a] = {};\r\n                    if (trigger.type === TriggerType.Alarm)\r\n                        patterns[a][0] = Alarm.parse(trigger);\r\n                    for (let s = 0, sl = trigger.triggers.length; s < sl; s++) {\r\n                        if (trigger.triggers[s].type === TriggerType.Alarm)\r\n                            patterns[a][s] = Alarm.parse(trigger.triggers[s]);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    patterns[a] = null;\r\n                    if (this.getOption('disableTriggerOnError')) {\r\n                        trigger.enabled = false;\r\n                        setTimeout(() => {\r\n                            this.saveProfiles();\r\n                            this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\r\n                        });\r\n                    }\r\n                    throw e;\r\n                }\r\n                alarm = patterns[a];\r\n                //what ever reason the alarm failed to create so move on to next alarm\r\n                if (!alarm) continue;\r\n            }\r\n            //we want to sub state pattern\r\n            alarm = alarm[trigger.state];\r\n            if (alarm.restart) {\r\n                alarm.startTime = Date.now();\r\n                alarm.prevTime = alarm.startTime;\r\n                if (alarm.tempTime)\r\n                    alarm.tempTime += Date.now() - alarm.restart;\r\n                alarm.restart = 0;\r\n            }\r\n            let match: boolean = true;\r\n            //a temp time was set so it overrides all matches as once the temp time has been reached end\r\n            if (alarm.tempTime) {\r\n                match = now >= alarm.tempTime;\r\n                if (match)\r\n                    alarm.tempTime = 0;\r\n            }\r\n            else\r\n                match = this.alarm_match(alarm, now, dNow);\r\n            if (match && !alarm.suspended) {\r\n                alarm.prevTime = now;\r\n                //save as if temp alarm as execute trigger advances state and temp alarms will need different state shifts\r\n                const state = parent.state;\r\n                this._input.lastTriggered = alarm.pattern;\r\n                //_Triggered = string.Format(\"{0}:{1}:{2}\", Fired.Hour, Fired.Minute, Fired.Second);\r\n                this._input.ExecuteTrigger(trigger, [alarm.pattern], false, -a, null, null, parent);\r\n                if (state !== parent.state)\r\n                    alarm.restart = Date.now();\r\n                if (alarm.temp) {\r\n                    //has sub state so only remove the temp alarm state\r\n                    if (parent.triggers.length) {\r\n                        if (state === 0) {\r\n                            const item = parent.triggers.shift();\r\n                            //restore previous state as shifted state may have skipped next state\r\n                            item.state = state;\r\n                            item.priority = parent.priority;\r\n                            item.name = parent.name;\r\n                            item.profile = parent.profile;\r\n                            //if removed temp shift state adjust\r\n                            if (item.state > item.triggers.length)\r\n                                item.state = 0;\r\n                            item.triggers = parent.triggers;\r\n                            alarms[a] = item;\r\n                            patterns[a] = null;\r\n                            this.saveProfiles();\r\n                            const idx = parent.profile.triggers.indexOf(parent)\r\n                            parent.profile.triggers[idx] = item;\r\n                            this.emit('item-updated', 'trigger', parent.profile.name, idx, item);\r\n                        }\r\n                        else {\r\n                            parent.triggers.splice(state - 1, 1);\r\n                            patterns[a].splice(state - 1, 1);\r\n                            //restore previous state as shifted state may have skipped next state\r\n                            parent.state = state;\r\n                            //if removed temp shift state adjust\r\n                            if (parent.state > parent.triggers.length)\r\n                                parent.state = 0;\r\n                            this.saveProfiles();\r\n                            const idx = parent.profile.triggers.indexOf(parent);\r\n                            this.emit('item-updated', 'trigger', parent.profile.name, idx, parent);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this._input.clearTriggerState(a);\r\n                        this.removeTrigger(parent);\r\n                    }\r\n                }\r\n                //remove after temp as temp requires old index\r\n                a = -this._input.cleanUpTriggerState(-a);\r\n            }\r\n        }\r\n    }\r\n\r\n    private alarm_match(alarm, now, dNow) {\r\n        if (!alarm || alarm.suspended) return false;\r\n        let match: boolean = true;\r\n        let ts;\r\n        let sec;\r\n        let min;\r\n        let hr;\r\n        let hours;\r\n        let minutes;\r\n        let seconds;\r\n        //no moment fall back to simple math\r\n        if (!moment || this.simpleAlarms) {\r\n            ts = now - this.connectTime;\r\n            if (ts < 1000)\r\n                return false;\r\n            sec = Math.round(ts / 1000);\r\n            min = Math.floor(sec / 60);\r\n            hr = Math.floor(min / 60);\r\n            hours = hr;\r\n            minutes = Math.floor(min % 60);\r\n            seconds = Math.floor(sec % 60);\r\n        }\r\n        else {\r\n            if (alarm.start)\r\n                ts = moment.duration(now - this.connectTime);\r\n            else\r\n                ts = moment.duration(now - alarm.startTime);\r\n            if (ts.asMilliseconds() < 1000)\r\n                return false;\r\n            sec = Math.round(ts.asMilliseconds() / 1000);\r\n            min = Math.floor(sec / 60);\r\n            hr = Math.floor(min / 60);\r\n            hours = ts.hours();\r\n            minutes = ts.minutes();\r\n            seconds = ts.seconds();\r\n        }\r\n        if (alarm.hoursWildCard) {\r\n            if (alarm.hours === 0)\r\n                match = match && hours === 0;\r\n            else if (alarm.hours !== -1)\r\n                match = match && hr !== 0 && hr % alarm.hours === 0;\r\n        }\r\n        else if (alarm.hours !== -1)\r\n            match = match && alarm.hours === (alarm.start ? hours : dNow.getHours());\r\n        if (alarm.minutesWildcard) {\r\n            if (alarm.minutes === 0)\r\n                match = match && minutes === 0;\r\n            else if (alarm.minutes !== -1)\r\n                match = match && min !== 0 && min % alarm.minutes === 0;\r\n        }\r\n        else if (alarm.minutes !== -1)\r\n            match = match && alarm.minutes === (alarm.start ? minutes : dNow.getMinutes());\r\n        if (alarm.secondsWildcard) {\r\n            if (alarm.seconds === 0)\r\n                match = match && seconds === 0;\r\n            else if (alarm.seconds !== -1)\r\n                match = match && sec % alarm.seconds === 0;\r\n        }\r\n        else if (alarm.seconds !== -1)\r\n            match = match && alarm.seconds === (alarm.start ? seconds : dNow.getSeconds());\r\n        return match;\r\n    }\r\n\r\n    constructor(options?: ClientOptions) {\r\n        super();\r\n        window.client = this;\r\n        window.oiMUD = this;\r\n        this._plugins = [];\r\n        options = Object.assign({ display: '#display', commandInput: '#commandInput' }, options || {});\r\n        if (!('display' in options) || typeof options.display === undefined)\r\n            options.display = '#display';\r\n        if (!('commandInput' in options) || typeof options.commandInput === undefined)\r\n            options.commandInput = '#commandInput';\r\n\r\n        this._display = new Display(options.display);\r\n\r\n        this.display.on('click', e => {\r\n            if (this.getOption('CommandonClick'))\r\n                this._commandInput.focus();\r\n        });\r\n        this.display.on('scroll-lock', (lock) => {\r\n            this.scrollLock = lock;\r\n        });\r\n        this.display.on('update-window', (width, height) => {\r\n            this.telnet.updateWindow(width, height);\r\n        });\r\n\r\n        this.display.on('update-window', (width, height) => {\r\n            this.telnet.updateWindow(width, height);\r\n        });\r\n\r\n        this.display.on('debug', (msg) => { this.debug(msg); });\r\n        this.display.on('add-line', data => {\r\n            this.emit('add-line', data);\r\n        });\r\n        this.display.on('add-line-done', data => {\r\n            this.emit('add-line-done', data);\r\n        });\r\n        this.display.on('MXP-tag-reply', (tag, args) => {\r\n            const e = { tag: tag, args: args, preventDefault: false };\r\n            this.emit('MXP-tag-reply', e);\r\n            if (e.preventDefault)\r\n                return;\r\n            switch (tag) {\r\n                case 'VERSION':\r\n                    if (this.display.MXPStyleVersion && this.display.MXPStyleVersion.length) {\r\n                        this.debug(`MXP Tag REPLY: <VERSION MXP=1.0 STYLE=${this.display.MXPStyleVersion} CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>`);\r\n                        this.send(`\\x1b[1z<VERSION MXP=1.0 STYLE=${this.display.MXPStyleVersion} CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>\\r\\n`);\r\n                    }\r\n                    else {\r\n                        this.debug(`MXP Tag REPLY: <VERSION MXP=1.0 CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>`);\r\n                        this.send(`\\x1b[1z<VERSION MXP=1.0 CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>\\r\\n`);\r\n                    }\r\n                    break;\r\n                case 'SUPPORT':\r\n                    this.debug(`MXP Tag REPLY: <SUPPORTS ${args.join(' ')}>`);\r\n                    this.send(`\\x1b[1z<SUPPORTS ${args.join(' ')}>\\r\\n`);\r\n                    break;\r\n                case 'USER':\r\n                    this.emit('sendUsername', e);\r\n                    break;\r\n                case 'PASSWORD':\r\n                    this.emit('sendPassword', e);\r\n                    break;\r\n            }\r\n        });\r\n        this.display.on('expire-links', (args) => {\r\n            this.emit('expire-links', args);\r\n        });\r\n\r\n        this.display.on('parse-done', () => {\r\n            this.emit('parse-done');\r\n        });\r\n        this.display.on('set-title', (title, type) => {\r\n            if (typeof title === 'undefined' || title == null || title.length === 0)\r\n                this.emit('set-title', this.getOption('title').replace('$t', this.defaultTitle) || this.defaultTitle);\r\n            else if (type !== 1)\r\n                this.emit('set-title', this.getOption('title').replace('$t', title) || '')\r\n        });\r\n        this.display.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this.display.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this.display.on('bell', () => {\r\n            this.emit('bell');\r\n        });\r\n\r\n        if (typeof options.commandInput === 'string') {\r\n            this._commandInput = document.querySelector(options.commandInput) as HTMLTextAreaElement;\r\n            if (!this._commandInput)\r\n                throw new Error('Invalid selector for command input.');\r\n        }\r\n        else if (options.commandInput instanceof $)\r\n            this._commandInput = options.commandInput[0];\r\n        else if (options.commandInput instanceof HTMLElement)\r\n            this._commandInput = options.commandInput as HTMLTextAreaElement;\r\n        else\r\n            throw new Error('Command input must be a selector, element or jquery object');\r\n\r\n        this._telnet = new Telnet({ protocol: options.protocol, scheme: options.scheme });\r\n        this._telnet.terminal = 'oiMUD';\r\n        this._telnet.version = this.version;\r\n        this._telnet.GMCPSupports.push('oMUD 1');\r\n\r\n        this._telnet.on('error', (err) => {\r\n            if (this.enableDebug) this.debug(err);\r\n            if (err) {\r\n                if (err.type === 'close' && err.code === 1006)\r\n                    return;\r\n                const msg = [];\r\n                if (err.type)\r\n                    msg.push(err.type);\r\n                if (err.text)\r\n                    msg.push(err.text);\r\n                if (err.message)\r\n                    msg.push(err.message);\r\n                if (err.reason)\r\n                    msg.push(err.reason);\r\n                if (err.code)\r\n                    this.error(err.code + ' : ' + msg.join(', '));\r\n                else\r\n                    this.error(msg.join(', '));\r\n            }\r\n            else\r\n                this.error('Unknown telnet error.');\r\n            if (this.getOption('autoConnect') && !this._telnet.connected)\r\n                setTimeout(() => { this.connect(); }, client.getOption('autoConnectDelay'));\r\n            this.emit('reconnect');\r\n        });\r\n        this.telnet.on('connecting', () => {\r\n            this.connecting = true;\r\n            this.echo('Trying to connect to ' + this.host + ':' + this.port, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n        });\r\n        this.telnet.on('connect', () => {\r\n            this.connecting = false;\r\n            this.echo('Connected...', AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n            this.connectTime = Date.now();\r\n            this.disconnectTime = 0;\r\n            this.lastSendTime = Date.now();\r\n            this.emit('connected');\r\n            this.raise('connected');\r\n        });\r\n\r\n        this.telnet.on('debug', msg => {\r\n            this.debug(msg);\r\n        });\r\n        this.telnet.on('receive-option', data => {\r\n            this.emit('received-option', data);\r\n        });\r\n        this.telnet.on('close', () => {\r\n            this.connecting = false;\r\n            this.echo('Connection closed to ' + this.host + ':' + this.port, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n            this.disconnectTime = Date.now();\r\n            this.emit('closed');\r\n            this.raise('disconnected');\r\n            //clear after in case events need the times\r\n            this.connectTime = 0;\r\n            this.lastSendTime = 0;\r\n        });\r\n        this.telnet.on('received-data', data => {\r\n            data = { value: data };\r\n            this.emit('received-data', data);\r\n            if (data == null || typeof data === 'undefined' || data.value == null || typeof data.value === 'undefined')\r\n                return;\r\n            this.printInternal(data.value, false, true);\r\n            this.debug('Latency: ' + this.telnet.latency + 'ms');\r\n            this.debug('Latency: ' + (this.telnet.latency / 1000) + 's');\r\n        });\r\n        this.telnet.on('received-MSDP', data => {\r\n            this.emit('received-MSDP', data);\r\n        });\r\n        this.telnet.on('received-GMCP', data => {\r\n            let val: string = data.value;\r\n            let mod: string;\r\n            let idx: number = 0;\r\n            const dl: number = val.length;\r\n            let c;\r\n            if (dl === 0) return;\r\n            for (idx = 0; idx < dl; idx++) {\r\n                c = val.charAt(idx);\r\n                if (c === ' ' || c === '{' || c === '[')\r\n                    break;\r\n            }\r\n            mod = val.substr(0, idx).trim();\r\n            val = val.substr(idx).trim();\r\n            this.debug('GMCP Module: ' + mod);\r\n            this.debug('GMCP Data: ' + val);\r\n            let obj;\r\n            if (mod.toLowerCase() === 'client.gui') {\r\n                obj = val.split('/n');\r\n                if (val.length >= 2) {\r\n                    obj = {\r\n                        version: parseInt(obj[0], 10),\r\n                        url: obj[1]\r\n                    };\r\n                }\r\n                else if (val.length > 0) {\r\n                    obj = {\r\n                        version: parseInt(obj[0], 10),\r\n                        url: obj[1]\r\n                    };\r\n                }\r\n                else\r\n                    obj = { version: obj, url: '' };\r\n                this.emit('received-GMCP', mod, obj);\r\n                return;\r\n            }\r\n            try {\r\n                if (val.length > 0)\r\n                    obj = JSON.parse(val);\r\n            }\r\n            catch (e) {\r\n                this.error('Invalid GMCP');\r\n                return;\r\n            }\r\n            this.emit('received-GMCP', mod, obj);\r\n        });\r\n        this.telnet.on('windowSize', () => { this.UpdateWindow(); });\r\n\r\n        let tmp: any = getParameterByName('host');\r\n        if (tmp !== null && tmp.length)\r\n            this.host = tmp;\r\n        else if (options && 'host' in options)\r\n            this.host = options.host;\r\n        else\r\n            this.host = '127.0.0.1';\r\n        tmp = +getParameterByName('port');\r\n        if (!isNaN(tmp) && tmp > 0)\r\n            this.port = tmp;\r\n        else if (options && 'port' in options)\r\n            this.port = options.port;\r\n        else\r\n            this.port = 23;\r\n\r\n        this._input = new Input(this);\r\n        this._input.on('scroll-lock', (lock) => {\r\n            this.display.scrollLock = lock;\r\n            this.emit('scroll-lock', lock);\r\n        });\r\n        this._input.on('command-history-changed', history => this.emit('command-history-changed', history));\r\n\r\n        this._input.on('item-added', (type, profile, item) => {\r\n            this.emit('item-added', type, profile, item);\r\n        });\r\n\r\n        this._input.on('item-updated', (type, profile, idx, item) => {\r\n            this.emit('item-updated', type, profile, idx, item);\r\n        });\r\n\r\n        this._input.on('item-removed', (type, profile, idx) => {\r\n            this.emit('item-removed', type, profile, idx);\r\n        });\r\n        this.loadOptions();\r\n        this._commandInput.value = '';\r\n        this._commandInput.focus();\r\n        window.addEventListener('blur', () => {\r\n            this.active = false;\r\n            this.emit('blur');\r\n            this.raise('blur');\r\n        });\r\n        window.addEventListener('focus', () => {\r\n            this.active = true;\r\n            this.emit('focus');\r\n            this.raise('focus');\r\n        });\r\n        window.addEventListener('beforeunload', e => {\r\n            if (this.connected) {\r\n                if (e)\r\n                    e.returnValue = 'Closing or reloading will disconnect you from the mud.';\r\n                return 'Closing or reloading will disconnect you from the mud.';\r\n            }\r\n            this.raise('closed');\r\n        });\r\n        window.addEventListener('unload', () => {\r\n            if (this.connected)\r\n                this.close();\r\n        })\r\n        //Add core plugins\r\n        this.addPlugin(new MSP(this));\r\n        this.addPlugin(new Mapper(this));\r\n        if (DEBUG || TEST)\r\n            this.addPlugin(new Test(this));\r\n        if (this.getOption('autoConnect'))\r\n            setTimeout(() => { this.connect(); }, client.getOption('autoConnectDelay'));\r\n        this.emit('initialized');\r\n    }\r\n\r\n    public loadOptions() {\r\n        this._options = new Settings();\r\n\r\n        this.enableDebug = this._options.enableDebug;\r\n        this.display.maxLines = this._options.bufferSize;\r\n        this.display.enableFlashing = this._options.flashing;\r\n        this.display.enableMXP = this._options.enableMXP;\r\n        this.display.showInvalidMXPTags = this._options['display.showInvalidMXPTags'];\r\n        this.display.enableURLDetection = this._options.enableURLDetection;\r\n        this.display.enableMSP = this._options.enableMSP;\r\n        this.display.enableColors = this._options['display.enableColors'];\r\n        this.display.enableBackgroundColors = this._options['display.enableBackgroundColors'];\r\n\r\n        this.display.wordWrap = this._options['display.wordWrap'];\r\n        this.display.wrapAt = this._options['display.wrapAt'];\r\n        this.display.indent = this._options['display.indent'];\r\n        this.display.showTimestamp = this._options['display.showTimestamp'];\r\n        this.display.tabWidth = this._options['display.tabWidth'];\r\n        this.display.timestampFormat = this._options['display.timestampFormat'];\r\n        const colors = this.getOption('colors');\r\n        if (colors && colors.length > 0) {\r\n            let c;\r\n            const cl = colors.length;\r\n            for (c = 0; c < cl; c++) {\r\n                if (!colors[c] || colors[c].length === 0) continue;\r\n                this.display.SetColor(c, colors[c]);\r\n            }\r\n        }\r\n\r\n        if (this._telnet) {\r\n            this._telnet.options.MCCP = this._options.enableMCCP;\r\n            this._telnet.options.MXP = this._options.enableMXP;\r\n            this._telnet.UTF8 = this._options.enableUTF8;\r\n            this._telnet.options.ECHO = this._options.enableEcho;\r\n            this._telnet.enableLatency = this._options.lagMeter;\r\n            this._telnet.enablePing = this._options.enablePing;\r\n        }\r\n        this._input.scrollLock = this._options.scrollLocked;\r\n        this._input.enableParsing = this._options.enableParsing;\r\n        this._input.enableTriggers = this._options.enableTriggers;\r\n        this.display.scrollLock = this._options.scrollLocked;\r\n        this.display.hideTrailingEmptyLine = this._options['display.hideTrailingEmptyLine'];\r\n        this.display.displayControlCodes = this.getOption('display.displayControlCodes');\r\n        this.display.emulateTerminal = this.getOption('display.emulateTerminal');\r\n        this.display.emulateControlCodes = this.getOption('display.emulateControlCodes');\r\n\r\n        this._commandInput.wrap = this.getOption('commandWordWrap') ? 'on' : 'off';\r\n\r\n        if (this.UpdateFonts) this.UpdateFonts();\r\n        this.display.scrollDisplay();\r\n        this.loadProfiles();\r\n        this.emit('options-loaded');\r\n    }\r\n\r\n    public setOption(name, value) {\r\n        if (name === -1 || name === '-1')\r\n            return;\r\n        this._options[name] = value;\r\n        Settings.setValue(name, value);\r\n        this.emit('option=changed', name, value);\r\n    }\r\n\r\n    public getOption(name: string): any {\r\n        if (this._options && name in this._options)\r\n            return this._options[name];\r\n        return this._options[name] = Settings.getValue(name);\r\n    }\r\n\r\n    public UpdateFonts() {\r\n        //can only update if display has been setup\r\n        if (!this.display) return;\r\n        this.display.updateFont(this._options.font + ', monospace', this._options.fontSize);\r\n        this._commandInput.style.fontSize = this._options.cmdfontSize;\r\n        this._commandInput.style.fontFamily = this._options.cmdfont + ', monospace';\r\n    }\r\n\r\n    public parse(txt: string) {\r\n        this.parseInternal(txt, false, false, true);\r\n    }\r\n\r\n    private parseInternal(txt: string, remote: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this.display.append(txt, remote, force, prependSplit);\r\n    }\r\n\r\n    public error(err: any) {\r\n        if (this.enableDebug) this.debug(err);\r\n        let msg = '';\r\n        if (err == null || typeof err === 'undefined')\r\n            err = new Error('Unknown');\r\n        else if (typeof err === 'string' && err.length === 0)\r\n            err = new Error('Unknown');\r\n        if (err.stack && this.getOption('showErrorsExtended'))\r\n            msg = err.stack;\r\n        else if (err instanceof Error || err instanceof TypeError)\r\n            msg = err.name + ': ' + err.message;\r\n        else if (err.message)\r\n            msg = err.message;\r\n        else\r\n            msg = '' + err;\r\n\r\n        if (msg.match(/^.*Error: /g) || msg.match(/^.*Error - /g))\r\n            this.echo(msg, AnsiColorCode.ErrorText, AnsiColorCode.ErrorBackground, true, true);\r\n        else\r\n            this.echo('Error: ' + msg, AnsiColorCode.ErrorText, AnsiColorCode.ErrorBackground, true, true);\r\n\r\n        if (this.getOption('logErrors')) {\r\n            if (!this.getOption('showErrorsExtended')) {\r\n                if (err.stack)\r\n                    msg = err.stack;\r\n                else {\r\n                    err = new Error(err || msg);\r\n                    msg = err.stack;\r\n                }\r\n            }\r\n            else if (!err.stack) {\r\n                err = new Error(err || msg);\r\n                msg = err.stack;\r\n            }\r\n            window.console.log(new Date().toLocaleString());\r\n            window.console.log(msg);\r\n            localforage.getItem('oiMUDErrorLog', function (err, value) {\r\n                localforage.setItem('oiMUDErrorLog', value = (value || '') + new Date().toLocaleString() + '\\n' + msg + '\\n');\r\n            });\r\n        }\r\n        if (err === 'Error: ECONNRESET - read ECONNRESET.' && this.telnet.connected)\r\n            this.close();\r\n        this.raise('error', msg);\r\n    }\r\n\r\n    public echo(str: string, fore?: number, back?: number, newline?: boolean, forceLine?: boolean) {\r\n        if (str == null) str = '';\r\n        if (newline == null) newline = false;\r\n        if (forceLine == null) forceLine = false;\r\n        if (fore == null) fore = AnsiColorCode.LocalEcho;\r\n        if (back == null) back = AnsiColorCode.LocalEchoBack;\r\n        const codes = '\\x1b[0m' + this.display.CurrentAnsiCode() + '\\n';\r\n        //make its a string in case raw js passes number or something else\r\n        str = '' + str;\r\n        if (str.endsWith('\\n'))\r\n            str = str.substr(0, str.length - 1);\r\n        if (this.telnet.prompt && forceLine) {\r\n            this.print('\\n\\x1b[' + fore + ';' + back + 'm' + str + codes, newline);\r\n            this.telnet.prompt = false;\r\n        }\r\n        else\r\n            this.print('\\x1b[' + fore + ';' + back + 'm' + str + codes, newline);\r\n    }\r\n\r\n    public print(txt: string, newline?: boolean) {\r\n        this.printInternal(txt, newline, false, true);\r\n    }\r\n\r\n    private printInternal(txt: string, newline?: boolean, remote?: boolean, prependSplit?: boolean) {\r\n        if (txt == null || typeof txt === 'undefined') return;\r\n        if (newline == null) newline = false;\r\n        if (remote == null) remote = false;\r\n        if (newline && this.display.textLength > 0 && !this.display.EndOfLine && this.display.EndOfLineLength !== 0 && !this.telnet.prompt && !this.display.parseQueueEndOfLine)\r\n            txt = '\\n' + txt;\r\n        this.emit('print');\r\n        this.parseInternal(txt, remote, false, prependSplit);\r\n    }\r\n\r\n    public send(data, echo?: boolean) {\r\n        this.telnet.sendData(data);\r\n        this.lastSendTime = Date.now();\r\n        if (echo && this.telnet.echo && this.getOption('commandEcho'))\r\n            this.echo(data);\r\n        else if (echo)\r\n            this.echo('\\n');\r\n    }\r\n\r\n    public sendRaw(data) {\r\n        this.telnet.sendData(data, true);\r\n        this.lastSendTime = Date.now();\r\n    }\r\n\r\n    public sendGMCP(data) {\r\n        this.telnet.sendGMCP(data);\r\n        this.lastSendTime = Date.now();\r\n    }\r\n\r\n    public debug(str: string, style?) {\r\n        const data = { value: str };\r\n        this.emit('debug', data);\r\n        if (!this._enableDebug || data == null || typeof data === 'undefined' || data.value == null || typeof data.value === 'undefined' || data.value.length === 0)\r\n            return;\r\n        if (window.console) {\r\n            if (style)\r\n                window.console.log('%c' + str, style);\r\n            else\r\n                window.console.log(data.value);\r\n        }\r\n    }\r\n\r\n    public sendCommand(txt?: string, noEcho?: boolean, comments?: boolean) {\r\n        if (txt == null) {\r\n            txt = this._commandInput.value;\r\n            if (!this.telnet.echo)\r\n                this._commandInput.value = '';\r\n            else\r\n                this._input.AddCommandToHistory(txt);\r\n        }\r\n        //make its a string in case raw js passes number or something else\r\n        txt = '' + txt;\r\n        if (!txt.endsWith('\\n'))\r\n            txt = txt + '\\n';\r\n        const data = { value: txt, handled: false, comments: comments };\r\n        this.emit('parse-command', data);\r\n        if (data == null || typeof data === 'undefined') return;\r\n        if (data.handled || data.value == null || typeof data.value === 'undefined') return;\r\n        if (data.value.length > 0)\r\n            this.send(data.value, !noEcho);\r\n        if (!this.getOption('keepLastCommand'))\r\n            this._commandInput.value = '';\r\n        else if (this.getOption('selectLastCommand'))\r\n            selectAll(this._commandInput);\r\n    }\r\n\r\n    public sendBackground(txt: string, noEcho?: boolean, comments?: boolean) {\r\n        if (txt == null) {\r\n            txt = this._commandInput.value;\r\n            if (!this.telnet.echo)\r\n                this._commandInput.value = '';\r\n            else\r\n                this._input.AddCommandToHistory(txt);\r\n        }\r\n        //make its a string in case raw js passes number or something else\r\n        txt = '' + txt;\r\n        if (!txt.endsWith('\\n'))\r\n            txt = txt + '\\n';\r\n        const data = { value: txt, handled: false, comments: comments };\r\n        this.emit('parse-command', data);\r\n        if (data == null || typeof data === 'undefined') return;\r\n        if (data.value == null || typeof data.value === 'undefined') return;\r\n        if (!data.handled && data.value.length > 0)\r\n            this.send(data.value, !noEcho);\r\n    }\r\n\r\n    get scrollLock(): boolean {\r\n        return this._input.scrollLock;\r\n    }\r\n\r\n    set scrollLock(enabled: boolean) {\r\n        this._input.scrollLock = enabled;\r\n    }\r\n\r\n    public toggleScrollLock() {\r\n        this._input.toggleScrollLock();\r\n    }\r\n\r\n    public UpdateWindow() {\r\n        this.display.updateWindow();\r\n    }\r\n\r\n    public close() {\r\n        this.telnet.close();\r\n    }\r\n\r\n    public connect() {\r\n        this.errored = false;\r\n        this.emit('connecting');\r\n        this.display.ClearMXP();\r\n        this.display.ResetMXPLine();\r\n        this.telnet.connect();\r\n        this.emit('connect');\r\n        this._commandInput.focus();\r\n    }\r\n\r\n    public receivedData(data) {\r\n        this.telnet.receivedData(data);\r\n    }\r\n\r\n    public notify(title: string, message: string, options?: NotificationOptions) {\r\n        if (this.enableDebug) {\r\n            this.emit('debug', 'notify title: ' + title);\r\n            this.emit('debug', 'notify msg: ' + message);\r\n        }\r\n        this.emit('notify', title, message, options);\r\n    }\r\n\r\n    public clear() {\r\n        this.display.clear();\r\n        this.emit('cleared');\r\n    }\r\n\r\n    public parseInline(text: string) {\r\n        return this._input.parseInline(text);\r\n    }\r\n\r\n    public parseOutgoing(text: string, eAlias?: boolean, stacking?: boolean, noFunction?: boolean) {\r\n        return this._input.parseOutgoing(text, eAlias, stacking, noFunction);\r\n    }\r\n\r\n    public clearCache() {\r\n        this._input.clearCaches();\r\n        this._itemCache = {\r\n            triggers: null,\r\n            aliases: null,\r\n            macros: null,\r\n            buttons: null,\r\n            contexts: null,\r\n            defaultContext: null,\r\n            alarms: null,\r\n            alarmPatterns: []\r\n        };\r\n    };\r\n\r\n    public beep() {\r\n        this.emit('bell');\r\n    }\r\n\r\n    public raise(event: string, args?, delay?: number) {\r\n        //if profiles not loaded, try again until loaded as profiles are loaded async\r\n        if (!this.profiles) {\r\n            setTimeout(() => {\r\n                this.raise(event, args, delay);\r\n            }, 100);\r\n            return;\r\n        }\r\n        if (!delay || delay < 1)\r\n            this._input.triggerEvent(event, args);\r\n        else\r\n            setTimeout(() => {\r\n                this._input.triggerEvent(event, args);\r\n            }, delay);\r\n    }\r\n\r\n    public show() {\r\n        this.emit('show');\r\n    }\r\n\r\n    public hide() {\r\n        this.emit('hide');\r\n    }\r\n\r\n    public toggle() {\r\n        this.emit('toggle');\r\n    }\r\n}\r\nwindow.Client = Client;\r\nwindow.Display = Display;"],
  "mappings": "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uD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,OACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACXuD,EAAI,SACCvD,IAAM,IACX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AAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,aACV,OAAU,SACV,OAAU,QACV,OAAU,OACV,OAAU,mBACV,OAAU,gBACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,iBACV,OAAU,iBACV,OAAU,iBACV,OAAU,WACV,OAAU,aACV,OAAU,mBACV,OAAU,aACV,OAAU,iBACV,OAAU,kBACV,OAAU,WACV,OAAU,aACV,OAAU,cACV,OAAU,cACV,OAAU,aACV,OAAU,aACV,OAAU,kBACV,OAAU,MACV,OAAU,YACV,OAAU,oBACV,OAAU,UACV,OAAU,cACV,OAAU,SACV,OAAU,cACV,OAAU,aACV,OAAU,WACV,OAAU,gBACV,OAAU,gBACV,OAAU,gBACV,OAAU,iBACV,OAAU,eACV,OAAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,OACV,OAAU,aACV,OAAU,eACV,OAAU,OACV,OAAU,mBACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,iBACV,OAAU,iBACV,OAAU,aACV,OAAU,iBACV,OAAU,eACV,OAAU,mBACV,OAAU,aACV,OAAU,iBACV,OAAU,iBACV,OAAU,iBACV,OAAU,cACV,OAAU,YACV,OAAU,YACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,cACV,OAAU,aACV,OAAU,WACV,OAAU,WACV,OAAU,SACV,OAAU,gBACV,OAAU,SACV,OAAU,sBACV,OAAU,aACV,OAAU,OACV,OAAU,OACV,OAAU,SACV,OAAU,OACV,OAAU,kBACV,OAAU,MACV,OAAU,aACV,OAAU,UACV,OAAU,OACV,OAAU,SACV,OAAU,QACV,OAAU,kBACV,OAAU,eACV,OAAU,OACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,mBACV,OAAU,iBACV,OAAU,WACV,OAAU,aACV,OAAU,MACV,OAAU,YACV,OAAU,YACV,OAAU,YACV,OAAU,UACV,OAAU,UACV,OAAU,YACV,OAAU,aACV,OAAU,aACV,OAAU,WACV,OAAU,WACV,OAAU,gBACV,OAAU,cACV,OAAU,SACV,OAAU,cACV,OA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",
  "names": ["require_inflate_stream_min", "__commonJSMin", "exports", "k", "l", "aa", "s", "a", "d", "b", "c", "e", "x", "y", "g", "f", "p", "h", "q", "m", "n", "r", "B", "z", "A", "H", "I", "ba", "ca", "V", "K", "W", "w", "D", "E", "C", "u", "t", "X", "O", "L", "Y", "F", "M", "G", "N", "P", "da", "Z", "v", "$", "ea", "fa", "ga", "ha", "ia", "ja", "ka", "la", "ma", "Q", "R", "na", "S", "T", "oa", "U", "require_buzz", "__commonJSMin", "exports", "module", "context", "factory", "AudioContext", "buzz", "src", "options", "doc", "pid", "events", "eventsOnce", "supported", "volume", "value", "time", "set", "percent", "duration", "timerangeToArray", "key", "types", "func", "self", "efunc", "e", "t", "type", "idx", "i", "namespace", "detail", "eventType", "evt", "to", "callback", "from", "delay", "doFade", "sound", "source", "getExt", "timeRange", "array", "length", "filename", "audioCtx", "j", "k", "sounds", "argsToArray", "soundArray", "a", "fn", "speed", "args", "withHours", "h", "m", "s", "splits", "total", "decimal", "r", "require_pathfinding3D", "__commonJSMin", "exports", "module", "e", "define", "ses", "bootstrap", "t", "n", "i", "s", "o", "__require", "r", "u", "require", "Heap", "defaultCmp", "floor", "heapify", "heappop", "heappush", "heappushpop", "heapreplace", "insort", "min", "nlargest", "nsmallest", "updateItem", "_siftdown", "_siftup", "x", "y", "a", "lo", "hi", "cmp", "mid", "array", "item", "lastelt", "returnitem", "_ref", "_i", "_j", "_len", "_ref1", "_results", "_results1", "pos", "elem", "result", "los", "startpos", "newitem", "parent", "parentpos", "childpos", "endpos", "rightpos", "heap", "Node", "Grid", "width", "height", "depth", "matrix", "j", "z", "nodes", "row", "d", "walkable", "node", "allowDiagonal", "dontCrossCorners", "neighbors", "s0", "d0", "s1", "d1", "s2", "d2", "s3", "d3", "s4", "s5", "thisNodes", "newGrid", "newNodes", "dx", "dy", "dz", "backtrace", "path", "biBacktrace", "nodeA", "nodeB", "pathA", "pathB", "pathLength", "sum", "getLine", "x1", "y1", "z1", "x2", "y2", "z2", "ListOfPoints", "xs", "ys", "zs", "p1", "p2", "smoothenPath", "grid", "len", "x0", "y0", "z0", "sx", "sy", "sz", "Util", "Heuristic", "AStarFinder", "opt", "startX", "startY", "startZ", "endX", "endY", "endZ", "openList", "startNode", "endNode", "heuristic", "weight", "abs", "SQRT2", "neighbor", "l", "ng", "BestFirstFinder", "orig", "BiAStarFinder", "startOpenList", "endOpenList", "BY_START", "BY_END", "BiBestFirstFinder", "BiBreadthFirstFinder", "BiDijkstraFinder", "BreadthFirstFinder", "DijkstraFinder", "IDAStarFinder", "nodesVisited", "startTime", "h", "b", "cost", "search", "g", "cutoff", "route", "f", "end", "k", "neighbour", "neighbours", "start", "cutOff", "JumpPointFinder", "px", "py", "pz", "jx", "jy", "nx", "ny", "nz", "EventEmitter", "#events", "type", "listener", "caller", "args", "events", "i", "len", "key", "fun", "len", "res", "thisp", "i", "val", "SortArrayByPriority", "a", "b", "SortMapByPriority", "SortItemArrayByPriority", "list", "map", "el", "FilterArrayByKeyValue", "array", "k", "v", "al", "_edCache", "htmlEncode", "value", "_edCache", "htmlDecode", "stripQuotes", "str", "offset", "el", "box", "docElem", "StringBuffer", "string", "b", "arr", "CharAllowedInURL", "chr", "proto", "i", "keyCodeToChar", "keyCharToCode", "$", "clone", "obj", "replacer", "copy", "o", "output", "v", "key", "setSelectionRange", "input", "selectionStart", "selectionEnd", "range", "selectAll", "x", "y", "w", "h", "r", "o", "k", "p", "obj", "str", "idx", "s", "rem", "paddingValue", "newStr", "addSlashes", "string", "all", "sep", "type", "escape", "escapeChar", "quote", "sQuote", "pS", "c", "pC", "sp", "spl", "spC", "tl", "getTimeSpan", "i", "al", "tmp", "capitalize", "s", "first", "c", "i", "p", "il", "pl", "splitQuoted", "str", "sep", "ec", "q", "sq", "strings", "ps", "s", "sl", "c", "spl", "sp", "getCursor", "el", "oSel", "_colorCodes", "pinkfishToHTML", "text", "loadColors", "stack", "codes", "t", "tl", "bold", "boldNest", "classes", "cl", "c", "color", "r", "g", "b", "idx", "getColors", "_ColorTable", "formatUnit", "str", "ch", "isValidIdentifier", "str", "insertValue", "input", "value", "active", "arg", "txtDecoder", "ArrayBufferToString", "buffer", "BinaryToString", "BinaryToString", "binary", "error", "_error", "StringToBinary", "string", "chars", "code", "i", "isUCS2", "len", "_i", "txtEncoder", "StringToUint8Array", "binLen", "buffer", "copyText", "text", "resolve", "reject", "blob", "data", "permission", "textarea", "e", "err", "pasteText", "getParameterByName", "name", "url", "regex", "results", "fSaveAs", "DownloadAttributeSupport", "BlobBuilder", "URL", "BrowserSupportedMimeTypes", "data", "mimetype", "builder", "blob", "link", "event", "utf8", "intc", "i", "TryGetCharUTF8", "b", "count", "c", "s", "ss", "StringBuffer", "sl", "printArray", "dl", "ba", "idx", "getScrollbarWidth", "outer", "inner", "scrollbarWidth", "openFileDialog", "title", "multiple", "accept", "resolve", "reject", "dialog", "e", "input", "readFile", "file", "progress", "reader", "evt", "_timers", "debounce", "mainFunction", "delay", "key", "scrollChildIntoView", "parent", "child", "childRect", "parentRect", "import_inflate_stream_min", "Telnet", "EventEmitter", "options", "data", "skipDecompress", "prependSplit", "tmp", "StringToUint8Array", "raw", "printArray", "e", "returnRaw", "len", "_sb", "state", "pState", "processed", "StringBuffer", "ga", "verb", "option", "msdp_val", "msdp_var", "_MSSP", "i", "ne", "idx", "debugOp", "uLen", "ArrayBufferToString", "op", "reply", "val", "w", "h", "w1", "w2", "h1", "h2", "mf", "str", "dl", "ba", "c", "host", "port", "_socket", "hasScheme", "evt", "reader", "b", "Ansi", "AnsiColorCode", "getAnsiColorCode", "color", "back", "getColorCode", "code", "f", "b", "bold", "isMXPColor", "getAnsiCode", "str", "Size", "width", "height", "SettingList", "Settings", "_Settings", "s", "sl", "SettingList", "setting", "defaultValue", "tmp", "err", "value", "prop", "TriggerType", "SubTriggerTypes", "MacroDisplay", "item", "d", "keyCodeToChar", "Alarm", "_Alarm", "data", "pattern", "parent", "readOnly", "t", "parts", "tmp", "value", "Item", "_Item", "profile", "prop", "Button", "_Button", "Macro", "_Macro", "Alias", "_Alias", "Trigger", "_Trigger", "il", "i", "state", "Context", "_Context", "Variable", "_Variable", "splitQuoted", "Profile", "_Profile", "name", "defaults", "m", "dl", "buttons", "b", "file", "version", "sl", "s", "clone", "key", "type", "field", "SortItemArrayByPriority", "l", "v", "ProfileCollection", "_ProfileCollection", "defaultProfile", "a", "ap", "bp", "idx", "c", "profiles", "p", "pc", "resolve", "reject", "collection", "keys", "k", "kl", "convertPattern", "client", "convertPatternState", "stringBuilder", "tl", "arg", "pat", "nest", "isValidIdentifier", "mathjs", "_mathjs", "WindowVariables", "ProperCase", "str", "txt", "fudgeDice", "Input", "EventEmitter", "client", "mathjs", "_mathjs", "event", "data", "state", "insertValue", "start", "end", "cursorPos", "getCursor", "endPos", "startPos", "findStr", "regSearch", "word", "line", "tabCasing", "clone", "scope", "WindowVariables", "a", "ll", "l", "name", "expression", "results", "sl", "obj", "locked", "value", "arg", "fun", "res", "functions", "args", "math", "c", "sides", "mod", "min", "max", "sum", "i", "fudgeDice", "keys", "k", "kl", "SortItemArrayByPriority", "MacroDisplay", "ansiRegex", "getAnsiCode", "f", "getAnsiColorCode", "getColorCode", "alarms", "al", "t", "p", "trigger", "profile", "escape", "m", "controllers", "ct", "cl", "controller", "axes", "bl", "macros", "FilterArrayByKeyValue", "ml", "val", "pressed", "n", "raw", "cmd", "index", "txt", "idx", "tl", "s", "pd", "ps", "cmdChar", "items", "tmp", "item", "reload", "o", "Trigger", "Button", "pattern", "commands", "gl", "v", "e", "w", "getTimeSpan", "StringToUint8Array", "Alias", "SettingList", "files", "isMXPColor", "match", "out", "isValidIdentifier", "r", "openFileDialog", "readFile", "contents", "text", "eAlias", "stacking", "append", "noFunctions", "noComments", "str", "alias", "AliasesCached", "aliases", "stackingChar", "spChar", "ePaths", "eCmd", "eEscape", "escChar", "verbatimChar", "eVerbatim", "eParamEscape", "paramChar", "eParam", "nParamChar", "eNParam", "eEval", "iEval", "iComments", "bComments", "iCommentsStr", "bCommentsStr", "bTrim", "sTrim", "findAlias", "tmp2", "_neg", "_pos", "_fall", "nest", "ProperCase", "nl", "named", "ret", "keycode", "alt", "ctrl", "shift", "meta", "macro", "replace", "num", "delay", "pPath", "ePath", "cnt", "current", "type", "frag", "subtypes", "changed", "triggers", "states", "rCache", "tType", "parent", "re", "convertPattern", "regex", "pIdx", "reparse", "params", "oldState", "oldFire", "oTrigger", "reParse", "lines", "code", "b", "force", "forceSingle", "sep", "splitQuoted", "options", "subTrigger", "sTrigger", "isNew", "filter", "TriggerType", "SubTriggerTypes", "fore", "back", "xEnd", "xStart", "RGBColor", "color_string", "simple_colors", "key", "color_defs", "bits", "i", "cl", "re", "processor", "channels", "r", "b", "MXPTag", "MXPState", "Entity", "remote", "Element", "Tag", "index", "fore", "back", "MXPStyle", "style", "high", "open", "Parser", "EventEmitter", "options", "Size", "mxp", "f", "b", "fc", "bc", "offset", "colors", "params", "p", "pl", "i", "rgb", "_ColorTable", "r", "g", "idx", "code", "color", "RGBColor", "line", "raw", "fragment", "skip", "formats", "data", "textLen", "l", "nF", "format", "end", "nFormat", "entity", "tag", "custom", "secure", "tmp", "ml", "m", "args", "oTag", "blocks", "arg", "sArg", "sArgs", "x", "xl", "e", "sl", "s", "href", "hint", "expire", "prompt", "MXPTag", "stripQuotes", "cmds", "tt", "caps", "bl", "eType", "n", "type", "tl", "ts", "str", "c", "state", "clr", "il", "cnt", "ansi", "text", "force", "prependSplit", "_TermTitle", "_TermTitleType", "_AnsiParams", "stringBuilder", "formatBuilder", "rawBuilder", "pState", "lineLength", "iTmp", "mOffset", "_MXPTag", "_MXPOTag", "_MXPEntity", "_MXPComment", "_MXPArgs", "lines", "d", "u", "tabWidth", "lnk", "fLnk", "lnkOffset", "lLnk", "lNest", "mt", "j", "htmlDecode", "CharAllowedInURL", "_Tab", "psk", "pFnd", "nl", "ex", "width", "height", "Display", "EventEmitter", "container", "options", "e", "DisplayModel", "debounce", "entries", "observer", "mutationsList", "mutation", "value", "val", "data", "noUpdate", "args", "x", "xl", "title", "type", "tag", "idx", "enable", "Size", "getScrollbarWidth", "l", "html", "msg", "y", "amt", "r", "txt", "remote", "force", "prependSplit", "line", "id", "elLine", "width", "height", "scrollWidth", "font", "size", "pc", "padding", "styles", "start", "len", "inner", "parts", "offset", "style", "fCls", "text", "formats", "fLen", "right", "f", "format", "nFormat", "end", "td", "htmlEncode", "tmp", "formatUnit", "full", "_html", "fore", "back", "color", "code", "selection", "range", "clonedSelection", "div", "elements", "element", "el", "Parser", "lines", "expire", "fs", "fl", "fsl", "eType", "n", "percent", "ol", "lineLength", "found", "formatEnd", "nF", "textLen", "version", "buzz", "Plugin", "EventEmitter", "#client", "value", "client", "SoundState", "EventEmitter", "file", "repeats", "volume", "priority", "e", "err", "resolve", "reject", "MSP", "Plugin", "options", "Client", "data", "idx", "option", "value", "text", "type", "args", "state", "str", "x", "xl", "arg", "tmp", "stripQuotes", "old", "mod", "sound", "i", "Test", "Plugin", "client", "data", "openFileDialog", "files", "readFile", "contents", "n", "i", "p", "StringToUint8Array", "avg", "max", "min", "items", "start", "sample", "t", "r", "bg", "a", "Ansi", "AnsiColorCode", "fg", "title", "g", "b", "c", "colors", "cl", "dcc", "ws", "w", "h", "commands", "e", "emojiRange", "range", "x", "sample2", "maxLines", "id", "name", "PF", "RoomExits", "Room", "_Room", "data", "prop", "exit", "a", "c", "copy", "Map", "_Map", "EventEmitter", "value", "or", "rooms", "r", "rl", "key", "resolve", "reject", "map", "filter", "keys", "filterKeys", "fl", "roomLoop", "k", "kl", "room", "f", "idx", "areas", "area", "zone", "id", "dest", "b", "aRoom", "bRoom", "type", "MapDisplay", "EventEmitter", "container", "options", "entries", "observer", "mutationsList", "mutation", "e", "target", "index", "cached", "curDiff", "pointerUp", "cachedEv", "x", "y", "room", "event", "m", "value", "evt", "rect", "rx", "ry", "ox", "oy", "Room", "canvas", "context", "ex", "resolve", "reject", "z", "area", "zone", "s", "$w", "$h", "$x", "$y", "rooms", "d", "r", "rl", "type", "level", "es", "map", "idx", "ctx", "nc", "amt", "scale", "o", "key", "tx", "f", "color", "w", "h", "exit", "x1", "x2", "y1", "y2", "id", "filter", "destRoom", "roomsC", "oz", "cx", "cy", "cz", "matrix", "grid", "finder", "fPath", "startRoom", "z2", "walk", "cmds", "tmp", "cnt", "option", "tempCanvas", "computedStyle", "borderLeftWidth", "borderRightWidth", "borderTopWidth", "borderBottomWidth", "separator", "copyText", "err", "cmd", "wl", "scaled", "t", "fx", "rectWidth", "rectHeight", "blob", "reader", "DialogButtons", "Dialog", "EventEmitter", "options", "debounce", "e", "t", "styles", "x", "y", "size", "fake", "redirectedEvent", "footer", "ec", "right", "bottom", "corner", "left", "top", "entries", "observer", "mutationsList", "mutation", "value", "type", "rect", "el", "returnValue", "w", "h", "position", "forceReset", "dialogs", "d", "dl", "i", "order", "z", "b", "full", "silent", "contents", "args", "scripts", "s", "sl", "AlertDialog", "title", "message", "icon", "getIcon", "ConfirmDialog", "buttons", "ProgressDialog", "resolve", "reject", "confirm", "reason", "closeMenu", "instance", "showMenu", "initMenu", "el", "text", "icon", "updateScrollLock", "e", "showDialog", "doc", "docEl", "requestFullScreen", "cancelFullScreen", "toggleButtons", "button", "pl", "s", "sl", "list", "p", "item", "code", "id", "ie", "AdvEditor", "EventEmitter", "element", "enabledAdvanced", "value", "insertValue", "htmlEncode", "content", "_dColors", "getColors", "c", "color", "r", "g", "b", "idx", "_bold", "bl", "clientColors", "RGBColor", "_editor", "editor", "url", "fallbackColor", "_colors", "_lastButton", "Cell", "initial", "v", "_forecolor", "_backcolor", "getCurrentColor", "format", "elm", "applyFormat", "removeFormat", "registerCommands", "name", "setIconColor", "getAdditionalColors", "hasCustom", "type", "remove", "applyColor", "onChoice", "mapColors", "colorMap", "colors", "i", "getFetch", "callback", "splitButtonApi", "newColor", "id", "registerTextColorButton", "tooltip", "lastColor", "_splitButtonApi", "handler", "e", "registerTextColorMenuItem", "text", "data", "buttonPostRender", "buttonApi", "state", "toggleFormat", "api", "pasteText", "err", "copyText", "els", "back", "fore", "cell", "Dialog", "cl", "html", "html2", "cells", "openFileDialog", "files", "f", "fl", "readFile", "contents", "pinkfishToHTML", "tag", "$el", "t", "tl", "stack", "tags", "el", "nodes", "n", "nl", "start", "end", "style", "buffer", "codes", "d", "dl", "rgb", "hex", "hexToRgb", "shortRegEx", "full", "longRegEx", "rgbArray", "rgbObj", "closestHexFromRgb", "minDistance", "nearestHex", "currentColor", "distance", "regex", "m", "SettingsDialog", "_SettingsDialog", "Dialog", "footer", "removeHash", "data", "clone", "openFileDialog", "files", "readFile", "contents", "s", "sl", "SettingList", "AlertDialog", "err", "confirm", "ConfirmDialog", "c", "colors", "pages", "title", "capitalize", "e", "forms", "f", "fl", "Settings", "args", "breadcrumb", "last", "p", "pl", "target", "value", "id", "name", "enums", "el", "color", "RGBColor", "code", "option", "type", "menu", "item", "Splitter", "EventEmitter", "options", "value", "parent", "e", "bnd", "ge", "l", "entries", "observer", "mutationsList", "mutation", "ProfilesDialog", "Dialog", "Splitter", "distance", "footer", "el", "rect", "removeHash", "items", "Profile", "il", "i", "data", "openFileDialog", "files", "readFile", "contents", "keys", "n", "k", "kl", "p", "err", "value", "collection", "index", "idPrefix", "hrefPrefix", "indent", "menu", "padding", "htmlEncode", "GetDisplay", "c", "cl", "nav", "item", "e", "capitalize", "profile", "title", "id", "enabled", "args", "pages", "breadcrumb", "last", "pl", "forms", "fl", "target", "debounce", "f", "b", "pp", "page", "resolve", "reject", "scripts", "FilterArrayByKeyValue", "keyCharToCode", "keyCodeToChar", "Trigger", "updateHash", "DialogButtons", "s", "sl", "events", "name", "enums", "currentItem", "currentParent", "display", "bc", "select", "expand", "po", "scrollChildIntoView", "defaults", "menuItem", "oldProfile", "oldID", "newID", "container", "oldName", "newName", "oldPath", "newPath", "a", "ap", "bp", "r", "Alias", "Button", "Macro", "Context", "m", "newNode", "back", "menuItems", "href", "obj", "prop", "type", "arr", "MacroDisplay", "Contextmenu", "_Contextmenu", "EventEmitter", "items", "id", "e", "menu", "i", "il", "index", "x", "y", "editor", "editorDialog", "_currentIcon", "_selword", "_selurl", "_selline", "lastMouse", "doLink", "url", "e", "doMXPLink", "el", "doMXPSend", "pmt", "tt", "im", "extra", "os", "offset", "x", "y", "items", "i", "il", "item", "MXPMenuHandler", "Contextmenu", "setSelectionRange", "cmd", "doMXPTooltip", "initializeInterface", "options", "_setIcon", "initMenu", "pasteText", "txt", "html", "copyText", "window", "closeDialog", "a", "value", "parent", "pos", "resizeCommandInput", "initCommandInput", "updateCommandInput", "_dialogs", "title", "buildButtons", "message", "notify", "permission", "args", "name", "showDialog", "h", "menu", "history", "event", "filename", "lineno", "colno", "error", "hashChange", "_loadHistory", "showButtons", "removeHash", "string", "hashes", "s", "updateHash", "add", "remove", "hashes", "s", "hashChange", "dialogs", "d", "showDialog", "_dialogs", "name", "Dialog", "removeHash", "loadDialog", "e", "footer", "cmd", "_loadHistory", "list", "cmds", "l", "ll", "c", "cl", "editorDialog", "editor", "textarea", "AdvEditor", "value", "openFileDialog", "files", "readFile", "contents", "SettingsDialog", "ProfilesDialog", "dialog", "path", "show", "showError", "resolve", "reject", "subpath", "data", "err", "closeDialog", "history", "fragment", "i", "opt", "resizeCommandInput", "debounce", "_resizeCommandInput", "initCommandInput", "commandInputResize", "updateCommandInput", "measure", "cmdSize", "oldMeasure", "minHeight", "height", "padding", "inset", "_setIcon", "ico", "_currentIcon", "icon", "toggleButtons", "showButtons", "createButton", "button", "index", "tt", "caption", "bh", "buildButtons", "buttons", "b", "bl", "items", "il", "ExecuteButton", "dragButton", "el", "idx", "ret", "f", "elmnt", "pos3", "pos4", "delay", "dragMouseDown", "dragTouchStart", "dragMouseleave", "closeDragButton", "elementDrag", "elementMove", "initializeInterface", "mapper_menu_default", "mapper_room_default", "Mapper", "Plugin", "options", "Client", "Map", "map", "err", "idx", "window", "e", "mod", "data", "room", "Room", "exit", "x", "Dialog", "debounce", "toolbar", "removeHash", "mapper_menu_default", "closeMenu", "openFileDialog", "files", "readFile", "reason", "MapDisplay", "area", "setting", "value", "Splitter", "mapper_room_default", "f", "target", "name", "enums", "el", "selected", "current", "items", "i", "il", "event", "msg", "initMapper", "m", "rooms", "areas", "roomArea", "h", "progress", "selector", "disabled", "instance", "Client", "EventEmitter", "options", "version", "Display", "e", "lock", "width", "height", "msg", "data", "tag", "args", "title", "type", "Telnet", "err", "val", "mod", "idx", "dl", "c", "obj", "tmp", "getParameterByName", "Input", "history", "profile", "item", "MSP", "Mapper", "Test", "value", "enable", "host", "port", "keys", "k", "kl", "SortItemArrayByPriority", "trigger", "a", "s", "sl", "plugin", "name", "variables", "names", "nl", "n", "index", "txt", "resolve", "ProfileCollection", "profiles", "Profile", "al", "client", "state", "pattern", "Alarm", "p", "temp", "oldState", "newState", "alarm", "now", "dNow", "future", "fend", "old", "oAlarms", "changed", "patterns", "alarms", "parent", "line", "match", "ts", "sec", "min", "hr", "hours", "minutes", "seconds", "Settings", "colors", "cl", "remote", "force", "prependSplit", "str", "fore", "back", "newline", "forceLine", "codes", "echo", "style", "noEcho", "comments", "selectAll", "enabled", "message", "text", "eAlias", "stacking", "noFunction", "event", "delay"]
}
