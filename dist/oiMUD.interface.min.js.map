{
  "version": 3,
  "sources": ["../src/interface/menu.ts", "../src/events.ts", "../src/library.ts", "../src/dialog.ts", "../src/lib/rgbcolor.js", "../src/interface/adv.editor.ts", "../src/interface/interface.ts"],
  "sourcesContent": ["declare let client;\r\ndeclare let bootstrap;\r\n\r\nexport function closeMenu() {\r\n    bootstrap.Offcanvas.getInstance(document.getElementById('clientMenu')).hide();        \r\n}\r\n\r\nexport function showMenu() {\r\n    bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('clientMenu')).show();        \r\n}\r\n\r\nexport function initMenu() {\r\n    document.getElementById('btn-menu').addEventListener('click', showMenu);\r\n    client.on('connected', () => {\r\n        let el = document.getElementById('menu-connect');\r\n        let text = document.querySelector('#menu-connect a span');\r\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\r\n        el.title = 'Disconnect';\r\n        el.classList.add('active');\r\n        text.textContent = 'Disconnect';\r\n        icon.classList.add('fa-plug-circle-xmark');\r\n        icon.classList.remove('fa-plug');\r\n    });\r\n    client.on('closed', () => {\r\n        let el = document.getElementById('menu-connect');\r\n        let text = document.querySelector('#menu-connect a span');\r\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\r\n        el.title = 'Connect';\r\n        el.classList.remove('active');\r\n        text.textContent = 'Connect';\r\n        icon.classList.remove('fa-plug-circle-xmark');\r\n        icon.classList.add('fa-plug');        \r\n    })\r\n    client.on('scroll-lock', updateScrollLock);\r\n    document.querySelector('#menu-connect a').addEventListener('click', e => {\r\n        if (client.connected)\r\n            client.close();\r\n        else {\r\n            client.connect();\r\n            closeMenu();\r\n        }\r\n    });\r\n    document.querySelector('#menu-clear a').addEventListener('click', e => {\r\n        client.clear();\r\n        closeMenu()\r\n    });\r\n    document.querySelector('#menu-lock a').addEventListener('click', e => {\r\n        client.toggleScrollLock();\r\n        closeMenu();\r\n    });\r\n    document.querySelector('#menu-editor a').addEventListener('click', e => {\r\n        closeMenu();\r\n        document.getElementById('btn-adv-edit').click();        \r\n    });        \r\n    updateScrollLock();\r\n}\r\n\r\nfunction updateScrollLock() {\r\n    let el = document.getElementById('menu-lock');\r\n    let text = document.querySelector('#menu-lock a span');\r\n    let icon = document.querySelector('#menu-lock svg') || document.querySelector('#menu-lock i');\r\n    if (client.scrollLock) {\r\n        el.title = 'Unlock display';\r\n        el.classList.add('active');\r\n        text.textContent = 'Unlock display';\r\n        icon.classList.add('fa-unlock');\r\n        icon.classList.remove('fa-lock');\r\n    }\r\n    else {\r\n        el.title = 'Lock display';\r\n        el.classList.remove('active');\r\n        text.textContent = 'Lock display';\r\n        icon.classList.remove('fa-unlock');\r\n        icon.classList.add('fa-lock');\r\n    }\r\n}", "/**\r\n * A custom event emitter that will work in browsers or nodejs\r\n * Contains naming conventions from all standard formats\r\n */\r\nexport class EventEmitter {\r\n    #events = {};\r\n\r\n    public bind(type: string, listener: Function) {\r\n        if (!Array.isArray(this.#events[type]) || typeof this.#events[type] === 'undefined')\r\n            this.#events[type] = [];\r\n        this.#events[type].push(listener);\r\n    }\r\n\r\n    public on(type: string, listener: Function) {\r\n        this.bind(type, listener);\r\n    }\r\n\r\n    public addEventListener(type: string, listener: Function) {\r\n        this.bind(type, listener);\r\n    }\r\n\r\n    public fire(type, args?, caller?) {\r\n        if (!type || typeof type !== 'string')\r\n            throw new Error('Event missing.');\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        if (!args || args === null || typeof args === 'undefined')\r\n            args = [];\r\n        else if (!Array.isArray(args))\r\n            args = [args];\r\n\r\n        caller = caller || this;\r\n        var events = this.#events[type];\r\n        for (var i = 0, len = events.length; i < len; i++)\r\n            events[i].apply(caller, args);\r\n    }\r\n\r\n    public emit(type, ...args) {\r\n        this.fire(type, args);\r\n    }\r\n\r\n    public dispatchEvent(type:string, args?, caller?) {\r\n        this.fire(type, args, caller);\r\n    }\r\n\r\n    public unbind(type, listener) {\r\n        if (!type || !listener) return;\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        const events = this.#events[type];\r\n        for (let i = 0, len = events.length; i < len; i++) {\r\n            if (events[i] === listener) {\r\n                events.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public remove(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public off(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeListener(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeAllListeners(type?) {\r\n        if(!type) {\r\n            this.#events = [];\r\n            return;\r\n        }\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        delete this.#events[type];\r\n    }\r\n\r\n    public listeners(type?) {\r\n        if(!type) return this.#events;\r\n        return this.#events[type] || [];\r\n    }\r\n}", "/**\n * @file Core functions and helpers\n *\n * @author William\n */\n//spell-checker:ignore Eisu, Junja, Hanja, Nonconvert, Modechange, printscreen, jisho, Masshou, Touroku, loya, roya\n//spell-checker:ignore Wsctrl, Cusel, Enlw, Backtab, Crsel, Exsel, Ereof rtrim ltrim Dropdown DBLUNDERLINE noflash\ndeclare global {\n    interface String {\n        trimLeft(): string;\n        trimRight(): string;\n        rtrim(): string;\n        addSlashes(): string;\n    }\n\n    interface Uint8Array {\n        charAt;\n        charCodeAt;\n    }\n\n    interface Object {\n        toType;\n    }\n}\n\n/**\n * Copyright (c) Mozilla Foundation http://www.mozilla.org/\n * This code is available under the terms of the MIT License\n */\nif (!Array.prototype.filter) {\n    Array.prototype.filter = function (fun /*, thisp*/) {\n        var len = this.length >>> 0;\n        if (typeof fun != 'function') {\n            throw new TypeError();\n        } ``\n\n        var res = [];\n        var thisp = arguments[1];\n        for (var i = 0; i < len; i++) {\n            if (i in this) {\n                var val = this[i]; // in case fun mutates this\n                if (fun.call(thisp, val, i, this)) {\n                    res.push(val);\n                }\n            }\n        }\n\n        return res;\n    };\n}\n\nexport function SortArrayByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    return 0;\n}\n\nexport function SortMapByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    if (a.index < b.index)\n        return -1;\n    if (a.index > b.index)\n        return 1;\n    return 0;\n}\n\nexport function SortItemArrayByPriority(list) {\n    const map = list.map((el, i) => {\n        return { index: i, priority: el.priority };\n    });\n    map.sort(SortMapByPriority);\n    return map.map((el) => {\n        return list[el.index];\n    });\n}\n\nexport function FilterArrayByKeyValue(array, k, v) {\n    const res = [];\n    if (!array || array.length === 0) return res;\n    const al = array.length;\n    for (let i = 0; i < al; i++) {\n        if (array[i]['enabled'] && array[i][k] === v)\n            res.push(array[i]);\n    }\n    if (res.length <= 1) return res;\n    return res.sort(SortArrayByPriority);\n}\n\nconst _edCache = document.createElement('div');\n\nexport function htmlEncode2(value) {\n    _edCache.textContent = value.replace(/ /g, '\\u00A0');\n    return _edCache.innerHTML;\n}\n\nexport function htmlDecode2(value) {\n    _edCache.innerHTML = value;\n    return _edCache.textContent.replace(/\\u00A0/g, ' ');\n}\n\nexport function htmlEncode(value) {\n    _edCache.textContent = value;\n    return _edCache.innerHTML;\n}\n\nexport function htmlDecode(value) {\n    _edCache.innerHTML = value;\n    return _edCache.textContent;\n}\n\nexport function htmlEntities(str) {\n    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\n\nexport function stripHTML(html) {\n    _edCache.innerHTML = html;\n    return _edCache.textContent || _edCache.innerText || '';\n}\n\nexport function stripParentheses(str) {\n    return str.replace(/(^\\()|(\\)$)/g, '');\n}\n\nexport function stripQuotes(str) {\n    str = str.replace(/^\"(.+(?=\"$))?\"$/, '$1');\n    str = str.replace(/^'(.+(?='$))?'$/, '$1');\n    return str;\n}\n\nexport function offset(el) {\n    const box = el.getBoundingClientRect();\n    const docElem = document.documentElement;\n    return {\n        top: box.top + window.pageYOffset - docElem.clientTop,\n        left: box.left + window.pageXOffset - docElem.clientLeft\n    };\n}\n\nexport class StringBuffer {\n    public buffer: string[];\n    //public rawbuffer: string[];\n    public length: number = 0;\n    constructor(str?: string) {\n        if (typeof str == 'string' && str.length > 0)\n            this.buffer = [str];\n        else\n            this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n    }\n\n    public prepend(string) {\n        this.buffer.unshift(string);\n        //this.rawbuffer.unshift(string.charCodeAt(0));\n        this.length += string.length;\n        return this;\n    }\n\n    public append(string) {\n        this.buffer.push(string);\n        this.length += string.length;\n        //this.rawbuffer.push(string.charCodeAt(0));\n        return this;\n    }\n\n    public push(string) {\n        if (typeof string === 'number')\n            this.appendCode(string);\n        else\n            this.append(string);\n    }\n\n    public appendCode(b) {\n        this.buffer.push(String.fromCharCode(b));\n        //this.rawbuffer.push(b);\n        this.length++;\n        return this;\n    }\n\n    public toString() {\n        return this.buffer.join('');\n    }\n\n    public clear(str?) {\n        this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n        if (str && typeof str != 'undefined' && str.length) {\n            this.buffer.push(str);\n            this.length = str.length;\n        }\n        return this;\n    }\n\n    public concat(arr) {\n        this.buffer = this.buffer.concat(arr);\n        //this.rawbuffer.push(arr.charCodeAt(0));\n    }\n\n}\n\nexport function CharAllowedInURL(chr, proto) {\n    if (chr.length > 1)\n        return false;\n    if (\n        chr === '-' ||\n        chr === '_' ||\n        chr === '.' ||\n        chr === '~' ||\n        chr === '!' ||\n        chr === '*' ||\n        chr === '\\'' ||\n        chr === ';' ||\n        chr === ':' ||\n        chr === '@' ||\n        chr === '&' ||\n        chr === '=' ||\n        chr === '+' ||\n        chr === '$' ||\n        chr === ',' ||\n        chr === '/' ||\n        chr === '\\\\' ||\n        chr === '?' ||\n        chr === '%' ||\n        chr === '#' ||\n        chr === '[' ||\n        chr === ']' ||\n        chr === '(' ||\n        chr === ')'\n    )\n        return !proto;\n    const i = chr.charCodeAt(0);\n    if (i > 64 && i < 91)\n        return true;\n    if (i > 96 && i < 123)\n        return true;\n    if (i > 47 && i < 58)\n        return true;\n    if (i >= 160 && i <= 55295)\n        return true;\n    if (i >= 57344 && i <= 64975)\n        return true;\n    if (i >= 65008 && i <= 65533)\n        return true;\n    if (i >= 65536 && i <= 131069)\n        return true;\n    if (i >= 131072 && i <= 196605)\n        return true;\n    if (i >= 196608 && i <= 262141)\n        return true;\n    if (i >= 262144 && i <= 327677)\n        return true;\n    if (i >= 327680 && i <= 393213)\n        return true;\n    if (i >= 393216 && i <= 458749)\n        return true;\n    if (i >= 458752 && i <= 524285)\n        return true;\n    if (i >= 524288 && i <= 589821)\n        return true;\n    if (i >= 589824 && i <= 655357)\n        return true;\n    if (i >= 655360 && i <= 720893)\n        return true;\n    if (i >= 720896 && i <= 786429)\n        return true;\n    if (i >= 786432 && i <= 851965)\n        return true;\n    if (i >= 851968 && i <= 917501)\n        return true;\n    if (i >= 921600 && i <= 983037)\n        return true;\n    if (i >= 983040 && i <= 1048573)\n        return true;\n    if (i >= 1048576 && i <= 1114109)\n        return true;\n    return false;\n}\n\nexport let keyCodeToChar = {\n    3: 'Cancel',\n    6: 'Help',\n    8: 'Backspace',\n    9: 'Tab',\n    19: 'Pause/Break',\n    20: 'Caps Lock',\n    21: 'Kana',\n    22: 'Eisu',\n    23: 'Junja',\n    24: 'Final',\n    25: 'Hanja',\n    27: 'Esc',\n    28: 'Convert',\n    29: 'Nonconvert',\n    30: 'Accept',\n    31: 'Modechange',\n    32: 'Space',\n    33: 'Page Up',\n    34: 'Page Down',\n    35: 'End',\n    36: 'Home',\n    37: 'Left',\n    38: 'Up',\n    39: 'Right',\n    40: 'Down',\n    41: 'Select',\n    42: 'Print',\n    43: 'Execute',\n    44: 'Printscreen',\n    45: 'Insert',\n    46: 'Delete',\n    48: '0',\n    49: '1',\n    50: '2',\n    51: '3',\n    52: '4',\n    53: '5',\n    54: '6',\n    55: '7',\n    56: '8',\n    57: '9',\n    58: 'Colon',\n    59: 'Semicolon',\n    60: 'Less Than',\n    61: 'Equals2',\n    62: 'Greater Than',\n    63: 'Question Mark',\n    65: 'A',\n    66: 'B',\n    67: 'C',\n    68: 'D',\n    69: 'E',\n    70: 'F',\n    71: 'G',\n    72: 'H',\n    73: 'I',\n    74: 'J',\n    75: 'K',\n    76: 'L',\n    77: 'M',\n    78: 'N',\n    79: 'O',\n    80: 'P',\n    81: 'Q',\n    82: 'R',\n    83: 'S',\n    84: 'T',\n    85: 'U',\n    86: 'V',\n    87: 'W',\n    88: 'X',\n    89: 'Y',\n    90: 'Z',\n    93: 'Context Menu',\n    95: 'Sleep',\n    96: 'Numpad 0',\n    97: 'Numpad 1',\n    98: 'Numpad 2',\n    99: 'Numpad 3',\n    100: 'Numpad 4',\n    101: 'Numpad 5',\n    102: 'Numpad 6',\n    103: 'Numpad 7',\n    104: 'Numpad 8',\n    105: 'Numpad 9',\n    106: 'Numpad *',\n    107: 'Numpad +',\n    109: 'Numpad -',\n    110: 'Numpad .',\n    111: 'Numpad /',\n    112: 'F1',\n    113: 'F2',\n    114: 'F3',\n    115: 'F4',\n    116: 'F5',\n    117: 'F6',\n    118: 'F7',\n    119: 'F8',\n    120: 'F9',\n    121: 'F10',\n    122: 'F11',\n    123: 'F12',\n    124: 'F13',\n    125: 'F14',\n    126: 'F15',\n    127: 'F16',\n    128: 'F17',\n    129: 'F18',\n    130: 'F19',\n    131: 'F20',\n    132: 'F21',\n    133: 'F22',\n    134: 'F23',\n    135: 'F24',\n    144: 'Num Lock',\n    145: 'Scroll Lock',\n    146: 'Win Oem Fj Jisho',\n    147: 'Win Oem Fj Masshou',\n    148: 'Win Oem Fj Touroku',\n    149: 'Win Oem Fj Loya',\n    150: 'Win Oem Fj Roya',\n    160: 'Circumflex',\n    161: 'Exclamation',\n    162: 'Double Quote',\n    163: 'Hash',\n    164: 'Dollar',\n    165: 'Percent',\n    166: 'Ampersand',\n    167: 'Underscore',\n    168: 'Open Paren',\n    169: 'Close Paren',\n    170: 'Asterisk',\n    171: 'Plus',\n    172: 'Pipe',\n    173: 'Hyphen Minus',\n    174: 'Open Curly Bracket',\n    175: 'Close Curly Bracket',\n    176: 'Tilde',\n    181: 'Volume Mute',\n    182: 'Volume Down',\n    183: 'Volume Up',\n    186: ';',\n    187: 'Equals',\n    188: ',',\n    189: 'Minus',\n    190: '.',\n    191: '/',\n    192: '`',\n    219: '[',\n    220: '\\\\',\n    221: ']',\n    222: '\\'',\n    227: 'Win Ico Help',\n    228: 'Win Ico 00',\n    230: 'Win Ico Clear',\n    233: 'Win Oem Reset',\n    234: 'Win Oem Jump',\n    235: 'Win Oem Pa1',\n    236: 'Win Oem Pa2',\n    237: 'Win Oem Pa3',\n    238: 'Win Oem Wsctrl',\n    239: 'Win Oem Cusel',\n    240: 'Win Oem Attn',\n    241: 'Win Oem Finish',\n    242: 'Win Oem Copy',\n    243: 'Win Oem Auto',\n    244: 'Win Oem Enlw',\n    245: 'Win Oem Backtab',\n    246: 'Attn',\n    247: 'Crsel',\n    248: 'Exsel',\n    249: 'Ereof',\n    250: 'Play',\n    251: 'Zoom',\n    253: 'Pa1',\n    254: 'Win Oem Clear'\n};\n\nexport let keyCharToCode = {\n    Cancel: 3,\n    Help: 6,\n    Backspace: 8,\n    Tab: 9,\n    'Pause/Break': 19,\n    'Caps Lock': 20,\n    Esc: 27,\n    Space: 32,\n    'Page Up': 33,\n    'Page Down': 34,\n    End: 35,\n    Home: 36,\n    Left: 37,\n    Up: 38,\n    Right: 39,\n    Down: 40,\n    Insert: 45,\n    Delete: 46,\n    0: 48,\n    1: 49,\n    2: 50,\n    3: 51,\n    4: 52,\n    5: 53,\n    6: 54,\n    7: 55,\n    8: 56,\n    9: 57,\n    A: 65,\n    B: 66,\n    C: 67,\n    D: 68,\n    E: 69,\n    F: 70,\n    G: 71,\n    H: 72,\n    I: 73,\n    J: 74,\n    K: 75,\n    L: 76,\n    M: 77,\n    N: 78,\n    O: 79,\n    P: 80,\n    Q: 81,\n    R: 82,\n    S: 83,\n    T: 84,\n    U: 85,\n    V: 86,\n    W: 87,\n    X: 88,\n    Y: 89,\n    Z: 90,\n    'Numpad 0': 96,\n    'Numpad 1': 97,\n    'Numpad 2': 98,\n    'Numpad 3': 99,\n    'Numpad 4': 100,\n    'Numpad 5': 101,\n    'Numpad 6': 102,\n    'Numpad 7': 103,\n    'Numpad 8': 104,\n    'Numpad 9': 105,\n    'Numpad *': 106,\n    'Numpad +': 107,\n    'Numpad -': 109,\n    'Numpad .': 110,\n    'Numpad /': 111,\n    F1: 112,\n    F2: 113,\n    F3: 114,\n    F4: 115,\n    F5: 116,\n    F6: 117,\n    F7: 118,\n    F8: 119,\n    F9: 120,\n    F10: 121,\n    F11: 122,\n    F12: 123,\n    'Num Lock': 144,\n    'Scroll Lock': 145,\n    ';': 186,\n    ',': 188,\n    '.': 190,\n    '/': 191,\n    '`': 192,\n    '[': 219,\n    '\\\\': 220,\n    ']': 221,\n    '\\'': 222,\n    Kana: 21,\n    Eisu: 22,\n    Junja: 23,\n    Final: 24,\n    Hanja: 25,\n    Convert: 28,\n    Nonconvert: 29,\n    Accept: 30,\n    Modechange: 31,\n    Select: 41,\n    Print: 42,\n    Execute: 43,\n    Printscreen: 44,\n    Colon: 58,\n    Semicolon: 59,\n    'Less Than': 60,\n    Equals2: 61,\n    'Greater Than': 62,\n    'Question Mark': 63,\n    'Context Menu': 93,\n    Sleep: 95,\n    F13: 124,\n    F14: 125,\n    F15: 126,\n    F16: 127,\n    F17: 128,\n    F18: 129,\n    F19: 130,\n    F20: 131,\n    F21: 132,\n    F22: 133,\n    F23: 134,\n    F24: 135,\n    'Win Oem Fj Jisho': 146,\n    'Win Oem Fj Masshou': 147,\n    'Win Oem Fj Touroku': 148,\n    'Win Oem Fj Loya': 149,\n    'Win Oem Fj Roya': 150,\n    Circumflex: 160,\n    Exclamation: 161,\n    'Double Quote': 162,\n    Hash: 163,\n    Dollar: 164,\n    Percent: 165,\n    Ampersand: 166,\n    Underscore: 167,\n    'Open Paren': 168,\n    'Close Paren': 169,\n    Asterisk: 170,\n    Plus: 171,\n    Pipe: 172,\n    'Hyphen Minus': 173,\n    'Open Curly Bracket': 174,\n    'Close Curly Bracket': 175,\n    Tilde: 176,\n    'Volume Mute': 181,\n    'Volume Down': 182,\n    'Volume Up': 183,\n    Equals: 187,\n    Minus: 189,\n    'Win Ico Help': 227,\n    'Win Ico 00': 228,\n    'Win Ico Clear': 230,\n    'Win Oem Reset': 233,\n    'Win Oem Jump': 234,\n    'Win Oem Pa1': 235,\n    'Win Oem Pa2': 236,\n    'Win Oem Pa3': 237,\n    'Win Oem Wsctrl': 238,\n    'Win Oem Cusel': 239,\n    'Win Oem Attn': 240,\n    'Win Oem Finish': 241,\n    'Win Oem Copy': 242,\n    'Win Oem Auto': 243,\n    'Win Oem Enlw': 244,\n    'Win Oem Backtab': 245,\n    Attn: 246,\n    Crsel: 247,\n    Exsel: 248,\n    Ereof: 249,\n    Play: 250,\n    Zoom: 251,\n    Pa1: 253,\n    'Win Oem Clear': 254\n\n};\n\n//var hasHorizontalScrollbar = div.scrollWidth > div.clientWidth;\n//var hasVerticalScrollbar = div.scrollHeight > div.clientHeight;\n(function ($) {\n    $.fn.hasHorizontalScrollBar = function () {\n        return $(this)[0].scrollWidth > $(this).innerWidth();\n    };\n})(jQuery);\n\nexport function clone(obj, replacer?) {\n    return JSON.parse(JSON.stringify(obj, replacer));\n}\n\nexport function cloneObject(obj) {\n    if (!obj) return obj;\n    const nObj = {};\n    let prop;\n    for (prop in obj) {\n        if (!obj.hasOwnProperty(prop)) continue;\n        if (obj[prop])\n            nObj[prop] = obj[prop];\n        else if (typeof obj[prop] === 'object')\n            nObj[prop] = cloneObject(obj[prop]);\n        else if (Array.isArray(obj[prop]))\n            nObj[prop] = cloneArray(obj[prop]);\n        else\n            nObj[prop] = obj[prop];\n    }\n    return nObj;\n}\n\nexport function cloneArray(arr) {\n    if (!arr || arr.length === 0) return new Array();\n    const nArr = new Array(arr.length);\n    let l = arr.length;\n    while (l--) {\n        if (typeof arr[l] === 'object')\n            nArr[l] = cloneObject(arr[l]);\n        else if (Array.isArray(arr[l]))\n            nArr[l] = cloneArray(arr[l]);\n        else\n            nArr[l] = cloneObject(arr[l]);\n    }\n    return nArr;\n}\n\nexport function copy(o) {\n    let output;\n    let v;\n    let key;\n    if (!o || (typeof o !== 'object' && !Array.isArray(o)))\n        return o;\n    output = Array.isArray(o) ? [] : {};\n    for (key in o) {\n        if (!o.hasOwnProperty(key)) continue;\n        v = o[key];\n        output[key] = (v && (typeof v === 'object' || Array.isArray(v))) ? copy(v) : v;\n    }\n    return output;\n}\n\nexport function setSelectionRange(input, selectionStart, selectionEnd) {\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(selectionStart, selectionEnd);\n    }\n    else if (input.createTextRange) {\n        const range = input.createTextRange();\n        range.collapse(true);\n        range.moveEnd('character', selectionEnd);\n        range.moveStart('character', selectionStart);\n        range.select();\n    }\n}\n\nexport function selectAll(input) {\n    if (!input || input.value.length === 0) return;\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(0, input.value.length);\n    }\n    else\n        input.select();\n}\n\nexport function getSelectionText() {\n    var text = \"\";\n    if (window.getSelection)\n        text = window.getSelection().toString();\n    return text;\n}\n\nCanvasRenderingContext2D.prototype.fillRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.fill();\n};\n\nCanvasRenderingContext2D.prototype.strokeRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.stroke();\n};\n\nif (!Object.keys) Object.keys = function (o) {\n    if (o !== Object(o))\n        throw new TypeError('Object.keys called on a non-object');\n    var k = [], p;\n    for (p in o) if (Object.prototype.hasOwnProperty.call(o, p)) k.push(p);\n    return k;\n};\n\nif (!Object.toType) Object.toType = function (obj) {\n    return ({}).toString.call(obj).match(/\\s([a-z|A-Z]+)/)[1].toLowerCase();\n};\n\nif (typeof String.prototype.startsWith != 'function') {\n    String.prototype.startsWith = function (str) {\n        return this.slice(0, str.length) == str;\n    };\n}\n\nif (typeof String.prototype.endsWith != 'function') {\n    String.prototype.endsWith = function (str) {\n        return this.slice(-str.length) == str;\n    };\n}\n\nif (typeof String.prototype.splice !== 'function') {\n    String.prototype.splice = function (this: string, idx: number, s: string, rem?: number) {\n        if (typeof rem === 'undefined') rem = 0;\n        return (this.slice(0, idx) + s + this.slice(idx + Math.abs(rem)));\n    };\n}\n\nif (typeof String.prototype.padStart !== 'function') {\n    String.prototype.padStart = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number')\n            paddingValue = ' '.repeat(paddingValue);\n        return String(paddingValue + this).slice(-paddingValue.length);\n    };\n}\n\nif (typeof String.prototype.padEnd !== 'function') {\n    String.prototype.padEnd = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number') {\n            if (paddingValue <= this.length) return this;\n            paddingValue = ' '.repeat(paddingValue - this.length);\n            return this + paddingValue;\n        }\n        if (paddingValue.length <= this.length) return this;\n        return this + paddingValue.slice(-this.length);\n    };\n}\n\nif (!String.prototype.replaceAll) {\n    String.prototype.replaceAll = function (str, newStr) {\n\n        // If a regex pattern\n        if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {\n            return this.replace(str, newStr);\n        }\n\n        // If a string\n        return this.replace(new RegExp(str, 'g'), newStr);\n    };\n}\n\n\nif (typeof Uint8Array.prototype.charAt != 'function') {\n    Uint8Array.prototype.charAt = function (this: Uint8Array, idx: number) {\n        return String.fromCharCode(this[idx]);\n    };\n}\n\nif (typeof Uint8Array.prototype.charCodeAt != 'function') {\n    Uint8Array.prototype.charCodeAt = function (this: Uint8Array, idx: number) {\n        return this[idx];\n    };\n}\n\nexport function addSlashes(string, all?) {\n    if (!string || !string.length) return string;\n    if (all)\n        return string.replace(/\\\\/g, '\\\\\\\\').\n            replace(/\\u0008/g, '\\\\b').\n            replace(/\\t/g, '\\\\t').\n            replace(/\\n/g, '\\\\n').\n            replace(/\\f/g, '\\\\f').\n            replace(/\\r/g, '\\\\r').\n            replace(/'/g, '\\\\\\'').\n            replace(/\"/g, '\\\\\"').\n            replace(/\\u0000/g, '\\\\0');\n    return string.replace(/\\\\/g, '\\\\\\\\').\n        replace(/'/g, '\\\\\\'').\n        replace(/\"/g, '\\\\\"');\n}\n\nString.prototype.addSlashes = function (this: string) {\n    //no need to do (str+'') anymore because 'this' can only be a string\n    return addSlashes(this);\n}\n\nString.prototype.splitQuote = function (this: string, sep: string, type?, escape?, escapeChar?) {\n    if (this.length === 0)\n        return [];\n    if (!sep || !sep.length)\n        return [this];\n    if (!type) type = 1 | 2;\n    if (!escape) escape = 1 | 2;\n    if (!escapeChar) escapeChar = '\\\\';\n    let quote: boolean = false;\n    let sQuote: boolean = false;\n    const str = [];\n    let pS = 0;\n    let s = 0;\n    let c: string;\n    let pC = '';\n    let sp;\n    const spl = sep.length;\n    let spC: string;\n    const tl = this.length;\n    for (; s < tl; s++) {\n        c = this.charAt(s);\n        if (c === '\"' && (type & 2) === 2) {\n            if ((escape & 2) === 2) {\n                if (s === 0 || pC !== escapeChar)\n                    quote = !quote;\n            }\n            else\n                quote = !quote;\n        }\n        else if (c === '\\'' && (type & 1) === 1) {\n            if ((escape & 1) === 1) {\n                if (s === 0 || pC !== escapeChar)\n                    sQuote = !sQuote;\n            }\n            else\n                sQuote = !sQuote;\n        }\n        else if (!quote && !sQuote) {\n            for (sp = 0; sp < spl; sp++) {\n                spC = sep.charAt(sp);\n                if (c === spC) {\n                    if (s > pS || s === 0) {\n                        str.push(this.substr(pS, s - pS));\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === pS) {\n                        str.push('');\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === tl - 1)\n                        str.push('');\n                }\n            }\n        }\n        pC = c;\n    }\n    if (s === tl && s === pS && sep.indexOf(pC) !== -1) {\n        str.push('');\n        pS = s + 1;\n    }\n    if (s > pS)\n        str.push(this.substr(pS, s - pS));\n    return str;\n};\n\nexport function getTimeSpan(i: number): string {\n    let al;\n    const tmp = [];\n\n    al = Math.floor(i / (1000 * 60 * 60 * 24));\n    i -= al * (1000 * 60 * 60 * 24);\n    if (al === 1) tmp.push(al + ' day');\n    else if (al > 0) tmp.push(al + ' days');\n\n    al = Math.floor(i / (1000 * 60 * 60));\n    i -= al * (1000 * 60 * 60);\n    if (al === 1) tmp.push(al + ' hour');\n    else if (al > 0) tmp.push(al + ' hours');\n\n    al = Math.floor(i / (1000 * 60));\n    i -= al * (1000 * 60);\n    if (al === 1) tmp.push(al + ' minute');\n    else if (al > 0) tmp.push(al + ' minutes');\n\n    al = Math.floor(i / (1000));\n    i -= al * (1000);\n    if (al === 1) tmp.push(al + ' second');\n    else if (al > 0) tmp.push(al + ' seconds');\n    if (tmp.length === 0)\n        tmp.push('0 seconds');\n    return tmp.join(', ');\n}\n\nexport function naturalCompare(a, b) {\n    const ax = [];\n    const bx = [];\n\n    a.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { ax.push([$1 || Infinity, $2 || '']); });\n    b.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { bx.push([$1 || Infinity, $2 || '']); });\n\n    while (ax.length && bx.length) {\n        const an = ax.shift();\n        const bn = bx.shift();\n        const nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);\n        if (nn) return nn;\n    }\n\n    return ax.length - bx.length;\n}\n\nexport function getScrollBarWidth(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetWidth;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    if (w1 === w2) w2 = el.clientWidth;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n\nexport function getScrollBarHeight(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetHeight;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n\nexport function getScrollBarSize(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n\n    const w1 = inner.offsetWidth;\n    const h1 = inner.offsetHeight;\n\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    let h2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientWidth;\n    if (h1 === h2) h2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return [(w1 - w2), (h1 - h2)];\n}\n\nexport function formatSize(size) {\n    if (size >= 1073741824)\n        return Math.round(size / 1073741824).toLocaleString() + ' GB';\n    else if (size >= 1048576)\n        return Math.round(size / 1048576).toLocaleString() + ' MB';\n    else if (size >= 1024)\n        return Math.round(size / 1024).toLocaleString() + ' KB';\n    return size.toLocaleString() + ' B';\n}\n\nexport function capitalize(s, first?) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = first ? 1 : s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1).toLowerCase();\n                break;\n            }\n        }\n    }\n    return s.join(' ');\n}\n\nexport function capitalizePinkfish(s) {\n    const p = string_parts(s);\n    if (p.length !== 3)\n        return capitalize(s, true);\n    return p[0] + capitalize(p[1], true) + p[2];\n}\n\nfunction is_color(str) {\n    if (!_colorCodes)\n        loadColors();\n    if (!str)\n        return false;\n    if (_colorCodes[str])\n        return true;\n    switch (str) {\n        case 'ITALIC':\n        case 'UNDERLINE':\n        case 'STRIKEOUT':\n        case 'DBLUNDERLINE':\n        case 'OVERLINE':\n        case 'FLASH':\n        case 'REVERSE':\n        case 'RESET':\n        case 'DEFAULT':\n        case 'BOLD':\n            return true;\n    }\n    return false;\n}\n\nfunction string_parts(str) {\n    let tmp;\n    let t2;\n    let ss;\n    let se;\n    let sm;\n    let s;\n    let e;\n    let c;\n    //more accurate then a regex even if slower in some cases\n    if (!str.length) return ['', '', ''];\n    tmp = str.split('%^');\n    c = tmp.length;\n    if (c === 1)\n        return ['', str, ''];\n\n    if (tmp[0].length === 0) {\n        for (s = 0; s < c; s++) {\n            t2 = tmp[s];\n            if (!t2.length) continue;\n            if (!is_color(t2)) {\n                s--;\n                break;\n            }\n        }\n    }\n    else\n        s--;\n    if (tmp[c - 1].length === 0) {\n        for (e = c - 1; e > s; e--) {\n            t2 = tmp[e];\n            if (!t2.length) continue;\n            if (!is_color(t2)) {\n                e++;\n                break;\n            }\n        }\n    }\n    else\n        e = c;\n    sm = tmp.slice(s + 1, e).join('%^');\n    if (!sm.length)\n        return [str, '', ''];\n    ss = tmp.slice(0, s + 1).join('%^');\n    se = tmp.slice(e).join('%^');\n    if (sm.length) {\n        if (ss.length)\n            ss += '%^';\n        if (se.length)\n            se = '%^' + se;\n    }\n    return [ss, sm, se];\n}\n\nexport function inverse(s) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if (c >= 'A' && c <= 'Z')\n                s[i] = s[i].substr(0, p) + c.toLowerCase() + s[i].substr(p + 1);\n            else if (c >= 'a' && c <= 'z')\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1);\n        }\n    }\n    return s.join(' ');\n}\n\nexport function invert(obj) {\n    const new_obj = {};\n    let prop;\n    for (prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            new_obj[obj[prop]] = prop;\n        }\n    }\n    return new_obj;\n}\n\nexport function Cardinal(x) {\n    let str;\n    if (x === 0) return 'zero';\n    if (x < 0) {\n        str = 'negative ';\n        x = Math.abs(x);\n    }\n    else\n        str = '';\n    switch (x) {\n        case 1:\n            return str + 'one';\n        case 2:\n            return str + 'two';\n        case 3:\n            return str + 'three';\n        case 4:\n            return str + 'four';\n        case 5:\n            return str + 'five';\n        case 6:\n            return str + 'six';\n        case 7:\n            return str + 'seven';\n        case 8:\n            return str + 'eight';\n        case 9:\n            return str + 'nine';\n        case 10:\n            return str + 'ten';\n        case 11:\n            return str + 'eleven';\n        case 12:\n            return str + 'twelve';\n        case 13:\n            return str + 'thirteen';\n        case 14:\n            return str + 'fourteen';\n        case 15:\n            return str + 'fifteen';\n        case 16:\n            return str + 'sixteen';\n        case 17:\n            return str + 'seventeen';\n        case 18:\n            return str + 'eighteen';\n        case 19:\n            return str + 'nineteen';\n        case 20:\n            return str + 'twenty';\n        default:\n            if (x > 1000000000)\n                return 'over a billion';\n            else if (x / 1000000 > 0) {\n                if (x % 1000000 > 0)\n                    return +' million ' + Cardinal(x % 1000000);\n                return Cardinal((x / 1000000) >> 0) + ' million';\n            }\n            else if (x / 1000 > 0) {\n                if (x % 1000 > 0)\n                    return Cardinal((x / 1000) >> 0) + ' thousand ' + Cardinal(x % 1000);\n                return Cardinal((x / 1000) >> 0) + ' thousand';\n            }\n            else if (x / 100 > 0) {\n                if (x % 100 > 0)\n                    return Cardinal((x / 100) >> 0) + ' hundred' + Cardinal(x % 100);\n                return Cardinal((x / 100) >> 0) + ' hundred';\n            }\n            else {\n                if (x % 10 > 0)\n                    str = '-' + Cardinal(x % 10);\n                else\n                    str = '';\n                switch (x / 10) {\n                    case 2:\n                        return 'twenty' + str;\n                    case 3:\n                        return 'thirty' + str;\n                    case 4:\n                        return 'forty' + str;\n                    case 5:\n                        return 'fifty' + str;\n                    case 6:\n                        return 'sixty' + str;\n                    case 7:\n                        return 'seventy' + str;\n                    case 8:\n                        return 'eighty' + str;\n                    case 9:\n                        return 'ninety' + str;\n                    default:\n                        return 'error';\n                }\n            }\n    }\n}\n\nexport function wordwrap(str, maxWidth, newLineStr?) {\n    let done = false;\n    let res = '';\n    let found;\n    let i;\n    newLineStr = newLineStr || '\\n';\n    do {\n        found = false;\n        // Inserts new line at first whitespace of the line\n        for (i = maxWidth - 1; i >= 0; i--) {\n            if (testWhite(str.charAt(i))) {\n                res = res + [str.slice(0, i + 1), newLineStr].join('');\n                str = str.slice(i + 1);\n                found = true;\n                break;\n            }\n        }\n        // Inserts new line at maxWidth position, the word is too long to wrap\n        if (!found) {\n            res += [str.slice(0, maxWidth), newLineStr].join('');\n            str = str.slice(maxWidth);\n        }\n\n        if (str.length < maxWidth)\n            done = true;\n    } while (!done);\n    if (str.length > 0)\n        return res + str;\n    return res;\n}\n\nfunction testWhite(x) {\n    return /^\\s$/.test(x.charAt(0));\n}\n\nexport function splitQuoted(str, sep, t?, e?, ec?) {\n    if (typeof (t) === 'undefined') t = 1 | 2;\n    if (typeof (e) === 'undefined') e = 0;\n    if (typeof (ec) === 'undefined') ec = '\\\\';\n    if (!str || str.length === 0)\n        return [];\n    if (!sep || sep.length === 0)\n        return [str];\n    sep = sep.split('');\n    let q = false;\n    let sq = false;\n    const strings = [];\n    let ps = 0;\n    let s = 0;\n    const sl = str.length;\n    let c;\n    for (; s < sl; s++) {\n        c = str.charAt(s);\n        if (c === '\"' && (t & 2) === 2) {\n            if ((e & 2) === 2 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    q = !q;\n            }\n            else\n                q = !q;\n        }\n        else if (c === '\\'' && (t & 1) === 1) {\n            if ((e & 1) === 1 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    sq = !sq;\n            }\n            else\n                sq = !sq;\n        }\n        else if (!sq && !q) {\n            const spl = sep.length;\n            for (let sp = 0; sp < spl; sp++) {\n                if (c === sep[sp]) {\n                    if (s > ps || s === 0) {\n                        strings.push(str.substring(ps, s));\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === ps) {\n                        strings.push('');\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === (sl - 1))\n                        strings.push('');\n                }\n            }\n        }\n    }\n    if (s === sl && s === ps && sep.indexOf(str.charAt(s - 1)) > -1) {\n        strings.push('');\n        ps = s + 1;\n    }\n    if (s > ps)\n        strings.push(str.substring(ps, s));\n    return strings;\n}\n\nexport function leadingZeros(num, totalChars: number, padWith: string, trim?: boolean) {\n    num = num + '';\n    padWith = (padWith) ? padWith : '0';\n    if (num.length < totalChars) {\n        while (num.length < totalChars) {\n            num = padWith + num;\n        }\n    }\n    if (trim && num.length > totalChars) {\n        num = num.substring((num.length - totalChars), totalChars);\n    }\n    return num;\n}\n\nexport function resetCursor(txtElement) {\n    txtElement.scrollTop = 0;\n    txtElement.scrollLeft = 0;\n    if (typeof txtElement.selectionStart === 'number') {\n        txtElement.selectionStart = 0;\n        txtElement.selectionEnd = 0;\n    }\n    else if (txtElement.setSelectionRange) {\n        txtElement.focus();\n        txtElement.setSelectionRange(0, 0);\n        txtElement.focus();\n    } else if (txtElement.createTextRange) {\n        const range = txtElement.createTextRange();\n        range.moveStart('character', 0);\n        range.select();\n    }\n}\n\nexport function moveCursorToEnd(el) {\n    el.scrollTop = el.scrollHeight;\n    if (typeof el.selectionStart === 'number') {\n        el.selectionStart = el.selectionEnd = el.value.length;\n    } else if (typeof el.createTextRange !== 'undefined') {\n        el.focus();\n        const range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n    }\n}\n\nexport function getCursor(el) {\n    if (!el) return 0;\n    if (typeof el.selectionStart === 'number') {\n        return el.selectionDirection == 'backward' ? el.selectionStart : el.selectionEnd;\n    } else if ((<any>document).selection) {\n        // Set focus on the element\n        el.focus();\n        // To get cursor position, get empty selection range\n        var oSel = (<any>document).selection.createRange();\n        // Move selection start to 0 position\n        oSel.moveStart('character', -el.value.length);\n        // The caret position is selection length\n        return oSel.text.length;\n    }\n    return 0;\n}\n\nexport function stringToEnum(str, en, ignoreCase?) {\n    if (!str || !en) return 0;\n    if (ignoreCase)\n        str = str.toUpperCase();\n    //split strip and trim spaces\n    str = str.split(',').map(v => v.trim());\n    //init value\n    let value = 0;\n    let sl = str.length;\n    //get the enum keys\n    const values = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    let test = values.slice(0);\n    //ignore case just make everything upper\n    if (ignoreCase)\n        test = test.map(v => v.toUpperCase());\n    //loop the strings\n    while (sl--) {\n        let vl = values.length;\n        //loop the enum to try and find the string value\n        while (vl--) {\n            //found value add it on\n            if (test[vl] === str[sl]) {\n                value |= en[values[vl].replace(/ /g, '_')];\n                break;\n            }\n        }\n    }\n    //return final value\n    return value;\n}\n\nexport function enumToString(value, en, exact?) {\n    let state;\n    const states = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    if (value === 0)\n        return en[0];\n    const f = [];\n    state = states.length;\n    while (state--) {\n        if (en[states[state]] === 0) continue;\n        if (exact) {\n            if (value === en[states[state]])\n                f.push(capitalize(states[state].replace(/_/g, ' ')));\n        }\n        else if ((value & en[states[state]]) === en[states[state]])\n            f.push(capitalize(states[state].replace(/_/g, ' ')));\n    }\n    return f.join(', ');\n}\n\n//https://j11y.io/snippets/wordwrap-for-javascript/\nexport function wordWrap(str, width, brk, cut) {\n    brk = brk || 'n';\n    width = width || 75;\n    cut = cut || false;\n    if (!str) return str;\n    const regex = '.{1,' + width + '}(\\s|$)' + (cut ? '|.{' + width + '}|.+$' : '|\\S+?(\\s|$)');\n    return str.match(RegExp(regex, 'g')).join(brk);\n}\n\nexport function wordBreak(str, start, length) {\n    if (length < 0) return 0;\n    let wBreak = length - 1;\n    if (start + wBreak >= str.length)\n        return str.length - start;\n    while (wBreak >= 0 && str.charAt(start + wBreak) !== ' ' && str.charAt(start + wBreak) !== '\\\\')\n        wBreak--;\n    if (wBreak <= 0)\n        return length;\n    wBreak++;\n    return wBreak;\n}\n\nexport function formatString(str, indent, width?, prefix?, postFix?, preIdent?) {\n    if (!str || str.length === 0) return '';\n    width = width || 66;\n    if (width < 40) width = 40;\n    if (typeof prefix !== 'string')\n        prefix = '\"';\n    if (typeof postFix !== 'string')\n        postFix = '\"';\n    preIdent = preIdent || '';\n    if (str.length <= width)\n        return prefix + str + postFix;\n    const list = [];\n    let wBreak = wordBreak(str, 0, width);\n    list.push(str.substr(0, wBreak));\n    let len = str.length - wBreak;\n    let tmp = wBreak; // set start of next line at window width\n    while (len / width > 0) { // while full lines loop\n        wBreak = wordBreak(str, tmp, width);\n        list.push(str.substr(tmp, wBreak));\n        tmp += wBreak; // move to next line\n        len -= wBreak; // remove line width\n    }\n    if (len > 0) // left over\n        list.push(str.substr(tmp, len));\n    return prefix + list.join(postFix + '\\n' + preIdent + ' '.repeat(indent) + prefix) + postFix;\n}\n\nexport function consolidate(amt, str) {\n    let y;\n    let l;\n    let e = '';\n    if (!amt || !str || amt < 2) return str;\n    if (str.endsWith(' ')) {\n        e = ' ';\n        str = str.trim();\n    }\n    str = str.split(' ');\n    if (str[0].toLowerCase() === 'a' || str[0].toLowerCase() === 'an' || str[0].toLowerCase() === 'the')\n        str.shift();\n    l = str.length;\n    y = str.indexOf('of');\n    if (y > 0)\n        str[y - 1] = pluralize(str[y - 1]);\n    else if (str[l - 1].endsWith(')')) {\n        y = l - 1;\n        while (y >= 0) {\n            if (str[y].startsWith('('))\n                break;\n            y--;\n        }\n        if (y - 1 >= 0)\n            str[y - 1] = pluralize(str[y - 1]);\n    }\n    else if (str[l - 1].match(/\\(.*\\)/)) {\n        if (l - 2 >= 0)\n            str[l - 2] = pluralize(str[l - 2]);\n    }\n    else\n        str[l - 1] = pluralize(str[l - 1]);\n    if (amt > 10)\n        return 'numerous ' + str.join(' ') + e;\n    return ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'][amt] + ' ' + str.join(' ') + e;\n}\n\n//spell-checker:disable\nexport function pluralize(revert) {\n    const plural = {\n        '(quiz)$': '$1zes',\n        '^(ox)$': '$1en',\n        '([m|l])ouse$': '$1ice',\n        '(matr|vert|ind)ix|ex$': '$1ices',\n        '(x|ch|ss|sh)$': '$1es',\n        '([^aeiouy]|qu)y$': '$1ies',\n        '(hive)$': '$1s',\n        '(?:([^f])fe|([lr])f)$': '$1$2ves',\n        '(shea|lea|loa|thie)f$': '$1ves',\n        sis$: 'ses',\n        '([ti])um$': '$1a',\n        '(tomat|potat|ech|her|vet)o$': '$1oes',\n        '(bu)s$': '$1ses',\n        '(alias)$': '$1es',\n        '(octop)us$': '$1i',\n        '(ax|test)is$': '$1es',\n        '(us)$': '$1es',\n        '([^s]+)$': '$1s'\n    };\n\n    const singular = {\n        '(quiz)zes$': '$1',\n        '(matr)ices$': '$1ix',\n        '(vert|ind)ices$': '$1ex',\n        '^(ox)en$': '$1',\n        '(alias)es$': '$1',\n        '(octop|vir)i$': '$1us',\n        '(cris|ax|test)es$': '$1is',\n        '(shoe)s$': '$1',\n        '(o)es$': '$1',\n        '(bus)es$': '$1',\n        '([m|l])ice$': '$1ouse',\n        '(x|ch|ss|sh)es$': '$1',\n        '(m)ovies$': '$1ovie',\n        '(s)eries$': '$1eries',\n        '([^aeiouy]|qu)ies$': '$1y',\n        '([lr])ves$': '$1f',\n        '(tive)s$': '$1',\n        '(hive)s$': '$1',\n        '(li|wi|kni)ves$': '$1fe',\n        '(shea|loa|lea|thie)ves$': '$1f',\n        '(^analy)ses$': '$1sis',\n        '((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$': '$1$2sis',\n        '([ti])a$': '$1um',\n        '(n)ews$': '$1ews',\n        '(h|bl)ouses$': '$1ouse',\n        '(corpse)s$': '$1',\n        '(us)es$': '$1',\n        s$: ''\n    };\n\n    const irregular = {\n        move: 'moves',\n        foot: 'feet',\n        goose: 'geese',\n        sex: 'sexes',\n        child: 'children',\n        man: 'men',\n        tooth: 'teeth',\n        person: 'people'\n    };\n\n    const uncountable = [\n        'sheep',\n        'fish',\n        'deer',\n        'moose',\n        'series',\n        'species',\n        'money',\n        'rice',\n        'information',\n        'equipment'\n    ];\n\n    // save some time in the case that singular and plural are the same\n    if (uncountable.indexOf(revert.toLowerCase()) >= 0)\n        return revert;\n    let word;\n    // check for irregular forms\n    for (word in irregular) {\n        if (!irregular.hasOwnProperty(word)) continue;\n        let pattern;\n        let replace;\n        if (revert) {\n            pattern = new RegExp(irregular[word] + '$', 'i');\n            replace = word;\n        } else {\n            pattern = new RegExp(word + '$', 'i');\n            replace = irregular[word];\n        }\n        if (pattern.test(revert))\n            return revert.replace(pattern, replace);\n    }\n    let array;\n    if (revert) array = singular;\n    else array = plural;\n    let reg;\n\n    // check for matches using regular expressions\n    for (reg in array) {\n        if (!array.hasOwnProperty(reg)) continue;\n        const pattern = new RegExp(reg, 'i');\n\n        if (pattern.test(revert))\n            return revert.replace(pattern, array[reg]);\n    }\n\n    return revert;\n}\n//spell-checker:enable\n\nexport function stripPinkfish(text) {\n    text = text || '';\n    text = text.split('%^');\n    const stack = [];\n    let t = 0;\n    const tl = text.length;\n    for (; t < tl; t++) {\n        if (text[t].startsWith('B_') && is_color(text[t].substr(2)))\n            continue;\n        else if (is_color(text[t]))\n            continue;\n        stack.push(text[t]);\n    }\n    return stack.join('');\n}\n\nlet _colorCodes;\nexport function pinkfishToHTML(text) {\n    text = text || '';\n    text = text.split('%^');\n    if (!_colorCodes)\n        loadColors();\n    const stack = [];\n    let codes = [];\n    let t = 0;\n    let tl = text.length;\n    let bold = false;\n    let boldNest = false;\n    let classes = [];\n    for (; t < tl; t++) {\n        switch (text[t]) {\n            case 'ITALIC':\n                stack.push('<em>');\n                codes.push('</em>');\n                break;\n            case 'UNDERLINE':\n                classes.push('underline');\n                break;\n            case 'STRIKEOUT':\n                classes.push('strikeout');\n                break;\n            case 'DBLUNDERLINE':\n                classes.push('dblunderline');\n                break;\n            case 'OVERLINE':\n                classes.push('overline');\n                break;\n            case 'FLASH':\n                classes.push('noflash');\n                break;\n            case 'REVERSE':\n                classes.push('reverse');\n                break;\n            case 'RESET':\n            case 'DEFAULT':\n                const cl = codes.length;\n                for (let c = 0; c < cl; c++)\n                    stack.push(codes[c]);\n                codes = [];\n                classes = [];\n                break;\n            case 'BOLD':\n                bold = true;\n                break;\n            case '':\n                break;\n            default:\n                if (text[t].startsWith('B_')) {\n                    text[t] = text[t].substr(2);\n                    if (bold) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;background-color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    bold = false;\n                    continue;\n                }\n                else if (_colorCodes[text[t]]) {\n                    if (bold && !_colorCodes['BOLD%^%^' + text[t]]) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                    }\n                    else if (bold) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^' + text[t]] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                        continue;\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    continue;\n                }\n                else if (bold && !boldNest) {\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                    codes.push('</span>');\n                }\n                if (classes.length) {\n                    stack.push('<span class=\"' + classes.join(' ') + '\">');\n                    codes.push('</span>');\n                    classes = [];\n                }\n                stack.push(text[t]);\n                bold = false;\n                boldNest = false;\n                break;\n        }\n    }\n    if (classes.length) {\n        stack.push('<span class=\"' + classes.join(' ') + '\">');\n        codes.push('</span>');\n    }\n    for (t = 0, tl = codes.length; t < tl; t++)\n        stack.push(codes[t]);\n    return stack.join('');\n}\n\nfunction loadColors() {\n    let c;\n    let color;\n    let r;\n    let g;\n    let b;\n    let idx;\n    _colorCodes = {};\n\n    _colorCodes['BLACK'] = '000000';\n    _colorCodes['RED'] = '800000';\n    _colorCodes['GREEN'] = '008000';\n    _colorCodes['ORANGE'] = '808000';\n    _colorCodes['BLUE'] = '0000EE';\n    _colorCodes['MAGENTA'] = '800080';\n    _colorCodes['CYAN'] = '008080';\n    _colorCodes['WHITE'] = 'BBBBBB';\n    _colorCodes['mono11'] = '808080';\n    _colorCodes['BOLD%^%^RED'] = 'FF0000';\n    _colorCodes['BOLD%^%^GREEN'] = '00FF00';\n    _colorCodes['YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^BLUE'] = '5C5CFF';\n    _colorCodes['BOLD%^%^MAGENTA'] = 'FF00FF';\n    _colorCodes['BOLD%^%^CYAN'] = '00FFFF';\n    _colorCodes['BOLD%^%^WHITE'] = 'FFFFFF';\n    _colorCodes['BOLD%^%^BLACK'] = '808080';\n\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = `RGB${r}${g}${b}`;\n                color = '';\n                c = 0;\n                c = r * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = g * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = b * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                if (!_colorCodes[idx])\n                    _colorCodes[idx] = color.toUpperCase();\n            }\n        }\n    }\n\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        if (g < 16)\n            g = '0' + g.toString(16).toUpperCase();\n        else\n            g = g.toString(16).toUpperCase();\n        g = g + g + g;\n        if (r < 242)\n            _colorCodes['mono0' + (r - 232)] = g;\n        else\n            _colorCodes['mono' + (r - 232)] = g;\n    }\n}\n\nexport function getColors() {\n    const _ColorTable = [];\n    let r;\n    let g;\n    let b;\n    let idx;\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = 16 + (r * 36) + (g * 6) + b;\n                _ColorTable[idx] = 'rgb(';\n                if (r > 0)\n                    _ColorTable[idx] += r * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (g > 0)\n                    _ColorTable[idx] += g * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (b > 0)\n                    _ColorTable[idx] += b * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ')';\n            }\n        }\n    }\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        _ColorTable[r] = ['rgb(', g, ',', g, ',', g, ')'].join('');\n    }\n    _ColorTable[0] = 'rgb(0,0,0)'; //black fore\n    _ColorTable[1] = 'rgb(128, 0, 0)'; //red fore\n    _ColorTable[2] = 'rgb(0, 128, 0)'; //green fore\n    _ColorTable[3] = 'rgb(128, 128, 0)'; //yellow fore\n    _ColorTable[4] = 'rgb(0, 0, 238)'; //blue fore\n    _ColorTable[5] = 'rgb(128, 0, 128)'; //magenta fore\n    _ColorTable[6] = 'rgb(0, 128, 128)'; //cyan fore\n    _ColorTable[7] = 'rgb(187, 187, 187)'; //white fore\n    _ColorTable[8] = 'rgb(128, 128, 128)'; //black  bold\n    _ColorTable[9] = 'rgb(255, 0, 0)'; //Red bold\n    _ColorTable[10] = 'rgb(0, 255, 0)'; //green bold\n    _ColorTable[11] = 'rgb(255, 255, 0)'; //yellow bold\n    _ColorTable[12] = 'rgb(92, 92, 255)'; //blue bold\n    _ColorTable[13] = 'rgb(255, 0, 255)'; //magenta bold\n    _ColorTable[14] = 'rgb(0, 255, 255)'; //cyan bold\n    _ColorTable[15] = 'rgb(255, 255, 255)'; //white bold\n    _ColorTable[256] = 'rgb(0, 0, 0)'; //black faint\n    _ColorTable[257] = 'rgb(118, 0, 0)'; //red  faint\n    _ColorTable[258] = 'rgb(0, 108, 0)'; //green faint\n    _ColorTable[259] = 'rgb(145, 136, 0)'; //yellow faint\n    _ColorTable[260] = 'rgb(0, 0, 167)'; //blue faint\n    _ColorTable[261] = 'rgb(108, 0, 108)'; //magenta faint\n    _ColorTable[262] = 'rgb(0, 108, 108)'; //cyan faint\n    _ColorTable[263] = 'rgb(161, 161, 161)'; //white faint\n    _ColorTable[264] = 'rgb(0, 0, 0)'; //BackgroundBlack\n    _ColorTable[265] = 'rgb(128, 0, 0)'; //red back\n    _ColorTable[266] = 'rgb(0, 128, 0)'; //greenback\n    _ColorTable[267] = 'rgb(128, 128, 0)'; //yellow back\n    _ColorTable[268] = 'rgb(0, 0, 238)'; //blue back\n    _ColorTable[269] = 'rgb(128, 0, 128)'; //magenta back\n    _ColorTable[270] = 'rgb(0, 128, 128)'; //cyan back\n    _ColorTable[271] = 'rgb(187, 187, 187)'; //white back\n    _ColorTable[272] = 'rgb(0,0,0)'; //InfoBackground\n    _ColorTable[273] = 'rgb(0, 255, 255)'; //InfoText\n    _ColorTable[274] = 'rgb(0,0,0)'; //LocalEchoBackground\n    _ColorTable[275] = 'rgb(255, 255, 0)'; //LocalEchoText\n    _ColorTable[276] = 'rgb(0, 0, 0)'; //DefaultBack\n    _ColorTable[277] = 'rgb(229, 229, 229)'; //DefaultFore\n    _ColorTable[278] = 'rgb(205, 0, 0)'; //ErrorFore\n    _ColorTable[279] = 'rgb(229, 229, 229)'; //ErrorBack\n    _ColorTable[280] = 'rgb(255,255,255)'; //DefaultBrightFore\n    return _ColorTable;\n}\n\nexport function formatUnit(str, ch?) {\n    if (!str) return str;\n    if (/^\\d+c$/.test(str)) {\n        if (ch)\n            return (parseInt(str, 10) * ch) + 'px';\n        return str + 'h';\n    }\n    if (/^\\d+$/.test(str))\n        return parseInt(str, 10) + 'px';\n    return str;\n}\n\nexport function replaceHtml(el, html) {\n    const oldEl = typeof el === 'string' ? document.getElementById(el) : el;\n    /*@cc_on // Pure innerHTML is slightly faster in IE\n        oldEl.innerHTML = html;\n        return oldEl;\n    @*/\n    const newEl = oldEl.cloneNode(false);\n    newEl.innerHTML = html;\n    oldEl.parentNode.replaceChild(newEl, oldEl);\n    /* Since we just removed the old element from the DOM, return a reference\n    to the new element, which can be used to restore variable references. */\n    return newEl;\n}\n\nexport function isValidIdentifier(str: string): boolean {\n    if (!str || str.length === 0) return false;\n    //valid character check\n    if (!str.match(/^[a-zA-Z_$][a-zA-Z_$0-9]*$/g))\n        return false;\n    //not a keyword\n    return ['break', 'case', 'catch', 'continue', 'debugger', 'default', 'delete', 'do', 'else', 'finally', 'for', 'function', 'if', 'in', 'instanceof', 'new', 'return', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with', 'class', 'const', 'enum', 'export', 'extends', 'import', 'super', 'implements', 'interface', 'let', 'package', 'private', 'protected', 'public', 'static', 'yield', 'null', 'true', 'false', 'NaN', 'Infinity', 'undefined', 'eval', 'arguments'].indexOf(str) === -1;\n}\n\nexport function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nexport function insertValue(input, value) {\n    if (!input) return;\n    const active = <HTMLElement>document.activeElement;\n    if (!active || active != input)\n        input.focus();\n    document.execCommand(\"insertText\", false, value);\n    if (active && active != input)\n        active.focus();\n}\n\n\nif (!Array.isArray) {\n    (<any>Array.isArray) = function (arg) {\n        return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n}\n\nlet txtDecoder;\nexport function ArrayBufferToString(buffer) {\n    if (window.TextDecoder !== undefined) {\n        return (txtDecoder || (txtDecoder = new TextDecoder())).decode(new Uint8Array(buffer));\n    }\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nexport function Uint8ArrayToString(buffer) {\n    if (window.TextDecoder !== undefined)\n        return (txtDecoder || (txtDecoder = new TextDecoder())).decode(buffer);\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(buffer)));\n}\n\nexport function StringToArrayBuffer(string) {\n    return StringToUint8Array(string).buffer;\n}\n\nexport function BinaryToString(binary) {\n    var error;\n\n    try {\n        return decodeURIComponent(escape(binary));\n    } catch (_error) {\n        error = _error;\n        if (error instanceof URIError) {\n            return binary;\n        } else {\n            throw error;\n        }\n    }\n}\n\nexport function StringToBinary(string) {\n    var chars, code, i, isUCS2, len, _i;\n\n    len = string.length;\n    chars = [];\n    isUCS2 = false;\n    for (i = _i = 0; 0 <= len ? _i < len : _i > len; i = 0 <= len ? ++_i : --_i) {\n        code = String.prototype.charCodeAt.call(string, i);\n        if (code > 255) {\n            isUCS2 = true;\n            chars = null;\n            break;\n        } else {\n            chars.push(code);\n        }\n    }\n    if (isUCS2 === true) {\n        return unescape(encodeURIComponent(string));\n    } else {\n        return String.fromCharCode.apply(null, Array.prototype.slice.apply(chars));\n    }\n}\n\nlet txtEncoder;\nexport function StringToUint8Array(string) {\n    var binary, binLen, buffer, chars, i, _i;\n    if (window.TextEncoder !== undefined)\n        return (txtEncoder || (txtEncoder = new TextEncoder())).encode(string);\n    binary = StringToBinary(string);\n    binLen = binary.length;\n    buffer = new ArrayBuffer(binLen);\n    chars = new Uint8Array(buffer);\n    for (i = _i = 0; 0 <= binLen ? _i < binLen : _i > binLen; i = 0 <= binLen ? ++_i : --_i) {\n        chars[i] = String.prototype.charCodeAt.call(binary, i);\n    }\n    return chars;\n}\n\n//attempt to copy text to clipboard, may or may not always work depending on permissions and browser\nexport function copyText(text: string) {\n    return new Promise(function (resolve, reject) {\n        try {\n            if (typeof navigator !== \"undefined\" && typeof navigator.clipboard !== \"undefined\" && typeof navigator.permissions !== \"undefined\") {\n                var blob = new Blob([text], { type: \"text/plain\" });\n                var data = [new ClipboardItem({ \"text/plain\": blob })];\n                navigator.permissions.query({ name: \"clipboardWrite\" as PermissionName }).then(function (permission) {\n                    if (permission.state === \"granted\" || permission.state === \"prompt\") {\n                        navigator.clipboard.write(data).then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error(\"Permission not granted!\"));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported(\"copy\")) {\n                var textarea = document.createElement(\"textarea\");\n                textarea.value = text;\n                textarea.textContent = text;\n                textarea.style.position = \"fixed\";\n                textarea.style.width = '2em';\n                textarea.style.height = '2em';\n                textarea.style.padding = '0';\n                textarea.style.border = 'none';\n                textarea.style.outline = 'none';\n                textarea.style.boxShadow = 'none';\n                textarea.style.background = 'transparent';\n                document.body.appendChild(textarea);\n                textarea.focus();\n                textarea.select();\n                try {\n                    document.execCommand(\"copy\");\n                    document.body.removeChild(textarea);\n                    resolve(null);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error(\"None of copying methods are supported by this browser!\"));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function pasteText() {\n    return new Promise<string>(function (resolve, reject) {\n        try {\n            if (typeof navigator !== \"undefined\" && typeof navigator.clipboard !== \"undefined\" && typeof navigator.permissions !== \"undefined\") {\n                navigator.permissions.query({ name: \"clipboardRead\" as PermissionName }).then(function (permission) {\n                    if (permission.state === \"granted\" || permission.state === \"prompt\") {\n                        navigator.clipboard.readText().then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error(\"Permission not granted!\"));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported(\"paste\")) {\n                var textarea = document.createElement(\"textarea\");\n                textarea.style.position = \"fixed\";\n                textarea.style.width = '2em';\n                textarea.style.height = '2em';\n                textarea.style.padding = '0';\n                textarea.style.border = 'none';\n                textarea.style.outline = 'none';\n                textarea.style.boxShadow = 'none';\n                textarea.style.background = 'transparent';\n                document.body.appendChild(textarea);\n                textarea.focus();\n                textarea.select();\n                try {\n                    document.execCommand(\"paste\", false, null);\n                    resolve(textarea.value);\n                    document.body.removeChild(textarea);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error(\"None of pasting methods are supported by this browser!\"));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function getParameterByName(name: string, url?: string): string {\n    if (!name) return null;\n    if (!url) url = window.location.href;\n    name = name.replace(/[[\\]]/g, '\\\\$&');\n    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\n\nexport function fSaveAs() {\n    // Feature test: Does this browser support the download attribute on anchor tags? (currently only Chrome)\n    var DownloadAttributeSupport = 'download' in document.createElement('a');\n\n    // Use any available BlobBuilder/URL implementation:\n    var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    // IE 10 has a handy navigator.msSaveBlob method. Maybe other browsers will emulate that interface?\n    // See: http://msdn.microsoft.com/en-us/library/windows/apps/hh441122.aspx\n    navigator.saveBlob = navigator.saveBlob || navigator.msSaveBlob || navigator.mozSaveBlob || navigator.webkitSaveBlob;\n\n    // Anyway, HMTL5 defines a very similar but more powerful window.saveAs function:\n    // http://www.w3.org/TR/file-writer-api/#the-filesaver-interface\n    window.saveAs = window.saveAs || window.webkitSaveAs || window.mozSaveAs || window.msSaveAs;\n    // However, this is not supported by any browser yet. But there is a compatibility library that\n    // adds this function to browsers that support Blobs (except Internet Exlorer):\n    // http://eligrey.com/blog/post/saving-generated-files-on-the-client-side\n    // https://github.com/eligrey/FileSaver.js\n\n    // mime types that (potentially) don't trigger a download when opened in a browser:\n    var BrowserSupportedMimeTypes = {\n        'image/jpeg': true,\n        'image/png': true,\n        'image/gif': true,\n        'image/svg+xml': true,\n        'image/bmp': true,\n        'image/x-windows-bmp': true,\n        'image/webp': true,\n        'audio/wav': true,\n        'audio/mpeg': true,\n        'audio/webm': true,\n        'audio/ogg': true,\n        'video/mpeg': true,\n        'video/webm': true,\n        'video/ogg': true,\n        'text/plain': true,\n        'text/html': true,\n        'text/xml': true,\n        'application/xhtml+xml': true,\n        'application/json': true\n    };\n\n    // Blobs and saveAs (or saveBlob)\t:\n    if (BlobBuilder && (window.saveAs || navigator.saveBlob)) {\n        // Currently only IE 10 supports this, but I hope other browsers will also implement the saveAs/saveBlob method eventually.\n        this.show = function (data, name, mimetype) {\n            var builder = new BlobBuilder();\n            builder.append(data);\n            var blob = builder.getBlob(mimetype || 'application/octet-stream');\n            if (!name) name = 'Download.bin';\n            // I don't assign saveAs to navigator.saveBlob (or the other way around)\n            // because I cannot know at this point whether future implementations\n            // require these methods to be called with 'this' assigned to window (or\n            // naviagator) in order to work. E.g. console.log won't work when not called\n            // with this === console.\n            if (window.saveAs) {\n                window.saveAs(blob, name);\n            }\n            else {\n                navigator.saveBlob(blob, name);\n            }\n        };\n    }\n    // Blobs and object URLs:\n    else if (BlobBuilder && URL) {\n        // Currently WebKit and Gecko support BlobBuilder and object URLs.\n        this.show = function (data, name, mimetype) {\n            var blob, url, builder = new BlobBuilder();\n            builder.append(data);\n            if (!mimetype) mimetype = 'application/octet-stream';\n            if (DownloadAttributeSupport) {\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                var link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                var event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // \"application/octet-stream\" for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    else if (Blob && URL) {\n        this.show = function (data, name, mimetype) {\n            var blob, url;\n            if (!mimetype) mimetype = 'application/octet-stream';\n            blob = new Blob([data], { type: mimetype });\n            if (DownloadAttributeSupport) {\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                var link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                var event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // \"application/octet-stream\" for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    // data:-URLs:\n    else if (!/\\bMSIE\\b/.test(navigator.userAgent)) {\n        // IE does not support URLs longer than 2048 characters (actually bytes), so it is useless for data:-URLs.\n        // Also it seems not to support window.open in combination with data:-URLs at all.\n        this.show = function (data, name, mimetype) {\n            if (!mimetype) mimetype = 'application/octet-stream';\n            // Again I need to filter the mime type so a download is forced.\n            if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                mimetype = 'application/octet-stream';\n            }\n            // Note that encodeURIComponent produces UTF-8 encoded text. The mime type should contain\n            // the charset=UTF-8 parameter. In case you don't want the data to be encoded as UTF-8\n            // you could use escape(data) instead.\n            window.open('data:' + mimetype + ',' + encodeURIComponent(data), '_blank', '');\n        };\n    }\n    // Internet Explorer before version 10 does not support any of the methods above.\n    // If it is text data you could show it in an textarea and tell the user to copy it into a text file.\n}\n\nwindow.fileSaveAs = new fSaveAs();\n\n\nfunction utf8() {\n    var intc, i;\n\n    //http://siphon9.net/loune/2009/10/javascript-snippet-to-convert-raw-utf8-to-unicode/\n    function TryGetCharUTF8(b, count) {\n        var c = b.charCodeAt(i);\n        /*\n         * 10000000 80\n         * 11000000 C0\n         * 11100000 E0\n         * 11110000 F0\n         * 11111000 F8\n         * 11111100 FC\n         * \n         * FEFF = 65279 = BOM\n         * \n         * string musicalbassclef = \"\" + (char)0xD834 + (char)0xDD1E; 119070 0x1D11E\n         */\n        if ((c & 0x80) === 0)\n            intc = c;\n        else {\n            if ((c & 0xE0) == 0xC0) {\n                intc = ((c & 0x1F) << 6) | ((b.charCodeAt(i + 1) & 0x3F));\n                i += 1;\n            }\n            else if ((c & 0xF0) == 0xE0) {\n                // 3 bytes Covers the rest of the BMP\n                //if (i+2 >= count) return false;\n                intc = ((c & 0xF) << 12) | ((b.charCodeAt(i + 1) & 0x3F) << 6) | ((b.charCodeAt(i + 2) & 0x3F));\n                //alert(c + ' '+b.charCodeAt(i + 1) +' '+b.charCodeAt(i + 2));\n                i += 2;\n            }\n            else if ((c & 0xF8) == 0xF0) {\n                intc = ((c & 0x7) << 18) | ((b.charCodeAt(i + 1) & 0x3F) << 12) | ((b.charCodeAt(i + 2) & 0x3F) << 6) | ((b.charCodeAt(i + 3) & 0x3F));\n                i += 1;\n            }\n            else\n                return false;\n        }\n        return true;\n    }\n\n    this.decode = function (s) {\n        var ss = new StringBuffer();\n        var sl = s.length;\n        for (i = 0; i < sl; i++) {\n            if (TryGetCharUTF8(s, sl))\n                ss.appendCode(intc);\n        }\n        return ss.toString();\n    };\n\n    this.decode2 = function (s) {\n        var ss = new StringBuffer();\n        var sl = s.length;\n        var i, c;\n        for (i = 0; i < sl; i++) {\n            c = s.charCodeAt(i);\n            if ((c & 0x80) !== 0) {\n                if ((c & 0xE0) == 0xC0) {\n                    c = ((c & 0x1F) << 6) | ((s.charCodeAt(i + 1) & 0x3F));\n                    i += 1;\n                }\n                else if ((c & 0xF0) == 0xE0) {\n                    c = ((c & 0xF) << 12) | ((s.charCodeAt(i + 1) & 0x3F) << 6) | ((s.charCodeAt(i + 2) & 0x3F));\n                    i += 2;\n                }\n                else if ((c & 0xF8) == 0xF0) {\n                    c = ((c & 0x7) << 18) | ((s.charCodeAt(i + 1) & 0x3F) << 12) | ((s.charCodeAt(i + 2) & 0x3F) << 6) | ((s.charCodeAt(i + 3) & 0x3F));\n                    i += 1;\n                }\n                else\n                    continue;\n            }\n            ss.appendCode(c);\n        }\n        return ss.toString();\n    };\n\n}\n\nwindow.UTF8 = new utf8();\n\nexport function printArray(data) {\n    if (data === null || typeof data == 'undefined') return data;\n    var dl, ba;\n    var idx = 0;\n    dl = data.byteLength;\n    ba = new StringBuffer();\n    for (; idx < dl; idx++) {\n        if (data[idx] < 32 || data[idx] >= 127)\n            ba.append('<' + data[idx] + '>');\n        else\n            ba.append(String.fromCharCode(data[idx]));\n    }\n    //save newly escaped string\n    return ba.toString();\n}\n\nexport function getScrollbarWidth() {\n\n    // Creating invisible container\n    const outer = document.createElement('div');\n    outer.style.visibility = 'hidden';\n    outer.style.overflow = 'scroll'; // forcing scrollbar to appear\n    (<any>outer.style).msOverflowStyle = 'scrollbar'; // needed for WinJS apps\n    document.body.appendChild(outer);\n\n    // Creating inner element and placing it in the container\n    const inner = document.createElement('div');\n    outer.appendChild(inner);\n\n    // Calculating difference between container's full width and the child width\n    const scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);\n\n    // Removing temporary elements from the DOM\n    outer.parentNode.removeChild(outer);\n\n    return scrollbarWidth;\n\n}\n\nexport function openFileDialog(title?: string, multiple?: boolean, accept?:string) {\n    return new Promise<FileList>((resolve, reject) => {\n        let dialog = document.createElement('dialog');\n        if (typeof dialog.showModal !== \"function\") {\n            reject(\"Browser does not support dialogs.\");\n            return;\n        }\n        dialog.id = 'openFileDialog';\n        dialog.style.zIndex = '2000';\n        dialog.style.height = '155px';\n        dialog.style.width = '350px';\n        dialog.innerHTML = `<div class=\"dialog-header\" style=\"font-weight: bold\"><button type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" onclick=\"document.getElementById('openFileDialog').close();\"></button><div>${title || 'Open file...'}</div></div><div class=\"dialog-body\"><div class=\"m-3\"><input class=\"form-control\" type=\"file\" id=\"openFileDialog-files\"${multiple ? ' multiple' : ''} required${accept && accept.length ? (' accept=\"'+accept+'\"') :''}></div></div><div class=\"dialog-footer\"><button id=\"openFileDialog-cancel\" style=\"float: right\" type=\"button\" class=\"btn btn-default\" onclick=\"document.getElementById('openFileDialog').close();\">Cancel</button><button id=\"openFileDialog-ok\" style=\"float: right\" type=\"button\" class=\"btn btn-primary\">Ok</button></div>`;\n        document.body.appendChild(dialog);\n        //dialog.addEventListener('open', onOpen);\n        dialog.addEventListener('close', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('closed');\n        });\n        dialog.addEventListener('cancel', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('canceled');\n        });\n        document.getElementById('openFileDialog-ok').addEventListener('click', () => {\n            const input: HTMLInputElement = (<HTMLInputElement>document.getElementById('openFileDialog-files'));\n            if (!input.files || input.files.length === 0) {\n                input.classList.add('is-invalid')\n                return;\n            }\n            input.classList.remove('is-invalid');\n            dialog.close();\n            dialog.returnValue = 'files-ok';\n            resolve(input.files);\n        });\n        dialog.showModal();\n    });\n}\n\nexport function readFile(file) {\n    return new Promise((resolve, reject) => {\n        if (!file) reject(new Error('Invalid file'));\n        var reader = new FileReader();\n        reader.onerror = reject;\n        reader.onload = evt => {\n            resolve(evt.target.result);\n        };\n        reader.readAsText(file);\n    });\n}\n\nconst _timers = {};\nexport function debounce(mainFunction, delay, key?) {\n    key = key || 'default';\n    // Clear the previous timer to prevent the execution of 'mainFunction'\n    clearTimeout(_timers[key]);\n    // Set a new timer that will execute 'mainFunction' after the specified delay\n    _timers[key] = setTimeout(() => {\n        mainFunction();\n        delete _timers[key];\n    }, delay);\n}", "import { EventEmitter } from \"./events\";\r\nimport { debounce } from \"./library\";\r\n\r\nexport interface DialogOptions {\r\n    title?: string;\r\n    width?: string | number;\r\n    height?: string | number;\r\n    minWidth?: string | number;\r\n    minHeight?: string | number;\r\n    x?: string | number;\r\n    y?: string | number;\r\n    id?: string;\r\n    buttons?: boolean;\r\n    resizable?: boolean;\r\n    moveable?: boolean;\r\n    maximizable?: boolean;\r\n    noAdaptive?: boolean;\r\n    maximized?: boolean;\r\n    showModal?: boolean;\r\n    show?: boolean | number;\r\n    center?: boolean;\r\n    noFooter?: boolean;\r\n    position?: Position;\r\n}\r\n\r\nenum ResizeType {\r\n    None = 0,\r\n    Right = 1 << 0,\r\n    Bottom = 1 << 1,\r\n    Left = 1 << 2,\r\n    Top = 1 << 3,\r\n}\r\n\r\nenum Position {\r\n    Left = 1 << 0,\r\n    Right = 1 << 1,\r\n    Top = 1 << 2,\r\n    Bottom = 1 << 3,\r\n    CenterVertical = 1 << 4,\r\n    CenterHorizontal = 1 << 5,\r\n    Center = Position.CenterHorizontal | Position.CenterVertical\r\n}\r\n\r\nexport class Dialog extends EventEmitter {\r\n    private _dialog;\r\n    private _body;\r\n    private _footer;\r\n    private _header;\r\n    private _title;\r\n    private _id;\r\n    private _state = { x: 0, y: 0, height: 0, width: 0, zIndex: 100, maximized: false, show: 0 };\r\n    private _resize = { x: 0, y: 0, height: 0, width: 0, type: ResizeType.None, minHeight: 150, minWidth: 300, borderHeight: 1, borderWidth: 1 };\r\n    private _dragPosition = { x: 0, y: 0 };\r\n    private _windowResize = () => {\r\n        //if window resized ensure top left corner is visible\r\n        debounce(() => {\r\n            const styles = document.defaultView.getComputedStyle(this._dialog);\r\n            if (this._state.x > window.innerWidth - 16) {\r\n                this._state.x = (window.innerWidth - 16);\r\n                this._dialog.style.left = this._state.x + \"px\";\r\n            }\r\n            if (this._state.y > window.innerHeight - 16) {\r\n                this._state.y = (window.innerHeight - 16);\r\n                this._dialog.style.top = this._state.y + \"px\";\r\n            }\r\n            this.emit('moved', this._state);\r\n        }, 250, this._id + 'dialogResize');\r\n    };\r\n\r\n    private resizeDoDrag = e => {\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.clientY - this._resize.y;\r\n            if (t > window.innerWidth - 16) t = window.innerHeight - 16;\r\n            this._dialog.style.height = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                this._dialog.style.height = this._resize.minHeight + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + \"px\";\r\n            t = e.clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                this._dialog.style.width = this._resize.minWidth + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + \"px\";\r\n            t = e.clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + \"px\";\r\n        }\r\n    };\r\n\r\n    private resizeTouchDrag = e => {\r\n        if (!e.touches.length) return;\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.touches[0].clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.touches[0].clientY - this._resize.y;\r\n            if (t > window.innerWidth) t = window.innerHeight;\r\n            this._dialog.style.height = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.touches[0].clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                this._dialog.style.height = this._resize.minHeight + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + \"px\";\r\n            t = e.touches[0].clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + \"px\";\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.touches[0].clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                this._dialog.style.width = this._resize.minWidth + \"px\";\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + \"px\";\r\n            t = e.touches[0].clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + \"px\";\r\n        }\r\n    };\r\n\r\n    private resizeStopDrag = e => {\r\n        document.documentElement.removeEventListener(\"mousemove\", this.resizeDoDrag);\r\n        document.documentElement.removeEventListener(\"mouseup\", this.resizeStopDrag);\r\n        document.documentElement.removeEventListener(\"touchmove\", this.resizeTouchDrag);\r\n        document.documentElement.removeEventListener(\"touchend\", this.resizeStopDrag);\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this._body.style.pointerEvents = '';\r\n        this.emit('resized', this._state);\r\n    }\r\n\r\n    private dragMouseDown = e => {\r\n        if (this.maximized) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        document.documentElement.addEventListener('mouseup', this.dragMouseUp);\r\n        document.documentElement.addEventListener('mousemove', this.dragMouseMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private dragTouchStart = e => {\r\n        if (this.maximized) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        document.documentElement.addEventListener('touchend', this.dragMouseUp);\r\n        document.documentElement.addEventListener('touchmove', this.dragTouchMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private dragMouseMove = e => {\r\n        let x = this._dragPosition.x - e.clientX;\r\n        let y = this._dragPosition.y - e.clientY;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        if (this._state.x < 16 - this._dialog.clientWidth)\r\n            this._state.x = 16 - this._dialog.clientWidth;\r\n        if (this._state.y < 16 - this._dialog.clientHeight)\r\n            this._state.y = 16 - this._dialog.clientHeight;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private dragTouchMove = e => {\r\n        if (!e.touches.length) return;\r\n        let x = this._dragPosition.x - e.touches[0].clientX;\r\n        let y = this._dragPosition.y - e.touches[0].clientY;\r\n        this._dragPosition.x = e.touches[0].clientX;\r\n        this._dragPosition.y = e.touches[0].clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        if (this._state.x < 16 - this._dialog.clientWidth)\r\n            this._state.x = 16 - this._dialog.clientWidth;\r\n        if (this._state.y < 16 - this._dialog.clientHeight)\r\n            this._state.y = 16 - this._dialog.clientHeight;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private dragMouseUp = () => {\r\n        document.documentElement.removeEventListener('mouseup', this.dragMouseUp);\r\n        document.documentElement.removeEventListener('mousemove', this.dragMouseMove);\r\n        document.documentElement.removeEventListener('touchend', this.dragMouseUp);\r\n        document.documentElement.removeEventListener('touchmove', this.dragTouchMove);\r\n        this._header.style.cursor = '';\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this.emit('moved', this._state);\r\n    };\r\n\r\n    public moveable: boolean = true;\r\n    public resizable: boolean = true;\r\n    private _maximizable: boolean = true;\r\n\r\n    public get maximizable() { return this._maximizable; }\r\n    public set maximizable(value) {\r\n        if (value === this._maximizable) return;\r\n        this._maximizable = value;\r\n        if (this.maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n    }\r\n\r\n    public set maximized(value: boolean) {\r\n        if (this._state.maximized === value) return;\r\n        this._state.maximized = value;\r\n    }\r\n    public get maximized(): boolean {\r\n        return this._state.maximized;\r\n    }\r\n\r\n    constructor(options?: DialogOptions) {\r\n        super();\r\n        if (options && 'type' in options && options.type == 1) {\r\n            this._dialog = document.createElement('div');\r\n            this._dialog.open = false;\r\n        }\r\n        else\r\n            this._dialog = document.createElement('dialog');\r\n\r\n        if (typeof this._dialog.showModal !== \"function\") {\r\n            this._dialog.showModal = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 2;\r\n                this._dialog.focus();\r\n                this.emit('shown', false);\r\n                if (!this._dialog._keydown) {\r\n                    this._dialog._keydown = e => {\r\n                        if (e.key === 'Escape' && e.srcElement.tagName !== 'TEXTAREA' && e.srcElement.tagName !== 'INPUT' && e.srcElement.tagName !== 'SELECT')\r\n                            this.close();\r\n                    }\r\n                }\r\n                if (!this._dialog.backdrop_) {\r\n                    this._dialog.backdrop_ = document.createElement('div');\r\n                    this._dialog.backdrop_.className = 'backdrop';\r\n                    this._dialog.backdrop_MouseEvent = function (e) {\r\n                        if (!this.hasAttribute('tabindex')) {\r\n                            var fake = document.createElement('div');\r\n                            this.insertBefore(fake, this.firstChild);\r\n                            fake.tabIndex = -1;\r\n                            fake.focus();\r\n                            this.removeChild(fake);\r\n                        }\r\n                        else\r\n                            this.focus();\r\n                        var redirectedEvent = document.createEvent('MouseEvents');\r\n                        redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\r\n                            e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\r\n                            e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\r\n                        this.dispatchEvent(redirectedEvent);\r\n                        e.stopPropagation();\r\n                    }\r\n                    this._dialog.backdrop_.addEventListener('mouseup', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('mousedown', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('click', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                }\r\n                this._dialog.parentNode.insertBefore(this._dialog.backdrop_, this._dialog.nextSibling);\r\n                window.document.addEventListener('keydown', this._dialog._keydown);\r\n                this.getMaxZIndex();\r\n                this._dialog.backdrop_.style.zIndex = '' + ++this._state.zIndex;\r\n                this._dialog.style.zIndex = '' + ++this._state.zIndex;\r\n            };\r\n        }\r\n        //poly fill functions if not found to fake dialog\r\n        if (typeof this._dialog.show !== \"function\") {\r\n            this._dialog.show = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 1;\r\n                this._dialog.focus();\r\n                this.emit('shown', false);\r\n            };\r\n        }\r\n        if (typeof this._dialog.close !== \"function\") {\r\n            this._dialog.close = () => {\r\n                this._dialog.style.display = '';\r\n                this._dialog.style.visibility = '';\r\n                this._dialog.open = false;\r\n                this._state.show = 0;\r\n                window.removeEventListener('resize', this._windowResize);\r\n                this.emit('closed');\r\n            };\r\n        }\r\n        this._dialog.dialog = this;\r\n        if (options && 'id' in options && options.id && options.id.length)\r\n            this._id = options.id;\r\n        else if (!this._id || !this._id.length)\r\n            this._id = 'dialog' + new Date().getTime();\r\n        this._dialog.id = this._id;\r\n        this._dialog.style.zIndex = '100';\r\n        this._dialog.style.margin = '0';\r\n        this._dialog.classList.add('dialog');\r\n        if (!options || !options.noAdaptive)\r\n            this._dialog.classList.add('adaptive');\r\n        if (options && 'moveable' in options)\r\n            this.moveable = options.moveable;\r\n        if (options && 'resizable' in options)\r\n            this.resizable = options.resizable;\r\n        if (options && 'maximizable' in options)\r\n            this._maximizable = options.maximizable;\r\n        if (typeof options?.height === 'number')\r\n            this._dialog.style.height = options.height + 'px';\r\n        else if (options?.height && options?.height.length > 0)\r\n            this._dialog.style.height = options.height;\r\n        else\r\n            this._dialog.style.height = '480px';\r\n\r\n        if (typeof options?.minHeight === 'number')\r\n            this._dialog.style.minHeight = options.minHeight + 'px';\r\n        else if (options?.minHeight && options?.minHeight.length > 0)\r\n            this._dialog.style.minHeight = options.minHeight;\r\n        else\r\n            this._dialog.style.minHeight = '150px';\r\n\r\n        if (typeof options?.minWidth === 'number')\r\n            this._dialog.style.minWidth = options.minWidth + 'px';\r\n        else if (options?.minWidth && options?.minWidth.length > 0)\r\n            this._dialog.style.minWidth = options.minWidth;\r\n        else\r\n            this._dialog.style.minWidth = '300px';\r\n\r\n        if (typeof options?.width === 'number')\r\n            this._dialog.style.width = options.width + 'px';\r\n        else if (options?.width && options?.width.length > 0)\r\n            this._dialog.style.width = options.width;\r\n        else\r\n            this._dialog.style.width = '640px';\r\n        if (typeof options?.y === 'number')\r\n            this._dialog.style.top = options.y + 'px';\r\n        else if (options?.y && options?.y.length > 0)\r\n            this._dialog.style.top = options.y;\r\n        else\r\n            this._dialog.style.top = '0';\r\n        if (typeof options?.x === 'number')\r\n            this._dialog.style.left = options.x + 'px';\r\n        else if (options?.x && options?.x.length > 0)\r\n            this._dialog.style.left = options.x;\r\n        else\r\n            this._dialog.style.left = '0';\r\n        let footer = '';\r\n        if (options?.buttons)\r\n            footer += `<button id=\"${this._id}-cancel\" type=\"button\" class=\"float-end btn btn-light\" title=\"Cancel dialog\">Cancel</button>\r\n            <button id=\"${this._id}-ok\" type=\"button\" class=\"float-end btn btn-primary\" title=\"Confirm dialog\">Ok</button>`;\r\n        this._dialog.innerHTML = `<div class=\"dialog-header\">\r\n        <button id=\"${this._id}-header-close\" style=\"padding: 4px;\" type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" title=\"Close window\"></button>\r\n        <button type=\"button\" class=\"btn btn-light float-end maximize\" id=\"${this._id}-max\" title=\"Maximize window\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-arrows-fullscreen\"></i></button>\r\n        <div>${options?.title || ''}</div>\r\n    </div>\r\n    <div class=\"dialog-body\"></div>\r\n    <div class=\"dialog-footer\">${footer}</div>`;\r\n        this._dialog.querySelector(`#${this._id}-header-close`).addEventListener('click', () => {\r\n            this.close();\r\n        });\r\n        this._dialog.querySelector(`#${this._id}-max`).addEventListener('click', () => {\r\n            if (!this.maximized)\r\n                this.maximize();\r\n            else\r\n                this.restore();\r\n        });\r\n        this._dialog.addEventListener('close', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('closing', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            window.removeEventListener('resize', this._windowResize);\r\n            this.emit('closed');\r\n        });\r\n        this._dialog.addEventListener('cancel', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('canceling', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //prevent closing ig in edit field, note this does not stop chrome from closing dialog if esc is pressed multiple times\r\n            if (document.activeElement && (document.activeElement.tagName === 'TEXTAREA' ||\r\n                document.activeElement.tagName === 'iNPUT' ||\r\n                document.activeElement.tagName === 'SELECT')\r\n            ) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //left true sometimes so lets just always make it false to ensure modal dialogs open right\r\n            this._dialog.open = false;\r\n            document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            window.removeEventListener('resize', this._windowResize);\r\n            if (this._dialog.returnValue !== 'ok')\r\n                this.emit('canceled');\r\n        });\r\n        document.body.appendChild(this._dialog);\r\n\r\n        if (this._maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n        if (options?.buttons) {\r\n            this._dialog.querySelector(`#${this._id}-cancel`).addEventListener('click', () => {\r\n                this.close();\r\n            });\r\n            this._dialog.querySelector(`#${this._id}-ok`).addEventListener('click', () => {\r\n                const e = { preventDefault: false };\r\n                this.emit('ok', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'ok';\r\n                this._dialog.close();\r\n            });\r\n        }\r\n        this._body = this._dialog.querySelector('[class=\"dialog-body\"]');\r\n        this._title = this._dialog.querySelector('[class=\"dialog-header\"] div');\r\n        this._footer = this._dialog.querySelector('[class=\"dialog-footer\"]');\r\n        this._header = this._dialog.querySelector('[class=\"dialog-header\"]');\r\n\r\n        if (this.resizable) {\r\n            this._dialog.classList.add('resizable');\r\n            var right = document.createElement(\"div\");\r\n            right.className = \"resizer-right\";\r\n            this._dialog.appendChild(right);\r\n            right.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right) }, false);\r\n            right.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right) }, { passive: true });\r\n\r\n            var bottom = document.createElement(\"div\");\r\n            bottom.className = \"resizer-bottom\";\r\n            this._dialog.appendChild(bottom);\r\n            bottom.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Bottom) }, false);\r\n            bottom.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Bottom) }, { passive: true });\r\n\r\n            var corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-se\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right | ResizeType.Bottom) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right | ResizeType.Bottom) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-ne\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Right | ResizeType.Top) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Right | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-nw\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left | ResizeType.Top) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = document.createElement(\"div\");\r\n            corner.className = \"resizer-sw\";\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left | ResizeType.Bottom) }, false);\r\n            corner.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left | ResizeType.Bottom) }, { passive: true });\r\n\r\n            var left = document.createElement(\"div\");\r\n            left.className = \"resizer-left\";\r\n            this._dialog.appendChild(left);\r\n            left.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Left) }, false);\r\n            left.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Left) }, { passive: true });\r\n\r\n            var top = document.createElement(\"div\");\r\n            top.className = \"resizer-top\";\r\n            this._dialog.appendChild(top);\r\n            top.addEventListener(\"mousedown\", e => { this.initResize(e, ResizeType.Top) }, false);\r\n            top.addEventListener(\"touchstart\", e => { this.initResizeTouch(e, ResizeType.Top) }, { passive: true });\r\n        }\r\n\r\n        if (this.moveable) {\r\n            this._dialog.addEventListener('mousedown', () => {\r\n                this.getMaxZIndex();\r\n                this._dialog.style.zIndex = '' + ++this._state.zIndex;\r\n            })\r\n            this._header.addEventListener('mousedown', this.dragMouseDown);\r\n            this._header.addEventListener('touchstart', this.dragTouchStart, { passive: true });\r\n        }\r\n\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._state.x = this._resize.x = parseInt(styles.left, 10);;\r\n        this._state.width = this._resize.width = parseInt(styles.width, 10);\r\n        this._state.y = this._resize.y = parseInt(styles.top, 10);;\r\n        this._state.height = this._resize.height = parseInt(styles.height, 10);\r\n\r\n        if (options && 'noFooter' in options && options.noFooter)\r\n            this.hideFooter();\r\n        if (options && 'maximized' in options && options.maximized)\r\n            this.maximize();\r\n        if (options && 'showModal' in options && options.showModal)\r\n            this.showModal();\r\n        else if (options && 'show' in options && options.show) {\r\n            if (options.show === 2)\r\n                this.showModal();\r\n            else\r\n                this.show();\r\n        }\r\n        if (options && 'center' in options && options.center)\r\n            this.center();\r\n        if (options && 'position' in options && options.position > 0)\r\n            this.position(options.position);\r\n    }\r\n\r\n    private initResize(e, type) {\r\n        if (this.maximized) return;\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._resize.x = e.clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        this._resize.borderHeight = e.offsetY + parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = e.offsetX + parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        document.documentElement.addEventListener(\"mousemove\", this.resizeDoDrag, false);\r\n        document.documentElement.addEventListener(\"mouseup\", this.resizeStopDrag, false);\r\n    }\r\n\r\n    private initResizeTouch(e, type) {\r\n        if (!e.touches.length || this.maximized) return;\r\n        const styles = document.defaultView.getComputedStyle(this._dialog);\r\n        this._resize.x = e.touches[0].clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.touches[0].clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        var rect = e.target.getBoundingClientRect();\r\n        var x = e.targetTouches[0].clientX - rect.x;\r\n        var y = e.targetTouches[0].clientY - rect.y;\r\n        this._resize.borderHeight = y + parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = x + parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        document.documentElement.addEventListener(\"touchmove\", this.resizeTouchDrag, false);\r\n        document.documentElement.addEventListener(\"touchend\", this.resizeStopDrag, false);\r\n    }\r\n\r\n    public get id() {\r\n        return this._id;\r\n    }\r\n\r\n    public set id(value) {\r\n        if (this._id === value) return;\r\n        this._id = value;\r\n        if (this._dialog) {\r\n            const old = this._dialog.id;\r\n            this._dialog.id = this._id;\r\n            let el = this._dialog.querySelector(`#${this._id}-cancel`);\r\n            if (el) el.id = this._id + '-cancel';\r\n            el = this._dialog.querySelector(`#${this._id}-ok`);\r\n            if (el) el.id = this._id + '-ok';\r\n            el = this._dialog.querySelector(`#${this._id}-max`);\r\n            if (el) el.id = this._id + '-max';\r\n            el = this._dialog.querySelector(`#${this._id}-header-close`);\r\n            if (el) el.id = this._id + '-header-close';\r\n        }\r\n    }\r\n\r\n    public get title() {\r\n        return this._title.innerHTML;\r\n    }\r\n    public set title(value) {\r\n        this._title.innerHTML = value;\r\n    }\r\n\r\n    public showModal() {\r\n        if (!this._dialog.parentElement)\r\n            document.body.appendChild(this._dialog);\r\n        if (this._dialog.open) return;\r\n        this._dialog.showModal();\r\n        this._state.show = 2;\r\n        window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', true);\r\n    }\r\n\r\n    public show() {\r\n        if (!this._dialog.parentElement)\r\n            document.body.appendChild(this._dialog);\r\n        if (this._dialog.open) return;\r\n        this._dialog.show();\r\n        this._state.show = 1;\r\n        window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', false);\r\n    }\r\n\r\n    public get opened() {\r\n        return this._dialog.open;\r\n    }\r\n\r\n    public close() {\r\n        if (!this._dialog.open) return;\r\n        if (this._dialog.backdrop_)\r\n            this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n        if (this._dialog._keydown)\r\n            window.document.removeEventListener('keydown', this._dialog._keydown);\r\n        this._dialog.close();\r\n    }\r\n\r\n    public get header() {\r\n        return this._header;\r\n    }\r\n    public get body() {\r\n        return this._body;\r\n    }\r\n    public get footer() {\r\n        return this._footer;\r\n    }\r\n    public get dialog() {\r\n        return this._dialog;\r\n    }\r\n\r\n    public get left() {\r\n        return this._dialog.style.left;\r\n    }\r\n    public set left(value) {\r\n        this._dialog.style.left = value;\r\n    }\r\n\r\n    public get top() {\r\n        return this._dialog.style.top;\r\n    }\r\n    public set top(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get width() {\r\n        return this._dialog.style.width;\r\n    }\r\n    public set width(value) {\r\n        this._dialog.style.width = value;\r\n    }\r\n\r\n    public get height() {\r\n        return this._dialog.style.height;\r\n    }\r\n    public set height(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get windowState() {\r\n        return this._state;\r\n    }\r\n\r\n    public center() {\r\n        this.position(Position.Center);\r\n    }\r\n\r\n    public position(position: Position) {\r\n        if (position < 1) return;\r\n        //styles2.width\r\n        let w = this._dialog.clientWidth;\r\n        let h = this._dialog.clientHeight;\r\n        if (!w || !h) {\r\n            const styles = document.defaultView.getComputedStyle(this._dialog);\r\n            w = w || parseInt(styles.width, 10);\r\n            h = h || parseInt(styles.height, 10);\r\n        }\r\n        if ((position & Position.Top) === Position.Top)\r\n            this._state.y = 0;\r\n        else if ((position & Position.Bottom) === Position.Bottom)\r\n            this._state.y = window.innerHeight - h;\r\n        else if ((position & Position.CenterVertical) === Position.CenterVertical)\r\n            this._state.y = (window.innerHeight / 2 - h / 2);\r\n\r\n        if ((position & Position.Left) === Position.Left)\r\n            this._state.x = 0;\r\n        else if ((position & Position.Right) === Position.Right)\r\n            this._state.x = window.innerWidth - w;\r\n        else if ((position & Position.CenterHorizontal) === Position.CenterHorizontal)\r\n            this._state.x = (window.innerWidth / 2 - w / 2);\r\n\r\n        this._dialog.style.left = this._state.x + 'px';\r\n        this._dialog.style.top = this._state.y + 'px';\r\n        this._state.width = this._dialog.clientWidth;\r\n        this._state.height = this._dialog.clientHeight;\r\n        this.emit('moved', this._state);\r\n    }\r\n\r\n    public maximize() {\r\n        if (this.maximized) return;\r\n        this.maximized = true;\r\n        this._dialog.classList.add('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-angle-contract');\r\n        this.emit('maximized');\r\n    }\r\n\r\n    public restore() {\r\n        if (!this.maximized) return;\r\n        this.maximized = false;\r\n        this._dialog.classList.remove('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-angle-contract');\r\n        this.emit('restored');\r\n    }\r\n\r\n    private getMaxZIndex(forceReset?: boolean) {\r\n        const dialogs = document.getElementsByTagName('dialog');\r\n        let d = 0;\r\n        const dl = dialogs.length;\r\n        let i = parseInt(this._dialog.style.zIndex, 10);;\r\n        const order = [];\r\n        for (; d < dl; d++) {\r\n            if (!dialogs[d].style.zIndex || !dialogs[d].style.zIndex.length) continue;\r\n            let z = parseInt(dialogs[d].style.zIndex, 10);\r\n            if (z > i)\r\n                i = z;\r\n            order.push({ z: z, idx: d });\r\n        }\r\n        this._state.zIndex = i;\r\n        if (forceReset || this._state.zIndex > 1000) {\r\n            this._state.zIndex = 100;\r\n            d = 0;\r\n            order.sort((a, b) => ((a.z < b.z) ? -1 : (a.z > b.z ? 1 : 0)))\r\n            for (; d < dl; d++)\r\n                dialogs[order[d].idx].style.zIndex = '' + (this._state.zIndex++);\r\n        }\r\n    }\r\n\r\n    public showFooter() {\r\n        this._footer.style.display = '';\r\n        this._body.bottom = '';\r\n    }\r\n\r\n    public hideFooter() {\r\n        this._footer.style.display = 'none';\r\n        this._body.style.bottom = '0';\r\n    }\r\n}", "/**\r\n * A class to parse color values\r\n * @author Stoyan Stefanov <sstoo@gmail.com>\r\n * @link   http://www.phpied.com/rgb-color-parser-in-javascript/\r\n * @license Use it if you like it\r\n */\r\nexport function RGBColor(color_string)\r\n{\r\n    this.ok = false;\r\n\r\n    // strip any leading #\r\n    if (color_string.charAt(0) == '#') { // remove # if any\r\n        color_string = color_string.substr(1,6);\r\n    }\r\n\r\n    color_string = color_string.replace(/ /g,'');\r\n    color_string = color_string.toLowerCase();\r\n\r\n    // before getting into regexps, try simple matches\r\n    // and overwrite the input\r\n    var simple_colors = {\r\n        aliceblue: 'f0f8ff',\r\n        antiquewhite: 'faebd7',\r\n        aqua: '00ffff',\r\n        aquamarine: '7fffd4',\r\n        azure: 'f0ffff',\r\n        beige: 'f5f5dc',\r\n        bisque: 'ffe4c4',\r\n        black: '000000',\r\n        blanchedalmond: 'ffebcd',\r\n        blue: '0000ff',\r\n        blueviolet: '8a2be2',\r\n        brown: 'a52a2a',\r\n        burlywood: 'deb887',\r\n        cadetblue: '5f9ea0',\r\n        chartreuse: '7fff00',\r\n        chocolate: 'd2691e',\r\n        coral: 'ff7f50',\r\n        cornflowerblue: '6495ed',\r\n        cornsilk: 'fff8dc',\r\n        crimson: 'dc143c',\r\n        cyan: '00ffff',\r\n        darkblue: '00008b',\r\n        darkcyan: '008b8b',\r\n        darkgoldenrod: 'b8860b',\r\n        darkgray: 'a9a9a9',\r\n        darkgreen: '006400',\r\n        darkkhaki: 'bdb76b',\r\n        darkmagenta: '8b008b',\r\n        darkolivegreen: '556b2f',\r\n        darkorange: 'ff8c00',\r\n        darkorchid: '9932cc',\r\n        darkred: '8b0000',\r\n        darksalmon: 'e9967a',\r\n        darkseagreen: '8fbc8f',\r\n        darkslateblue: '483d8b',\r\n        darkslategray: '2f4f4f',\r\n        darkturquoise: '00ced1',\r\n        darkviolet: '9400d3',\r\n        deeppink: 'ff1493',\r\n        deepskyblue: '00bfff',\r\n        dimgray: '696969',\r\n        dodgerblue: '1e90ff',\r\n        feldspar: 'd19275',\r\n        firebrick: 'b22222',\r\n        floralwhite: 'fffaf0',\r\n        forestgreen: '228b22',\r\n        fuchsia: 'ff00ff',\r\n        gainsboro: 'dcdcdc',\r\n        ghostwhite: 'f8f8ff',\r\n        gold: 'ffd700',\r\n        goldenrod: 'daa520',\r\n        gray: '808080',\r\n        green: '008000',\r\n        greenyellow: 'adff2f',\r\n        honeydew: 'f0fff0',\r\n        hotpink: 'ff69b4',\r\n        indianred : 'cd5c5c',\r\n        indigo : '4b0082',\r\n        ivory: 'fffff0',\r\n        khaki: 'f0e68c',\r\n        lavender: 'e6e6fa',\r\n        lavenderblush: 'fff0f5',\r\n        lawngreen: '7cfc00',\r\n        lemonchiffon: 'fffacd',\r\n        lightblue: 'add8e6',\r\n        lightcoral: 'f08080',\r\n        lightcyan: 'e0ffff',\r\n        lightgoldenrodyellow: 'fafad2',\r\n        lightgrey: 'd3d3d3',\r\n        lightgreen: '90ee90',\r\n        lightpink: 'ffb6c1',\r\n        lightsalmon: 'ffa07a',\r\n        lightseagreen: '20b2aa',\r\n        lightskyblue: '87cefa',\r\n        lightslateblue: '8470ff',\r\n        lightslategray: '778899',\r\n        lightsteelblue: 'b0c4de',\r\n        lightyellow: 'ffffe0',\r\n        lime: '00ff00',\r\n        limegreen: '32cd32',\r\n        linen: 'faf0e6',\r\n        magenta: 'ff00ff',\r\n        maroon: '800000',\r\n        mediumaquamarine: '66cdaa',\r\n        mediumblue: '0000cd',\r\n        mediumorchid: 'ba55d3',\r\n        mediumpurple: '9370d8',\r\n        mediumseagreen: '3cb371',\r\n        mediumslateblue: '7b68ee',\r\n        mediumspringgreen: '00fa9a',\r\n        mediumturquoise: '48d1cc',\r\n        mediumvioletred: 'c71585',\r\n        midnightblue: '191970',\r\n        mintcream: 'f5fffa',\r\n        mistyrose: 'ffe4e1',\r\n        moccasin: 'ffe4b5',\r\n        navajowhite: 'ffdead',\r\n        navy: '000080',\r\n        oldlace: 'fdf5e6',\r\n        olive: '808000',\r\n        olivedrab: '6b8e23',\r\n        orange: 'ffa500',\r\n        orangered: 'ff4500',\r\n        orchid: 'da70d6',\r\n        palegoldenrod: 'eee8aa',\r\n        palegreen: '98fb98',\r\n        paleturquoise: 'afeeee',\r\n        palevioletred: 'd87093',\r\n        papayawhip: 'ffefd5',\r\n        peachpuff: 'ffdab9',\r\n        peru: 'cd853f',\r\n        pink: 'ffc0cb',\r\n        plum: 'dda0dd',\r\n        powderblue: 'b0e0e6',\r\n        purple: '800080',\r\n        red: 'ff0000',\r\n        rosybrown: 'bc8f8f',\r\n        royalblue: '4169e1',\r\n        saddlebrown: '8b4513',\r\n        salmon: 'fa8072',\r\n        sandybrown: 'f4a460',\r\n        seagreen: '2e8b57',\r\n        seashell: 'fff5ee',\r\n        sienna: 'a0522d',\r\n        silver: 'c0c0c0',\r\n        skyblue: '87ceeb',\r\n        slateblue: '6a5acd',\r\n        slategray: '708090',\r\n        snow: 'fffafa',\r\n        springgreen: '00ff7f',\r\n        steelblue: '4682b4',\r\n        tan: 'd2b48c',\r\n        teal: '008080',\r\n        thistle: 'd8bfd8',\r\n        tomato: 'ff6347',\r\n        turquoise: '40e0d0',\r\n        violet: 'ee82ee',\r\n        violetred: 'd02090',\r\n        wheat: 'f5deb3',\r\n        white: 'ffffff',\r\n        whitesmoke: 'f5f5f5',\r\n        yellow: 'ffff00',\r\n        yellowgreen: '9acd32'\r\n    };\r\n    for (var key in simple_colors) {\r\n        if (color_string == key) {\r\n            color_string = simple_colors[key];\r\n        }\r\n    }\r\n    // end of simple type-in colors\r\n\r\n    // array of color definition objects\r\n    var color_defs = [\r\n        {\r\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\r\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 10),\r\n                    parseInt(bits[2], 10),\r\n                    parseInt(bits[3], 10)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{2})(\\w{2})(\\w{2})$/,\r\n            example: ['#00ff00', '336699'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 16),\r\n                    parseInt(bits[2], 16),\r\n                    parseInt(bits[3], 16)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{1})(\\w{1})(\\w{1})$/,\r\n            example: ['#fb0', 'f0f'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1] + bits[1], 16),\r\n                    parseInt(bits[2] + bits[2], 16),\r\n                    parseInt(bits[3] + bits[3], 16)\r\n                ];\r\n            }\r\n        }\r\n    ];\r\n\r\n    // search through the definitions to find a match\r\n    for (var i = 0, cl = color_defs.length; i < cl; i++) {\r\n        var re = color_defs[i].re;\r\n        var processor = color_defs[i].process;\r\n        var bits = re.exec(color_string);\r\n        if (bits) {\r\n            var channels = processor(bits);\r\n            this.r = channels[0];\r\n            this.g = channels[1];\r\n            this.b = channels[2];\r\n            this.ok = true;\r\n        }\r\n\r\n    }\r\n\r\n    // validate/cleanup values\r\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\r\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\r\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\r\n\r\n    // some getters\r\n    this.toRGB = function () {\r\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\r\n    };\r\n    this.toHex = function () {\r\n        var r = this.r.toString(16);\r\n        var g = this.g.toString(16);\r\n        var b = this.b.toString(16);\r\n        if (r.length == 1) r = '0' + r;\r\n        if (g.length == 1) g = '0' + g;\r\n        if (b.length == 1) b = '0' + b;\r\n        return '#' + r + g + b;\r\n    };\r\n\r\n    // help\r\n    /*\r\n    this.getHelpXML = function () {\r\n\r\n        var examples = [], i, l;\r\n        // add regexps\r\n        for (i = 0, l = color_defs.length; i < l; i++) {\r\n            var example = color_defs[i].example;\r\n            for (var j = 0, el = example.length; j < el; j++) {\r\n                examples[examples.length] = example[j];\r\n            }\r\n        }\r\n        // add type-in colors\r\n        for (var sc in simple_colors) {\r\n            examples[examples.length] = sc;\r\n        }\r\n\r\n        var xml = document.createElement('ul');\r\n        xml.setAttribute('id', 'rgbcolor-examples');\r\n        for (i = 0, el = examples.length; i < el; i++) {\r\n            try {\r\n                var list_item = document.createElement('li');\r\n                var list_color = new RGBColor(examples[i]);\r\n                var example_div = document.createElement('div');\r\n                example_div.style.cssText = 'margin: 3px;border: 1px solid black;background:' + list_color.toHex() + ';color:' + list_color.toHex();\r\n                example_div.appendChild(document.createTextNode('test'));\r\n                var list_item_value = document.createTextNode(' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex());\r\n                list_item.appendChild(example_div);\r\n                list_item.appendChild(list_item_value);\r\n                xml.appendChild(list_item);\r\n\r\n            } catch(e){}\r\n        }\r\n        return xml;\r\n\r\n    };\r\n    */\r\n\r\n}\r\n\r\n", "import \"../css/tinymce.css\";\r\nimport { EventEmitter } from \"../events\";\r\nimport { RGBColor } from '../lib/rgbcolor';\r\nimport { insertValue, stripHTML, htmlEncode, invert, getColors, copyText, openFileDialog, readFile, pasteText, pinkfishToHTML } from '../library'\r\nimport { Dialog } from \"../dialog\";\r\n\r\nexport class AdvEditor extends EventEmitter {\r\n    private _element;\r\n    private _simple = true;\r\n    private _colors;\r\n    private _ColorTable;\r\n    //private _colorCodes;\r\n    private colorNames = {\r\n        'No color': 'Default',\r\n        'BLACK': 'Black',\r\n        'RED': 'Maroon',\r\n        'GREEN': 'Green',\r\n        'ORANGE': 'Olive',\r\n        'BLUE': 'Navy',\r\n        'MAGENTA': 'Purple',\r\n        'WHITE': 'Silver',\r\n        'CYAN': 'Teal',\r\n        'BOLD BLACK': 'Grey',\r\n        'BOLD RED': 'Red',\r\n        'BOLD GREEN': 'Lime',\r\n        'YELLOW': 'Yellow',\r\n        'BOLD YELLOW': 'Yellow',\r\n        'BOLD BLUE': 'Blue',\r\n        'BOLD MAGENTA': 'Fuchsia',\r\n        'BOLD CYAN': 'Aqua',\r\n        'BOLD': 'White',\r\n        'BOLD WHITE': 'White',\r\n        'RGB000': 'Black',\r\n        'RGB001': 'Navy Blue',\r\n        'RGB002': 'Dark Blue',\r\n        'RGB003': 'Blue',\r\n        'RGB004': 'Blue',\r\n        'RGB005': 'Blue',\r\n        'RGB010': 'Dark Green',\r\n        'RGB011': 'Deep Sky Blue',\r\n        'RGB012': 'Deep Sky Blue',\r\n        'RGB013': 'Deep Sky Blue',\r\n        'RGB014': 'Cobalt/Dodger Blue',\r\n        'RGB015': 'Dodger Blue',\r\n        'RGB020': 'Green',\r\n        'RGB021': 'Spring Green',\r\n        'RGB022': 'Turquoise',\r\n        'RGB023': 'Deep Sky Blue',\r\n        'RGB024': 'Deep Sky Blue',\r\n        'RGB025': 'Dodger Blue',\r\n        'RGB030': 'Green',\r\n        'RGB031': 'Spring Green',\r\n        'RGB032': 'Dark Cyan',\r\n        'RGB033': 'Light Sea Green',\r\n        'RGB034': 'Deep Sky Blue',\r\n        'RGB035': 'Deep Sky Blue',\r\n        'RGB040': 'Green',\r\n        'RGB041': 'Spring Green',\r\n        'RGB042': 'Spring Green',\r\n        'RGB043': 'Cyan',\r\n        'RGB044': 'Dark Turquoise',\r\n        'RGB045': 'Turquoise',\r\n        'RGB050': 'Green',\r\n        'RGB051': 'Spring Green',\r\n        'RGB052': 'Spring Green',\r\n        'RGB053': 'Medium Spring Green',\r\n        'RGB054': 'Cyan',\r\n        'RGB055': 'Cyan',\r\n        'RGB100': 'Dark Red',\r\n        'RGB101': 'Deep Pink',\r\n        'RGB102': 'Purple',\r\n        'RGB103': 'Purple',\r\n        'RGB104': 'Purple',\r\n        'RGB105': 'Blue Violet',\r\n        'RGB110': 'Orange',\r\n        'RGB111': 'Dark Grey',\r\n        'RGB112': 'Medium Purple',\r\n        'RGB113': 'Slate Blue',\r\n        'RGB114': 'Slate Blue',\r\n        'RGB115': 'Royal Blue',\r\n        'RGB120': 'Chartreuse',\r\n        'RGB121': 'Dark Sea Green',\r\n        'RGB122': 'Pale Turquoise',\r\n        'RGB123': 'Steel Blue',\r\n        'RGB124': 'Steel Blue',\r\n        'RGB125': 'Cornflower Blue',\r\n        'RGB130': 'Chartreuse',\r\n        'RGB131': 'Dark Sea Green',\r\n        'RGB132': 'Cadet Blue',\r\n        'RGB133': 'Cadet Blue',\r\n        'RGB134': 'Sky Blue',\r\n        'RGB135': 'Steel Blue',\r\n        'RGB140': 'Chartreuse',\r\n        'RGB141': 'Pale Green',\r\n        'RGB142': 'Sea Green',\r\n        'RGB143': 'Aquamarine',\r\n        'RGB144': 'Medium Turquoise',\r\n        'RGB145': 'Steel Blue',\r\n        'RGB150': 'Chartreuse',\r\n        'RGB151': 'Sea Green',\r\n        'RGB152': 'Sea Green',\r\n        'RGB153': 'Sea Green',\r\n        'RGB154': 'Aquamarine',\r\n        'RGB155': 'Dark Slate Gray',\r\n        'RGB200': 'Dark Red',\r\n        'RGB201': 'Deep Pink',\r\n        'RGB202': 'Dark Magenta',\r\n        'RGB203': 'Dark Magenta',\r\n        'RGB204': 'Dark Violet',\r\n        'RGB205': 'Purple',\r\n        'RGB210': 'Orange',\r\n        'RGB211': 'Light Pink',\r\n        'RGB212': 'Plum',\r\n        'RGB213': 'Medium Purple',\r\n        'RGB214': 'Medium Purple',\r\n        'RGB215': 'Slate Blue',\r\n        'RGB220': 'Yellow',\r\n        'RGB221': 'Wheat',\r\n        'RGB222': 'Grey',\r\n        'RGB223': 'Light Slate Grey',\r\n        'RGB224': 'Medium Purple',\r\n        'RGB225': 'Light Slate Blue',\r\n        'RGB230': 'Yellow',\r\n        'RGB231': 'Dark Olive Green',\r\n        'RGB232': 'Dark Sea Green',\r\n        'RGB233': 'Light Sky Blue',\r\n        'RGB234': 'Light Sky Blue',\r\n        'RGB235': 'Sky Blue',\r\n        'RGB240': 'Chartreuse',\r\n        'RGB241': 'Dark Olive Green',\r\n        'RGB242': 'Pale Green',\r\n        'RGB243': 'Dark Sea Green',\r\n        'RGB244': 'Dark Slate Gray',\r\n        'RGB245': 'Sky Blue',\r\n        'RGB250': 'Chartreuse',\r\n        'RGB251': 'Light Green',\r\n        'RGB252': 'Light Green',\r\n        'RGB253': 'Pale Green',\r\n        'RGB254': 'Aquamarine',\r\n        'RGB255': 'Dark Slate Gray',\r\n        'RGB300': 'Red',\r\n        'RGB301': 'Deep Pink',\r\n        'RGB302': 'Medium Violet Red',\r\n        'RGB303': 'Magenta',\r\n        'RGB304': 'Dark Violet',\r\n        'RGB305': 'Purple',\r\n        'RGB310': 'Dark Orange',\r\n        'RGB311': 'Indian Red',\r\n        'RGB312': 'Hot Pink',\r\n        'RGB313': 'Medium Orchid',\r\n        'RGB314': 'Medium Orchid',\r\n        'RGB315': 'Medium Purple',\r\n        'RGB320': 'Dark Goldenrod',\r\n        'RGB321': 'Light Salmon',\r\n        'RGB322': 'Rosy Brown',\r\n        'RGB323': 'Grey',\r\n        'RGB324': 'Medium Purple',\r\n        'RGB325': 'Medium Purple',\r\n        'RGB330': 'Gold',\r\n        'RGB331': 'Dark Khaki',\r\n        'RGB332': 'Navajo White',\r\n        'RGB333': 'Grey',\r\n        'RGB334': 'Light Steel Blue',\r\n        'RGB335': 'Light Steel Blue',\r\n        'RGB340': 'Yellow',\r\n        'RGB341': 'Dark Olive Green',\r\n        'RGB342': 'Dark Sea Green',\r\n        'RGB343': 'Dark Sea Green',\r\n        'RGB344': 'Light Cyan',\r\n        'RGB345': 'Light Sky Blue',\r\n        'RGB350': 'Green Yellow',\r\n        'RGB351': 'Dark Olive Green',\r\n        'RGB352': 'Pale Green',\r\n        'RGB353': 'Dark Sea Green',\r\n        'RGB354': 'Dark Sea Green',\r\n        'RGB355': 'Pale Turquoise',\r\n        'RGB400': 'Crimson/Red',\r\n        'RGB401': 'Deep Pink',\r\n        'RGB402': 'Deep Pink',\r\n        'RGB403': 'Magenta',\r\n        'RGB404': 'Magenta',\r\n        'RGB405': 'Magenta',\r\n        'RGB410': 'Dark Orange',\r\n        'RGB411': 'Indian Red',\r\n        'RGB412': 'Hot Pink',\r\n        'RGB413': 'Hot Pink',\r\n        'RGB414': 'Orchid',\r\n        'RGB415': 'Medium Orchid',\r\n        'RGB420': 'Orange',\r\n        'RGB421': 'Light Salmon/Bronze',\r\n        'RGB422': 'Light Pink',\r\n        'RGB423': 'Pink',\r\n        'RGB424': 'Plum',\r\n        'RGB425': 'Violet',\r\n        'RGB430': 'Gold',\r\n        'RGB431': 'Light Goldenrod',\r\n        'RGB432': 'Tan',\r\n        'RGB433': 'Misty Rose',\r\n        'RGB434': 'Thistle',\r\n        'RGB435': 'Plum',\r\n        'RGB440': 'Yellow',\r\n        'RGB441': 'Khaki',\r\n        'RGB442': 'Light Goldenrod',\r\n        'RGB443': 'Light Yellow',\r\n        'RGB444': 'Grey',\r\n        'RGB445': 'Light Steel Blue',\r\n        'RGB450': 'Yellow',\r\n        'RGB451': 'Dark Olive Green',\r\n        'RGB452': 'Dark Olive Green',\r\n        'RGB453': 'Dark Sea Green',\r\n        'RGB454': 'Honeydew',\r\n        'RGB455': 'Light Cyan',\r\n        'RGB500': 'Red',\r\n        'RGB501': 'Deep Pink',\r\n        'RGB502': 'Deep Pink',\r\n        'RGB503': 'Deep Pink',\r\n        'RGB504': 'Magenta',\r\n        'RGB505': 'Magenta',\r\n        'RGB510': 'Orangered',\r\n        'RGB511': 'Indian Red',\r\n        'RGB512': 'Indian Red',\r\n        'RGB513': 'Hot Pink',\r\n        'RGB514': 'Hot Pink',\r\n        'RGB515': 'Medium Orchid',\r\n        'RGB520': 'Dark Orange',\r\n        'RGB521': 'Salmon',\r\n        'RGB522': 'Light Coral',\r\n        'RGB523': 'Pale Violet Red',\r\n        'RGB524': 'Orchid',\r\n        'RGB525': 'Orchid',\r\n        'RGB530': 'Orange',\r\n        'RGB531': 'Sandy Brown',\r\n        'RGB532': 'Light Salmon',\r\n        'RGB533': 'Light Pink',\r\n        'RGB534': 'Pink',\r\n        'RGB535': 'Plum',\r\n        'RGB540': 'Gold',\r\n        'RGB541': 'Light Goldenrod',\r\n        'RGB542': 'Light Goldenrod',\r\n        'RGB543': 'Navajo White',\r\n        'RGB544': 'Misty Rose',\r\n        'RGB545': 'Thistle',\r\n        'RGB550': 'Yellow',\r\n        'RGB551': 'Light Goldenrod',\r\n        'RGB552': 'Khaki',\r\n        'RGB553': 'Wheat',\r\n        'RGB554': 'Corn Silk',\r\n        'RGB555': 'White',\r\n        'mono00': 'Grey 3',\r\n        'mono01': 'Grey 7',\r\n        'mono02': 'Grey 11',\r\n        'mono03': 'Grey 15',\r\n        'mono04': 'Grey 19',\r\n        'mono05': 'Grey 23',\r\n        'mono06': 'Grey 27',\r\n        'mono07': 'Grey 30',\r\n        'mono08': 'Grey 35',\r\n        'mono09': 'Grey 39',\r\n        'mono10': 'Grey 32',\r\n        'mono11': 'Grey 46',\r\n        'mono12': 'Grey 50',\r\n        'mono13': 'Grey 54',\r\n        'mono14': 'Grey 58',\r\n        'mono15': 'Grey 62',\r\n        'mono16': 'Grey 66',\r\n        'mono17': 'Grey 70',\r\n        'mono18': 'Grey 74',\r\n        'mono19': 'Grey 78',\r\n        'mono20': 'Grey 82',\r\n        'mono21': 'Grey 85',\r\n        'mono22': 'Grey 89',\r\n        'mono23': 'Grey 93'\r\n    };\r\n\r\n    private _colorDialog: Dialog;\r\n\r\n    constructor(element: string | JQuery | HTMLElement, enabledAdvanced?: boolean) {\r\n        super();\r\n        if (!element)\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        if (typeof element === 'string') {\r\n            this._element = document.querySelector(element);\r\n            if (!this._element)\r\n                throw new Error('Invalid selector for AdvEditor.');\r\n        }\r\n        else if (element instanceof $)\r\n            this._element = element[0];\r\n        else if (element instanceof HTMLElement)\r\n            this._element = element;\r\n        else\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        this.simple = !enabledAdvanced;\r\n    }\r\n\r\n    get id() {\r\n        if (this._element) return this._element.id;\r\n        return '';\r\n    }\r\n\r\n    get element(): HTMLElement {\r\n        return this._element;\r\n    }\r\n\r\n    get simple() { return this._simple; }\r\n    set simple(value) {\r\n        if (value === this._simple) return;\r\n        this._simple = value;\r\n        if (TINYMCE && !this.tinymceExist) return;\r\n        //was disabled\r\n        if (value)\r\n            this.remove();\r\n        else\r\n            this.initialize();\r\n    }\r\n    public clear() {\r\n        if (TINYMCE && !this.isSimple)\r\n            tinymce.activeEditor.setContent('');\r\n        else\r\n            this._element.value = '';\r\n    }\r\n    public get value() {\r\n        if (!this.isSimple)\r\n            return this.getFormattedText().replace(/(?:\\r)/g, '')\r\n        return this._element.value;\r\n    }\r\n    public set value(value) {\r\n        if (this.isSimple)\r\n            this._element.value = value;\r\n        else\r\n            tinymce.activeEditor.setContent(value);\r\n    }\r\n\r\n    public insert(value) {\r\n        if (!this.isSimple) {\r\n            value = htmlEncode(value);\r\n            value = value.replace(/ /g, '&nbsp;');\r\n            value = value.replace(/\\t/g, '&nbsp;&nbsp;&nbsp;');\r\n            value = value.replace(/(?:\\r\\n|\\r|\\n)/g, '<br/>');\r\n            var content = this.getText();\r\n            if (content === '\\n') {\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.setContent(value);\r\n                });\r\n            }\r\n            else {\r\n                if (!content.endsWith('\\n'))\r\n                    value = '<br>' + value;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.dom.add(tinymce.activeEditor.getBody(), 'span', {}, value);\r\n                });\r\n            }\r\n\r\n        }\r\n        else\r\n            insertValue(this._element, value); {\r\n        }\r\n\r\n    }\r\n\r\n    get tinymceExist() {\r\n        return TINYMCE && typeof (tinymce) !== 'undefined';\r\n    }\r\n\r\n    get isSimple(): boolean {\r\n        return this._simple || !this.tinymceExist;\r\n    }\r\n\r\n    private loadColors() {\r\n        var _dColors = getColors();\r\n        var c, color, r, g, b, idx, _bold = [], bl;\r\n        this._ColorTable = [];\r\n        this._colors = {};\r\n        var clientColors = client.getOption('colors') || [];\r\n        color = new RGBColor(clientColors[0] || _dColors[0]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BLACK';\r\n        this._ColorTable.push(color, 'BLACK');\r\n\r\n        color = new RGBColor(clientColors[1] || _dColors[1]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'RED';\r\n        this._ColorTable.push(color, 'RED');\r\n\r\n        color = new RGBColor(clientColors[2] || _dColors[2]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'GREEN';\r\n        this._ColorTable.push(color, 'GREEN');\r\n\r\n        color = new RGBColor(clientColors[3] || _dColors[3]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'ORANGE';\r\n        this._ColorTable.push(color, 'ORANGE');\r\n\r\n        color = new RGBColor(clientColors[4] || _dColors[4]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BLUE';\r\n        this._ColorTable.push(color, 'BLUE');\r\n        color = new RGBColor(clientColors[5] || _dColors[5]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'MAGENTA';\r\n        this._ColorTable.push(color, 'MAGENTA');\r\n        color = new RGBColor(clientColors[6] || _dColors[6]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'CYAN';\r\n        this._ColorTable.push(color, 'CYAN');\r\n        color = new RGBColor(clientColors[7] || _dColors[7]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'WHITE';\r\n        this._ColorTable.push(color, 'WHITE');\r\n\r\n        color = new RGBColor(clientColors[8] || _dColors[8]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'mono11';\r\n        this._ColorTable.push(color, 'BOLD BLACK');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[9] || _dColors[9]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^RED';\r\n        this._ColorTable.push(color, 'BOLD RED');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[10] || _dColors[10]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^GREEN';\r\n        this._ColorTable.push(color, 'BOLD GREEN');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[11] || _dColors[11]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^YELLOW';\r\n        this._ColorTable.push(color, 'BOLD YELLOW');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[11] || _dColors[11]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'YELLOW';\r\n        this._ColorTable.push(color, 'YELLOW');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[12] || _dColors[12]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^BLUE';\r\n        this._ColorTable.push(color, 'BOLD BLUE');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[13] || _dColors[13]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^MAGENTA';\r\n        this._ColorTable.push(color, 'BOLD MAGENTA');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[14] || _dColors[14]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^CYAN';\r\n        this._ColorTable.push(color, 'BOLD CYAN');\r\n        _bold.push(color);\r\n        color = new RGBColor(clientColors[15] || _dColors[15]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^WHITE';\r\n        this._ColorTable.push(color, 'BOLD WHITE');\r\n        //_bold.push(color);\r\n\r\n        for (r = 0; r < 6; r++) {\r\n            for (g = 0; g < 6; g++) {\r\n                for (b = 0; b < 6; b++) {\r\n                    idx = `RGB${r}${g}${b}`;\r\n                    color = '';\r\n                    c = 0;\r\n                    c = r * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = g * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = b * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    color = color.toUpperCase();\r\n                    //_ColorTable.push(color);\r\n                    //_ColorTable.push(idx);\r\n                    if (!this._colors[color])\r\n                        this._colors[color] = idx;\r\n                    this.colorList.push({ color: idx, hex: '#' + color, rgb: { r: r * 40 + 55, g: g * 40 + 55, b: b * 40 + 55 } });\r\n                }\r\n            }\r\n        }\r\n\r\n        for (r = 232; r <= 255; r++) {\r\n            g = (r - 232) * 10 + 8;\r\n            if (g < 16)\r\n                g = '0' + g.toString(16).toUpperCase();\r\n            else\r\n                g = g.toString(16).toUpperCase();\r\n            g = g + g + g;\r\n            //_ColorTable.push(g);\r\n            if (r < 242) {\r\n                //_ColorTable.push(\"mono0\" + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono0' + (r - 232);\r\n            }\r\n            else {\r\n                //_ColorTable.push(\"mono\" + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono' + (r - 232);\r\n            }\r\n        }\r\n        //this._colorCodes = invert(this._colors);\r\n        for (b = 0, bl = _bold.length; b < bl; b++) {\r\n            this._colors['B' + _bold[b]] = this._colors[this.nearestHex('#' + _bold[b]).substr(1)].toUpperCase();\r\n        }\r\n        this._colors['BFFFFFF'] = 'RGB555';\r\n        tinymce.activeEditor.options.set('color_map', this._ColorTable);\r\n    }\r\n\r\n    private initPlugins() {\r\n        if (!TINYMCE) return\r\n        const _editor = this;\r\n        tinymce.PluginManager.add('pinkfishtextcolor', function (editor, url) {\r\n            type ColorFormat = 'forecolor' | 'hilitecolor';\r\n\r\n            const fallbackColor = '#000000';\r\n            const _colors = ['000000', 'BLACK', '800000', 'RED', '008000', 'GREEN', '808000', 'ORANGE', '0000EE', 'BLUE', '800080', 'MAGENTA', '008080', 'CYAN', 'BBBBBB', 'WHITE', '808080', 'BOLD BLACK', 'FF0000', 'BOLD RED', '00FF00', 'BOLD GREEN', 'FFFF00', 'YELLOW', '5C5CFF', 'BOLD YELLOW', '5C5CFF', 'BOLD BLUE', 'FF00FF', 'BOLD MAGENTA', '00FFFF', 'BOLD CYAN', 'FFFFFF', 'BOLD WHITE'];\r\n\r\n            let _lastButton;\r\n\r\n            interface Cell<T> {\r\n                get: () => T;\r\n                set: (value: T) => void;\r\n            }\r\n\r\n            const Cell = <T>(initial: T): Cell<T> => {\r\n                let value = initial;\r\n\r\n                const get = () => {\r\n                    return value;\r\n                };\r\n\r\n                const set = (v: T) => {\r\n                    value = v;\r\n                };\r\n\r\n                return {\r\n                    get,\r\n                    set\r\n                };\r\n            };\r\n\r\n            let _forecolor = Cell(fallbackColor);\r\n            let _backcolor = Cell(fallbackColor);\r\n\r\n            const getCurrentColor = (editor, format: ColorFormat) => {\r\n                let color: string | undefined;\r\n\r\n                editor.dom.getParents(editor.selection.getStart(), (elm) => {\r\n                    let value;\r\n\r\n                    if ((value = elm.style[format === 'forecolor' ? 'color' : 'background-color'])) {\r\n                        color = color ? color : value;\r\n                    }\r\n                });\r\n\r\n                return color;\r\n            };\r\n\r\n            const applyFormat = (editor, format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.apply(format, { value });\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const removeFormat = (editor, format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const registerCommands = (editor) => {\r\n                editor.addCommand('mceApplyTextcolor', (format, value) => {\r\n                    applyFormat(editor, format, value);\r\n                });\r\n\r\n                editor.addCommand('mceRemoveTextcolor', (format) => {\r\n                    removeFormat(editor, format);\r\n                });\r\n\r\n                editor.addCommand('mceSetTextcolor', (name, color) => {\r\n                    if (_lastButton) {\r\n                        setIconColor(_lastButton, name === 'forecolor' ? 'pinkfishforecolor' : name, color);\r\n                        (name === 'forecolor' ? _forecolor : _backcolor).set(color);\r\n                    }\r\n                });\r\n            };\r\n\r\n            const getAdditionalColors = (hasCustom: boolean) => {\r\n                const type: 'choiceitem' = 'choiceitem';\r\n                const remove = {\r\n                    type,\r\n                    text: 'Remove color',\r\n                    icon: 'color-swatch-remove-color',\r\n                    value: 'remove'\r\n                };\r\n                const custom = {\r\n                    type,\r\n                    text: 'Custom color',\r\n                    icon: 'color-picker',\r\n                    value: 'custom'\r\n                };\r\n                return hasCustom ? [\r\n                    remove,\r\n                    custom\r\n                ] : [remove];\r\n            };\r\n\r\n            const applyColor = (editor, format, value, onChoice: (v: string) => void) => {\r\n                if (value === 'custom') {\r\n                    _editor.openColorDialog(format, '');\r\n                } else if (value === 'remove') {\r\n                    onChoice('');\r\n                    editor.execCommand('mceRemoveTextcolor', format);\r\n                } else {\r\n                    onChoice(value);\r\n                    editor.execCommand('mceApplyTextcolor', format, value);\r\n                }\r\n            };\r\n\r\n            const mapColors = (colorMap: string[]) => {\r\n                const colors = [];\r\n\r\n                for (let i = 0; i < colorMap.length; i += 2) {\r\n                    colors.push({\r\n                        text: colorMap[i + 1],\r\n                        value: '#' + colorMap[i],\r\n                        type: 'choiceitem'\r\n                    });\r\n                }\r\n\r\n                return colors;\r\n            }\r\n\r\n            const getColors = (colors, hasCustom: boolean) => mapColors(_colors).concat(getAdditionalColors(hasCustom));\r\n\r\n            const getFetch = (colors, hasCustom: boolean) => (callback) => {\r\n                callback(getColors(colors, hasCustom));\r\n            };\r\n\r\n            const setIconColor = (splitButtonApi, name: string, newColor: string) => {\r\n                const id = name === 'pinkfishforecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\r\n                splitButtonApi.setIconFill(id, newColor);\r\n            };\r\n\r\n            const registerTextColorButton = (editor, name: string, format: ColorFormat, tooltip: string, lastColor) => {\r\n                editor.ui.registry.addSplitButton(name, {\r\n                    tooltip,\r\n                    presets: 'color',\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    select: (value) => {\r\n                        const optCurrentRgb = new RGBColor(getCurrentColor(editor, format) || '').toHex();\r\n                        return optCurrentRgb.toLowerCase() === value.toLowerCase();\r\n                    },\r\n                    columns: 5,\r\n                    fetch: getFetch(_colors, true),\r\n                    onAction: (_splitButtonApi) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, lastColor.get(), () => { });\r\n                    },\r\n                    onItemAction: (_splitButtonApi, value) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, value, (newColor) => {\r\n                            lastColor.set(newColor);\r\n                            editor.fire('TextColorChange', {\r\n                                name,\r\n                                color: newColor\r\n                            });\r\n                        });\r\n                    },\r\n                    onSetup: (splitButtonApi) => {\r\n                        setIconColor(splitButtonApi, name, lastColor.get());\r\n\r\n                        const handler = (e) => {\r\n                            if (e.name === name) {\r\n                                setIconColor(splitButtonApi, e.name, e.color);\r\n                            }\r\n                        };\r\n\r\n                        editor.on('TextColorChange', handler);\r\n\r\n                        return () => {\r\n                            editor.off('TextColorChange', handler);\r\n                        };\r\n                    }\r\n                });\r\n            };\r\n\r\n            const registerTextColorMenuItem = (editor, name: string, format: ColorFormat, text: string) => {\r\n                editor.ui.registry.addNestedMenuItem(name, {\r\n                    text,\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    getSubmenuItems: () => [\r\n                        {\r\n                            type: 'fancymenuitem',\r\n                            fancytype: 'colorswatch',\r\n                            onAction: (data) => {\r\n                                applyColor(editor, format, data.value, () => { });\r\n                            }\r\n                        }\r\n                    ]\r\n                });\r\n            };\r\n\r\n            registerCommands(editor);\r\n            registerTextColorButton(editor, 'pinkfishforecolor', 'forecolor', 'Text color', _forecolor);\r\n            registerTextColorButton(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color', _backcolor);\r\n\r\n            registerTextColorMenuItem(editor, 'pinkfishforecolor', 'forecolor', 'Text color');\r\n            registerTextColorMenuItem(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color');\r\n        });\r\n        tinymce.PluginManager.add('pinkfish', function (editor) {\r\n\r\n            editor.addCommand('mceApplyFormat', (format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    if (value)\r\n                        editor.formatter.apply(format, { value: value });\r\n                    else\r\n                        editor.formatter.apply(format);\r\n                    _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            editor.addCommand('mceRemoveFormat', (format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            function buttonPostRender(buttonApi, format) {\r\n                editor.on('init', () => {\r\n                    editor.formatter.formatChanged(format, function (state) {\r\n                        buttonApi.setActive(state);\r\n                    });\r\n                });\r\n            }\r\n\r\n            function toggleFormat(format) {\r\n                if (!format || typeof format !== 'string') format = this.settings.format;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).removeClass('animate');\r\n                    this.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.execCommand('mceToggleFormat', false, format);\r\n                    this.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).addClass('animate');\r\n                });\r\n            }\r\n\r\n\r\n            editor.ui.registry.addIcon('overline', '<i class=\"mce-i-overline\"></i>');\r\n            editor.ui.registry.addIcon('dblunderline', '<i class=\"mce-i-dblunderline\"></i>');\r\n            editor.ui.registry.addIcon('flash', '<i class=\"mce-i-flash\"></i>');\r\n            editor.ui.registry.addIcon('reverse', '<i class=\"mce-i-reverse\"></i>');\r\n            editor.ui.registry.addIcon('pasteformatted', '<i class=\"mce-i-pasteformatted\"></i>');\r\n            editor.ui.registry.addIcon('copyformatted', '<i class=\"mce-i-copyformatted\"></i>');\r\n\r\n            editor.ui.registry.addSplitButton('send', {\r\n                icon: 'arrow-right',\r\n                tooltip: 'Send to mud',\r\n                onAction: () => {\r\n                    client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                    if (client.getOption('editorClearOnSend'))\r\n                        tinymce.activeEditor.setContent('');\r\n                    if (client.getOption('editorCloseOnSend'))\r\n                        _editor.emit('close');\r\n                },\r\n                onItemAction: (api, value) => {\r\n                    switch (value) {\r\n                        case 'formatted':\r\n                            client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'text':\r\n                            client.sendCommand(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'formattednoecho':\r\n                            client.sendBackground(_editor.getFormattedText().replace(/(?:\\r)/g, ''), true);\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'textnoecho':\r\n                            client.sendBackground(_editor.getText().replace(/(?:\\r)/g, ''), true);\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'formattedverbatim':\r\n                            client.send(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'textverbatim':\r\n                            client.send(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'rawformatted':\r\n                            client.sendRaw(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                        case 'rawtext':\r\n                            client.sendRaw(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            if (client.getOption('editorClearOnSend'))\r\n                                tinymce.activeEditor.setContent('');\r\n                            if (client.getOption('editorCloseOnSend'))\r\n                                _editor.emit('close');\r\n                            break;\r\n                    }\r\n                },\r\n                fetch: callback => {\r\n                    callback([\r\n                        {\r\n                            text: 'Formatted as commands',\r\n                            value: 'formatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands',\r\n                            value: 'text',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted as commands (No echo)',\r\n                            value: 'formattednoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands (No echo)',\r\n                            value: 'textnoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted verbatim (No echo)',\r\n                            value: 'formattedverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text verbatim (No echo)',\r\n                            value: 'textverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw formatted (No echo)',\r\n                            value: 'rawformatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw text (No echo)',\r\n                            value: 'rawtext',\r\n                            type: 'choiceitem'\r\n                        }\r\n                    ]);\r\n                }\r\n            });\r\n            editor.ui.registry.addButton('append', {\r\n                icon: 'browse',\r\n                tooltip: 'Append file...',\r\n                onAction: () => _editor.appendFile()\r\n            });\r\n            editor.ui.registry.addButton('clear', {\r\n                icon: 'remove',\r\n                tooltip: 'Clear',\r\n                onAction: () => _editor.clear()\r\n            });\r\n            editor.ui.registry.addButton('pasteformatted', {\r\n                icon: 'pasteformatted',\r\n                tooltip: 'Paste formatted',\r\n                onAction: buttonApi => {\r\n                    pasteText().then(text => {\r\n                        _editor.insertFormatted(text || '');\r\n                    }).catch(err => {\r\n                        if (client.enableDebug)\r\n                            client.debug(err);\r\n                        if (err.message && err.message === 'Permission not granted!')\r\n                            alert('Paste permission not granted.');\r\n                        else\r\n                            alert('Paste not supported.');\r\n                    });\r\n                }\r\n            });\r\n            editor.ui.registry.addButton('pasteastext', {\r\n                icon: 'paste-text',\r\n                tooltip: 'Paste as text',\r\n                onAction: buttonApi => {\r\n                    pasteText().then(text => {\r\n                        tinymce.activeEditor.execCommand('mceInsertContent', false, (text || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                    }).catch(err => {\r\n                        if (client.enableDebug)\r\n                            client.debug(err);\r\n                        if (err.message && err.message === 'Permission not granted!')\r\n                            alert('Paste permission not granted.');\r\n                        else\r\n                            alert('Paste not supported.');\r\n                    });\r\n                }\r\n            });\r\n\r\n            editor.ui.registry.addButton('copyformatted', {\r\n                icon: 'copyformatted',\r\n                tooltip: 'Copy formatted',\r\n                onAction: buttonApi => copyText(_editor.getFormattedSelection().replace(/(?:\\r)/g, ''))\r\n            });\r\n\r\n            editor.ui.registry.addToggleButton('overline', {\r\n                icon: 'overline',\r\n                tooltip: 'Overline',\r\n                format: 'overline',\r\n                onAction: buttonApi => toggleFormat('overline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'overline')\r\n            });\r\n            editor.ui.registry.addToggleButton('dblunderline', {\r\n                icon: 'dblunderline',\r\n                tooltip: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onAction: buttonApi => toggleFormat('dblunderline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'dblunderline')\r\n            });\r\n            editor.ui.registry.addToggleButton('flash', {\r\n                tooltip: 'Flash',\r\n                format: 'flash',\r\n                icon: 'flash',\r\n                onAction: buttonApi => toggleFormat('flash'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'flash')\r\n            });\r\n            editor.ui.registry.addToggleButton('reverse', {\r\n                icon: 'reverse',\r\n                tooltip: 'Reverse',\r\n                format: 'reverse',\r\n                onAction: buttonApi => toggleFormat('reverse'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'reverse')\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('style', {\r\n                text: 'Style',\r\n                menu: [\r\n                    {\r\n                        image: 'overline',\r\n                        text: 'Overline',\r\n                        format: 'overline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }, {\r\n                        image: 'dblunderline',\r\n                        text: 'Double Underline',\r\n                        format: 'dblunderline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        text: 'Flash',\r\n                        format: 'flash',\r\n                        image: 'flash',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        image: 'reverse',\r\n                        text: 'Reverse',\r\n                        format: 'reverse',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }\r\n                ]\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('overline', {\r\n                image: 'overline',\r\n                text: 'Overline',\r\n                format: 'overline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('dblunderline', {\r\n                image: 'dblunderline',\r\n                text: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('flash', {\r\n                text: 'Flash',\r\n                format: 'flash',\r\n                image: 'flash',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n            editor.ui.registry.addMenuItem('reverse', {\r\n                image: 'reverse',\r\n                text: 'Reverse',\r\n                format: 'reverse',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.on('Change', () => {\r\n                _editor.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n            });\r\n            editor.addShortcut('ctrl+s', 'Strikethrough', () => {\r\n                toggleFormat('strikethrough');\r\n            });\r\n            editor.addShortcut('ctrl+o', 'Overline', () => {\r\n                toggleFormat('overline');\r\n            });\r\n            editor.addShortcut('ctrl+d', 'Double Underline', () => {\r\n                toggleFormat('dblunderline');\r\n            });\r\n            editor.addShortcut('ctrl+f', 'Flash', () => {\r\n                toggleFormat('flash');\r\n            });\r\n            editor.addShortcut('ctrl+r', 'Reverse', () => {\r\n                toggleFormat('reverse');\r\n            });\r\n        });\r\n    }\r\n\r\n    private clearReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (!$(this).data('reverse'))\r\n                    return;\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                var back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    fore = $(this).parent().css('color');\r\n                    back = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'black')\r\n                    back = '';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                if ($(this).children().length)\r\n                    this.clearReverse($(this).children(), true);\r\n            }\r\n        );\r\n    }\r\n\r\n    private addReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                var back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    back = $(this).parent().css('color');\r\n                    fore = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'rgba(0, 0, 0, 0)')\r\n                    back = 'black';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                if ($(this).children().length) {\r\n                    this.clearReverse($(this).children(), true);\r\n                    this.addReverse($(this).children(), true);\r\n                }\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                $(this).data('reverse', true);\r\n\r\n            }\r\n        );\r\n    }\r\n\r\n    private colorCell(color, idx) {\r\n        var cell = '<td class=\"mce-grid-cell' + (color === 'transparent' ? ' mce-colorbtn-trans' : '') + '\">';\r\n        cell += '<div id=\"' + idx + '\"';\r\n        cell += ' data-mce-color=\"' + color + '\"';\r\n        cell += ' role=\"option\"';\r\n        cell += ' tabIndex=\"-1\"';\r\n        cell += ' style=\"background-color: ' + (color === 'transparent' ? color : '#' + color) + '\"';\r\n        if (this.colorNames[idx])\r\n            cell += ' title=\"' + idx + ', ' + this.colorNames[idx] + '\">';\r\n        else\r\n            cell += ' title=\"' + idx + '\">';\r\n        if (color === 'transparent') cell += '&#215;';\r\n        cell += '</div>';\r\n        cell += '</td>';\r\n        return cell;\r\n    }\r\n\r\n    private openColorDialog(type, color) {\r\n        if (!this._colorDialog) {\r\n            this._colorDialog = new Dialog({ noFooter: true, title: '<i class=\"fas fa-palette\"></i> Pick color', center: true, resizable: false, moveable: false, maximizable: false, width: 380, height: 340 });\r\n            this._colorDialog.body.style.alignItems = 'center';\r\n            this._colorDialog.body.style.display = 'flex';\r\n            let c;\r\n            let cl;\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let idx;\r\n            var html = '<table style=\"margin : auto !important;\" class=\"mce-grid mce-grid-border mce-colorbutton-grid\" role=\"list\" cellspacing=\"0\"><tbody><tr>';\r\n            for (c = 0, cl = this._ColorTable.length; c < cl; c += 2) {\r\n                html += this.colorCell(this._ColorTable[c], this._ColorTable[c + 1]);\r\n                if (c / 2 % 6 === 5)\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n            }\r\n            html += '<td class=\"mce-grid-cell\"></td>';\r\n            html += this.colorCell('transparent', 'No color');\r\n            html += '</tr><tr><td></td></tr>';\r\n            var html2 = '';\r\n            for (r = 0; r < 6; r++) {\r\n                if (g < 3)\r\n                    html += '<tr>';\r\n                else\r\n                    html2 += '<tr>';\r\n                for (g = 0; g < 6; g++) {\r\n                    for (b = 0; b < 6; b++) {\r\n                        idx = `RGB${r}${g}${b}`;\r\n                        color = '';\r\n                        c = 0;\r\n                        c = r * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = g * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = b * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        color = color.toUpperCase();\r\n                        if (g < 3)\r\n                            html += this.colorCell(color, idx);\r\n                        else\r\n                            html2 += this.colorCell(color, idx);\r\n                    }\r\n                    if (g === 2)\r\n                        html += '</tr>';\r\n                    else if (g < 3)\r\n                        html += '<td class=\"mce-grid-cell\"></td>';\r\n                    else if (g < 5)\r\n                        html2 += '<td class=\"mce-grid-cell\"></td>';\r\n                }\r\n                if (g < 3)\r\n                    html += '</tr>';\r\n                else\r\n                    html2 += '</tr>';\r\n            }\r\n            html += html2;\r\n            html += '<tr><td></td></tr><tr>';\r\n            for (r = 232; r <= 255; r++) {\r\n                g = (r - 232) * 10 + 8;\r\n                if (g < 16)\r\n                    g = '0' + g.toString(16).toUpperCase();\r\n                else\r\n                    g = g.toString(16).toUpperCase();\r\n                g = g + g + g;\r\n                html += this.colorCell(g, color);\r\n                if (r === 237 || r === 249)\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n                if (r === 243)\r\n                    html += '</tr><tr>';\r\n            }\r\n            html += '</tr></tbody></table>';\r\n            html += `<style>\r\n.mce-colorbtn-trans div {line-height: 14px;overflow: hidden;}\r\n.mce-grid td.mce-grid-cell div{border:1px solid #c5c5c5;width:15px;height:15px;margin:0;cursor:pointer}.mce-grid td.mce-grid-cell div:focus{border-color:#91bbe9}.mce-grid td.mce-grid-cell div[disabled]{cursor:not-allowed}            \r\n.mce-grid{border-spacing:2px;border-collapse:separate}.mce-grid a{display:block;border:1px solid transparent}.mce-grid a:hover,.mce-grid a:focus{border-color:#91bbe9}.mce-grid-border{margin:0 4px 0 4px}.mce-grid-border a{border-color:#c5c5c5;width:13px;height:13px}.mce-grid-border a:hover,.mce-grid-border a.mce-active{border-color:#91bbe9;background:#bdd6f2}            \r\n            </style>`;\r\n            this._colorDialog.body.innerHTML = html;\r\n            let cells = this._colorDialog.body.querySelectorAll('div');\r\n            for (c = 0, cl = cells.length; c < cl; c++)\r\n                cells[c].addEventListener('click', e => {\r\n                    color = (e.currentTarget as HTMLElement).dataset.mceColor;\r\n                    if (color === 'transparent')\r\n                        tinymce.activeEditor.execCommand('mceRemoveFormat', this._colorDialog.dialog.dataset.type);\r\n                    else\r\n                        tinymce.activeEditor.execCommand('mceApplyFormat', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    tinymce.activeEditor.execCommand('mceSetTextcolor', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    this._colorDialog.close();\r\n                });\r\n        }\r\n        this._colorDialog.dialog.dataset.type = type;\r\n        this._colorDialog.showModal();\r\n    }\r\n\r\n    private appendFile() {\r\n        openFileDialog('Append file(s)', true).then(files => {\r\n            for (var f = 0, fl = files.length; f < fl; f++)\r\n                readFile(files[f]).then((contents: any) => {\r\n                    this.insert(contents);\r\n                }).catch(client.error);\r\n        }).catch(() => { });\r\n    }\r\n\r\n    private insertFormatted(text) {\r\n        if (this.isSimple)\r\n            insertValue(this._element, text);\r\n        else\r\n            tinymce.activeEditor.execCommand('insertHTML', false, pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'));\r\n    }\r\n\r\n    public setFormatted(text) {\r\n        if (this.isSimple)\r\n            this._element.value = text;\r\n        else {\r\n            tinymce.activeEditor.setContent(pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'), { format: 'html' });\r\n        }\r\n    }\r\n\r\n    private buildHTMLStack(els) {\r\n        var tag, $el, t, tl;\r\n        var stack = [];\r\n        for (var e = 0, el = els.length; e < el; e++) {\r\n            $el = $(els[e]);\r\n            tag = $el.prop('tagName');\r\n            if (tag === 'EM' || tag === 'I')\r\n                tag = 'ITALIC';\r\n            else if (tag === 'STRONG' || tag === 'B')\r\n                tag = 'BOLD';\r\n            if (!tag)\r\n                stack.push('\"' + $el.text() + '\"');\r\n            else if (tag === 'SPAN') {\r\n                if (els[e].className != '') {\r\n                    tag = els[e].className.toUpperCase().split(/\\s+/g);\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t] === 'NOFLASH')\r\n                            stack.push('FLASH');\r\n                        else if (tag[t].length > 0)\r\n                            stack.push(tag[t]);\r\n                    }\r\n                    stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t] === 'NOFLASH')\r\n                            stack.push('FLASH');\r\n                        else if (tag[t].length > 0)\r\n                            stack.push('/' + tag[t]);\r\n                    }\r\n                    continue;\r\n                }\r\n                else if ($el.css('text-decoration') === 'line-through')\r\n                    tag = 'STRIKEOUT';\r\n                else if ($el.css('text-decoration') === 'underline')\r\n                    tag = 'UNDERLINE';\r\n                else if ($el.data('mce-style')) {\r\n                    tag = $el.data('mce-style').toUpperCase().split(';');\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].endsWith('INHERIT') || tag[t].endsWith('BLACK'))\r\n                            continue;\r\n                        tag[t] = tag[t].trim();\r\n                        tag[t] = tag[t].replace('BACKGROUND:', 'BACKGROUND-COLOR:');\r\n                        if (tag[t].length > 0)\r\n                            stack.push(tag[t]);\r\n                    }\r\n                    stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].endsWith('INHERIT') || tag[t].endsWith('BLACK'))\r\n                            continue;\r\n                        if (tag[t].length > 0)\r\n                            stack.push('/' + tag[t].trim());\r\n                    }\r\n                    continue;\r\n                }\r\n                else if ($el.css('color') || $el.css('background-color') || $el.css('background')) {\r\n                    tag = [];\r\n                    if ($el.css('color'))\r\n                        tag.push('COLOR: ' + new RGBColor($el.css('color')).toHex().toUpperCase());\r\n                    if ($el.css('background-color'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background-color')).toHex().toUpperCase());\r\n                    if ($el.css('background'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background')).toHex().toUpperCase());\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].length > 0)\r\n                            stack.push(tag[t].trim());\r\n                    }\r\n                    stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].length > 0)\r\n                            stack.push('/' + tag[t].trim());\r\n                    }\r\n                    continue;\r\n                }\r\n\r\n                stack.push(tag);\r\n                stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                stack.push('/' + tag);\r\n            }\r\n            else if (tag == 'BR' && $el.data('mce-bogus'))\r\n                stack.push('RESET');\r\n            else {\r\n                stack.push(tag);\r\n                stack = stack.concat(this.buildHTMLStack($el.contents()));\r\n                stack.push('/' + tag);\r\n            }\r\n        }\r\n        return stack;\r\n    }\r\n\r\n    public getFormattedSelection() {\r\n        //build all previous nodes to ensure all formatting is captures\r\n        var nodes = tinymce.activeEditor.dom.getParents(tinymce.activeEditor.selection.getNode());\r\n        var n = 0, nl = nodes.length;\r\n        var start = '<html>';\r\n        var end = '</html>';\r\n        for (; n < nl; n++) {\r\n            var tag = nodes[n].tagName;\r\n            if (tag === 'EM' || tag === 'I' || tag === 'STRONG' || tag === 'B') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'SPAN') {\r\n                start += '<' + tag;\r\n                if (nodes[n].className != '')\r\n                    start += ' class=\"' + nodes[n].className + '\"';\r\n                var style = '';\r\n                if (nodes[n].style.textDecoration != '')\r\n                    style += 'text-decoration:' + nodes[n].style.textDecoration + ';';\r\n                if (nodes[n].style.color != '')\r\n                    style += 'color:' + nodes[n].style.color + ';';\r\n                if (nodes[n].style.background != '')\r\n                    style += 'background:' + nodes[n].style.background + ';';\r\n                if (nodes[n].style.backgroundColor != '')\r\n                    style += 'background-color:' + nodes[n].style.backgroundColor + ';';\r\n                if (style.length > 0)\r\n                    start += ' style=\"' + style + '\"';\r\n                if (nodes[n].dataset && nodes[n].dataset.mceStyle)\r\n                    start += ' data-mce-style=\"' + nodes[n].dataset.mceStyle + '\"';\r\n                start += ' >';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'BODY') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n                break;\r\n            }\r\n        }\r\n        return this.formatHtml($(start + tinymce.activeEditor.selection.getContent({ format: 'raw' }).replace(/<\\/div><div>/g, '<br>') + end));\r\n    }\r\n\r\n    public getFormattedText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return this.formatHtml($('<html>' + this.getRaw().replace(/<\\/div><div>/g, '<br>') + '</html>'));\r\n    }\r\n\r\n    public getText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'text' });\r\n    }\r\n\r\n    // eslint-disable-next-line no-unused-vars\r\n    public getHTML() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'html' });\r\n    }\r\n\r\n    public getRaw() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'raw' });\r\n    }\r\n\r\n    private formatHtml(text) {\r\n        var data = this.buildHTMLStack(text);\r\n        var buffer = [];\r\n        var codes = [];\r\n        var color, d, dl, rgb;\r\n        if (DEBUG && client.getOption('enableDebug'))\r\n            client.debug('Advanced Editor Get Raw HTML: ' + this.getRaw());\r\n        for (d = data.length - 1; d >= 0; d--) {\r\n            if (!data[d].startsWith('\"') && data[d] != 'BR' && data[d] != 'RESET')\r\n                data.pop();\r\n            else\r\n                break;\r\n        }\r\n        if (data[0] === 'DIV')\r\n            data.shift();\r\n\r\n        for (d = 0, dl = data.length; d < dl; d++) {\r\n            switch (data[d]) {\r\n                case 'BOLD':\r\n                case 'ITALIC':\r\n                case 'UNDERLINE':\r\n                case 'STRIKEOUT':\r\n                case 'DBLUNDERLINE':\r\n                case 'OVERLINE':\r\n                case 'FLASH':\r\n                case 'REVERSE':\r\n                    codes.push('%^' + data[d] + '%^');\r\n                    buffer.push('%^' + data[d] + '%^');\r\n                    break;\r\n                case '/DBLUNDERLINE':\r\n                case '/OVERLINE':\r\n                case '/FLASH':\r\n                case '/REVERSE':\r\n                case '/UNDERLINE':\r\n                case '/BOLD':\r\n                case '/ITALIC':\r\n                case '/STRIKEOUT':\r\n                    codes.pop();\r\n                    this.cleanReset(buffer);\r\n                    buffer.push('%^RESET%^');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'SPAN':\r\n                case '/SPAN':\r\n                case '/BR':\r\n                case '/DIV':\r\n                    break;\r\n                case 'DIV':\r\n                case 'BR':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    buffer.push('\\n');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'RESET':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                default:\r\n                    if (data[d].startsWith('COLOR: #')) {\r\n                        color = data[d].substr(8);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this.nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n                    }\r\n                    else if (data[d].startsWith('COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(7)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this.nearestHex('#' + color).substr(1);\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n\r\n                    }\r\n                    else if (data[d].startsWith('/COLOR: ')) {\r\n                        codes.pop();\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: #')) {\r\n                        color = data[d].substr(19);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this.nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(18)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this.nearestHex('#' + color).substr(1);\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('/BACKGROUND-COLOR: ')) {\r\n                        codes.pop();\r\n                        this.cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('\"'))\r\n                        buffer.push(data[d].substring(1, data[d].length - 1));\r\n                    break;\r\n            }\r\n        }\r\n        return buffer.join('');\r\n    }\r\n\r\n    private cleanReset(buffer) {\r\n        let b = buffer.length - 1;\r\n        for (; b >= 0; b--) {\r\n            if (buffer[b].startsWith('%^'))\r\n                buffer.pop();\r\n            else\r\n                return buffer;\r\n        }\r\n        return buffer;\r\n    }\r\n\r\n    //{ color: 'red', hex: '#EA4235', rgb: { r: 234, g: 66, b: 53 } },\r\n    private colorList = [];\r\n\r\n    private nearestHex(hex) {\r\n        var _editor = this;\r\n        //https://codereview.stackexchange.com/questions/132225/given-hexadecimal-rgb-color-find-the-closest-predefined-color\r\n        var hexToRgb = function (hex) {\r\n            var shortRegEx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n            //hex = hex.replace(shortRegEx, \"$1$1$2$2$3$3\");\r\n            hex = hex.replace(shortRegEx, function (full, r, g, b) {\r\n                return [r, r, g, g, b, b].join();\r\n            });\r\n            var longRegEx = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})?/i;\r\n            var rgbArray = longRegEx.exec(hex);\r\n            var rgbObj = rgbArray ? {\r\n                r: parseInt(rgbArray[1], 16),\r\n                g: parseInt(rgbArray[2], 16),\r\n                b: parseInt(rgbArray[3], 16)\r\n            } : null;\r\n            return rgbObj;\r\n        };\r\n\r\n        var closestHexFromRgb = function (rgbObj) {\r\n            if (!rgbObj) {\r\n                throw new Error('The hex you provided is not formatted correctly. Please try in a format such as \\'#FFF\\' or \\'#DDFFDD\\'.');\r\n            }\r\n\r\n            var minDistance = Number.MAX_SAFE_INTEGER;\r\n            var nearestHex = null;\r\n\r\n            for (var i = 0; i < _editor.colorList.length; i++) {\r\n                var currentColor = _editor.colorList[i];\r\n                var distance = Math.sqrt(\r\n                    Math.pow((rgbObj.r - currentColor.rgb.r), 2) +\r\n                    Math.pow((rgbObj.g - currentColor.rgb.g), 2) +\r\n                    Math.pow((rgbObj.b - currentColor.rgb.b), 2)\r\n                );\r\n                if (distance < minDistance) {\r\n                    minDistance = distance;\r\n                    nearestHex = currentColor.hex;\r\n                }\r\n            }\r\n            return nearestHex;\r\n        };\r\n\r\n        return closestHexFromRgb(hexToRgb(hex));\r\n\r\n    }\r\n\r\n    public remove() {\r\n        tinymce.remove(`#${this._element.id}`);\r\n    }\r\n\r\n    public initialize() {\r\n        if (this.isSimple) return;\r\n        this.initPlugins();\r\n        tinymce.init({\r\n            license_key: 'gpl',\r\n            custom_colors: false,\r\n            selector: `textarea#${this._element.id}`,\r\n            height: 500,\r\n            menubar: false,\r\n            browser_spellcheck: true,\r\n            //contextmenu: false,\r\n            resize: true,\r\n            statusbar: false,\r\n            nowrap: true,\r\n            force_br_newlines: true,\r\n            forced_root_block: 'div',\r\n            plugins: 'pinkfish insertdatetime pinkfishtextcolor nonbreaking',\r\n            color_picker_callback: (editor, color, format) => { this.openColorDialog(format, color || ''); },\r\n            color_picker_caption: 'More&hellip;',\r\n            textcolor_rows: '3',\r\n            textcolor_cols: '8',\r\n            toolbar: 'send | append | undo redo | pinkfishforecolor pinkfishbackcolor | italic underline strikethrough overline dblunderline flash reverse | clear | copy copyformatted | insertdatetime',\r\n            toolbar_mode: 'sliding',\r\n            content_css: 'css/tinymce.content.min.css',\r\n            formats: {\r\n                bold: { inline: 'strong', exact: true, links: true, remove_similar: true },\r\n                italic: { inline: 'em', exact: true, links: true, remove_similar: true },\r\n                overline: { inline: 'span', 'classes': 'overline', links: true, remove_similar: true },\r\n                dblunderline: { inline: 'span', 'classes': 'dblunderline', links: true, remove_similar: true },\r\n                flash: { inline: 'span', 'classes': 'flash', links: true, remove_similar: true },\r\n                reverse: { inline: 'span', 'classes': 'reverse', links: true, remove_similar: true },\r\n                underline: { inline: 'span', 'classes': 'underline', links: true, remove_similar: true },\r\n                strikethrough: { inline: 'span', 'classes': 'strikeout', links: true, remove_similar: true },\r\n                forecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                hilitecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n                //forecolor: { block: 'span', attributes: { 'data-color': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                //hilitecolor: { block: 'span', attributes: { 'data-backcolor': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n            },\r\n            init_instance_callback: (editor) => {\r\n                editor.shortcuts.add('ctrl+shift+c', 'Copy formatted', () => copyText(this.getFormattedSelection().replace(/(?:\\r)/g, '')));\r\n                /*\r\n                editor.shortcuts.add('ctrl+shift+p', 'Paste formatted', () => {\r\n                    //insertFormatted(clipboard.readText('selection') || '');\r\n                });\r\n                editor.shortcuts.add('ctrl+alt+p', 'Paste as text', () => {\r\n                    //tinymce.activeEditor.execCommand('mceInsertContent', false, (clipboard.readText('selection') || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                });\r\n                */\r\n                editor.on('PastePreProcess', e => {\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced Before Editor PastePreProcess: ' + e.content);\r\n                    this.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    e.content = e.content.replace(/<\\/p>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/h[1-6]>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/li>/g, '<br>');\r\n                    var regex = /<pre(.*?)>((.|\\s)*)<\\/pre>/mgi;\r\n                    var m;\r\n                    while ((m = regex.exec(e.content)) !== null) {\r\n                        if (m.index === regex.lastIndex) {\r\n                            regex.lastIndex++;\r\n                        }\r\n                        e.content = e.content.substring(0, m.index) + e.content.substring(m.index, regex.lastIndex).replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;') + e.content.substring(regex.lastIndex);\r\n                    }\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced After Editor PastePreProcess: ' + e.content);\r\n                });\r\n                editor.on('PastePreProcess', () => {\r\n                    this.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                });\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-size', client.getOption('cmdfontSize'));\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-family', client.getOption('cmdfont') + ', monospace');\r\n                if (tinymce.activeEditor.formatter)\r\n                    tinymce.activeEditor.formatter.register('flash', { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true });\r\n                else\r\n                    tinymce.activeEditor.settings.formats['flash'] = { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true };\r\n                this.loadColors();\r\n                this.setFormatted(this.value);\r\n                this.emit('editor-init');\r\n            },\r\n            paste_data_images: false,\r\n            paste_webkit_styles: 'color background background-color text-decoration',\r\n            valid_elements: 'strong/b,em/i,u,span[style],span[class],strike/s,br',\r\n            valid_styles: {\r\n                '*': 'color,background,background-color,text-decoration,font-weight'\r\n            },\r\n            color_map: this._ColorTable,\r\n        });\r\n    }\r\n\r\n    public focus() {\r\n        if (this.isSimple)\r\n            this._element.focus();\r\n        else if (TINYMCE && tinymce.activeEditor)\r\n            tinymce.activeEditor.focus();\r\n    }\r\n}", "\r\nimport \"../css/interface.css\";\r\nimport { initMenu } from './menu';\r\nimport { Client } from '../client';\r\nimport { Dialog } from \"../dialog\";\r\nimport { openFileDialog, readFile, debounce } from '../library';\r\nimport { AdvEditor } from './adv.editor';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        initializeInterface;\r\n    }\r\n    let client: Client;\r\n}\r\n\r\n//cache the objects once made for later use\r\nlet editor: AdvEditor;\r\nlet editorDialog: Dialog;\r\n\r\nexport function initializeInterface() {\r\n    let options;\r\n    initMenu();\r\n    client.input.on('history-navigate', () => {\r\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\r\n            resizeCommandInput();\r\n    });\r\n    client.on('options-loaded', () => {\r\n        client.commandInput.removeEventListener('input', resizeCommandInput);\r\n        client.commandInput.removeEventListener('change', resizeCommandInput);\r\n        initCommandInput();\r\n        updateCommandInput();\r\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\r\n            resizeCommandInput();\r\n    });\r\n    //setup advanced editor footer button\r\n    document.getElementById('btn-adv-edit').addEventListener('click', e => {\r\n        if (!editorDialog) {\r\n            editorDialog = new Dialog(Object.assign({}, client.getOption('windows.editor') || { center: true }, { title: '<i class=\"fas fa-edit\"></i> Advanced editor', id: 'adv-editor' }));\r\n            editorDialog.on('resized', e => {\r\n                client.setOption('windows.editor', e);\r\n            });\r\n            editorDialog.on('moved', e => {\r\n                client.setOption('windows.editor', e);\r\n            })\r\n            editorDialog.on('maximized', () => {\r\n                client.setOption('windows.editor', editorDialog.windowState);\r\n            });\r\n            editorDialog.on('restored', () => {\r\n                client.setOption('windows.editor', editorDialog.windowState);\r\n            });\r\n            editorDialog.on('shown', () => {\r\n                client.setOption('windows.editor', editorDialog.windowState);\r\n                editor.initialize();\r\n            });\r\n            editorDialog.on('closing', () => {\r\n                editor.remove();\r\n            });\r\n            editorDialog.on('closed', () => {\r\n                client.setOption('windows.editor', editorDialog.windowState);\r\n            });\r\n            editorDialog.on('canceling', () => {\r\n                editor.remove();\r\n            });\r\n            editorDialog.on('canceled', () => {\r\n                client.setOption('windows.editor', editorDialog.windowState);\r\n            });\r\n            const textarea = document.createElement('textarea');\r\n            textarea.classList.add('form-control', 'form-control-sm');\r\n            textarea.id = 'txt-adv-editor';\r\n            editorDialog.body.appendChild(textarea);\r\n            editorDialog.body.style.overflow = 'hidden';\r\n            if (!editor) editor = new AdvEditor(textarea, !client.getOption('simpleEditor'));\r\n            editor.on('close', () => {\r\n                editorDialog.close();\r\n            });\r\n            editor.on('editor-init', () => editor.focus());\r\n            editorDialog.dialog.editor = editor;\r\n            if (TINYMCE && tinymce)\r\n                editorDialog.header.querySelector('#adv-editor-max').insertAdjacentHTML('afterend', '<button type=\"button\" class=\"btn btn-light float-end\" id=\"adv-editor-switch\" title=\"Switch to advanced\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-shuffle\"></i></button>');\r\n            editorDialog.footer.innerHTML = `<button id=\"btn-adv-edit-clear\" type=\"button\" class=\"float-start btn btn-light\" title=\"Clear editor\">Clear</button>\r\n                <button id=\"btn-adv-edit-append\" type=\"button\" class=\"float-start btn btn-light\" title=\"Append file...\">Append file...</button>\r\n                <button id=\"btn-adv-edit-send\" type=\"button\" class=\"float-end btn btn-primary\" title=\"Send\">Send</button>`;\r\n            if (!editor.isSimple)\r\n                editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\r\n            editorDialog.header.querySelector('#adv-editor-switch').addEventListener('click', () => {\r\n                client.setOption('simpleEditor', !editor.simple);\r\n                let value = '';\r\n                if (!editor.isSimple)\r\n                    value = editor.getFormattedText().replace(/(?:\\r)/g, '');\r\n                //else\r\n                //value = editor.value;\r\n                editor.simple = !editor.simple;\r\n                if (!editor.isSimple) {\r\n                    editorDialog.hideFooter();\r\n                    editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\r\n                }\r\n                else {\r\n                    editor.value = value;\r\n                    editorDialog.showFooter();\r\n                    editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to advanced';\r\n                    setTimeout(() => editor.focus(), 100);\r\n                }\r\n                //editor.setFormatted(value);\r\n            });\r\n            document.getElementById('btn-adv-edit-append').addEventListener('click', () => {\r\n                openFileDialog('Append file', false).then(files => {\r\n                    readFile(files[0]).then((contents: any) => {\r\n                        editor.insert(contents);\r\n                    }).catch(client.error);\r\n                }).catch(() => { });\r\n            });\r\n            document.getElementById('btn-adv-edit-send').addEventListener('click', () => {\r\n                client.sendCommand(editor.value());\r\n                if (client.getOption('editorClearOnSend'))\r\n                    editor.clear();\r\n                if (client.getOption('editorCloseOnSend'))\r\n                    editorDialog.close();\r\n            });\r\n            document.getElementById('btn-adv-edit-clear').addEventListener('click', () => {\r\n                editor.clear();\r\n                editor.focus();\r\n            });\r\n            if (!editor.isSimple)\r\n                editorDialog.hideFooter();\r\n        }\r\n        editorDialog.show();\r\n        editor.focus();\r\n    });\r\n    //restore advanced editor\r\n    options = client.getOption('windows.editor');\r\n    if (options && options.show)\r\n        document.getElementById('btn-adv-edit').click();\r\n\r\n    document.getElementById('btn-command-history').addEventListener('show.bs.dropdown', function () {\r\n        document.body.appendChild(document.getElementById('command-history-menu'));\r\n    });\r\n    document.getElementById('btn-command-history').addEventListener('hidden.bs.dropdown', function () {\r\n        document.getElementById('btn-command-history').parentElement.appendChild(document.getElementById('command-history-menu'));\r\n    });\r\n    client.commandInput.removeEventListener('input', resizeCommandInput);\r\n    client.commandInput.removeEventListener('change', resizeCommandInput);\r\n    initCommandInput();\r\n    updateCommandInput();\r\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\r\n        resizeCommandInput();\r\n}\r\n\r\nfunction resizeCommandInput() {\r\n    debounce(() => {\r\n        _resizeCommandInput();\r\n    }, 250, 'resizeCommand');\r\n}\r\n\r\nasync function initCommandInput() {\r\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars')) {\r\n        client.commandInput.addEventListener('input', resizeCommandInput);\r\n        client.commandInput.addEventListener('change', resizeCommandInput);\r\n    }\r\n    if (client.getOption('commandWordWrap')) {\r\n        document.getElementById('commandMeasure').style.whiteSpace = 'pre-wrap';\r\n        document.getElementById('commandMeasure').style.overflowWrap = 'anywhere';\r\n    }\r\n    else {\r\n        document.getElementById('commandMeasure').style.whiteSpace = '';\r\n        document.getElementById('commandMeasure').style.overflowWrap = '';\r\n    }\r\n    if (client.getOption('commandScrollbars')) {\r\n        document.getElementById('commandMeasure').style.overflow = 'auto';\r\n        client.commandInput.style.overflow = 'auto';\r\n    }\r\n    else {\r\n        document.getElementById('commandMeasure').style.overflow = '';\r\n        client.commandInput.style.overflow = '';\r\n    }\r\n}\r\n\r\nlet commandInputResize: any = {};\r\nfunction updateCommandInput() {\r\n    const measure = document.getElementById('commandMeasure');\r\n    document.body.appendChild(measure);\r\n    const cmd = client.commandInput.parentElement;\r\n    const cmdSize = window.getComputedStyle(cmd);\r\n    measure.style.fontSize = client.commandInput.style.fontSize;\r\n    measure.style.fontFamily = client.commandInput.style.fontFamily;\r\n    measure.style.width = client.commandInput.offsetWidth + 'px';\r\n    const oldMeasure = measure.innerHTML;\r\n    measure.innerHTML = 'W';\r\n    let minHeight = client.getOption('commandMinLines');\r\n    const height = measure.offsetHeight;\r\n    minHeight = height * (minHeight < 1 ? 1 : minHeight);\r\n    let padding = parseFloat(cmdSize.borderTopWidth) || 0;\r\n    padding += parseFloat(cmdSize.borderBottomWidth) || 0;\r\n    padding += parseFloat(cmdSize.paddingTop) || 0;\r\n    padding += parseFloat(cmdSize.paddingBottom) || 0;\r\n    let inset = cmdSize.inset.split(' ');\r\n    padding += (parseFloat(inset[0]) || 0) * 2;\r\n    measure.innerHTML = oldMeasure;\r\n    cmd.style.height = (height + padding) + 'px';\r\n    /*\r\n    TODO need to rethink this logic and in _resizeCommandInput, as the current interface has 3 layers the nav group, then input group, then the input itself\r\n    may need to walk the chain up til body or until it finds shared container with display and resize each one based on positions/paddings/margins\r\n    */\r\n    client.commandInput.parentElement.style.height = height + 'px';\r\n    client.commandInput.closest('nav').style.height = height + 6 + 'px';\r\n    client.display.container.style.bottom = (height + padding) + 'px';\r\n\r\n    commandInputResize = {\r\n        measure: measure,\r\n        cmd: cmd,\r\n        cmdSize: cmdSize,\r\n        height: height,\r\n        padding: padding,\r\n        minHeight: minHeight\r\n    }\r\n}\r\n\r\nfunction _resizeCommandInput() {\r\n    const measure = commandInputResize.measure;\r\n    const cmd = commandInputResize.cmd;\r\n    measure.innerHTML = client.commandInput.value + '\\n';\r\n    let height = measure.offsetHeight;\r\n    if (height < commandInputResize.minHeight)\r\n        height = commandInputResize.minHeight;\r\n    const padding = commandInputResize.padding;\r\n    cmd.style.height = (height + padding) + 'px';\r\n    client.commandInput.parentElement.style.height = height + 'px';\r\n    client.commandInput.closest('nav').style.height = height + 6 + 'px';\r\n    client.display.container.style.bottom = (height + padding) + 'px';\r\n}\r\nwindow.initializeInterface = initializeInterface;"],
  "mappings": "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R,QAAW,SACX,MAAS,SACT,KAAQ,OACR,aAAc,OACd,WAAY,MACZ,aAAc,OACd,OAAU,SACV,cAAe,SACf,YAAa,OACb,eAAgB,UAChB,YAAa,OACb,KAAQ,QACR,aAAc,QACd,OAAU,QACV,OAAU,YACV,OAAU,YACV,OAAU,OACV,OAAU,OACV,OAAU,OACV,OAAU,aACV,OAAU,gBACV,OAAU,gBACV,OAAU,gBACV,OAAU,qBACV,OAAU,cACV,OAAU,QACV,OAAU,eACV,OAAU,YACV,OAAU,gBACV,OAAU,gBACV,OAAU,cACV,OAAU,QACV,OAAU,eACV,OAAU,YACV,OAAU,kBACV,OAAU,gBACV,OAAU,gBACV,OAAU,QACV,OAAU,eACV,OAAU,eACV,OAAU,OACV,OAAU,iBACV,OAAU,YACV,OAAU,QACV,OAAU,eACV,OAAU,eACV,OAAU,sBACV,OAAU,OACV,OAAU,OACV,OAAU,WACV,OAAU,YACV,OAAU,SACV,OAAU,SACV,OAAU,SACV,OAAU,cACV,OAAU,SACV,OAAU,YACV,OAAU,gBACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,iBACV,OAAU,iBACV,OAAU,aACV,OAAU,aACV,OAAU,kBACV,OAAU,aACV,OAAU,iBACV,OAAU,aACV,OAAU,aACV,OAAU,WACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,YACV,OAAU,aACV,OAAU,mBACV,OAAU,aACV,OAAU,aACV,OAAU,YACV,OAAU,YACV,OAAU,YACV,OAAU,aACV,OAAU,kBACV,OAAU,WACV,OAAU,YACV,OAAU,eACV,OAAU,eACV,OAAU,cACV,OAAU,SACV,OAAU,SACV,OAAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,aACV,OAAU,SACV,OAAU,QACV,OAAU,OACV,OAAU,mBACV,OAAU,gBACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,iBACV,OAAU,iBACV,OAAU,iBACV,OAAU,WACV,OAAU,aACV,OAAU,mBACV,OAAU,aACV,OAAU,iBACV,OAAU,kBACV,OAAU,WACV,OAAU,aACV,OAAU,cACV,OAAU,cACV,OAAU,aACV,OAAU,aACV,OAAU,kBACV,OAAU,MACV,OAAU,YACV,OAAU,oBACV,OAAU,UACV,OAAU,cACV,OAAU,SACV,OAAU,cACV,OAAU,aACV,OAAU,WACV,OAAU,gBACV,OAAU,gBACV,OAAU,gBACV,OAAU,iBACV,OAAU,eACV,OAAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,OACV,OAAU,aACV,OAAU,eACV,OAAU,OACV,OAAU,mBACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,iBACV,OAAU,iBACV,OAAU,aACV,OAAU,iBACV,OAAU,eACV,OAAU,mBACV,OAAU,aACV,OAAU,iBACV,OAAU,iBACV,OAAU,iBACV,OAAU,cACV,OAAU,YACV,OAAU,YACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,cACV,OAAU,aACV,OAAU,WACV,OAAU,WACV,OAAU,SACV,OAAU,gBACV,OAAU,SACV,OAAU,sBACV,OAAU,aACV,OAAU,OACV,OAAU,OACV,OAAU,SACV,OAAU,OACV,OAAU,kBACV,OAAU,MACV,OAAU,aACV,OAAU,UACV,OAAU,OACV,OAAU,SACV,OAAU,QACV,OAAU,kBACV,OAAU,eACV,OAAU,OACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,mBACV,OAAU,iBACV,OAAU,WACV,OAAU,aACV,OAAU,MACV,OAAU,YACV,OAAU,YACV,OAAU,YACV,OAAU,UACV,OAAU,UACV,OAAU,YACV,OAAU,aACV,OAAU,aACV,OAAU,WACV,OAAU,WACV,OAAU,gBACV,OAAU,cACV,OAAU,SACV,OAAU,cACV,OAAU,kBACV,OAAU,SACV,OAAU,SACV,OAAU,SACV,OAAU,cACV,OAAU,eACV,OAAU,aACV,OAAU,OACV,OAAU,OACV,OAAU,OACV,OAAU,kBACV,OAAU,kBACV,OAAU,eACV,OAAU,aACV,OAAU,UACV,OAAU,SACV,OAAU,kBACV,OAAU,QACV,OAAU,QACV,OAAU,YACV,OAAU,QACV,OAAU,SACV,OAAU,SACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,UACV,OAAU,SACd,EAmvCA,KAAQ,UAAY,CAAC,EA7uCb,IAACD,EACD,MAAM,IAAI,MAAM,wDAAwD,EAC5E,GAAI,OAAOA,GAAY,UAEnB,GADA,KAAK,SAAW,SAAS,cAAcA,CAAO,EAC1C,CAAC,KAAK,SACN,MAAM,IAAI,MAAM,iCAAiC,UAEhDA,aAAmB,EACxB,KAAK,SAAWA,EAAQ,CAAC,UACpBA,aAAmB,YACxB,KAAK,SAAWA,MAEhB,OAAM,IAAI,MAAM,wDAAwD,EAC5E,KAAK,OAAS,CAACC,CACnB,CAEA,IAAI,IAAK,CACL,OAAI,KAAK,SAAiB,KAAK,SAAS,GACjC,EACX,CAEA,IAAI,SAAuB,CACvB,OAAO,KAAK,QAChB,CAEA,IAAI,QAAS,CAAE,OAAO,KAAK,OAAS,CACpC,IAAI,OAAOC,EAAO,CACVA,IAAU,KAAK,UACnB,KAAK,QAAUA,EACC,KAAK,eAEjBA,EACA,KAAK,OAAO,EAEZ,KAAK,WAAW,GACxB,CACO,OAAQ,CACK,KAAK,SAGjB,KAAK,SAAS,MAAQ,GAFtB,QAAQ,aAAa,WAAW,EAAE,CAG1C,CACA,IAAW,OAAQ,CACf,OAAK,KAAK,SAEH,KAAK,SAAS,MADV,KAAK,iBAAiB,EAAE,QAAQ,UAAW,EAAE,CAE5D,CACA,IAAW,MAAMA,EAAO,CAChB,KAAK,SACL,KAAK,SAAS,MAAQA,EAEtB,QAAQ,aAAa,WAAWA,CAAK,CAC7C,CAEO,OAAOA,EAAO,CACjB,GAAK,KAAK,SAqBNC,EAAY,KAAK,SAAUD,CAAK,MArBhB,CAChBA,EAAQE,EAAWF,CAAK,EACxBA,EAAQA,EAAM,QAAQ,KAAM,QAAQ,EACpCA,EAAQA,EAAM,QAAQ,MAAO,oBAAoB,EACjDA,EAAQA,EAAM,QAAQ,kBAAmB,OAAO,EAChD,IAAIG,EAAU,KAAK,QAAQ,EACvBA,IAAY;AAAA,EACZ,QAAQ,aAAa,YAAY,SAAS,IAAM,CAC5C,QAAQ,aAAa,WAAWH,CAAK,CACzC,CAAC,GAGIG,EAAQ,SAAS;AAAA,CAAI,IACtBH,EAAQ,OAASA,GACrB,QAAQ,aAAa,YAAY,SAAS,IAAM,CAC5C,QAAQ,aAAa,IAAI,IAAI,QAAQ,aAAa,QAAQ,EAAG,OAAQ,CAAC,EAAGA,CAAK,CAClF,CAAC,EAGT,CAKJ,CAEA,IAAI,cAAe,CACf,OAAkB,OAAQ,QAAa,GAC3C,CAEA,IAAI,UAAoB,CACpB,OAAO,KAAK,SAAW,CAAC,KAAK,YACjC,CAEQ,YAAa,CACjB,IAAII,EAAWC,EAAU,EACrBC,EAAGC,EAAOC,EAAGC,EAAGC,EAAGC,EAAKC,EAAQ,CAAC,EAAGC,EACxC,KAAK,YAAc,CAAC,EACpB,KAAK,QAAU,CAAC,EAChB,IAAIC,EAAe,OAAO,UAAU,QAAQ,GAAK,CAAC,EAmElD,IAlEAP,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,QACtB,KAAK,YAAY,KAAKA,EAAO,OAAO,EAEpCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,MACtB,KAAK,YAAY,KAAKA,EAAO,KAAK,EAElCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,QACtB,KAAK,YAAY,KAAKA,EAAO,OAAO,EAEpCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,SACtB,KAAK,YAAY,KAAKA,EAAO,QAAQ,EAErCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,OACtB,KAAK,YAAY,KAAKA,EAAO,MAAM,EACnCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,UACtB,KAAK,YAAY,KAAKA,EAAO,SAAS,EACtCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,OACtB,KAAK,YAAY,KAAKA,EAAO,MAAM,EACnCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,QACtB,KAAK,YAAY,KAAKA,EAAO,OAAO,EAEpCA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,SACtB,KAAK,YAAY,KAAKA,EAAO,YAAY,EACzCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,CAAC,GAAKV,EAAS,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACnF,KAAK,QAAQG,CAAK,EAAI,cACtB,KAAK,YAAY,KAAKA,EAAO,UAAU,EACvCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,gBACtB,KAAK,YAAY,KAAKA,EAAO,YAAY,EACzCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,iBACtB,KAAK,YAAY,KAAKA,EAAO,aAAa,EAC1CK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,SACtB,KAAK,YAAY,KAAKA,EAAO,QAAQ,EACrCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,eACtB,KAAK,YAAY,KAAKA,EAAO,WAAW,EACxCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,kBACtB,KAAK,YAAY,KAAKA,EAAO,cAAc,EAC3CK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,eACtB,KAAK,YAAY,KAAKA,EAAO,WAAW,EACxCK,EAAM,KAAKL,CAAK,EAChBA,EAAQ,IAAIQ,EAASD,EAAa,EAAE,GAAKV,EAAS,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,YAAY,EACrF,KAAK,QAAQG,CAAK,EAAI,gBACtB,KAAK,YAAY,KAAKA,EAAO,YAAY,EAGpCC,EAAI,EAAGA,EAAI,EAAGA,IACf,IAAKC,EAAI,EAAGA,EAAI,EAAGA,IACf,IAAKC,EAAI,EAAGA,EAAI,EAAGA,IACfC,EAAM,MAAMH,CAAC,GAAGC,CAAC,GAAGC,CAAC,GACrBH,EAAQ,GACRD,EAAI,EACJA,EAAIE,EAAI,GAAK,GACTF,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBA,EAAI,EACJA,EAAIG,EAAI,GAAK,GACTH,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBA,EAAI,EACJA,EAAII,EAAI,GAAK,GACTJ,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBC,EAAQA,EAAM,YAAY,EAGrB,KAAK,QAAQA,CAAK,IACnB,KAAK,QAAQA,CAAK,EAAII,GAC1B,KAAK,UAAU,KAAK,CAAE,MAAOA,EAAK,IAAK,IAAMJ,EAAO,IAAK,CAAE,EAAGC,EAAI,GAAK,GAAI,EAAGC,EAAI,GAAK,GAAI,EAAGC,EAAI,GAAK,EAAG,CAAE,CAAC,EAKzH,IAAKF,EAAI,IAAKA,GAAK,IAAKA,IACpBC,GAAKD,EAAI,KAAO,GAAK,EACjBC,EAAI,GACJA,EAAI,IAAMA,EAAE,SAAS,EAAE,EAAE,YAAY,EAErCA,EAAIA,EAAE,SAAS,EAAE,EAAE,YAAY,EACnCA,EAAIA,EAAIA,EAAIA,EAERD,EAAI,IAEC,KAAK,QAAQC,CAAC,IACf,KAAK,QAAQA,CAAC,EAAI,SAAWD,EAAI,MAIhC,KAAK,QAAQC,CAAC,IACf,KAAK,QAAQA,CAAC,EAAI,QAAUD,EAAI,MAI5C,IAAKE,EAAI,EAAGG,EAAKD,EAAM,OAAQF,EAAIG,EAAIH,IACnC,KAAK,QAAQ,IAAME,EAAMF,CAAC,CAAC,EAAI,KAAK,QAAQ,KAAK,WAAW,IAAME,EAAMF,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,YAAY,EAEvG,KAAK,QAAQ,QAAa,SAC1B,QAAQ,aAAa,QAAQ,IAAI,YAAa,KAAK,WAAW,CAClE,CAEQ,aAAc,CAElB,IAAMM,EAAU,KAChB,QAAQ,cAAc,IAAI,oBAAqB,SAAUC,EAAQC,EAAK,CAGlE,IAAMC,EAAgB,UAChBC,EAAU,CAAC,SAAU,QAAS,SAAU,MAAO,SAAU,QAAS,SAAU,SAAU,SAAU,OAAQ,SAAU,UAAW,SAAU,OAAQ,SAAU,QAAS,SAAU,aAAc,SAAU,WAAY,SAAU,aAAc,SAAU,SAAU,SAAU,cAAe,SAAU,YAAa,SAAU,eAAgB,SAAU,YAAa,SAAU,YAAY,EAErXC,EAOEC,EAAWC,GAAwB,CACrC,IAAIvB,EAAQuB,EAUZ,MAAO,CACH,IATQ,IACDvB,EASP,IANSwB,GAAS,CAClBxB,EAAQwB,CACZ,CAKA,CACJ,EAEIC,EAAaH,EAAKH,CAAa,EAC/BO,EAAaJ,EAAKH,CAAa,EAE7BQ,EAAkB,CAACV,EAAQW,IAAwB,CACrD,IAAIrB,EAEJ,OAAAU,EAAO,IAAI,WAAWA,EAAO,UAAU,SAAS,EAAIY,GAAQ,CACxD,IAAI7B,GAECA,EAAQ6B,EAAI,MAAMD,IAAW,YAAc,QAAU,kBAAkB,KACxErB,EAAQA,GAAgBP,EAEhC,CAAC,EAEMO,CACX,EAEMuB,EAAc,CAACb,EAAQW,EAAQ5B,IAAU,CAC3CiB,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,MAAM,EACbA,EAAO,UAAU,MAAMW,EAAQ,CAAE,MAAA5B,CAAM,CAAC,EACxCiB,EAAO,YAAY,CACvB,CAAC,CACL,EAEMc,EAAe,CAACd,EAAQW,IAAW,CACrCX,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,MAAM,EACbA,EAAO,UAAU,OAAOW,EAAQ,CAAE,MAAO,IAAK,EAAG,KAAM,EAAI,EAC3DX,EAAO,YAAY,CACvB,CAAC,CACL,EAEMe,EAAoBf,GAAW,CACjCA,EAAO,WAAW,oBAAqB,CAACW,EAAQ5B,IAAU,CACtD8B,EAAYb,EAAQW,EAAQ5B,CAAK,CACrC,CAAC,EAEDiB,EAAO,WAAW,qBAAuBW,GAAW,CAChDG,EAAad,EAAQW,CAAM,CAC/B,CAAC,EAEDX,EAAO,WAAW,kBAAmB,CAACgB,EAAM1B,IAAU,CAC9Cc,IACAa,EAAab,EAAaY,IAAS,YAAc,oBAAsBA,EAAM1B,CAAK,GACjF0B,IAAS,YAAcR,EAAaC,GAAY,IAAInB,CAAK,EAElE,CAAC,CACL,EAEM4B,GAAuBC,GAAuB,CAChD,IAAMC,EAAqB,aACrBC,EAAS,CACX,KAAAD,EACA,KAAM,eACN,KAAM,4BACN,MAAO,QACX,EAOA,OAAOD,EAAY,CACfE,EAPW,CACX,KAAAD,EACA,KAAM,eACN,KAAM,eACN,MAAO,QACX,CAIA,EAAI,CAACC,CAAM,CACf,EAEMC,EAAa,CAACtB,EAAQW,EAAQ5B,EAAOwC,IAAkC,CACrExC,IAAU,SACVgB,EAAQ,gBAAgBY,EAAQ,EAAE,EAC3B5B,IAAU,UACjBwC,EAAS,EAAE,EACXvB,EAAO,YAAY,qBAAsBW,CAAM,IAE/CY,EAASxC,CAAK,EACdiB,EAAO,YAAY,oBAAqBW,EAAQ5B,CAAK,EAE7D,EAEMyC,GAAaC,GAAuB,CACtC,IAAMC,EAAS,CAAC,EAEhB,QAASC,EAAI,EAAGA,EAAIF,EAAS,OAAQE,GAAK,EACtCD,EAAO,KAAK,CACR,KAAMD,EAASE,EAAI,CAAC,EACpB,MAAO,IAAMF,EAASE,CAAC,EACvB,KAAM,YACV,CAAC,EAGL,OAAOD,CACX,EAEMtC,GAAY,CAACsC,EAAQP,IAAuBK,GAAUrB,CAAO,EAAE,OAAOe,GAAoBC,CAAS,CAAC,EAEpGS,GAAW,CAACF,EAAQP,IAAwBU,GAAa,CAC3DA,EAASzC,GAAUsC,EAAQP,CAAS,CAAC,CACzC,EAEMF,EAAe,CAACa,EAAgBd,EAAce,IAAqB,CACrE,IAAMC,EAAKhB,IAAS,oBAAsB,6BAA+B,qCACzEc,EAAe,YAAYE,EAAID,CAAQ,CAC3C,EAEME,EAA0B,CAACjC,EAAQgB,EAAcL,EAAqBuB,EAAiBC,IAAc,CACvGnC,EAAO,GAAG,SAAS,eAAegB,EAAM,CACpC,QAAAkB,EACA,QAAS,QACT,KAAMlB,IAAS,oBAAsB,aAAe,qBACpD,OAASjC,GACiB,IAAIe,EAASY,EAAgBV,EAAQW,CAAM,GAAK,EAAE,EAAE,MAAM,EAC3D,YAAY,IAAM5B,EAAM,YAAY,EAE7D,QAAS,EACT,MAAO6C,GAASzB,EAAS,EAAI,EAC7B,SAAWiC,GAAoB,CAC3BhC,EAAcgC,EACdd,EAAWtB,EAAQW,EAAQwB,EAAU,IAAI,EAAG,IAAM,CAAE,CAAC,CACzD,EACA,aAAc,CAACC,EAAiBrD,IAAU,CACtCqB,EAAcgC,EACdd,EAAWtB,EAAQW,EAAQ5B,EAAQgD,GAAa,CAC5CI,EAAU,IAAIJ,CAAQ,EACtB/B,EAAO,KAAK,kBAAmB,CAC3B,KAAAgB,EACA,MAAOe,CACX,CAAC,CACL,CAAC,CACL,EACA,QAAUD,GAAmB,CACzBb,EAAaa,EAAgBd,EAAMmB,EAAU,IAAI,CAAC,EAElD,IAAME,EAAWC,GAAM,CACfA,EAAE,OAAStB,GACXC,EAAaa,EAAgBQ,EAAE,KAAMA,EAAE,KAAK,CAEpD,EAEA,OAAAtC,EAAO,GAAG,kBAAmBqC,CAAO,EAE7B,IAAM,CACTrC,EAAO,IAAI,kBAAmBqC,CAAO,CACzC,CACJ,CACJ,CAAC,CACL,EAEME,EAA4B,CAACvC,EAAQgB,EAAcL,EAAqB6B,IAAiB,CAC3FxC,EAAO,GAAG,SAAS,kBAAkBgB,EAAM,CACvC,KAAAwB,EACA,KAAMxB,IAAS,oBAAsB,aAAe,qBACpD,gBAAiB,IAAM,CACnB,CACI,KAAM,gBACN,UAAW,cACX,SAAWyB,GAAS,CAChBnB,EAAWtB,EAAQW,EAAQ8B,EAAK,MAAO,IAAM,CAAE,CAAC,CACpD,CACJ,CACJ,CACJ,CAAC,CACL,EAEA1B,EAAiBf,CAAM,EACvBiC,EAAwBjC,EAAQ,oBAAqB,YAAa,aAAcQ,CAAU,EAC1FyB,EAAwBjC,EAAQ,oBAAqB,cAAe,mBAAoBS,CAAU,EAElG8B,EAA0BvC,EAAQ,oBAAqB,YAAa,YAAY,EAChFuC,EAA0BvC,EAAQ,oBAAqB,cAAe,kBAAkB,CAC5F,CAAC,EACD,QAAQ,cAAc,IAAI,WAAY,SAAUA,EAAQ,CAEpDA,EAAO,WAAW,iBAAkB,CAACW,EAAQ5B,IAAU,CACnDiB,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,MAAM,EACbD,EAAQ,aAAa,EAAE,WAAY,EAAEC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC7DjB,EACAiB,EAAO,UAAU,MAAMW,EAAQ,CAAE,MAAO5B,CAAM,CAAC,EAE/CiB,EAAO,UAAU,MAAMW,CAAM,EACjCZ,EAAQ,WAAW,EAAE,WAAY,EAAEC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC/DA,EAAO,YAAY,CACvB,CAAC,CACL,CAAC,EAEDA,EAAO,WAAW,kBAAoBW,GAAW,CAC7CX,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,MAAM,EACbD,EAAQ,aAAa,EAAE,WAAY,EAAEC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EACjEA,EAAO,UAAU,OAAOW,EAAQ,CAAE,MAAO,IAAK,EAAG,KAAM,EAAI,EAC3DZ,EAAQ,WAAW,EAAE,WAAY,EAAEC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC/DA,EAAO,YAAY,CACvB,CAAC,CACL,CAAC,EAED,SAAS0C,EAAiBC,EAAWhC,EAAQ,CACzCX,EAAO,GAAG,OAAQ,IAAM,CACpBA,EAAO,UAAU,cAAcW,EAAQ,SAAUiC,EAAO,CACpDD,EAAU,UAAUC,CAAK,CAC7B,CAAC,CACL,CAAC,CACL,CAEA,SAASC,EAAalC,EAAQ,EACtB,CAACA,GAAU,OAAOA,GAAW,YAAUA,EAAS,KAAK,SAAS,QAClE,QAAQ,aAAa,YAAY,SAAS,IAAM,CAC5C,EAAE,WAAY,QAAQ,aAAa,OAAO,CAAC,EAAE,YAAY,SAAS,EAClE,KAAK,aAAa,EAAE,WAAY,EAAEX,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC9DA,EAAO,YAAY,kBAAmB,GAAOW,CAAM,EACnD,KAAK,WAAW,EAAE,WAAY,EAAEX,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC5D,EAAE,WAAY,QAAQ,aAAa,OAAO,CAAC,EAAE,SAAS,SAAS,CACnE,CAAC,CACL,CAGAA,EAAO,GAAG,SAAS,QAAQ,WAAY,gCAAgC,EACvEA,EAAO,GAAG,SAAS,QAAQ,eAAgB,oCAAoC,EAC/EA,EAAO,GAAG,SAAS,QAAQ,QAAS,6BAA6B,EACjEA,EAAO,GAAG,SAAS,QAAQ,UAAW,+BAA+B,EACrEA,EAAO,GAAG,SAAS,QAAQ,iBAAkB,sCAAsC,EACnFA,EAAO,GAAG,SAAS,QAAQ,gBAAiB,qCAAqC,EAEjFA,EAAO,GAAG,SAAS,eAAe,OAAQ,CACtC,KAAM,cACN,QAAS,cACT,SAAU,IAAM,CACZ,OAAO,YAAYD,EAAQ,iBAAiB,EAAE,QAAQ,UAAW,EAAE,CAAC,EAChE,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,CAC5B,EACA,aAAc,CAAC+C,EAAK/D,IAAU,CAC1B,OAAQA,EAAO,CACX,IAAK,YACD,OAAO,YAAYgB,EAAQ,iBAAiB,EAAE,QAAQ,UAAW,EAAE,CAAC,EAChE,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,OACD,OAAO,YAAYA,EAAQ,QAAQ,EAAE,QAAQ,UAAW,EAAE,CAAC,EACvD,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,kBACD,OAAO,eAAeA,EAAQ,iBAAiB,EAAE,QAAQ,UAAW,EAAE,EAAG,EAAI,EACzE,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,aACD,OAAO,eAAeA,EAAQ,QAAQ,EAAE,QAAQ,UAAW,EAAE,EAAG,EAAI,EAChE,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,oBACD,OAAO,KAAKA,EAAQ,iBAAiB,EAAE,QAAQ,UAAW,EAAE,CAAC,EACzD,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,eACD,OAAO,KAAKA,EAAQ,QAAQ,EAAE,QAAQ,UAAW,EAAE,CAAC,EAChD,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,eACD,OAAO,QAAQA,EAAQ,iBAAiB,EAAE,QAAQ,UAAW,EAAE,CAAC,EAC5D,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,MACJ,IAAK,UACD,OAAO,QAAQA,EAAQ,QAAQ,EAAE,QAAQ,UAAW,EAAE,CAAC,EACnD,OAAO,UAAU,mBAAmB,GACpC,QAAQ,aAAa,WAAW,EAAE,EAClC,OAAO,UAAU,mBAAmB,GACpCA,EAAQ,KAAK,OAAO,EACxB,KACR,CACJ,EACA,MAAO8B,GAAY,CACfA,EAAS,CACL,CACI,KAAM,wBACN,MAAO,YACP,KAAM,YACV,EACA,CACI,KAAM,mBACN,MAAO,OACP,KAAM,YACV,EACA,CACI,KAAM,kCACN,MAAO,kBACP,KAAM,YACV,EACA,CACI,KAAM,6BACN,MAAO,aACP,KAAM,YACV,EACA,CACI,KAAM,+BACN,MAAO,oBACP,KAAM,YACV,EACA,CACI,KAAM,0BACN,MAAO,eACP,KAAM,YACV,EACA,CACI,KAAM,0BACN,MAAO,eACP,KAAM,YACV,EACA,CACI,KAAM,qBACN,MAAO,UACP,KAAM,YACV,CACJ,CAAC,CACL,CACJ,CAAC,EACD7B,EAAO,GAAG,SAAS,UAAU,SAAU,CACnC,KAAM,SACN,QAAS,iBACT,SAAU,IAAMD,EAAQ,WAAW,CACvC,CAAC,EACDC,EAAO,GAAG,SAAS,UAAU,QAAS,CAClC,KAAM,SACN,QAAS,QACT,SAAU,IAAMD,EAAQ,MAAM,CAClC,CAAC,EACDC,EAAO,GAAG,SAAS,UAAU,iBAAkB,CAC3C,KAAM,iBACN,QAAS,kBACT,SAAU2C,GAAa,CACnBI,EAAU,EAAE,KAAKP,GAAQ,CACrBzC,EAAQ,gBAAgByC,GAAQ,EAAE,CACtC,CAAC,EAAE,MAAMQ,GAAO,CACR,OAAO,aACP,OAAO,MAAMA,CAAG,EAChBA,EAAI,SAAWA,EAAI,UAAY,0BAC/B,MAAM,+BAA+B,EAErC,MAAM,sBAAsB,CACpC,CAAC,CACL,CACJ,CAAC,EACDhD,EAAO,GAAG,SAAS,UAAU,cAAe,CACxC,KAAM,aACN,QAAS,gBACT,SAAU2C,GAAa,CACnBI,EAAU,EAAE,KAAKP,GAAQ,CACrB,QAAQ,aAAa,YAAY,mBAAoB,IAAQA,GAAQ,IAAI,QAAQ,gBAAiB,OAAO,EAAE,WAAW,KAAM,cAAc,CAAC,CAC/I,CAAC,EAAE,MAAMQ,GAAO,CACR,OAAO,aACP,OAAO,MAAMA,CAAG,EAChBA,EAAI,SAAWA,EAAI,UAAY,0BAC/B,MAAM,+BAA+B,EAErC,MAAM,sBAAsB,CACpC,CAAC,CACL,CACJ,CAAC,EAEDhD,EAAO,GAAG,SAAS,UAAU,gBAAiB,CAC1C,KAAM,gBACN,QAAS,iBACT,SAAU2C,GAAaM,EAASlD,EAAQ,sBAAsB,EAAE,QAAQ,UAAW,EAAE,CAAC,CAC1F,CAAC,EAEDC,EAAO,GAAG,SAAS,gBAAgB,WAAY,CAC3C,KAAM,WACN,QAAS,WACT,OAAQ,WACR,SAAU2C,GAAaE,EAAa,UAAU,EAC9C,QAASF,GAAaD,EAAiBC,EAAW,UAAU,CAChE,CAAC,EACD3C,EAAO,GAAG,SAAS,gBAAgB,eAAgB,CAC/C,KAAM,eACN,QAAS,mBACT,OAAQ,eACR,SAAU2C,GAAaE,EAAa,cAAc,EAClD,QAASF,GAAaD,EAAiBC,EAAW,cAAc,CACpE,CAAC,EACD3C,EAAO,GAAG,SAAS,gBAAgB,QAAS,CACxC,QAAS,QACT,OAAQ,QACR,KAAM,QACN,SAAU2C,GAAaE,EAAa,OAAO,EAC3C,QAASF,GAAaD,EAAiBC,EAAW,OAAO,CAC7D,CAAC,EACD3C,EAAO,GAAG,SAAS,gBAAgB,UAAW,CAC1C,KAAM,UACN,QAAS,UACT,OAAQ,UACR,SAAU2C,GAAaE,EAAa,SAAS,EAC7C,QAASF,GAAaD,EAAiBC,EAAW,SAAS,CAC/D,CAAC,EAED3C,EAAO,GAAG,SAAS,YAAY,QAAS,CACpC,KAAM,QACN,KAAM,CACF,CACI,MAAO,WACP,KAAM,WACN,OAAQ,WACR,QAAS6C,EACT,aAAcH,CAClB,EAAG,CACC,MAAO,eACP,KAAM,mBACN,OAAQ,eACR,QAASG,EACT,aAAcH,CAClB,EACA,CACI,KAAM,QACN,OAAQ,QACR,MAAO,QACP,QAASG,EACT,aAAcH,CAClB,EACA,CACI,MAAO,UACP,KAAM,UACN,OAAQ,UACR,QAASG,EACT,aAAcH,CAClB,CACJ,CACJ,CAAC,EAED1C,EAAO,GAAG,SAAS,YAAY,WAAY,CACvC,MAAO,WACP,KAAM,WACN,OAAQ,WACR,QAAS6C,EACT,aAAcH,CAClB,CAAC,EAED1C,EAAO,GAAG,SAAS,YAAY,eAAgB,CAC3C,MAAO,eACP,KAAM,mBACN,OAAQ,eACR,QAAS6C,EACT,aAAcH,CAClB,CAAC,EAED1C,EAAO,GAAG,SAAS,YAAY,QAAS,CACpC,KAAM,QACN,OAAQ,QACR,MAAO,QACP,QAAS6C,EACT,aAAcH,CAClB,CAAC,EACD1C,EAAO,GAAG,SAAS,YAAY,UAAW,CACtC,MAAO,UACP,KAAM,UACN,OAAQ,UACR,QAAS6C,EACT,aAAcH,CAClB,CAAC,EAED1C,EAAO,GAAG,SAAU,IAAM,CACtBD,EAAQ,WAAW,EAAE,WAAY,EAAEC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,CACnE,CAAC,EACDA,EAAO,YAAY,SAAU,gBAAiB,IAAM,CAChD6C,EAAa,eAAe,CAChC,CAAC,EACD7C,EAAO,YAAY,SAAU,WAAY,IAAM,CAC3C6C,EAAa,UAAU,CAC3B,CAAC,EACD7C,EAAO,YAAY,SAAU,mBAAoB,IAAM,CACnD6C,EAAa,cAAc,CAC/B,CAAC,EACD7C,EAAO,YAAY,SAAU,QAAS,IAAM,CACxC6C,EAAa,OAAO,CACxB,CAAC,EACD7C,EAAO,YAAY,SAAU,UAAW,IAAM,CAC1C6C,EAAa,SAAS,CAC1B,CAAC,CACL,CAAC,CACL,CAEQ,aAAaK,EAAK7D,EAAI,CAC1B6D,EAAI,KACA,UAAY,CACR,GAAK,EAAE,IAAI,EAAE,KAAK,SAAS,GAEvB,EAAA7D,GAAK,EAAE,IAAI,EAAE,SAAS,SAAS,GAEnC,KAAI8D,EAAMC,EACN/D,GACA8D,EAAO,EAAE,IAAI,EAAE,IAAI,OAAO,EAC1BC,EAAO,EAAE,IAAI,EAAE,IAAI,kBAAkB,IAGrCA,EAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,OAAO,EACnCD,EAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,kBAAkB,GAE9CA,IAAS,UACTA,EAAO,IACPC,IAAS,qBACTA,EAAO,SACX,EAAE,IAAI,EAAE,IAAI,QAASA,CAAI,EACzB,EAAE,IAAI,EAAE,IAAI,mBAAoBD,CAAI,EAChC,EAAE,IAAI,EAAE,SAAS,EAAE,QACnB,KAAK,aAAa,EAAE,IAAI,EAAE,SAAS,EAAG,EAAI,EAClD,CACJ,CACJ,CAEQ,WAAWD,EAAK7D,EAAI,CACxB6D,EAAI,KACA,UAAY,CACR,GAAI,EAAA7D,GAAK,EAAE,IAAI,EAAE,SAAS,SAAS,GAEnC,KAAI8D,EAAMC,EACN/D,GACA8D,EAAO,EAAE,IAAI,EAAE,IAAI,OAAO,EAC1BC,EAAO,EAAE,IAAI,EAAE,IAAI,kBAAkB,IAGrCD,EAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,OAAO,EACnCC,EAAO,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,kBAAkB,GAE9CD,IAAS,qBACTA,EAAO,SACPC,IAAS,qBACTA,EAAO,SACP,EAAE,IAAI,EAAE,SAAS,EAAE,SACnB,KAAK,aAAa,EAAE,IAAI,EAAE,SAAS,EAAG,EAAI,EAC1C,KAAK,WAAW,EAAE,IAAI,EAAE,SAAS,EAAG,EAAI,GAE5C,EAAE,IAAI,EAAE,IAAI,QAASA,CAAI,EACzB,EAAE,IAAI,EAAE,IAAI,mBAAoBD,CAAI,EACpC,EAAE,IAAI,EAAE,KAAK,UAAW,EAAI,EAEhC,CACJ,CACJ,CAEQ,UAAU7D,EAAOI,EAAK,CAC1B,IAAI2D,EAAO,4BAA8B/D,IAAU,cAAgB,sBAAwB,IAAM,KACjG,OAAA+D,GAAQ,YAAc3D,EAAM,IAC5B2D,GAAQ,oBAAsB/D,EAAQ,IACtC+D,GAAQ,iBACRA,GAAQ,iBACRA,GAAQ,8BAAgC/D,IAAU,cAAgBA,EAAQ,IAAMA,GAAS,IACrF,KAAK,WAAWI,CAAG,EACnB2D,GAAQ,WAAa3D,EAAM,KAAO,KAAK,WAAWA,CAAG,EAAI,KAEzD2D,GAAQ,WAAa3D,EAAM,KAC3BJ,IAAU,gBAAe+D,GAAQ,UACrCA,GAAQ,SACRA,GAAQ,QACDA,CACX,CAEQ,gBAAgBjC,EAAM9B,EAAO,CACjC,GAAI,CAAC,KAAK,aAAc,CACpB,KAAK,aAAe,IAAIgE,EAAO,CAAE,SAAU,GAAM,MAAO,4CAA6C,OAAQ,GAAM,UAAW,GAAO,SAAU,GAAO,YAAa,GAAO,MAAO,IAAK,OAAQ,GAAI,CAAC,EACnM,KAAK,aAAa,KAAK,MAAM,WAAa,SAC1C,KAAK,aAAa,KAAK,MAAM,QAAU,OACvC,IAAIjE,EACAkE,EACAhE,EACAC,EACAC,EACAC,EACJ,IAAI8D,EAAO,yIACX,IAAKnE,EAAI,EAAGkE,EAAK,KAAK,YAAY,OAAQlE,EAAIkE,EAAIlE,GAAK,EACnDmE,GAAQ,KAAK,UAAU,KAAK,YAAYnE,CAAC,EAAG,KAAK,YAAYA,EAAI,CAAC,CAAC,EAC/DA,EAAI,EAAI,IAAM,IACdmE,GAAQ,mCAEhBA,GAAQ,kCACRA,GAAQ,KAAK,UAAU,cAAe,UAAU,EAChDA,GAAQ,0BACR,IAAIC,EAAQ,GACZ,IAAKlE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAKpB,IAJIC,EAAI,EACJgE,GAAQ,OAERC,GAAS,OACRjE,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACpB,IAAKC,EAAI,EAAGA,EAAI,EAAGA,IACfC,EAAM,MAAMH,CAAC,GAAGC,CAAC,GAAGC,CAAC,GACrBH,EAAQ,GACRD,EAAI,EACJA,EAAIE,EAAI,GAAK,GACTF,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBA,EAAI,EACJA,EAAIG,EAAI,GAAK,GACTH,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBA,EAAI,EACJA,EAAII,EAAI,GAAK,GACTJ,EAAI,KACJC,GAAS,KACbA,GAASD,EAAE,SAAS,EAAE,EACtBC,EAAQA,EAAM,YAAY,EACtBE,EAAI,EACJgE,GAAQ,KAAK,UAAUlE,EAAOI,CAAG,EAEjC+D,GAAS,KAAK,UAAUnE,EAAOI,CAAG,EAEtCF,IAAM,EACNgE,GAAQ,QACHhE,EAAI,EACTgE,GAAQ,kCACHhE,EAAI,IACTiE,GAAS,kCACjB,CACIjE,EAAI,EACJgE,GAAQ,QAERC,GAAS,OACjB,CAGA,IAFAD,GAAQC,EACRD,GAAQ,yBACHjE,EAAI,IAAKA,GAAK,IAAKA,IACpBC,GAAKD,EAAI,KAAO,GAAK,EACjBC,EAAI,GACJA,EAAI,IAAMA,EAAE,SAAS,EAAE,EAAE,YAAY,EAErCA,EAAIA,EAAE,SAAS,EAAE,EAAE,YAAY,EACnCA,EAAIA,EAAIA,EAAIA,EACZgE,GAAQ,KAAK,UAAUhE,EAAGF,CAAK,GAC3BC,IAAM,KAAOA,IAAM,OACnBiE,GAAQ,mCACRjE,IAAM,MACNiE,GAAQ,aAEhBA,GAAQ,wBACRA,GAAQ;AAAA;AAAA;AAAA;AAAA,sBAKR,KAAK,aAAa,KAAK,UAAYA,EACnC,IAAIE,EAAQ,KAAK,aAAa,KAAK,iBAAiB,KAAK,EACzD,IAAKrE,EAAI,EAAGkE,EAAKG,EAAM,OAAQrE,EAAIkE,EAAIlE,IACnCqE,EAAMrE,CAAC,EAAE,iBAAiB,QAASiD,GAAK,CACpChD,EAASgD,EAAE,cAA8B,QAAQ,SAC7ChD,IAAU,cACV,QAAQ,aAAa,YAAY,kBAAmB,KAAK,aAAa,OAAO,QAAQ,IAAI,EAEzF,QAAQ,aAAa,YAAY,iBAAkB,KAAK,aAAa,OAAO,QAAQ,KAAM,IAAMA,CAAK,EACzG,QAAQ,aAAa,YAAY,kBAAmB,KAAK,aAAa,OAAO,QAAQ,KAAM,IAAMA,CAAK,EACtG,KAAK,aAAa,MAAM,CAC5B,CAAC,CACT,CACA,KAAK,aAAa,OAAO,QAAQ,KAAO8B,EACxC,KAAK,aAAa,UAAU,CAChC,CAEQ,YAAa,CACjBuC,EAAe,iBAAkB,EAAI,EAAE,KAAKC,GAAS,CACjD,QAASC,EAAI,EAAGC,EAAKF,EAAM,OAAQC,EAAIC,EAAID,IACvCE,EAASH,EAAMC,CAAC,CAAC,EAAE,KAAMG,GAAkB,CACvC,KAAK,OAAOA,CAAQ,CACxB,CAAC,EAAE,MAAM,OAAO,KAAK,CAC7B,CAAC,EAAE,MAAM,IAAM,CAAE,CAAC,CACtB,CAEQ,gBAAgBxB,EAAM,CACtB,KAAK,SACLxD,EAAY,KAAK,SAAUwD,CAAI,EAE/B,QAAQ,aAAa,YAAY,aAAc,GAAOyB,EAAezB,CAAI,EAAE,QAAQ,gBAAiB,OAAO,CAAC,CACpH,CAEO,aAAaA,EAAM,CAClB,KAAK,SACL,KAAK,SAAS,MAAQA,EAEtB,QAAQ,aAAa,WAAWyB,EAAezB,CAAI,EAAE,QAAQ,gBAAiB,OAAO,EAAG,CAAE,OAAQ,MAAO,CAAC,CAElH,CAEQ,eAAeU,EAAK,CAGxB,QAFIgB,EAAKC,EAAKC,EAAGC,EACbC,EAAQ,CAAC,EACJhC,EAAI,EAAGiC,EAAKrB,EAAI,OAAQZ,EAAIiC,EAAIjC,IAOrC,GANA6B,EAAM,EAAEjB,EAAIZ,CAAC,CAAC,EACd4B,EAAMC,EAAI,KAAK,SAAS,EACpBD,IAAQ,MAAQA,IAAQ,IACxBA,EAAM,UACDA,IAAQ,UAAYA,IAAQ,OACjCA,EAAM,QACN,CAACA,EACDI,EAAM,KAAK,IAAMH,EAAI,KAAK,EAAI,GAAG,UAC5BD,IAAQ,OAAQ,CACrB,GAAIhB,EAAIZ,CAAC,EAAE,WAAa,GAAI,CAGxB,IAFA4B,EAAMhB,EAAIZ,CAAC,EAAE,UAAU,YAAY,EAAE,MAAM,MAAM,EACjD+B,EAAKH,EAAI,OACJE,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,IAAM,UACXE,EAAM,KAAK,OAAO,EACbJ,EAAIE,CAAC,EAAE,OAAS,GACrBE,EAAM,KAAKJ,EAAIE,CAAC,CAAC,EAGzB,IADAE,EAAQA,EAAM,OAAO,KAAK,eAAeH,EAAI,SAAS,CAAC,CAAC,EACnDC,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,IAAM,UACXE,EAAM,KAAK,OAAO,EACbJ,EAAIE,CAAC,EAAE,OAAS,GACrBE,EAAM,KAAK,IAAMJ,EAAIE,CAAC,CAAC,EAE/B,QACJ,SACSD,EAAI,IAAI,iBAAiB,IAAM,eACpCD,EAAM,oBACDC,EAAI,IAAI,iBAAiB,IAAM,YACpCD,EAAM,oBACDC,EAAI,KAAK,WAAW,EAAG,CAG5B,IAFAD,EAAMC,EAAI,KAAK,WAAW,EAAE,YAAY,EAAE,MAAM,GAAG,EACnDE,EAAKH,EAAI,OACJE,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,EAAE,SAAS,SAAS,GAAKF,EAAIE,CAAC,EAAE,SAAS,OAAO,IAEzDF,EAAIE,CAAC,EAAIF,EAAIE,CAAC,EAAE,KAAK,EACrBF,EAAIE,CAAC,EAAIF,EAAIE,CAAC,EAAE,QAAQ,cAAe,mBAAmB,EACtDF,EAAIE,CAAC,EAAE,OAAS,GAChBE,EAAM,KAAKJ,EAAIE,CAAC,CAAC,GAGzB,IADAE,EAAQA,EAAM,OAAO,KAAK,eAAeH,EAAI,SAAS,CAAC,CAAC,EACnDC,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,EAAE,SAAS,SAAS,GAAKF,EAAIE,CAAC,EAAE,SAAS,OAAO,GAErDF,EAAIE,CAAC,EAAE,OAAS,GAChBE,EAAM,KAAK,IAAMJ,EAAIE,CAAC,EAAE,KAAK,CAAC,EAEtC,QACJ,SACSD,EAAI,IAAI,OAAO,GAAKA,EAAI,IAAI,kBAAkB,GAAKA,EAAI,IAAI,YAAY,EAAG,CAS/E,IARAD,EAAM,CAAC,EACHC,EAAI,IAAI,OAAO,GACfD,EAAI,KAAK,UAAY,IAAIpE,EAASqE,EAAI,IAAI,OAAO,CAAC,EAAE,MAAM,EAAE,YAAY,CAAC,EACzEA,EAAI,IAAI,kBAAkB,GAC1BD,EAAI,KAAK,qBAAuB,IAAIpE,EAASqE,EAAI,IAAI,kBAAkB,CAAC,EAAE,MAAM,EAAE,YAAY,CAAC,EAC/FA,EAAI,IAAI,YAAY,GACpBD,EAAI,KAAK,qBAAuB,IAAIpE,EAASqE,EAAI,IAAI,YAAY,CAAC,EAAE,MAAM,EAAE,YAAY,CAAC,EAC7FE,EAAKH,EAAI,OACJE,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,EAAE,OAAS,GAChBE,EAAM,KAAKJ,EAAIE,CAAC,EAAE,KAAK,CAAC,EAGhC,IADAE,EAAQA,EAAM,OAAO,KAAK,eAAeH,EAAI,SAAS,CAAC,CAAC,EACnDC,EAAI,EAAGA,EAAIC,EAAID,IACZF,EAAIE,CAAC,EAAE,OAAS,GAChBE,EAAM,KAAK,IAAMJ,EAAIE,CAAC,EAAE,KAAK,CAAC,EAEtC,QACJ,CAEAE,EAAM,KAAKJ,CAAG,EACdI,EAAQA,EAAM,OAAO,KAAK,eAAeH,EAAI,SAAS,CAAC,CAAC,EACxDG,EAAM,KAAK,IAAMJ,CAAG,CACxB,MACSA,GAAO,MAAQC,EAAI,KAAK,WAAW,EACxCG,EAAM,KAAK,OAAO,GAElBA,EAAM,KAAKJ,CAAG,EACdI,EAAQA,EAAM,OAAO,KAAK,eAAeH,EAAI,SAAS,CAAC,CAAC,EACxDG,EAAM,KAAK,IAAMJ,CAAG,GAG5B,OAAOI,CACX,CAEO,uBAAwB,CAM3B,QAJIE,EAAQ,QAAQ,aAAa,IAAI,WAAW,QAAQ,aAAa,UAAU,QAAQ,CAAC,EACpFC,EAAI,EAAGC,EAAKF,EAAM,OAClBG,EAAQ,SACRC,EAAM,UACHH,EAAIC,EAAID,IAAK,CAChB,IAAIP,EAAMM,EAAMC,CAAC,EAAE,QACnB,GAAIP,IAAQ,MAAQA,IAAQ,KAAOA,IAAQ,UAAYA,IAAQ,IAC3DS,GAAS,IAAMT,EAAM,IACrBU,EAAM,KAAOV,EAAM,IAAMU,UAEpBV,IAAQ,OAAQ,CACrBS,GAAS,IAAMT,EACXM,EAAMC,CAAC,EAAE,WAAa,KACtBE,GAAS,WAAaH,EAAMC,CAAC,EAAE,UAAY,KAC/C,IAAII,EAAQ,GACRL,EAAMC,CAAC,EAAE,MAAM,gBAAkB,KACjCI,GAAS,mBAAqBL,EAAMC,CAAC,EAAE,MAAM,eAAiB,KAC9DD,EAAMC,CAAC,EAAE,MAAM,OAAS,KACxBI,GAAS,SAAWL,EAAMC,CAAC,EAAE,MAAM,MAAQ,KAC3CD,EAAMC,CAAC,EAAE,MAAM,YAAc,KAC7BI,GAAS,cAAgBL,EAAMC,CAAC,EAAE,MAAM,WAAa,KACrDD,EAAMC,CAAC,EAAE,MAAM,iBAAmB,KAClCI,GAAS,oBAAsBL,EAAMC,CAAC,EAAE,MAAM,gBAAkB,KAChEI,EAAM,OAAS,IACfF,GAAS,WAAaE,EAAQ,KAC9BL,EAAMC,CAAC,EAAE,SAAWD,EAAMC,CAAC,EAAE,QAAQ,WACrCE,GAAS,oBAAsBH,EAAMC,CAAC,EAAE,QAAQ,SAAW,KAC/DE,GAAS,KACTC,EAAM,KAAOV,EAAM,IAAMU,CAC7B,SACSV,IAAQ,OAAQ,CACrBS,GAAS,IAAMT,EAAM,IACrBU,EAAM,KAAOV,EAAM,IAAMU,EACzB,KACJ,CACJ,CACA,OAAO,KAAK,WAAW,EAAED,EAAQ,QAAQ,aAAa,UAAU,WAAW,CAAE,OAAQ,KAAM,CAAC,EAAE,QAAQ,gBAAiB,MAAM,EAAIC,CAAG,CAAC,CACzI,CAEO,kBAAmB,CACtB,OAAI,KAAK,SACE,KAAK,SAAS,MAClB,KAAK,WAAW,EAAE,SAAW,KAAK,OAAO,EAAE,QAAQ,gBAAiB,MAAM,EAAI,SAAS,CAAC,CACnG,CAEO,SAAU,CACb,OAAI,KAAK,SACE,KAAK,SAAS,MAClB,QAAQ,aAAa,WAAW,CAAE,OAAQ,MAAO,CAAC,CAC7D,CAGO,SAAU,CACb,OAAI,KAAK,SACE,KAAK,SAAS,MAClB,QAAQ,aAAa,WAAW,CAAE,OAAQ,MAAO,CAAC,CAC7D,CAEO,QAAS,CACZ,OAAI,KAAK,SACE,KAAK,SAAS,MAClB,QAAQ,aAAa,WAAW,CAAE,OAAQ,KAAM,CAAC,CAC5D,CAEQ,WAAWpC,EAAM,CACrB,IAAIC,EAAO,KAAK,eAAeD,CAAI,EAC/BsC,EAAS,CAAC,EACVC,EAAQ,CAAC,EACTzF,EAAO0F,EAAGC,EAAIC,EAGlB,IAAKF,EAAIvC,EAAK,OAAS,EAAGuC,GAAK,IACvB,CAACvC,EAAKuC,CAAC,EAAE,WAAW,GAAG,GAAKvC,EAAKuC,CAAC,GAAK,MAAQvC,EAAKuC,CAAC,GAAK,SADhCA,IAE1BvC,EAAK,IAAI,EAOjB,IAHIA,EAAK,CAAC,IAAM,OACZA,EAAK,MAAM,EAEVuC,EAAI,EAAGC,EAAKxC,EAAK,OAAQuC,EAAIC,EAAID,IAClC,OAAQvC,EAAKuC,CAAC,EAAG,CACb,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,YACL,IAAK,eACL,IAAK,WACL,IAAK,QACL,IAAK,UACDD,EAAM,KAAK,KAAOtC,EAAKuC,CAAC,EAAI,IAAI,EAChCF,EAAO,KAAK,KAAOrC,EAAKuC,CAAC,EAAI,IAAI,EACjC,MACJ,IAAK,gBACL,IAAK,YACL,IAAK,SACL,IAAK,WACL,IAAK,aACL,IAAK,QACL,IAAK,UACL,IAAK,aACDD,EAAM,IAAI,EACV,KAAK,WAAWD,CAAM,EACtBA,EAAO,KAAK,WAAW,EACnBC,EAAM,OAAS,GACfD,EAAO,KAAKC,EAAM,KAAK,EAAE,CAAC,EAC9B,MACJ,IAAK,OACL,IAAK,QACL,IAAK,MACL,IAAK,OACD,MACJ,IAAK,MACL,IAAK,KACGA,EAAM,OAAS,GAAKD,EAAO,OAAS,GAAK,CAACA,EAAOA,EAAO,OAAS,CAAC,EAAE,SAAS,WAAW,IACxF,KAAK,WAAWA,CAAM,EACtBA,EAAO,KAAK,WAAW,GAE3BA,EAAO,KAAK;AAAA,CAAI,EACZC,EAAM,OAAS,GACfD,EAAO,KAAKC,EAAM,KAAK,EAAE,CAAC,EAC9B,MACJ,IAAK,QACGA,EAAM,OAAS,GAAKD,EAAO,OAAS,GAAK,CAACA,EAAOA,EAAO,OAAS,CAAC,EAAE,SAAS,WAAW,IACxF,KAAK,WAAWA,CAAM,EACtBA,EAAO,KAAK,WAAW,GAEvBC,EAAM,OAAS,GACfD,EAAO,KAAKC,EAAM,KAAK,EAAE,CAAC,EAC9B,MACJ,QACQtC,EAAKuC,CAAC,EAAE,WAAW,UAAU,GAC7B1F,EAAQmD,EAAKuC,CAAC,EAAE,OAAO,CAAC,EACnB,KAAK,QAAQ1F,CAAK,IACnB4F,EAAM,IAAIpF,EAASR,CAAK,EACxBA,EAAQ,KAAK,WAAW4F,EAAI,MAAM,CAAC,EAAE,OAAO,CAAC,GAEjD5F,EAAQ,KAAK,QAAQA,CAAK,GACtBA,IAAU,cAAgBA,IAAU,mBACpCA,EAAQ,UACZyF,EAAM,KAAK,KAAOzF,EAAQ,IAAI,EAC9BwF,EAAO,KAAK,KAAOxF,EAAQ,IAAI,GAE1BmD,EAAKuC,CAAC,EAAE,WAAW,SAAS,GACjC1F,EAAQ,IAAIQ,EAAS2C,EAAKuC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EACnD,KAAK,QAAQ1F,CAAK,IACnBA,EAAQ,KAAK,WAAW,IAAMA,CAAK,EAAE,OAAO,CAAC,GACjDA,EAAQ,KAAK,QAAQA,CAAK,GACtBA,IAAU,cAAgBA,IAAU,mBACpCA,EAAQ,UACZyF,EAAM,KAAK,KAAOzF,EAAQ,IAAI,EAC9BwF,EAAO,KAAK,KAAOxF,EAAQ,IAAI,GAG1BmD,EAAKuC,CAAC,EAAE,WAAW,UAAU,GAClCD,EAAM,IAAI,EACV,KAAK,WAAWD,CAAM,EACtBA,EAAO,KAAK,WAAW,EACnBC,EAAM,OAAS,GACfD,EAAO,KAAKC,EAAM,KAAK,EAAE,CAAC,GAEzBtC,EAAKuC,CAAC,EAAE,WAAW,qBAAqB,GAC7C1F,EAAQmD,EAAKuC,CAAC,EAAE,OAAO,EAAE,EACpB,KAAK,QAAQ1F,CAAK,IACnB4F,EAAM,IAAIpF,EAASR,CAAK,EACxBA,EAAQ,KAAK,WAAW4F,EAAI,MAAM,CAAC,EAAE,OAAO,CAAC,GAE7C,KAAK,QAAQ,IAAM5F,CAAK,EACxBA,EAAQ,KAAK,QAAQ,IAAMA,CAAK,EAEhCA,EAAQ,KAAK,QAAQA,CAAK,EAC9BA,EAAQ,OAASA,EAAQ,KACzByF,EAAM,KAAKzF,CAAK,EAChBwF,EAAO,KAAKxF,CAAK,GAEZmD,EAAKuC,CAAC,EAAE,WAAW,oBAAoB,GAC5C1F,EAAQ,IAAIQ,EAAS2C,EAAKuC,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,EACpD,KAAK,QAAQ1F,CAAK,IACnBA,EAAQ,KAAK,WAAW,IAAMA,CAAK,EAAE,OAAO,CAAC,GAC7C,KAAK,QAAQ,IAAMA,CAAK,EACxBA,EAAQ,KAAK,QAAQ,IAAMA,CAAK,EAEhCA,EAAQ,KAAK,QAAQA,CAAK,EAC9BA,EAAQ,OAASA,EAAQ,KACzByF,EAAM,KAAKzF,CAAK,EAChBwF,EAAO,KAAKxF,CAAK,GAEZmD,EAAKuC,CAAC,EAAE,WAAW,qBAAqB,GAC7CD,EAAM,IAAI,EACV,KAAK,WAAWD,CAAM,EACtBA,EAAO,KAAK,WAAW,EACnBC,EAAM,OAAS,GACfD,EAAO,KAAKC,EAAM,KAAK,EAAE,CAAC,GAEzBtC,EAAKuC,CAAC,EAAE,WAAW,GAAG,GAC3BF,EAAO,KAAKrC,EAAKuC,CAAC,EAAE,UAAU,EAAGvC,EAAKuC,CAAC,EAAE,OAAS,CAAC,CAAC,EACxD,KACR,CAEJ,OAAOF,EAAO,KAAK,EAAE,CACzB,CAEQ,WAAWA,EAAQ,CACvB,IAAIrF,EAAIqF,EAAO,OAAS,EACxB,KAAOrF,GAAK,EAAGA,IACX,GAAIqF,EAAOrF,CAAC,EAAE,WAAW,IAAI,EACzBqF,EAAO,IAAI,MAEX,QAAOA,EAEf,OAAOA,CACX,CAKQ,WAAWK,EAAK,CACpB,IAAIpF,EAAU,KAEVqF,EAAW,SAAUD,EAAK,CAC1B,IAAIE,EAAa,mCAEjBF,EAAMA,EAAI,QAAQE,EAAY,SAAUC,EAAM/F,EAAGC,EAAGC,EAAG,CACnD,MAAO,CAACF,EAAGA,EAAGC,EAAGA,EAAGC,EAAGA,CAAC,EAAE,KAAK,CACnC,CAAC,EACD,IAAI8F,EAAY,4CACZC,EAAWD,EAAU,KAAKJ,CAAG,EAC7BM,EAASD,EAAW,CACpB,EAAG,SAASA,EAAS,CAAC,EAAG,EAAE,EAC3B,EAAG,SAASA,EAAS,CAAC,EAAG,EAAE,EAC3B,EAAG,SAASA,EAAS,CAAC,EAAG,EAAE,CAC/B,EAAI,KACJ,OAAOC,CACX,EAEIC,EAAoB,SAAUD,EAAQ,CACtC,GAAI,CAACA,EACD,MAAM,IAAI,MAAM,sGAA0G,EAM9H,QAHIE,EAAc,OAAO,iBACrBC,EAAa,KAERjE,EAAI,EAAGA,EAAI5B,EAAQ,UAAU,OAAQ4B,IAAK,CAC/C,IAAIkE,EAAe9F,EAAQ,UAAU4B,CAAC,EAClCmE,EAAW,KAAK,KAChB,KAAK,IAAKL,EAAO,EAAII,EAAa,IAAI,EAAI,CAAC,EAC3C,KAAK,IAAKJ,EAAO,EAAII,EAAa,IAAI,EAAI,CAAC,EAC3C,KAAK,IAAKJ,EAAO,EAAII,EAAa,IAAI,EAAI,CAAC,CAC/C,EACIC,EAAWH,IACXA,EAAcG,EACdF,EAAaC,EAAa,IAElC,CACA,OAAOD,CACX,EAEA,OAAOF,EAAkBN,EAASD,CAAG,CAAC,CAE1C,CAEO,QAAS,CACZ,QAAQ,OAAO,IAAI,KAAK,SAAS,EAAE,EAAE,CACzC,CAEO,YAAa,CACZ,KAAK,WACT,KAAK,YAAY,EACjB,QAAQ,KAAK,CACT,YAAa,MACb,cAAe,GACf,SAAU,YAAY,KAAK,SAAS,EAAE,GACtC,OAAQ,IACR,QAAS,GACT,mBAAoB,GAEpB,OAAQ,GACR,UAAW,GACX,OAAQ,GACR,kBAAmB,GACnB,kBAAmB,MACnB,QAAS,wDACT,sBAAuB,CAACnF,EAAQV,EAAOqB,IAAW,CAAE,KAAK,gBAAgBA,EAAQrB,GAAS,EAAE,CAAG,EAC/F,qBAAsB,eACtB,eAAgB,IAChB,eAAgB,IAChB,QAAS,qLACT,aAAc,UACd,YAAa,8BACb,QAAS,CACL,KAAM,CAAE,OAAQ,SAAU,MAAO,GAAM,MAAO,GAAM,eAAgB,EAAK,EACzE,OAAQ,CAAE,OAAQ,KAAM,MAAO,GAAM,MAAO,GAAM,eAAgB,EAAK,EACvE,SAAU,CAAE,OAAQ,OAAQ,QAAW,WAAY,MAAO,GAAM,eAAgB,EAAK,EACrF,aAAc,CAAE,OAAQ,OAAQ,QAAW,eAAgB,MAAO,GAAM,eAAgB,EAAK,EAC7F,MAAO,CAAE,OAAQ,OAAQ,QAAW,QAAS,MAAO,GAAM,eAAgB,EAAK,EAC/E,QAAS,CAAE,OAAQ,OAAQ,QAAW,UAAW,MAAO,GAAM,eAAgB,EAAK,EACnF,UAAW,CAAE,OAAQ,OAAQ,QAAW,YAAa,MAAO,GAAM,eAAgB,EAAK,EACvF,cAAe,CAAE,OAAQ,OAAQ,QAAW,YAAa,MAAO,GAAM,eAAgB,EAAK,EAC3F,UAAW,CAAE,OAAQ,OAAQ,OAAQ,CAAE,eAAgB,UAAW,OAAQ,UAAW,MAAO,QAAS,EAAG,MAAO,GAAM,MAAO,GAAM,eAAgB,EAAK,EACvJ,YAAa,CAAE,OAAQ,OAAQ,OAAQ,CAAE,eAAgB,UAAW,OAAQ,UAAW,gBAAiB,QAAS,EAAG,MAAO,GAAM,MAAO,GAAM,eAAgB,EAAK,CAGvK,EACA,uBAAyBU,GAAW,CAChCA,EAAO,UAAU,IAAI,eAAgB,iBAAkB,IAAMiD,EAAS,KAAK,sBAAsB,EAAE,QAAQ,UAAW,EAAE,CAAC,CAAC,EAS1HjD,EAAO,GAAG,kBAAmBsC,GAAK,CAC1B,OAAO,UAAU,aAAa,GAC9B,OAAO,MAAM,2CAA6CA,EAAE,OAAO,EACvE,KAAK,aAAa,EAAE,WAAY,EAAEtC,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,EAC9DsC,EAAE,QAAUA,EAAE,QAAQ,QAAQ,SAAU,MAAM,EAC9CA,EAAE,QAAUA,EAAE,QAAQ,QAAQ,cAAe,MAAM,EACnDA,EAAE,QAAUA,EAAE,QAAQ,QAAQ,UAAW,MAAM,EAG/C,QAFIyD,EAAQ,gCACRC,GACIA,EAAID,EAAM,KAAKzD,EAAE,OAAO,KAAO,MAC/B0D,EAAE,QAAUD,EAAM,WAClBA,EAAM,YAEVzD,EAAE,QAAUA,EAAE,QAAQ,UAAU,EAAG0D,EAAE,KAAK,EAAI1D,EAAE,QAAQ,UAAU0D,EAAE,MAAOD,EAAM,SAAS,EAAE,QAAQ,gBAAiB,OAAO,EAAE,WAAW,KAAM,cAAc,EAAIzD,EAAE,QAAQ,UAAUyD,EAAM,SAAS,EAEpM,OAAO,UAAU,aAAa,GAC9B,OAAO,MAAM,0CAA4CzD,EAAE,OAAO,CAC1E,CAAC,EACDtC,EAAO,GAAG,kBAAmB,IAAM,CAC/B,KAAK,WAAW,EAAE,WAAY,EAAEA,EAAO,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC,CAChE,CAAC,EACD,EAAE,oBAAqB,QAAQ,aAAa,OAAO,CAAC,EAAE,IAAI,YAAa,OAAO,UAAU,aAAa,CAAC,EACtG,EAAE,oBAAqB,QAAQ,aAAa,OAAO,CAAC,EAAE,IAAI,cAAe,OAAO,UAAU,SAAS,EAAI,aAAa,EAChH,QAAQ,aAAa,UACrB,QAAQ,aAAa,UAAU,SAAS,QAAS,CAAE,OAAQ,OAAQ,QAAW,OAAO,UAAU,UAAU,EAAI,QAAU,UAAW,MAAO,GAAM,eAAgB,EAAK,CAAC,EAErK,QAAQ,aAAa,SAAS,QAAQ,MAAW,CAAE,OAAQ,OAAQ,QAAW,OAAO,UAAU,UAAU,EAAI,QAAU,UAAW,MAAO,GAAM,eAAgB,EAAK,EACxK,KAAK,WAAW,EAChB,KAAK,aAAa,KAAK,KAAK,EAC5B,KAAK,KAAK,aAAa,CAC3B,EACA,kBAAmB,GACnB,oBAAqB,oDACrB,eAAgB,sDAChB,aAAc,CACV,IAAK,+DACT,EACA,UAAW,KAAK,WACpB,CAAC,EACL,CAEO,OAAQ,CACP,KAAK,SACL,KAAK,SAAS,MAAM,EACJ,QAAQ,cACxB,QAAQ,aAAa,MAAM,CACnC,CACJ,ECtoDA,IAAIiG,EACAC,EAEG,SAASC,IAAsB,CAClC,IAAIC,EACJC,EAAS,EACT,OAAO,MAAM,GAAG,mBAAoB,IAAM,EAClC,OAAO,UAAU,iBAAiB,GAAK,OAAO,UAAU,mBAAmB,IAC3EC,EAAmB,CAC3B,CAAC,EACD,OAAO,GAAG,iBAAkB,IAAM,CAC9B,OAAO,aAAa,oBAAoB,QAASA,CAAkB,EACnE,OAAO,aAAa,oBAAoB,SAAUA,CAAkB,EACpEC,EAAiB,EACjBC,EAAmB,GACf,OAAO,UAAU,iBAAiB,GAAK,OAAO,UAAU,mBAAmB,IAC3EF,EAAmB,CAC3B,CAAC,EAED,SAAS,eAAe,cAAc,EAAE,iBAAiB,QAASG,GAAK,CACnE,GAAI,CAACP,EAAc,CACfA,EAAe,IAAIQ,EAAO,OAAO,OAAO,CAAC,EAAG,OAAO,UAAU,gBAAgB,GAAK,CAAE,OAAQ,EAAK,EAAG,CAAE,MAAO,8CAA+C,GAAI,YAAa,CAAC,CAAC,EAC/KR,EAAa,GAAG,UAAWO,GAAK,CAC5B,OAAO,UAAU,iBAAkBA,CAAC,CACxC,CAAC,EACDP,EAAa,GAAG,QAASO,GAAK,CAC1B,OAAO,UAAU,iBAAkBA,CAAC,CACxC,CAAC,EACDP,EAAa,GAAG,YAAa,IAAM,CAC/B,OAAO,UAAU,iBAAkBA,EAAa,WAAW,CAC/D,CAAC,EACDA,EAAa,GAAG,WAAY,IAAM,CAC9B,OAAO,UAAU,iBAAkBA,EAAa,WAAW,CAC/D,CAAC,EACDA,EAAa,GAAG,QAAS,IAAM,CAC3B,OAAO,UAAU,iBAAkBA,EAAa,WAAW,EAC3DD,EAAO,WAAW,CACtB,CAAC,EACDC,EAAa,GAAG,UAAW,IAAM,CAC7BD,EAAO,OAAO,CAClB,CAAC,EACDC,EAAa,GAAG,SAAU,IAAM,CAC5B,OAAO,UAAU,iBAAkBA,EAAa,WAAW,CAC/D,CAAC,EACDA,EAAa,GAAG,YAAa,IAAM,CAC/BD,EAAO,OAAO,CAClB,CAAC,EACDC,EAAa,GAAG,WAAY,IAAM,CAC9B,OAAO,UAAU,iBAAkBA,EAAa,WAAW,CAC/D,CAAC,EACD,IAAMS,EAAW,SAAS,cAAc,UAAU,EAClDA,EAAS,UAAU,IAAI,eAAgB,iBAAiB,EACxDA,EAAS,GAAK,iBACdT,EAAa,KAAK,YAAYS,CAAQ,EACtCT,EAAa,KAAK,MAAM,SAAW,SAC9BD,IAAQA,EAAS,IAAIW,EAAUD,EAAU,CAAC,OAAO,UAAU,cAAc,CAAC,GAC/EV,EAAO,GAAG,QAAS,IAAM,CACrBC,EAAa,MAAM,CACvB,CAAC,EACDD,EAAO,GAAG,cAAe,IAAMA,EAAO,MAAM,CAAC,EAC7CC,EAAa,OAAO,OAASD,EACd,SACXC,EAAa,OAAO,cAAc,iBAAiB,EAAE,mBAAmB,WAAY,sLAAsL,EAC9QA,EAAa,OAAO,UAAY;AAAA;AAAA,2HAG3BD,EAAO,WACRC,EAAa,OAAO,cAAc,oBAAoB,EAAE,MAAQ,oBACpEA,EAAa,OAAO,cAAc,oBAAoB,EAAE,iBAAiB,QAAS,IAAM,CACpF,OAAO,UAAU,eAAgB,CAACD,EAAO,MAAM,EAC/C,IAAIY,EAAQ,GACPZ,EAAO,WACRY,EAAQZ,EAAO,iBAAiB,EAAE,QAAQ,UAAW,EAAE,GAG3DA,EAAO,OAAS,CAACA,EAAO,OACnBA,EAAO,UAKRA,EAAO,MAAQY,EACfX,EAAa,WAAW,EACxBA,EAAa,OAAO,cAAc,oBAAoB,EAAE,MAAQ,qBAChE,WAAW,IAAMD,EAAO,MAAM,EAAG,GAAG,IAPpCC,EAAa,WAAW,EACxBA,EAAa,OAAO,cAAc,oBAAoB,EAAE,MAAQ,mBASxE,CAAC,EACD,SAAS,eAAe,qBAAqB,EAAE,iBAAiB,QAAS,IAAM,CAC3EY,EAAe,cAAe,EAAK,EAAE,KAAKC,GAAS,CAC/CC,EAASD,EAAM,CAAC,CAAC,EAAE,KAAME,GAAkB,CACvChB,EAAO,OAAOgB,CAAQ,CAC1B,CAAC,EAAE,MAAM,OAAO,KAAK,CACzB,CAAC,EAAE,MAAM,IAAM,CAAE,CAAC,CACtB,CAAC,EACD,SAAS,eAAe,mBAAmB,EAAE,iBAAiB,QAAS,IAAM,CACzE,OAAO,YAAYhB,EAAO,MAAM,CAAC,EAC7B,OAAO,UAAU,mBAAmB,GACpCA,EAAO,MAAM,EACb,OAAO,UAAU,mBAAmB,GACpCC,EAAa,MAAM,CAC3B,CAAC,EACD,SAAS,eAAe,oBAAoB,EAAE,iBAAiB,QAAS,IAAM,CAC1ED,EAAO,MAAM,EACbA,EAAO,MAAM,CACjB,CAAC,EACIA,EAAO,UACRC,EAAa,WAAW,CAChC,CACAA,EAAa,KAAK,EAClBD,EAAO,MAAM,CACjB,CAAC,EAEDG,EAAU,OAAO,UAAU,gBAAgB,EACvCA,GAAWA,EAAQ,MACnB,SAAS,eAAe,cAAc,EAAE,MAAM,EAElD,SAAS,eAAe,qBAAqB,EAAE,iBAAiB,mBAAoB,UAAY,CAC5F,SAAS,KAAK,YAAY,SAAS,eAAe,sBAAsB,CAAC,CAC7E,CAAC,EACD,SAAS,eAAe,qBAAqB,EAAE,iBAAiB,qBAAsB,UAAY,CAC9F,SAAS,eAAe,qBAAqB,EAAE,cAAc,YAAY,SAAS,eAAe,sBAAsB,CAAC,CAC5H,CAAC,EACD,OAAO,aAAa,oBAAoB,QAASE,CAAkB,EACnE,OAAO,aAAa,oBAAoB,SAAUA,CAAkB,EACpEC,EAAiB,EACjBC,EAAmB,GACf,OAAO,UAAU,iBAAiB,GAAK,OAAO,UAAU,mBAAmB,IAC3EF,EAAmB,CAC3B,CAEA,SAASA,GAAqB,CAC1BY,EAAS,IAAM,CACXC,GAAoB,CACxB,EAAG,IAAK,eAAe,CAC3B,CAEA,eAAeZ,GAAmB,EAC1B,OAAO,UAAU,iBAAiB,GAAK,OAAO,UAAU,mBAAmB,KAC3E,OAAO,aAAa,iBAAiB,QAASD,CAAkB,EAChE,OAAO,aAAa,iBAAiB,SAAUA,CAAkB,GAEjE,OAAO,UAAU,iBAAiB,GAClC,SAAS,eAAe,gBAAgB,EAAE,MAAM,WAAa,WAC7D,SAAS,eAAe,gBAAgB,EAAE,MAAM,aAAe,aAG/D,SAAS,eAAe,gBAAgB,EAAE,MAAM,WAAa,GAC7D,SAAS,eAAe,gBAAgB,EAAE,MAAM,aAAe,IAE/D,OAAO,UAAU,mBAAmB,GACpC,SAAS,eAAe,gBAAgB,EAAE,MAAM,SAAW,OAC3D,OAAO,aAAa,MAAM,SAAW,SAGrC,SAAS,eAAe,gBAAgB,EAAE,MAAM,SAAW,GAC3D,OAAO,aAAa,MAAM,SAAW,GAE7C,CAEA,IAAIc,EAA0B,CAAC,EAC/B,SAASZ,GAAqB,CAC1B,IAAMa,EAAU,SAAS,eAAe,gBAAgB,EACxD,SAAS,KAAK,YAAYA,CAAO,EACjC,IAAMC,EAAM,OAAO,aAAa,cAC1BC,EAAU,OAAO,iBAAiBD,CAAG,EAC3CD,EAAQ,MAAM,SAAW,OAAO,aAAa,MAAM,SACnDA,EAAQ,MAAM,WAAa,OAAO,aAAa,MAAM,WACrDA,EAAQ,MAAM,MAAQ,OAAO,aAAa,YAAc,KACxD,IAAMG,EAAaH,EAAQ,UAC3BA,EAAQ,UAAY,IACpB,IAAII,EAAY,OAAO,UAAU,iBAAiB,EAC5CC,EAASL,EAAQ,aACvBI,EAAYC,GAAUD,EAAY,EAAI,EAAIA,GAC1C,IAAIE,EAAU,WAAWJ,EAAQ,cAAc,GAAK,EACpDI,GAAW,WAAWJ,EAAQ,iBAAiB,GAAK,EACpDI,GAAW,WAAWJ,EAAQ,UAAU,GAAK,EAC7CI,GAAW,WAAWJ,EAAQ,aAAa,GAAK,EAChD,IAAIK,EAAQL,EAAQ,MAAM,MAAM,GAAG,EACnCI,IAAY,WAAWC,EAAM,CAAC,CAAC,GAAK,GAAK,EACzCP,EAAQ,UAAYG,EACpBF,EAAI,MAAM,OAAUI,EAASC,EAAW,KAKxC,OAAO,aAAa,cAAc,MAAM,OAASD,EAAS,KAC1D,OAAO,aAAa,QAAQ,KAAK,EAAE,MAAM,OAASA,EAAS,EAAI,KAC/D,OAAO,QAAQ,UAAU,MAAM,OAAUA,EAASC,EAAW,KAE7DP,EAAqB,CACjB,QAASC,EACT,IAAKC,EACL,QAASC,EACT,OAAQG,EACR,QAASC,EACT,UAAWF,CACf,CACJ,CAEA,SAASN,IAAsB,CAC3B,IAAME,EAAUD,EAAmB,QAC7BE,EAAMF,EAAmB,IAC/BC,EAAQ,UAAY,OAAO,aAAa,MAAQ;AAAA,EAChD,IAAIK,EAASL,EAAQ,aACjBK,EAASN,EAAmB,YAC5BM,EAASN,EAAmB,WAChC,IAAMO,EAAUP,EAAmB,QACnCE,EAAI,MAAM,OAAUI,EAASC,EAAW,KACxC,OAAO,aAAa,cAAc,MAAM,OAASD,EAAS,KAC1D,OAAO,aAAa,QAAQ,KAAK,EAAE,MAAM,OAASA,EAAS,EAAI,KAC/D,OAAO,QAAQ,UAAU,MAAM,OAAUA,EAASC,EAAW,IACjE,CACA,OAAO,oBAAsBxB",
  "names": ["closeMenu", "showMenu", "initMenu", "el", "text", "icon", "updateScrollLock", "e", "EventEmitter", "#events", "type", "listener", "args", "caller", "events", "i", "len", "fun", "len", "res", "thisp", "val", "_edCache", "htmlEncode", "value", "_edCache", "StringBuffer", "str", "string", "b", "arr", "$", "x", "y", "w", "h", "r", "o", "k", "p", "obj", "str", "idx", "rem", "paddingValue", "newStr", "addSlashes", "string", "all", "sep", "type", "escape", "escapeChar", "quote", "sQuote", "pS", "s", "c", "pC", "sp", "spl", "spC", "tl", "_colorCodes", "pinkfishToHTML", "text", "loadColors", "stack", "codes", "tl", "bold", "boldNest", "classes", "cl", "c", "color", "r", "g", "b", "idx", "getColors", "_ColorTable", "insertValue", "input", "value", "active", "arg", "copyText", "text", "resolve", "reject", "blob", "data", "permission", "textarea", "e", "err", "pasteText", "fSaveAs", "DownloadAttributeSupport", "BlobBuilder", "URL", "BrowserSupportedMimeTypes", "data", "name", "mimetype", "builder", "blob", "url", "link", "event", "utf8", "intc", "i", "TryGetCharUTF8", "b", "count", "c", "s", "ss", "StringBuffer", "sl", "openFileDialog", "title", "multiple", "accept", "resolve", "reject", "dialog", "e", "input", "readFile", "file", "reader", "evt", "_timers", "debounce", "mainFunction", "delay", "key", "Dialog", "EventEmitter", "options", "debounce", "styles", "x", "y", "e", "fake", "redirectedEvent", "footer", "ec", "right", "bottom", "corner", "left", "top", "value", "type", "rect", "old", "el", "position", "w", "h", "forceReset", "dialogs", "d", "dl", "i", "order", "z", "a", "b", "RGBColor", "color_string", "simple_colors", "key", "color_defs", "bits", "cl", "re", "processor", "channels", "r", "g", "b", "AdvEditor", "EventEmitter", "element", "enabledAdvanced", "value", "insertValue", "htmlEncode", "content", "_dColors", "getColors", "c", "color", "r", "g", "b", "idx", "_bold", "bl", "clientColors", "RGBColor", "_editor", "editor", "url", "fallbackColor", "_colors", "_lastButton", "Cell", "initial", "v", "_forecolor", "_backcolor", "getCurrentColor", "format", "elm", "applyFormat", "removeFormat", "registerCommands", "name", "setIconColor", "getAdditionalColors", "hasCustom", "type", "remove", "applyColor", "onChoice", "mapColors", "colorMap", "colors", "i", "getFetch", "callback", "splitButtonApi", "newColor", "id", "registerTextColorButton", "tooltip", "lastColor", "_splitButtonApi", "handler", "e", "registerTextColorMenuItem", "text", "data", "buttonPostRender", "buttonApi", "state", "toggleFormat", "api", "pasteText", "err", "copyText", "els", "back", "fore", "cell", "Dialog", "cl", "html", "html2", "cells", "openFileDialog", "files", "f", "fl", "readFile", "contents", "pinkfishToHTML", "tag", "$el", "t", "tl", "stack", "el", "nodes", "n", "nl", "start", "end", "style", "buffer", "codes", "d", "dl", "rgb", "hex", "hexToRgb", "shortRegEx", "full", "longRegEx", "rgbArray", "rgbObj", "closestHexFromRgb", "minDistance", "nearestHex", "currentColor", "distance", "regex", "m", "editor", "editorDialog", "initializeInterface", "options", "initMenu", "resizeCommandInput", "initCommandInput", "updateCommandInput", "e", "Dialog", "textarea", "AdvEditor", "value", "openFileDialog", "files", "readFile", "contents", "debounce", "_resizeCommandInput", "commandInputResize", "measure", "cmd", "cmdSize", "oldMeasure", "minHeight", "height", "padding", "inset"]
}
