{
  "version": 3,
  "sources": ["../src/lib/inflate_stream.min.js", "../src/lib/buzz.js", "../src/lib/pathfinding3D.js", "../src/core/events.ts", "../src/core/library.ts", "../src/core/telnet.ts", "../src/core/ansi.ts", "../src/core/types.ts", "../src/core/settings.ts", "../src/core/profile.ts", "../src/core/input.ts", "../src/lib/rgbcolor.js", "../src/core/parser.ts", "../src/core/display.ts", "../package.json", "../src/plugins/msp.ts", "../src/core/plugin.ts", "../src/plugins/test.ts", "../src/interface/mapdisplay.ts", "../src/core/map.ts", "../src/html/paste.special.htm", "../src/interface/dialog.ts", "../src/interface/menu.ts", "../src/interface/adv.editor.ts", "../src/interface/breadcrumb.ts", "../src/html/settings.menu.htm", "../src/interface/settingsdialog.ts", "../src/interface/splitter.ts", "../src/interface/profilesdialog.search.ts", "../src/interface/profilesdialog.ts", "../src/interface/help.ts", "../src/interface/contextmenu.ts", "../src/interface/interface.ts", "../src/html/mapper.menu.htm", "../src/html/mapper.room.htm", "../src/plugins/mapper.ts", "../src/html/status.htm", "../src/plugins/status.ts", "inline-worker:D:\\Development\\oiMUD\\src\\plugins\\logger.worker.ts", "../src/html/log.header.html", "../src/plugins/logger.ts", "../src/plugins/chat.ts", "../src/plugins/ShadowMUD/backup.ts", "../src/plugins/ShadowMUD/shadowmud.ts", "../src/plugins/panelbar.ts", "../src/core/client.ts"],
  "sourcesContent": ["/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function() {'use strict';var k=void 0,l=!0,aa=this;function s(a,d){var b=a.split(\".\"),c=aa;!(b[0]in c)&&c.execScript&&c.execScript(\"var \"+b[0]);for(var e;b.length&&(e=b.shift());)!b.length&&d!==k?c[e]=d:c=c[e]?c[e]:c[e]={}};var x=\"undefined\"!==typeof Uint8Array&&\"undefined\"!==typeof Uint16Array&&\"undefined\"!==typeof Uint32Array&&\"undefined\"!==typeof DataView;function y(a){var d=a.length,b=0,c=Number.POSITIVE_INFINITY,e,g,f,p,h,q,m,n,r,B;for(n=0;n<d;++n)a[n]>b&&(b=a[n]),a[n]<c&&(c=a[n]);e=1<<b;g=new (x?Uint32Array:Array)(e);f=1;p=0;for(h=2;f<=b;){for(n=0;n<d;++n)if(a[n]===f){q=0;m=p;for(r=0;r<f;++r)q=q<<1|m&1,m>>=1;B=f<<16|n;for(r=q;r<e;r+=h)g[r]=B;++p}++f;p<<=1;h<<=1}return[g,b,c]};function z(a,d,b){this.u=[];this.i=b?b:32768;this.v=0;this.a=d===k?0:d;this.d=this.e=0;this.input=x?new Uint8Array(a):a;this.b=new (x?Uint8Array:Array)(this.i);this.c=0;this.t=this.l=!1;this.f=0;this.status=A}var A=0;\nz.prototype.j=function(a,d){var b=!1;a!==k&&(this.input=a);d!==k&&(this.a=d);for(;!b;)switch(this.status){case A:case 1:var c;var e=k;this.status=1;H(this);if(0>(e=I(this,3)))J(this),c=-1;else{e&1&&(this.l=l);e>>>=1;switch(e){case 0:this.h=0;break;case 1:this.h=1;break;case 2:this.h=2;break;default:throw Error(\"unknown BTYPE: \"+e);}this.status=2;c=k}0>c&&(b=l);break;case 2:case 3:switch(this.h){case 0:var g;var f=k,p=k,h=this.input,q=this.a;this.status=3;if(q+4>=h.length)g=-1;else{f=h[q++]|h[q++]<<\n8;p=h[q++]|h[q++]<<8;if(f===~p)throw Error(\"invalid uncompressed block header: length verify\");this.d=this.e=0;this.a=q;this.m=f;this.status=4;g=k}0>g&&(b=l);break;case 1:this.status=3;this.k=ba;this.n=ca;this.status=4;break;case 2:var m;a:{var n=k,r=k,B=k,V=new (x?Uint8Array:Array)(K.length),W=k;this.status=3;H(this);n=I(this,5)+257;r=I(this,5)+1;B=I(this,4)+4;if(0>n||0>r||0>B)J(this),m=-1;else{try{for(var w=k,D=k,E=0,C=k,u=k,t=k,X=k,t=0;t<B;++t){if(0>(w=I(this,3)))throw Error(\"not enough input\");\nV[K[t]]=w}W=y(V);u=new (x?Uint8Array:Array)(n+r);t=0;for(X=n+r;t<X;){D=O(this,W);if(0>D)throw Error(\"not enough input\");switch(D){case 16:if(0>(w=I(this,2)))throw Error(\"not enough input\");for(C=3+w;C--;)u[t++]=E;break;case 17:if(0>(w=I(this,3)))throw Error(\"not enough input\");for(C=3+w;C--;)u[t++]=0;E=0;break;case 18:if(0>(w=I(this,7)))throw Error(\"not enough input\");for(C=11+w;C--;)u[t++]=0;E=0;break;default:E=u[t++]=D}}new (x?Uint8Array:Array)(n);new (x?Uint8Array:Array)(r);this.k=x?y(u.subarray(0,\nn)):y(u.slice(0,n));this.n=x?y(u.subarray(n)):y(u.slice(n))}catch(pa){J(this);m=-1;break a}this.status=4;m=0}}0>m&&(b=l)}break;case 4:case 5:switch(this.h){case 0:var L;a:{var Y=this.input,F=this.a,M=this.b,G=this.c,N=this.m;for(this.status=5;N--;){G===M.length&&(M=P(this,{o:2}));if(F>=Y.length){this.a=F;this.c=G;this.m=N+1;L=-1;break a}M[G++]=Y[F++]}0>N&&(this.status=6);this.a=F;this.c=G;L=0}0>L&&(b=l);break;case 1:case 2:0>da(this)&&(b=l)}break;case 6:this.l?b=l:this.status=A}var Z,v=this.c,$;Z=\nthis.t?x?new Uint8Array(this.b.subarray(this.f,v)):this.b.slice(this.f,v):x?this.b.subarray(this.f,v):this.b.slice(this.f,v);this.f=v;v>32768+this.i&&(this.c=this.f=32768,x?($=this.b,this.b=new Uint8Array(this.i+32768),this.b.set($.subarray(v-32768,v))):this.b=this.b.slice(v-32768));return Z};\nvar ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=x?new Uint16Array(ea):ea,fa=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ga=x?new Uint16Array(fa):fa,ha=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],ia=x?new Uint8Array(ha):ha,ja=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ka=x?new Uint16Array(ja):ja,la=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,\n11,11,12,12,13,13],ma=x?new Uint8Array(la):la,Q=new (x?Uint8Array:Array)(288),R,na;R=0;for(na=Q.length;R<na;++R)Q[R]=143>=R?8:255>=R?9:279>=R?7:8;var ba=y(Q),S=new (x?Uint8Array:Array)(30),T,oa;T=0;for(oa=S.length;T<oa;++T)S[T]=5;var ca=y(S);function I(a,d){for(var b=a.e,c=a.d,e=a.input,g=a.a,f;c<d;){if(e.length<=g)return-1;f=e[g++];b|=f<<c;c+=8}f=b&(1<<d)-1;a.e=b>>>d;a.d=c-d;a.a=g;return f}\nfunction O(a,d){for(var b=a.e,c=a.d,e=a.input,g=a.a,f=d[0],p=d[1],h,q,m;c<p;){if(e.length<=g)return-1;h=e[g++];b|=h<<c;c+=8}q=f[b&(1<<p)-1];m=q>>>16;if(m>c)throw Error(\"invalid code length: \"+m);a.e=b>>m;a.d=c-m;a.a=g;return q&65535}function H(a){a.s=a.a;a.r=a.d;a.q=a.e}function J(a){a.a=a.s;a.d=a.r;a.e=a.q}\nfunction da(a){var d=a.b,b=a.c,c,e,g,f,p=a.k,h=a.n,q=d.length,m;for(a.status=5;;){H(a);c=O(a,p);if(0>c)return a.c=b,J(a),-1;if(256===c)break;if(256>c)b===q&&(d=P(a),q=d.length),d[b++]=c;else{e=c-257;f=ga[e];if(0<ia[e]){m=I(a,ia[e]);if(0>m)return a.c=b,J(a),-1;f+=m}c=O(a,h);if(0>c)return a.c=b,J(a),-1;g=ka[c];if(0<ma[c]){m=I(a,ma[c]);if(0>m)return a.c=b,J(a),-1;g+=m}b+f>=q&&(d=P(a),q=d.length);for(;f--;)d[b]=d[b++-g];if(a.a===a.input.length)return a.c=b,-1}}for(;8<=a.d;)a.d-=8,a.a--;a.c=b;a.status=\n6}function P(a,d){var b,c=a.input.length/a.a+1|0,e,g,f,p=a.input,h=a.b;d&&(\"number\"===typeof d.o&&(c=d.o),\"number\"===typeof d.p&&(c+=d.p));2>c?(e=(p.length-a.a)/a.k[2],f=258*(e/2)|0,g=f<h.length?h.length+f:h.length<<1):g=h.length*c;x?(b=new Uint8Array(g),b.set(h)):b=h;a.b=b;return a.b};function U(a){this.input=a===k?new (x?Uint8Array:Array):a;this.a=0;this.g=new z(this.input,this.a);this.b=this.g.b}\nU.prototype.j=function(a){var d;if(a!==k)if(x){var b=new Uint8Array(this.input.length+a.length);b.set(this.input,0);b.set(a,this.input.length);this.input=b}else this.input=this.input.concat(a);var c;if(c=this.method===k){var e;var g=this.a,f=this.input,p=f[g++],h=f[g++];if(p===k||h===k)e=-1;else{switch(p&15){case 8:this.method=8;break;default:throw Error(\"unsupported compression method\");}if(0!==((p<<8)+h)%31)throw Error(\"invalid fcheck flag:\"+((p<<8)+h)%31);if(h&32)throw Error(\"fdict flag is not supported\");\nthis.a=g;e=k}c=0>e}if(c)return new (x?Uint8Array:Array);d=this.g.j(this.input,this.a);0!==this.g.a&&(this.input=x?this.input.subarray(this.g.a):this.input.slice(this.g.a),this.a=0);return d};s(\"Zlib.InflateStream\",U);s(\"Zlib.InflateStream.prototype.decompress\",U.prototype.j);}).call(this);\n", " // ----------------------------------------------------------------------------\n // Buzz, a Javascript HTML5 Audio library\n // v1.1.10 - Built 2015-04-20 13:05\n // Licensed under the MIT license.\n // http://buzz.jaysalvat.com/\n // ----------------------------------------------------------------------------\n // Copyright (C) 2010-2015 Jay Salvat\n // http://jaysalvat.com/\n // ----------------------------------------------------------------------------\n\n(function(context, factory) {\n    \"use strict\";\n    if (typeof module !== \"undefined\" && module.exports) {\n        module.exports = factory();\n    } else if (typeof define === \"function\" && define.amd) {\n        define([], factory);\n    } else {\n        context.buzz = factory();\n    }\n})(this, function() {\n    \"use strict\";\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\n    var buzz = {\n        defaults: {\n            autoplay: false,\n            duration: 5e3,\n            formats: [],\n            loop: false,\n            placeholder: \"--\",\n            preload: \"metadata\",\n            volume: 80,\n            webAudioApi: false,\n            document: window.document\n        },\n        types: {\n            mp3: \"audio/mpeg\",\n            ogg: \"audio/ogg\",\n            wav: \"audio/wav\",\n            aac: \"audio/aac\",\n            m4a: \"audio/x-m4a\"\n        },\n        sounds: [],\n        el: document.createElement(\"audio\"),\n        getAudioContext: function() {\n            if (this.audioCtx === undefined) {\n                try {\n                    this.audioCtx = AudioContext ? new AudioContext() : null;\n                } catch (e) {\n                    this.audioCtx = null;\n                }\n            }\n            return this.audioCtx;\n        },\n        sound: function(src, options) {\n            options = options || {};\n            var doc = options.document || buzz.defaults.document;\n            var pid = 0, events = [], eventsOnce = {}, supported = buzz.isSupported();\n            this.load = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.load();\n                return this;\n            };\n            this.play = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.play();\n                return this;\n            };\n            this.togglePlay = function() {\n                if (!supported) {\n                    return this;\n                }\n                if (this.sound.paused) {\n                    this.sound.play();\n                } else {\n                    this.sound.pause();\n                }\n                return this;\n            };\n            this.pause = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.pause();\n                return this;\n            };\n            this.isPaused = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.paused;\n            };\n            this.stop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.setTime(0);\n                this.sound.pause();\n                return this;\n            };\n            this.isEnded = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.ended;\n            };\n            this.loop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.loop = \"loop\";\n                this.bind(\"ended.buzzloop\", function() {\n                    this.currentTime = 0;\n                    this.play();\n                });\n                return this;\n            };\n            this.unloop = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.removeAttribute(\"loop\");\n                this.unbind(\"ended.buzzloop\");\n                return this;\n            };\n            this.mute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = true;\n                return this;\n            };\n            this.unmute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = false;\n                return this;\n            };\n            this.toggleMute = function() {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.muted = !this.sound.muted;\n                return this;\n            };\n            this.isMuted = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.muted;\n            };\n            this.setVolume = function(volume) {\n                if (!supported) {\n                    return this;\n                }\n                if (volume < 0) {\n                    volume = 0;\n                }\n                if (volume > 100) {\n                    volume = 100;\n                }\n                this.volume = volume;\n                this.sound.volume = volume / 100;\n                return this;\n            };\n            this.getVolume = function() {\n                if (!supported) {\n                    return this;\n                }\n                return this.volume;\n            };\n            this.increaseVolume = function(value) {\n                return this.setVolume(this.volume + (value || 1));\n            };\n            this.decreaseVolume = function(value) {\n                return this.setVolume(this.volume - (value || 1));\n            };\n            this.setTime = function(time) {\n                if (!supported) {\n                    return this;\n                }\n                var set = true;\n                this.whenReady(function() {\n                    if (set === true) {\n                        set = false;\n                        this.sound.currentTime = time;\n                    }\n                });\n                return this;\n            };\n            this.getTime = function() {\n                if (!supported) {\n                    return null;\n                }\n                var time = Math.round(this.sound.currentTime * 100) / 100;\n                return isNaN(time) ? buzz.defaults.placeholder : time;\n            };\n            this.setPercent = function(percent) {\n                if (!supported) {\n                    return this;\n                }\n                return this.setTime(buzz.fromPercent(percent, this.sound.duration));\n            };\n            this.getPercent = function() {\n                if (!supported) {\n                    return null;\n                }\n                var percent = Math.round(buzz.toPercent(this.sound.currentTime, this.sound.duration));\n                return isNaN(percent) ? buzz.defaults.placeholder : percent;\n            };\n            this.setSpeed = function(duration) {\n                if (!supported) {\n                    return this;\n                }\n                this.sound.playbackRate = duration;\n                return this;\n            };\n            this.getSpeed = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.playbackRate;\n            };\n            this.getDuration = function() {\n                if (!supported) {\n                    return null;\n                }\n                var duration = Math.round(this.sound.duration * 100) / 100;\n                return isNaN(duration) ? buzz.defaults.placeholder : duration;\n            };\n            this.getPlayed = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.played);\n            };\n            this.getBuffered = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.buffered);\n            };\n            this.getSeekable = function() {\n                if (!supported) {\n                    return null;\n                }\n                return timerangeToArray(this.sound.seekable);\n            };\n            this.getErrorCode = function() {\n                if (supported && this.sound.error) {\n                    return this.sound.error.code;\n                }\n                return 0;\n            };\n            this.getErrorMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getErrorCode()) {\n                  case 1:\n                    return \"MEDIA_ERR_ABORTED\";\n\n                  case 2:\n                    return \"MEDIA_ERR_NETWORK\";\n\n                  case 3:\n                    return \"MEDIA_ERR_DECODE\";\n\n                  case 4:\n                    return \"MEDIA_ERR_SRC_NOT_SUPPORTED\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.getStateCode = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.readyState;\n            };\n            this.getStateMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getStateCode()) {\n                  case 0:\n                    return \"HAVE_NOTHING\";\n\n                  case 1:\n                    return \"HAVE_METADATA\";\n\n                  case 2:\n                    return \"HAVE_CURRENT_DATA\";\n\n                  case 3:\n                    return \"HAVE_FUTURE_DATA\";\n\n                  case 4:\n                    return \"HAVE_ENOUGH_DATA\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.getNetworkStateCode = function() {\n                if (!supported) {\n                    return null;\n                }\n                return this.sound.networkState;\n            };\n            this.getNetworkStateMessage = function() {\n                if (!supported) {\n                    return null;\n                }\n                switch (this.getNetworkStateCode()) {\n                  case 0:\n                    return \"NETWORK_EMPTY\";\n\n                  case 1:\n                    return \"NETWORK_IDLE\";\n\n                  case 2:\n                    return \"NETWORK_LOADING\";\n\n                  case 3:\n                    return \"NETWORK_NO_SOURCE\";\n\n                  default:\n                    return null;\n                }\n            };\n            this.set = function(key, value) {\n                if (!supported) {\n                    return this;\n                }\n                this.sound[key] = value;\n                return this;\n            };\n            this.get = function(key) {\n                if (!supported) {\n                    return null;\n                }\n                return key ? this.sound[key] : this.sound;\n            };\n            this.bind = function(types, func) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                var self = this, efunc = function(e) {\n                    func.call(self, e);\n                };\n                for (var t = 0; t < types.length; t++) {\n                    var type = types[t], idx = type;\n                    type = idx.split(\".\")[0];\n                    events.push({\n                        idx: idx,\n                        func: efunc\n                    });\n                    this.sound.addEventListener(type, efunc, true);\n                }\n                return this;\n            };\n            this.unbind = function(types) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                for (var t = 0; t < types.length; t++) {\n                    var idx = types[t], type = idx.split(\".\")[0];\n                    for (var i = 0; i < events.length; i++) {\n                        var namespace = events[i].idx.split(\".\");\n                        if (events[i].idx === idx || namespace[1] && namespace[1] === idx.replace(\".\", \"\")) {\n                            this.sound.removeEventListener(type, events[i].func, true);\n                            events.splice(i, 1);\n                        }\n                    }\n                }\n                return this;\n            };\n            this.bindOnce = function(type, func) {\n                if (!supported) {\n                    return this;\n                }\n                var self = this;\n                eventsOnce[pid++] = false;\n                this.bind(type + \".\" + pid, function() {\n                    if (!eventsOnce[pid]) {\n                        eventsOnce[pid] = true;\n                        func.call(self);\n                    }\n                    self.unbind(type + \".\" + pid);\n                });\n                return this;\n            };\n            this.trigger = function(types, detail) {\n                if (!supported) {\n                    return this;\n                }\n                types = types.split(\" \");\n                for (var t = 0; t < types.length; t++) {\n                    var idx = types[t];\n                    for (var i = 0; i < events.length; i++) {\n                        var eventType = events[i].idx.split(\".\");\n                        if (events[i].idx === idx || eventType[0] && eventType[0] === idx.replace(\".\", \"\")) {\n                            var evt = doc.createEvent(\"HTMLEvents\");\n                            evt.initEvent(eventType[0], false, true);\n                            evt.originalEvent = detail;\n                            this.sound.dispatchEvent(evt);\n                        }\n                    }\n                }\n                return this;\n            };\n            this.fadeTo = function(to, duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                if (duration instanceof Function) {\n                    callback = duration;\n                    duration = buzz.defaults.duration;\n                } else {\n                    duration = duration || buzz.defaults.duration;\n                }\n                var from = this.volume, delay = duration / Math.abs(from - to), self = this;\n                this.play();\n                function doFade() {\n                    setTimeout(function() {\n                        if (from < to && self.volume < to) {\n                            self.setVolume(self.volume += 1);\n                            doFade();\n                        } else if (from > to && self.volume > to) {\n                            self.setVolume(self.volume -= 1);\n                            doFade();\n                        } else if (callback instanceof Function) {\n                            callback.apply(self);\n                        }\n                    }, delay);\n                }\n                this.whenReady(function() {\n                    doFade();\n                });\n                return this;\n            };\n            this.fadeIn = function(duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                return this.setVolume(0).fadeTo(100, duration, callback);\n            };\n            this.fadeOut = function(duration, callback) {\n                if (!supported) {\n                    return this;\n                }\n                return this.fadeTo(0, duration, callback);\n            };\n            this.fadeWith = function(sound, duration) {\n                if (!supported) {\n                    return this;\n                }\n                this.fadeOut(duration, function() {\n                    this.stop();\n                });\n                sound.play().fadeIn(duration);\n                return this;\n            };\n            this.whenReady = function(func) {\n                if (!supported) {\n                    return null;\n                }\n                var self = this;\n                if (this.sound.readyState === 0) {\n                    this.bind(\"canplay.buzzwhenready\", function() {\n                        func.call(self);\n                    });\n                } else {\n                    func.call(self);\n                }\n            };\n            this.addSource = function(src) {\n                var self = this, source = doc.createElement(\"source\");\n                source.src = src;\n                if (buzz.types[getExt(src)]) {\n                    source.type = buzz.types[getExt(src)];\n                }\n                this.sound.appendChild(source);\n                source.addEventListener(\"error\", function(e) {\n                    self.trigger(\"sourceerror\", e);\n                });\n                return source;\n            };\n            function timerangeToArray(timeRange) {\n                var array = [], length = timeRange.length - 1;\n                for (var i = 0; i <= length; i++) {\n                    array.push({\n                        start: timeRange.start(i),\n                        end: timeRange.end(i)\n                    });\n                }\n                return array;\n            }\n            function getExt(filename) {\n                return filename.split(\".\").pop();\n            }\n            if (supported && src) {\n                for (var i in buzz.defaults) {\n                    if (buzz.defaults.hasOwnProperty(i)) {\n                        if (options[i] === undefined) {\n                            options[i] = buzz.defaults[i];\n                        }\n                    }\n                }\n                this.sound = doc.createElement(\"audio\");\n                if (options.webAudioApi) {\n                    var audioCtx = buzz.getAudioContext();\n                    if (audioCtx) {\n                        this.source = audioCtx.createMediaElementSource(this.sound);\n                        this.source.connect(audioCtx.destination);\n                    }\n                }\n                if (src instanceof Array) {\n                    for (var j in src) {\n                        if (src.hasOwnProperty(j)) {\n                            this.addSource(src[j]);\n                        }\n                    }\n                } else if (options.formats.length) {\n                    for (var k in options.formats) {\n                        if (options.formats.hasOwnProperty(k)) {\n                            this.addSource(src + \".\" + options.formats[k]);\n                        }\n                    }\n                } else {\n                    this.addSource(src);\n                }\n                if (options.loop) {\n                    this.loop();\n                }\n                if (options.autoplay) {\n                    this.sound.autoplay = \"autoplay\";\n                }\n                if (options.preload === true) {\n                    this.sound.preload = \"auto\";\n                } else if (options.preload === false) {\n                    this.sound.preload = \"none\";\n                } else {\n                    this.sound.preload = options.preload;\n                }\n                this.setVolume(options.volume);\n                buzz.sounds.push(this);\n            }\n        },\n        group: function(sounds) {\n            sounds = argsToArray(sounds, arguments);\n            this.getSounds = function() {\n                return sounds;\n            };\n            this.add = function(soundArray) {\n                soundArray = argsToArray(soundArray, arguments);\n                for (var a = 0; a < soundArray.length; a++) {\n                    sounds.push(soundArray[a]);\n                }\n            };\n            this.remove = function(soundArray) {\n                soundArray = argsToArray(soundArray, arguments);\n                for (var a = 0; a < soundArray.length; a++) {\n                    for (var i = 0; i < sounds.length; i++) {\n                        if (sounds[i] === soundArray[a]) {\n                            sounds.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n            };\n            this.load = function() {\n                fn(\"load\");\n                return this;\n            };\n            this.play = function() {\n                fn(\"play\");\n                return this;\n            };\n            this.togglePlay = function() {\n                fn(\"togglePlay\");\n                return this;\n            };\n            this.pause = function(time) {\n                fn(\"pause\", time);\n                return this;\n            };\n            this.stop = function() {\n                fn(\"stop\");\n                return this;\n            };\n            this.mute = function() {\n                fn(\"mute\");\n                return this;\n            };\n            this.unmute = function() {\n                fn(\"unmute\");\n                return this;\n            };\n            this.toggleMute = function() {\n                fn(\"toggleMute\");\n                return this;\n            };\n            this.setVolume = function(volume) {\n                fn(\"setVolume\", volume);\n                return this;\n            };\n            this.increaseVolume = function(value) {\n                fn(\"increaseVolume\", value);\n                return this;\n            };\n            this.decreaseVolume = function(value) {\n                fn(\"decreaseVolume\", value);\n                return this;\n            };\n            this.loop = function() {\n                fn(\"loop\");\n                return this;\n            };\n            this.unloop = function() {\n                fn(\"unloop\");\n                return this;\n            };\n            this.setSpeed = function(speed) {\n                fn(\"setSpeed\", speed);\n                return this;\n            };\n            this.setTime = function(time) {\n                fn(\"setTime\", time);\n                return this;\n            };\n            this.set = function(key, value) {\n                fn(\"set\", key, value);\n                return this;\n            };\n            this.bind = function(type, func) {\n                fn(\"bind\", type, func);\n                return this;\n            };\n            this.unbind = function(type) {\n                fn(\"unbind\", type);\n                return this;\n            };\n            this.bindOnce = function(type, func) {\n                fn(\"bindOnce\", type, func);\n                return this;\n            };\n            this.trigger = function(type) {\n                fn(\"trigger\", type);\n                return this;\n            };\n            this.fade = function(from, to, duration, callback) {\n                fn(\"fade\", from, to, duration, callback);\n                return this;\n            };\n            this.fadeIn = function(duration, callback) {\n                fn(\"fadeIn\", duration, callback);\n                return this;\n            };\n            this.fadeOut = function(duration, callback) {\n                fn(\"fadeOut\", duration, callback);\n                return this;\n            };\n            function fn() {\n                var args = argsToArray(null, arguments), func = args.shift();\n                for (var i = 0; i < sounds.length; i++) {\n                    sounds[i][func].apply(sounds[i], args);\n                }\n            }\n            function argsToArray(array, args) {\n                return array instanceof Array ? array : Array.prototype.slice.call(args);\n            }\n        },\n        all: function() {\n            return new buzz.group(buzz.sounds);\n        },\n        isSupported: function() {\n            return !!buzz.el.canPlayType;\n        },\n        isOGGSupported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType('audio/ogg; codecs=\"vorbis\"');\n        },\n        isWAVSupported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType('audio/wav; codecs=\"1\"');\n        },\n        isMP3Supported: function() {\n            return !!buzz.el.canPlayType && buzz.el.canPlayType(\"audio/mpeg;\");\n        },\n        isAACSupported: function() {\n            return !!buzz.el.canPlayType && (buzz.el.canPlayType(\"audio/x-m4a;\") || buzz.el.canPlayType(\"audio/aac;\"));\n        },\n        toTimer: function(time, withHours) {\n            var h, m, s;\n            h = Math.floor(time / 3600);\n            h = isNaN(h) ? \"--\" : h >= 10 ? h : \"0\" + h;\n            m = withHours ? Math.floor(time / 60 % 60) : Math.floor(time / 60);\n            m = isNaN(m) ? \"--\" : m >= 10 ? m : \"0\" + m;\n            s = Math.floor(time % 60);\n            s = isNaN(s) ? \"--\" : s >= 10 ? s : \"0\" + s;\n            return withHours ? h + \":\" + m + \":\" + s : m + \":\" + s;\n        },\n        fromTimer: function(time) {\n            var splits = time.toString().split(\":\");\n            if (splits && splits.length === 3) {\n                time = parseInt(splits[0], 10) * 3600 + parseInt(splits[1], 10) * 60 + parseInt(splits[2], 10);\n            }\n            if (splits && splits.length === 2) {\n                time = parseInt(splits[0], 10) * 60 + parseInt(splits[1], 10);\n            }\n            return time;\n        },\n        toPercent: function(value, total, decimal) {\n            var r = Math.pow(10, decimal || 0);\n            return Math.round(value * 100 / total * r) / r;\n        },\n        fromPercent: function(percent, total, decimal) {\n            var r = Math.pow(10, decimal || 0);\n            return Math.round(total / 100 * percent * r) / r;\n        }\n    };\n    return buzz;\n});", "/**\n *    ____       _   _     _____ _           _ _                _         \n *   |  _ \\ __ _| |_| |__ |  ___(_)_ __   __| (_)_ __   __ _   (_)___     \n *   | |_) / _` | __| '_ \\| |_  | | '_ \\ / _` | | '_ \\ / _` |  | / __|    \n *   |  __/ (_| | |_| | | |  _| | | | | | (_| | | | | | (_| |_ | \\__ \\    \n *   |_|   \\__,_|\\__|_| |_|_|   |_|_| |_|\\__,_|_|_| |_|\\__, (_)/ |___/    \n *                                                     |___/ |__/         \n *   https://github.com/qiao/PathFinding.js\n */\n(function (e) {\n    if (\"function\" == typeof bootstrap) bootstrap(\"pf\", e);\n    else if (\"object\" == typeof exports) module.exports = e();\n    else if (\"function\" == typeof define && define.amd) define(e);\n    else if (\"undefined\" != typeof ses) {\n        if (!ses.ok()) return;\n        ses.makePF = e\n    }\n    else \"undefined\" != typeof window ? window.PF = e() : global.PF = e();\n})(function () {\n    var define, ses, bootstrap, module, exports;\n    return (function (e, t, n) { function i(n, s) { if (!t[n]) { if (!e[n]) { var o = typeof require == \"function\" && require; if (!s && o) return o(n, !0); if (r) return r(n, !0); throw new Error(\"Cannot find module '\" + n + \"'\") } var u = t[n] = { exports: {} }; e[n][0].call(u.exports, function (t) { var r = e[n][1][t]; return i(r ? r : t) }, u, u.exports) } return t[n].exports } var r = typeof require == \"function\" && require; for (var s = 0; s < n.length; s++)i(n[s]); return i })({\n        1: [function (require, module, exports) {\n            module.exports = require('./lib/heap');\n\n        }, { \"./lib/heap\": 2 }], 2: [function (require, module, exports) {\n            // Generated by CoffeeScript 1.6.3\n            (function () {\n                var Heap, defaultCmp, floor, heapify, heappop, heappush, heappushpop, heapreplace, insort, min, nlargest, nsmallest, updateItem, _siftdown, _siftup;\n\n                floor = Math.floor, min = Math.min;\n\n                /* \n                Default comparison function to be used\n                */\n\n\n                defaultCmp = function (x, y) {\n                    if (x < y) {\n                        return -1;\n                    }\n                    if (x > y) {\n                        return 1;\n                    }\n                    return 0;\n                };\n\n                /* \n                Insert item x in list a, and keep it sorted assuming a is sorted.\n                \n                If x is already in a, insert it to the right of the rightmost x.\n                \n                Optional args lo (default 0) and hi (default a.length) bound the slice\n                of a to be searched.\n                */\n\n\n                insort = function (a, x, lo, hi, cmp) {\n                    var mid;\n                    if (lo == null) {\n                        lo = 0;\n                    }\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (lo < 0) {\n                        throw new Error('lo must be non-negative');\n                    }\n                    if (hi == null) {\n                        hi = a.length;\n                    }\n                    while (lo < hi) {\n                        mid = floor((lo + hi) / 2);\n                        if (cmp(x, a[mid]) < 0) {\n                            hi = mid;\n                        } else {\n                            lo = mid + 1;\n                        }\n                    }\n                    return ([].splice.apply(a, [lo, lo - lo].concat(x)), x);\n                };\n\n                /*\n                Push item onto heap, maintaining the heap invariant.\n                */\n\n\n                heappush = function (array, item, cmp) {\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    array.push(item);\n                    return _siftdown(array, 0, array.length - 1, cmp);\n                };\n\n                /*\n                Pop the smallest item off the heap, maintaining the heap invariant.\n                */\n\n\n                heappop = function (array, cmp) {\n                    var lastelt, returnitem;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    lastelt = array.pop();\n                    if (array.length) {\n                        returnitem = array[0];\n                        array[0] = lastelt;\n                        _siftup(array, 0, cmp);\n                    } else {\n                        returnitem = lastelt;\n                    }\n                    return returnitem;\n                };\n\n                /*\n                Pop and return the current smallest value, and add the new item.\n                \n                This is more efficient than heappop() followed by heappush(), and can be \n                more appropriate when using a fixed size heap. Note that the value\n                returned may be larger than item! That constrains reasonable use of\n                this routine unless written as part of a conditional replacement:\n                    if item > array[0]\n                      item = heapreplace(array, item)\n                */\n\n\n                heapreplace = function (array, item, cmp) {\n                    var returnitem;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    returnitem = array[0];\n                    array[0] = item;\n                    _siftup(array, 0, cmp);\n                    return returnitem;\n                };\n\n                /*\n                Fast version of a heappush followed by a heappop.\n                */\n\n\n                heappushpop = function (array, item, cmp) {\n                    var _ref;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (array.length && cmp(array[0], item) < 0) {\n                        _ref = [array[0], item], item = _ref[0], array[0] = _ref[1];\n                        _siftup(array, 0, cmp);\n                    }\n                    return item;\n                };\n\n                /*\n                Transform list into a heap, in-place, in O(array.length) time.\n                */\n\n\n                heapify = function (array, cmp) {\n                    var i, _i, _j, _len, _ref, _ref1, _results, _results1;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    _ref1 = (function () {\n                        _results1 = [];\n                        for (var _j = 0, _ref = floor(array.length / 2); 0 <= _ref ? _j < _ref : _j > _ref; 0 <= _ref ? _j++ : _j--) { _results1.push(_j); }\n                        return _results1;\n                    }).apply(this).reverse();\n                    _results = [];\n                    for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n                        i = _ref1[_i];\n                        _results.push(_siftup(array, i, cmp));\n                    }\n                    return _results;\n                };\n\n                /*\n                Update the position of the given item in the heap.\n                This function should be called every time the item is being modified.\n                */\n\n\n                updateItem = function (array, item, cmp) {\n                    var pos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    pos = array.indexOf(item);\n                    if (pos === -1) {\n                        return;\n                    }\n                    _siftdown(array, 0, pos, cmp);\n                    return _siftup(array, pos, cmp);\n                };\n\n                /*\n                Find the n largest elements in a dataset.\n                */\n\n\n                nlargest = function (array, n, cmp) {\n                    var elem, result, _i, _len, _ref;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    result = array.slice(0, n);\n                    if (!result.length) {\n                        return result;\n                    }\n                    heapify(result, cmp);\n                    _ref = array.slice(n);\n                    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                        elem = _ref[_i];\n                        heappushpop(result, elem, cmp);\n                    }\n                    return result.sort(cmp).reverse();\n                };\n\n                /*\n                Find the n smallest elements in a dataset.\n                */\n\n\n                nsmallest = function (array, n, cmp) {\n                    var elem, i, los, result, _i, _j, _len, _ref, _ref1, _results;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    if (n * 10 <= array.length) {\n                        result = array.slice(0, n).sort(cmp);\n                        if (!result.length) {\n                            return result;\n                        }\n                        los = result[result.length - 1];\n                        _ref = array.slice(n);\n                        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n                            elem = _ref[_i];\n                            if (cmp(elem, los) < 0) {\n                                insort(result, elem, 0, null, cmp);\n                                result.pop();\n                                los = result[result.length - 1];\n                            }\n                        }\n                        return result;\n                    }\n                    heapify(array, cmp);\n                    _results = [];\n                    for (i = _j = 0, _ref1 = min(n, array.length); 0 <= _ref1 ? _j < _ref1 : _j > _ref1; i = 0 <= _ref1 ? ++_j : --_j) {\n                        _results.push(heappop(array, cmp));\n                    }\n                    return _results;\n                };\n\n                _siftdown = function (array, startpos, pos, cmp) {\n                    var newitem, parent, parentpos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    newitem = array[pos];\n                    while (pos > startpos) {\n                        parentpos = (pos - 1) >> 1;\n                        parent = array[parentpos];\n                        if (cmp(newitem, parent) < 0) {\n                            array[pos] = parent;\n                            pos = parentpos;\n                            continue;\n                        }\n                        break;\n                    }\n                    return array[pos] = newitem;\n                };\n\n                _siftup = function (array, pos, cmp) {\n                    var childpos, endpos, newitem, rightpos, startpos;\n                    if (cmp == null) {\n                        cmp = defaultCmp;\n                    }\n                    endpos = array.length;\n                    startpos = pos;\n                    newitem = array[pos];\n                    childpos = 2 * pos + 1;\n                    while (childpos < endpos) {\n                        rightpos = childpos + 1;\n                        if (rightpos < endpos && !(cmp(array[childpos], array[rightpos]) < 0)) {\n                            childpos = rightpos;\n                        }\n                        array[pos] = array[childpos];\n                        pos = childpos;\n                        childpos = 2 * pos + 1;\n                    }\n                    array[pos] = newitem;\n                    return _siftdown(array, startpos, pos, cmp);\n                };\n\n                Heap = (function () {\n                    Heap.push = heappush;\n\n                    Heap.pop = heappop;\n\n                    Heap.replace = heapreplace;\n\n                    Heap.pushpop = heappushpop;\n\n                    Heap.heapify = heapify;\n\n                    Heap.nlargest = nlargest;\n\n                    Heap.nsmallest = nsmallest;\n\n                    function Heap(cmp) {\n                        this.cmp = cmp != null ? cmp : defaultCmp;\n                        this.nodes = [];\n                    }\n\n                    Heap.prototype.push = function (x) {\n                        return heappush(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.pop = function () {\n                        return heappop(this.nodes, this.cmp);\n                    };\n\n                    Heap.prototype.peek = function () {\n                        return this.nodes[0];\n                    };\n\n                    Heap.prototype.contains = function (x) {\n                        return this.nodes.indexOf(x) !== -1;\n                    };\n\n                    Heap.prototype.replace = function (x) {\n                        return heapreplace(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.pushpop = function (x) {\n                        return heappushpop(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.heapify = function () {\n                        return heapify(this.nodes, this.cmp);\n                    };\n\n                    Heap.prototype.updateItem = function (x) {\n                        return updateItem(this.nodes, x, this.cmp);\n                    };\n\n                    Heap.prototype.clear = function () {\n                        return this.nodes = [];\n                    };\n\n                    Heap.prototype.empty = function () {\n                        return this.nodes.length === 0;\n                    };\n\n                    Heap.prototype.size = function () {\n                        return this.nodes.length;\n                    };\n\n                    Heap.prototype.clone = function () {\n                        var heap;\n                        heap = new Heap();\n                        heap.nodes = this.nodes.slice(0);\n                        return heap;\n                    };\n\n                    Heap.prototype.toArray = function () {\n                        return this.nodes.slice(0);\n                    };\n\n                    Heap.prototype.insert = Heap.prototype.push;\n\n                    Heap.prototype.remove = Heap.prototype.pop;\n\n                    Heap.prototype.top = Heap.prototype.peek;\n\n                    Heap.prototype.front = Heap.prototype.peek;\n\n                    Heap.prototype.has = Heap.prototype.contains;\n\n                    Heap.prototype.copy = Heap.prototype.clone;\n\n                    return Heap;\n\n                })();\n\n                if (typeof module !== \"undefined\" && module !== null ? module.exports : void 0) {\n                    module.exports = Heap;\n                } else {\n                    window.Heap = Heap;\n                }\n\n            }).call(this);\n\n        }, {}], 3: [function (require, module, exports) {\n            module.exports = {\n                'Heap': require('heap'),\n                'Node': require('./core/Node'),\n                'Grid': require('./core/Grid'),\n                'Util': require('./core/Util'),\n                'Heuristic': require('./core/Heuristic'),\n                'AStarFinder': require('./finders/AStarFinder'),\n                'BestFirstFinder': require('./finders/BestFirstFinder'),\n                'BreadthFirstFinder': require('./finders/BreadthFirstFinder'),\n                'DijkstraFinder': require('./finders/DijkstraFinder'),\n                'BiAStarFinder': require('./finders/BiAStarFinder'),\n                'BiBestFirstFinder': require('./finders/BiBestFirstFinder'),\n                'BiBreadthFirstFinder': require('./finders/BiBreadthFirstFinder'),\n                'BiDijkstraFinder': require('./finders/BiDijkstraFinder'),\n                'JumpPointFinder': require('./finders/JumpPointFinder'),\n                'IDAStarFinder': require('./finders/IDAStarFinder')\n            };\n\n        }, { \"./core/Grid\": 4, \"./core/Heuristic\": 5, \"./core/Node\": 6, \"./core/Util\": 7, \"./finders/AStarFinder\": 8, \"./finders/BestFirstFinder\": 9, \"./finders/BiAStarFinder\": 10, \"./finders/BiBestFirstFinder\": 11, \"./finders/BiBreadthFirstFinder\": 12, \"./finders/BiDijkstraFinder\": 13, \"./finders/BreadthFirstFinder\": 14, \"./finders/DijkstraFinder\": 15, \"./finders/IDAStarFinder\": 16, \"./finders/JumpPointFinder\": 17, \"heap\": 1 }], 4: [function (require, module, exports) {\n            var Node = require('./Node');\n\n            /**\n             * The Grid class, which serves as the encapsulation of the layout of the nodes.\n             * @constructor\n             * @param {number} width Number of columns of the grid.\n             * @param {number} height Number of rows of the grid.\n             * @param {Array.<Array.<(number|boolean)>>} [matrix] - A 0-1 matrix\n             *     representing the walkable status of the nodes(0 or false for walkable).\n             *     If the matrix is not supplied, all the nodes will be walkable.  */\n            function Grid(width, height, depth, matrix) {\n                /**\n                 * The number of columns of the grid.\n                 * @type number\n                 */\n                this.width = width;\n                /**\n                 * The number of rows of the grid.\n                 * @type number\n                 */\n                this.height = height;\n\n                this.depth = depth;\n\n\n                /**\n                 * A 2D array of nodes.\n                 */\n                this.nodes = this._buildNodes(width, height, depth, matrix);\n            }\n\n            /**\n             * Build and return the nodes.\n             * @private\n             * @param {number} width\n             * @param {number} height\n             * @param {Array.<Array.<number|boolean>>} [matrix] - A 0-1 matrix representing\n             *     the walkable status of the nodes.\n             * @see Grid\n             */\n            Grid.prototype._buildNodes = function (width, height, depth, matrix) {\n                var i, j, z,\n                    nodes = new Array(height),\n                    row;\n\n                for (i = 0; i < height; ++i) {\n                    nodes[i] = new Array(width);\n                    for (j = 0; j < width; ++j) {\n                        nodes[i][j] = new Array(depth);\n                        for (z = 0; z < depth; ++z) {\n                            nodes[i][j][z] = new Node(j, i, z);\n                        }\n                    }\n                }\n\n\n                if (matrix === undefined) {\n                    return nodes;\n                }\n\n                if (matrix.length !== height || matrix[0].length !== width) {\n                    throw new Error('Matrix size does not fit');\n                }\n\n                for (i = 0; i < height; ++i) {\n                    for (j = 0; j < width; ++j) {\n                        for (z = 0; z < depth; ++z) {\n                            nodes[i][j][z].walkable = matrix[i][j][z];\n                        }\n                    }\n                }\n\n                return nodes;\n            };\n\n\n            Grid.prototype.getNodeAt = function (x, y, z) {\n                return this.nodes[y][x][z];\n            };\n\n\n            /**\n             * Determine whether the node at the given position is walkable.\n             * (Also returns false if the position is outside the grid.)\n             * @param {number} x - The x coordinate of the node.\n             * @param {number} y - The y coordinate of the node.\n             * @param {number} z - The z coordinate of the node.\n             * @return {boolean} - The walkability of the node.\n             */\n\n            /*\n               public enum RoomExits\n               {\n                   Unknown = 4096,    \n                   Out = 2048,\n                   Enter = 1024,                       \n                   Up = 512,\n                   Down = 256,\n                   North = 128,\n                   NorthEast = 64,\n                   East = 32,\n                   SouthEast = 16,\n                   South = 8,\n                   SouthWest = 4,\n                   West = 2,\n                   NorthWest = 1,\n                   None = 0,\n                   //Directional = North | NorthEast | NorthWest | South | SouthEast | SouthWest | West | East,\n                   //All = Directional | Up | Down\n               }\n            */\n            Grid.prototype.isWalkableAt = function (x, y, z, d) {\n                return this.isInside(x, y, z) && (this.nodes[y][x][z].walkable & d) == d;\n            };\n\n\n            /**\n             * Determine whether the position is inside the grid.\n             * XXX: `grid.isInside(x, y, z)` is wierd to read.\n             * It should be `(x, y, z) is inside grid`, but I failed to find a better\n             * name for this method.\n             * @param {number} x\n             * @param {number} y\n             * @param {number} z\n             * @return {boolean}\n             */\n            Grid.prototype.isInside = function (x, y, z) {\n                return (x >= 0 && x < this.width) && (y >= 0 && y < this.height) && (z >= 0 && z < this.depth);\n            };\n\n\n            /**\n             * Set whether the node on the given position is walkable.\n             * NOTE: throws exception if the coordinate is not inside the grid.\n             * @param {number} x - The x coordinate of the node.\n             * @param {number} y - The y coordinate of the node.\n             * @param {number} z - The z coordinate of the node.\n             * @param {boolean} walkable - Whether the position is walkable.\n             */\n            Grid.prototype.setWalkableAt = function (x, y, z, walkable) {\n                this.nodes[y][x][z].walkable = walkable;\n            };\n\n\n            /**\n             * Get the neighbors of the given node.\n             *\n             *     offsets      diagonalOffsets:\n             *  +---+---+---+    +---+---+---+\n             *  |   | 0 |   |    | 0 |   | 1 |\n             *  +---+---+---+    +---+---+---+\n             *  | 3 |   | 1 |    |   |   |   |\n             *  +---+---+---+    +---+---+---+\n             *  |   | 2 |   |    | 3 |   | 2 |\n             *  +---+---+---+    +---+---+---+\n             *\n             *  When allowDiagonal is true, if offsets[i] is valid, then\n             *  diagonalOffsets[i] and\n             *  diagonalOffsets[(i + 1) % 4] is valid.\n             * @param {Node} node\n             * @param {boolean} allowDiagonal\n             * @param {boolean} dontCrossCorners\n             */\n            Grid.prototype.getNeighbors = function (node, allowDiagonal, dontCrossCorners) {\n                var x = node.x,\n                    y = node.y,\n                    z = node.z,\n                    neighbors = [],\n                    s0 = false, d0 = false,\n                    s1 = false, d1 = false,\n                    s2 = false, d2 = false,\n                    s3 = false, d3 = false,\n                    s4 = false,\n                    s5 = false,\n                    nodes = this.nodes;\n\n                // \u2191\n                if (this.isWalkableAt(x, y, z, 128) && this.isInside(x, y - 1, z, 8)) {\n                    neighbors.push(nodes[y - 1][x][z]);\n                    s0 = true;\n                }\n                // \u2192\n                if (this.isWalkableAt(x, y, z, 32) && this.isInside(x + 1, y, z, 2)) {\n                    neighbors.push(nodes[y][x + 1][z]);\n                    s1 = true;\n                }\n                // \u2193\n                if (this.isWalkableAt(x, y, z, 8) && this.isInside(x, y + 1, z, 128)) {\n                    neighbors.push(nodes[y + 1][x][z]);\n                    s2 = true;\n                }\n                // \u2190\n                if (this.isWalkableAt(x, y, z, 2) && this.isInside(x - 1, y, z, 32)) {\n                    neighbors.push(nodes[y][x - 1][z]);\n                    s3 = true;\n                }\n                //up\n                if (this.isWalkableAt(x, y, z, 512) && this.isInside(x, y, z + 1, 256)) {\n                    neighbors.push(nodes[y][x][z + 1]);\n                    s4 = true;\n                }\n                //down\n                if (this.isWalkableAt(x, y, z, 256) && this.isInside(x, y, z - 1, 512)) {\n                    neighbors.push(nodes[y][x][z - 1]);\n                    s5 = true;\n                }\n\n\n                if (!allowDiagonal) {\n                    return neighbors;\n                }\n\n                if (dontCrossCorners) {\n                    d0 = s3 && s0;\n                    d1 = s0 && s1;\n                    d2 = s1 && s2;\n                    d3 = s2 && s3;\n                } else {\n                    d0 = s3 || s0 || true;\n                    d1 = s0 || s1 || true;\n                    d2 = s1 || s2 || true;\n                    d3 = s2 || s3 || true;\n                }\n\n                // \u2196 nw\n                if (d0 && this.isWalkableAt(x, y, z, 1) && this.isInside(x - 1, y - 1, z, 16)) {\n                    neighbors.push(nodes[y - 1][x - 1][z]);\n                }\n                // \u2197 ne\n                if (d1 && this.isWalkableAt(x, y, z, 64) && this.isInside(x + 1, y - 1, z, 4)) {\n                    neighbors.push(nodes[y - 1][x + 1][z]);\n                }\n                // \u2198 se\n                if (d2 && this.isWalkableAt(x, y, z, 16) && this.isInside(x + 1, y + 1, z, 1)) {\n                    neighbors.push(nodes[y + 1][x + 1][z]);\n                }\n                // \u2199 sw\n                if (d3 && this.isWalkableAt(x, y, z, 4) && this.isInside(x - 1, y + 1, z, 64)) {\n                    neighbors.push(nodes[y + 1][x - 1][z]);\n                }\n\n                return neighbors;\n            };\n\n\n            /**\n             * Get a clone of this grid.\n             * @return {Grid} Cloned grid.\n             */\n            Grid.prototype.clone = function () {\n                var i, j,\n\n                    width = this.width,\n                    height = this.height,\n                    depth = this.depth,\n                    thisNodes = this.nodes,\n\n                    newGrid = new Grid(width, height, depth),\n                    newNodes = new Array(height),\n                    row;\n\n                for (i = 0; i < height; ++i) {\n                    newNodes[i] = new Array(width);\n                    for (j = 0; j < width; ++j) {\n                        newNodes[i][j] = new Array(depth);\n                        for (z = 0; z < depth; ++z) {\n                            newNodes[i][j][z] = new Node(j, i, z, thisNodes[i][j][z].walkable);\n                        }\n                    }\n                }\n\n                newGrid.nodes = newNodes;\n\n                return newGrid;\n            };\n\n            module.exports = Grid;\n\n        }, { \"./Node\": 6 }], 5: [function (require, module, exports) {\n            /**\n             * @namespace PF.Heuristic\n             * @description A collection of heuristic functions.\n             */\n            module.exports = {\n\n                /**\n                 * Manhattan distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} dx + dy\n                 */\n                manhattan: function (dx, dy, dz) {\n                    return dx + dy + dz;\n                },\n\n                /**\n                 * Euclidean distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} sqrt(dx * dx + dy * dy)\n                 */\n                euclidean: function (dx, dy, dz) {\n                    return Math.sqrt(dx * dx + dy * dy + dz * dz);\n                },\n\n                /**\n                 * Chebyshev distance.\n                 * @param {number} dx - Difference in x.\n                 * @param {number} dy - Difference in y.\n                 * @return {number} max(dx, dy)\n                 */\n                chebyshev: function (dx, dy, dz) {\n                    return Math.max(dx, dy, dz);\n                }\n\n            };\n\n        }, {}], 6: [function (require, module, exports) {\n            /**\n             * A node in grid. \n             * This class holds some basic information about a node and custom \n             * attributes may be added, depending on the algorithms' needs.\n             * @constructor\n             * @param {number} x - The x coordinate of the node on the grid.\n             * @param {number} y - The y coordinate of the node on the grid.\n             * @param {boolean} [walkable] - Whether this node is walkable.\n             */\n            function Node(x, y, z, walkable) {\n                /**\n                 * The x coordinate of the node on the grid.\n                 * @type number\n                 */\n                this.x = x;\n                /**\n                 * The y coordinate of the node on the grid.\n                 * @type number\n                 */\n                this.y = y;\n                /**\n                 * Whether this node can be walked through.\n                 * @type boolean\n                 */\n                this.walkable = (walkable === undefined ? true : walkable);\n\n                this.z = z;\n            }\n\n            module.exports = Node;\n\n        }, {}], 7: [function (require, module, exports) {\n            /**\n             * Backtrace according to the parent records and return the path.\n             * (including both start and end nodes)\n             * @param {Node} node End node\n             * @return {Array.<Array.<number>>} the path\n             */\n            function backtrace(node) {\n                var path = [[node.x, node.y, node.z]];\n                while (node.parent) {\n                    node = node.parent;\n                    path.push([node.x, node.y, node.z]);\n                }\n                return path.reverse();\n            }\n            exports.backtrace = backtrace;\n\n            /**\n             * Backtrace from start and end node, and return the path.\n             * (including both start and end nodes)\n             * @param {Node}\n             * @param {Node}\n             */\n            function biBacktrace(nodeA, nodeB) {\n                var pathA = backtrace(nodeA),\n                    pathB = backtrace(nodeB);\n                return pathA.concat(pathB.reverse());\n            }\n            exports.biBacktrace = biBacktrace;\n\n            /**\n             * Compute the length of the path.\n             * @param {Array.<Array.<number>>} path The path\n             * @return {number} The length of the path\n             */\n            function pathLength(path) {\n                var i, sum = 0, a, b, dx, dy, dz;\n                for (i = 1; i < path.length; ++i) {\n                    a = path[i - 1];\n                    b = path[i];\n                    dx = a[0] - b[0];\n                    dy = a[1] - b[1];\n                    dz = a[2] - b[2];\n                    sum += Math.sqrt(dx * dx + dy * dy + dz * dz);\n                }\n                return sum;\n            }\n            exports.pathLength = pathLength;\n\n\n            /**\n             * Given the start and end coordinates, return all the coordinates lying\n             * on the line formed by these coordinates, based on Bresenham's algorithm.\n             * http://en.wikipedia.org/wiki/Bresenham's_line_algorithm#Simplification\n             * https://www.geeksforgeeks.org/bresenhams-algorithm-for-3-d-line-drawing/\n             * @param {number} x1 Start x coordinate\n             * @param {number} y1 Start y coordinate\n             * @param {number} z1 Start z coordinate\n             * @param {number} x2 End x coordinate\n             * @param {number} y2 End y coordinate\n             * @param {number} z2 End z coordinate\n             * @return {Array.<Array.<number>>} The coordinates on the line\n             */\n            function getLine(x1, y1, z1, x2, y2, z2) {\n                let ListOfPoints = [];\n                ListOfPoints.push([x1, y1, z1]);\n                let dx = Math.abs(x2 - x1);\n                let dy = Math.abs(y2 - y1);\n                let dz = Math.abs(z2 - z1);\n                let xs;\n                let ys;\n                let zs;\n                if (x2 > x1) {\n                    xs = 1;\n                } else {\n                    xs = -1;\n                }\n                if (y2 > y1) {\n                    ys = 1;\n                } else {\n                    ys = -1;\n                }\n                if (z2 > z1) {\n                    zs = 1;\n                } else {\n                    zs = -1;\n                }\n\n                // Driving axis is X-axis\"\n                if (dx >= dy && dx >= dz) {\n                    let p1 = 2 * dy - dx;\n                    let p2 = 2 * dz - dx;\n                    while (x1 != x2) {\n                        x1 += xs;\n                        if (p1 >= 0) {\n                            y1 += ys;\n                            p1 -= 2 * dx;\n                        }\n                        if (p2 >= 0) {\n                            z1 += zs;\n                            p2 -= 2 * dx;\n                        }\n                        p1 += 2 * dy;\n                        p2 += 2 * dz;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n\n                    // Driving axis is Y-axis\"\n                } else if (dy >= dx && dy >= dz) {\n                    let p1 = 2 * dx - dy;\n                    let p2 = 2 * dz - dy;\n                    while (y1 != y2) {\n                        y1 += ys;\n                        if (p1 >= 0) {\n                            x1 += xs;\n                            p1 -= 2 * dy;\n                        }\n                        if (p2 >= 0) {\n                            z1 += zs;\n                            p2 -= 2 * dy;\n                        }\n                        p1 += 2 * dx;\n                        p2 += 2 * dz;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n\n                    // Driving axis is Z-axis\"\n                } else {\n                    let p1 = 2 * dy - dz;\n                    let p2 = 2 * dx - dz;\n                    while (z1 != z2) {\n                        z1 += zs;\n                        if (p1 >= 0) {\n                            y1 += ys;\n                            p1 -= 2 * dz;\n                        }\n                        if (p2 >= 0) {\n                            x1 += xs;\n                            p2 -= 2 * dz;\n                        }\n                        p1 += 2 * dy;\n                        p2 += 2 * dx;\n                        ListOfPoints.push([x1, y1, z1]);\n                    }\n                }\n                return ListOfPoints;\n            }\n            exports.getLine = getLine;\n\n\n            /**\n             * Smoothen the give path.\n             * The original path will not be modified; a new path will be returned.\n             * @param {PF.Grid} grid\n             * @param {Array.<Array.<number>>} path The path\n             * @return {Array.<Array.<number>>} Smoothened path\n             */\n            function smoothenPath(grid, path) {\n                var len = path.length,\n                    x0 = path[0][0],        // path start x\n                    y0 = path[0][1],        // path start y\n                    z0 = path[0][2],\n                    x1 = path[len - 1][0],  // path end x\n                    y1 = path[len - 1][1],  // path end y\n                    z1 = path[len - 1][2],\n                    sx, sy, sz                 // current start coordinate\n                ex, ey, ez                // current end coordinate\n                lx, ly, lz                 // last valid end coordinate\n                newPath,\n                    i, j, coord, line, testCoord, blocked;\n\n                sx = x0;\n                sy = y0;\n                sz = z0\n                lx = path[1][0];\n                ly = path[1][1];\n                lz = path[1][2];\n                newPath = [[sx, sy, sz]];\n\n                for (i = 2; i < len; ++i) {\n                    coord = path[i];\n                    ex = coord[0];\n                    ey = coord[1];\n                    ez = coord[2];\n                    line = getLine(sx, sy, sz, ex, ey, ez);\n\n                    blocked = false;\n                    for (j = 1; j < line.length; ++j) {\n\n                        testCoord = line[j];\n\n                        if (!grid.isWalkableAt(testCoord[0], testCoord[1])) {\n                            blocked = true;\n                            newPath.push([lx, ly]);\n                            sx = lx;\n                            sy = ly;\n                            break;\n                        }\n                    }\n                    if (!blocked) {\n                        lx = ex;\n                        ly = ey;\n                    }\n                }\n                newPath.push([x1, y1]);\n\n                return newPath;\n            }\n            exports.smoothenPath = smoothenPath;\n\n        }, {}], 8: [function (require, module, exports) {\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * A* path-finder.\n             * based upon https://github.com/bgrins/javascript-astar\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths, \n             *     in order to speed up the search.\n             */\n            function AStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            AStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                //if start or end are not in grid return;\n                if (!grid.isInside(startX, startY, startZ) || !grid.isInside(endX, endY, endZ))\n                    return [];\n\n                var openList = new Heap(function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                });\n                var startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    heuristic = this.heuristic,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    weight = this.weight,\n                    abs = Math.abs, SQRT2 = Math.SQRT2,\n                    node, neighbors, neighbor, i, l, x, y, ng, z;\n\n\n\n                // set the `g` and `f` value of the start node to be 0\n                startNode.g = 0;\n                startNode.f = 0;\n\n                // push the start node into the open list\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the open list is not empty\n                while (!openList.empty()) {\n                    // pop the position of node which has the minimum `f` value.\n                    node = openList.pop();\n                    node.closed = true;\n\n                    // if reached the end position, construct the path and return it\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - endX), abs(y - endY), abs(z - endZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                openList.push(neighbor);\n                                neighbor.opened = true;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                openList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n                } // end while not open list empty\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = AStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }], 9: [function (require, module, exports) {\n            var AStarFinder = require('./AStarFinder');\n\n            /**\n             * Best-First-Search path-finder.\n             * @constructor\n             * @extends AStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function BestFirstFinder(opt) {\n                AStarFinder.call(this, opt);\n\n                var orig = this.heuristic;\n                this.heuristic = function (dx, dy, dz) {\n                    return orig(dx, dy, dz) * 1000000;\n                };\n            }\n\n            BestFirstFinder.prototype = new AStarFinder();\n            BestFirstFinder.prototype.constructor = BestFirstFinder;\n\n            module.exports = BestFirstFinder;\n\n        }, { \"./AStarFinder\": 8 }], 10: [function (require, module, exports) {\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * A* path-finder.\n             * based upon https://github.com/bgrins/javascript-astar\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths, \n             *     in order to speed up the search.\n             */\n            function BiAStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BiAStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var cmp = function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                },\n                    startOpenList = new Heap(cmp),\n                    endOpenList = new Heap(cmp),\n                    startNode = grid.getNodeAt(startX, startY),\n                    endNode = grid.getNodeAt(endX, endY),\n                    heuristic = this.heuristic,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    weight = this.weight,\n                    abs = Math.abs, SQRT2 = Math.SQRT2,\n                    node, neighbors, neighbor, i, l, x, y, ng, z,\n                    BY_START = 1, BY_END = 2;\n\n                // set the `g` and `f` value of the start node to be 0\n                // and push it into the start open list\n                startNode.g = 0;\n                startNode.f = 0;\n                startOpenList.push(startNode);\n                startNode.opened = BY_START;\n\n                // set the `g` and `f` value of the end node to be 0\n                // and push it into the open open list\n                endNode.g = 0;\n                endNode.f = 0;\n                endOpenList.push(endNode);\n                endNode.opened = BY_END;\n\n                // while both the open lists are not empty\n                while (!startOpenList.empty() && !endOpenList.empty()) {\n\n                    // pop the position of start node which has the minimum `f` value.\n                    node = startOpenList.pop();\n                    node.closed = true;\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened === BY_END) {\n                            return Util.biBacktrace(node, neighbor);\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - endX), abs(y - endY), abs(z - endZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                startOpenList.push(neighbor);\n                                neighbor.opened = BY_START;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                startOpenList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n\n\n                    // pop the position of end node which has the minimum `f` value.\n                    node = endOpenList.pop();\n                    node.closed = true;\n\n                    // get neigbours of the current node\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened === BY_START) {\n                            return Util.biBacktrace(neighbor, node);\n                        }\n\n                        x = neighbor.x;\n                        y = neighbor.y;\n                        z = neighbor.z;\n\n                        // get the distance between current node and the neighbor\n                        // and calculate the next g score\n                        ng = node.g + ((x - node.x === 0 || y - node.y === 0 || z - node.z === 0) ? 1 : SQRT2);\n\n                        // check if the neighbor has not been inspected yet, or\n                        // can be reached with smaller cost from the current node\n                        if (!neighbor.opened || ng < neighbor.g) {\n                            neighbor.g = ng;\n                            neighbor.h = neighbor.h || weight * heuristic(abs(x - startX), abs(y - startY), abs(z - startZ));\n                            neighbor.f = neighbor.g + neighbor.h;\n                            neighbor.parent = node;\n\n                            if (!neighbor.opened) {\n                                endOpenList.push(neighbor);\n                                neighbor.opened = BY_END;\n                            } else {\n                                // the neighbor can be reached with smaller cost.\n                                // Since its f value has been updated, we have to\n                                // update its position in the open list\n                                endOpenList.updateItem(neighbor);\n                            }\n                        }\n                    } // end for each neighbor\n                } // end while not open list empty\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BiAStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }], 11: [function (require, module, exports) {\n            var BiAStarFinder = require('./BiAStarFinder');\n\n            /**\n             * Bi-direcitional Best-First-Search path-finder.\n             * @constructor\n             * @extends BiAStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function BiBestFirstFinder(opt) {\n                BiAStarFinder.call(this, opt);\n\n                var orig = this.heuristic;\n                this.heuristic = function (dx, dy, dz) {\n                    return orig(dx, dy, dz) * 1000000;\n                };\n            }\n\n            BiBestFirstFinder.prototype = new BiAStarFinder();\n            BiBestFirstFinder.prototype.constructor = BiBestFirstFinder;\n\n            module.exports = BiBestFirstFinder;\n\n        }, { \"./BiAStarFinder\": 10 }], 12: [function (require, module, exports) {\n            var Util = require('../core/Util');\n\n            /**\n             * Bi-directional Breadth-First-Search path finder.\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BiBreadthFirstFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n            }\n\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BiBreadthFirstFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    startOpenList = [], endOpenList = [],\n                    neighbors, neighbor, node,\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    BY_START = 0, BY_END = 1,\n                    i, l;\n\n                // push the start and end nodes into the queues\n                startOpenList.push(startNode);\n                startNode.opened = true;\n                startNode.by = BY_START;\n\n                endOpenList.push(endNode);\n                endNode.opened = true;\n                endNode.by = BY_END;\n\n                // while both the queues are not empty\n                while (startOpenList.length && endOpenList.length) {\n\n                    // expand start open list\n\n                    node = startOpenList.shift();\n                    node.closed = true;\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened) {\n                            // if this node has been inspected by the reversed search,\n                            // then a path is found.\n                            if (neighbor.by === BY_END) {\n                                return Util.biBacktrace(node, neighbor);\n                            }\n                            continue;\n                        }\n                        startOpenList.push(neighbor);\n                        neighbor.parent = node;\n                        neighbor.opened = true;\n                        neighbor.by = BY_START;\n                    }\n\n                    // expand end open list\n\n                    node = endOpenList.shift();\n                    node.closed = true;\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        if (neighbor.closed) {\n                            continue;\n                        }\n                        if (neighbor.opened) {\n                            if (neighbor.by === BY_START) {\n                                return Util.biBacktrace(neighbor, node);\n                            }\n                            continue;\n                        }\n                        endOpenList.push(neighbor);\n                        neighbor.parent = node;\n                        neighbor.opened = true;\n                        neighbor.by = BY_END;\n                    }\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BiBreadthFirstFinder;\n\n        }, { \"../core/Util\": 7 }], 13: [function (require, module, exports) {\n            var BiAStarFinder = require('./BiAStarFinder');\n\n            /**\n             * Bi-directional Dijkstra path-finder.\n             * @constructor\n             * @extends BiAStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BiDijkstraFinder(opt) {\n                BiAStarFinder.call(this, opt);\n                this.heuristic = function (dx, dy, dz) {\n                    return 0;\n                };\n            }\n\n            BiDijkstraFinder.prototype = new BiAStarFinder();\n            BiDijkstraFinder.prototype.constructor = BiDijkstraFinder;\n\n            module.exports = BiDijkstraFinder;\n\n        }, { \"./BiAStarFinder\": 10 }], 14: [function (require, module, exports) {\n            var Util = require('../core/Util');\n\n            /**\n             * Breadth-First-Search path finder.\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function BreadthFirstFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n            }\n\n            /**\n             * Find and return the the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            BreadthFirstFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var openList = [],\n                    allowDiagonal = this.allowDiagonal,\n                    dontCrossCorners = this.dontCrossCorners,\n                    startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = grid.getNodeAt(endX, endY, endZ),\n                    neighbors, neighbor, node, i, l;\n\n                // push the start pos into the queue\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the queue is not empty\n                while (openList.length) {\n                    // take the front node from the queue\n                    node = openList.shift();\n                    node.closed = true;\n\n                    // reached the end position\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    neighbors = grid.getNeighbors(node, allowDiagonal, dontCrossCorners);\n                    for (i = 0, l = neighbors.length; i < l; ++i) {\n                        neighbor = neighbors[i];\n\n                        // skip this neighbor if it has been inspected before\n                        if (neighbor.closed || neighbor.opened) {\n                            continue;\n                        }\n\n                        openList.push(neighbor);\n                        neighbor.opened = true;\n                        neighbor.parent = node;\n                    }\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            module.exports = BreadthFirstFinder;\n\n        }, { \"../core/Util\": 7 }], 15: [function (require, module, exports) {\n            var AStarFinder = require('./AStarFinder');\n\n            /**\n             * Dijkstra path-finder.\n             * @constructor\n             * @extends AStarFinder\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             */\n            function DijkstraFinder(opt) {\n                AStarFinder.call(this, opt);\n                this.heuristic = function (dx, dy, dz) {\n                    return 0;\n                };\n            }\n\n            DijkstraFinder.prototype = new AStarFinder();\n            DijkstraFinder.prototype.constructor = DijkstraFinder;\n\n            module.exports = DijkstraFinder;\n\n        }, { \"./AStarFinder\": 8 }], 16: [function (require, module, exports) {\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n            var Node = require('../core/Node');\n\n            /**\n             * Iterative Deeping A Star (IDA*) path-finder.\n             *\n             * Recursion based on:\n             *   http://www.apl.jhu.edu/~hall/AI-Programming/IDA-Star.html\n             *\n             * Path retracing based on:\n             *  V. Nageshwara Rao, Vipin Kumar and K. Ramesh\n             *  \"A Parallel Implementation of Iterative-Deeping-A*\", January 1987.\n             *  ftp://ftp.cs.utexas.edu/.snapshot/hourly.1/pub/AI-Lab/tech-reports/UT-AI-TR-87-46.pdf\n             *\n             * @author Gerard Meier (www.gerardmeier.com)\n             *\n             * @constructor\n             * @param {object} opt\n             * @param {boolean} opt.allowDiagonal Whether diagonal movement is allowed.\n             * @param {boolean} opt.dontCrossCorners Disallow diagonal movement touching block corners.\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             * @param {integer} opt.weight Weight to apply to the heuristic to allow for suboptimal paths,\n             *     in order to speed up the search.\n             * @param {object} opt.trackRecursion Whether to track recursion for statistical purposes.\n             * @param {object} opt.timeLimit Maximum execution time. Use <= 0 for infinite.\n             */\n\n            function IDAStarFinder(opt) {\n                opt = opt || {};\n                this.allowDiagonal = opt.allowDiagonal;\n                this.dontCrossCorners = opt.dontCrossCorners;\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.weight = opt.weight || 1;\n                this.trackRecursion = opt.trackRecursion || false;\n                this.timeLimit = opt.timeLimit || Infinity; // Default: no time limit.\n            }\n\n            /**\n             * Find and return the the path. When an empty array is returned, either\n             * no path is possible, or the maximum execution time is reached.\n             *\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            IDAStarFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                // Used for statistics:\n                var nodesVisited = 0;\n\n                // Execution time limitation:\n                var startTime = new Date().getTime();\n\n                // Heuristic helper:\n                var h = function (a, b) {\n                    return this.heuristic(Math.abs(b.x - a.x), Math.abs(b.y - a.y), Math.abs(b.z - a.z));\n                }.bind(this);\n\n                // Step cost from a to b:\n                var cost = function (a, b) {\n                    return (a.x === b.x || a.y === b.y || a.z === b.z) ? 1 : Math.SQRT2;\n                };\n\n                /**\n                 * IDA* search implementation.\n                 *\n                 * @param {Node} The node currently expanding from.\n                 * @param {number} Cost to reach the given node.\n                 * @param {number} Maximum search depth (cut-off value).\n                 * @param {{Array.<[number, number]>}} The found route.\n                 * @param {number} Recursion depth.\n                 *\n                 * @return {Object} either a number with the new optimal cut-off depth,\n                 * or a valid node instance, in which case a path was found.\n                 */\n                var search = function (node, g, cutoff, route, depth) {\n                    nodesVisited++;\n\n                    // Enforce timelimit:\n                    if (this.timeLimit > 0 && new Date().getTime() - startTime > this.timeLimit * 1000) {\n                        // Enforced as \"path-not-found\".\n                        return Infinity;\n                    }\n\n                    var f = g + h(node, end) * this.weight;\n\n                    // We've searched too deep for this iteration.\n                    if (f > cutoff) {\n                        return f;\n                    }\n\n                    if (node == end) {\n                        route[depth] = [node.x, node.y, node.z];\n                        return node;\n                    }\n\n                    var min, t, k, neighbour;\n\n                    var neighbours = grid.getNeighbors(node, this.allowDiagonal, this.dontCrossCorners);\n\n                    // Sort the neighbours, gives nicer paths. But, this deviates\n                    // from the original algorithm - so I left it out.\n                    //neighbours.sort(function(a, b){\n                    //    return h(a, end) - h(b, end);\n                    //});\n\n                    for (k = 0, min = Infinity; neighbour = neighbours[k]; ++k) {\n\n                        if (this.trackRecursion) {\n                            // Retain a copy for visualisation. Due to recursion, this\n                            // node may be part of other paths too.\n                            neighbour.retainCount = neighbour.retainCount + 1 || 1;\n\n                            if (neighbour.tested !== true) {\n                                neighbour.tested = true;\n                            }\n                        }\n\n                        t = search(neighbour, g + cost(node, neighbour), cutoff, route, depth + 1);\n\n                        if (t instanceof Node) {\n                            route[depth] = [node.x, node.y, node.z];\n\n                            // For a typical A* linked list, this would work:\n                            // neighbour.parent = node;\n                            return t;\n                        }\n\n                        // Decrement count, then determine whether it's actually closed.\n                        if (this.trackRecursion && (--neighbour.retainCount) === 0) {\n                            neighbour.tested = false;\n                        }\n\n                        if (t < min) {\n                            min = t;\n                        }\n                    }\n\n                    return min;\n\n                }.bind(this);\n\n                // Node instance lookups:\n                var start = grid.getNodeAt(startX, startY, startZ);\n                var end = grid.getNodeAt(endX, endY, endZ);\n\n                // Initial search depth, given the typical heuristic contraints,\n                // there should be no cheaper route possible.\n                var cutOff = h(start, end);\n\n                var j, route, t;\n\n                // With an overflow protection.\n                for (j = 0; true; ++j) {\n                    //console.log(\"Iteration: \" + j + \", search cut-off value: \" + cutOff + \", nodes visited thus far: \" + nodesVisited + \".\");\n\n                    route = [];\n\n                    // Search till cut-off depth:\n                    t = search(start, 0, cutOff, route, 0);\n\n                    // Route not possible, or not found in time limit.\n                    if (t === Infinity) {\n                        return [];\n                    }\n\n                    // If t is a node, it's also the end node. Route is now\n                    // populated with a valid path to the end node.\n                    if (t instanceof Node) {\n                        //console.log(\"Finished at iteration: \" + j + \", search cut-off value: \" + cutOff + \", nodes visited: \" + nodesVisited + \".\");\n                        return route;\n                    }\n\n                    // Try again, this time with a deeper cut-off. The t score\n                    // is the closest we got to the end node.\n                    cutOff = t;\n                }\n\n                // This _should_ never to be reached.\n                return [];\n            };\n\n            module.exports = IDAStarFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Node\": 6, \"../core/Util\": 7 }], 17: [function (require, module, exports) {\n            /**\n             * @author aniero / https://github.com/aniero\n             */\n            var Heap = require('heap');\n            var Util = require('../core/Util');\n            var Heuristic = require('../core/Heuristic');\n\n            /**\n             * Path finder using the Jump Point Search algorithm\n             * @param {object} opt\n             * @param {function} opt.heuristic Heuristic function to estimate the distance\n             *     (defaults to manhattan).\n             */\n            function JumpPointFinder(opt) {\n                opt = opt || {};\n                this.heuristic = opt.heuristic || Heuristic.manhattan;\n                this.trackJumpRecursion = opt.trackJumpRecursion || false;\n            }\n\n            /**\n             * Find and return the path.\n             * @return {Array.<[number, number]>} The path, including both start and\n             *     end positions.\n             */\n            JumpPointFinder.prototype.findPath = function (startX, startY, startZ, endX, endY, endZ, grid) {\n                var openList = this.openList = new Heap(function (nodeA, nodeB) {\n                    return nodeA.f - nodeB.f;\n                }),\n                    startNode = this.startNode = grid.getNodeAt(startX, startY, startZ),\n                    endNode = this.endNode = grid.getNodeAt(endX, endY, endZ), node;\n\n                this.grid = grid;\n\n\n                // set the `g` and `f` value of the start node to be 0\n                startNode.g = 0;\n                startNode.f = 0;\n\n                // push the start node into the open list\n                openList.push(startNode);\n                startNode.opened = true;\n\n                // while the open list is not empty\n                while (!openList.empty()) {\n                    // pop the position of node which has the minimum `f` value.\n                    node = openList.pop();\n                    node.closed = true;\n\n                    if (node === endNode) {\n                        return Util.backtrace(endNode);\n                    }\n\n                    this._identifySuccessors(node);\n                }\n\n                // fail to find the path\n                return [];\n            };\n\n            /**\n             * Identify successors for the given node. Runs a jump point search in the\n             * direction of each available neighbor, adding any points found to the open\n             * list.\n             * @protected\n             */\n            JumpPointFinder.prototype._identifySuccessors = function (node) {\n                var grid = this.grid,\n                    heuristic = this.heuristic,\n                    openList = this.openList,\n                    endX = this.endNode.x,\n                    endY = this.endNode.y,\n                    endZ = this.endNode.z\n                neighbors, neighbor,\n                    jumpPoint, i, l,\n                    x = node.x, y = node.y, z = node.z\n                jx, jy, dx, dy, d, ng, jumpNode, dz, jz\n                abs = Math.abs, max = Math.max;\n\n                neighbors = this._findNeighbors(node);\n                for (i = 0, l = neighbors.length; i < l; ++i) {\n                    neighbor = neighbors[i];\n                    jumpPoint = this._jump(neighbor[0], neighbor[1], x, y, z);\n                    if (jumpPoint) {\n\n                        jx = jumpPoint[0];\n                        jy = jumpPoint[1];\n                        jz = jumpPoint[2]\n                        jumpNode = grid.getNodeAt(jx, jy, jz);\n\n                        if (jumpNode.closed) {\n                            continue;\n                        }\n\n                        // include distance, as parent may not be immediately adjacent:\n                        d = Heuristic.euclidean(abs(jx - x), abs(jy - y), abs(jz - z));\n                        ng = node.g + d; // next `g` value\n\n                        if (!jumpNode.opened || ng < jumpNode.g) {\n                            jumpNode.g = ng;\n                            jumpNode.h = jumpNode.h || heuristic(abs(jx - endX), abs(jy - endY), abs(jz - endZ));\n                            jumpNode.f = jumpNode.g + jumpNode.h;\n                            jumpNode.parent = node;\n\n                            if (!jumpNode.opened) {\n                                openList.push(jumpNode);\n                                jumpNode.opened = true;\n                            } else {\n                                openList.updateItem(jumpNode);\n                            }\n                        }\n                    }\n                }\n            };\n\n            /**\n             * Search recursively in the direction (parent -> child), stopping only when a\n             * jump point is found.\n             * @protected\n             * @return {Array.<[number, number]>} The x, y coordinate of the jump point\n             *     found, or null if not found\n             */\n            JumpPointFinder.prototype._jump = function (x, y, z, px, py, pz) {\n                var grid = this.grid,\n                    dx = x - px, dy = y - py, jx, jy;\n                dz = z - pz, jz;\n\n                if (!grid.isWalkableAt(x, y, z)) {\n                    return null;\n                }\n\n                if (this.trackJumpRecursion === true) {\n                    grid.getNodeAt(x, y, z).tested = true;\n                }\n\n                if (grid.getNodeAt(x, y, z) === this.endNode) {\n                    return [x, y, z];\n                }\n\n                // check for forced neighbors\n                // along the diagonal\n                if (dx !== 0 && dy !== 0) {\n                    if ((grid.isWalkableAt(x - dx, y + dy, z) && !grid.isWalkableAt(x - dx, y, z)) ||\n                        (grid.isWalkableAt(x + dx, y - dy, z) && !grid.isWalkableAt(x, y - dy, z))) {\n                        return [x, y, z];\n                    }\n                }\n                // horizontally/vertically\n                else {\n                    if (dx !== 0) { // moving along x\n                        if ((grid.isWalkableAt(x + dx, y + 1, z) && !grid.isWalkableAt(x, y + 1, z)) ||\n                            (grid.isWalkableAt(x + dx, y - 1, z) && !grid.isWalkableAt(x, y - 1, z))) {\n                            return [x, y, z];\n                        }\n                    }\n                    else {\n                        if ((grid.isWalkableAt(x + 1, y + dy, z) && !grid.isWalkableAt(x + 1, y, z)) ||\n                            (grid.isWalkableAt(x - 1, y + dy, z) && !grid.isWalkableAt(x - 1, y, z))) {\n                            return [x, y, z];\n                        }\n                    }\n                }\n                if (dz !== 0) {\n                    jz = his._jump(x, y, z + dz, x, y, z);\n                    if (jz) return [x, y, z];\n                }\n                // when moving diagonally, must check for vertical/horizontal jump points\n                if (dx !== 0 && dy !== 0) {\n                    jx = this._jump(x + dx, y, z, x, y, z);\n                    jy = this._jump(x, y + dy, z, x, y, z);\n                    if (jx || jy) {\n                        return [x, y, z];\n                    }\n                }\n\n                // moving diagonally, must make sure one of the vertical/horizontal\n                // neighbors is open to allow the path\n                if (grid.isWalkableAt(x + dx, y, z) || grid.isWalkableAt(x, y + dy, z)) {\n                    return this._jump(x + dx, y + dy, z, x, y, z);\n                } else {\n                    return null;\n                }\n            };\n\n            /**\n             * Find the neighbors for the given node. If the node has a parent,\n             * prune the neighbors based on the jump point search algorithm, otherwise\n             * return all available neighbors.\n             * @return {Array.<[number, number]>} The neighbors found.\n             */\n            JumpPointFinder.prototype._findNeighbors = function (node) {\n                var parent = node.parent,\n                    x = node.x, y = node.y, z = node.z,\n                    grid = this.grid,\n                    px, py, nx, ny, dx, dy, pz, nz, dz\n                neighbors = [], neighborNodes, neighborNode, i, l;\n\n                // directed pruning: can ignore most neighbors, unless forced.\n\n                if (parent) {\n                    px = parent.x;\n                    py = parent.y;\n                    pz = parent.z;\n                    // get the normalized direction of travel\n                    dx = (x - px) / Math.max(Math.abs(x - px), 1);\n                    dy = (y - py) / Math.max(Math.abs(y - py), 1);\n                    dz = (z - pz) / Math.max(Math.abs(z - pz), 1);\n\n                    //search up/down\n                    if (dz !== 0) {\n                        if (grid.isWalkableAt(x, y, z + dz)) {\n                            if (grid.isWalkableAt(x, y, z + dz)) {\n                                neighbors.push([x + dx, y + dy, z + dz]);\n                            }\n                            if (!grid.isWalkableAt(x, y, z + 1)) {\n                                neighbors.push([x + dx, y + dy, z + 1]);\n                            }\n                            if (!grid.isWalkableAt(x, y, z - 1)) {\n                                neighbors.push([x + dx, y + dy, z - 1]);\n                            }\n                        }\n                    }\n                    // search diagonally\n                    else if (dx !== 0 && dy !== 0) {\n                        if (grid.isWalkableAt(x, y + dy, z)) {\n                            neighbors.push([x, y + dy, z]);\n                        }\n                        if (grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y, z]);\n                        }\n                        if (grid.isWalkableAt(x, y + dy, z) || grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y + dy, z]);\n                        }\n                        if (!grid.isWalkableAt(x - dx, y, z) && grid.isWalkableAt(x, y + dy, z)) {\n                            neighbors.push([x - dx, y + dy, z]);\n                        }\n                        if (!grid.isWalkableAt(x, y - dy, z) && grid.isWalkableAt(x + dx, y, z)) {\n                            neighbors.push([x + dx, y - dy, z]);\n                        }\n                    }\n                    // search horizontally/vertically\n                    else {\n                        if (dx === 0) {\n                            if (grid.isWalkableAt(x, y + dy, z)) {\n                                if (grid.isWalkableAt(x, y + dy, z)) {\n                                    neighbors.push([x, y + dy, z]);\n                                }\n                                if (!grid.isWalkableAt(x + 1, y, z)) {\n                                    neighbors.push([x + 1, y + dy, z]);\n                                }\n                                if (!grid.isWalkableAt(x - 1, y, z)) {\n                                    neighbors.push([x - 1, y + dy, z]);\n                                }\n                            }\n                        }\n                        else {\n                            if (grid.isWalkableAt(x + dx, y, z)) {\n                                if (grid.isWalkableAt(x + dx, y, z)) {\n                                    neighbors.push([x + dx, y, z]);\n                                }\n                                if (!grid.isWalkableAt(x, y + 1, z)) {\n                                    neighbors.push([x + dx, y + 1, z]);\n                                }\n                                if (!grid.isWalkableAt(x, y - 1, z)) {\n                                    neighbors.push([x + dx, y - 1, z]);\n                                }\n                            }\n                        }\n                    }\n                }\n                // return all neighbors\n                else {\n                    neighborNodes = grid.getNeighbors(node, true);\n                    for (i = 0, l = neighborNodes.length; i < l; ++i) {\n                        neighborNode = neighborNodes[i];\n                        neighbors.push([neighborNode.x, neighborNode.y, neighborNode.z]);\n                    }\n                }\n\n                return neighbors;\n            };\n\n            module.exports = JumpPointFinder;\n\n        }, { \"../core/Heuristic\": 5, \"../core/Util\": 7, \"heap\": 1 }]\n    }, {}, [3])(3);\n});", "/**\r\n * A custom event emitter that will work in browsers or nodejs\r\n * Contains naming conventions from all standard formats\r\n */\r\nexport class EventEmitter {\r\n    #events = {};\r\n\r\n    public bind(type: string, listener: Function, caller?, once?) {\r\n        if (!Array.isArray(this.#events[type]) || typeof this.#events[type] === 'undefined')\r\n            this.#events[type] = [];\r\n        this.#events[type].push({ listener: listener, caller: caller, once: once || false });\r\n    }\r\n\r\n    public on(type: string, listener: Function, caller?) {\r\n        this.bind(type, listener, caller);\r\n    }\r\n\r\n    public once(type: string, listener: Function, caller?) {\r\n        this.bind(type, listener, caller, true);\r\n    }\r\n\r\n    public addEventListener(type: string, listener: Function, caller?) {\r\n        this.bind(type, listener, caller);\r\n    }\r\n\r\n    public fire(type, args?, caller?) {\r\n        if (!type || typeof type !== 'string')\r\n            throw new Error('Event missing.');\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        if (!args || args === null || typeof args === 'undefined')\r\n            args = [];\r\n        else if (!Array.isArray(args))\r\n            args = [args];\r\n\r\n        caller = caller || this;\r\n        //copy of original events for testing in case an event gets removed mid loop\r\n        let oEvents = this.#events[type];\r\n        //story a copy of events incase something changes while looping, and reverse it so we can loop last to first to prevent skipping events if removed        \r\n        let events = oEvents.slice().reverse();\r\n\r\n        const once = [];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            //check if event was removed and if so skip it\r\n            if (oEvents.indexOf(events[i]) === -1) continue;\r\n            //store the event if once for easy removable, and because events may modify the list of arrays do not use index\r\n            if (events[i] && events[i].once)\r\n                once.push(events[i]);\r\n            events[i].listener.apply(events[i].caller || caller, args);\r\n        }\r\n\r\n        //Clean up once events after fired so events are fired in correct order, working last to first due to index manipulations\r\n        for (let i = once.length - 1; i >= 0; i--) {\r\n            let idx = this.#events[type].indexOf(once[i]);\r\n            if (idx !== -1)\r\n                this.#events[type].splice(idx, 1);\r\n        }\r\n    }\r\n\r\n    public emit(type, ...args) {\r\n        this.fire(type, args);\r\n    }\r\n\r\n    public dispatchEvent(type: string, args?, caller?) {\r\n        this.fire(type, args, caller);\r\n    }\r\n\r\n    public unbind(type, listener) {\r\n        if (!type || !listener) return;\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        const events = this.#events[type];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            if (events[i].listener === listener) {\r\n                events.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public remove(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public off(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeListener(type, listener) {\r\n        this.unbind(type, listener);\r\n    }\r\n\r\n    public removeAllListeners(type?) {\r\n        if (!type) {\r\n            this.#events = [];\r\n            return;\r\n        }\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        delete this.#events[type];\r\n    }\r\n\r\n    public removeListenersFromCaller(caller, type?) {\r\n        if (!type) {\r\n            Object.keys(this.#events).forEach(key => {\r\n                const events = this.#events[key];\r\n                for (let i = events.length - 1; i >= 0; i--) {\r\n                    if (events[i].caller === caller) {\r\n                        events.splice(i, 1);\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n            return;\r\n        }\r\n        if (!Array.isArray(this.#events[type])) return;\r\n        const events = this.#events[type];\r\n        for (let i = 0, len = events.length; i < len; i++) {\r\n            if (events[i].caller === caller) {\r\n                events.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public listeners(type?) {\r\n        if (!type) return this.#events;\r\n        return this.#events[type] || [];\r\n    }\r\n}", "/**\n * @file Core functions and helpers\n *\n * @author William\n */\n//spell-checker:ignore Eisu, Junja, Hanja, Nonconvert, Modechange, printscreen, jisho, Masshou, Touroku, loya, roya\n//spell-checker:ignore Wsctrl, Cusel, Enlw, Backtab, Crsel, Exsel, Ereof rtrim ltrim Dropdown DBLUNDERLINE noflash\ndeclare global {\n    interface String {\n        trimLeft(): string;\n        trimRight(): string;\n        rtrim(): string;\n        addSlashes(): string;\n    }\n\n    interface Uint8Array {\n        charAt;\n        charCodeAt;\n    }\n\n    interface Object {\n        toType;\n    }\n\n    interface Window {\n        opera;\n    }\n}\n\n/**\n * Copyright (c) Mozilla Foundation http://www.mozilla.org/\n * This code is available under the terms of the MIT License\n */\nif (!Array.prototype.filter) {\n    Array.prototype.filter = function (fun /*, thisp*/) {\n        let len = this.length >>> 0;\n        if (typeof fun != 'function') {\n            throw new TypeError();\n        } ``\n\n        let res = [];\n        let thisp = arguments[1];\n        for (let i = 0; i < len; i++) {\n            if (i in this) {\n                let val = this[i]; // in case fun mutates this\n                if (fun.call(thisp, val, i, this)) {\n                    res.push(val);\n                }\n            }\n        }\n\n        return res;\n    };\n}\n\nexport function SortArrayByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    return 0;\n}\n\nexport function SortMapByPriority(a, b) {\n    if (a.priority > b.priority)\n        return -1;\n    if (a.priority < b.priority)\n        return 1;\n    if (a.index < b.index)\n        return -1;\n    if (a.index > b.index)\n        return 1;\n    return 0;\n}\n\nexport function SortItemArrayByPriority(list) {\n    const map = list.map((el, i) => {\n        return { index: i, priority: el.priority };\n    });\n    map.sort(SortMapByPriority);\n    return map.map((el) => {\n        return list[el.index];\n    });\n}\n\nexport function FilterArrayByKeyValue(array, k, v) {\n    const res = [];\n    if (!array || array.length === 0) return res;\n    const al = array.length;\n    for (let i = 0; i < al; i++) {\n        if (array[i]['enabled'] && array[i][k] === v)\n            res.push(array[i]);\n    }\n    if (res.length <= 1) return res;\n    return res.sort(SortArrayByPriority);\n}\n\nconst _edCache = document.createElement('div');\n\nexport function htmlEncode(value, nonBreaking?) {\n    if (!value || !value.length) return '';\n    _edCache.textContent = nonBreaking ? value.replace(/ /g, '\\u00A0') : value;\n    value = _edCache.innerHTML;\n    _edCache.textContent = ''\n    return value;\n}\n\nexport function htmlDecode(value, nonBreaking?) {\n    if (!value || !value.length) return '';\n    _edCache.innerHTML = value;\n    value = nonBreaking ? _edCache.textContent.replace(/\\u00A0/g, ' ') : _edCache.textContent;\n    _edCache.innerHTML = '';\n    return value;\n}\n\nexport function htmlEntities(str) {\n    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\n\n/*\nexport function stripHTML(html) {\n    _edCache.innerHTML = html;\n    html = _edCache.textContent || _edCache.innerText || '';\n    _edCache.innerHTML = '';\n    return html;\n}\n\nexport function stripParentheses(str) {\n    return str.replace(/(^\\()|(\\)$)/g, '');\n}\n*/\nexport function stripQuotes(str) {\n    str = str.replace(/^\"(.+(?=\"$))?\"$/, '$1');\n    str = str.replace(/^'(.+(?='$))?'$/, '$1');\n    return str;\n}\n\nexport function offset(el) {\n    const box = el.getBoundingClientRect();\n    const docElem = document.documentElement;\n    return {\n        top: box.top + (window.scrollY || window.pageYOffset) - docElem.clientTop,\n        left: box.left + (window.scrollX || window.pageXOffset) - docElem.clientLeft\n    };\n}\n\nexport class StringBuffer {\n    public buffer: string[];\n    //public rawbuffer: string[];\n    public length: number = 0;\n    constructor(str?: string) {\n        if (typeof str == 'string' && str.length > 0)\n            this.buffer = [str];\n        else\n            this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n    }\n\n    public prepend(string) {\n        this.buffer.unshift(string);\n        //this.rawbuffer.unshift(string.charCodeAt(0));\n        this.length += string.length;\n        return this;\n    }\n\n    public append(string) {\n        this.buffer.push(string);\n        this.length += string.length;\n        //this.rawbuffer.push(string.charCodeAt(0));\n        return this;\n    }\n\n    public push(string) {\n        if (typeof string === 'number')\n            this.appendCode(string);\n        else\n            this.append(string);\n    }\n\n    public appendCode(b) {\n        this.buffer.push(String.fromCharCode(b));\n        //this.rawbuffer.push(b);\n        this.length++;\n        return this;\n    }\n\n    public toString() {\n        return this.buffer.join('');\n    }\n\n    public clear(str?) {\n        this.buffer = [];\n        //this.rawbuffer = [];\n        this.length = 0;\n        if (str && typeof str != 'undefined' && str.length) {\n            this.buffer.push(str);\n            this.length = str.length;\n        }\n        return this;\n    }\n\n    public concat(arr) {\n        this.buffer = this.buffer.concat(arr);\n        //this.rawbuffer.push(arr.charCodeAt(0));\n    }\n\n}\n\nexport function CharAllowedInURL(chr, proto) {\n    if (chr.length > 1)\n        return false;\n    if (\n        chr === '-' ||\n        chr === '_' ||\n        chr === '.' ||\n        chr === '~' ||\n        chr === '!' ||\n        chr === '*' ||\n        chr === '\\'' ||\n        chr === ';' ||\n        chr === ':' ||\n        chr === '@' ||\n        chr === '&' ||\n        chr === '=' ||\n        chr === '+' ||\n        chr === '$' ||\n        chr === ',' ||\n        chr === '/' ||\n        chr === '\\\\' ||\n        chr === '?' ||\n        chr === '%' ||\n        chr === '#' ||\n        chr === '[' ||\n        chr === ']' ||\n        chr === '(' ||\n        chr === ')'\n    )\n        return !proto;\n    const i = chr.charCodeAt(0);\n    if (i > 64 && i < 91)\n        return true;\n    if (i > 96 && i < 123)\n        return true;\n    if (i > 47 && i < 58)\n        return true;\n    if (i >= 160 && i <= 55295)\n        return true;\n    if (i >= 57344 && i <= 64975)\n        return true;\n    if (i >= 65008 && i <= 65533)\n        return true;\n    if (i >= 65536 && i <= 131069)\n        return true;\n    if (i >= 131072 && i <= 196605)\n        return true;\n    if (i >= 196608 && i <= 262141)\n        return true;\n    if (i >= 262144 && i <= 327677)\n        return true;\n    if (i >= 327680 && i <= 393213)\n        return true;\n    if (i >= 393216 && i <= 458749)\n        return true;\n    if (i >= 458752 && i <= 524285)\n        return true;\n    if (i >= 524288 && i <= 589821)\n        return true;\n    if (i >= 589824 && i <= 655357)\n        return true;\n    if (i >= 655360 && i <= 720893)\n        return true;\n    if (i >= 720896 && i <= 786429)\n        return true;\n    if (i >= 786432 && i <= 851965)\n        return true;\n    if (i >= 851968 && i <= 917501)\n        return true;\n    if (i >= 921600 && i <= 983037)\n        return true;\n    if (i >= 983040 && i <= 1048573)\n        return true;\n    if (i >= 1048576 && i <= 1114109)\n        return true;\n    return false;\n}\n\nexport let keyCodeToChar = {\n    3: 'Cancel',\n    6: 'Help',\n    8: 'Backspace',\n    9: 'Tab',\n    19: 'Pause/Break',\n    20: 'Caps Lock',\n    21: 'Kana',\n    22: 'Eisu',\n    23: 'Junja',\n    24: 'Final',\n    25: 'Hanja',\n    27: 'Esc',\n    28: 'Convert',\n    29: 'Nonconvert',\n    30: 'Accept',\n    31: 'Modechange',\n    32: 'Space',\n    33: 'Page Up',\n    34: 'Page Down',\n    35: 'End',\n    36: 'Home',\n    37: 'Left',\n    38: 'Up',\n    39: 'Right',\n    40: 'Down',\n    41: 'Select',\n    42: 'Print',\n    43: 'Execute',\n    44: 'Printscreen',\n    45: 'Insert',\n    46: 'Delete',\n    48: '0',\n    49: '1',\n    50: '2',\n    51: '3',\n    52: '4',\n    53: '5',\n    54: '6',\n    55: '7',\n    56: '8',\n    57: '9',\n    58: 'Colon',\n    59: 'Semicolon',\n    60: 'Less Than',\n    61: 'Equals2',\n    62: 'Greater Than',\n    63: 'Question Mark',\n    65: 'A',\n    66: 'B',\n    67: 'C',\n    68: 'D',\n    69: 'E',\n    70: 'F',\n    71: 'G',\n    72: 'H',\n    73: 'I',\n    74: 'J',\n    75: 'K',\n    76: 'L',\n    77: 'M',\n    78: 'N',\n    79: 'O',\n    80: 'P',\n    81: 'Q',\n    82: 'R',\n    83: 'S',\n    84: 'T',\n    85: 'U',\n    86: 'V',\n    87: 'W',\n    88: 'X',\n    89: 'Y',\n    90: 'Z',\n    93: 'Context Menu',\n    95: 'Sleep',\n    96: 'Numpad 0',\n    97: 'Numpad 1',\n    98: 'Numpad 2',\n    99: 'Numpad 3',\n    100: 'Numpad 4',\n    101: 'Numpad 5',\n    102: 'Numpad 6',\n    103: 'Numpad 7',\n    104: 'Numpad 8',\n    105: 'Numpad 9',\n    106: 'Numpad *',\n    107: 'Numpad +',\n    109: 'Numpad -',\n    110: 'Numpad .',\n    111: 'Numpad /',\n    112: 'F1',\n    113: 'F2',\n    114: 'F3',\n    115: 'F4',\n    116: 'F5',\n    117: 'F6',\n    118: 'F7',\n    119: 'F8',\n    120: 'F9',\n    121: 'F10',\n    122: 'F11',\n    123: 'F12',\n    124: 'F13',\n    125: 'F14',\n    126: 'F15',\n    127: 'F16',\n    128: 'F17',\n    129: 'F18',\n    130: 'F19',\n    131: 'F20',\n    132: 'F21',\n    133: 'F22',\n    134: 'F23',\n    135: 'F24',\n    144: 'Num Lock',\n    145: 'Scroll Lock',\n    146: 'Win Oem Fj Jisho',\n    147: 'Win Oem Fj Masshou',\n    148: 'Win Oem Fj Touroku',\n    149: 'Win Oem Fj Loya',\n    150: 'Win Oem Fj Roya',\n    160: 'Circumflex',\n    161: 'Exclamation',\n    162: 'Double Quote',\n    163: 'Hash',\n    164: 'Dollar',\n    165: 'Percent',\n    166: 'Ampersand',\n    167: 'Underscore',\n    168: 'Open Paren',\n    169: 'Close Paren',\n    170: 'Asterisk',\n    171: 'Plus',\n    172: 'Pipe',\n    173: 'Hyphen Minus',\n    174: 'Open Curly Bracket',\n    175: 'Close Curly Bracket',\n    176: 'Tilde',\n    181: 'Volume Mute',\n    182: 'Volume Down',\n    183: 'Volume Up',\n    186: ';',\n    187: 'Equals',\n    188: ',',\n    189: 'Minus',\n    190: '.',\n    191: '/',\n    192: '`',\n    219: '[',\n    220: '\\\\',\n    221: ']',\n    222: '\\'',\n    227: 'Win Ico Help',\n    228: 'Win Ico 00',\n    230: 'Win Ico Clear',\n    233: 'Win Oem Reset',\n    234: 'Win Oem Jump',\n    235: 'Win Oem Pa1',\n    236: 'Win Oem Pa2',\n    237: 'Win Oem Pa3',\n    238: 'Win Oem Wsctrl',\n    239: 'Win Oem Cusel',\n    240: 'Win Oem Attn',\n    241: 'Win Oem Finish',\n    242: 'Win Oem Copy',\n    243: 'Win Oem Auto',\n    244: 'Win Oem Enlw',\n    245: 'Win Oem Backtab',\n    246: 'Attn',\n    247: 'Crsel',\n    248: 'Exsel',\n    249: 'Ereof',\n    250: 'Play',\n    251: 'Zoom',\n    253: 'Pa1',\n    254: 'Win Oem Clear'\n};\n\nexport let keyCharToCode = {\n    Cancel: 3,\n    Help: 6,\n    Backspace: 8,\n    Tab: 9,\n    'Pause/Break': 19,\n    'Caps Lock': 20,\n    Esc: 27,\n    Space: 32,\n    'Page Up': 33,\n    'Page Down': 34,\n    End: 35,\n    Home: 36,\n    Left: 37,\n    Up: 38,\n    Right: 39,\n    Down: 40,\n    Insert: 45,\n    Delete: 46,\n    0: 48,\n    1: 49,\n    2: 50,\n    3: 51,\n    4: 52,\n    5: 53,\n    6: 54,\n    7: 55,\n    8: 56,\n    9: 57,\n    A: 65,\n    B: 66,\n    C: 67,\n    D: 68,\n    E: 69,\n    F: 70,\n    G: 71,\n    H: 72,\n    I: 73,\n    J: 74,\n    K: 75,\n    L: 76,\n    M: 77,\n    N: 78,\n    O: 79,\n    P: 80,\n    Q: 81,\n    R: 82,\n    S: 83,\n    T: 84,\n    U: 85,\n    V: 86,\n    W: 87,\n    X: 88,\n    Y: 89,\n    Z: 90,\n    'Numpad 0': 96,\n    'Numpad 1': 97,\n    'Numpad 2': 98,\n    'Numpad 3': 99,\n    'Numpad 4': 100,\n    'Numpad 5': 101,\n    'Numpad 6': 102,\n    'Numpad 7': 103,\n    'Numpad 8': 104,\n    'Numpad 9': 105,\n    'Numpad *': 106,\n    'Numpad +': 107,\n    'Numpad -': 109,\n    'Numpad .': 110,\n    'Numpad /': 111,\n    F1: 112,\n    F2: 113,\n    F3: 114,\n    F4: 115,\n    F5: 116,\n    F6: 117,\n    F7: 118,\n    F8: 119,\n    F9: 120,\n    F10: 121,\n    F11: 122,\n    F12: 123,\n    'Num Lock': 144,\n    'Scroll Lock': 145,\n    ';': 186,\n    ',': 188,\n    '.': 190,\n    '/': 191,\n    '`': 192,\n    '[': 219,\n    '\\\\': 220,\n    ']': 221,\n    '\\'': 222,\n    Kana: 21,\n    Eisu: 22,\n    Junja: 23,\n    Final: 24,\n    Hanja: 25,\n    Convert: 28,\n    Nonconvert: 29,\n    Accept: 30,\n    Modechange: 31,\n    Select: 41,\n    Print: 42,\n    Execute: 43,\n    Printscreen: 44,\n    Colon: 58,\n    Semicolon: 59,\n    'Less Than': 60,\n    Equals2: 61,\n    'Greater Than': 62,\n    'Question Mark': 63,\n    'Context Menu': 93,\n    Sleep: 95,\n    F13: 124,\n    F14: 125,\n    F15: 126,\n    F16: 127,\n    F17: 128,\n    F18: 129,\n    F19: 130,\n    F20: 131,\n    F21: 132,\n    F22: 133,\n    F23: 134,\n    F24: 135,\n    'Win Oem Fj Jisho': 146,\n    'Win Oem Fj Masshou': 147,\n    'Win Oem Fj Touroku': 148,\n    'Win Oem Fj Loya': 149,\n    'Win Oem Fj Roya': 150,\n    Circumflex: 160,\n    Exclamation: 161,\n    'Double Quote': 162,\n    Hash: 163,\n    Dollar: 164,\n    Percent: 165,\n    Ampersand: 166,\n    Underscore: 167,\n    'Open Paren': 168,\n    'Close Paren': 169,\n    Asterisk: 170,\n    Plus: 171,\n    Pipe: 172,\n    'Hyphen Minus': 173,\n    'Open Curly Bracket': 174,\n    'Close Curly Bracket': 175,\n    Tilde: 176,\n    'Volume Mute': 181,\n    'Volume Down': 182,\n    'Volume Up': 183,\n    Equals: 187,\n    Minus: 189,\n    'Win Ico Help': 227,\n    'Win Ico 00': 228,\n    'Win Ico Clear': 230,\n    'Win Oem Reset': 233,\n    'Win Oem Jump': 234,\n    'Win Oem Pa1': 235,\n    'Win Oem Pa2': 236,\n    'Win Oem Pa3': 237,\n    'Win Oem Wsctrl': 238,\n    'Win Oem Cusel': 239,\n    'Win Oem Attn': 240,\n    'Win Oem Finish': 241,\n    'Win Oem Copy': 242,\n    'Win Oem Auto': 243,\n    'Win Oem Enlw': 244,\n    'Win Oem Backtab': 245,\n    Attn: 246,\n    Crsel: 247,\n    Exsel: 248,\n    Ereof: 249,\n    Play: 250,\n    Zoom: 251,\n    Pa1: 253,\n    'Win Oem Clear': 254\n\n};\n\nexport function clone(obj, replacer?) {\n    return JSON.parse(JSON.stringify(obj, replacer));\n}\n\n/*\nexport function cloneObject(obj) {\n    if (!obj) return obj;\n    const nObj = {};\n    let prop;\n    for (prop in obj) {\n        if (!obj.hasOwnProperty(prop)) continue;\n        if (obj[prop])\n            nObj[prop] = obj[prop];\n        else if (typeof obj[prop] === 'object')\n            nObj[prop] = cloneObject(obj[prop]);\n        else if (Array.isArray(obj[prop]))\n            nObj[prop] = cloneArray(obj[prop]);\n        else\n            nObj[prop] = obj[prop];\n    }\n    return nObj;\n}\n\nexport function cloneArray(arr) {\n    if (!arr || arr.length === 0) return new Array();\n    const nArr = new Array(arr.length);\n    let l = arr.length;\n    while (l--) {\n        if (typeof arr[l] === 'object')\n            nArr[l] = cloneObject(arr[l]);\n        else if (Array.isArray(arr[l]))\n            nArr[l] = cloneArray(arr[l]);\n        else\n            nArr[l] = cloneObject(arr[l]);\n    }\n    return nArr;\n}\n*/\nexport function copy(o) {\n    let output;\n    let v;\n    let key;\n    if (!o || (typeof o !== 'object' && !Array.isArray(o)))\n        return o;\n    output = Array.isArray(o) ? [] : {};\n    for (key in o) {\n        if (!o.hasOwnProperty(key)) continue;\n        v = o[key];\n        output[key] = (v && (typeof v === 'object' || Array.isArray(v))) ? copy(v) : v;\n    }\n    return output;\n}\n\nexport function setSelectionRange(input, selectionStart, selectionEnd) {\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(selectionStart, selectionEnd);\n    }\n    else if (input.createTextRange) {\n        const range = input.createTextRange();\n        range.collapse(true);\n        range.moveEnd('character', selectionEnd);\n        range.moveStart('character', selectionStart);\n        range.select();\n    }\n}\n\nexport function selectAll(input) {\n    if (!input || input.value.length === 0) return;\n    if (input.setSelectionRange) {\n        input.focus();\n        input.setSelectionRange(0, input.value.length);\n    }\n    else\n        input.select();\n}\n/*\nexport function getSelectionText() {\n    let text = '';\n    if (window.getSelection)\n        text = window.getSelection().toString();\n    return text;\n}\n*/\nCanvasRenderingContext2D.prototype.fillRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.fill();\n};\n\nCanvasRenderingContext2D.prototype.strokeRoundedRect = function (this, x: number, y: number, w: number, h: number, r: number) {\n    this.beginPath();\n    this.moveTo(x + r, y);\n    this.lineTo(x + w - r, y);\n    this.quadraticCurveTo(x + w, y, x + w, y + r);\n    this.lineTo(x + w, y + h - r);\n    this.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n    this.lineTo(x + r, y + h);\n    this.quadraticCurveTo(x, y + h, x, y + h - r);\n    this.lineTo(x, y + r);\n    this.quadraticCurveTo(x, y, x + r, y);\n    this.closePath();\n    this.stroke();\n};\n\nif (!Object.keys) Object.keys = function (o) {\n    if (o !== Object(o))\n        throw new TypeError('Object.keys called on a non-object');\n    let k = [], p;\n    for (p in o) if (Object.prototype.hasOwnProperty.call(o, p)) k.push(p);\n    return k;\n};\n\nif (!Object.toType) Object.toType = function (obj) {\n    return ({}).toString.call(obj).match(/\\s([a-z|A-Z]+)/)[1].toLowerCase();\n};\n\nif (typeof String.prototype.startsWith != 'function') {\n    String.prototype.startsWith = function (str) {\n        return this.slice(0, str.length) == str;\n    };\n}\n\nif (typeof String.prototype.endsWith != 'function') {\n    String.prototype.endsWith = function (str) {\n        return this.slice(-str.length) == str;\n    };\n}\n\nif (typeof String.prototype.splice !== 'function') {\n    String.prototype.splice = function (this: string, idx: number, s: string, rem?: number) {\n        if (typeof rem === 'undefined') rem = 0;\n        return (this.slice(0, idx) + s + this.slice(idx + Math.abs(rem)));\n    };\n}\n\nif (typeof String.prototype.padStart !== 'function') {\n    String.prototype.padStart = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number')\n            paddingValue = ' '.repeat(paddingValue);\n        return String(paddingValue + this).slice(-paddingValue.length);\n    };\n}\n\nif (typeof String.prototype.padEnd !== 'function') {\n    String.prototype.padEnd = function (this: string, paddingValue: (string | number)) {\n        if (typeof paddingValue === 'number') {\n            if (paddingValue <= this.length) return this;\n            paddingValue = ' '.repeat(paddingValue - this.length);\n            return this + paddingValue;\n        }\n        if (paddingValue.length <= this.length) return this;\n        return this + paddingValue.slice(-this.length);\n    };\n}\n\nif (!String.prototype.replaceAll) {\n    String.prototype.replaceAll = function (str, newStr) {\n\n        // If a regex pattern\n        if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {\n            return this.replace(str, newStr);\n        }\n\n        // If a string\n        return this.replace(new RegExp(str, 'g'), newStr);\n    };\n}\n\nif (typeof Uint8Array.prototype.charAt != 'function') {\n    Uint8Array.prototype.charAt = function (this: Uint8Array, idx: number) {\n        return String.fromCharCode(this[idx]);\n    };\n}\n\nif (typeof Uint8Array.prototype.charCodeAt != 'function') {\n    Uint8Array.prototype.charCodeAt = function (this: Uint8Array, idx: number) {\n        return this[idx];\n    };\n}\n\n/*\nexport function addSlashes(string, all?) {\n    if (!string || !string.length) return string;\n    if (all)\n        return string.replace(/\\\\/g, '\\\\\\\\').\n            replace(/\\u0008/g, '\\\\b').\n            replace(/\\t/g, '\\\\t').\n            replace(/\\n/g, '\\\\n').\n            replace(/\\f/g, '\\\\f').\n            replace(/\\r/g, '\\\\r').\n            replace(/'/g, '\\\\\\'').\n            replace(/\"/g, '\\\\\"').\n            replace(/\\u0000/g, '\\\\0');\n    return string.replace(/\\\\/g, '\\\\\\\\').\n        replace(/'/g, '\\\\\\'').\n        replace(/\"/g, '\\\\\"');\n}\n\nString.prototype.addSlashes = function (this: string) {\n    //no need to do (str+'') anymore because 'this' can only be a string\n    return addSlashes(this);\n}\n*/\n\nString.prototype.splitQuote = function (this: string, sep: string, type?, escape?, escapeChar?) {\n    if (this.length === 0)\n        return [];\n    if (!sep || !sep.length)\n        return [this];\n    if (!type) type = 1 | 2;\n    if (!escape) escape = 1 | 2;\n    if (!escapeChar) escapeChar = '\\\\';\n    let quote: boolean = false;\n    let sQuote: boolean = false;\n    const str = [];\n    let pS = 0;\n    let s = 0;\n    let c: string;\n    let pC = '';\n    let sp;\n    const spl = sep.length;\n    let spC: string;\n    const tl = this.length;\n    for (; s < tl; s++) {\n        c = this.charAt(s);\n        if (c === '\"' && (type & 2) === 2) {\n            if ((escape & 2) === 2) {\n                if (s === 0 || pC !== escapeChar)\n                    quote = !quote;\n            }\n            else\n                quote = !quote;\n        }\n        else if (c === '\\'' && (type & 1) === 1) {\n            if ((escape & 1) === 1) {\n                if (s === 0 || pC !== escapeChar)\n                    sQuote = !sQuote;\n            }\n            else\n                sQuote = !sQuote;\n        }\n        else if (!quote && !sQuote) {\n            for (sp = 0; sp < spl; sp++) {\n                spC = sep.charAt(sp);\n                if (c === spC) {\n                    if (s > pS || s === 0) {\n                        str.push(this.substr(pS, s - pS));\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === pS) {\n                        str.push('');\n                        pS = s + 1;\n                        break;\n                    }\n                    else if (s === tl - 1)\n                        str.push('');\n                }\n            }\n        }\n        pC = c;\n    }\n    if (s === tl && s === pS && sep.indexOf(pC) !== -1) {\n        str.push('');\n        pS = s + 1;\n    }\n    if (s > pS)\n        str.push(this.substr(pS, s - pS));\n    return str;\n};\n\nexport function getTimeSpan(i: number): string {\n    let al;\n    const tmp = [];\n\n    al = Math.floor(i / (1000 * 60 * 60 * 24));\n    i -= al * (1000 * 60 * 60 * 24);\n    if (al === 1) tmp.push(al + ' day');\n    else if (al > 0) tmp.push(al + ' days');\n\n    al = Math.floor(i / (1000 * 60 * 60));\n    i -= al * (1000 * 60 * 60);\n    if (al === 1) tmp.push(al + ' hour');\n    else if (al > 0) tmp.push(al + ' hours');\n\n    al = Math.floor(i / (1000 * 60));\n    i -= al * (1000 * 60);\n    if (al === 1) tmp.push(al + ' minute');\n    else if (al > 0) tmp.push(al + ' minutes');\n\n    al = Math.floor(i / (1000));\n    i -= al * (1000);\n    if (al === 1) tmp.push(al + ' second');\n    else if (al > 0) tmp.push(al + ' seconds');\n    if (tmp.length === 0)\n        tmp.push('0 seconds');\n    return tmp.join(', ');\n}\n\nexport function naturalCompare(a, b) {\n    const ax = [];\n    const bx = [];\n\n    a.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { ax.push([$1 || Infinity, $2 || '']); });\n    b.replace(/(\\d+)|(\\D+)/g, (_, $1, $2) => { bx.push([$1 || Infinity, $2 || '']); });\n\n    while (ax.length && bx.length) {\n        const an = ax.shift();\n        const bn = bx.shift();\n        const nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);\n        if (nn) return nn;\n    }\n\n    return ax.length - bx.length;\n}\n/*\nexport function getScrollBarWidth(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetWidth;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    if (w1 === w2) w2 = el.clientWidth;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n*/\n/*\nexport function getScrollBarHeight(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n    const w1 = inner.offsetHeight;\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return (w1 - w2);\n}\n\nexport function getScrollBarSize(el) {\n    if (!el) return 0;\n    const inner = document.createElement('p');\n    inner.style.width = '100%';\n    inner.style.height = '100%';\n    inner.style.position = 'absolute';\n    inner.style.top = '0px';\n    inner.style.left = '0px';\n    inner.style.visibility = 'hidden';\n\n    el.style.overflowY = 'hidden';\n    el.style.overflowX = 'hidden';\n\n    el.appendChild(inner);\n\n    const w1 = inner.offsetWidth;\n    const h1 = inner.offsetHeight;\n\n    el.style.overflowY = '';\n    el.style.overflowX = '';\n\n    let w2 = inner.offsetWidth;\n    let h2 = inner.offsetHeight;\n    if (w1 === w2) w2 = el.clientWidth;\n    if (h1 === h2) h2 = el.clientHeight;\n\n    el.removeChild(inner);\n\n    return [(w1 - w2), (h1 - h2)];\n}\n*/\nexport function formatSize(size) {\n    if (size >= 1073741824)\n        return Math.round(size / 1073741824).toLocaleString() + ' GB';\n    else if (size >= 1048576)\n        return Math.round(size / 1048576).toLocaleString() + ' MB';\n    else if (size >= 1024)\n        return Math.round(size / 1024).toLocaleString() + ' KB';\n    return size.toLocaleString() + ' B';\n}\n\nexport function capitalize(s, first?) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = first ? 1 : s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if ((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')) {\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1).toLowerCase();\n                break;\n            }\n        }\n    }\n    return s.join(' ');\n}\n/*\nexport function capitalizePinkfish(s) {\n    const p = _string_parts(s);\n    if (p.length !== 3)\n        return capitalize(s, true);\n    return p[0] + capitalize(p[1], true) + p[2];\n}\n\nfunction _is_color(str) {\n    if (!_colorCodes)\n        _loadColors();\n    if (!str)\n        return false;\n    if (_colorCodes[str])\n        return true;\n    switch (str) {\n        case 'ITALIC':\n        case 'UNDERLINE':\n        case 'STRIKEOUT':\n        case 'DBLUNDERLINE':\n        case 'OVERLINE':\n        case 'FLASH':\n        case 'REVERSE':\n        case 'RESET':\n        case 'DEFAULT':\n        case 'BOLD':\n            return true;\n    }\n    return false;\n}\n\nfunction _string_parts(str) {\n    let tmp;\n    let t2;\n    let ss;\n    let se;\n    let sm;\n    let s;\n    let e;\n    let c;\n    //more accurate then a regex even if slower in some cases\n    if (!str.length) return ['', '', ''];\n    tmp = str.split('%^');\n    c = tmp.length;\n    if (c === 1)\n        return ['', str, ''];\n\n    if (tmp[0].length === 0) {\n        for (s = 0; s < c; s++) {\n            t2 = tmp[s];\n            if (!t2.length) continue;\n            if (!_is_color(t2)) {\n                s--;\n                break;\n            }\n        }\n    }\n    else\n        s--;\n    if (tmp[c - 1].length === 0) {\n        for (e = c - 1; e > s; e--) {\n            t2 = tmp[e];\n            if (!t2.length) continue;\n            if (!_is_color(t2)) {\n                e++;\n                break;\n            }\n        }\n    }\n    else\n        e = c;\n    sm = tmp.slice(s + 1, e).join('%^');\n    if (!sm.length)\n        return [str, '', ''];\n    ss = tmp.slice(0, s + 1).join('%^');\n    se = tmp.slice(e).join('%^');\n    if (sm.length) {\n        if (ss.length)\n            ss += '%^';\n        if (se.length)\n            se = '%^' + se;\n    }\n    return [ss, sm, se];\n}\n*/\n/*\nexport function inverse(s) {\n    if (!s) return '';\n    s = s.split(' ');\n    let c;\n    let i;\n    let p;\n    const il = s.length;\n    for (i = 0; i < il; i++) {\n        const pl = s[i].length;\n        for (p = 0; p < pl; p++) {\n            c = s[i].charAt(p);\n            if (c >= 'A' && c <= 'Z')\n                s[i] = s[i].substr(0, p) + c.toLowerCase() + s[i].substr(p + 1);\n            else if (c >= 'a' && c <= 'z')\n                s[i] = s[i].substr(0, p) + c.toUpperCase() + s[i].substr(p + 1);\n        }\n    }\n    return s.join(' ');\n}\n\nexport function invert(obj) {\n    const new_obj = {};\n    let prop;\n    for (prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            new_obj[obj[prop]] = prop;\n        }\n    }\n    return new_obj;\n}\n\nexport function Cardinal(x) {\n    let str;\n    if (x === 0) return 'zero';\n    if (x < 0) {\n        str = 'negative ';\n        x = Math.abs(x);\n    }\n    else\n        str = '';\n    switch (x) {\n        case 1:\n            return str + 'one';\n        case 2:\n            return str + 'two';\n        case 3:\n            return str + 'three';\n        case 4:\n            return str + 'four';\n        case 5:\n            return str + 'five';\n        case 6:\n            return str + 'six';\n        case 7:\n            return str + 'seven';\n        case 8:\n            return str + 'eight';\n        case 9:\n            return str + 'nine';\n        case 10:\n            return str + 'ten';\n        case 11:\n            return str + 'eleven';\n        case 12:\n            return str + 'twelve';\n        case 13:\n            return str + 'thirteen';\n        case 14:\n            return str + 'fourteen';\n        case 15:\n            return str + 'fifteen';\n        case 16:\n            return str + 'sixteen';\n        case 17:\n            return str + 'seventeen';\n        case 18:\n            return str + 'eighteen';\n        case 19:\n            return str + 'nineteen';\n        case 20:\n            return str + 'twenty';\n        default:\n            if (x > 1000000000)\n                return 'over a billion';\n            else if (x / 1000000 > 0) {\n                if (x % 1000000 > 0)\n                    return +' million ' + Cardinal(x % 1000000);\n                return Cardinal((x / 1000000) >> 0) + ' million';\n            }\n            else if (x / 1000 > 0) {\n                if (x % 1000 > 0)\n                    return Cardinal((x / 1000) >> 0) + ' thousand ' + Cardinal(x % 1000);\n                return Cardinal((x / 1000) >> 0) + ' thousand';\n            }\n            else if (x / 100 > 0) {\n                if (x % 100 > 0)\n                    return Cardinal((x / 100) >> 0) + ' hundred' + Cardinal(x % 100);\n                return Cardinal((x / 100) >> 0) + ' hundred';\n            }\n            else {\n                if (x % 10 > 0)\n                    str = '-' + Cardinal(x % 10);\n                else\n                    str = '';\n                switch (x / 10) {\n                    case 2:\n                        return 'twenty' + str;\n                    case 3:\n                        return 'thirty' + str;\n                    case 4:\n                        return 'forty' + str;\n                    case 5:\n                        return 'fifty' + str;\n                    case 6:\n                        return 'sixty' + str;\n                    case 7:\n                        return 'seventy' + str;\n                    case 8:\n                        return 'eighty' + str;\n                    case 9:\n                        return 'ninety' + str;\n                    default:\n                        return 'error';\n                }\n            }\n    }\n}\n\nexport function wordwrap(str, maxWidth, newLineStr?) {\n    let done = false;\n    let res = '';\n    let found;\n    let i;\n    newLineStr = newLineStr || '\\n';\n    do {\n        found = false;\n        // Inserts new line at first whitespace of the line\n        for (i = maxWidth - 1; i >= 0; i--) {\n            if (_testWhite(str.charAt(i))) {\n                res = res + [str.slice(0, i + 1), newLineStr].join('');\n                str = str.slice(i + 1);\n                found = true;\n                break;\n            }\n        }\n        // Inserts new line at maxWidth position, the word is too long to wrap\n        if (!found) {\n            res += [str.slice(0, maxWidth), newLineStr].join('');\n            str = str.slice(maxWidth);\n        }\n\n        if (str.length < maxWidth)\n            done = true;\n    } while (!done);\n    if (str.length > 0)\n        return res + str;\n    return res;\n}\n\nfunction _testWhite(x) {\n    return /^\\s$/.test(x.charAt(0));\n}\n*/\nexport function splitQuoted(str, sep, t?, e?, ec?) {\n    if (typeof (t) === 'undefined') t = 1 | 2;\n    if (typeof (e) === 'undefined') e = 0;\n    if (typeof (ec) === 'undefined') ec = '\\\\';\n    if (!str || str.length === 0)\n        return [];\n    if (!sep || sep.length === 0)\n        return [str];\n    sep = sep.split('');\n    let q = false;\n    let sq = false;\n    const strings = [];\n    let ps = 0;\n    let s = 0;\n    const sl = str.length;\n    let c;\n    for (; s < sl; s++) {\n        c = str.charAt(s);\n        if (c === '\"' && (t & 2) === 2) {\n            if ((e & 2) === 2 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    q = !q;\n            }\n            else\n                q = !q;\n        }\n        else if (c === '\\'' && (t & 1) === 1) {\n            if ((e & 1) === 1 && s > 0) {\n                if (s - 1 > 0 && str.charAt(s - 1) !== ec)\n                    sq = !sq;\n            }\n            else\n                sq = !sq;\n        }\n        else if (!sq && !q) {\n            const spl = sep.length;\n            for (let sp = 0; sp < spl; sp++) {\n                if (c === sep[sp]) {\n                    if (s > ps || s === 0) {\n                        strings.push(str.substring(ps, s));\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === ps) {\n                        strings.push('');\n                        ps = s + 1;\n                        break;\n                    }\n                    else if (s === (sl - 1))\n                        strings.push('');\n                }\n            }\n        }\n    }\n    if (s === sl && s === ps && sep.indexOf(str.charAt(s - 1)) > -1) {\n        strings.push('');\n        ps = s + 1;\n    }\n    if (s > ps)\n        strings.push(str.substring(ps, s));\n    return strings;\n}\n/*\nexport function leadingZeros(num, totalChars: number, padWith: string, trim?: boolean) {\n    num = num + '';\n    padWith = (padWith) ? padWith : '0';\n    if (num.length < totalChars) {\n        while (num.length < totalChars) {\n            num = padWith + num;\n        }\n    }\n    if (trim && num.length > totalChars) {\n        num = num.substring((num.length - totalChars), totalChars);\n    }\n    return num;\n}\n\nexport function resetCursor(txtElement) {\n    txtElement.scrollTop = 0;\n    txtElement.scrollLeft = 0;\n    if (typeof txtElement.selectionStart === 'number') {\n        txtElement.selectionStart = 0;\n        txtElement.selectionEnd = 0;\n    }\n    else if (txtElement.setSelectionRange) {\n        txtElement.focus();\n        txtElement.setSelectionRange(0, 0);\n        txtElement.focus();\n    } else if (txtElement.createTextRange) {\n        const range = txtElement.createTextRange();\n        range.moveStart('character', 0);\n        range.select();\n    }\n}\n\nexport function moveCursorToEnd(el) {\n    el.scrollTop = el.scrollHeight;\n    if (typeof el.selectionStart === 'number') {\n        el.selectionStart = el.selectionEnd = el.value.length;\n    } else if (typeof el.createTextRange !== 'undefined') {\n        el.focus();\n        const range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n    }\n}\n*/\nexport function getCursor(el) {\n    if (!el) return 0;\n    if (typeof el.selectionStart === 'number') {\n        return el.selectionDirection == 'backward' ? el.selectionStart : el.selectionEnd;\n    } else if ((<any>document).selection) {\n        // Set focus on the element\n        el.focus();\n        // To get cursor position, get empty selection range\n        let oSel = (<any>document).selection.createRange();\n        // Move selection start to 0 position\n        oSel.moveStart('character', -el.value.length);\n        // The caret position is selection length\n        return oSel.text.length;\n    }\n    return 0;\n}\n\nexport function stringToEnum(str, en, ignoreCase?) {\n    if (!str || !en) return 0;\n    if (ignoreCase)\n        str = str.toUpperCase();\n    //split strip and trim spaces\n    str = str.split(',').map(v => v.trim());\n    //init value\n    let value = 0;\n    let sl = str.length;\n    //get the enum keys\n    const values = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    let test = values.slice(0);\n    //ignore case just make everything upper\n    if (ignoreCase)\n        test = test.map(v => v.toUpperCase());\n    //loop the strings\n    while (sl--) {\n        let vl = values.length;\n        //loop the enum to try and find the string value\n        while (vl--) {\n            //found value add it on\n            if (test[vl] === str[sl]) {\n                value |= en[values[vl].replace(/ /g, '_')];\n                break;\n            }\n        }\n    }\n    //return final value\n    return value;\n}\n\nexport function enumToString(value, en, exact?) {\n    let state;\n    const states = Object.keys(en).filter(key => !isNaN(Number(en[key])));\n    if (value === 0)\n        return en[0];\n    const f = [];\n    state = states.length;\n    while (state--) {\n        if (en[states[state]] === 0) continue;\n        if (exact) {\n            if (value === en[states[state]])\n                f.push(capitalize(states[state].replace(/_/g, ' ')));\n        }\n        else if ((value & en[states[state]]) === en[states[state]])\n            f.push(capitalize(states[state].replace(/_/g, ' ')));\n    }\n    return f.join(', ');\n}\n/*\n//https://j11y.io/snippets/wordwrap-for-javascript/\nexport function wordWrap(str, width, brk, cut) {\n    brk = brk || 'n';\n    width = width || 75;\n    cut = cut || false;\n    if (!str) return str;\n    const regex = '.{1,' + width + '}(\\s|$)' + (cut ? '|.{' + width + '}|.+$' : '|\\S+?(\\s|$)');\n    return str.match(RegExp(regex, 'g')).join(brk);\n}\n\nexport function wordBreak(str, start, length) {\n    if (length < 0) return 0;\n    let wBreak = length - 1;\n    if (start + wBreak >= str.length)\n        return str.length - start;\n    while (wBreak >= 0 && str.charAt(start + wBreak) !== ' ' && str.charAt(start + wBreak) !== '\\\\')\n        wBreak--;\n    if (wBreak <= 0)\n        return length;\n    wBreak++;\n    return wBreak;\n}\n\nexport function formatString(str, indent, width?, prefix?, postFix?, preIdent?) {\n    if (!str || str.length === 0) return '';\n    width = width || 66;\n    if (width < 40) width = 40;\n    if (typeof prefix !== 'string')\n        prefix = '\"';\n    if (typeof postFix !== 'string')\n        postFix = '\"';\n    preIdent = preIdent || '';\n    if (str.length <= width)\n        return prefix + str + postFix;\n    const list = [];\n    let wBreak = wordBreak(str, 0, width);\n    list.push(str.substr(0, wBreak));\n    let len = str.length - wBreak;\n    let tmp = wBreak; // set start of next line at window width\n    while (len / width > 0) { // while full lines loop\n        wBreak = wordBreak(str, tmp, width);\n        list.push(str.substr(tmp, wBreak));\n        tmp += wBreak; // move to next line\n        len -= wBreak; // remove line width\n    }\n    if (len > 0) // left over\n        list.push(str.substr(tmp, len));\n    return prefix + list.join(postFix + '\\n' + preIdent + ' '.repeat(indent) + prefix) + postFix;\n}\n\nexport function consolidate(amt, str) {\n    let y;\n    let l;\n    let e = '';\n    if (!amt || !str || amt < 2) return str;\n    if (str.endsWith(' ')) {\n        e = ' ';\n        str = str.trim();\n    }\n    str = str.split(' ');\n    if (str[0].toLowerCase() === 'a' || str[0].toLowerCase() === 'an' || str[0].toLowerCase() === 'the')\n        str.shift();\n    l = str.length;\n    y = str.indexOf('of');\n    if (y > 0)\n        str[y - 1] = pluralize(str[y - 1]);\n    else if (str[l - 1].endsWith(')')) {\n        y = l - 1;\n        while (y >= 0) {\n            if (str[y].startsWith('('))\n                break;\n            y--;\n        }\n        if (y - 1 >= 0)\n            str[y - 1] = pluralize(str[y - 1]);\n    }\n    else if (str[l - 1].match(/\\(.*\\)/)) {\n        if (l - 2 >= 0)\n            str[l - 2] = pluralize(str[l - 2]);\n    }\n    else\n        str[l - 1] = pluralize(str[l - 1]);\n    if (amt > 10)\n        return 'numerous ' + str.join(' ') + e;\n    return ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'][amt] + ' ' + str.join(' ') + e;\n}\n\n//spell-checker:disable\nexport function pluralize(revert) {\n    const plural = {\n        '(quiz)$': '$1zes',\n        '^(ox)$': '$1en',\n        '([m|l])ouse$': '$1ice',\n        '(matr|vert|ind)ix|ex$': '$1ices',\n        '(x|ch|ss|sh)$': '$1es',\n        '([^aeiouy]|qu)y$': '$1ies',\n        '(hive)$': '$1s',\n        '(?:([^f])fe|([lr])f)$': '$1$2ves',\n        '(shea|lea|loa|thie)f$': '$1ves',\n        sis$: 'ses',\n        '([ti])um$': '$1a',\n        '(tomat|potat|ech|her|vet)o$': '$1oes',\n        '(bu)s$': '$1ses',\n        '(alias)$': '$1es',\n        '(octop)us$': '$1i',\n        '(ax|test)is$': '$1es',\n        '(us)$': '$1es',\n        '([^s]+)$': '$1s'\n    };\n\n    const singular = {\n        '(quiz)zes$': '$1',\n        '(matr)ices$': '$1ix',\n        '(vert|ind)ices$': '$1ex',\n        '^(ox)en$': '$1',\n        '(alias)es$': '$1',\n        '(octop|vir)i$': '$1us',\n        '(cris|ax|test)es$': '$1is',\n        '(shoe)s$': '$1',\n        '(o)es$': '$1',\n        '(bus)es$': '$1',\n        '([m|l])ice$': '$1ouse',\n        '(x|ch|ss|sh)es$': '$1',\n        '(m)ovies$': '$1ovie',\n        '(s)eries$': '$1eries',\n        '([^aeiouy]|qu)ies$': '$1y',\n        '([lr])ves$': '$1f',\n        '(tive)s$': '$1',\n        '(hive)s$': '$1',\n        '(li|wi|kni)ves$': '$1fe',\n        '(shea|loa|lea|thie)ves$': '$1f',\n        '(^analy)ses$': '$1sis',\n        '((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$': '$1$2sis',\n        '([ti])a$': '$1um',\n        '(n)ews$': '$1ews',\n        '(h|bl)ouses$': '$1ouse',\n        '(corpse)s$': '$1',\n        '(us)es$': '$1',\n        s$: ''\n    };\n\n    const irregular = {\n        move: 'moves',\n        foot: 'feet',\n        goose: 'geese',\n        sex: 'sexes',\n        child: 'children',\n        man: 'men',\n        tooth: 'teeth',\n        person: 'people'\n    };\n\n    const uncountable = [\n        'sheep',\n        'fish',\n        'deer',\n        'moose',\n        'series',\n        'species',\n        'money',\n        'rice',\n        'information',\n        'equipment'\n    ];\n\n    // save some time in the case that singular and plural are the same\n    if (uncountable.indexOf(revert.toLowerCase()) >= 0)\n        return revert;\n    let word;\n    // check for irregular forms\n    for (word in irregular) {\n        if (!irregular.hasOwnProperty(word)) continue;\n        let pattern;\n        let replace;\n        if (revert) {\n            pattern = new RegExp(irregular[word] + '$', 'i');\n            replace = word;\n        } else {\n            pattern = new RegExp(word + '$', 'i');\n            replace = irregular[word];\n        }\n        if (pattern.test(revert))\n            return revert.replace(pattern, replace);\n    }\n    let array;\n    if (revert) array = singular;\n    else array = plural;\n    let reg;\n\n    // check for matches using regular expressions\n    for (reg in array) {\n        if (!array.hasOwnProperty(reg)) continue;\n        const pattern = new RegExp(reg, 'i');\n\n        if (pattern.test(revert))\n            return revert.replace(pattern, array[reg]);\n    }\n\n    return revert;\n}\n//spell-checker:enable\n\nexport function stripPinkfish(text) {\n    text = text || '';\n    text = text.split('%^');\n    const stack = [];\n    let t = 0;\n    const tl = text.length;\n    for (; t < tl; t++) {\n        if (text[t].startsWith('B_') && _is_color(text[t].substr(2)))\n            continue;\n        else if (_is_color(text[t]))\n            continue;\n        stack.push(text[t]);\n    }\n    return stack.join('');\n}\n*/\nlet _colorCodes;\nexport function pinkfishToHTML(text) {\n    text = text || '';\n    text = text.split('%^');\n    if (!_colorCodes)\n        _loadColors();\n    const stack = [];\n    let codes = [];\n    let t = 0;\n    let tl = text.length;\n    let bold = false;\n    let boldNest = false;\n    let classes = [];\n    for (; t < tl; t++) {\n        switch (text[t]) {\n            case 'ITALIC':\n                stack.push('<em>');\n                codes.push('</em>');\n                break;\n            case 'UNDERLINE':\n                classes.push('underline');\n                break;\n            case 'STRIKEOUT':\n                classes.push('strikeout');\n                break;\n            case 'DBLUNDERLINE':\n                classes.push('dblunderline');\n                break;\n            case 'OVERLINE':\n                classes.push('overline');\n                break;\n            case 'FLASH':\n                classes.push('noflash');\n                break;\n            case 'REVERSE':\n                classes.push('reverse');\n                break;\n            case 'RESET':\n            case 'DEFAULT':\n                const cl = codes.length;\n                for (let c = 0; c < cl; c++)\n                    stack.push(codes[c]);\n                codes = [];\n                classes = [];\n                break;\n            case 'BOLD':\n                bold = true;\n                break;\n            case '':\n                break;\n            default:\n                if (text[t].startsWith('B_')) {\n                    text[t] = text[t].substr(2);\n                    if (bold && !boldNest) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;background-color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    bold = false;\n                    continue;\n                }\n                else if (_colorCodes[text[t]]) {\n                    if (bold && !_colorCodes['BOLD%^%^' + text[t]]) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                    }\n                    else if (bold) {\n                        stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^' + text[t]] + '\">');\n                        codes.push('</span>');\n                        boldNest = true;\n                        continue;\n                    }\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes[text[t]] + '\">');\n                    codes.push('</span>');\n                    continue;\n                }\n                else if (bold && !boldNest) {\n                    stack.push('<span style=\"border: inherit;text-decoration:inherit;color: #' + _colorCodes['BOLD%^%^WHITE'] + '\">');\n                    codes.push('</span>');\n                }\n                if (classes.length) {\n                    stack.push('<span class=\"' + classes.join(' ') + '\">');\n                    codes.push('</span>');\n                    classes = [];\n                }\n                stack.push(text[t]);\n                bold = false;\n                boldNest = false;\n                break;\n        }\n    }\n    if (classes.length) {\n        stack.push('<span class=\"' + classes.join(' ') + '\">');\n        codes.push('</span>');\n    }\n    for (t = 0, tl = codes.length; t < tl; t++)\n        stack.push(codes[t]);\n    return stack.join('');\n}\n\nfunction _loadColors() {\n    let c;\n    let color;\n    let r;\n    let g;\n    let b;\n    let idx;\n    _colorCodes = {};\n\n    _colorCodes['BLACK'] = '000000';\n    _colorCodes['RED'] = '800000';\n    _colorCodes['GREEN'] = '008000';\n    _colorCodes['ORANGE'] = '808000';\n    _colorCodes['BLUE'] = '0000EE';\n    _colorCodes['MAGENTA'] = '800080';\n    _colorCodes['CYAN'] = '008080';\n    _colorCodes['WHITE'] = 'BBBBBB';\n    _colorCodes['mono11'] = '808080';\n    _colorCodes['BOLD%^%^RED'] = 'FF0000';\n    _colorCodes['BOLD%^%^GREEN'] = '00FF00';\n    _colorCodes['YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^YELLOW'] = 'FFFF00';\n    _colorCodes['BOLD%^%^BLUE'] = '5C5CFF';\n    _colorCodes['BOLD%^%^MAGENTA'] = 'FF00FF';\n    _colorCodes['BOLD%^%^CYAN'] = '00FFFF';\n    _colorCodes['BOLD%^%^WHITE'] = 'FFFFFF';\n    _colorCodes['BOLD%^%^BLACK'] = '808080';\n\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = `RGB${r}${g}${b}`;\n                color = '';\n                c = 0;\n                c = r * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = g * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                c = 0;\n                c = b * 40 + 55;\n                if (c < 16)\n                    color += '0';\n                color += c.toString(16);\n                if (!_colorCodes[idx])\n                    _colorCodes[idx] = color.toUpperCase();\n            }\n        }\n    }\n\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        if (g < 16)\n            g = '0' + g.toString(16).toUpperCase();\n        else\n            g = g.toString(16).toUpperCase();\n        g = g + g + g;\n        if (r < 242)\n            _colorCodes['mono0' + (r - 232)] = g;\n        else\n            _colorCodes['mono' + (r - 232)] = g;\n    }\n}\n\nexport function getColors() {\n    const _ColorTable = [];\n    let r;\n    let g;\n    let b;\n    let idx;\n    for (r = 0; r < 6; r++) {\n        for (g = 0; g < 6; g++) {\n            for (b = 0; b < 6; b++) {\n                idx = 16 + (r * 36) + (g * 6) + b;\n                _ColorTable[idx] = 'rgb(';\n                if (r > 0)\n                    _ColorTable[idx] += r * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (g > 0)\n                    _ColorTable[idx] += g * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ',';\n                if (b > 0)\n                    _ColorTable[idx] += b * 40 + 55;\n                else\n                    _ColorTable[idx] += '0';\n                _ColorTable[idx] += ')';\n            }\n        }\n    }\n    for (r = 232; r <= 255; r++) {\n        g = (r - 232) * 10 + 8;\n        _ColorTable[r] = ['rgb(', g, ',', g, ',', g, ')'].join('');\n    }\n    _ColorTable[0] = 'rgb(0,0,0)'; //black fore\n    _ColorTable[1] = 'rgb(128, 0, 0)'; //red fore\n    _ColorTable[2] = 'rgb(0, 128, 0)'; //green fore\n    _ColorTable[3] = 'rgb(128, 128, 0)'; //yellow fore\n    _ColorTable[4] = 'rgb(0, 0, 238)'; //blue fore\n    _ColorTable[5] = 'rgb(128, 0, 128)'; //magenta fore\n    _ColorTable[6] = 'rgb(0, 128, 128)'; //cyan fore\n    _ColorTable[7] = 'rgb(187, 187, 187)'; //white fore\n    _ColorTable[8] = 'rgb(128, 128, 128)'; //black  bold\n    _ColorTable[9] = 'rgb(255, 0, 0)'; //Red bold\n    _ColorTable[10] = 'rgb(0, 255, 0)'; //green bold\n    _ColorTable[11] = 'rgb(255, 255, 0)'; //yellow bold\n    _ColorTable[12] = 'rgb(92, 92, 255)'; //blue bold\n    _ColorTable[13] = 'rgb(255, 0, 255)'; //magenta bold\n    _ColorTable[14] = 'rgb(0, 255, 255)'; //cyan bold\n    _ColorTable[15] = 'rgb(255, 255, 255)'; //white bold\n    _ColorTable[256] = 'rgb(0, 0, 0)'; //black faint\n    _ColorTable[257] = 'rgb(118, 0, 0)'; //red  faint\n    _ColorTable[258] = 'rgb(0, 108, 0)'; //green faint\n    _ColorTable[259] = 'rgb(145, 136, 0)'; //yellow faint\n    _ColorTable[260] = 'rgb(0, 0, 167)'; //blue faint\n    _ColorTable[261] = 'rgb(108, 0, 108)'; //magenta faint\n    _ColorTable[262] = 'rgb(0, 108, 108)'; //cyan faint\n    _ColorTable[263] = 'rgb(161, 161, 161)'; //white faint\n    _ColorTable[264] = 'rgb(0, 0, 0)'; //BackgroundBlack\n    _ColorTable[265] = 'rgb(128, 0, 0)'; //red back\n    _ColorTable[266] = 'rgb(0, 128, 0)'; //greenback\n    _ColorTable[267] = 'rgb(128, 128, 0)'; //yellow back\n    _ColorTable[268] = 'rgb(0, 0, 238)'; //blue back\n    _ColorTable[269] = 'rgb(128, 0, 128)'; //magenta back\n    _ColorTable[270] = 'rgb(0, 128, 128)'; //cyan back\n    _ColorTable[271] = 'rgb(187, 187, 187)'; //white back\n    _ColorTable[272] = 'rgb(0,0,0)'; //InfoBackground\n    _ColorTable[273] = 'rgb(0, 255, 255)'; //InfoText\n    _ColorTable[274] = 'rgb(0,0,0)'; //LocalEchoBackground\n    _ColorTable[275] = 'rgb(255, 255, 0)'; //LocalEchoText\n    _ColorTable[276] = 'rgb(0, 0, 0)'; //DefaultBack\n    _ColorTable[277] = 'rgb(229, 229, 229)'; //DefaultFore\n    _ColorTable[278] = 'rgb(205, 0, 0)'; //ErrorFore\n    _ColorTable[279] = 'rgb(229, 229, 229)'; //ErrorBack\n    _ColorTable[280] = 'rgb(255,255,255)'; //DefaultBrightFore\n    return _ColorTable;\n}\n\nexport function formatUnit(str, ch?) {\n    if (!str) return str;\n    if (/^\\d+c$/.test(str)) {\n        if (ch)\n            return (parseInt(str, 10) * ch) + 'px';\n        return str + 'h';\n    }\n    if (/^\\d+$/.test(str))\n        return parseInt(str, 10) + 'px';\n    return str;\n}\n\n/*\nexport function replaceHtml(el, html) {\n    const oldEl = typeof el === 'string' ? document.getElementById(el) : el;\n    */\n/*@cc_on // Pure innerHTML is slightly faster in IE\n    oldEl.innerHTML = html;\n    return oldEl;\n@*/\n/*\nconst newEl = oldEl.cloneNode(false);\nnewEl.innerHTML = html;\noldEl.parentNode.replaceChild(newEl, oldEl);\nreturn newEl;\n}\n*/\nexport function isValidIdentifier(str: string): boolean {\n    if (!str || str.length === 0) return false;\n    //valid character check\n    if (!str.match(/^[a-zA-Z_$][a-zA-Z_$0-9]*$/g))\n        return false;\n    //not a keyword\n    return ['break', 'case', 'catch', 'continue', 'debugger', 'default', 'delete', 'do', 'else', 'finally', 'for', 'function', 'if', 'in', 'instanceof', 'new', 'return', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with', 'class', 'const', 'enum', 'export', 'extends', 'import', 'super', 'implements', 'interface', 'let', 'package', 'private', 'protected', 'public', 'static', 'yield', 'null', 'true', 'false', 'NaN', 'Infinity', 'undefined', 'eval', 'arguments'].indexOf(str) === -1;\n}\n\n/*\nexport function escapeRegExp(string) {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n*/\n\nexport function insertValue(input, value) {\n    if (!input) return;\n    const active = <HTMLElement>document.activeElement;\n    if (!active || active != input)\n        input.focus();\n    if (!document.execCommand('insertText', false, value)) {\n        //failed so try old school manually replace\n        var startPos = input.selectionStart;\n        var endPos = input.selectionEnd;\n        input.value = input.value.substring(0, startPos)\n            + value\n            + input.value.substring(endPos, input.value.length);\n        input.selectionStart = startPos;\n        input.selectionEnd = startPos + value.length;\n    }\n    if (active && active != input)\n        active.focus();\n}\n\nif (!Array.isArray) {\n    (<any>Array.isArray) = function (arg) {\n        return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n}\n\nlet _txtDecoder;\nexport function ArrayBufferToString(buffer) {\n    if (window.TextDecoder !== undefined) {\n        return (_txtDecoder || (_txtDecoder = new TextDecoder())).decode(new Uint8Array(buffer));\n    }\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(new Uint8Array(buffer))));\n}\n\nexport function Uint8ArrayToString(buffer) {\n    if (window.TextDecoder !== undefined)\n        return (_txtDecoder || (_txtDecoder = new TextDecoder())).decode(buffer);\n    return BinaryToString(String.fromCharCode.apply(null, Array.prototype.slice.apply(buffer)));\n}\n\nexport function StringToArrayBuffer(string) {\n    return StringToUint8Array(string).buffer;\n}\n\nexport function BinaryToString(binary) {\n    let error;\n\n    try {\n        return decodeURIComponent(escape(binary));\n    } catch (_error) {\n        error = _error;\n        if (error instanceof URIError) {\n            return binary;\n        } else {\n            throw error;\n        }\n    }\n}\n\nexport function StringToBinary(string) {\n    let chars, code, i, isUCS2, len, _i;\n\n    len = string.length;\n    chars = [];\n    isUCS2 = false;\n    for (i = _i = 0; 0 <= len ? _i < len : _i > len; i = 0 <= len ? ++_i : --_i) {\n        code = String.prototype.charCodeAt.call(string, i);\n        if (code > 255) {\n            isUCS2 = true;\n            chars = null;\n            break;\n        } else {\n            chars.push(code);\n        }\n    }\n    if (isUCS2 === true) {\n        return unescape(encodeURIComponent(string));\n    } else {\n        return String.fromCharCode.apply(null, Array.prototype.slice.apply(chars));\n    }\n}\n\nlet _txtEncoder;\nexport function StringToUint8Array(string) {\n    let binary, binLen, buffer, chars, i, _i;\n    if (window.TextEncoder !== undefined)\n        return (_txtEncoder || (_txtEncoder = new TextEncoder())).encode(string);\n    binary = StringToBinary(string);\n    binLen = binary.length;\n    buffer = new ArrayBuffer(binLen);\n    chars = new Uint8Array(buffer);\n    for (i = _i = 0; 0 <= binLen ? _i < binLen : _i > binLen; i = 0 <= binLen ? ++_i : --_i) {\n        chars[i] = String.prototype.charCodeAt.call(binary, i);\n    }\n    return chars;\n}\n\nfunction _createTextarea(text?) {\n    let textarea = document.createElement('textarea');\n    if (text) {\n        textarea.value = text;\n        textarea.textContent = text;\n    }\n    textarea.style.position = 'fixed';\n    textarea.style.width = '2em';\n    textarea.style.height = '2em';\n    textarea.style.padding = '0';\n    textarea.style.border = 'none';\n    textarea.style.outline = 'none';\n    textarea.style.boxShadow = 'none';\n    textarea.style.background = 'transparent';\n    document.body.appendChild(textarea);\n    textarea.focus();\n    textarea.select();\n    return textarea;\n}\n\n//attempt to copy text to clipboard, may or may not always work depending on permissions and browser\nexport function copyText(text: string) {\n    return new Promise(function (resolve, reject) {\n        try {\n            if (typeof navigator !== 'undefined' && typeof navigator.clipboard !== 'undefined' && typeof navigator.permissions !== 'undefined') {\n                let blob = new Blob([text], { type: 'text/plain' });\n                let data = [new ClipboardItem({ 'text/plain': blob })];\n                navigator.permissions.query({ name: 'clipboard-write' as PermissionName }).then(function (permission) {\n                    if (permission.state === 'granted' || permission.state === 'prompt') {\n                        navigator.clipboard.write(data).then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error('Permission not granted!'));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported('copy')) {\n                let textarea = _createTextarea(text);\n                try {\n                    document.execCommand('copy');\n                    document.body.removeChild(textarea);\n                    resolve(null);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error('None of copying methods are supported by this browser!'));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function pasteText() {\n    return new Promise<string>(function (resolve, reject) {\n        try {\n            if (typeof navigator !== 'undefined' && typeof navigator.clipboard !== 'undefined' && typeof navigator.permissions !== 'undefined') {\n                navigator.permissions.query({ name: 'clipboard-read' as PermissionName }).then(function (permission) {\n                    if (permission.state === 'granted' || permission.state === 'prompt') {\n                        navigator.clipboard.readText().then(resolve, reject).catch(reject);\n                    }\n                    else {\n                        reject(new Error('Permission not granted!'));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported('paste')) {\n                let textarea = _createTextarea();\n                try {\n                    document.execCommand('paste', false, null);\n                    resolve(textarea.value);\n                    document.body.removeChild(textarea);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error('None of pasting methods are supported by this browser!'));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function pasteType(type, fallBack?) {\n    return new Promise<string>(function (resolve, reject) {\n        try {\n            if (typeof navigator !== 'undefined' && typeof navigator.clipboard !== 'undefined' && typeof navigator.permissions !== 'undefined') {\n                navigator.permissions.query({ name: 'clipboard-read' as PermissionName }).then(function (permission) {\n                    if (permission.state === 'granted' || permission.state === 'prompt') {\n                        navigator.clipboard.read().then((items) => {\n                            if (items.length) {\n                                //if html fall back to plain text\n                                if (fallBack && !items[0].types.includes(type))\n                                    type = fallBack;\n                                if (items[0].types.includes(type))\n                                    items[0].getType(type).then(data => {\n                                        resolve(data.text());\n                                    }).catch(reject);\n                                else\n                                    resolve('');\n                            }\n                            else\n                                resolve('');\n                        }).catch(reject);\n                    }\n                    else {\n                        reject(new Error('Permission not granted!'));\n                    }\n                });\n            }\n            else if (document.queryCommandSupported && document.queryCommandSupported('paste')) {\n                let textarea = _createTextarea();\n                try {\n                    document.execCommand('paste', false, null);\n                    resolve(textarea.value);\n                    document.body.removeChild(textarea);\n                }\n                catch (e) {\n                    document.body.removeChild(textarea);\n                    reject(e);\n                }\n            }\n            else {\n                reject(new Error('None of pasting methods are supported by this browser!'));\n            }\n        } catch (err) {\n            reject(err);\n        }\n    });\n}\n\nexport function isPasteSupported() {\n    if (typeof navigator !== 'undefined' && typeof navigator.clipboard !== 'undefined' && typeof navigator.permissions !== 'undefined')\n        return true;\n    if (document.queryCommandSupported && document.queryCommandSupported('paste'))\n        return true;\n    const el = document.createElement('div');\n    el.setAttribute('contenteditable', 'true');\n    document.body.appendChild(el);\n    el.focus();\n\n    const pasteEvent = new ClipboardEvent('paste');\n    el.dispatchEvent(pasteEvent);\n\n    let isSupported = pasteEvent.defaultPrevented;\n    document.body.removeChild(el);\n    return isSupported;\n}\n\nexport function getParameterByName(name: string, url?: string): string {\n    if (!name) return null;\n    if (!url) url = window.location.href;\n    name = name.replace(/[[\\]]/g, '\\\\$&');\n    let regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n        results = regex.exec(url);\n    if (!results) return null;\n    if (!results[2]) return '';\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}\n\nexport function fSaveAs() {\n    // Feature test: Does this browser support the download attribute on anchor tags? (currently only Chrome)\n    let DownloadAttributeSupport = 'download' in document.createElement('a');\n\n    // Use any available BlobBuilder/URL implementation:\n    let BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n    let URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    // IE 10 has a handy navigator.msSaveBlob method. Maybe other browsers will emulate that interface?\n    // See: http://msdn.microsoft.com/en-us/library/windows/apps/hh441122.aspx\n    navigator.saveBlob = navigator.saveBlob || navigator.msSaveBlob || navigator.mozSaveBlob || navigator.webkitSaveBlob;\n\n    // Anyway, HMTL5 defines a very similar but more powerful window.saveAs function:\n    // http://www.w3.org/TR/file-writer-api/#the-filesaver-interface\n    window.saveAs = window.saveAs || window.webkitSaveAs || window.mozSaveAs || window.msSaveAs;\n    // However, this is not supported by any browser yet. But there is a compatibility library that\n    // adds this function to browsers that support Blobs (except Internet Exlorer):\n    // http://eligrey.com/blog/post/saving-generated-files-on-the-client-side\n    // https://github.com/eligrey/FileSaver.js\n\n    // mime types that (potentially) don't trigger a download when opened in a browser:\n    let BrowserSupportedMimeTypes = {\n        'image/jpeg': true,\n        'image/png': true,\n        'image/gif': true,\n        'image/svg+xml': true,\n        'image/bmp': true,\n        'image/x-windows-bmp': true,\n        'image/webp': true,\n        'audio/wav': true,\n        'audio/mpeg': true,\n        'audio/webm': true,\n        'audio/ogg': true,\n        'video/mpeg': true,\n        'video/webm': true,\n        'video/ogg': true,\n        'text/plain': true,\n        'text/html': true,\n        'text/xml': true,\n        'application/xhtml+xml': true,\n        'application/json': true\n    };\n\n    // Blobs and saveAs (or saveBlob)\t:\n    if (BlobBuilder && (window.saveAs || navigator.saveBlob)) {\n        // Currently only IE 10 supports this, but I hope other browsers will also implement the saveAs/saveBlob method eventually.\n        this.show = function (data, name, mimetype) {\n            let builder = new BlobBuilder();\n            builder.append(data);\n            let blob = builder.getBlob(mimetype || 'application/octet-stream');\n            if (!name) name = 'Download.bin';\n            // I don't assign saveAs to navigator.saveBlob (or the other way around)\n            // because I cannot know at this point whether future implementations\n            // require these methods to be called with 'this' assigned to window (or\n            // naviagator) in order to work. E.g. console.log won't work when not called\n            // with this === console.\n            if (window.saveAs) {\n                window.saveAs(blob, name);\n            }\n            else {\n                navigator.saveBlob(blob, name);\n            }\n        };\n    }\n    // Blobs and object URLs:\n    else if (BlobBuilder && URL) {\n        // Currently WebKit and Gecko support BlobBuilder and object URLs.\n        this.show = function (data, name, mimetype) {\n            let blob, url, builder = new BlobBuilder();\n            builder.append(data);\n            if (!mimetype) mimetype = 'application/octet-stream';\n            if (DownloadAttributeSupport) {\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                let link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                let event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // 'application/octet-stream' for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n\n                blob = builder.getBlob(mimetype);\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    else if (Blob && URL) {\n        this.show = function (data, name, mimetype) {\n            let blob, url;\n            if (!mimetype) mimetype = 'application/octet-stream';\n            blob = new Blob([data], { type: mimetype });\n            if (DownloadAttributeSupport) {\n                url = URL.createObjectURL(blob);\n                // Currently only Chrome (since 14-dot-something) supports the download attribute for anchor elements.\n                let link = document.createElement('a');\n                link.setAttribute('href', url);\n                link.setAttribute('download', name || 'Download.bin');\n                // Now I need to simulate a click on the link.\n                // IE 10 has the better msSaveBlob method and older IE versions do not support the BlobBuilder interface\n                // and object URLs, so we don't need the MS way to build an event object here.\n                let event = document.createEvent('MouseEvents');\n                event.initMouseEvent('click', true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 0, null);\n                link.dispatchEvent(event);\n            }\n            else {\n                // In other browsers I open a new window with the object URL.\n                // In order to trigger a download I have to use the generic binary data mime type\n                // 'application/octet-stream' for mime types that browsers would display otherwise.\n                // Of course the browser won't show a nice file name here.\n                if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                    mimetype = 'application/octet-stream';\n                }\n                url = URL.createObjectURL(blob);\n                window.open(url, '_blank', '');\n            }\n            // The timeout is probably not necessary, but just in case that some browser handle the click/window.open\n            // asynchronously I don't revoke the object URL immediately.\n            setTimeout(function () {\n                URL.revokeObjectURL(url);\n            }, 250);\n\n            // Using the filesystem API (http://www.w3.org/TR/file-system-api/) you could do something very similar.\n            // However, I think this is only supported by Chrome right now and it is much more complicated than this\n            // solution. And chrome supports the download attribute anyway.\n        };\n    }\n    // data:-URLs:\n    else if (!/\\bMSIE\\b/.test(navigator.userAgent)) {\n        // IE does not support URLs longer than 2048 characters (actually bytes), so it is useless for data:-URLs.\n        // Also it seems not to support window.open in combination with data:-URLs at all.\n        this.show = function (data, name, mimetype) {\n            if (!mimetype) mimetype = 'application/octet-stream';\n            // Again I need to filter the mime type so a download is forced.\n            if (BrowserSupportedMimeTypes[mimetype.split(';')[0]] === true) {\n                mimetype = 'application/octet-stream';\n            }\n            // Note that encodeURIComponent produces UTF-8 encoded text. The mime type should contain\n            // the charset=UTF-8 parameter. In case you don't want the data to be encoded as UTF-8\n            // you could use escape(data) instead.\n            window.open('data:' + mimetype + ',' + encodeURIComponent(data), '_blank', '');\n        };\n    }\n    // Internet Explorer before version 10 does not support any of the methods above.\n    // If it is text data you could show it in an textarea and tell the user to copy it into a text file.\n}\n\nwindow.fileSaveAs = new fSaveAs();\n\n\nfunction _utf8() {\n    let intc, i;\n\n    //http://siphon9.net/loune/2009/10/javascript-snippet-to-convert-raw-utf8-to-unicode/\n    function _TryGetCharUTF8(b, count) {\n        let c = b.charCodeAt(i);\n        /*\n         * 10000000 80\n         * 11000000 C0\n         * 11100000 E0\n         * 11110000 F0\n         * 11111000 F8\n         * 11111100 FC\n         * \n         * FEFF = 65279 = BOM\n         * \n         * string musicalbassclef = '' + (char)0xD834 + (char)0xDD1E; 119070 0x1D11E\n         */\n        if ((c & 0x80) === 0)\n            intc = c;\n        else {\n            if ((c & 0xE0) == 0xC0) {\n                intc = ((c & 0x1F) << 6) | ((b.charCodeAt(i + 1) & 0x3F));\n                i += 1;\n            }\n            else if ((c & 0xF0) == 0xE0) {\n                // 3 bytes Covers the rest of the BMP\n                //if (i+2 >= count) return false;\n                intc = ((c & 0xF) << 12) | ((b.charCodeAt(i + 1) & 0x3F) << 6) | ((b.charCodeAt(i + 2) & 0x3F));\n                //alert(c + ' '+b.charCodeAt(i + 1) +' '+b.charCodeAt(i + 2));\n                i += 2;\n            }\n            else if ((c & 0xF8) == 0xF0) {\n                intc = ((c & 0x7) << 18) | ((b.charCodeAt(i + 1) & 0x3F) << 12) | ((b.charCodeAt(i + 2) & 0x3F) << 6) | ((b.charCodeAt(i + 3) & 0x3F));\n                i += 1;\n            }\n            else\n                return false;\n        }\n        return true;\n    }\n\n    this.decode = function (s) {\n        let ss = new StringBuffer();\n        let sl = s.length;\n        for (i = 0; i < sl; i++) {\n            if (_TryGetCharUTF8(s, sl))\n                ss.appendCode(intc);\n        }\n        return ss.toString();\n    };\n\n    this.decode2 = function (s) {\n        let ss = new StringBuffer();\n        let sl = s.length;\n        let i, c;\n        for (i = 0; i < sl; i++) {\n            c = s.charCodeAt(i);\n            if ((c & 0x80) !== 0) {\n                if ((c & 0xE0) == 0xC0) {\n                    c = ((c & 0x1F) << 6) | ((s.charCodeAt(i + 1) & 0x3F));\n                    i += 1;\n                }\n                else if ((c & 0xF0) == 0xE0) {\n                    c = ((c & 0xF) << 12) | ((s.charCodeAt(i + 1) & 0x3F) << 6) | ((s.charCodeAt(i + 2) & 0x3F));\n                    i += 2;\n                }\n                else if ((c & 0xF8) == 0xF0) {\n                    c = ((c & 0x7) << 18) | ((s.charCodeAt(i + 1) & 0x3F) << 12) | ((s.charCodeAt(i + 2) & 0x3F) << 6) | ((s.charCodeAt(i + 3) & 0x3F));\n                    i += 1;\n                }\n                else\n                    continue;\n            }\n            ss.appendCode(c);\n        }\n        return ss.toString();\n    };\n\n}\n\nwindow.UTF8 = new _utf8();\n\nexport function printArray(data) {\n    if (data === null || typeof data == 'undefined') return data;\n    let dl, ba;\n    let idx = 0;\n    dl = data.byteLength;\n    ba = new StringBuffer();\n    for (; idx < dl; idx++) {\n        if (data[idx] < 32 || data[idx] >= 127)\n            ba.append('<' + data[idx] + '>');\n        else\n            ba.append(String.fromCharCode(data[idx]));\n    }\n    //save newly escaped string\n    return ba.toString();\n}\n\nexport function getScrollbarWidth() {\n\n    // Creating invisible container\n    const outer = document.createElement('div');\n    outer.style.visibility = 'hidden';\n    outer.style.overflow = 'scroll'; // forcing scrollbar to appear\n    (<any>outer.style).msOverflowStyle = 'scrollbar'; // needed for WinJS apps\n    document.body.appendChild(outer);\n\n    // Creating inner element and placing it in the container\n    const inner = document.createElement('div');\n    outer.appendChild(inner);\n\n    // Calculating difference between container's full width and the child width\n    const scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);\n\n    // Removing temporary elements from the DOM\n    outer.parentNode.removeChild(outer);\n\n    return scrollbarWidth;\n\n}\n\nexport function openFileDialog(title?: string, multiple?: boolean, accept?: string) {\n    return new Promise<FileList>((resolve, reject) => {\n        let dialog = document.createElement('dialog');\n        if (typeof dialog.showModal !== 'function') {\n            reject('Browser does not support dialogs.');\n            return;\n        }\n        dialog.id = 'openFileDialog';\n        dialog.style.zIndex = '2000';\n        dialog.style.height = '158px';\n        dialog.style.width = '350px';\n        dialog.innerHTML = `<div class=\"dialog-header\" style=\"font-weight: bold\"><button type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" onclick=\"document.getElementById('openFileDialog').close();\"></button><div>${title || 'Open file...'}</div></div><div class=\"dialog-body\"><div class=\"m-3\"><input class=\"form-control\" type=\"file\" id=\"openFileDialog-files\"${multiple ? ' multiple' : ''} required${accept && accept.length ? (' accept=\"' + accept + '\"') : ''}></div></div><div class=\"dialog-footer\"><button id=\"openFileDialog-cancel\" style=\"float: right\" type=\"button\" class=\"btn btn-default\" onclick=\"document.getElementById('openFileDialog').close();\">Cancel</button><button id=\"openFileDialog-ok\" style=\"float: right\" type=\"button\" class=\"btn btn-primary\">Ok</button></div>`;\n        document.body.appendChild(dialog);\n        //dialog.addEventListener('open', onOpen);\n        dialog.addEventListener('close', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('closed');\n        });\n        dialog.addEventListener('cancel', e => {\n            if (e.target !== dialog) return;\n            document.body.removeChild(dialog);\n            if (dialog.returnValue !== 'file-ok')\n                reject('canceled');\n        });\n        document.getElementById('openFileDialog-ok').addEventListener('click', () => {\n            const input: HTMLInputElement = (<HTMLInputElement>document.getElementById('openFileDialog-files'));\n            if (!input.files || input.files.length === 0) {\n                input.classList.add('is-invalid')\n                return;\n            }\n            input.classList.remove('is-invalid');\n            dialog.close();\n            dialog.returnValue = 'files-ok';\n            resolve(input.files);\n        });\n        dialog.showModal();\n    });\n}\n\nexport function readFile(file, progress?) {\n    return new Promise((resolve, reject) => {\n        if (!file) reject(new Error('Invalid file'));\n        let reader = new FileReader();\n        reader.onerror = reject;\n        reader.onload = evt => {\n            resolve(evt.target.result);\n        };\n        reader.readAsText(file);\n        if (progress)\n            reader.onprogress = progress;\n    });\n}\n\nconst _timers = {};\nexport function debounce(mainFunction, delay, key?) {\n    key = key || 'default';\n    // Clear the previous timer to prevent the execution of 'mainFunction'\n    clearTimeout(_timers[key]);\n    // Set a new timer that will execute 'mainFunction' after the specified delay\n    _timers[key] = setTimeout(() => {\n        mainFunction();\n        delete _timers[key];\n    }, delay);\n}\n\nexport function markdownParser(text) {\n    const toHTML = text\n        .replace(/`(.*)`/gim, '<span class=\"markdown-code\" style=\"display: inline-block;background-color: #ececec\">$1</span>') // code block\n        .replace(/^---/gim, '<hr>')\n        .replace(/\\[(.*)\\]\\((.*)\\)/gim, '<a href=\"$2\">$1</a>')\n        .replace(/^##### (.*$)/gim, '<h5>$1</h5>') // h3 tag\n        .replace(/^##### (.*$)/gim, '<h5>$1</h5>') // h3 tag\n        .replace(/^#### (.*$)/gim, '<h4>$1</h4>') // h3 tag\n        .replace(/^### (.*$)/gim, '<h3>$1</h3>') // h3 tag\n        .replace(/^## (.*$)/gim, '<h2>$1</h2>') // h2 tag\n        .replace(/^# (.*$)/gim, '<h1>$1</h1>') // h1 tag\n        .replace(/\\*\\*(.*)\\*\\*/gim, '<b>$1</b>') // bold text\n        .replace(/\\*(.*)\\*/gim, '<i>$1</i>') // italic text\n        .replace(/_(.*)_/gim, '<i>$1</i>') // italic text\n        .replace(/\\\\$/gim, '$')\n        .replace(/\\\\{/gim, '\\\\');\n    return toHTML.trim(); // using trim method to remove whitespace\n}\n\nexport function scrollChildIntoView(parent, child) {\n    const childRect = child.getBoundingClientRect();\n    const parentRect = parent.getBoundingClientRect();\n\n    if (\n        childRect.top < parentRect.top ||\n        childRect.bottom > parentRect.bottom ||\n        childRect.left < parentRect.left ||\n        childRect.right > parentRect.right\n    ) {\n        child.scrollIntoView({\n            behavior: 'smooth', // Optional for smooth scrolling\n            block: 'nearest' // Scrolls to nearest edge of the parent\n        });\n    }\n}\n\nexport function getWordAtPosition(x, y) {\n    // Get the element at the specified coordinates\n    const element = document.elementFromPoint(x, y);\n\n    // Check if the element exists and contains text\n    if (element && element.textContent) {\n        // Get the text content of the element\n        const text = element.textContent;\n\n        // Find the word boundaries around the specified position\n        let start = text.lastIndexOf(' ', x) + 1;\n        let end = text.indexOf(' ', x);\n        if (end === -1) {\n            end = text.length;\n        }\n\n        // Extract the word\n        const word = text.substring(start, end);\n\n        return word;\n    }\n\n    return null;\n}\n\nexport function isMobile(userAgent?) {\n    if (window.matchMedia('(orientation: landscape) and (max-width: 641px)').matches)\n        return true;\n    if (window.matchMedia('(orientation: landscape) and (max-height: 480px)').matches)\n        return true;\n    if (window.matchMedia('(orientation: portrait) and (max-width: 480px)').matches)\n        return true;\n    if (window.matchMedia(' (orientation: portrait) and (max-height: 641px)').matches)\n        return true;\n    if (userAgent && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent || navigator.vendor || window.opera))\n        return true;\n    return false;\n}\n\nexport function isArrayEqual(a, b): boolean {\n    // if the other array is a falsy value, return\n    if (!a || !b)\n        return false;\n\n    // compare lengths - can save a lot of time \n    if (a.length != b.length)\n        return false;\n\n    for (var i = 0, l = a.length; i < l; i++) {\n        // Check if we have nested arrays\n        if (Array.isArray(a[i]) && Array.isArray(b[i])) {\n            // recurse into the nested arrays\n            if (!isArrayEqual(a[i], b[i]))\n                return false;\n        }\n        else if (a[i] instanceof Object && b[i] instanceof Object) {\n            // recurse into another objects\n            if (!isObjectEqual(a[i], b[i]))\n                return false;\n        }\n        else if (a[i] !== b[i]) {\n            // Warning - two different object instances will never be equal: {x:20} != {x:20}\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function isObjectEqual(a, b): boolean {\n    let propName;\n    if (a === b) return true;\n    if (a === null || b === null) return false;\n    if (Object.keys(a).length !== Object.keys(b).length) return false;\n    if (Array.isArray(a) || Array.isArray(b))\n        return isArrayEqual(a, b);\n    //For the first loop, we only check for types\n    for (propName in a) {\n        //Check for inherited methods and properties - like .equals itself\n        //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty\n        //Return false if the return value is different\n        if (a.hasOwnProperty(propName) != b.hasOwnProperty(propName)) {\n            return false;\n        }\n        //Check instance type\n        else if (typeof a[propName] != typeof b[propName]) {\n            //Different types => not equal\n            return false;\n        }\n    }\n    //Now a deeper check using other objects property names\n    for (propName in b) {\n        //We must check instances anyway, there may be a property that only exists in object2\n        //I wonder, if remembering the checked values from the first loop would be faster or not \n        if (a.hasOwnProperty(propName) != b.hasOwnProperty(propName)) {\n            return false;\n        }\n        else if (typeof a[propName] != typeof b[propName]) {\n            return false;\n        }\n        //If the property is inherited, do not check any more (it must be equal if both objects inherit it)\n        if (!a.hasOwnProperty(propName))\n            continue;\n\n        //Now the detail check and recursion\n\n        //This returns the script back to the array comparing\n        if (Array.isArray(a[propName]) && Array.isArray(b[propName])) {\n            // recurse into the nested arrays\n            if (!isArrayEqual(a[propName], b[propName]))\n                return false;\n        }\n        else if (a[propName] instanceof Object && b[propName] instanceof Object) {\n            // recurse into another objects\n            if (!isObjectEqual(a[propName], b[propName]))\n                return false;\n        }\n        //Normal value comparison for strings and numbers\n        else if (a[propName] !== b[propName]) {\n            return false;\n        }\n    }\n    //If everything passed, let's say YES\n    return true;\n}", "// spell-checker:words TELOP, TERMINALTYPE, NEWENVIRON, Achaea, Webdings, ENDOFRECORD, USERVAR keepalive, DONT\nimport { EventEmitter } from './events';\nimport { StringBuffer, StringToUint8Array, ArrayBufferToString, printArray } from './library';\n\ndeclare global {\n    interface Window {\n        telnet: Telnet;\n    }\n}\n\ndeclare let UTF8;\nimport { Zlib } from '../lib/inflate_stream.min.js';\n\nexport interface TelnetOption {\n    telnet: Telnet;\n    option: number;\n    verb: number;\n    value: string;\n    handled: boolean;\n}\n\nexport interface TelnetOptions {\n    MCCP: boolean;\n    MXP: boolean;\n    NAWS: boolean;\n    MSDP: boolean;\n    GMCP: boolean;\n    MSSP: boolean;\n    ECHO: boolean;\n    TTYPE: boolean;\n    EOR: boolean;\n    NEWENVIRON: boolean;\n    ZMP: boolean;\n    ATCP: boolean;\n    CHARSET: boolean;\n}\n\nexport interface TelnetOptionsServer {\n    MCCP1: boolean;\n    MCCP2: boolean;\n    MXP: boolean;\n    NAWS: boolean;\n    MSDP: boolean;\n    GMCP: boolean;\n    MSSP: boolean;\n    EOR: boolean;\n    NEWENVIRON: boolean;\n    ZMP: boolean;\n    ATCP: boolean;\n    CHARSET: boolean;\n}\n\n/**\n * A telnet base telnet object to create a connection to a host:port and handle\n * the base telnet protocol. In addition to the base protocol it also handles MCCP 1 & 2,\n * NAWS, MXP, GMCP, MSSP, CHARSET for UTF-8. To support MCCP it requires the module {@link module:src/lib/zlib-inflate}.\n *\n * @author Icewolfz\n * @copyright Icewolfz 2013\n * @class Telnet\n * @extends {EventEmitter}\n * @version 2.0\n * @requires module:src/lib/zlib-inflate\n * @namespace Telnet\n * @constructor\n * @param {Object} options\t\t\t\t- The options to start off with\n * @param {Object} options.host\t\t\t- The host to connect to\n * @param {Object} options.port\t\t\t- The port to connect to\n *\n * @todo add ZMP support\n * @todo add ENVIRON/NEWENVIRON exactly the same, but for var/value reversed, and there are rules to detect this so just treat ENVIRON as NEWENVIRON\n * @todo add ATCP support similar to GMCP\n * @todo add MSDP table/array support\n * @todo add MCP (Mud client protocol) - encodes protocol in text that is processed out and separates into an in bound (normal text), and out of bound (protocol data) see http://www.moo.mud.org/mcp/\n * @todo add CHARSET ttable support\n * \n * @property {Object}  options\t\t\t\t\t\t- The telnet options to enable or disable\n * @property {Boolean} [options.ECHO=1]\t\t\t\t- Enable/disable Echo (1)\n * @property {Boolean} [options.TTYPE=1]\t\t\t- Enable/disable Terminal Type - Does MTTS (http://tintin.sourceforge.net/mtts/) (TTYPE) (24)\n * @property {Boolean} [options.EOR=1]\t\t\t\t- Enable/disable End of record (EOR) (25/239)\n * @property {Boolean} [options.NAWS=1]\t\t\t\t- Enable/disable Negotiate About Window Size (NAWS) (31)\n * @property {Boolean} [options.NEWENVIRON=0]\t    - Enable/disable Environment Option (36/39)\n * @property {Boolean} [options.MSDP=1]\t\t\t\t- Enable/disable Mud Server Data Protocol (MSDP) (69)\n * @property {Boolean} [options.MSSP=0]\t\t\t\t- Enable/disable Mud Server Status Protocol (MSSP) (70)\n * @property {Boolean} [options.MCCP=1]\t\t\t\t- Enable/disable MUD Compression Protocol (MCCP) (85/86)\n * @property {Boolean} [options.MXP=1]\t\t\t\t- Enable/disable MUD eXtension Protocol  (MXP) (91)\n * @property {Boolean} [options.ZMP=0]\t\t\t\t- Enable/disable Zenith MUD Protocol (ZMP) (93)\n * @property {Boolean} [options.GMCP=1]\t\t\t\t- Enable/disable Generic Mud Communication Protocol/ATCP2 protocol (GMCP) (201)\n * @property {Boolean} [options.ATCP=0]\t\t\t\t- Enable/disable Achaea Telnet Client Protocol (ATCP) (200)\n * @property {Boolean} [options.CHARSET=1]\t\t    - Enable/disable CHARSET enabled, and which type, 1 is UTF-8\n * @property {Object}  server\t\t\t\t\t\t- The telnet options the server has enabled or disabled\n * @property {Boolean} [server.NAWS=0]\t\t\t\t- Is NAWS enabled\n * @property {Boolean} [server.MSDP=0]\t\t\t\t- Is MSDP enabled\n * @property {Boolean} [server.GMCP=0]\t\t\t\t- Is GMCP enabled\n * @property {Boolean} [server.MXP=0]\t\t\t\t- Is MXP enabled\n * @property {Boolean} [server.MCCP1=0]\t\t\t\t- Is MCCP1 enabled\n * @property {Boolean} [server.MCCP2=0]\t\t\t\t- Is MCCP2 enabled\n * @property {Boolean} [server.MSSP=0]\t\t\t\t- Is MSSP enabled\n * @property {Boolean} [server.NEWENVIRON=0]\t    - Is NEWENVIRON enabled\n * @property {Boolean} [server.ZMP=0]\t\t\t\t- Is ZMP enabled\n * @property {Boolean} [server.EOR=0]\t\t\t\t- Is EOR enabled\n * @property {Boolean} [server.ATCP=0]\t\t\t\t- Is ATCP enabled\n * @property {Boolean} [server.CHARSET=0]\t\t\t- Is CHARSET enabled, and which type, 1 is UTF-8\n * @property {String}  host\t\t\t\t\t\t\t- The host, may include ws://, wss://, http://, or https://, if not supplied uses set scheme\n * @property {Number}  port\t\t\t\t\t\t\t- The port, if set to < 1 it will use host only\n * @property {Boolean} [prompt=false]\t\t\t\t- The prompt state to determine if current end of line is a prompt or not\n * @property {Boolean} [echo=true]\t\t\t\t\t- The echo state to determine if you should echo text to the screen\n * @property {Boolean} [firstSent=true]\t\t\t\t- Weather anything has been sent yet, excluding telnet options\n * @property {Boolean} [firstReceived=true]\t\t    - Weather anything has been received yet, excluding telnet options\n * @property {String}  version\t\t\t\t\t\t- The version of the client to send for GMCP Core.Hello\n * @property {String}  [terminal=ansi]\t\t\t\t- The terminal type to send the first time for TTYPE\n * @property {Boolean} [UTF8=true]\t\t\t\t\t- Force process data after telnet options as UTF8 character\n * @property {Object}  [MSSP={}]\t\t\t\t\t- MSSP object that contains all variables and their assigned values.\n * @property {Object}  [socket=null]\t\t\t\t- The websocket object\n * @property {Number}  [latency=0]\t\t\t\t\t- The milliseconds between the last send and the current received data\n * @property {Boolean} [enableLatency=false]\t    - Attempt to calculate the latency between a send/receive, and if sent on receive send a GMCP ping back and attempt to get latency of a connection\n * @property {Number}  [latencyAvg=0]\t\t\t\t- The average milliseconds between the last send and the current received data\n * @property {Number}  [enablePing=false]\t\t\t- Enable GMCP ping back to better track latency\n * @property {Array}   GMCPSupports\t\t\t\t\t- An array of supported GMCP modules for mat of \"Modulate 0|1\", defaults are \"Core 1\", \"Char 1\", \"Char.Vitals 1\", \"Char.Experience 1\"\n * @property {string}  scheme                       - The websocket scheme to use, ws://, wss://, http://, or https:// must include the ://\n * @property {string}  protocol                     - The websocket protocol to use, defaults to binary\n */\nexport class Telnet extends EventEmitter {\n    private _splitBuffer: number[] = [];\n    private _connected: boolean = false;\n    private _MTTS: number = 0;\n    private _zStream: any = 0;\n    private _latencyTime: Date = null;\n    private _doPing: boolean = false;\n    private _closed: boolean = true;\n    private _zlib: boolean = false;\n\n    public options: TelnetOptions = { MCCP: true, MXP: true, NAWS: true, MSDP: true, GMCP: true, MSSP: false, ECHO: true, TTYPE: true, EOR: true, NEWENVIRON: false, ZMP: false, ATCP: false, CHARSET: true };\n    public host: string = '';\n    public port: number = 23;\n    public prompt: boolean = false;\n    public echo: boolean = true;\n    public firstSent: boolean = true;\n    public firstReceived: boolean = true;\n    public server: TelnetOptionsServer = { NAWS: false, MSDP: false, GMCP: false, MXP: false, MCCP1: false, MCCP2: false, MSSP: false, NEWENVIRON: false, ZMP: false, EOR: false, ATCP: false, CHARSET: false };\n    public version: string = '2.0';\n    public terminal: string = 'ansi';\n    public UTF8: boolean = true;\n    public MSSP = {};\n    public socket: WebSocket = null;\n    public latency: number = 0;\n    public latencyAvg: number = null;\n    public enableLatency: boolean = false;\n    public enablePing: boolean = false;\n    public GMCPSupports: string[] = ['Core 1'];\n    public enableDebug: boolean = false;\n    public scheme: string = 'ws://';\n    public protocol: string = 'binary';\n\n    /**\n     * Creates an instance of Telnet.\n     *\n     * @param {any} options a list of options to set\n     *\n     * @memberOf Telnet\n     */\n    constructor(options?: TelnetOptions | any) {\n        super();\n        if (options) {\n            if ('host' in options) {\n                if (options.host && options.host.length)\n                    this.host = options.host;\n                delete options.host;\n            }\n            if ('port' in options) {\n                this.port = options.port;\n                delete options.port;\n            }\n            if ('scheme' in options) {\n                if (options.scheme && options.scheme.length)\n                    this.scheme = options.scheme;\n                delete options.scheme;\n            }\n            if ('protocol' in options) {\n                if (options.protocol && options.protocol.length)\n                    this.protocol = options.protocol;\n                delete options.protocol;\n            }\n        }\n        this.options = Object.assign(this.options, options || {});\n    }\n\n    /**\n     * @name connected\n     * @desc determine if connected to host\n     * @returns {Boolean} weather connected to host or not\n     *\n     * @readonly\n     *\n     * @memberOf Telnet\n     */\n    get connected(): boolean {\n        if (!this.socket || typeof this.socket === 'undefined')\n            return false;\n        return this._connected;\n    }\n\n    /**\n         * @name Telnet#reset\n         * @desc reset state in preparation for a connect\n         */\n    public reset() {\n        this._MTTS = 0;\n        this.firstSent = true;\n        this.firstReceived = true;\n        this.prompt = false;\n        this.echo = true;\n        this.server = { NAWS: false, MSDP: false, GMCP: false, MXP: false, MCCP1: false, MCCP2: false, MSSP: false, EOR: false, NEWENVIRON: false, ATCP: false, CHARSET: false, ZMP: false };\n        this._splitBuffer = [];\n        this._endMCCP();\n        this._connected = false;\n        this._closed = false;\n        if (this.enableDebug)\n            this.emit('debug', 'Reset');\n    }\n\n    /**\n     * @name connect\n     * @desc connect to target host\n     *\n     * @fires Telnet#connecting\n     */\n    public connect() {\n        this._destroySocket();\n        this.reset();\n        this.emit('connecting');\n        this.socket = this._createSocket(this.host, this.port);\n        if (this.enableDebug)\n            this.emit('debug', 'Connecting to ' + this.host + ':' + this.port);\n    }\n\n    /**\n     * @name Telnet#close\n     * @desc close the connection ot host and reset state in preparation for next connection\n     *\n     * @fires Telnet#close\n     */\n    public close() {\n        if (this._closed) return;\n        this._destroySocket();\n        this.reset();\n        this.emit('close');\n        this._closed = true;\n        if (this.enableDebug)\n            this.emit('debug', 'Closed');\n    }\n\n    /**\n     * @name Telnet#receivedData\n     * @desc data that is received from the host to be processed\n     *\n     * @param {String} data string received from host\n     * @fires Telnet#received-data\n     */\n    public receivedData(data: Uint8Array, skipDecompress?: boolean, prependSplit?: boolean) {\n        if (this.enableLatency) {\n            if (this._latencyTime !== null) {\n                this.latency = new Date().getTime() - this._latencyTime.getTime();\n                if (this.latencyAvg == null)\n                    this.latencyAvg = this.latency;\n                else\n                    this.latencyAvg = (this.latency + this.latencyAvg) / 2;\n                this._latencyTime = null;\n                this._doPing = false;\n                this.emit('latency-changed', this.latency, this.latencyAvg);\n            }\n            else if (!this._doPing && this.enablePing)\n                this._doPing = true;\n            else {\n                this._latencyTime = null;\n                this._doPing = false;\n            }\n        }\n        if (this.enableDebug)\n            this.emit('debug', 'PreProcess:' + data, 1);\n        data = this.processData(data, skipDecompress, false, prependSplit);\n        if (this.enableDebug)\n            this.emit('debug', 'PostProcess:' + data, 1);\n        this.emit('received-data', data);\n        if (this.enableLatency) {\n            //split packet more then likely so reset timer for next part\n            if (this._splitBuffer.length > 0) {\n                if (this.enablePing) this._doPing = true;\n                this._latencyTime = null;\n            }\n            //gmcp ping, send after process to have a more accurate time\n            else if (this._doPing && this.enablePing) {\n                setTimeout(() => {\n                    this._latencyTime = new Date();\n                    this.sendGMCP('Core.Ping ' + this.latencyAvg);\n                });\n            }\n            else\n                this._doPing = false;\n        }\n    }\n\n    /**\n     * @name Telnet#sendTerminal\n     * @desc Send terminal type telnet option to mud to identify the terminal\n     */\n    public sendTerminal() {\n        if (this.enableDebug) {\n            if (this._MTTS === 0)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>' + this.terminal + '<IAC><SE>');\n            else if (this._MTTS === 1)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>ANSI-256COLOR<IAC><SE>');\n            else if (this._MTTS >= 2)\n                this.emit('debug', 'REPLY: <IAC><SB><TERMINALTYPE><IS>MTTS 9<IAC><SE>');\n        }\n        if (this._MTTS === 0) {\n            let tmp = new Uint8Array(6 + this.terminal.length);\n            tmp.set([255, 250, 24, 0], 0);\n            tmp.set(StringToUint8Array(this.terminal), 4);\n            tmp.set([255, 240], 4 + this.terminal.length);\n            this.sendData(tmp, true);\n        }\n        else if (this._MTTS === 1)\n            this.sendData([255, 250, 24, 0, 65, 78, 83, 73, 45, 50, 53, 54, 67, 79, 76, 79, 82, 255, 240], true);\n        else if (this._MTTS >= 2)\n            this.sendData([255, 250, 24, 0, 77, 84, 84, 83, 32, 57, 255, 240], true);\n    }\n\n    /**\n     * @name Telnet#sendData\n     * @desc Send data to the host\n     *\n     * @param {String} data string to send\n     * @param {Boolean} raw send raw unescaped telnet data to host, other wise it will escape the IAC for proper telnet\n     * @fires Telnet#data-sent\n     */\n    public sendData(data: any, raw?: boolean) {\n        if (data == null || typeof data === 'undefined' || data.length === 0)\n            return;\n        if (this.connected) {\n            try {\n                if (!raw) {\n                    //goAhead ended\n                    this.prompt = false;\n                    //if not an option and need to ensure proper escaping of IAC\n                    data = this._escapeData(data);\n                    if (this.enableLatency) this._latencyTime = new Date();\n                }\n                if (this.socket !== null) {\n                    if (data instanceof Uint8Array) {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataU8:' + printArray(data));\n                        this.socket.send(data);\n                    }\n                    else if (Array.isArray(data)) {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataBA' + printArray(new Uint8Array(data)));\n                        this.socket.send(new Uint8Array(data));\n                    }\n                    else {\n                        if (this.enableDebug)\n                            this.emit('debug', 'sendDataR:' + printArray(StringToUint8Array(data)));\n                        this.socket.send(data);\n                    }\n                    if (!raw) this.firstSent = false;\n                }\n\n            }\n            catch (e) {\n                this.emit('error', e);\n            }\n        }\n        else if (this.enableLatency)\n            this._latencyTime = null;\n        this.emit('data-sent', data, raw);\n    }\n\n    /**\n     * @name Telnet#processData\n     * @desc Process raw incoming data\n     *\n     * @param {string} data The data to process\n     * @returns {string} The results of the processed data\n     * @fires Telnet#receive-option\n     * @fires Telnet#receive-MSDP\n     * @fires Telnet#receive-GMCP\n     * @fires Telnet#receive-MSSP\n     * @fires Telnet#receive-NEWENVIRON\n     * @fires Telnet#receive-CHARSET\n     */\n    //this.processData = function(data) { return data; };\n    public processData(data: Uint8Array, skipDecompress?: boolean, returnRaw?: boolean, prependSplit?: boolean) {\n        let len: number;\n        let tmp: (string | boolean | Uint8Array) = '';\n        let _sb;\n        if (data == null)\n            return data;\n        if (!skipDecompress)\n            data = this._decompressData(data);\n        len = data.byteLength;\n        if (len === 0)\n            return data;\n        _sb = this._splitBuffer;\n        if (_sb.length > 0) {\n            if (this.enableDebug) this.emit('debug', 'Split buffer length: ' + _sb.length, 1);\n            tmp = new Uint8Array(len + _sb.length);\n            if (prependSplit) {\n                tmp.set(data, 0);\n                tmp.set(_sb, data.byteLength);\n            }\n            else {\n                tmp.set(_sb, 0);\n                tmp.set(data, _sb.length);\n            }\n            data = tmp;\n            _sb = [];\n            len = data.byteLength;\n        }\n        let state: number = 0;\n        let pState: number = 0;\n        let processed: StringBuffer = new StringBuffer();\n\n        const ga: boolean = this.prompt;\n        let verb: number = 0;\n        let option: number = 0;\n        let msdp_val: string = '';\n        let msdp_var: string = '';\n        let _MSSP;\n        let i: number = 0;\n        let ne: number;\n        let idx: number = 0;\n        tmp = '';\n        //reset for new state\n        this.prompt = false;\n        let debugOp = '';\n        try {\n            for (; idx < len; idx++) {\n                i = data[idx];\n                switch (state) {\n                    case 0:\n                        // If the current byte is the \"Interpret as Command\" code, set the state to 1.\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp = 'TELOP: <IAC>';\n                            //store in case it is split;\n                            _sb.push(i);\n                            state = 1;\n                        }\n                        else if (this.UTF8 || (this.options.CHARSET && this.server.CHARSET)) {\n                            //If current byte has first bit on unicode\n                            if ((i & 0x80) === 0x80 && idx >= len - 4) {\n                                let uLen = 0;\n                                //Get byte count based on bits turned on\n                                if ((i & 0xC0) === 0xC0)\n                                    uLen = 1;\n                                else if ((i & 0xE0) === 0xE0)\n                                    uLen = 2;\n                                else if ((i & 0xF0) === 0xF0)\n                                    uLen = 3;\n                                //if idx + length larger then current length, good chance the unicode character is split so store and end process\n                                if (idx + uLen >= len) {\n                                    _sb.push(...data.slice(idx));\n                                    if (this.enableDebug) {\n                                        this.emit('debug', 'Unicode split length: ' + uLen, 1);\n                                        this.emit('debug', 'Split buffer length: ' + _sb.length, 1);\n                                    }\n                                    break;\n                                }\n                                /**\n                                 * https://stackoverflow.com/questions/22404493/is-there-a-drastic-difference-between-utf-8-and-utf-16/22404874\n                                    0xxxxxxx // 1 byte\n                                    110xxxxx 10xxxxxx //2 bytes  0xC0\n                                    1110xxxx 10xxxxxx 10xxxxxx //3 bytes 0xE0\n                                    11110xxx 10xxxxxx 10xxxxxx 10xxxxxx //4 bytes 0xF0\n                                 */\n                            }\n                            processed.appendCode(i);\n                        }\n                        else\n                            processed.appendCode(i);\n                        break;\n                    case 1: // Telnet Option\n                        if (i === 255) //escaped\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<IAC>');\n                                debugOp = '';\n                            }\n                            processed.appendCode(i);\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if ((!this.options.EOR || !this.server.EOR) && i === 239) //EOR, if not enabled treat as NOP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 241 || i === 130) //no operation, just continue on\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 249 || i === 239) //EOR | GA\n                        {\n                            if (this.enableDebug) {\n                                if (i === 239)\n                                    this.emit('debug', debugOp + '<EOR>');\n                                else\n                                    this.emit('debug', debugOp + '<GA>');\n                                debugOp = '';\n                            }\n                            //more data to read, so ga means nothing but a new line\n                            if (idx + 1 < len && len - idx > 2) {\n                                processed.push('\\n');\n                                this.prompt = false;\n                            }\n                            else\n                                this.prompt = true;\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 253 || i === 254 || i === 251 || i === 252) //WILL DONT WONT DO\n                        {\n                            if (this.enableDebug) {\n                                switch (i) {\n                                    case 253: debugOp += '<DO>'; break;\n                                    case 254: debugOp += '<DONT>'; break;\n                                    case 251: debugOp += '<WILL>'; break;\n                                    case 252: debugOp += '<WONT>'; break;\n                                }\n                            }\n                            //store in case it is split;\n                            _sb.push(i);\n                            verb = i;\n                            state = 2;\n                        }\n                        else if (i === 250) // Sub negotiation\n                        {\n                            if (this.enableDebug) debugOp += '<SB>';\n                            _sb.push(i);\n                            state = 3;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb = [];\n                            state = 0;\n                        }\n                        break;\n                    case 2: //WILL DONT WONT DO response\n                        if (i === 1) // ECHO\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<ECHO>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                if (this.options.ECHO) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><ECHO>');\n                                    this.replyToOption(i, 251, verb);\n                                    this.echo = false;\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                    this.echo = true;\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><ECHO>');\n                                this.replyToOption(i, 252, verb);\n                                this.echo = true;\n                            }\n                            else if (verb === 251) {\n                                if (this.options.ECHO) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><ECHO>');\n                                    this.replyToOption(i, 253, verb);\n                                    this.echo = false;\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                    this.echo = true;\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ECHO>');\n                                this.echo = true;\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 24) // TERMINALTYPE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<TERMINALTYPE>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                if (this.options.TTYPE) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><TERMINALTYPE>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><TERMINALTYPE>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                if (this.options.TTYPE) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><TERMINALTYPE>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><TERMINALTYPE>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 25) // END OF RECORD\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<ENDOFRECORD>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.EOR = true;\n                                if (this.options.EOR) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><ENDOFRECORD>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><ENDOFRECORD>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.EOR = true;\n                                if (this.options.EOR) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><ENDOFRECORD>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><ENDOFRECORD>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 31) // NAWS\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NAWS>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.NAWS = true;\n                                if (this.options.NAWS) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><NAWS>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.NAWS = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><NAWS>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.NAWS = true;\n                                if (this.options.NAWS) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><NAWS>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.NAWS = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NAWS>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            this.emit('windowSize');\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 36 || i === 39) // NEWENVIRON\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NEWENVIRON>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.NEWENVIRON = true;\n                                if (this.options.NEWENVIRON) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><NEWENVIRON>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><NEWENVIRON>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.NEWENVIRON = true;\n                                if (this.options.NEWENVIRON) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><NEWENVIRON>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><NEWENVIRON>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 69) // MSDP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MSDP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MSDP = true;\n                                if (this.options.MSDP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MSDP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MSDP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MSDP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MSDP = true;\n                                if (this.options.MSDP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MSDP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MSDP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSDP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 70) // MSSP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MSSP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MSSP = true;\n                                if (this.options.MSSP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MSSP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MSSP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MSSP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MSSP = true;\n                                if (this.options.MSSP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MSSP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MSSP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MSSP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 85) // MCCP1\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MCCP1>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MCCP1 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MCCP1>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MCCP1 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MCCP1>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MCCP1 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MCCP1>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MCCP1 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP1>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 86) // MCCP2\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MCCP2>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MCCP2 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MCCP2>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MCCP2 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MCCP2>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MCCP2 = true;\n                                if (this.options.MCCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MCCP2>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MCCP2 = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MCCP2>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 91) // MXP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<MXP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.MXP = true;\n                                if (this.options.MXP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><MXP>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.MXP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><MXP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.MXP = true;\n                                if (this.options.MXP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><MXP>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.MXP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><MXP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 130 || i === 241) // NOP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<NOP>');\n                                debugOp = '';\n                            }\n                            this._fireReceiveOption(i, verb, '');\n                            _sb = [];\n                            state = 0;\n                        }\n                        else if (i === 201) //GMCP\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<GMCP>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.GMCP = true;\n                                if (this.options.GMCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><GMCP>');\n                                    this.replyToOption(i, 251, verb);\n                                    this._startGMCP();\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.GMCP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><GMCP>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.GMCP = true;\n                                if (this.options.GMCP) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><GMCP>');\n                                    this.replyToOption(i, 253, verb);\n                                    this._startGMCP();\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.GMCP = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><GMCP>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 42) //CHARSET\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<CHARSET>');\n                                debugOp = '';\n                            }\n                            if (verb === 253) {\n                                this.server.CHARSET = true;\n                                if (this.options.CHARSET) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WILL><CHARSET>');\n                                    this.replyToOption(i, 251, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 254) {\n                                this.server.CHARSET = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><CHARSET>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            else if (verb === 251) {\n                                this.server.CHARSET = true;\n                                if (this.options.CHARSET) {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DO><CHARSET>');\n                                    this.replyToOption(i, 253, verb);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                    this.replyToOption(i, 254, verb);\n                                }\n                            }\n                            else if (verb === 252) {\n                                this.server.CHARSET = false;\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><CHARSET>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else // Blindly reject the option.\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + this._formatByte(i));\n                                debugOp = '';\n                            }\n                            if (verb === 251 || verb === 252) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><DONT><' + i + '>');\n                                this.replyToOption(i, 254, verb);\n                            }\n                            else if (verb === 254 || verb === 253) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><WONT><' + i + '>');\n                                this.replyToOption(i, 252, verb);\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        break;\n                    case 3: // Sub negotiation\n                        option = i;\n                        if (i === 24) // TERMINALTYPE\n                        {\n                            if (this.enableDebug) debugOp += '<TERMINALTYPE>';\n                            _sb.push(i);\n                            option = i;\n                            state = 4;\n                        }\n                        else if (i === 36 || i === 39) // NEWENVIRON\n                        {\n                            if (this.enableDebug) debugOp += '<NEWENVIRON>';\n                            _sb.push(i);\n                            option = i;\n                            state = 12;\n                            ne = -1;\n                        }\n                        else if (i === 69) // MSDP\n                        {\n                            if (this.enableDebug) debugOp += '<MSDP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 4;\n                        }\n                        else if (i === 70) // MSSP\n                        {\n                            if (this.enableDebug) debugOp += '<MSSP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 8;\n                            _MSSP = {};\n                        }\n                        else if (i === 85 || i === 86) // MCCP1 & MCCP2\n                        {\n                            if (this.enableDebug) debugOp += i === 85 ? '<MCCP1>' : '<MCCP2>';\n                            _sb.push(i);\n                            option = i;\n                            state = 11;\n                        }\n                        else if (i === 201) {\n                            if (this.enableDebug) debugOp += '<GMCP>';\n                            _sb.push(i);\n                            option = i;\n                            state = 7;\n                        }\n                        //IAC SB MXP IAC SE - this tells the client that from now on we are sending MXP sequences.\n                        //http://www.mushclient.com/mushclient/addingservermxp.htm\n                        //Not sure what to reply once you receive this from a sever\n                        //else if(i === 91)\n                        //{\n                        //}\n                        else if (i === 240) // SE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 42) //CHARSET\n                        {\n                            if (this.enableDebug) debugOp += '<CHARSET>';\n                            _sb.push(i);\n                            option = i;\n                            state = 17;\n                            msdp_val = '';\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 4: //MSDP negotiation\n                        if (option === 24 && i === 1) // TERMINALTYPE SEND\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            verb = 1;\n                        }\n                        else if (i === 240) // SE\n                        {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            if (option === 24 && verb === 1) // TERMINALTYPE\n                            {\n                                tmp = false;\n                                this._fireReceiveOption(option, 250, '');\n                                if (!tmp) {\n                                    this.sendTerminal(); //sending it once doesn't seem to work, sending it a 2nd time seems to register it correctly\n                                    this.sendTerminal();\n                                    this._MTTS++;\n                                }\n                            }\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (option === 69 && i === 1) // MSDP\n                        {\n                            if (this.enableDebug) debugOp += '<MSDP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 5;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 5: // MSDP Variable\n                        if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSDP_VAL>';\n                            _sb.push(i);\n                            msdp_val = '';\n                            state = 6;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 6: // MSDP Value\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSDP_VAR>';\n                            this._fireReceiveMSDP(msdp_var, msdp_val);\n                            msdp_val = '';\n                            msdp_var = '';\n                            _sb.push(i);\n                            state = 5;\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveMSDP(msdp_var, msdp_val);\n                            msdp_val = '';\n                            msdp_var = '';\n                            state = 0;\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 7: // GMCP Sub Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveGMCP(msdp_val);\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 8: // MSSP Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                this.emit('debug', this.MSSP);\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this.emit('receive-MSSP', _MSSP);\n                            msdp_val = '';\n                            msdp_var = '';\n                            _MSSP = 0;\n                            state = 0;\n                            _sb = [];\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 9;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 9: // MSSP Variable\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                            state = 8;\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                        }\n                        else if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAL>';\n                            _sb.push(i);\n                            this.MSSP[msdp_var] = '';\n                            _MSSP[msdp_var] = '';\n                            state = 10;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 10: // MSSP Value\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                            state = 8;\n                        }\n                        else if (i === 1) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAR>';\n                            _sb.push(i);\n                            msdp_var = '';\n                            state = 9;\n                        }\n                        else if (i === 2) {\n                            if (this.enableDebug) debugOp += '<MSSP_VAL>';\n                            _sb.push(i);\n                            this.MSSP[msdp_var] = '';\n                            _MSSP[msdp_var] = '';\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            this.MSSP[msdp_var] += String.fromCharCode(i);\n                            _MSSP[msdp_var] += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 11: // MCCP Sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            this._fireReceiveOption(option, 86, '');\n                            this._startMCCP();\n                            state = 0;\n                            _sb = [];\n                            if (idx < len - 1)\n                                processed.append(this.processData(data.subarray(idx + 1), skipDecompress, true));\n                            idx = len;\n                        }\n                        break;\n                    case 12: // NEWENVIRON Sub sub negotiation\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            this._fireReceiveOption(option, 250, tmp);\n                            tmp = null;\n                            this._fireReceiveGMCP(msdp_val);\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else if (i === 0) // IS\n                        {\n                            if (this.enableDebug) debugOp += '<IS>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 1) // SEND\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 2) // INFO\n                        {\n                            if (this.enableDebug) debugOp += '<SEND>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 13: // NEWENVIRON\n                        if (i === 0) //var\n                        {\n                            if (this.enableDebug) debugOp += '<VAR>';\n                            _sb.push(i);\n                            state = 14;\n                            verb = i;\n                            msdp_var = '';\n                            if (ne === -1) ne = 0;\n                        }\n                        else if (i === 1) //value\n                        {\n                            if (this.enableDebug) debugOp += '<VALUE>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                            if (ne === -1) ne = 1;\n                        }\n                        else if (i === 3) //user var\n                        {\n                            if (this.enableDebug) debugOp += '<USERVAR>';\n                            _sb.push(i);\n                            state = 13;\n                            verb = i;\n                        }\n                        else if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = ArrayBufferToString(_sb.slice(1, _sb.length - 4));\n                            tmp = this._fireReceiveOption(option, 250, tmp);\n                            this.emit('receive-NEWENVIRON', msdp_val);\n                            //custom handled so don't do defaults\n                            if (!tmp) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><NEWENVIRON><IS><IAC><SE>');\n                                this.sendData(new Uint8Array([255, 250]), true);\n                                this.sendData(option, true);\n                                this.sendData(new Uint8Array([0, 255, 240]), true);\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 14:  // NEWENVIRON Var\n                        if (i === 2) //escape\n                        {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            _sb.push(i);\n                            state = 15;\n                            pState = 14;\n                        }\n                        else if (i === 255 || i <= 3) {\n                            idx--;\n                            state = 13;\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_var += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 15:\n                        if (this.enableDebug) debugOp += this._formatByte(i);\n                        if (pState === 16)\n                            msdp_val += String.fromCharCode(i);\n                        else\n                            msdp_var += String.fromCharCode(i);\n                        state = pState;\n                        _sb.push(i);\n                        break;\n                    case 16:\n                        break;\n                    case 17: //CHARSET\n                        if (i === 1) //REQUEST\n                        {\n                            if (this.enableDebug) debugOp += '<REQUEST>';\n                            _sb.push(i);\n                            state = 18;\n                            msdp_val = '';\n                        }\n                        //TODO add ttable support\n                        //https://www.rfc-editor.org/rfc/rfc2066.html\n                        else if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = this._fireReceiveOption(option, 250, msdp_val);\n                            this.emit('receive-CHARSET', msdp_val);\n                            if (!tmp) {\n                                if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><CHARSET><REJECTED><IAC><SE>');\n                                this.sendData(new Uint8Array([255, 250, 42, 3, 255, 240]), true);\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                    case 18: //CHARSET REQUEST\n                        if (i === 255) {\n                            if (this.enableDebug) debugOp += '<IAC>';\n                            _sb.push(i);\n                        }\n                        else if (i === 240) {\n                            if (this.enableDebug) {\n                                this.emit('debug', debugOp + '<SE>');\n                                debugOp = '';\n                            }\n                            tmp = this._fireReceiveOption(option, 250, msdp_val);\n                            this.emit('receive-CHARSET', msdp_val.slice(1));\n                            if (!tmp) {\n                                if (this.options.CHARSET && msdp_val.slice(1).toLowerCase() === 'utf-8') {\n                                    this.server.CHARSET = true;\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><ACCEPTED>UTF-8<IAC><SE>');\n                                    this.sendData(new Uint8Array([255, 250, 42, 2]), true);\n                                    this.sendData('UTF-8', true);\n                                    this.sendData(new Uint8Array([255, 240]), true);\n                                }\n                                else {\n                                    if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><CHARSET><REJECTED><IAC><SE>');\n                                    this.sendData(new Uint8Array([255, 250, 42, 3, 255, 240]), true);\n                                }\n                            }\n                            state = 0;\n                            msdp_val = '';\n                            _sb = [];\n                        }\n                        else {\n                            if (this.enableDebug) debugOp += this._formatByte(i);\n                            msdp_val += String.fromCharCode(i);\n                            _sb.push(i);\n                        }\n                        break;\n                }\n            }\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        if (this.enableDebug) {\n            {\n                if (debugOp.length > 0)\n                    this.emit('debug', debugOp);\n            }\n            this.emit('debug', 'Post Split buffer length: ' + _sb.length, 1);\n            this.emit('debug', 'PostSplit buffer  ' + printArray(new Uint8Array(_sb)), 1);\n        }\n        //if processed and was prev goAhead, it needs to starts a new line to correctly end goAhead\n        if (ga && processed.length > 0)\n            processed.prepend('\\n');\n        else if (ga)  //go ahead wasn't effected and if prev true, so reset back to true\n            this.prompt = true;\n        if (processed.length > 0)\n            this.firstReceived = false;\n        this._splitBuffer = _sb;\n        if (returnRaw)\n            return processed;\n        //force UTF8 or if charset is enabled and type is UTF8 process data as UTF8 data\n        if (this.UTF8 || (this.options.CHARSET && this.server.CHARSET))\n            return UTF8.decode2(processed.toString());\n        return processed.toString();\n    }\n\n    /**\n     * @name Telnet#replyToOption\n     * @desc Replay to a telnet option\n     *\n     * @param {Number} op The telnet option code\n     * @param {Number} verb The telnet verb to reply with\n     * @param {Number} reply The telnet verb your reply from\n     * @param {String|undefined} val The value if the option has one\n     * @return boolean returns if the reply was handled or not\n     * @fires Telnet#receive-option\n     */\n    public replyToOption(op: number, verb: number, reply: number, val?: string): boolean {\n        if (typeof val === 'undefined') val = '';\n        if (this._fireReceiveOption(op, reply, val))\n            return false;\n        this.sendData(new Uint8Array([255, verb, op]), true);\n        return true;\n    }\n\n    /**\n     * @name Telnet#updateWindow\n     * @desc Send a NAWS Window update\n     *\n     * @param {Number} w The current width in lines of the window\n     * @param {Number} h The current height in characters of the window\n     */\n    public updateWindow(w, h) {\n        if (h < 1 || w < 1 || !this.connected || !this.server.NAWS) return;\n        try {\n            let w1;\n            let w2;\n            let h1;\n            let h2;\n            const mf = Math.floor;\n            w1 = mf(w / 256);\n            if (w1 > 256)\n                w1 = 255;\n            w2 = w % 256;\n            h1 = mf(h / 256);\n            if (h1 > 256)\n                h1 = 255;\n            h2 = h % 256;\n            if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><NAWS><' + w1 + '><' + w2 + '><' + h1 + '><' + h2 + '><IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 31, w1, w2, h1, h2, 255, 240]), true);\n        }\n        catch (e) {\n            this.emit('error', { message: 'UpdateWindow Error: ' + e, err: e });\n        }\n    }\n\n    /**\n     * @name Telnet#sendGMCP\n     * @desc Send a GMCP formatted string\n     *\n     * @param {String} str The GMCP formatted string to send to the host\n     */\n    public sendGMCP(str) {\n        if (this.connected && this.server.GMCP) {\n            if (this.enableDebug) this.emit('debug', 'REPLY: <IAC><SB><GMCP>' + this._escapeData(str).toString('binary') + '<IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n            this.sendData(this._escapeData(str), true);\n            this.sendData(new Uint8Array([255, 240]), true);\n        }\n    }\n\n    /**\n     * @name Telnet#startGMCP\n     * @desc Start GMCP and send Core.Hello and Core.Support.Set\n     */\n    private _startGMCP() {\n        if (this.server.GMCP) {\n            if (this.enableDebug)\n                this.emit('debug', 'REPLY: <IAC><SB><GMCP>Core.Hello { \"client\": \"' + this.terminal + '\", \"version\": \"' + this.version + '\" }<IAC><SE>');\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n            this.sendData('Core.Hello { \"client\": \"' + this.terminal + '\", \"version\": \"' + this.version + '\" }', true);\n            this.sendData(new Uint8Array([255, 240]), true);\n            this.sendData(new Uint8Array([255, 250, 201]), true);\n\n            if (this.GMCPSupports.length > 0) {\n                //ensure we at least support core module\n                if (this.GMCPSupports.indexOf('Core 1') === -1)\n                    this.GMCPSupports.unshift('Core 1');\n                if (this.enableDebug)\n                    this.emit('debug', 'REPLY: <IAC><SB><GMCP>' + JSON.stringify(this.GMCPSupports) + '<IAC><SE>');\n                this.sendData('Core.Supports.Set ' + JSON.stringify(this.GMCPSupports));\n            }\n            else {\n                if (this.enableDebug)\n                    this.emit('debug', 'REPLY: <IAC><SB><GMCP>Core.Supports.Set [ \"Core 1\" ]<IAC><SE>');\n                this.sendData('Core.Supports.Set [ \"Core 1\" ]', true);\n            }\n            this.sendData(new Uint8Array([255, 240]), true);\n        }\n    }\n\n    /**\n     * @name Telnet#startMCCP\n     * @desc Start MCCP compression protocol and set compress state on\n     */\n    private _startMCCP() {\n        this._zlib = true;\n    }\n\n    /**\n     * @name Telnet#endMCCP\n     * @desc End MCCP compression protocol and set compress state off\n     */\n    private _endMCCP() {\n        this._zlib = false;\n        this._zStream = 0;\n    }\n\n    /**\n     * @name Telnet#decompressData\n     * @desc Decompresses a ZLIB stream if ZLIB is present and compress state is on\n     *\n     * @param {String} data The compressed data string\n     * @returns {String} The decompressed data or the original data i ZLIB is not found or compress state is off\n     */\n    private _decompressData(data) {\n        if (!this._zlib) return data;\n        if (!this._zStream)\n            this._zStream = new Zlib.InflateStream();\n        if (this.enableDebug) this.emit('debug', 'Pre decompress:' + printArray(data), 1);\n        data = this._zStream.decompress(data);\n        if (this.enableDebug) this.emit('debug', 'Post decompress:' + printArray(data), 1);\n        return new Uint8Array(data);\n    }\n\n    /**\n     * @name Telnet#escapeData\n     * @desc Escape data for sending over telnet, IAC should become IAC IAC and \\r to \\r\\0 and \\n to \\r\\n\n     *\n     * @param {String} data the data to be escaped\n     * @returns {String} the data after being escaped\n     *\n     */\n    private _escapeData(data) {\n        if (data == null || typeof data === 'undefined') return data;\n        let dl;\n        let ba;\n        let idx = 0;\n        let i;\n        let c;\n        if (data instanceof Uint8Array) {\n            dl = data.byteLength;\n            ba = new StringBuffer();\n            for (; idx < dl; idx++) {\n                ba.appendCode(data[idx]);\n                if (data[idx] === 255)\n                    ba.appendCode(255);\n                else if (data[idx] === 13 && dl === 1)\n                    ba.append('\\r\\n');\n                else if (data[idx] === 10 && dl === 1)\n                    ba.append('\\r\\0');\n            }\n            return ba.toString();\n        }\n        dl = data.length;\n        ba = new StringBuffer();\n        for (; idx < dl; idx++) {\n            c = data.charAt(idx);\n            i = data.charCodeAt(idx);\n            ba.append(c);\n            if (i === 255)\n                ba.append(c);\n            else if (i === 13 && dl === 1)\n                ba.append('\\r\\n');\n            else if (i === 10 && dl === 1)\n                ba.append('\\r\\0');\n        }\n        return ba.toString();\n    }\n\n    /**\n     * @name Telnet#createSocket \n     * @desc Create a websocket object and assign events\n     *\n     * @returns {object} returns the socket object\n     */\n    private _createSocket(host, port) {\n        let _socket;\n        try {\n            //test if host has a scheme:// at the start and use it, does not care if it is a valid one or not let websocket worry about that\n            const hasScheme = /^[a-z0-9]+:\\/\\//.test(host);\n            //if scheme and has a port set append the port\n            if (hasScheme && port > 0)\n                _socket = new WebSocket(host + ':' + port, this.protocol || 'binary');\n            //no port but a scheme so use host and let websocket use default ports\n            else if (hasScheme)\n                _socket = new WebSocket(host, this.protocol || 'binary');\n            //host and port, prepend scheme and append port\n            else if (host && port > 0)\n                _socket = new WebSocket((this.scheme || 'ws://') + host + ':' + port, this.protocol || 'binary');\n            //when all else fails just try and use host prepended with scheme\n            else if (host)\n                _socket = new WebSocket((this.scheme || 'ws://') + host, this.protocol || 'binary');\n            _socket.binaryType = 'arraybuffer';\n            //the socket was closed for some reason, any code but 1000 means some type of error so send it to the error system, call close for cleanup and then trigger teh onClose event\n            _socket.onclose = (evt) => {\n                if (evt.code === 1006 && evt.type === 'close' && !this._closed)\n                    this.close();\n                else if (evt.code !== 1000 && !this._closed) {\n                    this.emit('error', { message: 'Closed due to transmission error', err: evt });\n                    this.close();\n                }\n            };\n            //trigger the onConnect event when the socket has been opened\n            _socket.onopen = () => {\n                this._connected = true;\n                this.emit('connect');\n            };\n            //data was received, process the data\n            _socket.onmessage = (evt) => {\n                if (evt.data instanceof ArrayBuffer) {\n                    let data = new Uint8Array(evt.data);\n                    if (this.enableDebug) this.emit('debug', 'Data ArrayBuffer received:' + printArray(data));\n                    this.receivedData(data);\n                }\n                else if (evt.data instanceof Blob) {\n                    let reader = new FileReader();\n                    reader.onloadend = () => {\n                        let data = new Uint8Array(<ArrayBuffer>reader.result);\n                        this.receivedData(data);\n                        if (this.enableDebug) this.emit('debug', 'Data Blob received:' + printArray(reader.result));\n                    };\n                    reader.readAsArrayBuffer(evt.data);\n                }\n                else {\n                    if (this.enableDebug) this.emit('debug', 'Data received:' + evt.data);\n                    this.receivedData(evt.data);\n                }\n            };\n            //an error happened so let the error function fire\n            _socket.onerror = (evt) => {\n                if (!this._closed)\n                    this.emit('error', evt);\n            };\n            return _socket;\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        return null;\n    }\n\n    /**\n    * @name Telnet#destroySocket\n    * @desc Destroy the current websocket object by assigning all functions to be empty\n    *\n    * @returns {object} returns null\n    */\n    private _destroySocket() {\n        if (!this.socket || this.socket == null) return;\n        try {\n            this.socket.onopen = function () { };\n            this.socket.onclose = function () { };\n            this.socket.onmessage = function () { };\n            this.socket.onerror = function () { };\n            if (this.connected)\n                this.socket.close();\n            delete this.socket;\n        }\n        catch (e) {\n            this.emit('error', e);\n        }\n        this.socket = null;\n    }\n\n    /**\n    * @name Telnet#fireTelnetOption \n    * @desc Fire the onTelnetOption e\n    *\n    * @returns {object} returns null\n    */\n    private _fireReceiveOption(option, verb, val) {\n        const data: TelnetOption = { telnet: this, option: option, verb: 250, value: val, handled: false };\n        this.emit('received-option', data);\n        return data.handled;\n    }\n\n    private _fireReceiveMSDP(msdp_var, msdp_val) {\n        const data = { telnet: this, variable: msdp_var, value: msdp_val, handled: false };\n        this.emit('received-MSDP', data);\n        return data.handled;\n    }\n\n    private _fireReceiveGMCP(val) {\n        const data = { telnet: this, value: val, handled: false };\n        this.emit('received-GMCP', data);\n        return data.handled;\n    }\n\n    private _formatByte(b) {\n        if (b < 32 || b >= 127)\n            return '<' + b + '>';\n        return String.fromCharCode(b);\n    }\n\n    /**\n     * @name Telnet#onError\n     * @desc Fired when an error happens\n     * @method \n     * @event Telnet#onError\n     * @property {String|Object} err - the err object or message\n     */\n\n    /**\n     * @name Telnet#onConnecting\n     * @desc Fired when attempting to connect to host\n     * @method  \n     * @event Telnet#onConnecting\n     */\n\n    /**\n     * @name Telnet#onConnect\n     * @desc Fired when successfully connected to host\n     * @method  \n     * @event Telnet#onConnect\n     */\n\n    /**\n    * @name Telnet#onClose\n    * @desc Fired when connection is closed to host\n    * @method  \n    * @event Telnet#onClose\n    */\n\n    /**\n     * @name Telnet#onReceivedData\n     * @desc Fired when data is received from the host\n     * @method  \n     * @event Telnet#onReceivedData\n     * @property {String} data - received from the host after being processed for telnet options\n     */\n\n    /**\n     * @name Telnet#onDataSent\n     * @desc Fired when data is sent to the host\n     * @method  \n     * @event Telnet#onDataSent\n     * @property {String} data - data that was sent to the host\n     */\n\n    /**\n     * @name Telnet#onReceiveMSDP\n     * @desc Fired when a MSDP variable is received from host\n     * @method  \n     * @event Telnet#onReceiveMSDP\n     * @property {String} msdp_var - MSDP variable name\n     * @property {String} msdp_val - MSDP value of variable\n     */\n\n    /**\n    * @name Telnet#onReceiveGMCP\n    * @desc Fired when GMCP data is received from host\n    * @method  \n    * @event Telnet#onReceiveGMCP\n    * @property {String} value - The raw GMCP string\n    */\n\n    /**\n    * @name Telnet#onReceiveMSSP\n    * @desc Fired when MSSP variables and values are found\n    * @method  \n    * @event Telnet#onReceiveMSSP\n    * @type {object}\n    * @property {object} - the MSSP object containing all variables and values found\n    */\n\n    /**\n     * @name Telnet#onTelnetOption\n     * @desc Fired when a telnet option is found and before any reply sent\n     * @method  \n     * @event Telnet#onTelnetOption\n     * @type {object}\n     * @property {Number} option - Telnet option code\n     * @property {Number} verb - Telnet verb being replied to\n     * @property {String} value - Telnet option value if it has one\n     *\n     * @returns {Boolean} true if the option was handled, false if not handled and to continue default action\n     */\n\n}\n\nwindow.telnet = new Telnet;", "//spell-checker:ignore Xred\r\n/**\r\n *\r\n *\r\n * @export\r\n * @enum {number}\r\n */\r\nexport enum Ansi {\r\n    None = 0,\r\n    Bold = 1,\r\n    Faint = 2,\r\n    Underline = 4,\r\n    Italic = 3,\r\n    Slow = 5,\r\n    Rapid = 6,\r\n    Inverse = 7,\r\n    Hidden = 8,\r\n    Strikeout = 9,\r\n    DoubleUnderline = 21,\r\n    Overline = 53\r\n}\r\n\r\n/**\r\n * Enum for Ansi color codes.\r\n * @readonly\r\n * @enum {number}\r\n */\r\nexport enum AnsiColorCode {\r\n    /** @desc  Custom color for error Information */\r\n    ErrorBackground = -12,\r\n    /** @desc  Custom background color for error Information */\r\n    ErrorText = -11,\r\n    /** @desc  Custom background color for client Information */\r\n    InfoBackground = -8,\r\n    /** @desc  Custom foreground color for client Information */\r\n    InfoText = -7,\r\n    /** @desc  Custom tag for local echo */\r\n    LocalEcho = -3,\r\n    /** @desc  Custom tag for local echo */\r\n    LocalEchoBack = -4,\r\n    /** @desc All attributes off */\r\n    Reset = 0,\r\n    /** @desc Bold ON */\r\n    Bold = 1,\r\n    /** @desc Faint ON */\r\n    Faint = 2,\r\n    /** @desc Italic ON */\r\n    Italic = 3,\r\n    /** @desc Underscore */\r\n    Underline = 4,\r\n    /** @desc Blink ON (Slow) */\r\n    Blink = 5,\r\n    /** @desc Blink ON (Rapid) */\r\n    BlinkRapid = 6,\r\n    /** @desc Reverse Video ON */\r\n    Reverse = 7,\r\n    /** @desc Concealed ON */\r\n    Hidden = 8,\r\n    /** @desc  strike through */\r\n    StrikeThrough = 9,\r\n    /** @desc double underline on */\r\n    DoubleUnderline = 21,\r\n    /** @desc bold off */\r\n    BoldOff = 22,\r\n    /** @desc italics off */\r\n    ItalicOff = 23,\r\n    /** @desc underline off */\r\n    UnderlineOff = 24,\r\n    /** @desc blink off (slow) */\r\n    BlinkOff = 25,\r\n    /** @desc blink off (rapid) */\r\n    BlinkRapidOff = 26,\r\n    /** @desc inverse off */\r\n    ReverseOff = 27,\r\n    /** @desc Visible */\r\n    Visible = 28,\r\n    /** @desc strike through off */\r\n    StrikeThroughOff = 29,\r\n    /** @desc Black Foreground */\r\n    Black = 30,\r\n    /** @desc Red Foreground */\r\n    Red = 31,\r\n    /** @desc Green Foreground */\r\n    Green = 32,\r\n    /** @desc Yellow Foreground */\r\n    Yellow = 33,\r\n    /** @desc Blue Foreground */\r\n    Blue = 34,\r\n    /** @desc Magenta Foreground */\r\n    Magenta = 35,\r\n    /** @desc Cyan Foreground */\r\n    Cyan = 36,\r\n    /** @desc White Foreground */\r\n    White = 37,\r\n    /** @desc Default */\r\n    DefaultFore = 39,\r\n    /** @desc Black Background */\r\n    BlackBackground = 40,\r\n    /** @desc Red Background */\r\n    RedBackground = 41,\r\n    /** @desc Green Background */\r\n    GreenBackground = 42,\r\n    /** @desc Yellow Background */\r\n    YellowBackground = 43,\r\n    /** @desc Blue Background */\r\n    BlueBackground = 44,\r\n    /** @desc Magenta Background */\r\n    MagentaBackground = 45,\r\n    /** @desc Cyan Background */\r\n    CyanBackground = 46,\r\n    /** @desc White Background */\r\n    WhiteBackground = 47,\r\n    /** @desc default */\r\n    DefaultBack = 49,\r\n    /** @desc Subscript */\r\n    Subscript = 74,\r\n    /** @desc Superscript */\r\n    Superscript = 73,\r\n    SubSuperOff = 75,\r\n    // xterm 16 color support\r\n    /** @desc Set foreground color to Black */\r\n    XBlack = 90,\r\n    /** @desc Set foreground color to Red */\r\n    XRed = 91,\r\n    /** @desc Set foreground color to Green */\r\n    XGreen = 92,\r\n    /** @desc Set foreground color to Yellow */\r\n    XYellow = 93,\r\n    /** @desc Set foreground color to Blue */\r\n    XBlue = 94,\r\n    /** @desc Set foreground color to Magenta */\r\n    XMagenta = 95,\r\n    /** @desc Set foreground color to Cyan */\r\n    XCyan = 96,\r\n    /** @desc Set foreground color to White */\r\n    XWhite = 97,\r\n    /** @desc Set background color to Black */\r\n    XBlackBackground = 100,\r\n    /** @desc Set background color to Red */\r\n    XRedBackground = 101,\r\n    /** @desc Set background color to Green */\r\n    XGreenBackground = 102,\r\n    /** @desc Set background color to Yellow */\r\n    XYellowBackground = 103,\r\n    /** @desc Set background color to Blue */\r\n    XBlueBackground = 104,\r\n    /** @desc Set background color to Magenta */\r\n    XMagentaBackground = 105,\r\n    /** @desc Set background color to Cyan */\r\n    XCyanBackground = 106,\r\n    /** @desc Set background color to White */\r\n    XWhiteBackground = 107\r\n}\r\n\r\nexport function getAnsiColorCode(color: string, back?: boolean) {\r\n    switch (color.toLowerCase()) {\r\n        case 'black':\r\n            return back ? 40 : 30;\r\n        case 'red':\r\n            return back ? 41 : 31;\r\n        case 'green':\r\n            return back ? 42 : 32;\r\n        case 'yellow':\r\n            return back ? 43 : 33;\r\n        case 'blue':\r\n            return back ? 44 : 34;\r\n        case 'magenta':\r\n            return back ? 45 : 35;\r\n        case 'cyan':\r\n            return back ? 46 : 36;\r\n        case 'white':\r\n            return back ? 47 : 37;\r\n        case 'default':\r\n            return back ? 49 : 39;\r\n    }\r\n    return -1;\r\n}\r\n\r\nexport function getColorCode(code) {\r\n    let f = -1;\r\n    let b = -1;\r\n    let bold = false;\r\n    //rev            1024\r\n    if (code - 1024 >= 0) {\r\n        code -= 1024;\r\n    }\r\n    //blink            512  \r\n    if (code - 512 >= 0) {\r\n        code -= 512;\r\n    }\r\n    //under            256    \r\n    if (code - 256 >= 0) {\r\n        code -= 256;\r\n    }\r\n    //bold            128    \r\n    if (code - 128 >= 0) {\r\n        code -= 128;\r\n        bold = true;\r\n    }\r\n    if (code - 112 >= 0) {\r\n        code -= 112\r\n        b = 47;\r\n    }\r\n    if (code - 96 >= 0) {\r\n        code -= 96;\r\n        b = 43;\r\n    }\r\n    if (code - 80 >= 0) {\r\n        code -= 80;\r\n        b = 45;\r\n    }\r\n    if (code - 64 >= 0) {\r\n        code -= 64;\r\n        b = 41;\r\n    }\r\n    if (code - 48 >= 0) {\r\n        code -= 48;\r\n        b = 46\r\n    }\r\n    if (code - 32 >= 0) {\r\n        code -= 32;\r\n        b = 42;\r\n    }\r\n    if (code - 16 >= 0) {\r\n        code -= 16;\r\n        b = 44;\r\n    }\r\n    if (code >= 8) {\r\n        code -= 8;\r\n        bold = true;\r\n    }\r\n    switch (code) {\r\n        case 0:\r\n            f = 30;\r\n            break;\r\n        case 1:\r\n            f = 34;\r\n            break;\r\n        case 2:\r\n            f = 32;\r\n            break;\r\n        case 3:\r\n            f = 36;\r\n            break;\r\n        case 4:\r\n            f = 31;\r\n            break;\r\n        case 5:\r\n            f = 35;\r\n            break;\r\n        case 6:\r\n            f = 33;\r\n            break;\r\n        case 7:\r\n            f = 37;\r\n            break;\r\n    }\r\n    if (bold && f === -1) f = 370;\r\n    else if (bold) f *= 10;\r\n    if (f === -1)\r\n        return `,${b}`;\r\n    if (b === -1)\r\n        return f.toString();\r\n    return `${f},${b}`\r\n}\r\n\r\nexport function isMXPColor(color) {\r\n    if (!color || color.length === 0) return false;\r\n    return ['indianred', 'lightcoral', 'salmon', 'darksalmon', 'lightsalmon',\r\n        'crimson', 'red', 'firebrick', 'darkred', 'pink', 'lightpink', 'hotpink', 'deeppink',\r\n        'mediumvioletred', 'palevioletred', 'lightsalmon', 'coral', 'tomato', 'orangered',\r\n        'darkorange', 'orange', 'gold', 'yellow', 'lightyellow', 'lemonchiffon',\r\n        'lightgoldenrodyellow', 'papayawhip', 'moccasin', 'peachpuff', 'palegoldenrod',\r\n        'khaki', 'darkkhaki', 'lavender', 'thistle', 'plum', 'violet', 'orchid', 'fuchsia',\r\n        'magenta', 'mediumorchid', 'mediumpurple', 'blueviolet', 'darkviolet',\r\n        'darkorchid', 'darkmagenta', 'purple', 'indigo', 'slateblue', 'darkslateblue',\r\n        'mediumslateblue', 'greenyellow', 'chartreuse', 'lawngreen', 'lime', 'limegreen',\r\n        'palegreen', 'lightgreen', 'mediumspringgreen', 'springgreen', 'mediumseagreen',\r\n        'seagreen', 'forestgreen', 'green', 'darkgreen', 'yellowgreen', 'olivedrab',\r\n        'olive', 'darkolivegreen', 'mediumaquamarine', 'darkseagreen', 'lightseagreen',\r\n        'darkcyan', 'teal', 'aqua', 'cyan', 'lightcyan', 'paleturquoise', 'aquamarine',\r\n        'turquoise', 'mediumturquoise', 'darkturquoise', 'cadetblue', 'steelblue',\r\n        'lightsteelblue', 'powderblue', 'lightblue', 'skyblue', 'lightskyblue',\r\n        'deepskyblue', 'dodgerblue', 'cornflowerblue', 'mediumslateblue', 'royalblue',\r\n        'blue', 'mediumblue', 'darkblue', 'navy', 'midnightblue', 'cornsilk',\r\n        'blanchedalmond', 'bisque', 'navajowhite', 'wheat', 'burlywood', 'tan',\r\n        'rosybrown', 'sandybrown', 'goldenrod', 'darkgoldenrod', 'peru', 'chocolate',\r\n        'saddlebrown', 'sienna', 'brown', 'maroon', 'white', 'snow', 'honeydew',\r\n        'mintcream', 'azure', 'aliceblue', 'ghostwhite', 'whitesmoke', 'seashell',\r\n        'beige', 'oldlace', 'floralwhite', 'ivory', 'antiquewhite', 'linen',\r\n        'lavenderblush', 'mistyrose', 'gainsboro', 'lightgrey', 'silver', 'darkgray',\r\n        'gray', 'dimgray', 'lightslategray', 'slategray', 'darkslategray', 'black'].indexOf(color.toLowerCase()) != -1;\r\n}\r\n\r\nexport function getAnsiCode(str, back?: boolean) {\r\n    switch (str) {\r\n        /** @desc  custom color for error information */\r\n        case 'errortextbackground':\r\n        case 'errorbackground':\r\n            return -12;\r\n        /** @desc  custom background color for error information */\r\n        case 'errortext':\r\n            return back ? -12 : -11;\r\n        /** @desc  custom background color for client information */\r\n        case 'infobackground':\r\n            return -8;\r\n        /** @desc  custom foreground color for client information */\r\n        case 'infotext':\r\n            return back ? -8 : -7;\r\n        /** @desc  custom tag for local echo */\r\n        case 'localecho':\r\n            return back ? -4 : -3;\r\n        /** @desc  custom tag for local echo */\r\n        case 'localechoback':\r\n            return -4;\r\n        /** @desc all attributes off */\r\n        case 'reset':\r\n            return 0;\r\n        /** @desc bold on */\r\n        case 'bold':\r\n            return 1;\r\n        /** @desc faint on */\r\n        case 'faint':\r\n            return 2;\r\n        /** @desc italic on */\r\n        case 'italic':\r\n            return 3;\r\n        /** @desc underscore */\r\n        case 'underline':\r\n            return 4;\r\n        /** @desc blink on (slow) */\r\n        case 'blink':\r\n            return 5;\r\n        /** @desc blink on (rapid) */\r\n        case 'blinkrapid':\r\n            return 6;\r\n        /** @desc reverse video on */\r\n        case 'reverse':\r\n            return 7;\r\n        /** @desc concealed on */\r\n        case 'hidden':\r\n            return 8;\r\n        /** @desc  strike through */\r\n        case 'strikethrough':\r\n            return 9;\r\n        /** @desc double underline on */\r\n        case 'doubleunderline':\r\n            return 21;\r\n        /** @desc bold off */\r\n        case 'boldoff':\r\n            return 22;\r\n        /** @desc italics off */\r\n        case 'italicoff':\r\n            return 23;\r\n        /** @desc underline off */\r\n        case 'underlineoff':\r\n            return 24;\r\n        /** @desc blink off (slow) */\r\n        case 'blinkoff':\r\n            return 25;\r\n        /** @desc blink off (rapid) */\r\n        case 'blinkrapidoff':\r\n            return 26;\r\n        /** @desc inverse off */\r\n        case 'reverseoff':\r\n            return 27;\r\n        /** @desc visible */\r\n        case 'visible':\r\n            return 28;\r\n        /** @desc strike through off */\r\n        case 'strikethroughoff':\r\n            return 29;\r\n        /** @desc black foreground */\r\n        case 'black':\r\n            return back ? 40 : 30;\r\n        /** @desc red foreground */\r\n        case 'red':\r\n            return back ? 41 : 31;\r\n        /** @desc green foreground */\r\n        case 'green':\r\n            return back ? 42 : 32;\r\n        /** @desc yellow foreground */\r\n        case 'yellow':\r\n            return back ? 43 : 33;\r\n        /** @desc blue foreground */\r\n        case 'blue':\r\n            return back ? 44 : 34;\r\n        /** @desc magenta foreground */\r\n        case 'magenta':\r\n            return back ? 45 : 35;\r\n        /** @desc cyan foreground */\r\n        case 'cyan':\r\n            return back ? 46 : 36;\r\n        /** @desc white foreground */\r\n        case 'white':\r\n            return back ? 47 : 37;\r\n        /** @desc default */\r\n        case 'default':\r\n        case 'defaultfore':\r\n            return back ? 49 : 39;\r\n        /** @desc black background */\r\n        case 'blackbackground':\r\n            return 40;\r\n        /** @desc red background */\r\n        case 'redbackground':\r\n            return 41;\r\n        /** @desc green background */\r\n        case 'greenbackground':\r\n            return 42;\r\n        /** @desc yellow background */\r\n        case 'yellowbackground':\r\n            return 43;\r\n        /** @desc blue background */\r\n        case 'bluebackground':\r\n            return 44;\r\n        /** @desc magenta background */\r\n        case 'magentabackground':\r\n            return 45;\r\n        /** @desc cyan background */\r\n        case 'cyanbackground':\r\n            return 46;\r\n        /** @desc white background */\r\n        case 'whitebackground':\r\n            return 47;\r\n        /** @desc default */\r\n        case 'defaultbackground':\r\n        case 'defaultback':\r\n            return 49;\r\n        case 'overline':\r\n            return 53;\r\n        /** @desc subscript */\r\n        case 'subscript':\r\n            return 74;\r\n        /** @desc superscript */\r\n        case 'superscript':\r\n            return 73;\r\n        case 'subsuperoff':\r\n            return 75;\r\n        // xterm 16 color support\r\n        /** @desc set foreground color to black */\r\n        case 'xblack':\r\n            return back ? 100 : 90;\r\n        /** @desc set foreground color to red */\r\n        case 'xred':\r\n            return back ? 101 : 91;\r\n        /** @desc set foreground color to green */\r\n        case 'xgreen':\r\n            return back ? 102 : 92;\r\n        /** @desc set foreground color to yellow */\r\n        case 'xyellow':\r\n            return back ? 103 : 93;\r\n        /** @desc set foreground color to blue */\r\n        case 'xblue':\r\n            return back ? 104 : 94;\r\n        /** @desc set foreground color to magenta */\r\n        case 'xmagenta':\r\n            return back ? 105 : 95;\r\n        /** @desc set foreground color to cyan */\r\n        case 'xcyan':\r\n            return back ? 106 : 96;\r\n        /** @desc set foreground color to white */\r\n        case 'xwhite':\r\n            return back ? 107 : 97;\r\n        /** @desc set background color to black */\r\n        case 'xblackbackground':\r\n            return 100;\r\n        /** @desc set background color to red */\r\n        case 'xredbackground':\r\n            return 101;\r\n        /** @desc set background color to green */\r\n        case 'xgreenbackground':\r\n            return 102;\r\n        /** @desc set background color to yellow */\r\n        case 'xyellowbackground':\r\n            return 103;\r\n        /** @desc set background color to blue */\r\n        case 'xbluebackground':\r\n            return 104;\r\n        /** @desc set background color to magenta */\r\n        case 'xmagentabackground':\r\n            return 105;\r\n        /** @desc set background color to cyan */\r\n        case 'xcyanbackground':\r\n            return 106;\r\n        /** @desc set background color to white */\r\n        case 'xwhitebackground':\r\n            return 107\r\n    }\r\n    return -1;\r\n}", "import { Display } from './display';\n\nexport interface Point {\n  x: number;\n  y: number;\n  lineID: number;\n}\n\nexport interface DisplayOptions extends ParserOptions {\n  colors?: boolean;\n  backgroundColors?: boolean;\n  container?: string | JQuery | HTMLElement;\n}\n\nexport interface WindowState {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  maximized: boolean;\n}\n\nexport enum NewLineType {\n  None = 0,\n  Ctrl = 1,\n  Shift = 2,\n  CtrlOrShift = 4,\n  CtrlAndShift = 8\n}\n\nexport enum ScriptEngineType {\n  Full = 1,\n  Fast = 2,\n  Simple = 4\n}\n\nexport enum FormatType {\n  Normal = 0,\n  Link = 1,\n  LinkEnd = 2,\n  MXPLink = 3,\n  MXPLinkEnd = 4,\n  Image = 5,\n  WordBreak = 6,\n  MXPSend = 7,\n  MXPSendEnd = 8,\n  MXPExpired = 9,\n  MXPSkip = 10\n}\n\nexport enum OnDisconnect {\n  Nothing = 0, Reconnect = 1, ReconnectDialog = 2, LoadManager = 4, Close = 8\n}\n\nexport enum OnProfileChange {\n  Nothing = 0, Reload = 1, Ask = 2, Warn = 4\n}\n\nexport enum OnProfileDeleted {\n  Nothing = 0, Remove = 1, Ask = 2, Warn = 4\n}\n\nexport enum ProfileSortOrder {\n  None = 0, Alpha = 2, Priority = 4, Index = 8\n}\n\nexport enum Echo {\n  None = 0, Triggers = 8, Scripts = 2, Commands = 4\n}\n\nexport enum TabCompletion { PrependBuffer = 1, AppendBuffer = 2, BufferOnly = 4, List = 8 }\n\n/**\n   * Enum flag for Font styles.\n   * @readonly\n   * @enum {number}\n   * @typedef {number} FontStyle\n   */\nexport enum FontStyle {\n  None = 0,\n  Bold = 1,\n  Faint = 2,\n  Italic = 4,\n  Underline = 8,\n  Slow = 16, /** @desc Slow blink text combined with slow for final blink  */\n  Rapid = 32, /** @desc Rapid blink text combined with slow for final blink */\n  Inverse = 64, /** @desc reverse back and fore color */\n  Hidden = 128, /** @desc hide text */\n  Strikeout = 256,\n  DoubleUnderline = 512,\n  Overline = 1024\n}\n\nexport enum SettingType {\n  String = 0,\n  Boolean = 1,\n  Number = 2,\n  Raw = 3,\n  Custom = 4,\n  ComboBox = 5\n}\n\nexport interface LineFormat {\n  formatType: FormatType;\n  offset: number;\n  color: string | number;\n  background: string | number;\n  size: string;\n  font: string;\n  style: FontStyle;\n  hr?: boolean;\n}\n\nexport interface ImageFormat {\n  formatType: FormatType;\n  name: string;\n  url: string;\n  type: string;\n  height: string;\n  width: string;\n  vspace: string;\n  align: string;\n  ismap: boolean;\n}\n\nexport interface LinkFormat {\n  formatType: FormatType;\n  href?: string;\n  hint?: string;\n  expire?: string;\n  prompt?: boolean;\n  tt?: string | number;\n}\n\nexport interface ParserLine {\n  raw: string;\n  line: string;\n  fragment: boolean;\n  gagged: boolean;\n  formats: LineFormat[];\n  remote: boolean;\n  timestamp?: number;\n}\n\nexport interface ParserOptions {\n  DefaultImageURL?: string;\n  enableMXP?: boolean;\n  enableDebug?: boolean;\n  enableMSP?: boolean;\n  enableURLDetection?: boolean;\n  window?: Size;\n  enableFlashing?: boolean;\n  emulateTerminal?: boolean;\n  bell?: string;\n  enableBell?: boolean;\n  display?: Display;\n  enableLinks?: boolean;\n  showInvalidMXPTags?: boolean;\n}\n\nexport class Size {\n  public width: number;\n  public height: number;\n\n  constructor(width: number, height: number) {\n    this.width = width || 0;\n    this.height = height || 0;\n  }\n}\n\nexport enum IEDError {\n  RESET = 1,\n  USERRESET = 2,\n  DL_USERABORT = 3,\n  DL_NOTSTART = 4,\n  DL_TOOMANY = 5,\n  DL_INPROGRESS = 6,\n  DL_UNKNOWN = 7,\n  UL_USERABORT = 8,\n  UL_BADENCODE = 9,\n  UL_TOOLARGE = 10,\n  UL_FAILWRITE = 11,\n  UL_UNKNOWN = 12,\n  UL_INVALIDFILE = 13,\n  UL_INVALIDPATH = 14,\n  DL_INVALIDFILE = 15,\n  DL_INVALIDPATH = 16,\n  CMD_INVALIDFMT = 17,\n  CMD_INVALID = 18,\n  DIR_INVALIDFMT = 19,\n  DIR_INVALIDPATH = 20,\n  UL_INVALIDFMT = 21,\n  DL_INVALIDFMT = 22,\n  DIR_TOOMANY = 23,\n  DIR_CANTREAD = 24,\n  DIR_NOTSTART = 25,\n  CMD_DENIED = 26,\n  CMD_INVALIDFILE = 27,\n  CMD_INVALIDARG = 28,\n  CMD_INVALIDPATH = 29,\n  INVALIDPATH = 30,\n  INVALIDFILE = 31,\n  CMD_NOEXIST = 32,\n  CMD_DIRECTORY = 33,\n  CMD_EXIST = 34,\n  CMD_UNKNOWN = 35,\n  UL_TOOMANY = 36,\n  UL_INPROGRESS = 37,\n  CMD_FILE = 38,\n  UL_DENIED = 39,\n  UL_FILE = 40,\n  USER_DENIED = 41\n}\n\nexport enum IEDCmdStatus {\n  denied = 0,\n  success = 1,\n  failed = 2\n}\n\nexport enum ProfileSaveType {\n  Any = 0,\n  Trigger = 1,\n  Button = 2,\n  Macro = 4,\n  Alias = 8,\n  Context = 16,\n  Variable = 32\n}\n\nexport interface MenuItem {\n  id?: string;\n  name: string;\n  action?: Function | string;\n  icon?: string;\n  position?: number | string;\n  active?: boolean,\n  exists?,\n  hidden?: boolean\n}\n\nexport interface FunctionEvent {\n  name: string;\n  args: string[];\n  raw: string;\n  handled: boolean;\n  return: any;\n}\n", "//spell-checker:words vscroll, hscroll, askoncancel, askonclose,commandon, cmdfont\n//spell-checker:ignore emoteto, emotetos askonchildren YYYYMMDD Hmmss\nimport { NewLineType, OnDisconnect, ProfileSortOrder, OnProfileChange, OnProfileDeleted, ScriptEngineType, SettingType, Echo, TabCompletion } from './types';\nimport { isMobile } from './library'\n\n/**\n * Array that contains details about setting values\n * [settingKey, object property, setting data type, default value, max length\n *\n * settingKey - unique key value, object property value if object property undefined, 0 or null\n * object property - the value used to access setting if settingKey is not property, can use . to denote nested properties\n * setting data type - the data type of setting\n *      0 string\n *      1 boolean\n *      2 number\n *      3 raw setting\n *      4 custom\n *      5 combo-box\n * default value - the default value of setting\n * max length - optional max length\n */\nexport let SettingList: any[] = [\n    ['bufferSize', 0, 2, 500],\n    ['commandDelay', 0, 2, 500],\n    ['commandDelayCount', 0, 2, 5],\n    ['commandHistorySize', 0, 2, 20],\n    ['fontSize', 0, 0, '1em', 0],\n    ['cmdfontSize', 0, 0, '1em', 0],\n    ['commandEcho', 0, 1, true],\n    ['flashing', 0, 1, false],\n    ['autoConnect', 0, 1, true],\n    ['enableAliases', -1, 1, true],\n    ['enableTriggers', -1, 1, true],\n    ['enableMacros', -1, 1, true],\n    ['showScriptErrors', 0, 1, false],\n    ['commandStacking', 0, 1, true],\n    ['commandStackingChar', 0, 0, ';', 1],\n    ['htmlLog', 0, 1, true],\n    ['keepLastCommand', 0, 1, true],\n    ['enableMCCP', 0, 1, true],\n    ['enableUTF8', 0, 1, true],\n    ['font', 0, 5, '\\'Courier New\\', Courier, monospace', 0],\n    ['cmdfont', 0, 5, '\\'Courier New\\', Courier, monospace', 0],\n    ['aliases', -1, 4],\n    ['macros', -1, 4],\n    ['triggers', -1, 4],\n    ['mapFollow', 'mapper.follow', 1, true],\n    ['mapEnabled', 'mapper.enabled', 1, true],\n    ['MapperSplitArea', 'mapper.split', 1, false],\n    ['MapperFillWalls', 'mapper.fill', 1, false],\n    ['MapperOpen', 'showMapper', 1, false],\n    ['fullScreen', -1, 3, false],\n    ['enableMXP', 0, 1, true],\n    ['enableMSP', 0, 1, true],\n    ['parseCommands', 0, 3, true],\n    ['lagMeter', 0, 1, true],\n    ['enablePing', 0, 1, false],\n    ['enableEcho', 0, 1, true],\n    ['enableSpeedpaths', 0, 1, true],\n    ['speedpathsChar', 0, 0, '!', 1],\n    ['parseSpeedpaths', 0, 1, true],\n    ['profile', -1, 0, 'Default', 1],\n    ['parseSingleQuotes', 0, 1, false],\n    ['parseDoubleQuotes', 0, 1, true],\n    ['logEnabled', 0, 1, false],\n    ['logPrepend', 0, 1, false],\n    ['logOffline', 0, 1, false],\n    ['logUniqueOnConnect', 0, 1, true],\n    ['enableURLDetection', 0, 1, true],\n    ['colors', 0, 4],\n    ['notifyMSPPlay', 0, 1, false],\n    ['CommandonClick', 0, 1, true],\n    ['allowEval', 0, 1, true],\n    ['allowEscape', 0, 1, true],\n    ['AutoCopySelectedToClipboard', 0, 1, false],\n    ['enableDebug', 0, 1, false],\n    ['editorPersistent', 0, 1, false],\n    ['askonclose', 0, 1, true],\n    ['dev', 0, 1, false],\n    //New settings\n    ['chat.captureLines', 0, 1, false],\n    ['chat.captureAllLines', 0, 1, false],\n    ['chat.captureReviews', 0, 1, false],\n    ['chat.captureTells', 0, 1, false],\n    ['chat.captureTalk', 0, 1, false],\n    ['chat.gag', 0, 1, false],\n    ['chat.CaptureOnlyOpen', 0, 1, false],\n    ['checkForUpdates', 0, 1, false],\n    ['autoCreateCharacter', 0, 1, false],\n    ['askonchildren', 0, 1, true],\n    ['mapper.legend', 0, 1, false],\n    ['mapper.room', 0, 1, false],\n    ['mapper.importType', 0, 2, 1],\n    ['mapper.vscroll', 0, 2, 0],\n    ['mapper.hscroll', 0, 2, 0],\n    ['mapper.scale', 0, 2, 100],\n    ['mapper.alwaysOnTop', 0, 1, false],\n    ['mapper.alwaysOnTopClient', 0, 1, true],\n    ['mapper.memory', 0, 1, false],\n    ['mapper.memorySavePeriod', 0, 2, 900000],\n    ['mapper.active.ID', 0, 0, null],\n    ['mapper.active.x', 0, 2, 0],\n    ['mapper.active.y', 0, 2, 0],\n    ['mapper.active.z', 0, 2, 0],\n    ['mapper.active.area', 0, 0, null],\n    ['mapper.active.zone', 0, 2, 0],\n    ['mapper.persistent', 0, 1, true],\n    ['profiles.split', 0, 2, 204],\n    ['profiles.askoncancel', 0, 1, true],\n    ['profiles.triggersAdvanced', 0, 1, false],\n    ['profiles.aliasesAdvanced', 0, 1, false],\n    ['profiles.buttonsAdvanced', 0, 1, false],\n    ['profiles.macrosAdvanced', 0, 1, false],\n    ['profiles.contextsAdvanced', 0, 1, false],\n    ['profiles.codeEditor', 0, 1, true],\n    ['profiles.watchFiles', 0, 1, true],\n    ['chat.alwaysOnTop', 0, 1, false],\n    ['chat.alwaysOnTopClient', 0, 1, true],\n    ['chat.log', 0, 1, false],\n    ['chat.persistent', 0, 1, false],\n    ['chat.zoom', 0, 2, 1],\n    ['chat.font', 0, 5, '\\'Courier New\\', Courier, monospace'],\n    ['chat.fontSize', 0, 0, '1em'],\n    ['title', 0, 0, '$t'],\n    ['logGagged', 0, 1, false],\n    ['logTimeFormat', 0, 0, 'YYYYMMDD-HHmmss'],\n    ['autoConnectDelay', 0, 2, 600],\n    ['autoLogin', 0, 1, true],\n    ['onDisconnect', 0, 2, OnDisconnect.ReconnectDialog],\n    ['enableKeepAlive', 0, 1, false],\n    ['keepAliveDelay', 0, 2, 0],\n    ['newlineShortcut', 0, 2, NewLineType.Ctrl],\n    ['logWhat', 0, 2, 1],\n    ['logErrors', 0, 1, true],\n    ['showErrorsExtended', 0, 1, false],\n    ['reportCrashes', 0, 1, false],\n    ['enableCommands', 0, 1, true],\n    ['commandChar', 0, 0, '#', 1],\n    ['escapeChar', 0, 0, '\\\\', 1],\n    ['enableVerbatim', 0, 1, true],\n    ['verbatimChar', 0, 0, '`'],\n    ['soundPath', 0, 0, ''],\n    ['logPath', 0, 0, ''],\n    ['theme', 0, 0, ''],\n    ['gamepads', 0, 1, false],\n    ['buttons.connect', 0, 1, true],\n    ['buttons.characters', 0, 1, true],\n    ['buttons.preferences', 0, 1, true],\n    ['buttons.log', 0, 1, true],\n    ['buttons.clear', 0, 1, true],\n    ['buttons.lock', 0, 1, true],\n    ['buttons.map', 0, 1, true],\n    ['buttons.user', 0, 1, true],\n    ['buttons.mail', 0, 1, false],\n    ['buttons.compose', 0, 1, false],\n    ['buttons.immortal', 0, 1, true],\n    ['buttons.codeEditor', 0, 1, false],\n    ['find.case', 0, 1, false],\n    ['find.word', 0, 1, false],\n    ['find.reverse', 0, 1, false],\n    ['find.regex', 0, 1, false],\n    ['find.selection', 0, 1, false],\n    ['find.show', 0, 1, false],\n    ['display.split', 0, 1, false],\n    ['display.splitHeight', 0, 2, -1],\n    ['display.splitLive', 0, 1, false],\n    ['display.roundedOverlays', 0, 1, true],\n    ['backupLoad', 0, 2, 30],\n    ['backupSave', 0, 2, 30],\n    ['backupAllProfiles', 0, 1, true],\n    ['scrollLocked', 0, 1, false],\n    ['showStatus', 0, 1, true],\n    ['showCharacterManager', 0, 1, false],\n    ['showChat', 0, 1, false],\n    ['showEditor', 0, 1, false],\n    ['showArmor', 0, 1, false],\n    ['showStatusWeather', 0, 1, true],\n    ['showStatusLimbs', 0, 1, true],\n    ['showStatusHealth', 0, 1, true],\n    ['showStatusExperience', 0, 1, true],\n    ['showStatusPartyHealth', 0, 1, true],\n    ['showStatusCombatHealth', 0, 1, true],\n    ['showButtonBar', 0, 1, true],\n    ['allowNegativeNumberNeeded', 0, 1, false],\n    ['spellchecking', 0, 1, true],\n    ['hideOnMinimize', 0, 1, false],\n    ['showTrayIcon', 0, 1, false],\n    ['statusExperienceNeededProgressbar', 0, 1, false],\n    ['trayClick', 0, 2, 0],\n    ['trayDblClick', 0, 2, 0],\n    ['pasteSpecialPrefix', 0, 0, ''],\n    ['pasteSpecialPostfix', 0, 0, ''],\n    ['pasteSpecialReplace', 0, 0, ''],\n    ['pasteSpecialPrefixEnabled', 0, 1, true],\n    ['pasteSpecialPostfixEnabled', 0, 1, true],\n    ['pasteSpecialReplaceEnabled', 0, 1, true],\n    ['display.showSplitButton', 0, 1, true],\n    ['chat.split', 0, 1, false],\n    ['chat.splitHeight', 0, 2, -1],\n    ['chat.splitLive', 0, 1, false],\n    ['chat.roundedOverlays', 0, 1, true],\n    ['chat.showSplitButton', 0, 1, true],\n    ['chat.bufferSize', 0, 2, 500],\n    ['chat.flashing', 0, 1, false],\n    ['display.hideTrailingEmptyLine', 0, 1, true],\n    ['display.enableColors', 0, 1, true],\n    ['display.enableBackgroundColors', 0, 1, true],\n    ['enableSound', 0, 1, true],\n    ['allowHalfOpen', 0, 1, true],\n    ['editorClearOnSend', 0, 1, true],\n    ['editorCloseOnSend', 0, 1, true],\n    ['askOnCloseAll', 0, 1, true],\n    ['askonloadCharacter', 0, 1, true],\n    ['mapper.roomWidth', 0, 2, 200],\n    ['mapper.roomGroups', 0, 2, 1 | 2 | 4],\n    ['mapper.showInTaskBar', 0, 1, false],\n    ['profiles.enabled', 0, 4, []],\n    ['profiles.sortOrder', 0, 2, ProfileSortOrder.Priority | ProfileSortOrder.Index],\n    ['profiles.sortDirection', 0, 2, 1],\n    ['profiles.showInTaskBar', 0, 1, false],\n    ['profiles.profileSelected', 0, 0, 'default'],\n    ['profiles.profileExpandSelected', 0, 1, true],\n    ['chat.lines', 0, 4, []],\n    ['chat.showInTaskBar', 0, 1, false],\n    ['chat.showTimestamp', 0, SettingType.Number, 0],\n    ['chat.timestampFormat', 0, 0, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['chat.tabWidth', 0, 2, 8],\n    ['chat.displayControlCodes', 0, 1, false],\n    ['chat.emulateTerminal', 0, 1, false],\n    ['chat.emulateControlCodes', 0, 1, true],\n    ['chat.wordWrap', 0, 1, false],\n    ['chat.wrapAt', 0, 2, 0],\n    ['chat.indent', 0, 2, 4],\n    ['chat.scrollLocked', 0, 1, false],\n    ['chat.find.case', 0, 1, false],\n    ['chat.find.word', 0, 1, false],\n    ['chat.find.reverse', 0, 1, false],\n    ['chat.find.regex', 0, 1, false],\n    ['chat.find.selection', 0, 1, false],\n    ['chat.find.show', 0, 1, false],\n    ['chat.find.highlight', 0, 1, false],\n    ['chat.find.location', 0, 4, [5, 20]],\n    ['codeEditor.showInTaskBar', 0, 1, false],\n    ['codeEditor.persistent', 0, 1, false],\n    ['codeEditor.alwaysOnTop', 0, 1, false],\n    ['codeEditor.alwaysOnTopClient', 0, 1, true],\n    ['autoTakeoverLogin', 0, 1, false],\n    ['fixHiddenWindows', 0, 1, true],\n    ['maxReconnectDelay', 0, 2, 3600],\n    ['enableBackgroundThrottling', 0, 1, true],\n    ['enableBackgroundThrottlingClients', 0, 1, false],\n    ['showInTaskBar', 0, 1, true],\n    ['showLagInTitle', 0, 1, false],\n    ['mspMaxRetriesOnError', 0, 2, 0],\n    ['logTimestamp', 0, SettingType.Number, 0],\n    ['logTimestampFormat', 0, 0, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['disableTriggerOnError', 0, 1, true],\n    ['prependTriggeredLine', 0, 1, true],\n    ['enableParameters', 0, 1, true],\n    ['parametersChar', 0, 0, '%', 1],\n    ['enableNParameters', 0, 1, true],\n    ['nParametersChar', 0, 0, '$', 1],\n    ['enableParsing', 0, 1, true],\n    ['externalWho', 0, 1, true],\n    ['externalHelp', 0, 1, true],\n    ['watchForProfilesChanges', 0, 1, false],\n    ['onProfileChange', 0, 2, OnProfileChange.Nothing],\n    ['onProfileDeleted', 0, 2, OnProfileDeleted.Nothing],\n    ['enableDoubleParameterEscaping', 0, 1, false],\n    ['ignoreEvalUndefined', 0, 1, true],\n    ['enableInlineComments', 0, 1, true],\n    ['enableBlockComments', 0, 1, true],\n    ['inlineCommentString', 0, 0, '//'],\n    ['blockCommentString', 0, 0, '/*'],\n    ['allowCommentsFromCommand', 0, 1, false],\n    ['saveTriggerStateChanges', 0, 1, true],\n    ['groupProfileSaves', 0, 1, false],\n    ['groupProfileSaveDelay', 0, 2, 20000],\n    ['returnNewlineOnEmptyValue', 0, 1, false],\n    ['pathDelay', 0, 2, 0],\n    ['pathDelayCount', 0, 2, 1],\n    ['echoSpeedpaths', 0, 1, false],\n    ['alwaysShowTabs', 0, 1, false],\n    ['scriptEngineType', 0, SettingType.Number, ScriptEngineType.Simple],\n    ['initializeScriptEngineOnLoad', 0, SettingType.Boolean, false],\n    ['find.highlight', 0, SettingType.Boolean, false],\n    ['find.location', 0, SettingType.Custom, [5, 20]],\n    ['display.showInvalidMXPTags', 0, SettingType.Boolean, false],\n    ['display.showTimestamp', 0, SettingType.Number, 0],\n    ['display.timestampFormat', 0, SettingType.String, '[[]MM-DD HH:mm:ss.SSS[]] '],\n    ['display.displayControlCodes', 0, SettingType.Boolean, false],\n    ['display.emulateTerminal', 0, SettingType.Boolean, false],\n    ['display.emulateControlCodes', 0, SettingType.Boolean, true],\n    ['display.wordWrap', 0, SettingType.Boolean, false],\n    ['display.tabWidth', 0, SettingType.Number, 8],\n    ['display.wrapAt', 0, SettingType.Number, 0],\n    ['display.indent', 0, SettingType.Number, 4],\n    ['statusWidth', 0, SettingType.Number, -1],\n    ['showEditorInTaskBar', 0, SettingType.Boolean, true],\n    ['trayMenu', 0, SettingType.Number, 0],\n    ['lockLayout', 0, SettingType.Boolean, false],\n    ['loadLayout', 0, SettingType.String, ''],\n    ['useSingleInstance', 0, SettingType.Boolean, true],\n    ['onSecondInstance', 0, SettingType.Number, 0],\n    ['characterManagerDblClick', 0, SettingType.Number, 0],\n    ['enableTabCompletion', SettingType.Boolean, true],\n    ['ignoreCaseTabCompletion', 0, SettingType.Boolean, false],\n    ['tabCompletionBufferLimit', 0, SettingType.Number, 100],\n    ['enableNotifications', 0, SettingType.Boolean, true],\n    ['echo', 0, SettingType.Number, Echo.None],\n    ['commandAutoSize', 0, SettingType.Boolean, false],\n    ['commandWordWrap', 0, SettingType.Boolean, false],\n    ['commandScrollbars', 0, SettingType.Boolean, false],\n    ['tabCompletionList', 0, SettingType.String, ''],\n    ['tabCompletionLookupType', 0, SettingType.Number, TabCompletion.PrependBuffer],\n    ['tabCompletionReplaceCasing', 0, SettingType.Number, 0],\n    ['characterManagerAddButtonAction', 0, SettingType.Number, 0],\n    ['enableCrashReporting', 0, SettingType.Boolean, false],\n    ['characterManagerPanelWidth', 0, SettingType.Number, 0],\n    ['ignoreInputLeadingWhitespace', 0, SettingType.Boolean, false],\n    ['profiles.find.case', 0, 1, false],\n    ['profiles.find.word', 0, 1, false],\n    ['profiles.find.reverse', 0, 1, false],\n    ['profiles.find.regex', 0, 1, false],\n    ['profiles.find.selection', 0, 1, false],\n    ['profiles.find.show', 0, 1, false],\n    ['profiles.find.value', 0, 1, false],\n    ['skipMore', 0, 1, false],\n    ['skipMoreDelay', 0, SettingType.Number, 5000],\n    ['commandMinLines', 0, SettingType.Number, 1],\n    ['backupReplaceCharacters', 0, SettingType.Boolean, true],\n    ['simpleAlarms', 0, SettingType.Boolean, false],\n    ['simpleEditor', 0, SettingType.Boolean, false],\n    ['selectLastCommand', 0, SettingType.Boolean, true],\n    ['statusMode', 0, SettingType.Number, isMobile() ? 1 : 0],\n    ['logger.split', 0, SettingType.Number, 204],\n    ['showChatWindow', 0, SettingType.Number, 0],\n    ['chat.enableColors', 0, SettingType.Number, true],\n    ['chat.enableBackgroundColors', 0, SettingType.Number, true],\n    ['display.customSelection', 0, SettingType.Boolean, true],\n    ['chat.customSelection', 0, SettingType.Boolean, true],\n    ['pasteSpecialDisable', 0, SettingType.Boolean, true]\n];\n\nexport const SettingProperties = ['bufferSize', 'commandDelay', 'commandDelayCount', 'commandHistorySize', 'fontSize', 'cmdfontSize', 'commandEcho', 'flashing', 'autoConnect', 'enableAliases', 'enableTriggers', 'enableMacros', 'showScriptErrors', 'commandStacking', 'commandStackingChar', 'htmlLog', 'keepLastCommand', 'enableMCCP', 'enableUTF8', 'font', 'cmdfont', 'mapper.follow', 'mapper.enabled', 'mapper.split', 'mapper.fill', 'showMapper', 'fullScreen', 'enableMXP', 'enableMSP', 'parseCommands', 'lagMeter', 'enablePing', 'enableEcho', 'enableSpeedpaths', 'speedpathsChar', 'parseSpeedpaths', 'profile', 'parseSingleQuotes', 'parseDoubleQuotes', 'logEnabled', 'logPrepend', 'logOffline', 'logUniqueOnConnect', 'enableURLDetection', 'notifyMSPPlay', 'CommandonClick', 'allowEval', 'allowEscape', 'AutoCopySelectedToClipboard', 'enableDebug', 'editorPersistent', 'askonclose', 'dev', 'chat.captureLines', 'chat.captureAllLines', 'chat.captureReviews', 'chat.captureTells', 'chat.captureTalk', 'chat.gag', 'chat.CaptureOnlyOpen', 'checkForUpdates', 'autoCreateCharacter', 'askonchildren', 'mapper.legend', 'mapper.room', 'mapper.importType', 'mapper.vscroll', 'mapper.hscroll', 'mapper.scale', 'mapper.alwaysOnTop', 'mapper.alwaysOnTopClient', 'mapper.memory', 'mapper.memorySavePeriod', 'mapper.active.ID', 'mapper.active.x', 'mapper.active.y', 'mapper.active.z', 'mapper.active.area', 'mapper.active.zone', 'mapper.persistent', 'profiles.split', 'profiles.askoncancel', 'profiles.triggersAdvanced', 'profiles.aliasesAdvanced', 'profiles.buttonsAdvanced', 'profiles.macrosAdvanced', 'profiles.contextsAdvanced', 'profiles.codeEditor', 'profiles.watchFiles', 'chat.alwaysOnTop', 'chat.alwaysOnTopClient', 'chat.log', 'chat.persistent', 'chat.zoom', 'chat.font', 'chat.fontSize', 'title', 'logGagged', 'logTimeFormat', 'autoConnectDelay', 'autoLogin', 'onDisconnect', 'enableKeepAlive', 'keepAliveDelay', 'newlineShortcut', 'logWhat', 'logErrors', 'showErrorsExtended', 'reportCrashes', 'enableCommands', 'commandChar', 'escapeChar', 'enableVerbatim', 'verbatimChar', 'soundPath', 'logPath', 'theme', 'gamepads', 'buttons.connect', 'buttons.characters', 'buttons.preferences', 'buttons.log', 'buttons.clear', 'buttons.lock', 'buttons.map', 'buttons.user', 'buttons.mail', 'buttons.compose', 'buttons.immortal', 'buttons.codeEditor', 'find.case', 'find.word', 'find.reverse', 'find.regex', 'find.selection', 'find.show', 'display.split', 'display.splitHeight', 'display.splitLive', 'display.roundedOverlays', 'backupLoad', 'backupSave', 'backupAllProfiles', 'backupReplaceCharacters', 'scrollLocked', 'showStatus', 'showCharacterManager', 'showChat', 'showEditor', 'showArmor', 'showStatusWeather', 'showStatusLimbs', 'showStatusHealth', 'showStatusExperience', 'showStatusPartyHealth', 'showStatusCombatHealth', 'showButtonBar', 'allowNegativeNumberNeeded', 'spellchecking', 'hideOnMinimize', 'showTrayIcon', 'statusExperienceNeededProgressbar', 'trayClick', 'trayDblClick', 'pasteSpecialPrefix', 'pasteSpecialPostfix', 'pasteSpecialReplace', 'pasteSpecialPrefixEnabled', 'pasteSpecialPostfixEnabled', 'pasteSpecialReplaceEnabled', 'display.showSplitButton', 'chat.split', 'chat.splitHeight', 'chat.splitLive', 'chat.roundedOverlays', 'chat.showSplitButton', 'chat.bufferSize', 'chat.flashing', 'display.hideTrailingEmptyLine', 'display.enableColors', 'display.enableBackgroundColors', 'enableSound', 'allowHalfOpen', 'editorClearOnSend', 'editorCloseOnSend', 'askOnCloseAll', 'askonloadCharacter', 'mapper.roomWidth', 'mapper.roomGroups', 'mapper.showInTaskBar', 'profiles.enabled', 'profiles.sortOrder', 'profiles.sortDirection', 'profiles.showInTaskBar', 'profiles.profileSelected', 'profiles.profileExpandSelected', 'chat.lines', 'chat.showInTaskBar', 'chat.showTimestamp', 'chat.timestampFormat', 'chat.tabWidth', 'chat.displayControlCodes', 'chat.emulateTerminal', 'chat.emulateControlCodes', 'chat.wordWrap', 'chat.wrapAt', 'chat.indent', 'chat.scrollLocked', 'chat.find.case', 'chat.find.word', 'chat.find.reverse', 'chat.find.regex', 'chat.find.selection', 'chat.find.show', 'chat.find.highlight', 'chat.find.location', 'codeEditor.showInTaskBar', 'codeEditor.persistent', 'codeEditor.alwaysOnTop', 'codeEditor.alwaysOnTopClient', 'autoTakeoverLogin', 'fixHiddenWindows', 'maxReconnectDelay', 'enableBackgroundThrottling', 'enableBackgroundThrottlingClients', 'showInTaskBar', 'showLagInTitle', 'mspMaxRetriesOnError', 'logTimestamp', 'logTimestampFormat', 'disableTriggerOnError', 'prependTriggeredLine', 'enableParameters', 'parametersChar', 'enableNParameters', 'nParametersChar', 'enableParsing', 'externalWho', 'externalHelp', 'watchForProfilesChanges', 'onProfileChange', 'onProfileDeleted', 'enableDoubleParameterEscaping', 'ignoreEvalUndefined', 'enableInlineComments', 'enableBlockComments', 'inlineCommentString', 'blockCommentString', 'allowCommentsFromCommand', 'saveTriggerStateChanges', 'groupProfileSaves', 'groupProfileSaveDelay', 'returnNewlineOnEmptyValue', 'pathDelay', 'pathDelayCount', 'echoSpeedpaths', 'alwaysShowTabs', 'scriptEngineType', 'initializeScriptEngineOnLoad', 'find.highlight', 'find.location', 'display.showInvalidMXPTags', 'display.showTimestamp', 'display.timestampFormat', 'display.displayControlCodes', 'display.emulateTerminal', 'display.emulateControlCodes', 'display.wordWrap', 'display.tabWidth', 'display.wrapAt', 'display.indent', 'statusWidth', 'showEditorInTaskBar', 'trayMenu', 'lockLayout', 'loadLayout', 'useSingleInstance', 'statusWidth', 'characterManagerDblClick', 'warnAdvancedSettings', 'showAdvancedSettings', 'enableTabCompletion', 'tabCompletionBufferLimit', 'ignoreCaseTabCompletion', 'enableNotifications', 'commandAutoSize', 'commandWordWrap', 'commandScrollbars', 'tabCompletionList', 'tabCompletionLookupType', 'tabCompletionReplaceCasing', 'characterManagerAddButtonAction', 'enableCrashReporting', 'characterManagerPanelWidth', 'ignoreInputLeadingWhitespace', 'profiles.find.case', 'profiles.find.word', 'profiles.find.reverse', 'profiles.find.regex', 'profiles.find.selection', 'profiles.find.show', 'profiles.find.value', 'skipMore', 'skipMoreDelay', 'commandMinLines', 'simpleAlarms', 'simpleEditor', 'selectLastCommand', 'statusMode', 'logger.split', 'showChatWindow', 'chat.enableColors', 'chat.enableBackgroundColors', 'display.customSelection', 'chat.customSelection', 'pasteSpecialDisable'];\n\n/**\n * Class that contains all options, sets default values and allows loading and saving to json files\n *\n * @export\n * @class Settings\n */\nexport class Settings {\n    public colors: string[];\n    public enableTriggers: boolean;\n    public showErrorsExtended: boolean;\n    public logErrors: boolean;\n    public commandEcho: boolean;\n    public autoConnect: boolean;\n    public keepLastCommand: boolean;\n\n    constructor() {\n        /*\n        let subs;\n        let obj;\n        let k;\n        let kl;\n        */\n        for (let s = 0, sl = SettingList.length; s < sl; s++) {\n            if (SettingList[s][2] === SettingType.Custom) continue;\n            this[SettingList[s][0]] = Settings.getValue(SettingList[s][0]);\n            if (SettingList[s][1] && SettingList[s][1].length)\n                this[SettingList[s][1]] = Settings.getValue(SettingList[s][1]);\n            /*\n            subs = SettingList[s][0].split('.');\n            if ((kl = subs.length) > 1) {\n                obj = this[subs[0]] = {};\n                for (k = 1; k < kl - 1; k++) {\n                    obj[subs[k]] = {};\n                }\n                obj[subs[subs.length-1]] = Settings.getValue(SettingList[s][0]);\n            }\n            */\n        }\n        this.colors = Settings.getValue('colors');\n    }\n\n    public static settingError = false;\n\n    public static getValue(setting: string, defaultValue?: any) {\n        let tmp;\n        if (Settings.settingError) {\n            if (defaultValue === null || typeof defaultValue == 'undefined')\n                return Settings.defaultValue(setting);\n            return defaultValue;\n        }\n        try {\n            tmp = $.jStorage.get(setting);\n            if (typeof tmp == 'undefined' || tmp === null) {\n                if (defaultValue === null || typeof defaultValue == 'undefined')\n                    return Settings.defaultValue(setting);\n                return defaultValue;\n            }\n            switch (setting) {\n                case 'showChat':\n                case 'showStatus':\n                case 'showButtons':\n                case 'enableCommands':\n                case 'enableVerbatim':\n                case 'allowEscape':\n                case 'autoConnect':\n                case 'mapFollow':\n                case 'mapEnabled':\n                case 'flashing':\n                case 'commandEcho':\n                case 'enableAliases':\n                case 'enableTriggers':\n                case 'enableButtons':\n                case 'enableMacros':\n                case 'commandStacking':\n                case 'htmlLog':\n                case 'keepLastCommand':\n                case 'fullScreen':\n                case 'enableMXP':\n                case 'enableURLDetection':\n                case 'enableMCCP':\n                case 'enableUTF8':\n                case 'parseCommands':\n                case 'lagMeter':\n                case 'showScriptErrors':\n                case 'enablePing':\n                case 'enableEcho':\n                case 'enableSpeedpaths':\n                case 'parseSpeedpaths':\n                case 'mapper.enabled':\n                case 'MapperSplitArea':\n                case 'mapper.split':\n                case 'MapperFillWalls':\n                case 'mapper.fill':\n                case 'mapper.follow':\n                case 'MapperOpen':\n                case 'showMapper':\n                case 'parseSingleQuotes':\n                case 'parseDoubleQuotes':\n                case 'logEnabled':\n                case 'logOffline':\n                case 'logPrepend':\n                case 'logUniqueOnConnect':\n                case 'toolsPinned':\n                case 'notifyMSPPlay':\n                case 'CommandonClick':\n                case 'allowEval':\n                case 'disableTriggerOnError':\n                case 'prependTriggeredLine':\n                case 'chat.captureLines':\n                case 'chat.captureAllLines':\n                case 'chat.captureReviews':\n                case 'chat.captureTells':\n                case 'chat.captureTalk':\n                case 'chat.gag':\n                case 'chat.CaptureOnlyOpen':\n                case 'simpleAlarms':\n                case 'simpleEditor':\n                case 'selectLastCommand':\n                case 'showLagInTitle':\n                case 'display.split':\n                case 'chat.split':\n                case 'display.customSelection':\n                case 'chat.customSelection':\n                    if (tmp == 1)\n                        return true;\n                    return false;\n                case 'colors':\n                case 'chat.lines':\n                    if (tmp === null || typeof tmp == 'undefined' || tmp.length === 0)\n                        return [];\n                    return JSON.parse(tmp);\n            }\n            return tmp;\n        }\n        catch (err) {\n            if (!Settings.settingError) {\n                alert('Unable to save to localStorage so reverting to default,\\n\\nError description: ' + err.message);\n                Settings.settingError = true;\n            }\n            if (defaultValue === null || typeof defaultValue == 'undefined')\n                return Settings.defaultValue(defaultValue);\n            return defaultValue;\n        }\n    }\n\n    public static setValue(setting: string, value) {\n        switch (setting) {\n            case 'colors':\n            case 'chat.lines':\n                if (value === null || typeof value == 'undefined' || value.length === 0)\n                    $.jStorage.deleteKey(setting);\n                else\n                    $.jStorage.set(setting, JSON.stringify(value));\n                break;\n            default:\n                if (typeof value == 'boolean') {\n                    if (value)\n                        $.jStorage.set(setting, 1);\n                    else\n                        $.jStorage.set(setting, 0);\n                }\n                else\n                    $.jStorage.set(setting, value);\n                break;\n        }\n    }\n\n    public static clearValue(setting: string) {\n        $.jStorage.deleteKey(setting);\n    }\n\n    public static defaultValue(setting) {\n        switch (setting) {\n            case 'bufferSize': return 500;\n            case 'commandDelay': return 500;\n            case 'commandDelayCount': return 5;\n            case 'commandHistorySize': return 20;\n            case 'fontSize': return '1em';\n            case 'cmdfontSize': return '1em';\n            case 'commandEcho': return true;\n            case 'flashing': return false;\n            case 'autoConnect': return true;\n            case 'enableAliases': return true;\n            case 'enableTriggers': return true;\n            case 'enableMacros': return true;\n            case 'showScriptErrors': return false;\n            case 'commandStacking': return true;\n            case 'commandStackingChar': return ';';\n            case 'htmlLog': return true;\n            case 'keepLastCommand': return true;\n            case 'enableMCCP': return true;\n            case 'enableUTF8': return true;\n            case 'font': return '\\'Courier New\\', Courier, monospace';\n            case 'cmdfont': return '\\'Courier New\\', Courier, monospace';\n            case 'mapFollow':\n            case 'mapper.follow': return true;\n            case 'mapEnabled':\n            case 'mapper.enabled': return true;\n            case 'MapperSplitArea':\n            case 'mapper.split': return false;\n            case 'MapperFillWalls':\n            case 'mapper.fill': return false;\n            case 'MapperOpen':\n            case 'showMapper': return false;\n            case 'fullScreen': return false;\n            case 'enableMXP': return true;\n            case 'enableMSP': return true;\n            case 'parseCommands': return true;\n            case 'lagMeter': return true;\n            case 'enablePing': return false;\n            case 'enableEcho': return true;\n            case 'enableSpeedpaths': return true;\n            case 'speedpathsChar': return '!';\n            case 'parseSpeedpaths': return true;\n            case 'profile': return 'Default';\n            case 'parseSingleQuotes': return false;\n            case 'parseDoubleQuotes': return true;\n            case 'logEnabled': return false;\n            case 'logPrepend': return false;\n            case 'logOffline': return false;\n            case 'logUniqueOnConnect': return true;\n            case 'enableURLDetection': return true;\n            case 'notifyMSPPlay': return false;\n            case 'CommandonClick': return true;\n            case 'allowEval': return true;\n            case 'allowEscape': return true;\n            case 'AutoCopySelectedToClipboard': return false;\n            case 'enableDebug': return false;\n            case 'editorPersistent': return false;\n            case 'askonclose': return true;\n            case 'dev': return false;\n            //New settings\n            case 'chat.captureLines': return false;\n            case 'chat.captureAllLines': return false;\n            case 'chat.captureReviews': return false;\n            case 'chat.captureTells': return false;\n            case 'chat.captureTalk': return false;\n            case 'chat.gag': return false;\n            case 'chat.CaptureOnlyOpen': return false;\n            case 'checkForUpdates': return false;\n            case 'autoCreateCharacter': return false;\n            case 'askonchildren': return true;\n            case 'mapper.legend': return false;\n            case 'mapper.room': return false;\n            case 'mapper.importType': return 1;\n            case 'mapper.vscroll': return 0;\n            case 'mapper.hscroll': return 0;\n            case 'mapper.scale': return 100;\n            case 'mapper.active': return {\n                ID: null,\n                x: 0,\n                y: 0,\n                z: 0,\n                area: null,\n                zone: 0\n            };\n            case 'mapper.active.ID': return null;\n            case 'mapper.active.x': return 0;\n            case 'mapper.active.y': return 0;\n            case 'mapper.active.z': return 0;\n            case 'mapper.active.area': return null;\n            case 'mapper.active.zone': return 0;\n            case 'profiles.split': return 204;\n            case 'logger.split': return 204;\n            case 'profiles.askoncancel': return true;\n            case 'profiles.triggersAdvanced': return false;\n            case 'profiles.aliasesAdvanced': return false;\n            case 'profiles.buttonsAdvanced': return false;\n            case 'profiles.macrosAdvanced': return false;\n            case 'profiles.contextsAdvanced': return false;\n            case 'profiles.codeEditor': return true;\n            case 'chat.log': return false;\n            case 'chat.zoom': return 1;\n            case 'chat.font': return '\\'Courier New\\', Courier, monospace';\n            case 'chat.fontSize': return '1em';\n            case 'title': return '$t';\n            case 'logGagged': return false;\n            case 'logTimeFormat': return 'YYYYMMDD-HHmmss';\n            case 'autoConnectDelay': return 600;\n            case 'autoLogin': return true;\n            case 'onDisconnect': return OnDisconnect.ReconnectDialog;\n            case 'enableKeepAlive': return false;\n            case 'keepAliveDelay': return 0;\n            case 'newlineShortcut': return NewLineType.Ctrl;\n            case 'logWhat': return 1;\n            case 'logErrors': return true;\n            case 'showErrorsExtended': return false;\n            case 'reportCrashes': return false;\n            case 'enableCommands': return true;\n            case 'commandChar': return '#';\n            case 'escapeChar': return '\\\\';\n            case 'enableVerbatim': return true;\n            case 'verbatimChar': return '`';\n            case 'soundPath': return '';\n            case 'logPath': return '';\n            case 'theme': return '';\n            case 'gamepads': return false;\n            case 'backupLoad': return 30;\n            case 'backupSave': return 30;\n            case 'backupAllProfiles': return true;\n            case 'backupReplaceCharacters': return true;\n            case 'scrollLocked': return false;\n            case 'showStatus': return true;\n            case 'showChat': return false;\n            case 'showEditor': return false;\n            case 'showArmor': return false;\n            case 'showStatusWeather': return true;\n            case 'showStatusLimbs': return true;\n            case 'showStatusHealth': return true;\n            case 'showStatusExperience': return true;\n            case 'showStatusPartyHealth': return true;\n            case 'showStatusCombatHealth': return true;\n            case 'allowNegativeNumberNeeded': return false;\n            case 'spellchecking': return true;\n            case 'statusExperienceNeededProgressbar': return false;\n            case 'pasteSpecialPrefix': return '';\n            case 'pasteSpecialPostfix': return '';\n            case 'pasteSpecialReplace': return '';\n            case 'pasteSpecialPrefixEnabled': return true;\n            case 'pasteSpecialPostfixEnabled': return true;\n            case 'pasteSpecialReplaceEnabled': return true;\n            case 'pasteSpecialDisable': return true;\n            case 'display.showSplitButton': return true;\n            case 'chat.showSplitButton': return true;\n            case 'chat.bufferSize': return 500;\n            case 'chat.flashing': return false;\n            case 'display.hideTrailingEmptyLine': return true;\n            case 'display.enableColors': return true;\n            case 'display.enableBackgroundColors': return true;\n            case 'enableSound': return true;\n            case 'editorClearOnSend': return true;\n            case 'editorCloseOnSend': return true;\n            case 'askOnCloseAll': return true;\n            case 'askonloadCharacter': return true;\n            case 'mapper.roomWidth': return 200;\n            case 'mapper.roomGroups': return 1 | 2 | 4;\n            case 'mapper.showInTaskBar': return false;\n            case 'profiles.enabled': return [];\n            case 'profiles.sortOrder': return ProfileSortOrder.Priority | ProfileSortOrder.Index;\n            case 'profiles.sortDirection': return 1;\n            case 'profiles.profileSelected': return 'default';\n            case 'profiles.profileExpandSelected': return true;\n            case 'chat.lines': return [];\n            case 'chat.showTimestamp': return 0;\n            case 'chat.timestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'chat.tabWidth': return 8;\n            case 'chat.displayControlCodes': return false;\n            case 'chat.emulateTerminal': return false;\n            case 'chat.emulateControlCodes': return true;\n            case 'chat.wordWrap': return false;\n            case 'chat.wrapAt': return 0;\n            case 'chat.indent': return 4;\n            case 'chat.enableColors': return true;\n            case 'chat.enableBackgroundColors': return true;\n            case 'autoTakeoverLogin': return false;\n            case 'maxReconnectDelay': return 3600;\n            case 'showLagInTitle': return false;\n            case 'mspMaxRetriesOnError': return 0;\n            case 'logTimestamp': return 0;\n            case 'logTimestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'disableTriggerOnError': return true;\n            case 'prependTriggeredLine': return true;\n            case 'enableParameters': return true;\n            case 'parametersChar': return '%';\n            case 'enableNParameters': return true;\n            case 'nParametersChar': return '$';\n            case 'enableParsing': return true;\n            case 'onProfileChange': return OnProfileChange.Nothing;\n            case 'onProfileDeleted': return OnProfileDeleted.Nothing;\n            case 'enableDoubleParameterEscaping': return false;\n            case 'ignoreEvalUndefined': return true;\n            case 'enableInlineComments': return true;\n            case 'enableBlockComments': return true;\n            case 'inlineCommentString': return '//';\n            case 'blockCommentString': return '/*';\n            case 'allowCommentsFromCommand': return false;\n            case 'saveTriggerStateChanges': return true;\n            case 'groupProfileSaves': return false;\n            case 'groupProfileSaveDelay': return 20000;\n            case 'returnNewlineOnEmptyValue': return false;\n            case 'pathDelay': return 0;\n            case 'pathDelayCount': return 1;\n            case 'echoSpeedpaths': return false;\n            case 'scriptEngineType': return ScriptEngineType.Simple;\n            case 'initializeScriptEngineOnLoad': return false;\n            case 'display.showInvalidMXPTags': return false;\n            case 'display.showTimestamp': return 0;\n            case 'display.timestampFormat': return '[[]MM-DD HH:mm:ss.SSS[]] ';\n            case 'display.displayControlCodes': return false;\n            case 'display.emulateTerminal': return false;\n            case 'display.emulateControlCodes': return true;\n            case 'display.wordWrap': return false;\n            case 'display.tabWidth': return 8;\n            case 'display.wrapAt': return 0;\n            case 'display.indent': return 4;\n            case 'statusWidth': return -1;\n            case 'extensions': return {};\n            case 'warnAdvancedSettings': return true;\n            case 'showAdvancedSettings': return false;\n            case 'enableTabCompletion': return true;\n            case 'ignoreCaseTabCompletion': return false;\n            case 'tabCompletionBufferLimit': return 100;\n            case 'enableNotifications': return true;\n            case 'echo': return Echo.None;\n            case 'commandAutoSize': return false;\n            case 'commandWordWrap': return false;\n            case 'commandMinLines': return 1;\n            case 'tabCompletionLookupType': return TabCompletion.PrependBuffer;\n            case 'tabCompletionList': return '';\n            case 'tabCompletionReplaceCasing': return 0;\n            case 'ignoreInputLeadingWhitespace': return false;\n            case 'skipMore': return false;\n            case 'skipMoreDelay': return 5000;\n            case 'simpleAlarms': return false;\n            case 'simpleEditor': return false;\n            case 'selectLastCommand': return true;\n            case 'statusMode': isMobile() ? 1 : 0;\n            case 'showChatWindow': return 0;\n            case 'display.split': return false;\n            case 'display.splitLive': return false;\n            case 'display.splitHeight': return -1;\n            case 'display.customSelection': return true;\n            case 'chat.split': return false;\n            case 'chat.splitLive': return false;\n            case 'chat.return': return -1;\n            case 'chat.customSelection': return true;\n        }\n        return null;\n    }\n\n    public static exist(setting) {\n        let tmp = $.jStorage.get(setting);\n        return typeof tmp !== 'undefined' && tmp !== null;\n    }\n\n    public save() {\n        for (let prop in this) {\n            if (!this.hasOwnProperty(prop)) continue;\n            Settings.setValue(prop, this[prop]);\n        }\n    }\n\n    public reset() {\n        for (let s = 0, sl = SettingList.length; s < sl; s++) {\n            if (SettingList[s][2] === SettingType.Custom) continue;\n            this[SettingList[s][0]] = Settings.defaultValue(SettingList[s][0]);\n        }\n        this.colors = [];\n    }\n}", "//spell-checker:ignore displaytype, submenu, triggernewline, triggerprompt\nimport { clone, keyCodeToChar, SortItemArrayByPriority, splitQuoted, isValidIdentifier, isObjectEqual } from './library';\ndeclare let localforage;\n\nexport enum MacroModifiers {\n    None = 0,\n    Alt = 2,\n    Ctrl = 4,\n    Shift = 8,\n    Meta = 16,\n    All = Alt | Ctrl | Shift | Meta\n}\n\nexport enum ItemDisplayType {\n    Text = 0,\n    Function = 1\n}\n\nexport enum ItemStyle {\n    Text = 0,\n    Parse = 1,\n    Script = 2\n}\n\nexport enum TriggerType {\n    Regular = 0,\n    CommandInputRegular = 1,\n    Event = 2,\n    Alarm = 3,\n    Pattern = 8,\n    CommandInputPattern = 16,\n    Expression = 1 << 6,\n    LoopExpression = 1 << 7\n}\n\nexport enum TriggerTypes {\n    None = 0,\n    CommandInputRegular = 1,\n    Event = 2,\n    Regular = 4,\n    Pattern = 8,\n    CommandInputPattern = 16,\n    Alarm = 32,\n    Expression = 1 << 6,\n    LoopExpression = 1 << 7\n}\n\nexport enum SubTriggerTypes {\n    Skip = 1 << 9,\n    Wait = 1 << 10,\n    LoopPattern = 1 << 12,\n    LoopLines = 1 << 13,\n    Duration = 1 << 14,\n    WithinLines = 1 << 15,\n    Manual = 1 << 16,\n    ReParse = 1 << 17,\n    ReParsePattern = 1 << 18\n}\n\nexport enum VariableType {\n    Auto = 1,\n    Integer = 2,\n    StringExpanded = 3,\n    StringLiteral = 4,\n    StringList = 5,\n    Record = 6,\n    Float = 7,\n    Array = 8\n}\n\nexport function MacroDisplay(item: Macro) {\n    const d = [];\n    if (item.gamepad > 0) {\n        d.push('Gamepad ' + item.gamepad);\n        if (item.key > 0)\n            d.push('Button ' + item.key);\n        else if (item.gamepadAxes < 0)\n            d.push('Axis ' + -item.gamepadAxes);\n        else if (item.gamepadAxes > 0)\n            d.push('Axis ' + item.gamepadAxes);\n        if (d.length === 1)\n            return 'None';\n        return d.join('+');\n    }\n    if (item.key === 0) {\n        if (item.name && item.name.length > 0)\n            return 'None - ' + item.name;\n        return 'None';\n    }\n    if ((item.modifiers & MacroModifiers.Ctrl) === MacroModifiers.Ctrl)\n        d.push('Ctrl');\n    if ((item.modifiers & MacroModifiers.Alt) === MacroModifiers.Alt)\n        d.push('Alt');\n    if ((item.modifiers & MacroModifiers.Shift) === MacroModifiers.Shift)\n        d.push('Shift');\n    if ((item.modifiers & MacroModifiers.Meta) === MacroModifiers.Meta)\n        d.push('Meta');\n    if (keyCodeToChar[item.key])\n        d.push(keyCodeToChar[item.key]);\n    else if (item.name && item.name.length > 0)\n        return 'None - ' + item.name;\n    else\n        return 'None';\n    if (item.name && item.name.length > 0)\n        return d.join('+') + ' - ' + item.name;\n    return d.join('+');\n}\n\nexport class Alarm {\n    public parent: Trigger;\n    public pattern: string;\n    public temp: boolean = false;\n    public start: boolean = false;\n    public seconds: number = -1;\n    public secondsWildcard: boolean = true;\n    public hours: number = -1;\n    public hoursWildcard: boolean = true;\n    public minutes: number = -1;\n    public minutesWildcard: boolean = true;\n    public startTime: number;\n    public suspended: number = 0;\n    public restart: number = 0;\n    public tempTime: number;\n    public prevTime: number;\n\n    constructor(data?, pattern?) {\n        if (typeof data === 'string') {\n            pattern = data;\n            data = 0;\n        }\n        this.parent = data;\n        this.pattern = pattern;\n        this.startTime = Date.now();\n        this.prevTime = this.startTime;\n    }\n\n    public static parse(parent, pattern?: string, readOnly?: boolean): Alarm {\n        if (typeof parent === 'string') {\n            pattern = parent;\n            parent = 0;\n        }\n        if (!pattern || pattern.length === 0) {\n            if (typeof parent === 'object')\n                pattern = parent.pattern;\n            else\n                throw new Error('Blank pattern');\n        }\n        const t = new Alarm(parent, pattern);\n        while (pattern[0] === '-' || pattern[0] === '+') {\n            if (pattern[0] === '-')\n                t.start = true;\n            else if (pattern[0] === '+')\n                t.temp = true;\n            pattern = pattern.substr(1);\n        }\n        if (pattern !== '*') {\n            const parts = pattern.split(':');\n            let tmp;\n            if (parts.length === 0)\n                throw new Error('Invalid format: ' + pattern);\n            if (parts.length === 1) {\n                if (parts[0] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0)\n                        throw new Error('Seconds must be greater than or equal to 0.');\n                    else if (tmp > 59)\n                        t.secondsWildcard = true;\n                    t.seconds = tmp;\n                }\n            }\n            else if (parts.length === 2) {\n                if (parts[0] === '*') {\n                    t.minutesWildcard = true;\n                    t.minutes = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.minutesWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.minutesWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Minutes can only be 0 to 59');\n                    t.minutes = tmp;\n                }\n                if (parts[1] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[1][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[1] = parts[1].substr(1);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[1], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[1]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Seconds can only be 0 to 59');\n                    t.seconds = tmp;\n                }\n            }\n            else {\n                if (parts[0] === '*') {\n                    t.hoursWildcard = true;\n                    t.hours = -1;\n                }\n                else {\n                    if (parts[0][0] === '*') {\n                        t.hoursWildcard = true;\n                        parts[0] = parts[0].substr(1);\n                    }\n                    else\n                        t.hoursWildcard = false;\n                    tmp = parseInt(parts[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[0]);\n                    if (tmp < 0 || tmp > 23)\n                        throw new Error('Hours can only be 0 to 23');\n                    t.hours = tmp;\n                }\n                if (parts[1] === '*') {\n                    t.minutesWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[1][0] === '*') {\n                        t.minutesWildcard = true;\n                        parts[1] = parts[1].substr(1);\n                    }\n                    else\n                        t.minutesWildcard = false;\n                    tmp = parseInt(parts[1], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[1]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Minutes can only be 0 to 59');\n                    t.minutes = tmp;\n                }\n                if (parts[2] === '*') {\n                    t.secondsWildcard = true;\n                    t.seconds = -1;\n                }\n                else {\n                    if (parts[2][0] === '*') {\n                        t.secondsWildcard = true;\n                        parts[2] = parts[2].substr(2);\n                    }\n                    else\n                        t.secondsWildcard = false;\n                    tmp = parseInt(parts[2], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid Format: ' + parts[2]);\n                    if (tmp < 0 || tmp > 59)\n                        throw new Error('Seconds can only be 0 to 59');\n                    t.seconds = tmp;\n                }\n            }\n        }\n        if (readOnly)\n            t.temp = false;\n        return t;\n    }\n\n    public setTempTime(value: number) {\n        if (!value)\n            this.tempTime = 0;\n        else\n            this.tempTime = Date.now() + value;\n    }\n}\n\nexport class Item {\n    public name: string = '';\n    public priority: number = 0;\n    public display: string = 'name';\n    public displaytype: ItemDisplayType = ItemDisplayType.Text;\n    public value: string = '';\n    public style: ItemStyle = ItemStyle.Parse;\n    public group: string = '';\n    public enabled: boolean = true;\n    public notes: string = '';\n    public profile: Profile;\n\n    constructor(data?, profile?) {\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Item(this);\n    }\n\n    public equals(item) {\n        if (!item) return false;\n        return isObjectEqual(this, item);\n    }\n}\n\nexport class Button extends Item {\n    public caption: string = '';\n    public icon: string = '';\n    public append: boolean = false;\n    public send: boolean = true;\n    public chain: boolean = false;\n    public stretch: boolean = false;\n    public parse: boolean = false;\n    public top: number = -1;\n    public left: number = -1;\n    public right: number = -1;\n    public bottom: number = -1;\n    public width: number = 64;\n    public height: number = 64;\n    public iconOnly: boolean = false;\n\n    constructor(data?, profile?) {\n        super(data);\n        this.caption = 'NewButton';\n        this.display = 'caption';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Button(this);\n    }\n}\n\nexport class Macro extends Item {\n    public key: number = 0;\n    public append: boolean = false;\n    public send: boolean = true;\n    public modifiers: MacroModifiers = MacroModifiers.None;\n    public chain: boolean = false;\n    public gamepad: number = 0;\n    public gamepadAxes: number = 0;\n\n    constructor(data?, profile?) {\n        super();\n        this.display = 'return MacroDisplay(item)';\n        this.displaytype = ItemDisplayType.Function;\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Macro(this);\n    }\n}\n\nexport class Alias extends Item {\n    public pattern: string = 'NewAlias';\n    public regexp: boolean = false;\n    public multi: boolean = false;\n    public append: boolean = true;\n    public params: string = '';\n\n    constructor(pattern?: any, value?: string, profile?) {\n        super();\n        if (typeof pattern === 'string')\n            this.pattern = pattern;\n        if (value != null)\n            this.value = value;\n        this.display = 'pattern';\n        if (typeof pattern === 'object') {\n            let prop;\n            for (prop in pattern) {\n                if (!pattern.hasOwnProperty(prop)) {\n                    continue;\n                }\n                this[prop] = pattern[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Alias(this);\n    }\n}\n\nexport class Trigger extends Item {\n    public pattern: string = 'NewTrigger';\n    public verbatim: boolean = false;\n    public triggerNewline: boolean = true;\n    public triggerPrompt: boolean = false;\n    public type: TriggerType | SubTriggerTypes = TriggerType.Regular;\n    public temp: boolean = false;\n    public caseSensitive: boolean = false;\n    public raw: boolean = false;\n    public state: number = 0;\n    public params: string = '';\n    public triggers: Trigger[] = [];\n    public fired: boolean = false;\n\n    constructor(data?, profile?) {\n        super(data);\n        this.display = 'pattern';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                if (prop === 'triggers') {\n                    this.triggers = [];\n                    const il = data.triggers.length;\n                    for (let i = 0; i < il; i++) {\n                        this.triggers.push(new Trigger(data.triggers[i]));\n                    }\n                }\n                else\n                    this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Trigger(this);\n    }\n\n    public getState(state) {\n        if (state === 0)\n            return this;\n        state--;\n        if (state >= this.triggers.length || state < 0) return null;\n        return this.triggers[state];\n    }\n}\n\nexport class Context extends Item {\n    public caption: string = '';\n    public icon: string = '';\n    public append: boolean = false;\n    public send: boolean = true;\n    public chain: boolean = false;\n    public parent: string = '';\n    public items: Context[] = [];\n    public parse: boolean = false;\n    constructor(data?, profile?) {\n        super(data);\n        this.caption = 'NewContext';\n        this.display = 'caption';\n        if (typeof data === 'object') {\n            let prop;\n            for (prop in data) {\n                if (!data.hasOwnProperty(prop)) {\n                    continue;\n                }\n                if (prop === 'items') {\n                    let i = 0;\n                    const il = data[prop].length;\n                    for (; i < il; i++)\n                        this.items.push(new Context(data[prop][i]));\n                }\n                else\n                    this[prop] = data[prop];\n            }\n        }\n        this.profile = profile;\n    }\n\n    public clone() {\n        return new Context(this);\n    }\n}\n\nexport class Variable extends Item {\n    private _type: string = 'string';\n\n    public type: VariableType = VariableType.Auto;\n    public defaultValue: string = '';\n    public useDefault: boolean = false;\n    public params: string = '';\n\n    public set setValue(value: any) {\n        switch (this.type) {\n            case VariableType.Integer:\n                if (typeof value === 'string') {\n                    value = parseInt(value, 10);\n                    if (isNaN(value))\n                        value = 0;\n                }\n                else if (typeof value === 'boolean')\n                    value = value ? 1 : 0;\n                break;\n            case VariableType.Float:\n                if (typeof value === 'string') {\n                    value = parseFloat(value);\n                    if (isNaN(value))\n                        value = 0.0;\n                }\n                else if (typeof value === 'boolean')\n                    value = value ? 1.0 : 0.0;\n                break;\n        }\n        this.value = value;\n        this._type = typeof value;\n    }\n    public get getValue(): any {\n        switch (this.type) {\n            case VariableType.Auto:\n                if (typeof this.value !== this._type) {\n                    switch (this._type) {\n                        case 'number':\n                            return Number(this.value);\n                        case 'string':\n                            return this.value.toString();\n                        case 'boolean':\n                            return Boolean(this.value);\n                    }\n                }\n                return this.value;\n            case VariableType.Float:\n                return parseFloat(this.value);\n            case VariableType.Integer:\n                return parseInt(this.value, 10);\n            case VariableType.Record:\n                if (typeof this.value === 'string')\n                    try {\n                        return JSON.parse(this.value);\n                    }\n                    catch {\n                        return this.value;\n                    }\n                return this.value;\n            case VariableType.StringList:\n                if (typeof this.value === 'string')\n                    return splitQuoted(this.value, '|');\n                return this.value;\n        }\n        return this.value;\n    }\n\n    constructor(data?, profile?) {\n        super(data);\n        this.profile = profile;\n        if (this.useDefault)\n            this.setValue(this.defaultValue);\n    }\n\n    public clone() {\n        return new Variable(this);\n    }\n\n    public toString() {\n        switch (this.type) {\n            case VariableType.Record:\n                if (typeof this.value === 'string')\n                    return this.value;\n                return JSON.stringify(this.value);\n            case VariableType.StringList:\n                if (typeof this.value === 'string')\n                    return this.value;\n                return '\"' + (<any[]>this.value).join('\"|\"') + '\"';\n        }\n        return this.value?.toString();\n    }\n}\n\nexport class Profile {\n    public name: string = '';\n    public file: string = '';\n    public priority: number = 0;\n    public enabled: boolean = true;\n    public aliases: Alias[] = [];\n    public triggers: Trigger[] = [];\n    public macros: Macro[] = [];\n    public buttons: Button[] = [];\n    public contexts: Context[] = [];\n    public enableMacros: boolean = true;\n    public enableTriggers: boolean = true;\n    public enableAliases: boolean = true;\n    public enableButtons: boolean = true;\n    public enableContexts: boolean = true;\n    public enableDefaultContext: boolean = true;\n\n    constructor(name?: (string | boolean), defaults?: boolean) {\n        if (typeof name === 'string') {\n            this.name = name;\n            this.file = name.toLowerCase();\n            if (defaults == null || defaults)\n                this.macros = Profile.DefaultMacros;\n        }\n        else if (typeof name === 'boolean') {\n            if (name)\n                this.macros = Profile.DefaultMacros;\n        }\n        else if (defaults == null || defaults)\n            this.macros = Profile.DefaultMacros;\n    }\n\n    static get Default(): Profile {\n        return new Profile('Default');\n    }\n\n    static get DefaultMacros(): Macro[] {\n        const data = [\n            {\n                key: 97,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'sw',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'SouthWest',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 98,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 's',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'South',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 99,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'se',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'SouthEast',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 100,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'w',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'West',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 101,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'l',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'Look',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 102,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'e',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'East',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 103,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'nw',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'NorthWest',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 104,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'n',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'North',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            },\n            {\n                key: 105,\n                display: 'return MacroDisplay(item)',\n                displaytype: ItemDisplayType.Function,\n                value: 'ne',\n                style: ItemStyle.Parse,\n                append: false,\n                send: true,\n                name: 'NorthEast',\n                group: '',\n                enabled: true,\n                modifiers: MacroModifiers.None,\n                chain: true,\n                priority: 0,\n                notes: ''\n            }\n        ];\n        const m: Macro[] = [];\n        const dl = data.length;\n        for (let d = 0; d < dl; d++)\n            m.push(new Macro(data[d]));\n        return m;\n    }\n\n    static get DefaultButtons(): Button[] {\n        const buttons: Button[] = [];\n        let b;\n        b = new Button();\n        b.right = 176;\n        b.top = 14;\n        b.caption = 'fa-solid fa-angle-double-up';\n        b.value = 'up';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up,rotate--45';\n        b.value = 'northwest';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up';\n        b.value = 'north';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 14;\n        b.caption = 'fa-solid fa-caret-up,rotate-45';\n        b.value = 'northeast';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 176;\n        b.top = 66;\n        b.caption = 'fa-solid fa-crosshairs';\n        b.value = 'kill ${selected}';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 66;\n        b.caption = 'fa-solid fa-caret-left';\n        b.value = 'west';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 66;\n        b.caption = 'fa-solid fa-magnifying-glass';\n        b.value = 'look ${selected}';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 66;\n        b.caption = 'fa-solid fa-caret-right';\n        b.value = 'east';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 176;\n        b.top = 118;\n        b.caption = 'fa-solid fa-angle-double-down';\n        b.value = 'down';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 124;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down,rotate-45';\n        b.value = 'southwest';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 72;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down';\n        b.value = 'south';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        b = new Button();\n        b.right = 20;\n        b.top = 118;\n        b.caption = 'fa-solid fa-caret-down,rotate--45';\n        b.value = 'southeast';\n        b.width = 48;\n        b.height = 48;\n        buttons.push(b);\n        return buttons;\n    }\n\n    public static load(file) {\n        let profile;\n        let data;\n        if (typeof file === 'object')\n            data = file;\n        else\n            return new Profile();\n        profile = new Profile(false);\n        let prop;\n        for (prop in data) {\n            if (!data.hasOwnProperty(prop)) {\n                continue;\n            }\n            if (prop === 'aliases' || prop === 'triggers' || prop === 'macros' || prop === 'buttons' || prop === 'contexts' || prop === 'variables')\n                continue;\n            profile[prop] = data[prop];\n        }\n\n        let i;\n        let il;\n        if (data.aliases && data.aliases.length > 0) {\n            il = data.aliases.length;\n            for (i = 0; i < il; i++) {\n                profile.aliases.push(new Alias(data.aliases[i], null, profile));\n            }\n        }\n        if (data.triggers && data.triggers.length > 0) {\n            il = data.triggers.length;\n            for (i = 0; i < il; i++) {\n                profile.triggers.push(new Trigger(data.triggers[i], profile));\n            }\n        }\n        if (data.macros && data.macros.length > 0) {\n            il = data.macros.length;\n            profile.macros = [];\n            for (i = 0; i < il; i++) {\n                profile.macros.push(new Macro(data.macros[i], profile));\n            }\n        }\n        if (data.buttons && data.buttons.length > 0) {\n            il = data.buttons.length;\n            for (i = 0; i < il; i++) {\n                profile.buttons.push(new Button(data.buttons[i], profile));\n            }\n        }\n        if (data.contexts && data.contexts.length > 0) {\n            il = data.contexts.length;\n            for (i = 0; i < il; i++) {\n                profile.contexts.push(new Context(data.contexts[i], profile));\n            }\n        }\n        profile.file = profile.name;\n        return profile;\n    }\n\n    public clone(version?: number) {\n        let data;\n        let i;\n        let il;\n        if (version === 2) {\n            data = {\n                name: this.name,\n                priority: this.priority,\n                enabled: this.enabled,\n                aliases: [],\n                triggers: [],\n                macros: [],\n                buttons: [],\n                contexts: [],\n                enableMacros: this.enableMacros,\n                enableTriggers: this.enableTriggers,\n                enableAliases: this.enableAliases,\n                enableButtons: this.enableButtons,\n                enableContexts: this.enableContexts,\n                enableDefaultContext: this.enableDefaultContext\n            };\n\n            if (this.aliases.length > 0) {\n                il = this.aliases.length;\n                for (i = 0; i < il; i++) {\n                    data.aliases.push({\n                        pattern: this.aliases[i].pattern,\n                        value: this.aliases[i].value,\n                        priority: this.aliases[i].priority,\n                        regexp: this.aliases[i].regexp,\n                        style: this.aliases[i].style,\n                        multi: this.aliases[i].multi,\n                        append: this.aliases[i].append,\n                        name: this.aliases[i].name,\n                        group: this.aliases[i].group,\n                        enabled: this.aliases[i].enabled,\n                        params: this.aliases[i].params,\n                        display: this.aliases[i].display,\n                        notes: this.aliases[i].notes || ''\n                    });\n                }\n            }\n            if (this.triggers.length > 0) {\n                il = this.triggers.length;\n                for (i = 0; i < il; i++) {\n                    const t = {\n                        pattern: this.triggers[i].pattern,\n                        value: this.triggers[i].value,\n                        priority: this.triggers[i].priority,\n                        verbatim: this.triggers[i].verbatim,\n                        style: this.triggers[i].style,\n                        name: this.triggers[i].name,\n                        group: this.triggers[i].group,\n                        enabled: this.triggers[i].enabled,\n                        display: this.triggers[i].display,\n                        triggernewline: this.triggers[i].triggerNewline,\n                        caseSensitive: this.triggers[i].caseSensitive,\n                        triggerprompt: this.triggers[i].triggerPrompt,\n                        raw: this.triggers[i].raw,\n                        type: this.triggers[i].type,\n                        notes: this.triggers[i].notes || '',\n                        state: this.triggers[i].state || 0,\n                        params: this.triggers[i].params || '',\n                        triggers: []\n                    }\n                    if (this.triggers[i].triggers && this.triggers[i].triggers.length) {\n                        const sl = this.triggers[i].triggers.length;\n                        for (let s = 0; s < sl; s++) {\n                            t.triggers.push({\n                                pattern: this.triggers[i].triggers[s].pattern,\n                                value: this.triggers[i].triggers[s].value,\n                                priority: this.triggers[i].triggers[s].priority,\n                                verbatim: this.triggers[i].triggers[s].verbatim,\n                                style: this.triggers[i].triggers[s].style,\n                                name: this.triggers[i].triggers[s].name,\n                                group: this.triggers[i].triggers[s].group,\n                                enabled: this.triggers[i].triggers[s].enabled,\n                                display: this.triggers[i].triggers[s].display,\n                                triggernewline: this.triggers[i].triggers[s].triggerNewline,\n                                caseSensitive: this.triggers[i].triggers[s].caseSensitive,\n                                triggerprompt: this.triggers[i].triggers[s].triggerPrompt,\n                                raw: this.triggers[i].triggers[s].raw,\n                                type: this.triggers[i].triggers[s].type,\n                                notes: this.triggers[i].triggers[s].notes || '',\n                                state: this.triggers[i].triggers[s].state || 0,\n                                params: this.triggers[i].triggers[s].params || '',\n                                triggers: []\n                            });\n                        }\n                    }\n                    data.triggers.push(t);\n                }\n            }\n            if (this.macros.length > 0) {\n                il = this.macros.length;\n                for (i = 0; i < il; i++) {\n                    data.macros.push({\n                        key: this.macros[i].key,\n                        value: this.macros[i].value,\n                        style: this.macros[i].style,\n                        append: this.macros[i].append,\n                        send: this.macros[i].send,\n                        name: this.macros[i].name,\n                        group: this.macros[i].group,\n                        enabled: this.macros[i].enabled,\n                        display: 'if(item.key === 0) return \"None\"; return keyCodeToChar[item.key]',\n                        displaytype: 1,\n                        modifiers: this.macros[i].modifiers,\n                        chain: this.macros[i].chain,\n                        notes: this.macros[i].notes || ''\n                    });\n                }\n            }\n            if (this.buttons.length > 0) {\n                il = this.buttons.length;\n                for (i = 0; i < il; i++) {\n                    data.buttons.push(clone(this.buttons[i], (key, value) => {\n                        if (key === 'profile') return undefined;\n                        return value;\n                    }));\n                }\n            }\n            if (this.contexts.length > 0) {\n                il = this.contexts.length;\n                for (i = 0; i < il; i++) {\n                    data.contexts.push(clone(this.contexts[i], (key, value) => {\n                        if (key === 'profile') return undefined;\n                        return value;\n                    }));\n                }\n            }\n            return data;\n        }\n        data = clone(this, (key, value) => {\n            if (key === 'profile') return undefined;\n            return value;\n        });\n        const profile = new Profile(false);\n        let prop;\n        for (prop in data) {\n            if (!data.hasOwnProperty(prop)) {\n                continue;\n            }\n            if (prop === 'aliases' || prop === 'triggers' || prop === 'macros' || prop === 'buttons' || prop === 'contexts' || prop === 'variables')\n                continue;\n            profile[prop] = data[prop];\n        }\n\n        if (data.aliases && data.aliases.length > 0) {\n            il = data.aliases.length;\n            for (i = 0; i < il; i++) {\n                profile.aliases.push(new Alias(data.aliases[i], null, profile));\n            }\n        }\n        if (data.triggers && data.triggers.length > 0) {\n            il = data.triggers.length;\n            for (i = 0; i < il; i++) {\n                profile.triggers.push(new Trigger(data.triggers[i], profile));\n            }\n        }\n        if (data.macros && data.macros.length > 0) {\n            il = data.macros.length;\n            profile.macros = [];\n            for (i = 0; i < il; i++) {\n                profile.macros.push(new Macro(data.macros[i], profile));\n            }\n        }\n        if (data.buttons && data.buttons.length > 0) {\n            il = data.buttons.length;\n            for (i = 0; i < il; i++) {\n                profile.buttons.push(new Button(data.buttons[i], profile));\n            }\n        }\n        if (data.contexts && data.contexts.length > 0) {\n            il = data.contexts.length;\n            for (i = 0; i < il; i++) {\n                profile.contexts.push(new Context(data.contexts[i], profile));\n            }\n        }\n        return profile;\n    }\n\n    public find(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return tmp[t];\n        }\n        return null;\n    }\n\n    public findAny(type, field, value?) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] === field[v])\n                        return tmp[t];\n                }\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return tmp[t];\n        }\n        return null;\n    }\n\n    public indexOfAny(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] === field[v])\n                        return this[type].indexOf(tmp[t]);\n                }\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return this[type].indexOf(tmp[t]);\n        }\n        return -1;\n    }\n\n    public indexOf(type, field, value) {\n        let tmp;\n        if (!type || type.length === 0 || !this[type] || this[type].length === 0)\n            return null;\n        tmp = SortItemArrayByPriority(this[type]);\n        const l = tmp.length;\n        if (typeof field === 'object') {\n            for (let t = 0; t < l; t++) {\n                for (const v in field) {\n                    if (!field.hasOwnProperty(v)) continue;\n                    if (tmp[t][v] !== field[v]) continue;\n                }\n                return this[type].indexOf(tmp[t]);\n            }\n            return -1;\n        }\n        for (let t = 0; t < l; t++) {\n            if (tmp[t][field] === value)\n                return this[type].indexOf(tmp[t]);\n        }\n        return -1;\n    }\n}\n\nexport class ProfileCollection {\n    public items = {};\n    public keys = [];\n\n    constructor(defaultProfile?: Profile) {\n        this.add(defaultProfile == null ? Profile.Default : defaultProfile);\n    }\n\n    public SortByPriority() {\n        this.keys.sort((a, b) => {\n            let ap = this.items[a].priority;\n            let bp = this.items[b].priority;\n            if (ap > bp)\n                return -1;\n            if (ap < bp)\n                return 1;\n            if (a === 'default')\n                return -1;\n            if (b === 'default')\n                return 1;\n            ap = this.items[a].name;\n            bp = this.items[b].name;\n            if (ap > bp)\n                return 1;\n            if (ap < bp)\n                return -1;\n            return 0;\n        });\n    }\n\n    public enabled(profile: (string | Profile)): boolean {\n        if (!profile || this.keys.length === 0) return false;\n        if (typeof profile === 'string') {\n            if (!this.items[profile.toLowerCase()])\n                return false;\n            return this.items[profile.toLowerCase()].enabled;\n        }\n        return this.items[profile.name.toLowerCase()] ? this.items[profile.name.toLowerCase()].enabled : false;\n    }\n\n    public contains(profile: (string | Profile)): boolean {\n        if (!profile || this.keys.length === 0) return false;\n        if (typeof profile === 'string')\n            return this.items[profile.toLowerCase()] ? true : false;\n        return this.items[profile.name.toLowerCase()] ? true : false;\n    }\n\n    public canDisable(profile: any) {\n        if (!profile || this.keys.length === 0) return false;\n        let idx: any;\n        if (typeof profile === 'number') {\n            if (profile < 0)\n                return false;\n            if (profile >= this.keys.length)\n                return false;\n            idx = this.keys[profile];\n        }\n        else if (typeof profile === 'object')\n            idx = profile.name.toLowerCase();\n        else if (typeof profile === 'string')\n            idx = profile.toLowerCase();\n        else\n            return false;\n\n        if (!this.items[idx]) return false;\n        const e = !this.items[idx].enabled;\n        if (!e) {\n            let c = false;\n            for (const key in this.items) {\n                if (key === idx) continue;\n                if (this.items[key].enabled) c = true;\n                break;\n            }\n            if (!c)\n                return false;\n        }\n        return true;\n    }\n\n    public toggle(profile: any) {\n        if (!profile || this.keys.length === 0) return false;\n        let idx: any;\n        if (typeof profile === 'number') {\n            if (profile < 0)\n                return false;\n            if (profile >= this.keys.length)\n                return false;\n            idx = this.keys[profile];\n        }\n        else if (typeof profile === 'object')\n            idx = profile.name.toLowerCase();\n        else if (typeof profile === 'string')\n            idx = profile.toLowerCase();\n        else\n            return false;\n\n        if (!this.items[idx]) return false;\n        const e = !this.items[idx].enabled;\n        if (!e) {\n            let c = false;\n            for (const key in this.items) {\n                if (key === idx) continue;\n                if (this.items[key].enabled) c = true;\n                break;\n            }\n            if (!c)\n                return false;\n        }\n        this.items[idx].enabled = e;\n        return true;\n    }\n\n    public update() {\n        this.keys = Object.keys(this.items);\n        this.SortByPriority();\n    }\n\n    public add(profile: Profile, noUpdate?: boolean) {\n        if (!profile)\n            return;\n        this.items[profile.name.toLowerCase()] = profile;\n        if (!noUpdate)\n            this.update();\n    }\n\n    public remove(profile: (string | Profile | number)) {\n        if (!profile || this.keys.length === 0) return;\n        if (typeof profile === 'string')\n            delete this.items[profile.toLowerCase()];\n        else if (typeof profile === 'number') {\n            if (profile < 0 || profile >= this.keys.length) return;\n            delete this.items[this.keys[profile]];\n        }\n        else\n            delete this.items[profile.name.toLowerCase()];\n        this.update();\n    }\n\n    public copy(profile: (string | Profile | number)): (Profile | Profile[]) {\n        if (!profile) return clone(this.items);\n        if (this.keys.length === 0)\n            return null;\n        if (typeof profile === 'string') {\n            if (!this.items[profile.toLowerCase()])\n                return null;\n            return this.items[profile.toLowerCase()].clone();\n        }\n        if (typeof profile === 'number') {\n            if (profile < 0 || profile >= this.keys.length) return null;\n            return this.items[this.keys[profile]].clone();\n        }\n        return profile.clone();\n    }\n\n    public clone(version?: number): ProfileCollection | any {\n        if (version === 2) {\n            const profiles = {};\n            for (const p in this.items)\n                profiles[this.items[p].name.toLowerCase()] = this.items[p].clone(2);\n            return profiles;\n        }\n        const pc = new ProfileCollection();\n        for (const p in this.items)\n            pc.items[this.items[p].name.toLowerCase()] = this.items[p].clone();\n        pc.update();\n        return pc;\n    }\n\n    static load(key?) {\n        return new Promise((resolve, reject) => {\n            let collection = new ProfileCollection();\n            localforage.getItem(key || 'OoMUDProfiles').then(value => {\n                if (typeof value === 'string')\n                    value = JSON.parse(value);\n                if (!value)\n                    collection.add(Profile.Default);\n                else {\n                    const keys = Object.keys(value);\n                    let k = 0;\n                    let kl = keys.length;\n                    for (; k < kl; k++) {\n                        collection.add(Profile.load(value[keys[k]]));\n                    }\n                }\n                resolve(collection);\n            }).catch(reject);\n        })\n    }\n\n    public save(key?) {\n        const data = JSON.parse(JSON.stringify(this.items, (key, value) => {\n            if (key === 'profile') return undefined;\n            return value;\n        }));\n        //backwards compatibility as old client used Default instead of default\n        if (!key || key === 'OoMUDProfiles') {\n            data['Default'] = data['default'];\n            delete data['default'];\n        }\n        return localforage.setItem(key || 'OoMUDProfiles', data);\n    }\n\n    get length(): number {\n        return this.keys.length;\n    }\n\n    public count(): number { return this.keys.length; }\n\n    get active(): Profile {\n        const keys = this.keys;\n        //no profiles, add default and return\n        if (keys.length === 0) {\n            this.add(Profile.Default);\n            return this.items['default'];\n        }\n        //one profile\n        if (keys.length === 1) {\n            //profile is enabled\n            if (this.items[keys[0]].enabled)\n                return this.items[keys[0]];\n            //profile is default enable and return\n            if (this.items[keys[0]].name === 'Default') {\n                this.items[keys[0]].enable = true;\n                return this.items['default'];\n            }\n            //no default add one and return\n            this.add(Profile.Default);\n            return this.items['default'];\n        }\n        //search for first enabled profile\n        for (const key in keys) {\n            if (this.items[keys[key]].enabled)\n                return this.items[keys[key]];\n        }\n        //none found, see if default exist, if so enable and return\n        if (this.items['default']) {\n            this.items['default'].enabled = true;\n            return this.items['default'];\n        }\n        //no enabled or default, create and return\n        this.add(Profile.Default);\n        return this.items['default'];\n    }\n\n    get aliases(): Alias[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableAliases)\n                return [];\n            return this.items[keys[0]].aliases;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableAliases || this.items[keys[k]].aliases.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].aliases);\n        }\n        return tmp;\n    }\n\n    get triggers(): Trigger[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableTriggers)\n                return [];\n            return this.items[keys[0]].triggers;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableTriggers || this.items[keys[k]].triggers.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].triggers);\n        }\n        return tmp;\n    }\n\n    get macros(): Macro[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableMacros)\n                return [];\n            return this.items[keys[0]].macros;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableMacros || this.items[keys[k]].macros.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].macros);\n        }\n        return tmp;\n    }\n\n    get buttons(): Button[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableButtons)\n                return [];\n            return this.items[keys[0]].buttons;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableButtons || this.items[keys[k]].buttons.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].buttons);\n        }\n        return tmp;\n    }\n\n    get contexts(): Context[] {\n        const keys = this.keys;\n        let tmp = [];\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return [];\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled || !this.items[keys[0]].enableContexts)\n                return [];\n            return this.items[keys[0]].contexts;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled || !this.items[keys[k]].enableContexts || this.items[keys[k]].contexts.length === 0)\n                continue;\n            tmp = tmp.concat(this.items[keys[k]].contexts);\n        }\n        return tmp;\n    }\n\n    get defaultContext(): boolean {\n        const keys = this.keys;\n        let k = 0;\n        const kl = keys.length;\n        if (kl === 0) return true;\n        if (kl === 1) {\n            if (!this.items[keys[0]].enabled)\n                return true;\n            return this.items[keys[0]].enableDefaultContext;\n        }\n        for (; k < kl; k++) {\n            if (!this.items[keys[k]].enabled)\n                continue;\n            if (!this.items[keys[k]].enableDefaultContext)\n                return false;\n        }\n        return true;\n    }\n}\n\n/*\n*            match any number (even none) of characters or white space\n   .*\n?            match a single character\n   .\n%d            match any number of digits (0-9)\n   \\d*\n%n            match a number that starts with a + or - sign\n   [+|-]?\\d*\n%w            match any number of alpha characters (a-z) (a word)\n   \\w\n%a            match any number of alphanumeric characters (a-z,0-9)\n   [a-zA-Z0-9]*\n%s            match any amount of white space (spaces, tabs)\n   \\s*\n%x            match any amount of non-white space\n   \\S*\n%y            match any amount of non-white space (same as %x but matches start and end of line)\n   \\S*\n%p            match any punctuation\n   \\p{P}\n%q            match any punctuation (same as %p but matches start and end of line)\n   \\p{P}\n%t            match a direction command\n   ignore for now as i dont know what it does             \n%e            match ESC character for ansi patterns\n   \\e\n[range]      match any amount of characters listed in range\n   as is in .net\n^            force pattern to match starting at the beginning of the line\n   as is in .net\n$            force pattern to match ending at the end of the line\n   as is in .net\n(pattern)      save the matched pattern in a parameter %1 though %99\n   as is in .net\n~            quote the next character to prevent it to be interpreted as a wild card, required to match special characters\n   replace with \\                 \n~~            match a quote character verbatim\n   replace with \\\\ (not needed as ~ by itself is replaced with a \\\n{val1|val2|val3|...} match any of the specified strings can not use other wildcard inside this\n   remove {}\n@variable match any of the specified strings or keys\n    parsed and replaced with the variable value\n{^string}      do not match the specified string\n   [^string] replace {} with []\n&nn      matches exactly nn characters (fixed width pattern)\n   {nn} remove & and wrap in {}\n&VarName      assigns the matched string to the given variable (see below for more info)\n   (?<VarName>pattern ) research more, prob is varname can contain patterns so have to parse out name and patterns\n   probably best to pre-parse and get name / pattern then parse pattern separately in a recursive call\n%/regex/% matches the given Regular Expression\n%%function() runs any function\nhttp://forums.zuggsoft.com/modules/mx_kb/kb.php?mode=doc&page=3&refpage=3&a=cmud_Pattern_Match\n           */\nexport function convertPattern(pattern: string, client?) {\n    if (!pattern || !pattern.length) return '';\n    enum convertPatternState {\n        None = 0,\n        Ampersand = 1,\n        Percent = 2,\n        StringMatch = 3,\n        SubPattern = 4,\n        AmpersandPercent = 5,\n        AmpersandPattern = 6,\n        AmpersandRange = 7,\n        PercentRegex = 8,\n        Escape = 9,\n        Variable = 10\n    }\n    let state: convertPatternState = convertPatternState.None;\n    let stringBuilder = [];\n    let idx = 0;\n    let tl = pattern.length;\n    let c;\n    let i;\n    let arg;\n    let pat;\n    let nest = 0;\n    for (idx = 0; idx < tl; idx++) {\n        c = pattern.charAt(idx);\n        i = pattern.charCodeAt(idx);\n        switch (state) {\n            case convertPatternState.Ampersand:\n                if (arg.length === 0 && (c === '*' || c === '?' || c === '^' || c === '$'))\n                    pat = c;\n                else if (arg.length === 0 && c === '%')\n                    state = convertPatternState.AmpersandPercent;\n                else if (pat.length === 0 && c === '(') {\n                    pat = c;\n                    state = convertPatternState.AmpersandPattern;\n                }\n                else if (pat.length === 0 && c === '[') {\n                    pat = c;\n                    state = convertPatternState.AmpersandRange;\n                }\n                else if (c === '{')\n                    continue;\n                //end block or no longer valid varname character\n                else if (c === '}' || !((i >= 48 && i <= 57) || (i >= 65 && i <= 90) || (i >= 97 && i <= 122) || i === 95 || i === 36)) {\n                    if (!isValidIdentifier(arg))\n                        throw new Error('Invalid variable name');\n                    if (!pat.length && /^\\d+$/.exec(arg))\n                        stringBuilder.push('{', arg, '}');\n                    else if (!pat.length)\n                        stringBuilder.push('(?<', arg, '>.*)');\n                    else\n                        stringBuilder.push('(?<', arg, '>', convertPattern(pat), ')');\n                    if (c !== '}')\n                        idx--;\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.AmpersandPercent:\n                pat += '%' + c;\n                state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.AmpersandPattern:\n                pat += c;\n                if (c === ')')\n                    state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.AmpersandRange:\n                pat += c;\n                if (c === ']')\n                    state = convertPatternState.Ampersand;\n                break;\n            case convertPatternState.Percent:\n                switch (c) {\n                    case 'd':\n                        stringBuilder.push('\\\\d+');\n                        state = convertPatternState.None;\n                        break;\n                    case 'n':\n                        stringBuilder.push('[+-]?\\\\d+');\n                        state = convertPatternState.None;\n                        break;\n                    case 'w':\n                        stringBuilder.push('\\\\w');\n                        state = convertPatternState.None;\n                        break;\n                    case 'a':\n                        stringBuilder.push('[a-zA-Z0-9]*');\n                        state = convertPatternState.None;\n                        break;\n                    case 's':\n                        stringBuilder.push('\\\\s*');\n                        state = convertPatternState.None;\n                        break;\n                    case 'x':\n                        stringBuilder.push('\\\\S*');\n                        state = convertPatternState.None;\n                        break;\n                    case 'y':\n                        stringBuilder.push('\\\\S*');\n                        state = convertPatternState.None;\n                        break;\n                    case 'p':\n                        stringBuilder.push(\"[\\\\.\\\\?\\\\!\\\\:\\\\;\\\\-\\\\\u2014\\\\(\\\\)\\\\[\\\\]\\\\'\\\\\\\"\\\\\\\\/\\\\,]{1}\");\n                        state = convertPatternState.None;\n                        break;\n                    case 'q':\n                        stringBuilder.push(\"[\\\\.\\\\?\\\\!\\\\:\\\\;\\\\-\\\\\u2014\\\\(\\\\)\\\\[\\\\]\\\\'\\\\\\\"\\\\\\\\/\\\\,]{1}\");\n                        state = convertPatternState.None;\n                        break;\n                    case 't': //jiMUD does not support direction commands\n                        state = convertPatternState.None;\n                        break;\n                    case 'e':\n                        stringBuilder.push('\\x1b');\n                        state = convertPatternState.None;\n                        break;\n                    case '/': // %/pattern/%\n                        state = convertPatternState.PercentRegex;\n                        arg = '';\n                        break;\n                }\n                break;\n            case convertPatternState.PercentRegex:\n                if (c === '%') {\n                    if (!arg.endsWith('/'))\n                        throw new Error('Invalid %/regex/% pattern');\n                    stringBuilder.push(arg.substr(0, arg.length - 1));\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.StringMatch:\n                if (c === '^' && arg.length === 0)\n                    pat = true;\n                else if (c === '}') {\n                    if (pat)\n                        stringBuilder.push('[^', arg, ']');\n                    else\n                        stringBuilder.push(arg);\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.SubPattern:\n                if (c === ':') {\n                    stringBuilder.push('(?<', arg, '>');\n                    state = convertPatternState.None;\n                }\n                else if (c === ')') {\n                    stringBuilder.push('(', convertPattern(arg), ')');\n                    state = convertPatternState.None;\n                    nest--;\n                }\n                else\n                    arg += c;\n                break;\n            case convertPatternState.Escape:\n                stringBuilder.push('\\\\', c);\n                state = convertPatternState.None;\n                break;\n            case convertPatternState.Variable:\n                if (c === '{' && arg.length === 0)\n                    continue;\n                else if (c === '}' || !((i >= 48 && i <= 57) || (i >= 65 && i <= 90) || (i >= 97 && i <= 122) || i === 95 || i === 36)) {\n                    if (!isValidIdentifier(arg))\n                        throw new Error('Invalid variable name')\n                    if (client) {\n                        if (client.variables[arg] instanceof Variable)\n                            stringBuilder.push(client.variables[arg].value || '');\n                        else\n                            stringBuilder.push(client.variables[arg] || '');\n                    }\n                    if (c !== '}')\n                        idx--;\n                    state = convertPatternState.None;\n                }\n                else\n                    arg += c;\n                break;\n            default:\n                if (c === '*')\n                    stringBuilder.push('.*');\n                else if (c === '?')\n                    stringBuilder.push('.');\n                else if (c === '~')\n                    state = convertPatternState.Escape;\n                else if (c === '@') {\n                    state = convertPatternState.Variable;\n                    arg = '';\n                }\n                else if (c === '&') {\n                    arg = '';\n                    pat = '';\n                    state = convertPatternState.Ampersand;\n                }\n                else if (c === '%')\n                    state = convertPatternState.Percent;\n                else if (c === '{') {\n                    state = convertPatternState.StringMatch;\n                    arg = '';\n                }\n                else if (c === '(') {\n                    state = convertPatternState.SubPattern;\n                    arg = '';\n                    nest++;\n                }\n                else {\n                    if (c === ')')\n                        nest--;\n                    stringBuilder.push(c);\n                }\n                break;\n        }\n    }\n    switch (state) {\n        case convertPatternState.Ampersand:\n            if (!isValidIdentifier(arg))\n                throw new Error('Invalid variable name');\n            if (!pat.length && /^\\d+$/.exec(arg))\n                stringBuilder.push('{', arg, '}');\n            else if (!pat.length)\n                stringBuilder.push('(?<', arg, '>.*)');\n            else\n                stringBuilder.push('(?<', arg, '>', convertPattern(pat), ')');\n            break;\n        case convertPatternState.AmpersandPercent:\n        case convertPatternState.AmpersandPattern:\n        case convertPatternState.AmpersandRange:\n            throw new Error('Invalid &VarName pattern');\n        case convertPatternState.Percent:\n            throw new Error('Invalid % pattern');\n        case convertPatternState.PercentRegex:\n            throw new Error('Invalid %/regex/% pattern');\n        case convertPatternState.StringMatch:\n            throw new Error('Invalid string match pattern');\n        case convertPatternState.SubPattern:\n            throw new Error('Invalid (sub:pattern) pattern');\n        case convertPatternState.Escape:\n            throw new Error('Invalid escape pattern');\n        case convertPatternState.Variable:\n            if (!isValidIdentifier(arg))\n                throw new Error('Invalid variable name');\n            if (client) {\n                if (client.variables[arg] instanceof Variable)\n                    stringBuilder.push(client.variables[arg].getValue() || '');\n                else\n                    stringBuilder.push(client.variables[arg] || '');\n            }\n            break;\n    }\n    if (nest)\n        throw new Error('Invalid save matched pattern');\n    return stringBuilder.join('');\n}", "import { EventEmitter } from './events';\nimport { MacroModifiers, MacroDisplay, Alias, Trigger, Button, Profile, TriggerType, TriggerTypes, SubTriggerTypes, convertPattern } from './profile';\nimport { getTimeSpan, FilterArrayByKeyValue, SortItemArrayByPriority, clone, StringToUint8Array, splitQuoted, isValidIdentifier, getCursor, insertValue, openFileDialog, readFile } from './library';\nimport { Client } from './client';\nimport { NewLineType, TabCompletion, FunctionEvent } from './types';\nimport { SettingList } from './settings';\nimport { getAnsiColorCode, getColorCode, isMXPColor, getAnsiCode } from './ansi';\n\n\n/**\n * MATHJS expression engine\n * @constant\n * @type {object}\n */\nlet mathjs;\nlet _mathjs;\ndeclare let math;\n\n/**\n * Moment time format and manipulation (Optional, falls back to default date object formats)\n * @type {object}\n * @constant\n */\ndeclare let moment;\n\nconst WindowVariables = ['$selectedword', '$selword', '$selectedurl', '$selurl', '$selectedline', '$selline', '$selected', '$character', '$copied', '$action', '$trigger', '$caption', '$characterid'];\n\n/**\n * Return the proper case of a string for each word\n * @param {string} str - The string to proper capitalize each word of\n * @returns {string}\n */\nfunction ProperCase(str) {\n    return str.replace(/\\w*\\S*/g, (txt) => { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\n}\n\n/**\n * Return a fudge dice random value\n * @returns {number} Returns -1, 1 or 0 randomly\n */\nfunction fudgeDice() {\n    switch (~~(Math.random() * 6) + 1) {\n        case 1:\n        case 4:\n            return -1;\n        case 3:\n        case 2:\n            return 1;\n    }\n    return 0;\n}\n\n/**\n * Enum for input parse state\n * @readonly\n * @enum {number}\n */\nenum ParseState {\n    none = 0,\n    doubleQuoted = 1,\n    singleQuoted = 2,\n    aliasArguments = 3,\n    aliasArgumentsDouble = 4,\n    aliasArgumentsSingle = 5,\n    path = 6,\n    function = 7,\n    paramsP = 8,\n    paramsPBlock = 9,\n    paramsPEscape = 10,\n    paramsPNamed = 26,\n    paramsN = 11,\n    paramsNBlock = 12,\n    paramsNEscape = 13,\n    paramsNNamed = 14,\n    escape = 15,\n    verbatim = 16,\n    aliasArgumentsEscape = 17,\n    pathEscape = 18,\n    functionEscape = 19,\n    comment = 20,\n    inlineCommentStart = 21,\n    inlineComment = 22,\n    blockCommentStart = 23,\n    blockComment = 24,\n    blockCommentEnd = 25,\n    doubleQuotedEscape = 27,\n    singleQuotedEscape = 28\n}\n\n/**\n * Type of trigger ot test for\n */\nenum TriggerTypeFilter {\n    Main = 1,\n    Sub = 2,\n    All = 3\n}\n\nclass ArgumentInvalidError extends Error {\n    constructor(name: string) {\n        super(`Invalid arguments \\'${name}\\'`);\n    }\n}\n\nclass ArgumentInvalidNumberError extends Error {\n    constructor(value: string, name: string) {\n        super(`Invalid argument \\'${value.toString()}\\' must be a number for ${name}`);\n    }\n}\n\nclass ArgumentMissingError extends Error {\n    constructor(name: string) {\n        super(`Missing arguments for ${name}`);\n    }\n}\n\n\nclass ArgumentTooManyError extends Error {\n    constructor(name: string) {\n        super(`Too many arguments for ${name}`);\n    }\n}\n\nclass InvalidForeColorError extends Error {\n    constructor() {\n        super('Invalid fore color');\n    }\n}\n\nclass InvalidBackColorError extends Error {\n    constructor() {\n        super('Invalid back color');\n    }\n}\n\nclass InvalidTrigger extends Error {\n    constructor(msg) {\n        super(`Invalid trigger ${msg}`)\n    }\n}\n\nclass InvalidTemporaryTrigger extends Error {\n    constructor(msg) {\n        super(`Invalid temporary trigger ${msg}`)\n    }\n}\n\nclass ProfileNotFound extends Error {\n    constructor(profile) {\n        super(`Profile not found: ${profile}`)\n    }\n}\n\nclass TriggerNotFound extends Error {\n    constructor(trigger?, profile?) {\n        super(`Trigger not found${trigger ? `: ${trigger}` : ''}${profile ? ` in profile: ${profile}` : ''}`)\n    }\n}\n\n/**\n * Command input parser\n * \n * @class Input\n * @extends {EventEmitter}\n * @param {Object} client - the mud client object\n */\nexport class Input extends EventEmitter {\n    private _historyIdx: number = -1;\n    private _tabIdx: number = -1;\n    private _tabWords: string[] = null;;\n    private _tabSearch: any;\n    private _commandHistory: string[];\n    private _locked: number = 0;\n    private _TriggerCache: Trigger[] = null;\n    private _TriggerStates = {};\n    private _TriggerFunctionCache = {};\n    private _TriggerRegExCache = {};\n    private _LastTriggered = '';\n    private _LastTrigger = null;\n    private _scrollLock: boolean = false;\n    private _gag: number = 0;\n    private _gagID: any[] = [];\n    private _gags: any[] = [];\n    private _stack = [];\n    private _vStack = [];\n    private _controllers = {};\n    private _controllersCount = 0;\n    private _gamepadCaches = null;\n    private _lastSuspend = -1;\n    private _MacroCache = {};\n    private _loops: number[] = [];\n    private _pathQueue = [];\n    private _pathTimeout: any = null;\n    private _pathPaused: boolean = false;\n\n    public client: Client = null;\n    public enableParsing: boolean = true;\n    public enableTriggers: boolean = true;\n\n    public getScope() {\n        let scope: any = {};\n        Object.assign(scope, this.client.variables);\n        WindowVariables.forEach((a) => {\n            scope[a] = window[a];\n            scope[a.substr(1)] = window[a];\n        });\n        //if no stack use direct for some performance\n        if (this._stack.length === 0)\n            return scope;\n        if (!this.stack.named && !this.loops.length)\n            return scope;\n        if (this.stack.named)\n            Object.assign(scope, this.stack.named);\n        if (this.loops.length) {\n            scope.repeatnum = this.repeatnum;\n            const ll = this.loops.length;\n            //i to z only\n            for (let l = 0; l < ll && l < 18; l++)\n                scope[String.fromCharCode(105 + l)] = this.loops[l];\n        }\n        //scope.i = this.repeatnum;\n        //scope.repeatnum = this.repeatnum;\n        return scope;\n    }\n\n    public setScope(scope) {\n        //if same object no need to update\n        if (scope === this.client.variables) return;\n        const ll = this.loops.length;\n        for (const name in scope) {\n            //not a property, i or repeatnum\n            if (!Object.prototype.hasOwnProperty.call(scope, name) || name === 'i' || name === 'repeatnum')\n                continue;\n            if (WindowVariables.indexOf(name) !== -1 || WindowVariables.indexOf('$' + name) !== -1)\n                continue;\n            switch (name) {\n                case 'clientid':\n                    continue;\n            }\n            //if i to z and the loop exist skip it\n            if (name.length === 1 && ll && name.charCodeAt(0) >= 105 && name.charCodeAt(0) < 105 + ll)\n                continue;\n            //part of the named arguments so skip\n            if (this.stack.named && Object.prototype.hasOwnProperty.call(this.stack.named, name))\n                continue;\n            //update/add new variables\n            this.client.variables[name] = scope[name];\n        }\n    }\n\n    public evaluate(expression) {\n        let scope = this.getScope();\n        let results = mathjs().evaluate(expression, scope);\n        this.setScope(scope);\n        return results;\n    }\n\n    get stack() {\n        if (this._stack.length === 0)\n            this._stack.push({ args: 0, named: 0, used: 0, append: false });\n        return this._stack[this._stack.length - 1];\n    }\n\n    get repeatnum() {\n        if (this.loops.length === 0)\n            return 0;\n        return this.loops[this.loops.length - 1];\n    }\n\n    get loops() {\n        if (this._stack.length === 0 || !this.stack.hasOwnProperty('loops'))\n            return this._loops;\n        return this.stack.loops;\n    }\n\n    get regex() {\n        let sl = this._stack.length;\n        if (sl === 0)\n            return null;\n        while (sl >= 0) {\n            sl--;\n            if (this._stack[sl].hasOwnProperty('regex'))\n                return this._stack[sl].regex;\n        }\n        return null;\n    }\n\n    get indices() {\n        let sl = this._stack.length;\n        if (sl === 0)\n            return [];\n        while (sl >= 0) {\n            sl--;\n            if (this._stack[sl].hasOwnProperty('indices'))\n                return this._stack[sl].indices;\n        }\n        return [];\n    }\n\n    get vStack() {\n        if (this._vStack.length === 0)\n            return {};\n        return this._vStack[this._vStack.length - 1];\n    }\n\n    public vStackPush(obj) {\n        this._vStack.push(obj);\n    }\n\n    public vStackPop() {\n        this._vStack.pop();\n    }\n\n    get scrollLock(): boolean {\n        return this._scrollLock;\n    }\n    set scrollLock(locked: boolean) {\n        if (locked !== this._scrollLock) {\n            this._scrollLock = locked;\n            this.emit('scroll-lock', this.scrollLock);\n        }\n    }\n\n    get lastTriggerExecuted() {\n        return this._LastTrigger;\n    }\n\n    get lastTriggered() {\n        return this._LastTriggered;\n    }\n\n    set lastTriggered(value) {\n        this._LastTriggered = value;\n    }\n\n    private _getDiceArguments(arg, scope, fun) {\n        let res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\n        if (!res || res.length < 3) {\n            res = /(\\d+)\\s*?d\\s*?\\/\\s*?(100)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\n            if (!res || res.length < 3) {\n                //if failed with raw args try compiling and processing in case a variable or expression to build a string\n                arg = arg.compile().evaluate(scope);\n                res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\n                if (!res || res.length < 3) {\n                    //check for % dice\n                    res = /(\\d+)\\s*?d\\s*?\\/\\s*?(100)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(arg.toString());\n                    if (!res || res.length < 3)\n                        throw new Error('Invalid dice for ' + (fun || 'dice'));\n                    res[2] = '%';\n                }\n            }\n            else\n                res[2] = '%';\n        }\n        return res;\n    }\n\n    private _initMathJS() {\n        _mathjs = math;\n        const functions = {\n            esc: '\\x1b',\n            cr: '\\n',\n            lf: '\\r',\n            crlf: '\\r\\n',\n            diceavg: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                let min;\n                let max;\n                if (args.length === 0) throw new ArgumentInvalidError('diceavg');\n                if (args.length === 1) {\n                    res = this._getDiceArguments(args[0], scope, 'diceavg');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentTooManyError('diceavg');\n                min = 1;\n                if (sides === 'F' || sides === 'f') {\n                    min = -1;\n                    max = 1;\n                }\n                else if (sides === '%') {\n                    max = 1;\n                    min = 0;\n                }\n                else\n                    max = parseInt(sides);\n\n                if (mod)\n                    return math.evaluate(((min + max) / 2 * c) + mod, scope);\n                return (min + max) / 2 * c;\n            },\n            dicemin: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                let min;\n                if (args.length === 0) throw new ArgumentInvalidError('dicemin');\n                if (args.length === 1) {\n                    res = res = this._getDiceArguments(args[0], scope, 'dicemin');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentTooManyError('dicemin');\n                min = 1;\n                if (sides === 'F' || sides === 'f')\n                    min = -1;\n                else if (sides === '%')\n                    min = 0;\n                if (mod)\n                    return math.evaluate((min * c) + mod, scope);\n                return min * c;\n            },\n            dicemax: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                let max;\n                if (args.length === 0) throw new ArgumentInvalidError('dicemax');\n                if (args.length === 1) {\n                    res = this._getDiceArguments(args[0], scope, 'dicemax');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentTooManyError('dicemax');\n                if (sides === 'F' || sides === 'f')\n                    max = 1;\n                else if (sides === '%')\n                    max = 1;\n                else\n                    max = parseInt(sides);\n\n                if (mod)\n                    return math.evaluate((max * c) + mod, scope);\n                return max * c;\n            },\n            dicedev: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                let max;\n                if (args.length === 0) throw new ArgumentInvalidError('dicedev');\n                if (args.length === 1) {\n                    res = this._getDiceArguments(args[0], scope, 'dicedev');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentTooManyError('dicedev');\n                if (sides === 'F' || sides === 'f')\n                    max = 6;\n                else if (sides === '%')\n                    max = 1;\n                else\n                    max = parseInt(sides);\n                if (mod)\n                    return math.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod, scope);\n                return Math.sqrt(((max * max) - 1) / 12 * c);\n            },\n            zdicedev: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                let max;\n                if (args.length === 0) throw new ArgumentInvalidError('zdicedev');\n                if (args.length === 1) {\n                    res = this._getDiceArguments(args[0], scope, 'zdicedev');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentTooManyError('zdicedev');\n                if (sides === 'F' || sides === 'f')\n                    max = 6;\n                else if (sides === '%')\n                    max = 1;\n                else\n                    max = parseInt(sides);\n                max--;\n                if (mod)\n                    return math.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod, scope);\n                return Math.sqrt(((max * max) - 1) / 12 * c);\n            },\n            dice: (args, math, scope) => {\n                let res;\n                let c;\n                let sides;\n                let mod;\n                if (args.length === 1) {\n                    res = this._getDiceArguments(args[0], scope, 'dice');\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length > 1) {\n                    c = args[0].compile().evaluate(scope);\n                    sides = args[1].toString().trim();\n                    if (sides !== 'F' && sides !== '%')\n                        sides = args[1].compile().evaluate(scope);\n                    if (args.length > 2)\n                        mod = args[2].compile().evaluate(scope);\n                }\n                else\n                    throw new ArgumentInvalidError('dice');\n                let sum = 0;\n                for (let i = 0; i < c; i++) {\n                    if (sides === 'F' || sides === 'f')\n                        sum += fudgeDice();\n                    else if (sides === '%')\n                        sum += ~~(Math.random() * 100.0) + 1.0;\n                    else\n                        sum += ~~(Math.random() * sides) + 1;\n                }\n                if (sides === '%')\n                    sum /= 100.0;\n                if (mod)\n                    return math.evaluate(sum + mod, scope);\n                return sum;\n            },\n            isdefined: (args, math, scope) => {\n                if (args.length === 1) {\n                    args[0] = this.stripQuotes(args[0].toString());\n                    if (this.client.variables.hasOwnProperty(args[0]))\n                        return 1;\n                    if (scope.has(args[0]))\n                        return 1;\n                    return 0;\n                }\n                throw new ArgumentInvalidError(' isdefined');\n            },\n            defined: (args, math, scope) => {\n                let sides;\n                if (args.length === 0)\n                    throw new ArgumentMissingError('defined');\n                else if (args.length === 1) {\n                    args[0] = this.stripQuotes(args[0], true);\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0) return 0;\n                    //have to check each profile as the client only caches enabled items for speed\n                    for (; k < kl; k++) {\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                        sides = sides.find(i => {\n                            return i.pattern === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                        sides = sides.find(i => {\n                            return i.pattern === args[0] || i.name === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].macros);\n                        sides = sides.find(i => {\n                            return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                        sides = sides.find(i => {\n                            return i.caption === args[0] || i.name === args[0]\n                        });\n                        if (sides) return 1;\n                    }\n                    return this.client.variables.hasOwnProperty(args[0]);\n                }\n                else if (args.length === 2) {\n                    args[0] = this.stripQuotes(args[0].toString());\n                    args[0] = this.stripQuotes(args[1].toString());\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0) return 0;\n                    //have to check each profile as the client only caches enabled items for speed\n                    for (; k < kl; k++) {\n                        switch (args[1]) {\n                            case 'alias':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                                sides = sides.find(i => {\n                                    return i.pattern === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'event':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                sides = sides.find(i => {\n                                    return i.type === TriggerType.Event && (i.pattern === args[0] || i.name === args[0]);\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'trigger':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                sides = sides.find(i => {\n                                    return i.pattern === args[0] || i.name === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'macro':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].macros);\n                                sides = sides.find(i => {\n                                    return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'button':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                                sides = sides.find(i => {\n                                    return i.caption === args[0] || i.name === args[0]\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            //case 'variable':\n                            //case 'path':\n                            //case 'status':\n                            //case 'class':\n                            //case 'menu':                        \n                            //case 'module':\n                        }\n                    }\n                    if (args[1] === 'variable')\n                        return this.client.variables.hasOwnProperty(args[0]) || scope.has(args[0]);\n                }\n                else\n                    throw new ArgumentTooManyError('defined');\n                return 0;\n            },\n            time: (args, math, scope) => {\n                if (args.length > 1)\n                    throw new ArgumentTooManyError('time');\n                if (!moment) return new Date().toISOString();\n                if (args.length)\n                    return moment().format(args[0].compile().evaluate(scope));\n                return moment().format();\n            },\n            clip: (args, math, scope) => {\n                if (args.length > 1)\n                    throw new ArgumentTooManyError('clip');\n                if (args.length) {\n                    (<any>this.client).writeClipboard(args[0].compile().evaluate(scope));\n                    return;\n                }\n                return (<any>this.client).readClipboard();\n            },\n            if: (args, math, scope) => {\n                if (args.length < 3)\n                    throw new ArgumentMissingError('if');\n                if (args.length !== 3)\n                    throw new ArgumentTooManyError('if');\n\n                if (args[0].compile().evaluate(scope))\n                    return args[1].compile().evaluate(scope);\n                return args[2].compile().evaluate(scope);\n            },\n            len: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('len');\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('len');\n                return args[0].compile().evaluate(scope).toString().length;\n            },\n            stripansi: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('Missing arguments for len');\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('len');\n                const ansiRegex = new RegExp('[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)|(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-nq-uy=><~]))', 'g')\n                return args[0].compile().evaluate(scope).toString().replace(ansiRegex, '');\n            },\n            ansi: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('ansi');\n                args = args.map(a =>\n                    getAnsiCode(a.toString()) === -1 && a.toString() !== 'current' ? a.compile().evaluate(scope).toString() : a.toString()\n                );\n                const c = args.length;\n                let mod = [];\n                let min: any = {};\n                let sides;\n                let max;\n                for (sides = 0; sides < c; sides++) {\n                    if (args[sides].trim() === 'current')\n                        mod.push(args[sides].trim());\n                    else {\n                        max = getAnsiCode(args[sides].trim());\n                        if (max === -1)\n                            throw new Error('Invalid color or style for ansi');\n                        //style\n                        if (max >= 0 && max < 30)\n                            min[max] = 1;\n                        //color\n                        else\n                            mod.push(args[sides]);\n                    }\n                }\n                // fore,back\n                if (mod.length > 2)\n                    throw new Error('Too many colors for ansi');\n                if (mod.length > 1) {\n                    if (mod[1] === 'current')\n                        mod[1] = '';\n                    else\n                        mod[1] = getAnsiCode(mod[1], true);\n                }\n                if (mod.length > 0) {\n                    if (min[1] && mod[0] === 'white')\n                        mod[0] = '';\n                    else if (mod[0] === 'current')\n                        mod[0] = '';\n                    else\n                        mod[0] = getAnsiCode(mod[0]);\n                }\n\n                min = [...Object.keys(min), ...mod]\n                if (!min.length)\n                    throw new Error('Invalid colors or styles for ansi');\n                //remove any current flags\n                min = min.filter(f => f !== '');\n                return `\\x1b[${min.join(';')}m`;\n            },\n            color: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('color');\n                args = args.map(a =>\n                    getAnsiCode(a.toString()) === -1 && a.toString() !== 'current' ? a.compile().evaluate(scope).toString() : a.toString()\n                );\n                let c;\n                let sides;\n                if (args.length === 1) {\n                    if (args[0] === 'bold')\n                        return '370';\n                    c = getAnsiColorCode(args[0]);\n                    if (c === -1)\n                        throw new InvalidForeColorError();\n                    return c.toString();\n                }\n                else if (args.length === 2) {\n                    if (args[0] === 'bold')\n                        c = 370;\n                    else {\n                        c = getAnsiColorCode(args[0]);\n                        if (c === -1)\n                            throw new InvalidForeColorError();\n                        if (args[1] === 'bold')\n                            return (c * 10).toString();\n                    }\n                    sides = c.toString();\n                    c = getAnsiColorCode(args[1], true);\n                    if (c === -1)\n                        throw new InvalidBackColorError();\n                    return sides + ',' + c.toString();\n                }\n                else if (args.length === 3) {\n                    if (args[0] === 'bold') {\n                        args.shift();\n                        args.push('bold');\n                    }\n                    if (args[2] !== 'bold')\n                        throw new Error('Only bold is supported as third argument for color');\n                    c = getAnsiColorCode(args[0]);\n                    if (c === -1)\n                        throw new InvalidForeColorError();\n                    sides = (c * 10).toString();\n                    c = getAnsiColorCode(args[1], true);\n                    if (c === -1)\n                        throw new InvalidBackColorError();\n                    return sides + ',' + c.toString();\n                }\n                throw new ArgumentTooManyError('color');\n            },\n            zcolor: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('zcolor');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('zcolor');\n                return getColorCode(parseInt(args[0].compile().evaluate(scope), 10));\n            },\n            case: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('case');\n                let i = args[0].compile().evaluate(scope);\n                if (i > 0 && i < args.length)\n                    return args[i].compile().evaluate(scope);\n                return null;\n            },\n            switch: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('switch');\n                if (args.length % 2 === 1)\n                    throw new Error('All expressions must have a value for switch');\n                let i = args.length\n                for (let c = 0; c < i; c += 2) {\n                    if (args[c].compile().evaluate(scope))\n                        return args[c + 1].compile().evaluate(scope);\n                }\n                return null;\n            },\n            ascii: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('ascii');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('ascii');\n                if (args[0].toString().trim().length === 0)\n                    throw new Error('Invalid argument, empty string for ascii');\n                return args[0].toString().trim().charCodeAt(0);\n            },\n            char: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('char');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('char');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'char');\n                return String.fromCharCode(c);\n            },\n            bitand: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitand');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitand');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitand');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitand');\n                return c & sides;\n            },\n            bitnot: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitnot');\n                else if (args.length !== 1)\n                    throw new ArgumentTooManyError('bitnot');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitnot');\n                return ~c;\n            },\n            bitor: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitor');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitor');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitor');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitor');\n                return c | sides;\n            },\n            bitset: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitset');\n                else if (args.length > 3)\n                    throw new ArgumentTooManyError('bitset');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitset');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitset');\n                sides--;\n                let mod = 1;\n                if (args.length === 3) {\n                    mod = args[2].compile().evaluate(scope);\n                    if (isNaN(mod))\n                        throw new ArgumentInvalidNumberError(args[2], 'bitset');\n                }\n                return (c & (~(1 << sides))) | ((mod ? 1 : 0) << sides);\n            },\n            bitshift: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitshift');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitshift');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitshift');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitshift');\n                if (sides < 0)\n                    return c >> -sides;\n                return c << sides\n            },\n            bittest: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bittest');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bittest');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bittest');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bittest');\n                sides--;\n                return ((c >> sides) % 2 != 0) ? 1 : 0;\n            },\n            bitxor: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitxor');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitxor');\n                let c = args[0].compile().evaluate(scope);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitxor');\n                let sides = args[1].compile().evaluate(scope);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitxor');\n                return c ^ sides;\n            },\n            tonumber: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('number');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('number');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                    return parseInt(args[0], 10);\n                else if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return parseFloat(args[0]);\n                else if (args[0] === 'true')\n                    return 1;\n                else if (args[0] === 'false')\n                    return 0;\n                return 0;\n            },\n            isfloat: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('isfloat');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('isfloat');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return 1;\n                return 0;\n\n            },\n            isnumber: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('isnumber');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('isnumber');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return 1;\n                return 0;\n            },\n            tostring: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('string');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('string');\n                return args[0].compile().evaluate(scope).toString();\n            },\n            float: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('float');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('float');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return parseFloat(args[0]);\n                else if (args[0] === 'true')\n                    return 1.0;\n                else if (args[0] === 'false')\n                    return 0.0;\n                return 0;\n            },\n            trim: (args, math, scope) => {\n                if (args.length !== 1)\n                    throw new ArgumentMissingError('trim');\n                return args[0].compile().evaluate(scope).toString().trim();\n            },\n            trimleft: (args, math, scope) => {\n                if (args.length !== 1)\n                    throw new ArgumentMissingError('trimleft');\n                return args[0].compile().evaluate(scope).toString().trimLeft();\n            },\n            trimright: (args, math, scope) => {\n                if (args.length !== 1)\n                    throw new ArgumentMissingError('trimright');\n                return args[0].compile().evaluate(scope).toString().trimRight();\n            },\n            pos: (args, math, scope) => {\n                if (args.length < 2)\n                    throw new ArgumentMissingError('pos');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('pos');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                args[1] = args[1].compile().evaluate(scope).toString();\n                return args[1].indexOf(args[0]) + 1;\n            },\n            ipos: (args, math, scope) => {\n                if (args.length < 2)\n                    throw new ArgumentMissingError('pos');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('pos');\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\n                return args[1].indexOf(args[0]) + 1;\n            },\n            ends: (args, math, scope) => {\n                if (args.length < 2)\n                    throw new ArgumentMissingError('ends');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('ends');\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\n                return args[0].endsWith(args[1]);\n            },\n            begins: (args, math, scope) => {\n                if (args.length < 2)\n                    throw new ArgumentMissingError('begins');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('begins');\n                args[0] = args[0].compile().evaluate(scope).toString().toLowerCase();\n                args[1] = args[1].compile().evaluate(scope).toString().toLowerCase();\n                return args[0].startsWith(args[1]);\n            },\n            alarm: (args, math, scope) => {\n                let alarms;\n                let a;\n                let al;\n                let t;\n                let p;\n                switch (args.length) {\n                    case 0:\n                        throw new ArgumentMissingError('alarm');\n                    case 1:\n                        args[0] = args[0].compile().evaluate(scope).toString();\n                        alarms = this.client.alarms;\n                        al = alarms.length;\n                        if (al === 0)\n                            throw new Error('No alarms set.');\n                        a = 0;\n                        for (; a < al; a++) {\n                            //only main state counts here\n                            if (alarms[a].type !== TriggerType.Alarm) continue;\n                            if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\n                                if (alarms[a].suspended)\n                                    return 0;\n                                return this.client.getRemainingAlarmTime(a);\n                            }\n                        }\n                        return;\n                    case 2:\n                        t = args[1].compile().evaluate(scope);\n                        args[0] = args[0].compile().evaluate(scope).toString();\n                        alarms = this.client.alarms;\n                        al = alarms.length;\n                        if (al === 0)\n                            throw new Error('No alarms set.');\n                        a = 0;\n                        if (typeof t === 'string') {\n                            for (; a < al; a++) {\n                                //only main state counts here\n                                if (alarms[a].type !== TriggerType.Alarm) continue;\n                                if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\n                                    if (alarms[a].profile.name.toUpperCase() !== t.toUpperCase())\n                                        continue;\n                                    if (alarms[a].suspended)\n                                        return 0;\n                                    return this.client.getRemainingAlarmTime(a);\n                                }\n                            }\n                            throw new Error('Alarm not found in profile: ' + t + '.');\n                        }\n                        else {\n                            for (; a < al; a++) {\n                                //only main state counts here\n                                if (alarms[a].type !== TriggerType.Alarm) continue;\n                                if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\n                                    if (!alarms[a].suspended)\n                                        this.client.setAlarmTempTime(a, t);\n                                    return t;\n                                }\n                            }\n                            throw new Error('Alarm not found.');\n                        }\n                    case 3:\n                        t = args[1].compile().evaluate(scope);\n                        args[0] = args[0].compile().evaluate(scope).toString()\n                        p = args[2].compile().evaluate(scope).toString();\n                        alarms = this.client.alarms;\n                        al = alarms.length;\n                        if (al === 0)\n                            throw new Error('No alarms set.');\n                        a = 0;\n                        for (; a < al; a++) {\n                            //only main state counts here\n                            if (alarms[a].type !== TriggerType.Alarm) continue;\n                            if (alarms[a].name === args[0] || alarms[a].pattern === args[0]) {\n                                if (alarms[a].profile.name.toUpperCase() !== p.toUpperCase())\n                                    continue;\n                                if (!alarms[a].suspended)\n                                    this.client.setAlarmTempTime(a, t);\n                                return t;\n                            }\n                        }\n                        throw Error('Could not set time, alarm not found in profile: ' + args[2] + '.');\n                }\n                throw new ArgumentTooManyError('alarm');\n            },\n            state: (args, math, scope) => {\n                let trigger;\n                if (args.length === 0)\n                    throw new ArgumentMissingError('state');\n                if (args.length > 2)\n                    throw new ArgumentTooManyError('state');\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (args.length === 1) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                        trigger = trigger.find(t => {\n                            return t.name === args[0] || t.pattern === args[0];\n                        });\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                            trigger = trigger.find(t => {\n                                return t.name === args[0] || t.pattern === args[0];\n                            });\n                            if (trigger)\n                                break;\n                        }\n                    }\n                }\n                else if (args.length === 2) {\n                    args[1] = args[1].compile().evaluate(scope);\n                    let profile;\n                    if (this._profiles.contains(args[1]))\n                        profile = this._profiles.items[args[1].toLowerCase()];\n                    else\n                        throw new ProfileNotFound(args[1]);\n                    trigger = SortItemArrayByPriority(profile.triggers);\n                    trigger = trigger.find(t => {\n                        return t.name === args[0] || t.pattern === args[0];\n                    });\n                }\n                if (trigger)\n                    return trigger.triggers && trigger.triggers.length ? trigger.state : 0;\n                throw new Error('Trigger not found');\n            },\n            isnull: (args, math, scope) => {\n                if (args.length === 0)\n                    return null;\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('null');\n                return args[0].compile().evaluate(scope) ? 1 : 0;\n            },\n            escape: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('unescape');\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('unescape');\n                let c;\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (this._getOption('allowEscape')) {\n                    const escape = this._getOption('allowEscape') ? this._getOption('escapeChar') : '';\n                    c = escape;\n                    if (escape === '\\\\')\n                        c += escape;\n                    if (this._getOption('parseDoubleQuotes'))\n                        c += '\"';\n                    if (this._getOption('parseSingleQuotes'))\n                        c += '\\'';\n                    if (this._getOption('commandStacking'))\n                        c += this._getOption('commandStackingChar');\n                    if (this._getOption('enableSpeedpaths'))\n                        c += this._getOption('speedpathsChar');\n                    if (this._getOption('enableCommands'))\n                        c += this._getOption('commandChar');\n                    if (this._getOption('enableVerbatim'))\n                        c += this._getOption('verbatimChar');\n                    if (this._getOption('enableDoubleParameterEscaping'))\n                        c += this._getOption('parametersChar');\n                    if (this._getOption('enableNParameters'))\n                        c += this._getOption('nParametersChar');\n                    return args.replace(new RegExp(`[${c}]`, 'g'), escape + '$&');\n                }\n                return args.replace(/[\\\\\"']/g, '\\$&');\n            },\n            unescape: (args, math, scope) => {\n                if (args.length === 0)\n                    throw new ArgumentMissingError('unescape');\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('unescape');\n                let c;\n                args[0] = args[0].compile().evaluate(scope).toString();\n                if (this._getOption('allowEscape')) {\n                    const escape = this._getOption('allowEscape') ? this._getOption('escapeChar') : '';\n                    c = escape;\n                    if (escape === '\\\\')\n                        c += escape;\n                    if (this._getOption('parseDoubleQuotes'))\n                        c += '\"';\n                    if (this._getOption('parseSingleQuotes'))\n                        c += '\\'';\n                    if (this._getOption('commandStacking'))\n                        c += this._getOption('commandStackingChar');\n                    if (this._getOption('enableSpeedpaths'))\n                        c += this._getOption('speedpathsChar');\n                    if (this._getOption('enableCommands'))\n                        c += this._getOption('commandChar');\n                    if (this._getOption('enableVerbatim'))\n                        c += this._getOption('verbatimChar');\n                    if (this._getOption('enableDoubleParameterEscaping'))\n                        c += this._getOption('parametersChar');\n                    if (this._getOption('enableNParameters'))\n                        c += this._getOption('nParametersChar');\n                    if (escape === '\\\\')\n                        return args[0].replace(new RegExp(`\\\\\\\\[${c}]`, 'g'), (m) => m.substr(1));\n                    return args[0].replace(new RegExp(`${escape}[${c}]`, 'g'), (m) => m.substr(1));\n                }\n                return args[0].replace(/\\\\[\\\\\"']/g, (m) => m.substr(1));\n            },\n            prompt: (args, math, scope) => {\n                if (args.length > 3)\n                    throw new ArgumentTooManyError('prompt');\n                if (args.length === 0)\n                    return window.prompt();\n                args = args.map(a => a.compile().evaluate(scope).toString());\n                return window.prompt(...args);\n            },\n            /*\n            fileprompt: (args, math, scope) => {\n                if (args.length > 2)\n                    throw new ArgumentTooManyError('fileprompt');\n                args = args.map(a => a.compile().evaluate(scope).toString());\n                let f = [\n                    { name: 'All files (*.*)', extensions: ['*'] },\n                ];\n                if (args.length > 0 && args[0].trim().length > 0) {\n                    f.unshift({\n                        name: args[0],\n                        extensions: args[0].split(',').map(a => a.trim())\n                    })\n                }\n                let files = dialog.showOpenDialogSync({\n                    filters: f,\n                    properties: ['openFile', 'promptToCreate'],\n                    defaultPath: args.length >= 2 ? parseTemplate(args[1]) : ''\n                });\n                if (files && files.length) return files[0];\n            }\n            */\n        };\n        for (let fun in functions) {\n            if (!functions.hasOwnProperty(fun) || typeof functions[fun] !== 'function') {\n                continue;\n            }\n            functions[fun].rawArgs = true;\n        }\n        _mathjs.import(functions, {});\n    }\n\n    public resetExpressionEngine() {\n        if (!_mathjs) return;\n        _mathjs = undefined;\n    }\n\n    constructor(client: Client) {\n        super();\n        if (!client)\n            throw new Error('Invalid client!');\n        this.client = client;\n        //wrap mathjs to load on demand for speed as not every may need math\n        mathjs = () => {\n            if (_mathjs) return _mathjs;\n            this._initMathJS();\n            return _mathjs;\n        }\n        this._commandHistory = [];\n        document.addEventListener('keydown', (event) => {\n            if (!this.isLocked && this.ProcessMacros(event.which, event.altKey, event.ctrlKey, event.shiftKey, event.metaKey)) {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            //toggle scroll lock\n            else if (event.key === 'ScrollLock')\n                this.toggleScrollLock();\n        });\n\n        this.client.on('parse-command', (data) => {\n            if (this._getOption('parseCommands'))\n                data.value = this.parseOutgoing(data.value, null, null, null, null, !data.comments);\n        });\n\n        this.client.on('add-line', (data) => {\n            this.ExecuteTriggers(TriggerTypes.Regular | TriggerTypes.Pattern | TriggerTypes.LoopExpression, data.line, data.raw, data.fragment, false, true);\n            if (this._gag > 0 && !data.fragment) {\n                data.gagged = true;\n                this._gag--;\n            }\n            //if not fragment and not gagged count\n            if (!data.fragment)\n                for (let state in this._TriggerStates) {\n                    if (this._TriggerStates[state].lineCount)\n                        this._TriggerStates[state].lineCount--;\n                    //if (data.remote && this._TriggerStates[state].remoteCount)\n                    //this._TriggerStates[state].remoteCount--;\n                }\n        });\n\n        this.client.on('options-loaded', () => {\n            if (!_mathjs && this._getOption('initializeScriptEngineOnLoad'))\n                this._initMathJS();\n            this._initPads();\n        });\n\n        this.client.commandInput.addEventListener('keyup', event => {\n            if (event.key !== 'Escape' && event.key !== 'ArrowUp' && event.key !== 'ArrowDown')\n                this._historyIdx = this._commandHistory.length;\n        })\n\n        this.client.commandInput.addEventListener('keydown', event => {\n            switch (event.key) {\n                case 'Escape': //esc\n                    //any modifier set not a proper history navigation    \n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\n                    this.client.commandInput.blur();\n                    this.client.commandInput.value = '';\n                    this.client.commandInput.select();\n                    this._historyIdx = this._commandHistory.length;\n                    this._tabIdx = -1;\n                    this._tabWords = null;\n                    this._tabSearch = null\n                    this.emit('history-navigate', event);\n                    break;\n                case 'ArrowUp': //up\n                    //any modifier set not a proper history navigation    \n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\n                    if (this._historyIdx === this._commandHistory.length && this.client.commandInput.value.length > 0) {\n                        this.AddCommandToHistory(this.client.commandInput.value);\n                        if (this.client.commandInput.value === this._commandHistory[this._historyIdx - 1])\n                            this._historyIdx--;\n                    }\n                    this._historyIdx--;\n                    if (this._historyIdx < 0)\n                        this._historyIdx = 0;\n                    if (this._commandHistory.length < 0) {\n                        this._historyIdx = -1;\n                        this.client.commandInput.value = '';\n                    }\n                    else if (this._commandHistory.length > 0 && this._historyIdx < this._commandHistory.length && this._historyIdx >= 0) {\n                        this.client.commandInput.value = this._commandHistory[this._historyIdx];\n                    }\n                    setTimeout(() => this.client.commandInput.select(), 0);\n                    this.emit('history-navigate', event);\n                    break;\n                case 'ArrowDown': //down\n                    //any modifier set not a proper history navigation    \n                    if (event.ctrlKey || event.shiftKey || event.metaKey || event.altKey) return;\n                    if (this._historyIdx === this._commandHistory.length && this.client.commandInput.value.length > 0)\n                        this.AddCommandToHistory(this.client.commandInput.value);\n                    this._historyIdx++;\n                    if (this._historyIdx >= this._commandHistory.length || this._commandHistory.length < 1) {\n                        this._historyIdx = this._commandHistory.length;\n                        this.client.commandInput.value = '';\n                    }\n                    else if (this._commandHistory.length > 0 && this._historyIdx < this._commandHistory.length && this._historyIdx >= 0) {\n                        this.client.commandInput.value = this._commandHistory[this._historyIdx];\n                    }\n                    setTimeout(() => this.client.commandInput.select(), 0);\n                    this.emit('history-navigate', event);\n                    break;\n                case 'Enter': // return\n                    switch (this._getOption('newlineShortcut')) {\n                        case NewLineType.Ctrl:\n                            if (event.ctrlKey && !event.shiftKey && !event.metaKey && !event.altKey) {\n                                insertValue(this.client.commandInput, '\\n');\n                                this.emit('history-navigate', event);\n                                this.client.commandInput.blur();\n                                this.client.commandInput.focus();\n                                return true;\n                            }\n                            break;\n                        case NewLineType.CtrlAndShift:\n                            if (event.ctrlKey && event.shiftKey && !event.metaKey && !event.altKey) {\n                                insertValue(this.client.commandInput, '\\n');\n                                this.emit('history-navigate', event);\n                                this.client.commandInput.blur();\n                                this.client.commandInput.focus();\n                                return true;\n                            }\n                            break;\n                        case NewLineType.CtrlOrShift:\n                            if ((event.ctrlKey || event.shiftKey) && !event.metaKey && !event.altKey) {\n                                insertValue(this.client.commandInput, '\\n');\n                                this.emit('history-navigate', event);\n                                this.client.commandInput.blur();\n                                this.client.commandInput.focus();\n                                return true;\n                            }\n                            break;\n                        case NewLineType.Shift:\n                            if ((event.ctrlKey && event.shiftKey) && !event.metaKey && !event.altKey) {\n                                insertValue(this.client.commandInput, '\\n');\n                                this.emit('history-navigate', event);\n                                this.client.commandInput.blur();\n                                this.client.commandInput.focus();\n                                return true;\n                            }\n                            break;\n                    }\n                    //only send if no modifiers set\n                    if (!event.ctrlKey && !event.shiftKey && !event.metaKey && !event.altKey) {\n                        this._tabIdx = -1;\n                        this._tabWords = null;\n                        this._tabSearch = null\n                        event.preventDefault();\n                        this.client.sendCommand(null, null, this._getOption('allowCommentsFromCommand'));\n                        this.emit('history-navigate', event);\n                    }\n                    event.preventDefault();\n                    break;\n                case 'Tab':\n                    if (!this._getOption('enableTabCompletion') || this.client.commandInput.value.length === 0) return;\n                    //any modifiers down do not do tab complete\n                    if (event.altKey || event.ctrlKey || event.metaKey) return;\n                    if (event.shiftKey)\n                        this._tabIdx--;\n                    else\n                        this._tabIdx++;\n                    let start = this.client.commandInput.selectionStart;\n                    let end = this.client.commandInput.selectionEnd;\n                    if (this._tabWords === null) {\n                        const cursorPos = getCursor(this.client.commandInput);\n                        //(?=\\s[\\S]+$)\n                        let endPos = this.client.commandInput.value.indexOf(' ', cursorPos);\n                        if (endPos === -1)\n                            endPos = this.client.commandInput.value.indexOf('\\n', cursorPos);\n                        let startPos = this.client.commandInput.value.lastIndexOf(' ', cursorPos - 1);\n                        if (startPos === -1)\n                            startPos = this.client.commandInput.value.indexOf('\\n', cursorPos - 1);\n                        if (endPos === -1)\n                            endPos = this.client.commandInput.value.length;\n                        if (startPos === -1)\n                            startPos = 0;\n                        else\n                            startPos++;\n                        start = startPos;\n                        end = endPos;\n                        if (start === end)\n                            end++;\n                        const findStr = this.client.commandInput.value.substring(startPos, endPos);\n                        //nothing to find so bail\n                        if (findStr.length === 0) return;\n                        //tabCompletionList\n                        //tabCompletionType\n                        //this._getOption('enableTabCompletion')\n                        //TabCompletion\n                        this._tabSearch = { start: startPos, end: endPos, find: findStr.length };\n                        const regSearch = new RegExp(`^${findStr.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}`, this._getOption('ignoreCaseTabCompletion') ? 'i' : '');\n                        if (this._getOption('tabCompletionLookupType') === TabCompletion.List)\n                            this._tabWords = [...new Set(<string>this._getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)))];\n                        else {\n                            //get all words that start with findStr then reverse as you want last words first as they are the newest\n                            this._tabWords = [].concat(...this.client.display.lines.slice(this.client.display.lines.length - this._getOption('tabCompletionBufferLimit')).map(line => line.text.split(/\\s+/))).filter(word => word.match(regSearch)).reverse();\n                            if (this._getOption('tabCompletionLookupType') === TabCompletion.PrependBuffer)\n                                this._tabWords = [...new Set(<string>this._getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)).reverse())].concat(this._tabWords);\n                            else if (this._getOption('tabCompletionLookupType') === TabCompletion.AppendBuffer)\n                                this._tabWords = this._tabWords.concat([...new Set(<string>this._getOption('tabCompletionList').split(/\\s+/).filter(word => word.match(regSearch)).reverse())]);\n\n                            this._tabWords = [...new Set(this._tabWords)];\n                        }\n                    }\n                    else\n                        start -= this._tabSearch.find;\n                    if (this._tabWords.length === 0) return;\n                    if (this._tabIdx < 0) this._tabIdx = this._tabWords.length - 1;\n                    if (this._tabIdx >= this._tabWords.length) this._tabIdx = 0;\n\n                    const tabCasing = this._getOption('tabCompletionReplaceCasing');\n                    //Fixes undo/redo but saves all tab changes better to just break undo i think\n                    //this.client.commandInput.selectionStart = start;\n                    //this.client.commandInput.selectionEnd = end;\n                    //insertValue(this.client.commandInput, (tabCasing === 1 ? (this._tabWords[this._tabIdx].toLowerCase()) : (tabCasing === 2 ? this._tabWords[this._tabIdx].toUpperCase() : this._tabWords[this._tabIdx])));\n                    this.client.commandInput.value = this.client.commandInput.value.substring(0, start)\n                        + (tabCasing === 1 ? (this._tabWords[this._tabIdx].toLowerCase()) : (tabCasing === 2 ? this._tabWords[this._tabIdx].toUpperCase() : this._tabWords[this._tabIdx]))\n                        + this.client.commandInput.value.substring(end, this.client.commandInput.value.length);\n                    this.client.commandInput.selectionStart = this._tabSearch.start + this._tabSearch.find;\n                    this.client.commandInput.selectionEnd = this._tabSearch.start + this._tabWords[this._tabIdx].length;\n                    event.preventDefault();\n                    this.emit('history-navigate', event);\n                    break;\n                case 'Shift':\n                case 'Control':\n                case 'Meta':\n                case 'Alt':\n                case 'CapsLock':\n                case 'Fn':\n                case 'NumLock':\n                case 'ScrollLock':\n                case 'Super':\n                case 'PageDown':\n                case 'PageUp':\n                case 'End':\n                case 'Home':\n                case 'ArrowLeft':\n                case 'ArrowRight':\n                case 'ContextMenu':\n                    //TODO see if any other keys should not effect tab complete\n                    //Do not effect tab completion\n                    break;\n                default:\n                    this._tabIdx = -1;\n                    this._tabWords = null;\n                    this._tabSearch = null\n                    break;\n            }\n        });\n\n        this.client.commandInput.addEventListener('mouseup', event => {\n            this._tabIdx = -1;\n            this._tabWords = null;\n            this._tabSearch = null\n        });\n        //spell-checker:ignore gamepadconnected gamepaddisconnected\n        window.addEventListener('gamepadconnected', (e) => {\n            if (!this._getOption('gamepads')) return;\n            if (!this._gamepadCaches)\n                this._gamepadCaches = [];\n            this._controllers[e.gamepad.index] = { pad: e.gamepad, axes: clone(e.gamepad.axes), state: { axes: [], buttons: [] }, pState: { axes: [], buttons: [] } };\n            this._controllersCount++;\n            this._updatePads();\n        });\n\n        window.addEventListener('gamepaddisconnected', (e) => {\n            if (!this._getOption('gamepads')) return;\n            delete this._controllers[e.gamepad.index];\n            this._controllersCount--;\n        });\n        this._initPads();\n    }\n\n    private async _initPads() {\n        if (!this.client || !this.client.options) {\n            setTimeout(this._initPads, 5);\n            return;\n        }\n        this._controllers = [];\n        this._controllersCount = 0;\n        this._gamepadCaches = null;\n        if (!this._getOption('gamepads')) return;\n        const controllers = navigator.getGamepads();\n        let ct = 0;\n        const cl = controllers.length;\n        for (; ct < cl; ct++) {\n            if (!controllers[ct]) continue;\n            this._controllers[controllers[ct].index] = { pad: controllers[ct], axes: clone(controllers[ct].axes), state: { axes: [], buttons: [] }, pState: { axes: [], buttons: [] } };\n            this._controllersCount++;\n        }\n        this._updatePads();\n    }\n\n    private _updatePads() {\n        if (this._controllersCount === 0 || !this._getOption('gamepads'))\n            return;\n        const controllers = navigator.getGamepads();\n        let c = 0;\n        const cl = controllers.length;\n        if (!this._gamepadCaches && cl > 0)\n            this._gamepadCaches = [];\n        for (; c < cl; c++) {\n            const controller = controllers[c];\n            //no control and did not correctly connect so skip\n            if (!controller || !this._controllers[controller.index]) continue;\n            const state = this._controllers[controller.index].state;\n            const axes = this._controllers[controller.index].axes;\n            const bl = controller.buttons.length;\n            let i;\n            let macros;\n            if (!this._gamepadCaches[c])\n                this._gamepadCaches[c] = FilterArrayByKeyValue(this.client.macros, 'gamepad', c + 1);\n            macros = this._gamepadCaches[c];\n            let m = 0;\n            const ml = macros.length;\n            if (ml === 0) continue;\n            for (i = 0; i < bl; i++) {\n                let val: any = controller.buttons[i];\n                let pressed;\n                if (typeof (val) === 'object') {\n                    pressed = val.pressed;\n                    val = val.value;\n                }\n                else\n                    pressed = val >= 0.5;\n                if (state.buttons[i]) {\n                    if (state.buttons[i].pressed !== pressed) {\n                        state.buttons[i].pressed = pressed;\n                        if (!pressed) {\n                            for (; m < ml; m++) {\n                                if (!macros[m].enabled) continue;\n                                if (macros[m].key !== i + 1) continue;\n                                if (this.ExecuteMacro(macros[m])) {\n                                    if (this._controllersCount > 0 || controllers.length > 0)\n                                        requestAnimationFrame(() => { this._updatePads(); });\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    state.buttons[i] = { pct: Math.round(val * 100), pressed: pressed };\n                }\n            }\n\n            const al = controller.axes.length;\n            let a = 0;\n            for (i = 0; i < al; i++) {\n                if (state.axes[i] !== controller.axes[i] && controller.axes[i] !== axes[i]) {\n                    state.axes[i] = controller.axes[i];\n                    if (state.axes[i] < -0.75) {\n                        a = -(i + 1);\n                    }\n                    else if (state.axes[i] > 0.75) {\n                        a = i + 1;\n                    }\n                }\n                else if (state.axes[i] < -0.75) {\n                    a = -(i + 1);\n                }\n                else if (state.axes[i] > 0.75) {\n                    a = i + 1;\n                }\n                if (a !== 0)\n                    for (; m < ml; m++) {\n                        if (!macros[m].enabled) continue;\n                        if (macros[m].gamepadAxes !== i + 1) continue;\n                        if (this.ExecuteMacro(macros[m])) {\n                            if (this._controllersCount > 0 || controllers.length > 0)\n                                requestAnimationFrame(() => { this._updatePads(); });\n                            return;\n                        }\n                    }\n            }\n        }\n        if (this._controllersCount > 0 || controllers.length > 0)\n            requestAnimationFrame(() => { this._updatePads(); });\n    }\n\n    public adjustLastLine(n, raw?) {\n        if (!this.client.display.lines || this.client.display.lines.length === 0)\n            return 0;\n        if (raw) {\n            if (n === this.client.display.lines.length) {\n                n--;\n                if (this.client.display.lines[n].text.length === 0 && this.client.display.lines[n].raw.length)\n                    n--;\n            }\n            else if (n === this.client.display.lines.length - 1 && this.client.display.lines[n].text.length === 0 && this.client.display.lines[n].raw.length)\n                n--;\n        }\n        else if (n === this.client.display.lines.length) {\n            n--;\n            if (this.client.display.lines[n].text.length === 0)\n                n--;\n        }\n        else if (n === this.client.display.lines.length - 1 && this.client.display.lines[n].text.length === 0)\n            n--;\n        return n;\n    }\n\n    get isLocked(): boolean {\n        return this._locked === 0 ? false : true;\n    }\n\n    public addLock() {\n        this._locked++;\n    }\n\n    public removeLock() {\n        this._locked--;\n    }\n\n    public AddCommandToHistory(cmd: string) {\n        if ((this._commandHistory.length < 1 || this._commandHistory[this._commandHistory.length - 1] !== cmd) && cmd.length > 0) {\n            if (this._commandHistory.length >= this._getOption('commandHistorySize'))\n                this._commandHistory.shift();\n            this._commandHistory.push(cmd);\n            this.emit('command-history-changed', this._commandHistory);\n        }\n    }\n\n    public clearCommandHistory() {\n        this._commandHistory = [];\n        this._historyIdx = -1;\n        this.emit('command-history-changed', this._commandHistory);\n    }\n\n    public setHistoryIndex(index) {\n        if (index < 0 || this._commandHistory.length === 0)\n            this._historyIdx = -1;\n        else if (index >= this._commandHistory.length)\n            this._historyIdx = this._commandHistory.length - 1;\n        else\n            this._historyIdx = index;\n    }\n\n    public get commandHistory() { return this._commandHistory; }\n\n    public executeScript(txt: string) {\n        if (txt == null)\n            return txt;\n        let state: number = 0;\n        let idx: number = 0;\n        let c: string;\n        const tl: number = txt.length;\n        let fun: string = '';\n        let args = [];\n        let arg: string = '';\n        let raw: string;\n        let s = 0;\n        const pd: boolean = this._getOption('parseDoubleQuotes');\n        const ps: boolean = this._getOption('parseSingleQuotes');\n        const cmdChar: string = this._getOption('commandChar');\n\n        for (; idx < tl; idx++) {\n            c = txt.charAt(idx);\n            switch (state) {\n                //find name\n                case 1:\n                    if (c === ' ') {\n                        state = 2;\n                        raw += c;\n                    }\n                    else {\n                        fun += c;\n                        raw += c;\n                    }\n                    break;\n                //find arguments\n                case 2:\n                    if (c === '{') {\n                        state = 7;\n                        arg += c;\n                    }\n                    else if (c === '(') {\n                        state = 8;\n                        arg += c;\n                    }\n                    else if (c === ' ') {\n                        args.push(arg);\n                        arg = '';\n                    }\n                    else {\n                        if (c === '\"' && pd)\n                            state = 3;\n                        else if (c === '\\'' && ps)\n                            state = 4;\n                        arg += c;\n                    }\n                    raw += c;\n                    break;\n                case 3:\n                    if (c === '\"')\n                        state = 2;\n                    //if (c === '\\\\')\n                    //state = 5;\n                    //else {\n                    arg += c;\n                    raw += c;\n                    //}\n                    break;\n                case 4:\n                    if (c === '\\'')\n                        state = 2;\n                    //if (c === '\\\\')\n                    //state = 6;\n                    //else {\n                    arg += c;\n                    raw += c;\n                    //}\n                    break;\n                case 7:\n                    arg += c;\n                    if (c === '}') {\n                        if (s === 0) {\n                            state = 2;\n                        }\n                        else\n                            s--;\n                    }\n                    else if (c === '{')\n                        s++;\n                    raw += c;\n                    break;\n                case 8:\n                    arg += c;\n                    if (c === ')') {\n                        if (s === 0) {\n                            state = 2;\n                        }\n                        else\n                            s--;\n                    }\n                    else if (c === '(')\n                        s++;\n                    raw += c;\n                    break;\n                /*\n            case 5:\n                if (c === '\"') {\n                    arg += c;\n                    raw += c;\n                }\n                else {\n                    arg += '\\\\';\n                    raw += '\\\\';\n                    idx--;\n                }\n                state = 3;\n                break;\n            case 6:\n                if (c === '\\'') {\n                    arg += c;\n                    raw += c;\n                }\n                else {\n                    arg += '\\\\';\n                    raw += '\\\\';\n                    idx--;\n                }\n                state = 4;\n                break;\n                */\n                default:\n                    if (idx === 0 && c === cmdChar) {\n                        state = 1;\n                        fun = '';\n                        args = [];\n                        arg = '';\n                        raw = c;\n                    }\n                    else\n                        return txt;\n                    break;\n            }\n        }\n        if (fun.length > 0) {\n            //if (state === 3)\n            //arg += '\"';\n            //else if (state === 4)\n            //arg += '\\'';\n            if (arg.endsWith('\\n'))\n                arg = arg.substring(0, arg.length - 1);\n            if (arg.length > 0) args.push(arg);\n            return this.executeFunction(fun, args, raw, cmdChar);\n        }\n        return txt;\n    }\n\n    public executeFunction(fun: string, args, raw: string, cmdChar: string) {\n        let n;\n        let f = false;\n        let items;\n        let al;\n        let i;\n        let tmp;\n        let profile = null;\n        let name = null;\n        let item;\n        let p;\n        let trigger;\n        switch (fun.toLowerCase()) {\n            //spell-checker:ignore untrigger unaction\n            case 'unaction':\n            case 'untrigger':\n            case 'unt':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                profile = null;\n                name = null;\n                if (args.length < 1 || args.length > 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unt\\x1b[0;-11;-12mrigger {pattern|name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new Error('Invalid name or pattern');\n                //{pattern} {commands} profile\n                if (args[0].match(/^\\{.*\\}$/g))\n                    args[0] = this.parseInline(args[0].substr(1, args[0].length - 2));\n                else\n                    args[0] = this.parseInline(this.stripQuotes(args[0]));\n                if (args.length === 2) {\n                    profile = this.stripQuotes(args[2]);\n                    profile = this.parseInline(profile);\n                }\n                if (!profile || profile.length === 0) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        item = this._profiles.items[keys[k]].findAny('triggers', { name: args[0], pattern: args[0] });\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            item = this._profiles.items[keys[k]].findAny('triggers', { name: args[0], pattern: args[0] });\n                            if (item) {\n                                profile = this._profiles.items[keys[k]];\n                                break;\n                            }\n                        }\n                    }\n                    if (!item)\n                        throw new Error('Trigger \\'' + args[0] + '\\' not found in \\'' + profile.name + '\\'!');\n                    this.client.removeTrigger(item);\n                    this._echo('Trigger \\'' + args[0] + '\\' removed from \\'' + profile.name + '\\'.', -7, -8, true, true);\n                }\n                else {\n                    profile = this.parseInline(profile);\n                    if (this._profiles.contains(profile)) {\n                        profile = this._profiles.items[profile.toLowerCase()];\n                        item = profile.findAny('triggers', { name: args[0], pattern: args[0] });\n                        if (!item)\n                            throw new Error('Trigger \\'' + args[0] + '\\' not found in \\'' + profile.name + '\\'!');\n                        this.client.removeTrigger(item);\n                        this._echo('Trigger \\'' + args[0] + '\\' removed from \\'' + profile.name + '\\'.', -7, -8, true, true);\n                    }\n                    else\n                        throw new ProfileNotFound(profile);\n                }\n                return null;\n            case 'suspend':\n            case 'sus':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                switch (args.length) {\n                    case 0:\n                        tmp = this.client.alarms;\n                        if (tmp.length === 0)\n                            this._echo('No alarms defined.', -7, -8, true, true);\n                        else {\n                            this.client.setAlarmState(0, false);\n                            this._lastSuspend = 0;\n                            this._echo('Last alarm suspended.', -7, -8, true, true);\n                        }\n                        return null;\n                    case 1:\n                        items = this.parseInline(this.stripQuotes(args[0]));\n                        tmp = this.client.alarms;\n                        al = tmp.length;\n                        for (let a = tmp.length - 1; a >= 0; a--) {\n                            if (tmp[a].name === items || tmp[a].pattern === items) {\n                                this.client.setAlarmState(a, false);\n                                this._echo('Alarm \\'' + items + '\\' suspended.', -7, -8, true, true);\n                                this._lastSuspend = a;\n                                break;\n                            }\n                        }\n                        return null;\n                    default:\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sus\\x1b[0;-11;-12mpend id \\x1b[3mprofile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'sus\\x1b[0;-11;-12mpend');\n                }\n            case 'resume':\n            case 'resu':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                switch (args.length) {\n                    case 0:\n                        if (this._lastSuspend === -1)\n                            return null;\n                        this.client.setAlarmState(this._lastSuspend, true);\n                        this._echo('Last alarm suspended resumed.', -7, -8, true, true);\n                        this._lastSuspend = -1;\n                        return null;\n                    case 1:\n                        items = this.parseInline(this.stripQuotes(args[0]));\n                        tmp = this.client.alarms;\n                        al = tmp.length;\n                        for (let a = al - 1; a >= 0; a--) {\n                            if (tmp[a].name === items || tmp[a].pattern === items) {\n                                this.client.setAlarmState(a, true);\n                                this._echo('Alarm \\'' + items + '\\' resumed.', -7, -8, true, true);\n                                break;\n                            }\n                        }\n                        return null;\n                    default:\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'resu\\x1b[0;-11;-12mme id \\x1b[3mprofile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'resu\\x1b[0;-11;-12mme');\n                }\n            case 'action':\n            case 'ac':\n            case 'trigger':\n            case 'tr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region trigger\n                item = {\n                    profile: null,\n                    name: null,\n                    pattern: null,\n                    commands: null,\n                    options: { priority: 0 }\n                };\n                if (args.length < 2 || args.length > 5)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'tr\\x1b[0;-11;-12migger name {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'tr\\x1b[0;-11;-12migger {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new InvalidTrigger('name or pattern');\n\n                if (args[0].match(/^\\{.*\\}$/g)) {\n                    item.pattern = args.shift();\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                }\n                else {\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\n                    if (!item.name || item.name.length === 0)\n                        throw new InvalidTrigger('name');\n                    if (args[0].match(/^\\{.*\\}$/g)) {\n                        item.pattern = args.shift();\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    }\n                }\n                if (args.length !== 0) {\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                        item.commands = args.shift();\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\n                    }\n                    if (args.length === 1) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        else\n                            args[0] = this.stripQuotes(args[0]);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'temporary':\n                                    case 'temp':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                        //case 'expression':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1], TriggerTypeFilter.Main))\n                                                throw new InvalidTrigger('type');\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTrigger('options');\n                    }\n                    else if (args.length === 2) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'temporary':\n                                    case 'temp':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                        //case 'expression':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1], TriggerTypeFilter.Main))\n                                                throw new InvalidTrigger('type');\n\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTrigger('options');\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                }\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name);\n                //#endregion\n                return null;\n            case 'event':\n            case 'ev':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region event\n                profile = null;\n                item = {\n                    profile: null,\n                    name: null,\n                    pattern: null,\n                    commands: null,\n                    options: { priority: 0 }\n                };\n                if (args.length < 2 || args.length > 4)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ev\\x1b[0;-11;-12ment name {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new Error('Invalid event name');\n\n                item.name = this.parseInline(this.stripQuotes(args.shift()));\n                if (!item.name || item.name.length === 0)\n                    throw new Error('Invalid event name');\n                if (args.length === 0)\n                    throw new Error('Missing commands or options');\n\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                    item.commands = args.shift();\n                    item.commands = item.commands.substr(1, item.commands.length - 2);\n                }\n                else\n                    throw new Error('Missing commands');\n                if (args.length === 1) {\n                    args[0] = args[0].substr(1, args[0].length - 2);\n                    if (args[0].length !== 0) {\n                        this.parseInline(args[0]).split(',').forEach(o => {\n                            switch (o.trim()) {\n                                case 'nocr':\n                                case 'prompt':\n                                case 'case':\n                                case 'verbatim':\n                                case 'disable':\n                                case 'temporary':\n                                case 'temp':\n                                    item.options[o.trim()] = true;\n                                    break;\n                                default:\n                                    if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                        tmp = o.trim().split('=');\n                                        if (tmp.length !== 2)\n                                            throw new Error(`Invalid event priority option '${o.trim()}'`);\n                                        i = parseInt(tmp[1], 10);\n                                        if (isNaN(i))\n                                            throw new Error('Invalid event priority value \\'' + tmp[1] + '\\' must be a number');\n                                        item.options['priority'] = i;\n                                    }\n                                    else\n                                        throw new Error(`Invalid event option '${o.trim()}'`);\n                            }\n                        });\n                    }\n                    else\n                        throw new Error('Invalid event options');\n                }\n                else if (args.length === 2) {\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[0] = args[0].substr(1, args[0].length - 2);\n                    if (args[0].length !== 0) {\n                        this.parseInline(args[0]).split(',').forEach(o => {\n                            switch (o.trim()) {\n                                case 'nocr':\n                                case 'prompt':\n                                case 'case':\n                                case 'verbatim':\n                                case 'disable':\n                                case 'temporary':\n                                case 'temp':\n                                    item.options[o.trim()] = true;\n                                    break;\n                                default:\n                                    if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                        tmp = o.trim().split('=');\n                                        if (tmp.length !== 2)\n                                            throw new Error(`Invalid event priority option '${o.trim()}'`);\n                                        i = parseInt(tmp[1], 10);\n                                        if (isNaN(i))\n                                            throw new Error('Invalid event priority value \\'' + tmp[1] + '\\' must be a number');\n                                        item.options['priority'] = i;\n                                    }\n                                    else\n                                        throw new Error(`Invalid event option '${o.trim()}'`);\n                            }\n                        });\n                    }\n                    else\n                        throw new Error('Invalid event options');\n                    item.profile = this.stripQuotes(args[1]);\n                    if (item.profile.length !== 0)\n                        item.profile = this.parseInline(item.profile);\n                }\n\n                if (!item.profile || item.profile.length === 0) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        profile = this._profiles.items[keys[0]];\n                        tmp = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers.filter(t => t.type === TriggerType.Event));\n                        trigger = tmp.find(t => {\n                            return t.name === item.name || t.pattern === item.name;\n                        });\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            tmp = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers.filter(t => t.type === TriggerType.Event));\n                            trigger = tmp.find(t => {\n                                return t.name === item.name || t.pattern === item.name;\n                            });\n                            if (trigger) {\n                                profile = this._profiles.items[keys[k]];\n                                break;\n                            }\n                        }\n                        if (!profile)\n                            profile = this.client.activeProfile;\n                    }\n                }\n                else {\n                    if (this._profiles.contains(item.profile))\n                        profile = this._profiles.items[item.profile.toLowerCase()];\n                    else\n                        throw new ProfileNotFound(item.profile);\n                    trigger = tmp.find(t => {\n                        return t.name === item.name || t.pattern === item.name;\n                    });\n                }\n                if (!trigger) {\n                    trigger = new Trigger();\n                    trigger.name = item.name;\n                    profile.triggers.push(trigger);\n                    this._echo('Event \\'' + trigger.name + '\\' added.', -7, -8, true, true);\n                    item.new = true;\n                }\n                else\n                    this._echo('Event \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\n                trigger.pattern = item.name;\n                if (item.commands !== null)\n                    trigger.value = item.commands;\n                trigger.type = TriggerType.Event;\n                if (item.options.prompt)\n                    trigger.triggerPrompt = true;\n                if (item.options.nocr)\n                    trigger.triggerNewline = false;\n                if (item.options.case)\n                    trigger.caseSensitive = true;\n                if (item.options.raw)\n                    trigger.raw = true;\n\n                if (item.options.verbatim)\n                    trigger.verbatim = true;\n                if (item.options.disable)\n                    trigger.enabled = false;\n                else if (item.options.enable)\n                    trigger.enabled = true;\n                if (item.options.temporary || item.options.temp)\n                    trigger.temp = true;\n                trigger.priority = item.options.priority;\n                this.client.saveProfiles();\n                this.client.clearCache();\n                if (item.new)\n                    this.emit('item-added', 'trigger', profile.name, profile.triggers.length - 1, trigger);\n                else\n                    this.emit('item-updated', 'trigger', profile.name, profile.triggers.indexOf(trigger), trigger);\n                profile = null;\n                //#endregion\n                return null;\n            case 'unevent':\n            case 'une':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region unevent\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent name or \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                else {\n                    profile = this._processCommandItemArgs(args, 'Invalid syntax use \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent name or \\x1b[4m' + cmdChar + 'une\\x1b[0;-11;-12mvent {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                    n = profile.results;\n                    profile = profile.profile;\n                    items = SortItemArrayByPriority(profile.triggers.filter(t => t.type === TriggerType.Event));\n                    n = this.stripQuotes(n);\n                    tmp = n;\n                    n = items.findIndex(i => i.pattern === n || i.name === n);\n                    f = n !== -1;\n                    if (!f)\n                        this._echo('Event \\'' + tmp + '\\' not found.', -7, -8, true, true);\n                    else {\n                        this._echo('Event \\'' + (items[n].name || items[n].pattern) + '\\' removed.', -7, -8, true, true);\n                        this.client.removeTrigger(items[n]);\n                        profile = null;\n                    }\n                }\n                //#endregion\n                return null;\n            case 'button':\n            case 'bu':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region button\n                //#button name caption {commands} {icon} options profile\n                //#button name|index\n                //Options: enable, disable, nosend, chain, append, stretch, priority=#\n                if (args.length === 1) {\n                    n = this.parseInline(this.stripQuotes(args[0]));\n                    items = document.getElementById('user-buttons').children;\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= items.length)\n                            throw new Error('Button index must be >= 0 and < ' + items.length);\n                        else\n                            items[n].click();\n                    }\n                    else if (items[n])\n                        items[n].click();\n                    else\n                        throw new Error(`Button '${n}' not found`);\n                    return null;\n                }\n                profile = null;\n                item = {\n                    profile: null,\n                    name: null,\n                    caption: null,\n                    commands: null,\n                    icon: null,\n                    options: { priority: 0 }\n                };\n                if (args.length < 2 || args.length > 5)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'bu\\x1b[0;-11;-12mtton name|index or \\x1b[4m' + cmdChar + 'bu\\x1b[0;-11;-12mtton name \\x1b[3mcaption\\x1b[0;-11;-12m {commands} \\x1b[3m{icon} options profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'by\\x1b[0;-11;-12mutton \\x1b[3mcaption\\x1b[0;-11;-12m {commands} \\x1b[3m{icon} {options} profile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new Error('Invalid button name, caption or commands');\n\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                    item.commands = args.shift();\n                    item.commands = item.commands.substr(1, item.commands.length - 2);\n                }\n                else {\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\n                    if (!item.name || item.name.length === 0)\n                        throw new Error('Invalid button name or caption');\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                        item.commands = args.shift();\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\n                    }\n                    else {\n                        item.caption = this.stripQuotes(args.shift());\n                        if (!args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            throw new Error('Missing commands');\n                    }\n                }\n\n                if (args.length !== 0) {\n                    if (args[0].match(/^\\{.*\\}$/g)) {\n                        item.icon = args.shift();\n                        item.icon = item.icon.substr(1, item.icon.length - 2);\n                    }\n                    if (args.length === 1) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        else\n                            args[0] = this.stripQuotes(args[0]);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nosend':\n                                    case 'chain':\n                                    case 'append':\n                                    case 'stretch':\n                                    case 'disable':\n                                    case 'enable':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new Error(`Invalid button priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new Error('Invalid button priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new Error(`Invalid button option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new Error('Invalid button options');\n                    }\n                    else if (args.length === 2) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nosend':\n                                    case 'chain':\n                                    case 'append':\n                                    case 'stretch':\n                                    case 'disable':\n                                    case 'enable':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new Error(`Invalid button priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new Error('Invalid button priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new Error(`Invalid button option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new Error('Invalid button options');\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                }\n                if (!item.profile || item.profile.length === 0) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        profile = this._profiles.items[keys[0]];\n                        if (item.name !== null)\n                            trigger = this._profiles.items[keys[k]].find('buttons', 'name', item.name);\n                        else\n                            trigger = this._profiles.items[keys[k]].find('buttons', 'caption', item.caption);\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            if (item.name !== null)\n                                trigger = this._profiles.items[keys[k]].find('buttons', 'name', item.name);\n                            else\n                                trigger = this._profiles.items[keys[k]].find('buttons', 'caption', item.caption);\n                            if (trigger) {\n                                profile = this._profiles.items[keys[k]];\n                                break;\n                            }\n                        }\n                        if (!profile)\n                            profile = this.client.activeProfile;\n                    }\n                }\n                else {\n                    if (this._profiles.contains(item.profile))\n                        profile = this._profiles.items[item.profile.toLowerCase()];\n                    else\n                        throw new ProfileNotFound(item.profile);\n                    if (item.name !== null)\n                        trigger = profile.find('buttons', 'name', item.name);\n                    else\n                        trigger = profile.find('buttons', 'caption', item.caption);\n                }\n                if (!trigger) {\n                    trigger = new Button();\n                    trigger.name = item.name || '';\n                    trigger.caption = item.caption || '';\n                    profile.buttons.push(trigger);\n                    if (!item.name && !item.caption)\n                        this._echo('Button added.', -7, -8, true, true);\n                    else\n                        this._echo('Button \\'' + (trigger.name || trigger.caption || '') + '\\' added.', -7, -8, true, true);\n                    item.new = true;\n                }\n                else\n                    this._echo('Button \\'' + (trigger.name || trigger.caption || '') + '\\' updated.', -7, -8, true, true);\n                if (item.caption !== null)\n                    trigger.caption = item.caption;\n                if (item.commands !== null)\n                    trigger.value = item.commands;\n\n                if (item.options.icon)\n                    trigger.icon = item.options.icon;\n                if (item.options.nosend)\n                    trigger.send = false;\n                if (item.options.chain)\n                    trigger.chain = true;\n                if (item.options.append)\n                    trigger.append = true;\n                if (item.options.stretch)\n                    trigger.stretch = true;\n                if (item.options.disable)\n                    trigger.enabled = false;\n                else if (item.options.enable)\n                    trigger.enabled = true;\n                trigger.priority = item.options.priority;\n                this.client.saveProfiles();\n                this.client.clearCache();\n                if (item.new)\n                    this.emit('item-added', 'button', profile.name, profile.buttons.length - 1, trigger);\n                else\n                    this.emit('item-updated', 'button', profile.name, profile.buttons.indexOf(trigger), trigger);\n                profile = null;\n                //#endregion\n                return null;\n            case 'unbutton':\n            case 'unb':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region unbutton\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton name or \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                else {\n                    profile = this._processCommandItemArgs(args, 'Invalid syntax use \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton name or \\x1b[4m' + cmdChar + 'unb\\x1b[0;-11;-12mtton {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                    n = profile.results;\n                    profile = profile.profile;\n                    items = SortItemArrayByPriority(profile.buttons);\n                    tmp = n;\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= items.length)\n                            throw new Error('Button index must be >= 0 and < ' + items.length);\n                        f = true;\n                    }\n                    else {\n                        n = this.stripQuotes(n);\n                        n = items.findIndex(i => i.name === n || i.caption === n);\n                        f = n !== -1;\n                    }\n                    if (!f)\n                        this._echo('Button \\'' + tmp + '\\' not found.', -7, -8, true, true);\n                    else {\n                        if (items[n].name.length === 0 && items[n].caption.length === 0)\n                            this._echo('Button \\'' + tmp + '\\' removed.', -7, -8, true, true);\n                        else\n                            this._echo('Button \\'' + (items[n].name || items[n].caption) + '\\' removed.', -7, -8, true, true);\n                        trigger = items[n];\n                        n = profile.buttons.indexOf(items[n]);\n                        profile.buttons.splice(n, 1);\n                        this.client.saveProfiles();\n                        this.client.clearCache();\n                        this.emit('item-removed', 'button', profile.name, n, trigger);\n                        profile = null;\n                    }\n                }\n                //#endregion\n                return null;\n            case 'alarm':\n            case 'ala':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region alarm\n                //spell-checker:ignore timepattern\n                profile = null;\n                name = null;\n                n = false;\n                if (args.length < 2 || args.length > 4)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm name {timepattern} {commands} \\x1b[3mprofile\\x1b[0;-11;-12m, \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm name {timepattern} \\x1b[3mprofile\\x1b[0;-11;-12m, or \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm {timepattern} {commands} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new Error('Invalid name or timepattern');\n                //{pattern} {commands} profile\n                if (args[0].match(/^\\{.*\\}$/g)) {\n                    if (args.length > 3)\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ala\\x1b[0;-11;-12mrm {timepattern} {commands} profile');\n                    args[0] = args[0].substr(1, args[0].length - 2);\n                    args[0] = this.parseInline(args[0]);\n                    if (args[1].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[1] = args[1].substr(1, args[1].length - 2);\n                    if (args.length === 3) {\n                        profile = this.stripQuotes(args[2]);\n                        profile = this.parseInline(profile);\n                    }\n\n                    if (!profile || profile.length === 0)\n                        profile = this.client.activeProfile;\n                    else {\n                        if (this._profiles.contains(profile))\n                            profile = this._profiles.items[profile.toLowerCase()];\n                        else\n                            throw new ProfileNotFound(profile);\n                    }\n                    trigger = new Trigger();\n                    trigger.pattern = args[0];\n                    trigger.value = args[1];\n                    trigger.type = TriggerType.Alarm;\n                    profile.triggers.push(trigger);\n                    this.client.saveProfiles();\n                    this.client.clearCache();\n                    this._lastSuspend = -1;\n                    this.client.updateAlarms();\n                    this._echo('Alarm \\'' + trigger.pattern + '\\' added.', -7, -8, true, true);\n                    this.emit('item-added', 'trigger', profile.name, profile.triggers.length - 1, trigger);\n                    profile = null;\n                    return null;\n                }\n                name = this.stripQuotes(args[0]);\n                if (!name || name.length === 0)\n                    throw new Error('Invalid alarm name');\n                name = this.parseInline(name);\n                let pattern = args[1];\n                let commands = null;\n                if (pattern.match(/^\\{.*\\}$/g))\n                    pattern = pattern.substr(1, pattern.length - 2);\n                pattern = this.parseInline(pattern);\n                if (args.length === 3) {\n                    if (args[2].match(/^\\{[\\s\\S]*\\}$/g))\n                        commands = args[2].substr(1, args[2].length - 2);\n                    else\n                        profile = this.stripQuotes(args[2]);\n                }\n                else if (args.length === 4) {\n                    commands = args[2];\n                    profile = this.stripQuotes(args[3]);\n                    if (commands.match(/^\\{[\\s\\S]*\\}$/g))\n                        commands = commands.substr(1, commands.length - 2);\n                }\n                if (!profile || profile.length === 0) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        profile = this._profiles.items[keys[0]];\n                        trigger = profile.find('triggers', 'name', name);\n                        if (!trigger && !commands)\n                            throw new Error('Alarm not found!');\n                        else if (!trigger) {\n                            trigger = new Trigger();\n                            trigger.name = name;\n                            profile.triggers.push(trigger);\n                            this._echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\n                            n = true;\n                        }\n                        else\n                            this._echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            trigger = this._profiles.items[keys[k]].find('triggers', 'name', name);\n                            if (trigger) {\n                                profile = this._profiles.items[keys[k]];\n                                break;\n                            }\n                        }\n                        if (!profile && !commands)\n                            throw new Error('Alarm not found!');\n                        if (!profile)\n                            profile = this.client.activeProfile;\n                        if (!trigger) {\n                            trigger = new Trigger();\n                            n = true;\n                            trigger.name = name;\n                            profile.triggers.push(trigger);\n                            this._echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\n                        }\n                        else\n                            this._echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\n                    }\n                }\n                else {\n                    profile = this.parseInline(profile);\n                    if (this._profiles.contains(profile))\n                        profile = this._profiles.items[profile.toLowerCase()];\n                    else\n                        throw new ProfileNotFound(profile);\n                    trigger = profile.find('triggers', 'name', name);\n                    if (!trigger && !commands)\n                        throw new Error('Alarm not found!');\n                    else if (!trigger) {\n                        trigger = new Trigger();\n                        trigger.name = name;\n                        profile.triggers.push(trigger);\n                        n = true;\n                        this._echo('Alarm \\'' + trigger.name + '\\' added.', -7, -8, true, true);\n                    }\n                    else\n                        this._echo('Alarm \\'' + trigger.name + '\\' updated.', -7, -8, true, true);\n                }\n                trigger.pattern = pattern;\n                trigger.type = TriggerType.Alarm;\n                if (commands)\n                    trigger.value = commands;\n                this.client.saveProfiles();\n                this.client.clearCache();\n                if (n)\n                    this.emit('item-added', 'trigger', profile.name, profile.triggers.length - 1, trigger);\n                else\n                    this.emit('item-updated', 'trigger', profile.name, profile.triggers.indexOf(trigger), trigger);\n                profile = null;\n                this._lastSuspend = -1;\n                this.client.updateAlarms();\n                //#endregion\n                return null;\n            case 'ungag':\n            case 'ung':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length > 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ung\\x1b[0;-11;-12mag number or \\x1b[4m' + cmdChar + 'ung\\x1b[0;-11;-12mag');\n                if (this._gagID.length) {\n                    clearTimeout(this._gagID.pop());\n                    this._gags.pop();\n                }\n                this._gag = 0;\n                return null;\n            case 'gag':\n            case 'ga':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region gag\n                if (args.length === 0) {\n                    //if one exist for this line remove it and replace it with new one\n                    if (this._gags.length && this._gags[this._gags.length - 1] == this.client.display.lines.length) {\n                        this._gag = 0;\n                        this._gags.pop();\n                    }\n                    this._gags.push(this.client.display.lines.length);\n                    this._gagID.push(setTimeout(() => {\n                        n = this.adjustLastLine(this._gags.pop());\n                        if (this._gags.length) {\n                            let gl = this._gags.length;\n                            while (gl >= 0) {\n                                gl--;\n                                if (this._gags[gl] > n)\n                                    this._gags[gl]--;\n                            }\n                        }\n                        this.client.display.removeLine(n);\n                    }, 0));\n                    this._gag = 0;\n                    return null;\n                }\n                else if (args.length > 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ga\\x1b[0;-11;-12mg number or \\x1b[4m' + cmdChar + 'ga\\x1b[0;-11;-12mg');\n                i = parseInt(args[0], 10);\n                if (isNaN(i))\n                    throw new Error('Invalid number \\'' + args[0] + '\\'');\n                //if one exist for this line remove it and replace it with new one\n                if (this._gags.length && this._gags[this._gags.length - 1] == this.client.display.lines.length) {\n                    this._gag = 0;\n                    this._gags.pop();\n                }\n                this._gags.push(this.client.display.lines.length);\n                if (i >= 0) {\n                    this._gagID.push(setTimeout(() => {\n                        n = this.adjustLastLine(this._gags.pop());\n                        if (this._gags.length) {\n                            let gl = this._gags.length;\n                            while (gl >= 0) {\n                                gl--;\n                                if (this._gags[gl] > n)\n                                    this._gags[gl]--;\n                            }\n                        }\n                        this.client.display.removeLine(n);\n                        this._gag = i;\n                    }, 0));\n                    this._gag = 0;\n                }\n                else {\n                    this._gagID.push(setTimeout(() => {\n                        n = this.adjustLastLine(this._gags.pop());\n                        i *= -1;\n                        if (i > this.client.display.lines.length)\n                            i = this.client.display.lines.length;\n                        this.client.display.removeLines(n - i, i);\n                        this._gag = 0;\n                    }, 0));\n                    this._gag = 0;\n                }\n                //#endregion gag\n                return null;\n            case 'wait':\n            case 'wa':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //filter out empty arguments to avoid trailing spaces\n                args = args.filter(a => a);\n                if (args.length === 0 || args.length > 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wa\\x1b[0;-11;-12mit number');\n                i = parseInt(this.parseInline(args[0]), 10);\n                if (isNaN(i))\n                    throw new Error('Invalid number \\'' + i + '\\' for wait');\n                if (i < 1)\n                    throw new Error('Must be greater then zero for wait');\n                return i;\n            case 'showclient':\n            case 'showcl':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.show();\n                return null;\n            case 'hideclient':\n            case 'hidecl':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.hide();\n                return null;\n            case 'toggleclient':\n            case 'togglecl':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.toggle();\n                return null;\n            case 'raiseevent':\n            case 'raise':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (this._getOption('parseDoubleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\\"/g, '\"');\n                        });\n                    });\n                if (this._getOption('parseSingleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\'/g, '\\'');\n                        });\n                    });\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + '\\x1b[4mraise\\x1b[0;-11;-12mevent name or ' + cmdChar + '\\x1b[4mraise\\x1b[0;-11;-12mevent name arguments');\n                else if (args.length === 1)\n                    this.client.raise(args[0]);\n                else\n                    this.client.raise(args[0], args.slice(1));\n                return null;\n            case 'cl':\n            case 'close':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (this._getOption('parseDoubleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\\"/g, '\"');\n                        });\n                    });\n                if (this._getOption('parseSingleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\'/g, '\\'');\n                        });\n                    });\n                if (args.length > 2)\n                    throw new Error('Invalid syntax use ' + cmdChar + '\\x1b[4mcl\\x1b[0;-11;-12mose');\n                else if (args.length === 0)\n                    (<any>this.client).closeWindow();\n                else\n                    (<any>this.client).closeWindow(this.stripQuotes(this.parseInline(args[0])));\n                return null;\n            case 'window':\n            case 'win':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (this._getOption('parseDoubleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\\"/g, '\"');\n                        });\n                    });\n                if (this._getOption('parseSingleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\'/g, '\\'');\n                        });\n                    });\n                if (args.length === 0 || args.length > 3)\n                    throw new Error('Invalid syntax use ' + cmdChar + '\\x1b[4mwin\\x1b[0;-11;-12mdow name \\x1b[3mclose\\x1b[0;-11;-12m or ' + cmdChar + '\\x1b[4mwin\\x1b[0;-11;-12mdow new \\x1b[3mcharacter\\x1b[0;-11;-12m');\n                else if (args.length === 3)\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])), this.stripQuotes(this.parseInline(args[1])), this.stripQuotes(this.parseInline(args.slice(2).join(' '))));\n                else if (args.length === 1)\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])));\n                else\n                    this.client.emit('window', this.stripQuotes(this.parseInline(args[0])), this.stripQuotes(this.parseInline(args.slice(1).join(' '))));\n                return null;\n            case 'raisedelayed':\n            case 'raisede':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'raisede\\x1b[0;-11;-12mlayed milliseconds name or \\x1b[4m' + cmdChar + 'raisede\\x1b[0;-11;-12mlayed milliseconds name arguments');\n                i = parseInt(this.stripQuotes(this.parseInline(args[0])), 10);\n                if (isNaN(i))\n                    throw new Error('Invalid number \\'' + args[0] + '\\' for raisedelayed');\n                if (i < 1)\n                    throw new Error('Must be greater then zero for raisedelayed');\n                args.shift();\n                if (this._getOption('parseDoubleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\\"/g, '\"');\n                        });\n                    });\n                if (this._getOption('parseSingleQuotes'))\n                    args.forEach((a) => {\n                        return a.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\n                            return e.replace(/\\\\\\'/g, '\\'');\n                        });\n                    });\n\n                if (args.length === 1)\n                    this.client.raise(args[0], 0, i);\n                else\n                    this.client.raise(args[0], args.slice(1), i);\n                return null;\n            case 'notify':\n            case 'not':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'not\\x1b[0;-11;-12mify title \\x1b[3mmessage icon\\x1b[0;-11;-12m');\n                else {\n                    args[0] = this.stripQuotes(args[0]);\n                    if (args[args.length - 1].match(/^\\{.*\\}$/g)) {\n                        item = args.pop();\n                        n = { icon: this.parseInline(item.substr(1, item.length - 2)) };\n                    }\n                    if (args.length === 0)\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'not\\x1b[0;-11;-12mify title \\x1b[3mmessage icon\\x1b[0;-11;-12m');\n                    if (args.length === 1)\n                        this.client.notify(this.parseInline(this.stripQuotes(args[0])), null, n);\n                    else\n                        this.client.notify(this.parseInline(this.stripQuotes(args[0])), this.parseInline(args.slice(1).join(' ')), n);\n                }\n                return null;\n            case 'idle':\n            case 'idletime':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (!this.client.lastSendTime)\n                    this._echo('Not connected', -7, -8, true, true);\n                else\n                    this._echo('You have been idle: ' + getTimeSpan(Date.now() - this.client.lastSendTime), -7, -8, true, true);\n                return null;\n            case 'connect':\n            case 'connecttime':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (!this.client.connectTime) {\n                    if (!moment && this.client.disconnectTime)\n                        this._echo('Disconnected since: ' + (new Date(this.client.disconnectTime).toLocaleString()), -7, -8, true, true);\n                    else if (this.client.disconnectTime)\n                        this._echo('Disconnected since: ' + new moment(this.client.disconnectTime).format('MM/DD/YYYY hh:mm:ss A'), -7, -8, true, true);\n                    else\n                        this._echo('Not connected', -7, -8, true, true);\n                }\n                else\n                    this._echo('You have been connected: ' + getTimeSpan(Date.now() - this.client.connectTime), -7, -8, true, true);\n                return null;\n            case 'beep':\n            case 'be':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.beep();\n                return null;\n            case 'version':\n            case 've':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this._echo(this.client.telnet.terminal + ' v' + this.client.version, -7, -8, true, true);\n                return null;\n            case 'showprompt':\n            case 'showp':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                args = this.parseInline(args.join(' '));\n                this.client.telnet.receivedData(StringToUint8Array(args), true, true);\n                this.client.telnet.prompt = true;\n                return null;\n            case 'show':\n            case 'sh':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                args = this.parseInline(args.join(' ') + '\\n');\n                this.client.telnet.receivedData(StringToUint8Array(args), true, true);\n                return null;\n            case 'sayprompt':\n            case 'sayp':\n            case 'echoprompt':\n            case 'echop':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                args = this.parseInline(args.join(' '));\n                this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m', false);\n                return null;\n            case 'say':\n            case 'sa':\n            case 'echo':\n            case 'ec':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                args = this.parseInline(args.join(' '));\n                if (this.client.telnet.prompt)\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                else\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                this.client.telnet.prompt = false;\n                return null;\n            case 'print':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                i = this.client.enableTriggers;\n                this.client.enableTriggers = false;\n                args = this.parseInline(args.join(' '));\n                if (this.client.telnet.prompt)\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                else\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                this.client.telnet.prompt = false;\n                this.client.enableTriggers = i;\n                return null;\n            case 'printprompt':\n            case 'printp':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                i = this.client.enableTriggers;\n                this.client.enableTriggers = false;\n                args = this.parseInline(args.join(' '));\n                this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m', false);\n                this.client.enableTriggers = i;\n                return null;\n            case 'alias':\n            case 'al':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name value or \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name {value} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                else if (args.length === 1)\n                    throw new Error('Must supply an alias value');\n                else {\n                    n = this.parseInline(this.stripQuotes(args.shift()));\n                    profile = this._processCommandItemArgs(args, 'Invalid syntax use \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name value or \\x1b[4m' + cmdChar + 'al\\x1b[0;-11;-12mias name {value} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                    args = profile.results;\n                    profile = profile.profile;\n                    items = profile.aliases;\n                    args = this.stripQuotes(args);\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= items.length)\n                            throw new Error('Alias index must be >= 0 and < ' + items.length);\n                        else {\n                            items[n].value = args;\n                            this._echo('Alias \\'' + items[n].pattern + '\\' updated.', -7, -8, true, true);\n                        }\n                    }\n                    else {\n                        for (i = 0, al = items.length; i < al; i++) {\n                            if (items[i]['pattern'] === n) {\n                                items[i].value = args;\n                                this._echo('Alias \\'' + n + '\\' updated.', -7, -8, true, true);\n                                this.emit('item-updated', 'alias', profile.name, i, tmp);\n                                f = true;\n                                break;\n                            }\n                        }\n                        if (!f) {\n                            tmp = new Alias(n, args);\n                            items.push(tmp);\n                            this.emit('item-added', 'alias', profile.name, items.length - 1, tmp);\n                            this._echo('Alias \\'' + n + '\\' added.', -7, -8, true, true);\n                        }\n                    }\n                    profile.aliases = items;\n                    this.client.saveProfiles();\n                    this.client.clearCache();\n                    profile = null;\n                }\n                return null;\n            case 'unalias':\n            case 'una':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias name or \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                else {\n                    profile = this._processCommandItemArgs(args, 'Invalid syntax use \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias name or \\x1b[4m' + cmdChar + 'una\\x1b[0;-11;-12mlias {name} \\x1b[3mprofile\\x1b[0;-11;-12m');\n                    n = profile.results;\n                    profile = profile.profile;\n                    items = profile.aliases;\n                    n = this.stripQuotes(n);\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        tmp = n;\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= items.length)\n                            throw new Error('Alias index must be >= 0 and < ' + items.length);\n                        else\n                            f = true;\n                    }\n                    else {\n                        tmp = n;\n                        n = items.findIndex(i => i.pattern === n);\n                        f = n !== -1;\n                    }\n                    if (!f)\n                        this._echo('Alias \\'' + tmp + '\\' not found.', -7, -8, true, true);\n                    else {\n                        this._echo('Alias \\'' + items[n].pattern + '\\' removed.', -7, -8, true, true);\n                        trigger = items[n];\n                        items.splice(n, 1);\n                        profile.aliases = items;\n                        this.client.saveProfiles();\n                        this.client.clearCache();\n                        this.emit('item-removed', 'alias', profile.name, n, trigger);\n                        profile = null;\n                    }\n                }\n                return null;\n            case 'setsetting':\n            case 'sets':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sets\\x1b[0;-11;-12metting name value');\n                else if (args.length === 1)\n                    throw new Error('Must supply a setsetting value');\n                else {\n                    n = this.stripQuotes(this.parseInline(args[0]));\n                    args = this.stripQuotes(this.parseInline(args.slice(1).join(' ')));\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        tmp = n;\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= SettingList.length)\n                            throw new Error('Setting index must be >= 0 and < ' + SettingList.length);\n                        f = true;\n                    }\n                    else {\n                        n = n.toLowerCase();\n                        for (i = 0, al = SettingList.length; i < al; i++) {\n                            if (SettingList[i][0].toLowerCase() === n) {\n                                n = i;\n                                f = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (!f)\n                        throw new Error('Unknown setting \\'' + tmp + '\\'');\n                    else {\n                        switch (SettingList[n][2]) {\n                            case 0:\n                                if (SettingList[n][4] > 0 && args.length > SettingList[n][4])\n                                    throw new Error('String can not be longer then ' + SettingList[n][4] + ' characters');\n                                else {\n                                    this.client.setOption(SettingList[n][1] || SettingList[n][0], args);\n                                    this._echo('Setting \\'' + SettingList[n][0] + '\\' set to \\'' + args + '\\'.', -7, -8, true, true);\n                                    this.client.loadOptions();\n                                }\n                                break;\n                            case 1:\n                            case 3:\n                                switch (args.toLowerCase()) {\n                                    case 'true':\n                                    case '1':\n                                    case 'yes':\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], true);\n                                        this._echo('Setting \\'' + SettingList[n][0] + '\\' set to true.', -7, -8, true, true);\n                                        this.client.loadOptions();\n                                        break;\n                                    case 'no':\n                                    case 'false':\n                                    case '0':\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], false);\n                                        this._echo('Setting \\'' + SettingList[n][0] + '\\' set to false.', -7, -8, true, true);\n                                        this.client.loadOptions();\n                                        break;\n                                    case 'toggle':\n                                        args = this._getOption(SettingList[n][1] || SettingList[n][0]) ? false : true;\n                                        this.client.setOption(SettingList[n][1] || SettingList[n][0], args);\n                                        this._echo('Setting \\'' + SettingList[n][0] + '\\' set to ' + args + '.', -7, -8, true, true);\n                                        this.client.loadOptions();\n                                        break;\n                                    default:\n                                        throw new Error('Invalid value, must be true or false');\n                                }\n                                break;\n                            case 2:\n                                i = parseInt(args, 10);\n                                if (isNaN(i))\n                                    throw new Error('Invalid number \\'' + args + '\\'');\n                                else {\n                                    this.client.setOption(SettingList[n][1] || SettingList[n][0], i);\n                                    this._echo('Setting \\'' + SettingList[n][0] + '\\' set to \\'' + i + '\\'.', -7, -8, true, true);\n                                    this.client.loadOptions();\n                                }\n                                break;\n                            case 4:\n                            case 5:\n                                throw new Error('Unsupported setting \\'' + n + '\\'');\n                        }\n                    }\n                }\n                return null;\n            case 'getsetting':\n            case 'gets':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'gets\\x1b[0;-11;-12metting name');\n                else {\n                    n = this.stripQuotes(this.parseInline(args.join(' ')));\n                    if (/^\\s*?\\d+\\s*?$/.exec(n)) {\n                        n = parseInt(n, 10);\n                        if (n < 0 || n >= SettingList.length)\n                            throw new Error('Setting index must be >= 0 and < ' + SettingList.length);\n                        else\n                            f = true;\n                    }\n                    else {\n\n                        tmp = n;\n                        n = n.toLowerCase();\n                        if (n !== 'all') {\n                            for (i = 0, al = SettingList.length; i < al; i++) {\n                                if (SettingList[i][0].toLowerCase() === n) {\n                                    n = i;\n                                    f = true;\n                                    break;\n                                }\n                            }\n                        }\n                        if (n === 'all') {\n                            tmp = 'Current settings:\\n';\n                            //this._echo('Current settings:', -7, -8, true, true);\n                            for (i = 0, al = SettingList.length; i < al; i++) {\n                                switch (SettingList[i][2]) {\n                                    case 0:\n                                    case 2:\n                                        //this._echo('    '+_SettingList[i][0]+': '+getSetting(_SettingList[i][0]), -7, -8, true, true);\n                                        tmp += '    ' + SettingList[i][0] + ': ' + this._getOption(SettingList[n][1] || SettingList[n][0]) + '\\n';\n                                        break;\n                                    case 1:\n                                    case 3:\n                                        if (this._getOption(SettingList[n][1] || SettingList[n][0]))\n                                            tmp += '    ' + SettingList[i][0] + ': true\\n';\n                                        //this._echo('    '+_SettingList[i][0]+': true', -7, -8, true, true);\n                                        else\n                                            tmp += '    ' + SettingList[i][0] + ': false\\n';\n                                        //this._echo('    '+_SettingList[i][0]+': false', -7, -8, true, true);\n                                        break;\n                                }\n                            }\n                            this._echo(tmp, -7, -8, true, true);\n                        }\n                        else if (!f)\n                            throw new Error('Unknown setting \\'' + n + '\\'');\n                        else {\n                            switch (SettingList[n][2]) {\n                                case 0:\n                                case 2:\n                                    this._echo('Setting \\'' + SettingList[n][0] + '\\' is \\'' + this._getOption(SettingList[n][1] || SettingList[n][0]) + '\\'', -7, -8, true, true);\n                                    break;\n                                case 1:\n                                case 3:\n                                    if (this._getOption(SettingList[n][1] || SettingList[n][0]))\n                                        this._echo('Setting \\'' + SettingList[n][0] + '\\' is true', -7, -8, true, true);\n                                    else\n                                        this._echo('Setting \\'' + SettingList[n][0] + '\\' is false', -7, -8, true, true);\n                                    break;\n                            }\n                        }\n                    }\n                }\n                return null;\n            case 'profilelist':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this._echo('\\x1b[4mProfiles:\\x1b[0m', -7, -8, true, true);\n                const files = this._profiles.keys;\n                al = files.length;\n                for (i = 0; i < al; i++) {\n                    if (this._profiles.items[files[i]] && this._profiles.items[files[i]].enabled)\n                        this._echo('   ' + this._profiles.keys[i] + ' is enabled', -7, -8, true, true);\n                    else\n                        this._echo('   ' + files[i] + ' is disabled', -7, -8, true, true);\n                }\n                return null;\n            case 'profile':\n            case 'pro':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\n                else if (args.length === 1) {\n                    args[0] = this.parseInline(args[0]);\n                    this.client.toggleProfile(args[0]);\n                    if (!this._profiles.contains(args[0]))\n                        throw new ProfileNotFound(args[0]);\n                    else if (this._profiles.length === 1)\n                        throw new Error(args[0] + ' can not be disabled as it is the only one enabled');\n                    if (!this._profiles.contains(args[0].toLowerCase()))\n                        args = 'Profile not found';\n                    else if (this._profiles.items[args[0].toLowerCase()].enabled)\n                        args = args[0] + ' is enabled';\n                    else\n                        args = args[0] + ' is disabled';\n                }\n                else {\n                    args[0] = this.parseInline(args[0]).toLowerCase();\n                    if (!this._profiles.contains(args[0]))\n                        throw new ProfileNotFound(args[0]);\n                    if (!args[1])\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\n                    args[1] = this.parseInline(args[1]);\n                    switch (args[1].toLowerCase()) {\n                        case 'enable':\n                        case 'on':\n                        case 'yes':\n                            if (this._profiles.items[args[0].toLowerCase()].enabled)\n                                args = args[0] + ' is already enabled';\n                            else {\n                                this.client.toggleProfile(args[0]);\n                                if (this._profiles.items[args[0].toLowerCase()].enabled !== -1)\n                                    args = args[0] + ' is enabled';\n                                else\n                                    args = args[0] + ' remains disabled';\n                            }\n                            break;\n                        case 'disable':\n                        case 'off':\n                        case 'no':\n                            if (!this._profiles.items[args[0].toLowerCase()].enabled)\n                                args = args[0] + ' is already disabled';\n                            else {\n                                if (this._profiles.length === 1)\n                                    throw new Error(args[0] + ' can not be disabled as it is the only one enabled');\n                                this.client.toggleProfile(args[0]);\n                                args = args[0] + ' is disabled';\n                            }\n                            break;\n                        default:\n                            throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name or \\x1b[4m' + cmdChar + 'pro\\x1b[0;-11;-12mfile name enable/disable');\n                    }\n                }\n                if (this.client.telnet.prompt)\n                    this.client.print('\\n\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                else\n                    this.client.print('\\x1b[-7;-8m' + args + '\\x1b[0m\\n', false);\n                this.client.telnet.prompt = false;\n                return null;\n            case 'color':\n            case 'co':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length > 1 && args.length < 4) {\n                    item = {\n                        profile: null,\n                        pattern: null,\n                        commands: null\n                    };\n                    item.pattern = args.shift();\n                    if (item.pattern.match(/^\\{.*\\}$/g))\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    else\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\n                    if (args.length === 2) {\n                        item.commands = cmdChar + 'COLOR ' + this.parseInline(args[0]);\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                    else\n                        item.commands = cmdChar + 'COLOR ' + this.parseInline(args[0]);\n                    this.createTrigger(item.pattern, item.commands, item.profile);\n                    return null;\n                }\n                else if (args.length !== 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor color or \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\n                if (args.length !== 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor color or \\x1b[4m' + cmdChar + 'co\\x1b[0;-11;-12mlor {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\n                n = this.client.display.lines.length;\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\n                    setTimeout(() => {\n                        n = this.adjustLastLine(n);\n                        this.client.display.colorSubStrByLine(n, parseInt(args[0], 10));\n                    }, 0);\n                }\n                //back,fore from color function\n                else if (args[0].trim().match(/^[-|+]?\\d+\\s*?,\\s*?[-|+]?\\d+$/g)) {\n                    args[0] = args[0].split(',');\n                    setTimeout(() => {\n                        n = this.adjustLastLine(n);\n                        this.client.display.colorSubStrByLine(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10));\n                    }, 0);\n                }\n                else {\n                    args = args[0].toLowerCase().split(',');\n                    if (args.length === 1) {\n                        if (args[0] === 'bold')\n                            i = 370;\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            n = this.adjustLastLine(n);\n                            this.client.display.colorSubStrByLine(n, i);\n                        }, 0);\n                    }\n                    else if (args.length === 2) {\n                        if (args[0] === 'bold' && args[1] === 'bold')\n                            throw new InvalidForeColorError();\n                        if (args[0] === 'bold')\n                            i = 370;\n                        else if (args[0] === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[1] === 'bold') {\n                            setTimeout(() => {\n                                n = this.adjustLastLine(n);\n                                if (i === 370)\n                                    this.client.display.colorSubStrByLine(n, i);\n                                else\n                                    this.client.display.colorSubStrByLine(n, i * 10);\n                            }, 0);\n                        }\n                        else {\n                            p = i;\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                                i = args[1].trim();\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                                i = parseInt(args[1].trim(), 10);\n                            else {\n                                i = getAnsiColorCode(args[1], true);\n                                if (i === -1) {\n                                    if (isMXPColor(args[1]))\n                                        i = args[1];\n                                    else\n                                        throw new InvalidBackColorError();\n                                }\n                            }\n                            setTimeout(() => {\n                                n = this.adjustLastLine(n);\n                                this.client.display.colorSubStrByLine(n, p, i);\n                            }, 0);\n                        }\n                    }\n                    else if (args.length === 3) {\n                        if (args[0] === 'bold') {\n                            args.shift();\n                            args.push('bold');\n                        }\n                        if (args[0].trim() === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[2] !== 'bold')\n                            throw new Error('Only bold is supported as third argument');\n                        else if (!i)\n                            i = 370;\n                        else\n                            p = i * 10;\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[1].trim();\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[1].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[1], true);\n                            if (i === -1) {\n                                if (isMXPColor(args[1]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidBackColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            n = this.adjustLastLine(n);\n                            this.client.display.colorSubStrByLine(n, p, i);\n                        }, 0);\n                    }\n                }\n                return null;\n            case 'cw':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                trigger = this.stack.regex;\n                if (args.length > 1 && args.length < 4) {\n                    item = {\n                        profile: null,\n                        pattern: null,\n                        commands: null\n                    };\n                    item.pattern = args.shift();\n                    if (item.pattern.match(/^\\{.*\\}$/g))\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    else\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\n                    if (args.length === 2) {\n                        item.commands = cmdChar + 'CW ' + this.parseInline(args[0]);\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                    else\n                        item.commands = cmdChar + 'CW ' + this.parseInline(args[0]);\n                    this.createTrigger(item.pattern, item.commands, item.profile);\n                    return null;\n                }\n                else if (args.length !== 1)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'cw color or ' + cmdChar + 'cw {pattern} color \\x1b[3mprofile\\x1b[0;-11;-12m');\n                //no regex so\n                if (!trigger) return null;\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\n                n = this.client.display.lines.length;\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\n                    setTimeout(() => {\n                        n = this.adjustLastLine(n);\n                        //verbatim so color whole line\n                        if (trigger.length === 1)\n                            this.client.display.colorSubStrByLine(n, parseInt(args[0], 10));\n                        else {\n                            trigger[1].lastIndex = 0;\n                            tmp = trigger[0].matchAll(trigger[1]);\n                            for (const match of tmp) {\n                                this.client.display.colorSubStrByLine(n, parseInt(args[0], 10), null, match.index, match[0].length);\n                            }\n                        }\n                    }, 0);\n                }\n                //back,fore from color function\n                else if (args[0].trim().match(/^[-|+]?\\d+,[-|+]?\\d+$/g)) {\n                    args[0] = args[0].split(',');\n                    setTimeout(() => {\n                        n = this.adjustLastLine(n);\n                        //verbatim so color whole line\n                        if (trigger.length === 1)\n                            this.client.display.colorSubStrByLine(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10));\n                        else {\n                            trigger[1].lastIndex = 0;\n                            tmp = trigger[0].matchAll(trigger[1]);\n                            for (const match of tmp) {\n                                this.client.display.colorSubStrByLine(n, parseInt(args[0], 10), parseInt(args[0][1], 10), match.index, match[0].length);\n                            }\n                        }\n                    }, 0);\n                }\n                else {\n                    args = args[0].toLowerCase().split(',');\n                    if (args.length === 1) {\n                        if (args[0] === 'bold')\n                            i = 370;\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            n = this.adjustLastLine(n);\n                            //verbatim so color whole line\n                            if (trigger.length === 1)\n                                this.client.display.colorSubStrByLine(n, i);\n                            else {\n                                trigger[1].lastIndex = 0;\n                                tmp = trigger[0].matchAll(trigger[1]);\n                                for (const match of tmp) {\n                                    this.client.display.colorSubStrByLine(n, i, null, match.index, match[0].length);\n                                }\n                            }\n                        }, 0);\n                    }\n                    else if (args.length === 2) {\n                        if (args[0] === 'bold' && args[1] === 'bold')\n                            throw new InvalidForeColorError();\n                        if (args[0] === 'bold')\n                            i = 370;\n                        else if (args[0] === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[1] === 'bold') {\n                            setTimeout(() => {\n                                n = this.adjustLastLine(n);\n                                if (i !== 370)\n                                    i *= 10;\n                                //verbatim so color whole line\n                                if (trigger.length === 1)\n                                    this.client.display.colorSubStrByLine(n, i);\n                                else {\n                                    trigger[1].lastIndex = 0;\n                                    tmp = trigger[0].matchAll(trigger[1]);\n                                    for (const match of tmp) {\n                                        this.client.display.colorSubStrByLine(n, i, null, match.index, match[0].length);\n                                    }\n                                }\n                            }, 0);\n                        }\n                        else {\n                            p = i;\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                                i = args[1].trim();\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                                i = parseInt(args[1].trim(), 10);\n                            else {\n                                i = getAnsiColorCode(args[1], true);\n                                if (i === -1) {\n                                    if (isMXPColor(args[1]))\n                                        i = args[1];\n                                    else\n                                        throw new InvalidBackColorError();\n                                }\n                            }\n                            setTimeout(() => {\n                                n = this.adjustLastLine(n);\n                                //verbatim so color whole line\n                                if (trigger.length === 1)\n                                    this.client.display.colorSubStrByLine(n, p, i);\n                                else {\n                                    trigger[1].lastIndex = 0;\n                                    tmp = trigger[0].matchAll(trigger[1]);\n                                    for (const match of tmp) {\n                                        this.client.display.colorSubStrByLine(n, p, i, match.index, match[0].length);\n                                    }\n                                }\n                            }, 0);\n                        }\n                    }\n                    else if (args.length === 3) {\n                        if (args[0] === 'bold') {\n                            args.shift();\n                            args.push('bold');\n                        }\n                        if (args[0].trim() === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[2] !== 'bold')\n                            throw new Error('Only bold is supported as third argument');\n                        else if (!i)\n                            i = 370;\n                        else\n                            p = i * 10;\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[1].trim();\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[1].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[1], true);\n                            if (i === -1) {\n                                if (isMXPColor(args[1]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidBackColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            n = this.adjustLastLine(n);\n                            //verbatim so color whole line\n                            if (trigger.length === 1)\n                                this.client.display.colorSubStrByLine(n, p, i);\n                            else {\n                                trigger[1].lastIndex = 0;\n                                tmp = trigger[0].matchAll(trigger[1]);\n                                for (const match of tmp) {\n                                    this.client.display.colorSubStrByLine(n, p, i, match.index, match[0].length);\n                                }\n                            }\n                        }, 0);\n                    }\n                }\n                return null;\n            case 'pcol':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 1 || args.length > 5)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'pcol color \\x1b[3mXStart, XEnd, YStart, YEnd\\x1b[0;-11;-12m');\n                if (args.length > 1) {\n                    tmp = [].concat(...args.slice(1).map(s => this.parseInline(this.stripQuotes(s)).split(' ')));\n                    if (tmp.length > 4)\n                        throw new Error('Too many arguments use ' + cmdChar + 'pcol color \\x1b[3mXStart, XEnd, YStart, YEnd\\x1b[0;-11;-12m');\n                    item = { xStart: 0 };\n                    if (tmp.length > 0)\n                        item.xStart = parseInt(tmp[0], 10);\n                    if (tmp.length > 1)\n                        item.xEnd = parseInt(tmp[1], 10);\n                    if (tmp.length > 2)\n                        item.yStart = parseInt(tmp[2], 10);\n                    if (tmp.length > 3)\n                        item.yEnd = parseInt(tmp[3], 10);\n                    if (item.hasOwnProperty('yEnd') && item.yEnd > item.yStart)\n                        throw new Error('yEnd must be smaller or equal to yStart');\n                    if (item.hasOwnProperty('xEnd') && item.xEnd < item.xStart)\n                        throw new Error('xEnd must be larger or equal to xStart');\n                }\n                else\n                    item = { xStart: 0 };\n                args[0] = this.parseInline(this.stripQuotes(args[0]));\n                n = this.adjustLastLine(this.client.display.lines.length);\n                if (args[0].trim().match(/^[-|+]?\\d+$/g)) {\n                    setTimeout(() => {\n                        this._colorPosition(n, parseInt(args[0], 10), null, item);\n                    }, 0);\n                }\n                //back,fore from color function\n                else if (args[0].trim().match(/^[-|+]?\\d+\\s*?,\\s*?[-|+]?\\d+$/g)) {\n                    args[0] = args[0].split(',');\n                    setTimeout(() => {\n                        this._colorPosition(n, parseInt(args[0][0], 10), parseInt(args[0][1], 10), item);\n                    }, 0);\n                }\n                else {\n                    args = args[0].toLowerCase().split(',');\n                    if (args.length === 1) {\n                        if (args[0] === 'bold')\n                            i = 370;\n                        if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            this._colorPosition(n, i, null, item);\n                        }, 0);\n                    }\n                    else if (args.length === 2) {\n                        if (args[0] === 'bold' && args[1] === 'bold')\n                            throw new InvalidForeColorError();\n                        if (args[0] === 'bold')\n                            i = 370;\n                        else if (args[0] === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[1] === 'bold') {\n                            setTimeout(() => {\n                                this._colorPosition(n, i === 370 ? i : i * 10, null, item);\n                            }, 0);\n                        }\n                        else {\n                            p = i;\n                            if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                                i = args[1].trim();\n                            else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                                i = parseInt(args[1].trim(), 10);\n                            else {\n                                i = getAnsiColorCode(args[1], true);\n                                if (i === -1) {\n                                    if (isMXPColor(args[1]))\n                                        i = args[1];\n                                    else\n                                        throw new InvalidBackColorError();\n                                }\n                            }\n                            setTimeout(() => {\n                                this._colorPosition(n, p, i, item);\n                            }, 0);\n                        }\n                    }\n                    else if (args.length === 3) {\n                        if (args[0] === 'bold') {\n                            args.shift();\n                            args.push('bold');\n                        }\n                        if (args[0].trim() === 'current')\n                            i = null;\n                        else if (args[0].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[0].trim();\n                        else if (args[0].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[0].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[0]);\n                            if (i === -1) {\n                                if (isMXPColor(args[0]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidForeColorError();\n                            }\n                        }\n                        if (args[2] !== 'bold')\n                            throw new Error('Only bold is supported as third argument');\n                        else if (!i)\n                            i = 370;\n                        else\n                            p = i * 10;\n                        if (args[1].trim().match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})\\b$/g))\n                            i = args[1].trim();\n                        else if (args[1].trim().match(/^[-|+]?\\d+$/g))\n                            i = parseInt(args[1].trim(), 10);\n                        else {\n                            i = getAnsiColorCode(args[1], true);\n                            if (i === -1) {\n                                if (isMXPColor(args[1]))\n                                    i = args[0];\n                                else\n                                    throw new InvalidBackColorError();\n                            }\n                        }\n                        setTimeout(() => {\n                            this._colorPosition(n, p, i, item);\n                        }, 0);\n                    }\n                }\n                return null;\n            case 'highlight':\n            case 'hi':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length > 0 && args.length < 2) {\n                    item = {\n                        profile: null,\n                        pattern: null,\n                        commands: cmdChar + 'HIGHLIGHT'\n                    };\n                    item.pattern = args.shift();\n                    if (item.pattern.match(/^\\{.*\\}$/g))\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    else\n                        item.pattern = this.parseInline(this.stripQuotes(item.pattern));\n                    if (args.length === 1)\n                        item.profile = this.parseInline(this.stripQuotes(args[0]));\n                    this.createTrigger(item.pattern, item.commands, item.profile);\n                    return null;\n                }\n                else if (args.length)\n                    throw new Error('Too many arguments use \\x1b[4m' + cmdChar + 'hi\\x1b[0;-11;-12mghlight \\x1b[3mpattern profile\\x1b[0;-11;-12m');\n                n = this.client.display.lines.length;\n                setTimeout(() => {\n                    n = this.adjustLastLine(n);\n                    this.client.display.highlightSubStrByLine(n);\n                }, 0);\n                return null;\n            case 'break':\n            case 'br':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'br\\x1b[0;-11;-12meak\\x1b[0;-11;-12m');\n                if (!this.loops.length)\n                    throw new Error('\\x1b[4m' + cmdChar + 'br\\x1b[0;-11;-12meak\\x1b[0;-11;-12m must be used in a loop.');\n                if (this.stack.break)\n                    this.stack.break++;\n                else\n                    this.stack.break = 1;\n                return -1;\n            case 'continue':\n            case 'cont':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'cont\\x1b[0;-11;-12minue\\x1b[0;-11;-12m');\n                if (!this.loops.length)\n                    throw new Error('\\x1b[4m' + cmdChar + 'cont\\x1b[0;-11;-12minue\\x1b[0;-11;-12m must be used in a loop.');\n                this.stack.continue = true;\n                return -2;\n            case 'if':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (!args.length || args.length > 3)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'if {expression} {true-command} \\x1b[3m{false-command}\\x1b[0;-11;-12m');\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                    args[0] = args[0].substr(1, args[0].length - 2);\n                tmp = null;\n                if (this.evaluate(this.parseInline(args[0]))) {\n                    if (args[1].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[1] = args[1].substr(1, args[1].length - 2);\n                    tmp = this.parseOutgoing(args[1]);\n                }\n                else if (args.length > 2) {\n                    if (args[2].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[2] = args[2].substr(1, args[2].length - 2);\n                    tmp = this.parseOutgoing(args[2]);\n                }\n                if (tmp != null && tmp.length > 0)\n                    return tmp;\n                return null;\n            case 'case':\n            case 'ca':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (!args.length || args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ca\\x1b[0;-11;-12mse\\x1b[0;-11;-12m index {command 1} \\x1b[3m{command n}\\x1b[0;-11;-12m');\n                if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                    args[0] = args[0].substr(1, args[0].length - 2);\n                n = this.evaluate(this.parseInline(args[0]));\n                if (typeof n !== 'number')\n                    return null;\n                if (n > 0 && n < args.length) {\n                    if (args[n].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[n] = args[n].substr(1, args[n].length - 2);\n                    tmp = this.parseOutgoing(args[n]);\n                    if (tmp != null && tmp.length > 0)\n                        return tmp;\n                }\n                return null;\n            case 'switch':\n            case 'sw':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (!args.length || args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sw\\x1b[0;-11;-12mitch\\x1b[0;-11;-12m (expression) {command} \\x1b[3m(expression) {command} ... {else_command}\\x1b[0;-11;-12m');\n                if (args.length % 2 === 1)\n                    n = args.pop();\n                else\n                    n = null;\n                al = args.length;\n                //skip every other one as odd items are the commands to execute\n                for (i = 0; i < al; i += 2) {\n                    if (args[i].match(/^\\{[\\s\\S]*\\}$/g))\n                        args[i] = args[i].substr(1, args[i].length - 2);\n                    if (this.evaluate(this.parseInline(args[i]))) {\n                        if (args[i + 1].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[i + 1] = args[i + 1].substr(1, args[i + 1].length - 2);\n                        tmp = this.parseOutgoing(args[i + 1]);\n                        if (tmp != null && tmp.length > 0)\n                            return tmp;\n                        return null;\n                    }\n                }\n                if (n) {\n                    if (n.match(/^\\{[\\s\\S]*\\}$/g))\n                        n = n.substr(1, n.length - 2);\n                    tmp = this.parseOutgoing(n);\n                    if (tmp != null && tmp.length > 0)\n                        return tmp;\n                }\n                return null\n            case 'loop':\n            case 'loo':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'loo\\x1b[0;-11;-12mp\\x1b[0;-11;-12m range {commands}');\n                n = this.parseInline(args.shift()).split(',');\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                if (n.length === 1) {\n                    tmp = parseInt(n[0], 10);\n                    if (isNaN(tmp))\n                        throw new Error('Invalid loop range \\'' + n[0] + '\\' must be a number');\n                    return this._executeForLoop(0, tmp, args);\n                }\n                tmp = parseInt(n[0], 10);\n                if (isNaN(tmp))\n                    throw new Error('Invalid loop min \\'' + n[0] + '\\' must be a number');\n                i = parseInt(n[1], 10);\n                if (isNaN(i))\n                    throw new Error('Invalid loop max \\'' + n[1] + '\\' must be a number');\n                if (tmp > i) tmp++;\n                else tmp--;\n                return this._executeForLoop(tmp, i, args);\n            case 'repeat':\n            case 'rep':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'rep\\x1b[0;-11;-12meat\\x1b[0;-11;-12m expression {commands}');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                i = this.evaluate(this.parseInline(i));\n                if (typeof i !== 'number')\n                    throw new Error('Arguments must be a number');\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                if (i < 1)\n                    return this._executeForLoop((-i) + 1, 1, args);\n                return this._executeForLoop(0, i, args);\n            case 'until':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'until expression {commands}');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                tmp = [];\n                this.loops.push(0);\n                while (!this.evaluate(this.parseInline(i))) {\n                    let out = this.parseOutgoing(args);\n                    if (out != null && out.length > 0)\n                        tmp.push(out);\n                    if (this.stack.continue) {\n                        this.stack.continue = false;\n                        continue;\n                    }\n                    if (this.stack.break) {\n                        this.stack.break--;\n                        break;\n                    }\n                }\n                this.loops.pop();\n                if (tmp.length > 0)\n                    return tmp.map(v => v.trim()).join('\\n');\n                return null;\n            case 'while':\n            case 'wh':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wh\\x1b[0;-11;-12mile expression {commands}');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                tmp = [];\n                this.loops.push(0);\n                while (this.evaluate(this.parseInline(i))) {\n                    let out = this.parseOutgoing(args);\n                    if (out != null && out.length > 0)\n                        tmp.push(out);\n                    if (this.stack.continue) {\n                        this.stack.continue = false;\n                        continue;\n                    }\n                    if (this.stack.break) {\n                        this.stack.break--;\n                        break;\n                    }\n                }\n                this.loops.pop();\n                if (tmp.length > 0)\n                    return tmp.map(v => v.trim()).join('\\n');\n                return null;\n            case 'forall':\n            case 'fo':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'fo\\x1b[0;-11;-12mrall stringlist {commands}');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                tmp = [];\n                i = this.splitByQuotes(this.stripQuotes(this.parseInline(i)), '|');\n                al = i.length;\n                for (n = 0; n < al; n++) {\n                    this.loops.push(i[n]);\n                    let out = this.parseOutgoing(args);\n                    if (out != null && out.length > 0)\n                        tmp.push(out);\n                    if (this.stack.continue) {\n                        this.stack.continue = false;\n                        continue;\n                    }\n                    if (this.stack.break) {\n                        this.stack.break--;\n                        break;\n                    }\n                    this.loops.pop();\n                }\n                if (tmp.length > 0)\n                    return tmp.map(v => v.trim()).join('\\n');\n                return null;\n            case 'variable':\n            case 'var':\n            case 'va':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0) {\n                    i = Object.keys(this.client.variables);\n                    al = i.length;\n                    tmp = [];\n                    for (n = 0; n < al; n++)\n                        tmp.push(i[n] + ' = ' + this.client.variables[i[n]]);\n                    return tmp.join('\\n');\n                }\n                i = args.shift();\n                if (i.match(/^\\{.*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                i = this.parseInline(i);\n                if (!isValidIdentifier(i))\n                    throw new Error('Invalid variable name');\n                if (args.length === 0)\n                    return this.client.variables[i]?.toString();\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                args = this.parseInline(args);\n                if (args.match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                    this.client.variables[i] = parseInt(args, 10);\n                else if (args.match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    this.client.variables[i] = parseFloat(args);\n                else if (args === 'true')\n                    this.client.variables[i] = true;\n                else if (args === 'false')\n                    this.client.variables[i] = false;\n                else\n                    this.client.variables[i] = this.stripQuotes(args);\n                return null;\n            case 'unvar':\n            case 'unv':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length !== 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'unv\\x1b[0;-11;-12mar name ');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                i = this.parseInline(i);\n                delete this.client.variables[i];\n                return null;\n            case 'add':\n            case 'ad':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'ad\\x1b[0;-11;-12md name value');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                i = this.parseInline(i);\n                if (this.client.variables.hasOwnProperty(i) && typeof this.client.variables[i] !== 'number')\n                    throw new Error(i + ' is not a number for add');\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                args = this.evaluate(this.parseInline(args));\n                if (typeof args !== 'number')\n                    throw new Error('Value is not a number for add');\n                if (!this.client.variables.hasOwnProperty(i))\n                    this.client.variables[i] = args;\n                else\n                    this.client.variables[i] += args;\n                return null;\n            case 'math':\n            case 'mat':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length < 2)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'mat\\x1b[0;-11;-12mh name value');\n                i = args.shift();\n                if (i.match(/^\\{[\\s\\S]*\\}$/g))\n                    i = i.substr(1, i.length - 2);\n                i = this.parseInline(i);\n                args = args.join(' ');\n                if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                    args = args.substr(1, args.length - 2);\n                args = this.evaluate(this.parseInline(args));\n                if (typeof args !== 'number')\n                    throw new Error('Value is not a number for add');\n                this.client.variables[i] = args;\n                return null;\n            case 'evaluate':\n            case 'eva':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'eva\\x1b[0;-11;-12mluate expression');\n                args = this.evaluate(this.parseInline(args.join(' ')));\n                if (this._getOption('ignoreEvalUndefined') && typeof args === 'undefined')\n                    args = '';\n                else\n                    args = '' + args;\n                if (this.client.telnet.prompt)\n                    this.client.print('\\n' + args + '\\x1b[0m\\n', false);\n                else\n                    this.client.print(args + '\\x1b[0m\\n', false);\n                this.client.telnet.prompt = false;\n                return null\n            case 'freeze':\n            case 'fr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region freeze\n                if (args.length === 0) {\n                    this.scrollLock = !this.scrollLock;\n                    if (this.scrollLock) {\n                        if (this.client.display.scrollAtBottom)\n                            this.client.display.scrollUp();\n                    }\n                    else\n                        this.client.display.scrollDisplay();\n                }\n                else if (args.length === 1) {\n                    if (args[0] === '0' || args[0] === 'false') {\n                        if (this.scrollLock) {\n                            this.scrollLock = false;\n                            this.client.display.scrollDisplay();\n                        }\n                    }\n                    else if (!this.scrollLock) {\n                        this.scrollLock = true;\n                        if (this.client.display.scrollAtBottom)\n                            this.client.display.scrollUp();\n                    }\n                }\n                else if (args.length > 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'fr\\x1b[0;-11;-12meeze \\x1b[3mnumber\\x1b[0;-11;-12m');\n                //#endregion   \n                return null;\n            case 'clr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'CLR');\n                //nothing to clear so just bail\n                if (this.client.display.lines.length === 0)\n                    return null;\n                i = this.client.display.WindowSize.height + 2;\n                //skip trailing new lines\n                n = this.client.display.lines.length;\n                while (n-- && i) {\n                    if (this.client.display.lines[n].text.length)\n                        break;\n                    i--;\n                }\n                tmp = [];\n                while (i--)\n                    tmp.push('\\n');\n                this.client.print(tmp.join(''), true);\n                return null;\n            case 'fire':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                args = this.parseInline(args.join(' ') + '\\n');\n                this.ExecuteTriggers(TriggerTypes.Regular | TriggerTypes.Pattern | TriggerTypes.LoopExpression, args, args, false, false);\n                return null;\n            case 'state': //#STATE id state profile\n            case 'sta':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //setup args for easy use\n                args = args.map(m => {\n                    if (!m || !m.length)\n                        return m;\n                    if (m.match(/^\\{.*\\}$/g))\n                        return this.parseInline(m.substr(1, m.length - 2));\n                    return this.parseInline(this.stripQuotes(m));\n                })\n                switch (args.length) {\n                    case 0:\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sta\\x1b[0;-11;-12mte \\x1b[3m name|pattern state profile\\x1b[0;-11;-12m');\n                    case 1:\n                        //state\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\n                            if (!this._LastTrigger)\n                                throw new Error('No trigger has fired yet, unable to set state');\n                            trigger = this._LastTrigger;\n                            n = trigger.state;\n                            trigger.state = parseInt(args[0], 10);\n                        }\n                        else {\n                            //name|pattern\n                            const keys = this._profiles.keys;\n                            let k = 0;\n                            const kl = keys.length;\n                            if (kl === 0)\n                                return null;\n                            if (kl === 1) {\n                                if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                                    throw Error('No enabled profiles found!');\n                                trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                trigger = trigger.find(t => {\n                                    return t.name === args[0] || t.pattern === args[0];\n                                });\n                            }\n                            else {\n                                for (; k < kl; k++) {\n                                    if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                        continue;\n                                    trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                    trigger = trigger.find(t => {\n                                        return t.name === args[0] || t.pattern === args[0];\n                                    });\n                                    if (trigger)\n                                        break;\n                                }\n                            }\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0]);\n                            n = trigger.state;\n                            trigger.state = 0;\n                        }\n                        break;\n                    case 2:\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                            throw new Error('Invalid argument to ' + cmdChar + 'state, first argument must be name|pattern');\n                        //name|pattern state\n                        if (args[1].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\n                            const keys = this._profiles.keys;\n                            let k = 0;\n                            const kl = keys.length;\n                            if (kl === 0)\n                                return null;\n                            if (kl === 1) {\n                                if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                                    throw Error('No enabled profiles found!');\n                                trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                trigger = trigger.find(t => {\n                                    return t.name === args[0] || t.pattern === args[0];\n                                });\n                            }\n                            else {\n                                for (; k < kl; k++) {\n                                    if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                        continue;\n                                    trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                    trigger = trigger.find(t => {\n                                        return t.name === args[0] || t.pattern === args[0];\n                                    });\n                                    if (trigger)\n                                        break;\n                                }\n                            }\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0]);\n                            n = trigger.state;\n                            trigger.state = parseInt(args[1], 10);\n                        }\n                        //name|pattern profile\n                        else {\n                            profile = args[1];\n                            if (this._profiles.contains(profile))\n                                profile = this._profiles.items[profile.toLowerCase()];\n                            else\n                                throw new ProfileNotFound(args[1]);\n                            trigger = SortItemArrayByPriority(profile.triggers);\n                            trigger = trigger.find(t => {\n                                return t.name === args[0] || t.pattern === args[0];\n                            });\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0], profile.name);\n                            n = trigger.state;\n                            trigger.state = 0;\n                        }\n                        break;\n                    case 3: //name|pattern state profile\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                            throw new Error('Invalid argument to ' + cmdChar + 'state, first argument must be name|pattern');\n                        profile = args[2];\n                        if (this._profiles.contains(profile))\n                            profile = this._profiles.items[profile.toLowerCase()];\n                        else\n                            throw new ProfileNotFound(args[2]);\n                        trigger = SortItemArrayByPriority(profile.triggers);\n                        trigger = trigger.find(t => {\n                            return t.name === args[0] || t.pattern === args[0];\n                        });\n                        if (!trigger)\n                            throw new TriggerNotFound(args[0]);\n                        n = trigger.state;\n                        trigger.state = parseInt(args[1], 10);\n                        break;\n                    default:\n                        throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sta\\x1b[0;-11;-12mte \\x1b[3m name|pattern state profile\\x1b[0;-11;-12m');\n                }\n                if (trigger.state < 0 || trigger.state > trigger.triggers.length) {\n                    trigger.state = n;\n                    throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                }\n                i = trigger.fired;\n                trigger.fired = false;\n                this.resetTriggerState(this._TriggerCache.indexOf(trigger), n, i);\n                this.client.restartAlarmState(trigger, n, trigger.state);\n                this.client.saveProfiles();\n                this.client.emit('item-updated', 'trigger', trigger.profile.name, trigger.profile.triggers.indexOf(trigger), trigger);\n                this._echo('Trigger state set to ' + trigger.state + '.', -7, -8, true, true);\n                return null;\n            case 'set':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#SET pattern|name state value profile\n                //setup args for easy use\n                args = args.map(m => {\n                    if (!m || !m.length)\n                        return m;\n                    if (m.match(/^\\{.*\\}$/g))\n                        return this.parseInline(m.substr(1, m.length - 2));\n                    return this.parseInline(this.stripQuotes(m));\n                })\n                n = 0;\n                i = false;\n                switch (args.length) {\n                    case 0: //state - set fired to true for last trigger\n                        throw new Error('Invalid syntax use ' + cmdChar + 'set \\x1b[3mname|pattern\\x1b[0;-11;-12m state \\x1b[3mvalue profile\\x1b[0;-11;-12m');\n                    case 1:\n                        //state\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\n                            if (!this._LastTrigger)\n                                throw new Error('No trigger has fired yet, unable to set state');\n                            trigger = this._LastTrigger;\n                            n = parseInt(args[0], 10)\n                            if (n < 0 || n > trigger.triggers.length)\n                                throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                            if (n === 0) {\n                                i = trigger.fired;\n                                trigger.fired = true;\n                            }\n                            else {\n                                i = trigger.triggers[n - 1].fired;\n                                trigger.triggers[n - 1].fired = true;\n                            }\n                        }\n                        else\n                            throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                        break;\n                    case 2:\n                        //state value - set fired to value for last trigger\n                        if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/)) {\n                            if (!this._LastTrigger)\n                                throw new Error('No trigger has fired yet, unable to set state');\n                            trigger = this._LastTrigger;\n                            n = parseInt(args[0], 10)\n                            if (n < 0 || n > trigger.triggers.length)\n                                throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                            if (args[1] !== '0' && args[1] !== '1' && args[1] !== 'true' && args[1] !== 'false')\n                                throw new Error('Value must be 0, 1, true, or false');\n                            if (n === 0) {\n                                i = trigger.fired;\n                                trigger.fired = args[1] === '1' || args[1] === 'true';\n                            }\n                            else {\n                                i = trigger.triggers[n - 1].fired;\n                                trigger.triggers[n - 1].fired = args[1] === '1' || args[1] === 'true';\n                            }\n                        }\n                        //pattern|name state - set trigger state fired to true\n                        else {\n                            const keys = this._profiles.keys;\n                            let k = 0;\n                            const kl = keys.length;\n                            if (kl === 0)\n                                return null;\n                            if (kl === 1) {\n                                if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                                    throw Error('No enabled profiles found!');\n                                trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                trigger = trigger.find(t => {\n                                    return t.name === args[0] || t.pattern === args[0];\n                                });\n                            }\n                            else {\n                                for (; k < kl; k++) {\n                                    if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                        continue;\n                                    trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                    trigger = trigger.find(t => {\n                                        return t.name === args[0] || t.pattern === args[0];\n                                    });\n                                    if (trigger)\n                                        break;\n                                }\n                            }\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0]);\n                            n = parseInt(args[1], 10)\n                            if (n < 0 || n > trigger.triggers.length)\n                                throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                            if (n === 0) {\n                                i = trigger.fired;\n                                trigger.fired = true;\n                            }\n                            else {\n                                i = trigger.triggers[n - 1].fired;\n                                trigger.triggers[n - 1].fired = true;\n                            }\n                        }\n                        break;\n                    case 3:\n                        //pattern|name state profile - set trigger state to fired in profile\n                        if (args[2] === '0' && args[2] !== '1' && args[2] !== 'true' && args[21] !== 'false') {\n                            profile = args[2];\n                            if (this._profiles.contains(profile))\n                                profile = this._profiles.items[profile.toLowerCase()];\n                            else\n                                throw new ProfileNotFound(profile);\n                            trigger = SortItemArrayByPriority(profile.triggers);\n                            trigger = trigger.find(t => {\n                                return t.name === args[0] || t.pattern === args[0];\n                            });\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0], profile.name);\n                            n = parseInt(args[1], 10)\n                            if (n < 0 || n > trigger.triggers.length)\n                                throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                            if (n === 0) {\n                                i = trigger.fired;\n                                trigger.fired = true;\n                            }\n                            else {\n                                i = trigger.triggers[n - 1].fired;\n                                trigger.triggers[n - 1].fired = true;\n                            }\n                        }\n                        //pattern|name state value - set trigger state fired to value          \n                        else {\n                            const keys = this._profiles.keys;\n                            let k = 0;\n                            const kl = keys.length;\n                            if (kl === 0)\n                                return null;\n                            if (kl === 1) {\n                                if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                                    throw Error('No enabled profiles found!');\n                                trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                trigger = trigger.find(t => {\n                                    return t.name === args[0] || t.pattern === args[0];\n                                });\n                            }\n                            else {\n                                for (; k < kl; k++) {\n                                    if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                        continue;\n                                    trigger = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                    trigger = trigger.find(t => {\n                                        return t.name === args[0] || t.pattern === args[0];\n                                    });\n                                    if (trigger)\n                                        break;\n                                }\n                            }\n                            if (!trigger)\n                                throw new TriggerNotFound(args[0]);\n                            n = parseInt(args[1], 10)\n                            if (n < 0 || n > trigger.triggers.length)\n                                throw new Error('Trigger state must be greater than or equal to 0 or less than or equal to ' + trigger.triggers.length);\n                            if (n === 0) {\n                                i = trigger.fired;\n                                trigger.fired = args[2] === '1' || args[2] === 'true';\n                            }\n                            else {\n                                i = trigger.triggers[n - 1].fired;\n                                trigger.triggers[n - 1].fired = args[2] === '1' || args[2] === 'true';\n                            }\n                        }\n                        break;\n                    case 4:\n                        //pattern|name state value profile - set trigger state to value in profile \n                        profile = args[2];\n                        if (this._profiles.contains(profile))\n                            profile = this._profiles.items[profile.toLowerCase()];\n                        else\n                            throw new ProfileNotFound(profile);\n                        trigger = SortItemArrayByPriority(profile.triggers);\n                        trigger = trigger.find(t => {\n                            return t.name === args[0] || t.pattern === args[0];\n                        });\n                        if (!trigger)\n                            throw new TriggerNotFound(args[0], profile.name);\n                        if (args[2] !== '0' && args[2] !== '1' && args[2] !== 'true' && args[2] !== 'false')\n                            throw new Error('Value must be 0, 1, true, or false');\n                        if (n === 0) {\n                            i = trigger.fired;\n                            trigger.fired = args[2] === '1' || args[2] === 'true';\n                        }\n                        else {\n                            i = trigger.triggers[n - 1].fired;\n                            trigger.triggers[n - 1].fired = args[2] === '1' || args[2] === 'true';\n                        }\n                        break;\n                    default:\n                        throw new Error('Invalid syntax use ' + cmdChar + 'set \\x1b[3mname|pattern\\x1b[0;-11;-12m state \\x1b[3mvalue profile\\x1b[0;-11;-12m');\n                }\n                this.client.saveProfiles();\n                this.client.emit('item-updated', 'trigger', trigger.profile.name, trigger.profile.triggers.indexOf(trigger), trigger);\n                this.resetTriggerState(this._TriggerCache.indexOf(trigger), n, i);\n                if (n === 0)\n                    this._echo('Trigger state 0 fired state set to ' + trigger.fired + '.', -7, -8, true, true);\n                else {\n                    this._echo('Trigger state ' + n + ' fired state set to ' + trigger.triggers[n - 1].fired + '.', -7, -8, true, true);\n                    //manual trigger fire it using set type\n                    if (trigger.enabled && trigger.triggers[n - 1].enabled && trigger.triggers[n - 1].type === SubTriggerTypes.Manual) {\n                        this._LastTriggered = '';\n                        this.ExecuteTrigger(trigger, [], false, this._TriggerCache.indexOf(trigger), 0, 0, trigger);\n                    }\n                }\n                return null;\n            case 'condition':\n            case 'cond':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region condition\n                item = {\n                    profile: null,\n                    name: null,\n                    pattern: null,\n                    commands: null,\n                    options: { priority: 0 }\n                };\n                if (args.length < 2 || args.length > 5)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'cond\\x1b[0;-11;-12mition name|pattern {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'cond\\x1b[0;-11;-12mition {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new InvalidTrigger('name or pattern');\n\n                if (args[0].match(/^\\{.*\\}$/g)) {\n                    item.pattern = args.shift();\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                }\n                else {\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\n                    if (!item.name || item.name.length === 0)\n                        throw new InvalidTrigger('name');\n                    if (args[0].match(/^\\{.*\\}$/g)) {\n                        item.pattern = args.shift();\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    }\n                }\n                if (args.length !== 0) {\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                        item.commands = args.shift();\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\n                    }\n                    if (args.length === 1) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        else\n                            args[0] = this.stripQuotes(args[0]);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'temporary':\n                                    case 'temp':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                    //case 'expression':\n                                    case 'reparse':\n                                    case 'reparsepattern':\n                                    case 'manual':\n                                    case 'skip':\n                                    case 'looplines':\n                                    case 'looppattern':\n                                    case 'wait':\n                                    case 'duration':\n                                    case 'withinlines':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1]))\n                                                throw new InvalidTrigger('type');\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTrigger('options');\n                    }\n                    else if (args.length === 2) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'temporary':\n                                    case 'temp':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                    //case 'expression':\n                                    case 'reparse':\n                                    case 'reparsepattern':\n                                    case 'manual':\n                                    case 'skip':\n                                    case 'looplines':\n                                    case 'looppattern':\n                                    case 'wait':\n                                    case 'duration':\n                                    case 'withinlines':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1]))\n                                                throw new InvalidTrigger('type');\n\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTrigger('options');\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                }\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name, true);\n                //#endregion\n                return null;\n            case 'cr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.sendBackground('\\n');\n                return null;\n            case 'send':\n            case 'se':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd file \\x1b[3mprefix suffix\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd text');\n                args = args.join(' ');\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd file \\x1b[3mprefix suffix\\x1b[0;-11;-12m or \\x1b[4m' + cmdChar + 'se\\x1b[0;-11;-12mnd text');\n                this.client.sendBackground(this.stripQuotes(args), this._getOption('allowCommentsFromCommand'));\n                return null;\n            //work around for send as can not access files so we open a file dialog and ask for the file they want to send instead\n            case 'sendfile':\n            case 'sendf':\n                ((a, r) => {\n                    openFileDialog().then(files => {\n                        readFile(files[0]).then((contents: any) => {\n                            if ((this._getOption('echo') & 4) === 4)\n                                this._echo(r, -3, -4, true, true);\n                            p = '';\n                            i = '';\n                            if (a.length > 1)\n                                p = this.stripQuotes(this.parseInline(a[0]));\n                            if (a.length > 2)\n                                i = this.stripQuotes(this.parseInline(a[1]));\n                            //handle \\n and \\r\\n for windows and linux files\n                            items = contents.split(/\\r?\\n/);\n                            items.forEach(line => {\n                                this.client.sendBackground(p + line + i, null, this._getOption('allowCommentsFromCommand'));\n                            });\n                        }).catch(this.client.error);\n                    }).catch(() => { });\n                })(args, raw);\n                return null;\n            //work around for sendraw as can not access files so we open a file dialog and ask for the file they want to send instead\n            case 'sendfileraw':\n            case 'sendfiler':\n                ((a, r) => {\n                    openFileDialog().then(files => {\n                        readFile(files[0]).then((contents: any) => {\n                            if ((this._getOption('echo') & 4) === 4)\n                                this._echo(r, -3, -4, true, true);\n                            p = '';\n                            i = '';\n                            if (a.length > 1)\n                                p = this.stripQuotes(this.parseInline(a[0]));\n                            if (a.length > 2)\n                                i = this.stripQuotes(this.parseInline(a[1]));\n                            //handle \\n and \\r\\n for windows and linux files\n                            items = contents.split(/\\r?\\n/);\n                            items.forEach(line => {\n                                this.client.sendRaw(p + line + i);\n                            });\n                        }).catch(this.client.error);\n                    }).catch(() => { });\n                })(args, raw);\n                return null;\n            case 'sendraw':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'sendraw text or ' + cmdChar + 'sendraw file \\x1b[3mprefix suffix\\x1b[0;-11;-12m');\n                args = args.join(' ');\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'sendraw text or ' + cmdChar + 'sendraw file \\x1b[3mprefix suffix\\x1b[0;-11;-12m');\n                if (!args.endsWith('\\n'))\n                    args = args + '\\n';\n                this.client.sendRaw(args);\n                return null;\n            case 'sendprompt':\n            case 'sendp':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sendp\\x1b[0;-11;-12mrompt text');\n                args = args.join(' ');\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'sendp\\x1b[0;-11;-12mrompt text');\n                this.client.sendRaw(args);\n                return null;\n            case 'character':\n            case 'char':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                this.client.sendRaw(window.$character || '');\n                return null;\n            case 'speak':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speak text');\n                args = args.join(' ');\n                if (args.length === 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speak text');\n                args = this.stripQuotes(this.parseInline(args));\n                if (args.length !== 0)\n                    window.speechSynthesis.speak(new SpeechSynthesisUtterance(args));\n                return null;\n            case 'speakstop':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length !== 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakstop');\n                window.speechSynthesis.cancel();\n                return null;\n            case 'speakpause':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length !== 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakpause');\n                window.speechSynthesis.pause();\n                return null;\n            case 'speakresume':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length !== 0)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'speakresume');\n                window.speechSynthesis.resume();\n                return null;\n            case 'comment':\n            case 'comm':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                return null;\n            case 'noop':\n            case 'no':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length)\n                    this.parseInline(args.join(' '));\n                return null;\n            case 'temp':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //#region temp\n                item = {\n                    profile: null,\n                    name: null,\n                    pattern: null,\n                    commands: null,\n                    options: { priority: 0 }\n                };\n                if (args.length < 2 || args.length > 5)\n                    throw new Error('Invalid syntax use ' + cmdChar + 'temp name {pattern} {commands} \\x1b[3moptions profile\\x1b[0;-11;-12m or ' + cmdChar + 'temp {pattern} {commands} \\x1b[3m{options} profile\\x1b[0;-11;-12m');\n                if (args[0].length === 0)\n                    throw new InvalidTemporaryTrigger('or pattern');\n\n                if (args[0].match(/^\\{.*\\}$/g)) {\n                    item.pattern = args.shift();\n                    item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                }\n                else {\n                    item.name = this.parseInline(this.stripQuotes(args.shift()));\n                    if (!item.name || item.name.length === 0)\n                        throw new InvalidTemporaryTrigger('name');\n                    if (args[0].match(/^\\{.*\\}$/g)) {\n                        item.pattern = args.shift();\n                        item.pattern = this.parseInline(item.pattern.substr(1, item.pattern.length - 2));\n                    }\n                }\n                if (args.length !== 0) {\n                    if (args[0].match(/^\\{[\\s\\S]*\\}$/g)) {\n                        item.commands = args.shift();\n                        item.commands = item.commands.substr(1, item.commands.length - 2);\n                    }\n                    if (args.length === 1) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        else\n                            args[0] = this.stripQuotes(args[0]);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                        //case 'expression':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1], TriggerTypeFilter.Main))\n                                                throw new InvalidTemporaryTrigger('type');\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTemporaryTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTemporaryTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTemporaryTrigger('options');\n                    }\n                    else if (args.length === 2) {\n                        if (args[0].match(/^\\{[\\s\\S]*\\}$/g))\n                            args[0] = args[0].substr(1, args[0].length - 2);\n                        if (args[0].length !== 0) {\n                            this.parseInline(args[0]).split(',').forEach(o => {\n                                switch (o.trim()) {\n                                    case 'nocr':\n                                    case 'prompt':\n                                    case 'case':\n                                    case 'verbatim':\n                                    case 'disable':\n                                    case 'enable':\n                                    case 'cmd':\n                                    case 'raw':\n                                    case 'pattern':\n                                    case 'regular':\n                                    case 'alarm':\n                                    case 'event':\n                                    case 'cmdpattern':\n                                    case 'loopexpression':\n                                        //case 'expression':\n                                        item.options[o.trim()] = true;\n                                        break;\n                                    default:\n                                        if (o.trim().startsWith('param=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`param option '${o.trim()}'`);\n                                            item.options['params'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('type=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`type option '${o.trim()}'`);\n                                            if (!this._isTriggerType(tmp[1], TriggerTypeFilter.Main))\n                                                throw new InvalidTemporaryTrigger('type');\n\n                                            item.options['type'] = tmp[1];\n                                        }\n                                        else if (o.trim().startsWith('pri=') || o.trim().startsWith('priority=')) {\n                                            tmp = o.trim().split('=');\n                                            if (tmp.length !== 2)\n                                                throw new InvalidTemporaryTrigger(`priority option '${o.trim()}'`);\n                                            i = parseInt(tmp[1], 10);\n                                            if (isNaN(i))\n                                                throw new InvalidTemporaryTrigger('priority value \\'' + tmp[1] + '\\' must be a number');\n                                            item.options['priority'] = i;\n                                        }\n                                        else\n                                            throw new InvalidTemporaryTrigger(`option '${o.trim()}'`);\n                                }\n                            });\n                        }\n                        else\n                            throw new InvalidTemporaryTrigger('options');\n                        item.profile = this.stripQuotes(args[1]);\n                        if (item.profile.length !== 0)\n                            item.profile = this.parseInline(item.profile);\n                    }\n                }\n                item.options.temporary = true;\n                this.createTrigger(item.pattern, item.commands, item.profile, item.options, item.name);\n                //#endregion\n                return null;\n            case 'wrap':\n            case 'wr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                //filter out empty arguments to avoid trailing spaces\n                args = args.filter(a => a);\n                if (args.length > 1)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'wr\\x1b[0;-11;-12map or \\x1b[4m' + cmdChar + 'wr\\x1b[0;-11;-12map number');\n                if (args.length === 0) {\n                    this.client.setOption('display.wordWrap', !this._getOption('display.wordWrap'))\n                    this.client.display.wordWrap = this._getOption('display.wordWrap');\n                }\n                else {\n                    i = parseInt(this.parseInline(args[0]), 10);\n                    if (isNaN(i))\n                        throw new Error('Invalid number \\'' + i + '\\' for wrap');\n                    if (i < 0)\n                        throw new Error('Must be greater then or equal to zero for wrap');\n                    this.client.setOption('display.wordWrap', true)\n                    this.client.setOption('display.wordWrap', i)\n                    this.client.display.wordWrap = true;\n                    this.client.display.wrapAt = i;\n                }\n                return null;\n            case 'prompt':\n            case 'pr':\n                if ((this._getOption('echo') & 4) === 4)\n                    this._echo(raw, -3, -4, true, true);\n                if (args.length === 0 || args.length > 4)\n                    throw new Error('Invalid syntax use \\x1b[4m' + cmdChar + 'pr\\x1b[0;-11;-12mompt variable \\x1b[3mmessage defaultValue mask\\x1b[0;-11;-12m');\n                else {\n                    i = args.shift();\n                    if (i.match(/^\\{.*\\}$/g))\n                        i = i.substr(1, i.length - 2);\n                    i = this.parseInline(i);\n                    if (!isValidIdentifier(i))\n                        throw new Error('Invalid variable name');\n                    args = args.map(a => this.parseInline(this.stripQuotes(a)))\n                    if (args.length === 3 && args[2] && args[2].toLowerCase() === 'true')\n                        args[2] = true;\n                    args = window.prompt(...args);\n                    if (args?.match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                        this.client.variables[i] = parseInt(args, 10);\n                    else if (args?.match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                        this.client.variables[i] = parseFloat(args);\n                    else if (args === 'true')\n                        this.client.variables[i] = true;\n                    else if (args === 'false')\n                        this.client.variables[i] = false;\n                    else\n                        this.client.variables[i] = args;\n                }\n                return null;\n        }\n        if (fun.match(/^[-|+]?\\d+$/)) {\n            if ((this._getOption('echo') & 4) === 4)\n                this._echo(raw, -3, -4, true, true);\n            i = parseInt(fun, 10);\n            if (args.length === 0)\n                throw new Error('Invalid syntax use ' + cmdChar + 'nnn commands');\n            args = args.join(' ');\n            if (args.match(/^\\{[\\s\\S]*\\}$/g))\n                args = args.substr(1, args.length - 2);\n            if (i < 1)\n                return this._executeForLoop((-i) + 1, 1, args);\n            return this._executeForLoop(0, i, args);\n        }\n        const data: FunctionEvent = { name: fun, args: args, raw: raw, handled: false, return: null };\n        this.client.emit('function', data);\n        if (data.handled) {\n            if ((this._getOption('echo') & 4) === 4)\n                this._echo(raw, -3, -4, true, true);\n            return data.return;\n        }\n        if (data.raw.startsWith(cmdChar))\n            return cmdChar + this.parseOutgoing(data.raw.substr(1), null, null, null, true);\n        return this.parseOutgoing(data.raw + '\\n', null, null, null, true);\n    }\n\n    private _executeForLoop(start: number, end: number, commands: string) {\n        let tmp = [];\n        let r: number;\n        if (start > end) {\n            for (r = start - 1; r >= end; r--) {\n                this.loops.push(r);\n                try {\n                    let out = this.parseOutgoing(commands);\n                    if (out != null && out.length > 0)\n                        tmp.push(out);\n                    if (this.stack.continue) {\n                        this.stack.continue = false;\n                        continue;\n                    }\n                    if (this.stack.break) {\n                        this.stack.break--;\n                        break;\n                    }\n                }\n                catch (e) {\n                    throw e;\n                }\n                finally {\n                    this.loops.pop();\n                }\n            }\n        }\n        else {\n            for (r = start; r < end; r++) {\n                this.loops.push(r + 1);\n                try {\n                    let out = this.parseOutgoing(commands);\n                    if (out != null && out.length > 0)\n                        tmp.push(out);\n                    if (this.stack.continue) {\n                        this.stack.continue = false;\n                        continue;\n                    }\n                    if (this.stack.break) {\n                        this.stack.break--;\n                        break;\n                    }\n                }\n                catch (e) {\n                    throw e;\n                }\n                finally {\n                    this.loops.pop();\n                }\n            }\n        }\n        if (tmp.length > 0)\n            return tmp.map(v => v.trim()).join('\\n');\n        return null;\n    }\n\n    public parseInline(text) {\n        return this.parseOutgoing(text, false, null, false, true);\n    }\n\n    public parseOutgoing(text: string, eAlias?: boolean, stacking?: boolean, append?: boolean, noFunctions?: boolean, noComments?: boolean) {\n        const tl = text.length;\n        if (!this.enableParsing || text == null || tl === 0)\n            return text;\n        let str: string = '';\n        let alias: string = '';\n        let AliasesCached;\n        let state = 0;\n        //store as local vars to speed up parsing\n        const aliases = this.client.aliases;\n        const stackingChar: string = this._getOption('commandStackingChar');\n        const spChar: string = this._getOption('speedpathsChar');\n        const ePaths: boolean = this._getOption('enableSpeedpaths');\n        const eCmd: boolean = this._getOption('enableCommands');\n        const cmdChar: string = this._getOption('commandChar');\n        const eEscape: boolean = this._getOption('allowEscape');\n        const escChar: string = this._getOption('escapeChar');\n        const verbatimChar: string = this._getOption('verbatimChar');\n        const eVerbatim: boolean = this._getOption('enableVerbatim');\n        const eParamEscape: boolean = this._getOption('enableDoubleParameterEscaping');\n        const paramChar: string = this._getOption('parametersChar');\n        const eParam: boolean = this._getOption('enableParameters');\n        const nParamChar: string = this._getOption('nParametersChar');\n        const eNParam: boolean = this._getOption('enableNParameters');\n        const eEval: boolean = this._getOption('allowEval');\n        const iEval: boolean = this._getOption('ignoreEvalUndefined');\n        const iComments: boolean = this._getOption('enableInlineComments') && !noComments;\n        const bComments: boolean = this._getOption('enableBlockComments') && !noComments;\n        const iCommentsStr: string[] = this._getOption('inlineCommentString').split('');\n        const bCommentsStr: string[] = this._getOption('blockCommentString').split('');\n        const bTrim: boolean = this._getOption('ignoreInputLeadingWhitespace');\n        let sTrim = '';\n        let args = [];\n        let arg: any = '';\n        let findAlias: boolean = true;\n        let out: string = '';\n        let a;\n        let c: string;\n        let al: number;\n        let idx: number = 0;\n        let tmp;\n        let tmp2;\n        let start: boolean = true;\n        let _neg: boolean = false;\n        let _pos: boolean = false;\n        let _fall: boolean = false;\n        let nest: number = 0;\n        const pd: boolean = this._getOption('parseDoubleQuotes');\n        const ps: boolean = this._getOption('parseSingleQuotes');\n\n        if (eAlias == null)\n            eAlias = aliases.length > 0;\n        else\n            eAlias = eAlias && aliases.length > 0;\n\n        //if no character set treat it as disabled\n        if (stackingChar.length === 0)\n            stacking = false;\n        else if (stacking == null)\n            stacking = this._getOption('commandStacking');\n        else\n            stacking = stacking && this._getOption('commandStacking');\n\n        for (idx = 0; idx < tl; idx++) {\n            c = text.charAt(idx);\n            switch (state) {\n                case ParseState.doubleQuoted:\n                    //quoted string\n                    if (eEscape && c === escChar)\n                        state = ParseState.doubleQuotedEscape;\n                    else {\n                        if (c === '\"' && pd)\n                            state = ParseState.none;\n                        if (eAlias && findAlias)\n                            alias += c;\n                        else\n                            str += c;\n                    }\n                    start = false;\n                    break;\n                case ParseState.doubleQuotedEscape:\n                    state = ParseState.doubleQuoted;\n                    if (c !== '\"' && c !== escChar) {\n                        idx--;\n                        if (eAlias && findAlias)\n                            alias += escChar;\n                        else\n                            str += escChar;\n                    }\n                    else if (eAlias && findAlias)\n                        alias += c;\n                    else\n                        str += c;\n                    break;\n                case ParseState.singleQuoted:\n                    if (eEscape && c === escChar)\n                        state = ParseState.doubleQuotedEscape;\n                    else {\n                        //quoted string\n                        if (c === '\\'' && ps)\n                            state = ParseState.none;\n                        if (eAlias && findAlias)\n                            alias += c;\n                        else\n                            str += c;\n                    }\n                    start = false;\n                    break;\n                case ParseState.singleQuotedEscape:\n                    state = ParseState.singleQuoted;\n                    if (c !== '\\'' && c !== escChar) {\n                        idx--;\n                        if (eAlias && findAlias)\n                            alias += escChar;\n                        else\n                            str += escChar;\n                    }\n                    else if (eAlias && findAlias)\n                        alias += c;\n                    else\n                        str += c;\n                    break;\n                case ParseState.aliasArguments:\n                    //quoted string so keep intact\n                    if (c === '\"' && pd) {\n                        arg += c;\n                        state = ParseState.aliasArgumentsDouble;\n                        start = false;\n                    }\n                    //quoted string so keep int\n                    else if (c === '\\'' && ps) {\n                        arg += c;\n                        state = ParseState.aliasArgumentsSingle;\n                        start = false;\n                    }\n                    else if (eEscape && c === escChar) {\n                        state = ParseState.aliasArgumentsEscape;\n                        start = false;\n                    }\n                    //end of alias at end of text, new line, or command stack if enabled\n                    else if (idx === tl - 1 || c === '\\n' || (stacking && c === stackingChar)) {\n                        if (!(c === '\\n' || (stacking && c === stackingChar)))\n                            arg += c;\n                        //save any arg that was found\n                        if (arg.length > 0)\n                            args.push(this.parseInline(arg));\n                        al = AliasesCached.length;\n                        for (a = 0; a < al; a++) {\n                            str = this.ExecuteAlias(AliasesCached[a], args);\n                            if (typeof str === 'number') {\n                                if (str >= 0)\n                                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                                if (out.length === 0) return null;\n                                return out;\n                            }\n                            if (str !== null) out += str;\n                            str = '';\n                            if (!a.multi) break;\n                            if (this.stack.continue || this.stack.break) {\n                                if (out.length === 0) return null;\n                                return out;\n                            }\n                        }\n                        alias = '';\n                        state = ParseState.none;\n                        AliasesCached = null;\n                        start = true;\n                    }\n                    //space so new argument\n                    else if (c === ' ') {\n                        args.push(this.parseInline(arg));\n                        arg = '';\n                        start = false;\n                    }\n                    else {\n                        arg += c;\n                        start = false;\n                    }\n                    break;\n                case ParseState.aliasArgumentsDouble: //quoted alias argument\n                    if (c === '\"')\n                        state = ParseState.aliasArguments;\n                    arg += c;\n                    start = false;\n                    break;\n                case ParseState.aliasArgumentsSingle: //quoted alias argument\n                    if (c === '\\'')\n                        state = ParseState.aliasArguments;\n                    arg += c;\n                    start = false;\n                    break;\n                case ParseState.aliasArgumentsEscape:\n                    state = ParseState.aliasArguments;\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\n                        arg += c;\n                    else if (iComments && c == iCommentsStr[0])\n                        tmp2 = c;\n                    else if (bComments && c == bCommentsStr[0])\n                        tmp2 = c;\n                    else if ('\"\\'{'.indexOf(c) !== -1)\n                        arg += c;\n                    else\n                        arg += escChar + c;\n                    break;\n                case ParseState.path: //path found\n                    if (eEscape && c === escChar) {\n                        state = ParseState.pathEscape;\n                        start = false;\n                    }\n                    else if (c === '\\n' || (stacking && c === stackingChar)) {\n                        state = ParseState.none;\n                        str = this.ProcessPath(str);\n                        if (str !== null) out += str;\n                        str = '';\n                        start = true;\n                        if (this.stack.continue || this.stack.break) {\n                            if (out.length === 0) return null;\n                            return out;\n                        }\n                    }\n                    else if (idx === 1 && c === spChar) {\n                        state = ParseState.none;\n                        idx--;\n                        start = false;\n                    }\n                    else {\n                        str += c;\n                        start = false;\n                    }\n                    break;\n                case ParseState.pathEscape:\n                    state = ParseState.path;\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\n                        str += c;\n                    else if (iComments && c == iCommentsStr[0])\n                        tmp2 = c;\n                    else if (bComments && c == bCommentsStr[0])\n                        tmp2 = c;\n                    else if ('\"\\'{'.indexOf(c) !== -1)\n                        str += c;\n                    else\n                        str += escChar + c;\n                    break;\n                case ParseState.function:\n                    if (c === '{') {\n                        start = false;\n                        str += c;\n                        nest++;\n                    }\n                    else if (c === '}') {\n                        start = false;\n                        str += c;\n                        nest--;\n                    }\n                    else if (nest === 0 && eEscape && c === escChar) {\n                        state = ParseState.functionEscape;\n                        start = false;\n                    }\n                    else if (nest === 0 && (c === '\\n' || (stacking && c === stackingChar))) {\n                        state = ParseState.none;\n                        str = this.executeScript(cmdChar + str);\n                        if (typeof str === 'number') {\n                            if (str >= 0)\n                                this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                            if (out.length === 0) return null;\n                            return out;\n                        }\n                        if (str !== null) {\n                            out += sTrim + str + '\\n';\n                            /*\n                            if (str.startsWith(cmdChar))\n                                out += cmdChar + this.parseOutgoing(str.substr(1));\n                            else\n                                out += this.parseOutgoing(str);\n                            */\n                        }\n                        if (this.stack.continue || this.stack.break) {\n                            if (out.length === 0) return null;\n                            return out;\n                        }\n                        str = '';\n                        start = true;\n                    }\n                    else {\n                        str += c;\n                        start = false;\n                    }\n                    break;\n                case ParseState.functionEscape:\n                    state = ParseState.function;\n                    str += escChar + c;\n                    break;\n                case ParseState.paramsP:\n                    if (c === '{' && arg.length === 0) {\n                        state = ParseState.paramsPBlock;\n                        continue;\n                    }\n                    /*\n                    if (eEscape && c === escChar && arg.length === 0) {\n                        state = ParseState.paramsPEscape;\n                        continue;\n                    }\n                    */\n                    switch (c) {\n                        case paramChar:\n                            if (arg.length === 0) {\n                                if (eAlias && findAlias)\n                                    alias += paramChar;\n                                else\n                                    str += paramChar;\n                                state = ParseState.none;\n                                if (!eParamEscape)\n                                    idx--;\n                            }\n                            break;\n                        case '*':\n                            if (arg.length === 0) {\n                                if (this.stack.args) {\n                                    if (eAlias && findAlias)\n                                        alias += this.stack.args.slice(1).join(' ');\n                                    else\n                                        str += this.stack.args.slice(1).join(' ');\n                                    this.stack.used = this.stack.args.length;\n                                }\n                                else if (eAlias && findAlias)\n                                    alias += paramChar + '*';\n                                else\n                                    str += paramChar + '*';\n                                state = ParseState.none;\n                                break;\n                            }\n                        case '-':\n                            if (arg.length === 0) {\n                                _neg = true;\n                                break;\n                            }\n                            else if (_pos && arg.length == 1) {\n                                _neg = true;\n                                break;\n                            }\n                            else\n                                _fall = true;\n                        case '0':\n                        case '1':\n                        case '2':\n                        case '3':\n                        case '4':\n                        case '5':\n                        case '6':\n                        case '7':\n                        case '8':\n                        case '9':\n                            if (!_fall) {\n                                arg += c;\n                                break;\n                            }\n                        case 'x':\n                            if (!_fall && arg.length === 0) {\n                                _pos = true;\n                                break;\n                            }\n                        default:\n                            if (this.stack.args && arg.length > 0) {\n                                tmp = parseInt(arg, 10);\n                                if (_pos) {\n                                    if (_neg && this.stack.args.indices && tmp < this.stack.args.length)\n                                        tmp = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\n                                    else if (this.stack.args.indices && tmp < this.stack.args.length)\n                                        tmp = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\n                                    else if (_neg)\n                                        tmp = paramChar + 'x-' + tmp;\n                                    else\n                                        tmp = paramChar + 'x' + tmp;\n                                }\n                                else {\n                                    if (_neg && tmp < this.stack.args.length)\n                                        tmp = this.stack.args.slice(arg).join(' ');\n                                    else if (tmp < this.stack.args.length)\n                                        tmp = this.stack.args[tmp];\n                                    else if (_neg)\n                                        tmp = paramChar + '-' + tmp;\n                                    else\n                                        tmp = paramChar + tmp;\n                                    if (_neg)\n                                        this.stack.used = this.stack.args.length;\n                                    else if (arg > this.stack.used)\n                                        this.stack.used = parseInt(arg, 10);\n                                }\n                                if (eAlias && findAlias)\n                                    alias += tmp;\n                                else\n                                    str += tmp;\n                                idx--;\n                            }\n                            else {\n                                if (arg.length === 0 && this.loops.length > 0) {\n                                    tmp = c.charCodeAt(0) - 105;\n                                    if (tmp >= 0 && tmp < 18 && tmp < this.loops.length) {\n                                        if (eAlias && findAlias)\n                                            alias += this.loops[tmp];\n                                        else\n                                            str += this.loops[tmp];\n                                        state = ParseState.none;\n                                        break;\n                                    }\n                                }\n                                if (eAlias && findAlias) {\n                                    alias += paramChar;\n                                    if (_neg)\n                                        alias += '-';\n                                    if (_pos)\n                                        alias += 'x';\n                                }\n                                else {\n                                    str += paramChar;\n                                    if (_neg)\n                                        str += '-';\n                                    if (_pos)\n                                        str += 'x';\n                                }\n                                idx = idx - arg.length - 1;\n                            }\n                            state = ParseState.none;\n                            arg = '';\n                            break;\n                    }\n                    break;\n                case ParseState.paramsPNamed:\n                    if (c.match(/[^a-zA-Z0-9_]/g)) {\n                        if (this.stack.named.hasOwnProperty(arg)) {\n                            if (eAlias && findAlias)\n                                alias += this.stack.named[arg];\n                            else\n                                str += this.stack.named[arg];\n                        }\n                        else if (eAlias && findAlias)\n                            alias += paramChar + arg;\n                        else\n                            str += paramChar + arg;\n                        idx--;\n                        state = ParseState.none;\n                        arg = '';\n                    }\n                    else\n                        arg += c;\n                    break;\n                case ParseState.paramsPBlock:\n                    if (c === '}' && nest === 0) {\n                        if (arg === 'i')\n                            tmp2 = this.loops[0];\n                        else if (arg === 'repeatnum')\n                            tmp2 = this.repeatnum;\n                        else if (this.stack.args && arg === '*') {\n                            tmp2 = this.stack.args.slice(1).join(' ');\n                            this.stack.used = this.stack.args.length;\n                        }\n                        else if (this.stack.named && this.stack.named.hasOwnProperty(arg))\n                            tmp2 = this.stack.named[arg];\n                        else {\n                            if (this.stack.args && !isNaN(arg)) {\n                                tmp = parseInt(arg, 10);\n                                if (tmp < 0) {\n                                    if (-tmp >= this.stack.args.length) {\n                                        if (eEval)\n                                            tmp2 = tmp;\n                                        else {\n                                            tmp2 = paramChar;\n                                            idx = idx - tmp.length - 2;\n                                        }\n                                    }\n                                    else {\n                                        tmp2 = this.stack.args.slice(tmp).join(' ');\n                                        this.stack.used = this.stack.args.length;\n                                    }\n                                }\n                                else if (tmp < this.stack.args.length) {\n                                    tmp2 = this.stack.args[tmp];\n                                    if (arg > this.stack.used)\n                                        this.stack.used = tmp;\n                                }\n                                else if (eEval)\n                                    tmp2 = tmp;\n                                else {\n                                    tmp2 = paramChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                            else if (this.stack.args && this.stack.args.indices && arg.match(/^x[-|+]?\\d+$/)) {\n                                tmp = parseInt(arg.substring(1), 10);\n                                if (tmp < 0) {\n                                    if (-tmp >= this.stack.args.length) {\n                                        tmp2 = paramChar;\n                                        idx = idx - tmp.length - 2;\n                                    }\n                                    else\n                                        tmp2 = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\n                                }\n                                else if (tmp < this.stack.args.length)\n                                    tmp2 = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\n                                else {\n                                    tmp2 = paramChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                            else {\n                                tmp = this.parseVariable(arg);\n                                if (tmp != null)\n                                    tmp2 = tmp;\n                                else if (eEval) {\n                                    tmp2 = this.evaluate(this.parseInline(arg));\n                                    if (iEval && typeof tmp2 === 'undefined')\n                                        tmp2 = null;\n                                    else\n                                        tmp2 = '' + tmp2;\n                                }\n                                else {\n                                    tmp2 = paramChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                        }\n                        if (tmp2 != null && eAlias && findAlias)\n                            alias += tmp2;\n                        else if (tmp2 != null)\n                            str += tmp2;\n                        state = 0;\n                        arg = '';\n                    }\n                    else if (c === '{') {\n                        nest++;\n                        arg += c;\n                    }\n                    else if (c === '}') {\n                        nest--;\n                        arg += c;\n                    }\n                    else\n                        arg += c;\n                    break;\n                /*\n                case ParseState.paramsPEscape:\n                    if (c === '{')\n                        tmp2 = paramChar+'{';\n                    else if (c === escChar)\n                        tmp2 = paramChar + escChar;\n                    else {\n                        tmp2 = paramChar + escChar;\n                        idx--;\n                    }\n                    if (eAlias && findAlias)\n                        alias += tmp2;\n                    else\n                        str += tmp2;\n                    state = ParseState.none;\n                    break;\n                */\n                case ParseState.paramsN:\n                    if (c === '{')\n                        state = ParseState.paramsNBlock;\n                    /*\n                    else if (eEscape && c === escChar)\n                        state = ParseState.paramsNEscape;\n                    */\n                    else if (c.match(/[^a-zA-Z_$]/g)) {\n                        state = ParseState.none;\n                        idx--;\n                        if (eAlias && findAlias)\n                            alias += nParamChar;\n                        else\n                            str += nParamChar;\n                    }\n                    else {\n                        arg = c;\n                        state = ParseState.paramsNNamed;\n                    }\n                    break;\n                case ParseState.paramsNNamed:\n                    if (c.match(/[^a-zA-Z0-9_]/g)) {\n                        if (this.stack.named && this.stack.named.hasOwnProperty(arg)) {\n                            if (eAlias && findAlias)\n                                alias += this.stack.named[arg];\n                            else\n                                str += this.stack.named[arg];\n                        }\n                        else if (this.client.variables.hasOwnProperty(arg)) {\n                            if (eAlias && findAlias)\n                                alias += this.client.variables[arg];\n                            else\n                                str += this.client.variables[arg];\n                        }\n                        else if (eAlias && findAlias)\n                            alias += nParamChar + arg;\n                        else\n                            str += nParamChar + arg;\n                        idx--;\n                        state = ParseState.none;\n                        arg = '';\n                    }\n                    else\n                        arg += c;\n                    break;\n                /*\n                                case ParseState.paramsNEscape:\n                                    if (c === '{')\n                                        tmp2 = `\\{`;\n                                    else if (c === escChar) \n                                        tmp2 = escChar;\n                                    else {\n                                        tmp2 = nParamChar + escChar;\n                                        idx--;\n                                    }\n                                    if (eAlias && findAlias)\n                                        alias += tmp2;\n                                    else\n                                        str += tmp2;\n                                    state = ParseState.none;\n                                    break;\n                                    */\n                case ParseState.paramsNBlock:\n                    if (c === '}' && nest === 0) {\n                        tmp2 = null;\n                        if (arg === 'i')\n                            tmp2 = this.loops[0];\n                        else if (arg === 'repeatnum')\n                            tmp2 = this.repeatnum;\n                        else if (this.stack.args && arg === '*') {\n                            tmp2 = this.stack.args.slice(1).join(' ');\n                            this.stack.used = this.stack.args.length;\n                        }\n                        else if (this.stack.named && this.stack.named.hasOwnProperty(arg))\n                            tmp2 = this.stack.named[arg];\n                        else {\n                            if (this.stack.args && !isNaN(arg)) {\n                                tmp = parseInt(arg, 10);\n                                if (tmp < 0) {\n                                    if (-tmp >= this.stack.args.length) {\n                                        if (eEval)\n                                            tmp2 = tmp;\n                                        else {\n                                            tmp2 = nParamChar;\n                                            idx = idx - arg.length - 2;\n                                        }\n                                    }\n                                    else {\n                                        tmp2 = this.stack.args.slice(tmp).join(' ');\n                                        this.stack.used = this.stack.args.length;\n                                    }\n                                }\n                                else if (tmp < this.stack.args.length) {\n                                    tmp2 = this.stack.args[tmp];\n                                    if (tmp > this.stack.used)\n                                        this.stack.used = tmp;\n                                }\n                                else if (eEval)\n                                    tmp2 = tmp;\n                                else {\n                                    tmp2 = nParamChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                            else if (this.stack.args && this.stack.args.indices && arg.match(/^x[-|+]?\\d+$/)) {\n                                tmp = parseInt(arg.substring(1), 10);\n                                if (tmp < 0) {\n                                    if (-tmp >= this.stack.args.length) {\n                                        tmp2 = nParamChar;\n                                        idx = idx - arg.length - 2;\n                                    }\n                                    else\n                                        tmp2 = this.stack.indices.slice(tmp).map(v => v ? (v[0] + ' ' + v[1]) : '0 0').join(' ');\n                                }\n                                else if (tmp < this.stack.args.length)\n                                    tmp2 = this.stack.args.indices[tmp] ? (this.stack.args.indices[tmp][0] + ' ' + this.stack.args.indices[tmp][1]) : '0 0';\n                                else {\n                                    tmp2 = nParamChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                            else {\n                                c = this.parseVariable(arg);\n                                if (c != null)\n                                    tmp2 = c;\n                                else if (eEval) {\n                                    tmp2 = this.evaluate(this.parseInline(arg));\n                                    if (iEval && typeof tmp2 === 'undefined')\n                                        tmp2 = null;\n                                    else\n                                        tmp2 = '' + tmp2;\n                                }\n                                else {\n                                    tmp2 = nParamChar;\n                                    idx = idx - arg.length - 2;\n                                }\n                            }\n                        }\n                        if (tmp2 != null && eAlias && findAlias)\n                            alias += tmp2;\n                        else if (tmp2 != null)\n                            str += tmp2;\n                        state = ParseState.none;\n                        arg = '';\n                    }\n                    else if (c === '{') {\n                        nest++;\n                        arg += c;\n                    }\n                    else if (c === '}') {\n                        nest--;\n                        arg += c;\n                    }\n                    else\n                        arg += c;\n                    break;\n                case ParseState.escape:\n                    if (c === escChar || (stacking && c === stackingChar) || (eVerbatim && c === verbatimChar) || (ePaths && c === spChar) || (eCmd && c === cmdChar) || (eParamEscape && c === paramChar) || (eNParam && c === nParamChar))\n                        tmp2 = c;\n                    else if (iComments && c == iCommentsStr[0])\n                        tmp2 = c;\n                    else if (bComments && c == bCommentsStr[0])\n                        tmp2 = c;\n                    else if ('\"\\'{'.indexOf(c) !== -1)\n                        tmp2 = c;\n                    else\n                        tmp2 = escChar + c;\n                    if (eAlias && findAlias)\n                        alias += tmp2;\n                    else\n                        str += tmp2;\n                    state = ParseState.none;\n                    break;\n                case ParseState.verbatim:\n                    if (c === '\\n') {\n                        state = ParseState.none;\n                        out += str + c;\n                        str = '';\n                        start = true;\n                    }\n                    else {\n                        str += c;\n                        start = false;\n                    }\n                    break;\n                case ParseState.comment:\n                    if (iComments && c === iCommentsStr[1])\n                        state = ParseState.inlineComment;\n                    else if (bComments && c === bCommentsStr[1])\n                        state = ParseState.blockComment;\n                    else {\n                        state = ParseState.none;\n                        if (eAlias && findAlias)\n                            alias += iCommentsStr[0];\n                        else\n                            str += iCommentsStr[0];\n                        idx--;\n                    }\n                    break;\n                case ParseState.inlineCommentStart:\n                    if (c === iCommentsStr[1])\n                        state = ParseState.inlineComment;\n                    else {\n                        state = ParseState.none;\n                        if (eAlias && findAlias)\n                            alias += iCommentsStr[0];\n                        else\n                            str += iCommentsStr[0];\n                        idx--;\n                    }\n                    break;\n                case ParseState.blockCommentStart:\n                    if (bComments && c === bCommentsStr[1])\n                        state = ParseState.blockCommentEnd;\n                    else {\n                        state = ParseState.none;\n                        if (eAlias && findAlias)\n                            alias += bCommentsStr[0];\n                        else\n                            str += bCommentsStr[0];\n                        idx--;\n                    }\n                    break;\n                case ParseState.inlineComment:\n                    if (c === '\\n') {\n                        state = ParseState.none;\n                        if (!start)\n                            idx--;\n                        else {\n                            alias = '';\n                            //new line so need to check for aliases again\n                            findAlias = true;\n                            start = true;\n                        }\n                    }\n                    break;\n                case ParseState.blockComment:\n                    if (bCommentsStr.length === 1) {\n                        if (c === bCommentsStr[0])\n                            state = ParseState.none;\n                    }\n                    else if (c === bCommentsStr[1])\n                        state = ParseState.blockCommentEnd;\n                    break;\n                case ParseState.blockCommentEnd:\n                    if (c === bCommentsStr[0])\n                        state = ParseState.none;\n                    else\n                        state = ParseState.blockComment;\n                    break;\n                default:\n                    if ((iComments || bComments) && c === iCommentsStr[0] && c === bCommentsStr[0]) {\n                        if (iComments && iCommentsStr.length === 1)\n                            state = ParseState.inlineComment;\n                        else if (bComments && bCommentsStr.length === 1)\n                            state = ParseState.blockComment;\n                        else\n                            state = ParseState.comment;\n                        continue;\n                    }\n                    else if (iComments && c === iCommentsStr[0]) {\n                        if (iCommentsStr.length === 1)\n                            state = ParseState.inlineComment;\n                        else\n                            state = ParseState.inlineCommentStart;\n                        continue;\n                    }\n                    else if (bComments && c === bCommentsStr[0]) {\n                        if (bCommentsStr.length === 1)\n                            state = ParseState.blockComment;\n                        else\n                            state = ParseState.blockCommentStart;\n                        continue;\n                    }\n                    else if (eEscape && c === escChar) {\n                        state = ParseState.escape;\n                        start = false;\n                        continue;\n                    }\n                    else if (eParam && c === paramChar) {\n                        state = ParseState.paramsP;\n                        _neg = false;\n                        _pos = false;\n                        _fall = false;\n                        arg = '';\n                        start = false;\n                    }\n                    else if (eNParam && c === nParamChar) {\n                        state = ParseState.paramsN;\n                        _neg = false;\n                        _pos = false;\n                        _fall = false;\n                        arg = '';\n                        start = false;\n                    }\n                    else if (!noFunctions && eCmd && start && c === cmdChar) {\n                        state = ParseState.function;\n                        start = false;\n                        if (alias.length) {\n                            sTrim = alias;\n                            alias = '';\n                        }\n                        else {\n                            sTrim = str || '';\n                            str = '';\n                        }\n                    }\n                    else if (eVerbatim && start && c === verbatimChar) {\n                        state = ParseState.verbatim;\n                        start = false;\n                    }\n                    else if (ePaths && start && c === spChar) {\n                        state = ParseState.path;\n                        start = false;\n                    }\n                    else if (c === '\"' && pd) {\n                        if (eAlias && findAlias)\n                            alias += c;\n                        else\n                            str += c;\n                        state = ParseState.doubleQuoted;\n                        start = false;\n                    }\n                    else if (c === '\\'' && ps) {\n                        if (eAlias && findAlias)\n                            alias += c;\n                        else\n                            str += c;\n                        state = ParseState.singleQuoted;\n                        start = false;\n                    }\n                    //\\f\\r\\t\\v\\u0020\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff\n                    else if (start && bTrim && (c === ' ' || c === '\\t' || c === '\\f' || c === '\\r' || c === '\\v' || c === '\\u0020' || c === '\\u00a0' || c === '\\u1680' || c === '\\u2000-' || c === '\\u200a' || c === '\\u2028' || c === '\\u2029' || c === '\\u202f' || c === '\\u205f' || c === '\\u3000' || c === '\\ufeff')) {\n                        if (eAlias && findAlias)\n                            alias += c;\n                        else\n                            str += c;\n                    }\n                    //if looking for an alias and a space check\n                    else if (eAlias && findAlias && c === ' ') {\n                        AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\n                        //are aliases enabled and does it match an alias?\n                        if (AliasesCached.length > 0) {\n                            //move to alias parsing\n                            state = ParseState.aliasArguments;\n                            //init args\n                            args.length = 0;\n                            arg = '';\n                            args.push(bTrim ? alias.trimStart() : alias);\n                        }\n                        else //else not an alias so normal space\n                        {\n                            str += alias + ' ';\n                            alias = '';\n                            AliasesCached = null;\n                        }\n                        //no longer look for an alias\n                        findAlias = false;\n                        start = false;\n                    }\n                    else if (c === '\\n' || (stacking && c === stackingChar)) {\n                        if (eAlias && findAlias && alias.length > 0) {\n                            AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\n                            //are aliases enabled and does it match an alias?\n                            if (AliasesCached.length > 0) {\n                                args.push(bTrim ? alias.trimStart() : alias);\n                                //move to alias parsing\n                                al = AliasesCached.length;\n                                for (a = 0; a < al; a++) {\n                                    str = this.ExecuteAlias(AliasesCached[a], args);\n                                    if (typeof str === 'number') {\n                                        if (str >= 0)\n                                            this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                                        if (out.length === 0) return null;\n                                        return out;\n                                    }\n                                    if (str !== null) out += str;\n                                    if (!a.multi) break;\n                                    if (this.stack.continue || this.stack.break) {\n                                        if (out.length === 0) return null;\n                                        return out;\n                                    }\n                                }\n                                str = '';\n                                //init args\n                                args.length = 0;\n                                arg = '';\n                            }\n                            else //else not an alias so normal space\n                            {\n                                str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\n                                if (typeof str === 'number') {\n                                    if (str >= 0)\n                                        this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                                    if (out.length === 0) return null;\n                                    return out;\n                                }\n                                if (str !== null) out += str + '\\n';\n                                str = '';\n                                AliasesCached = null;\n                            }\n                            //no longer look for an alias\n                        }\n                        else {\n                            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, str, str, false, true);\n                            if (typeof str === 'number') {\n                                if (str >= 0)\n                                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                                if (out.length === 0) return null;\n                                return out;\n                            }\n                            if (str !== null) out += str + '\\n';\n                            str = '';\n                        }\n                        if (this.stack.continue || this.stack.break) {\n                            if (out.length === 0) return null;\n                            return out;\n                        }\n                        alias = '';\n                        //new line so need to check for aliases again\n                        findAlias = true;\n                        start = true;\n                    }\n                    else if (eAlias && findAlias) {\n                        alias += c;\n                        start = false;\n                    }\n                    else {\n                        str += c;\n                        start = false;\n                    }\n                    break;\n            }\n        }\n        if (state === ParseState.escape)\n            str += escChar;\n        else if (state === ParseState.paramsNNamed && arg.length > 0) {\n            if (this.stack.named && this.stack.named[arg])\n                str += this.stack.named[arg];\n            else if (this.client.variables.hasOwnProperty(arg))\n                str += this.client.variables[arg];\n            else {\n                arg = this.parseInline(arg);\n                str += nParamChar;\n                if (arg != null) str += arg;\n            }\n        }\n        else if (state === ParseState.paramsP && arg.length > 0) {\n            if (this.stack.args) {\n                arg = parseInt(arg, 10);\n                if (_pos && this.stack.args.indices && arg < this.stack.args.length)\n                    str += this.stack.args.indices[arg] ? (this.stack.args.indices[arg][0] + ' ' + this.stack.args.indices[arg][1]) : '0 0';\n                else {\n                    if (_neg && arg < this.stack.args.length)\n                        str += this.stack.args.slice(arg).join(' ');\n                    else if (arg < this.stack.args.length)\n                        str += this.stack.args[arg];\n                    if (_neg)\n                        this.stack.used = this.stack.args.length;\n                    else if (arg > this.stack.used)\n                        this.stack.used = arg;\n                }\n            }\n            else {\n                arg = this.parseInline(arg);\n                str += paramChar;\n                if (_neg)\n                    str += '-';\n                if (_pos)\n                    str += 'x';\n                if (arg != null) str += arg;\n            }\n        }\n        else if (state === ParseState.paramsPBlock) {\n            arg = this.parseInline(arg);\n            str += paramChar + '{';\n            if (arg != null) str += arg;\n        }\n        else if (state === ParseState.paramsN && arg.length > 0) {\n            if (this.stack.named) {\n                if (this.stack.named.hasOwnProperty(arg)) {\n                    str += this.stack.named[arg];\n                }\n                else {\n                    arg = this.parseInline(arg);\n                    str += nParamChar;\n                    if (arg != null) str += arg;\n                }\n            }\n            else {\n                arg = this.parseInline(arg);\n                str += nParamChar;\n                if (arg != null) str += arg;\n            }\n        }\n        else if (state === ParseState.paramsNBlock) {\n            arg = this.parseInline(arg);\n            str += `${nParamChar}{`;\n            if (arg != null) str += arg;\n        }\n        else if (state === ParseState.path) {\n            str = this.ProcessPath(str);\n            if (str !== null) out += str;\n            str = '';\n        }\n        else if (state === ParseState.comment) {\n            str += iCommentsStr[0];\n            idx--;\n        }\n        else if (state === ParseState.inlineCommentStart) {\n            str += iCommentsStr[0];\n            idx--;\n        }\n        else if (state === ParseState.blockCommentStart) {\n            str += bCommentsStr[0];\n            idx--;\n        }\n\n        if (!noFunctions && state === ParseState.function) {\n            str = this.executeScript(cmdChar + str);\n            if (typeof str === 'number') {\n                if (str >= 0)\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                if (out.length === 0) return null;\n                return out;\n            }\n            if (str !== null) {\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\n                    let r = false;\n                    if (str.endsWith('\\n')) {\n                        str = str.substring(0, str.length - 1);\n                        r = true;\n                    }\n                    if (!str.endsWith(' '))\n                        str += ' ';\n                    if (this.stack.used < 1)\n                        str += this.stack.args.slice(1).join(' ');\n                    else\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\n                    this.stack.used = this.stack.args.length;\n                    if (r) str += '\\n';\n                }\n                out += sTrim + str;\n            }\n            else if (out.length === 0) return null;\n            if (this.stack.continue || this.stack.break) {\n                if (out.length === 0) return null;\n                return out;\n            }\n        }\n        else if (state === ParseState.verbatim) {\n            if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\n                let r = false;\n                if (str.endsWith('\\n')) {\n                    str = str.substring(0, str.length - 1);\n                    r = true;\n                }\n                if (!str.endsWith(' '))\n                    str += ' ';\n                if (this.stack.used < 1)\n                    str += this.stack.args.slice(1).join(' ');\n                else\n                    str += this.stack.args.slice(this.stack.used + 1).join(' ');\n                this.stack.used = this.stack.args.length;\n                if (r) str += '\\n';\n            }\n            out += str;\n        }\n        else if (alias.length > 0 && eAlias && findAlias) {\n            if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\n                let r = false;\n                if (str.endsWith('\\n')) {\n                    str = str.substring(0, str.length - 1);\n                    r = true;\n                }\n                if (!str.endsWith(' '))\n                    str += ' ';\n                if (this.stack.used < 1)\n                    str += this.stack.args.slice(1).join(' ');\n                else\n                    str += this.stack.args.slice(this.stack.used + 1).join(' ');\n                this.stack.used = this.stack.args.length;\n                if (r) str += '\\n';\n            }\n            if (str.length > 0)\n                alias += str;\n            AliasesCached = FilterArrayByKeyValue(aliases, 'pattern', bTrim ? alias.trimStart() : alias);\n            //are aliases enabled and does it match an alias?\n            if (AliasesCached.length > 0) {\n                //move to alias parsing\n                args.push(bTrim ? alias.trimStart() : alias);\n                al = AliasesCached.length;\n                for (a = 0; a < al; a++) {\n                    str = this.ExecuteAlias(AliasesCached[a], args);\n                    if (typeof str === 'number') {\n                        if (str >= 0)\n                            this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                        if (out.length === 0) return null;\n                        return out;\n                    }\n                    if (str !== null) out += str;\n                    else if (out.length === 0) return null;\n                    if (this.stack.continue || this.stack.break) {\n                        return out;\n                    }\n                    if (!a.multi) break;\n                }\n            }\n            else //else not an alias so normal space\n            {\n                str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\n                if (typeof str === 'number') {\n                    if (str >= 0)\n                        this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                    if (out.length === 0) return null;\n                    return out;\n                }\n                if (str !== null) out += str;\n                else if (out.length === 0) return null;\n                if (this.stack.continue || this.stack.break) {\n                    return out;\n                }\n            }\n            AliasesCached = null;\n        }\n        else if (alias.length > 0) {\n            if (str.length > 0)\n                alias += str;\n            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, alias, alias, false, true);\n            if (typeof str === 'number') {\n                if (str >= 0)\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                if (out.length === 0) return null;\n                return out;\n            }\n            if (str !== null) {\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\n                    let r = false;\n                    if (str.endsWith('\\n')) {\n                        str = str.substring(0, str.length - 1);\n                        r = true;\n                    }\n                    if (!str.endsWith(' '))\n                        str += ' ';\n                    if (this.stack.used < 1)\n                        str += this.stack.args.slice(1).join(' ');\n                    else\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\n                    this.stack.used = this.stack.args.length;\n                    if (r) str += '\\n';\n                }\n                out += str;\n            }\n            else if (out.length === 0) return null;\n            if (this.stack.continue || this.stack.break) {\n                if (out.length === 0) return null;\n                return out;\n            }\n        }\n        else if (str.length > 0) {\n            str = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, str, str, false, true);\n            if (typeof str === 'number') {\n                if (str >= 0)\n                    this.executeWait(text.substr(idx + 1), str, eAlias, stacking, append, noFunctions, noComments);\n                if (out.length === 0) return null;\n                return out;\n            }\n            if (str !== null) {\n                if (append && eAlias && this.stack.args && this.stack.append && this.stack.args.length - 1 > 0 && this.stack.used + 1 < this.stack.args.length) {\n                    let r = false;\n                    if (str.endsWith('\\n')) {\n                        str = str.substring(0, str.length - 1);\n                        r = true;\n                    }\n                    if (!str.endsWith(' '))\n                        str += ' ';\n                    if (this.stack.used < 1)\n                        str += this.stack.args.slice(1).join(' ');\n                    else\n                        str += this.stack.args.slice(this.stack.used + 1).join(' ');\n                    if (r) str += '\\n';\n                }\n                out += str;\n            }\n            else if (out.length === 0) return null;\n            if (this.stack.continue || this.stack.break) {\n                if (out.length === 0) return null;\n                return out;\n            }\n        }\n\n        args.length = 0;\n        args = null;\n        arg = null;\n        alias = null;\n        return out;\n    }\n\n    public parseVariable(text) {\n        let c;\n        switch (text) {\n            case 'esc':\n                return '\\x1b';\n            case 'cr':\n                return '\\n';\n            case 'lf':\n                return '\\r';\n            case 'crlf':\n                return '\\r\\n';\n            case 'copied':\n                return window.$copied;\n            case 'copied.lower':\n                return window.$copied.toLowerCase();\n            case 'copied.upper':\n                return window.$copied.toUpperCase();\n            case 'copied.proper':\n                return ProperCase(window.$copied);\n            case 'i':\n                return this.loops[0];\n            case 'repeatnum':\n                return this.vStack['$repeatnum'] || this.repeatnum;\n            case 'character':\n                return window.$character;\n            case 'character.lower':\n                return window.$character.toLowerCase();\n            case 'character.upper':\n                return window.$character.toUpperCase();\n            case 'character.proper':\n                return ProperCase(window.$character);\n            case 'selected':\n            case 'selectedurl':\n            case 'selectedline':\n            case 'selectedword':\n            case 'selurl':\n            case 'selline':\n            case 'selword':\n            case 'action':\n            case 'trigger':\n                return this.vStack['$' + text] || window['$' + text] || '';\n            case 'selected.lower':\n            case 'selectedurl.lower':\n            case 'selectedline.lower':\n            case 'selectedword.lower':\n            case 'selurl.lower':\n            case 'selline.lower':\n            case 'selword.lower':\n                return (this.vStack['$' + text.substr(0, text.length - 6)] || window['$' + text.substr(0, text.length - 6)] || '').toLowerCase();\n            case 'selected.upper':\n            case 'selectedurl.upper':\n            case 'selectedline.upper':\n            case 'selectedword.upper':\n            case 'selurl.upper':\n            case 'selline.upper':\n            case 'selword.upper':\n                return (this.vStack['$' + text.substr(0, text.length - 6)] || window['$' + text.substr(0, text.length - 6)] || '').toUpperCase();\n            case 'selected.proper':\n            case 'selectedurl.proper':\n            case 'selectedline.proper':\n            case 'selectedword.proper':\n            case 'selurl.proper':\n            case 'selline.proper':\n            case 'selword.proper':\n                return ProperCase(this.vStack['$' + text.substr(0, text.length - 7)] || window['$' + text.substr(0, text.length - 7)]);\n            case 'random':\n                return mathjs().randomInt(0, 100);\n        }\n        if (WindowVariables.indexOf(text) !== -1)\n            return this.vStack['$' + text] || window['$' + text] || '';\n        if (this.loops.length && text.length === 1) {\n            let i = text.charCodeAt(0) - 105;\n            if (i >= 0 && i < 18 && i < this.loops.length)\n                return this.loops[i];\n        }\n        const re = new RegExp('^([a-zA-Z]+)\\\\((.*)\\\\)$', 'g');\n        let res = re.exec(text);\n        if (!res || !res.length) {\n            const data: FunctionEvent = { raw: text, name: text, args: [], handled: false, return: null };\n            this.client.emit('variable', data);\n            if (data.handled)\n                return data.return;\n            return null;\n        }\n        let sides;\n        let mod;\n        let args;\n        let min;\n        let max;\n        let escape = this._getOption('allowEscape') ? this._getOption('escapeChar') : '';\n        switch (res[1]) {\n            case 'time':\n                if (!moment) return new Date().toISOString();\n                if (res[2] && res[2].length > 0)\n                    return moment().format(this.stripQuotes(this.parseInline(res[2])));\n                return moment().format();\n            case 'clip':\n                if (res[2] && res[2].length > 0) {\n                    (<any>this.client).writeClipboard(this.stripQuotes(this.parseInline(res[2])));\n                    return null;\n                }\n                return (<any>this.client).readClipboard();\n            case 'lower':\n                return this.stripQuotes(this.parseInline(res[2]).toLowerCase());\n            case 'upper':\n                return this.stripQuotes(this.parseInline(res[2]).toUpperCase());\n            case 'proper':\n                return ProperCase(this.stripQuotes(this.parseInline(res[2])));\n            case 'eval':\n                args = this.evaluate(this.parseInline(res[2]));\n                if (this._getOption('ignoreEvalUndefined') && typeof args === 'undefined')\n                    return null;\n                return '' + args;\n            case 'dice':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid dice');\n                if (args.length === 1) {\n                    res = /(\\d+)\\s*?d(F|f|%|\\d+)(\\s*?[-|+|*|\\/]?\\s*?\\d+)?/g.exec(args[0]);\n                    if (!res || res.length < 3) return null;\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = parseInt(args[0]);\n                    sides = args[1].trim();\n                    if (args.length > 2)\n                        mod = args[2].trim();\n                }\n                else\n                    throw new ArgumentTooManyError('dice');\n\n                if (sides === 'F' || sides === 'f')\n                    sides = 'F';\n                else if (sides !== '%')\n                    sides = parseInt(sides);\n\n                let sum = 0;\n                for (let i = 0; i < c; i++) {\n                    if (sides === 'F' || sides === 'f')\n                        sum += fudgeDice();\n                    else if (sides === '%')\n                        sum += ~~(Math.random() * 100.0) + 1.0;\n                    else\n                        sum += ~~(Math.random() * sides) + 1;\n                }\n                if (sides === '%')\n                    sum /= 100.0;\n                if (mod)\n                    return this.evaluate(sum + mod);\n                return '' + sum;\n            case 'diceavg':\n                //The average of any XdY is X*(Y+1)/2.\n                //(min + max) / 2 * a + m\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid dice for diceavg');\n                if (args.length === 1) {\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\n                    if (!res || res.length < 3) return null;\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = parseInt(args[0]);\n                    sides = args[1].trim();\n                    if (args.length > 2)\n                        mod = args[2].trim();\n                }\n                else\n                    throw new ArgumentTooManyError('diceavg');\n                min = 1;\n                if (sides === 'F' || sides === 'f') {\n                    min = -1;\n                    max = 1;\n                }\n                else if (sides === '%') {\n                    min = 0;\n                    max = 1;\n                }\n                else\n                    max = parseInt(sides);\n\n                if (mod)\n                    return this.evaluate(((min + max) / 2 * c) + mod);\n                return '' + ((min + max) / 2 * c);\n            case 'dicemin':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid dice for dicemin');\n                if (args.length === 1) {\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\n                    if (!res || res.length < 3) return null;\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = parseInt(args[0]);\n                    sides = args[1].trim();\n                    if (args.length > 2)\n                        mod = args[2];\n                }\n                else\n                    throw new ArgumentTooManyError('dicemin');\n                min = 1;\n                if (sides === 'F' || sides === 'f')\n                    min = -1;\n                else if (sides === '%')\n                    min = 0;\n\n                if (mod)\n                    return this.evaluate((min * c) + mod);\n                return '' + (min * c);\n            case 'dicemax':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid dice for dicemax');\n                if (args.length === 1) {\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\n                    if (!res || res.length < 3) return null;\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = parseInt(args[0]);\n                    sides = args[1].trim();\n                    if (args.length > 2)\n                        mod = args[2].trim();\n                }\n                else\n                    throw new ArgumentTooManyError('dicemax');\n\n                if (sides === 'F' || sides === 'f')\n                    max = 1;\n                else if (sides === '%')\n                    max = 1;\n                else\n                    max = parseInt(sides);\n                if (mod)\n                    return this.evaluate((max * c) + mod);\n                return '' + (max * c);\n            case 'zdicedev':\n            case 'dicedev':\n                const fun = res[1];\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid dice for ' + fun);\n                if (args.length === 1) {\n                    res = /(\\d+)d(F|f|%|\\d+)([-|+|*|/]?\\d+)?/g.exec(args[0]);\n                    if (!res || res.length < 3) return null;\n                    c = parseInt(res[1]);\n                    sides = res[2];\n                    if (res.length > 3)\n                        mod = res[3];\n                }\n                else if (args.length < 4) {\n                    c = parseInt(args[0]);\n                    sides = args[1].trim();\n                    if (args.length > 2)\n                        mod = args[2].trim();\n                }\n                else\n                    throw new ArgumentTooManyError('' + fun);\n\n                if (sides === 'F' || sides === 'f')\n                    max = 6;\n                else if (sides === '%')\n                    max = 1;\n                else\n                    max = parseInt(sides);\n\n                //zmud formula seems to be 0 index based\n                if (fun === 'zdicedev')\n                    max--;\n                if (mod)\n                    return this.evaluate(Math.sqrt(((max * max) - 1) / 12 * c) + mod);\n                return '' + Math.sqrt(((max * max) - 1) / 12 * c);\n            case 'color':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('color');\n                else if (args.length === 1) {\n                    if (args[0] === 'bold')\n                        return '370';\n                    c = getAnsiColorCode(args[0]);\n                    if (c === -1)\n                        throw new InvalidForeColorError();\n                    return c.toString();\n                }\n                else if (args.length === 2) {\n                    if (args[0] === 'bold')\n                        c = 370;\n                    else {\n                        c = getAnsiColorCode(args[0]);\n                        if (c === -1)\n                            throw new InvalidForeColorError();\n                        if (args[1] === 'bold')\n                            return (c * 10).toString();\n                    }\n                    sides = c.toString();\n                    c = getAnsiColorCode(args[1], true);\n                    if (c === -1)\n                        throw new InvalidBackColorError();\n                    return sides + ',' + c.toString();\n                }\n                else if (args.length === 3) {\n                    if (args[0] === 'bold') {\n                        args.shift();\n                        args.push('bold');\n                    }\n                    if (args[2] !== 'bold')\n                        throw new Error('Only bold is supported as third argument for color');\n                    c = getAnsiColorCode(args[0]);\n                    if (c === -1)\n                        throw new InvalidForeColorError();\n                    sides = (c * 10).toString();\n                    c = getAnsiColorCode(args[1], true);\n                    if (c === -1)\n                        throw new InvalidBackColorError();\n                    return sides + ',' + c.toString();\n                }\n                throw new ArgumentTooManyError('color');\n            case 'zcolor':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('zcolor');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('zcolor');\n                return getColorCode(parseInt(args[0], 10));\n            case 'ansi':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('ansi');\n                c = args.length;\n                mod = [];\n                min = {};\n                for (sides = 0; sides < c; sides++) {\n                    if (args[sides].trim() === 'current')\n                        mod.push(args[sides].trim());\n                    else {\n                        max = getAnsiCode(args[sides].trim());\n                        if (max === -1)\n                            throw new Error('Invalid color or style for ansi');\n                        //style\n                        if (max >= 0 && max < 30)\n                            min[max] = 1;\n                        //color\n                        else\n                            mod.push(args[sides]);\n                    }\n                }\n                // fore,back\n                if (mod.length > 2)\n                    throw new Error('Too many colors for ansi');\n                if (mod.length > 1) {\n                    if (mod[1] === 'current')\n                        mod[1] = '';\n                    else\n                        mod[1] = getAnsiCode(mod[1], true);\n                }\n                if (mod.length > 0) {\n                    if (min[1] && mod[0] === 'white')\n                        mod[0] = '';\n                    else if (mod[0] === 'current')\n                        mod[0] = '';\n                    else\n                        mod[0] = getAnsiCode(mod[0]);\n                }\n\n                min = [...Object.keys(min), ...mod]\n                if (!min.length)\n                    throw new Error('Invalid colors or styles for ansi');\n                //remove any current flags\n                min = min.filter(f => f !== '');\n                return `\\x1b[${min.join(';')}m`;\n            case 'random':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0) throw new Error('Invalid random');\n                if (args.length === 1)\n                    return mathjs().randomInt(0, parseInt(args[0], 10) + 1);\n                else if (args.length === 2)\n                    return mathjs().randomInt(parseInt(args[0], 10), parseInt(args[1], 10) + 1);\n                else\n                    throw new ArgumentTooManyError('random');\n            case 'case': //case(index,n1,n2...)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('case');\n                c = this.evaluate(this.parseInline(args[0]));\n                if (typeof c !== 'number')\n                    return '';\n                if (c > 0 && c < args.length)\n                    return this.stripQuotes(args[c]);\n                return '';\n            case 'switch': //switch(exp,value...)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('switch');\n                if (args.length % 2 === 1)\n                    throw new Error('All expressions must have a value for switch');\n                sides = args.length;\n                for (c = 0; c < sides; c += 2) {\n                    if (this.evaluate(args[c]))\n                        return this.stripQuotes(args[c + 1]);\n                }\n                return '';\n            case 'if': //if(exp,true,false)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length < 3)\n                    throw new ArgumentMissingError('if');\n                if (args.length !== 3)\n                    throw new ArgumentTooManyError('if');\n                if (this.evaluate(args[0]))\n                    return this.stripQuotes(args[1].trim());\n                return this.stripQuotes(args[2].trim());\n            case 'ascii': //ascii(string)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('ascii');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('ascii');\n                if (args[0].trim().length === 0)\n                    throw new Error('Invalid argument, empty string for ascii');\n                return args[0].trim().charCodeAt(0);\n            case 'char': //char(number)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('char');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('char');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'char');\n                return String.fromCharCode(c);\n            case 'begins'://(string1,string2)` return true if string 1 starts with string 2\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length < 2)\n                    throw new ArgumentMissingError('begins');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('begins');\n                return this.stripQuotes(args[0]).startsWith(this.stripQuotes(args[1]));\n            case 'ends'://(string1, string2)` returns true if string 1 ends with string 2\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length < 2)\n                    throw new ArgumentMissingError('ends');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('ends');\n                return this.stripQuotes(args[0]).endsWith(this.stripQuotes(args[1]));\n            case 'len'://(string)` returns the length of string\n                return this.stripQuotes(this.parseInline(res[2])).length;\n            case 'stripansi':\n                const ansiRegex = new RegExp('[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)|(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-nq-uy=><~]))', 'g')\n                return this.stripQuotes(this.parseInline(res[2])).replace(ansiRegex, '');\n            case 'pos'://(pattern,string)` returns the position pattern in string on 1 index scale, 0 if not found\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length < 2)\n                    throw new ArgumentMissingError('pos');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('pos');\n                return this.stripQuotes(args[1]).indexOf(this.stripQuotes(args[0])) + 1;\n            case 'ipos'://(pattern,string)` returns the position pattern in string on 1 index scale, 0 if not found\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length < 2)\n                    throw new ArgumentMissingError('ipos');\n                else if (args.length > 2)\n                    throw new ArgumentTooManyError('ipos');\n                return this.stripQuotes(args[1]).toLowerCase().indexOf(this.stripQuotes(args[0]).toLowerCase()) + 1;\n            case 'regex'://(string,regex,var1,...,varN)\n                args = this.splitByQuotes(res[2], ',');\n                if (args.length < 2)\n                    throw new ArgumentMissingError('regex');\n                c = new RegExp(this.stripQuotes(args[1]), 'gd');\n                c = c.exec(this.stripQuotes(this.parseInline(args[0])));\n                args.shift();\n                args.shift();\n                if (c == null || c.length === 0)\n                    return 0;\n                if (args.length) {\n                    for (sides = 1; sides < c.length; sides++) {\n                        if (!args.length)\n                            break;\n                        this.client.variables[this.stripQuotes(this.parseInline(args[0]))] = c[sides];\n                        args.shift();\n                    }\n                    if (args.length)\n                        this.client.variables[this.stripQuotes(this.parseInline(args[0]))] = c[0].length;\n                }\n                if (!c.indices[0])\n                    return 1;\n                return c.indices[0][0] + 1;\n            case 'trim':\n                return this.stripQuotes(this.parseInline(res[2])).trim();\n            case 'trimleft':\n                return this.stripQuotes(this.parseInline(res[2])).trimLeft();\n            case 'trimright':\n                return this.stripQuotes(this.parseInline(res[2])).trimRight();\n            case 'bitand'://bitand(v1,v2)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitand');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitand');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitand');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitand');\n                return c & sides;\n            case 'bitnot'://bitnot(v1)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitnot');\n                else if (args.length !== 1)\n                    throw new ArgumentTooManyError('bitnot');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitnot');\n                return ~c;\n            case 'bitor': //bitor(v1,v2)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitor');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitor');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitor');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitor');\n                return c | sides;\n            case 'bitset':\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitset');\n                else if (args.length > 3)\n                    throw new ArgumentTooManyError('bitset');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitset');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitset');\n                sides--;\n                mod = 1;\n                if (args.length === 3) {\n                    mod = parseInt(args[2], 10);\n                    if (isNaN(mod))\n                        throw new ArgumentInvalidNumberError(args[2], 'bitset');\n                }\n                return (c & (~(1 << sides))) | ((mod ? 1 : 0) << sides);\n            case 'bitshift'://bitshift(value,num)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitshift');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitshift');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitshift');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitshift');\n                if (sides < 0)\n                    return c >> -sides;\n                return c << sides\n            case 'bittest'://bittest(i,bitnum)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bittest');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bittest');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bittest');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bittest');\n                sides--;\n                return ((c >> sides) % 2 != 0) ? 1 : 0;\n            case 'bitxor'://bitxor(v1,v2)\n                args = this.parseInline(res[2]).split(',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('bitxor');\n                else if (args.length !== 2)\n                    throw new ArgumentTooManyError('bitxor');\n                c = parseInt(args[0], 10);\n                if (isNaN(c))\n                    throw new ArgumentInvalidNumberError(args[0], 'bitxor');\n                sides = parseInt(args[1], 10);\n                if (isNaN(sides))\n                    throw new ArgumentInvalidNumberError(args[1], 'bitxor');\n                return c ^ sides;\n            case 'number': //number(s)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('number');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('number');\n                args[0] = this.stripQuotes(args[0], true);\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/))\n                    return parseInt(args[0], 10);\n                else if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return parseFloat(args[0]);\n                else if (args[0] === \"true\")\n                    return 1;\n                else if (args[0] === \"false\")\n                    return 0;\n                return 0;\n            case 'isfloat'://isfloat(value)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('isfloat');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('isfloat');\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return 1;\n                return 0;\n            case 'isnumber': //isnumber(s)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('isnumber');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('isnumber');\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return 1;\n                return 0;\n            case 'string'://string(value)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('string');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('string');\n                return `\"${this.stripQuotes(args[0]), true}\"`;\n            case 'float'://float(value)\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('float');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('float');\n                args[0] = this.stripQuotes(args[0], true);\n                if (args[0].match(/^\\s*?[-|+]?\\d+\\s*?$/) || args[0].match(/^\\s*?[-|+]?\\d+\\.\\d+\\s*?$/))\n                    return parseFloat(args[0]);\n                else if (args[0] === 'true')\n                    return 1.0;\n                else if (args[0] === 'false')\n                    return 0.0;\n                return 0;\n            case 'isdefined':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('isdefined');\n                else if (args.length > 1)\n                    throw new ArgumentTooManyError('isdefined');\n                args[0] = this.stripQuotes(args[0], true);\n                if (this.client.variables.hasOwnProperty(args[0]))\n                    return 1;\n                return 0;\n            case 'defined':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('defined');\n                else if (args.length === 1) {\n                    args[0] = this.stripQuotes(args[0], true);\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0) return 0;\n                    //have to check each profile as the client only caches enabled items for speed\n                    for (; k < kl; k++) {\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                        sides = sides.find(i => {\n                            return i.pattern === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                        sides = sides.find(i => {\n                            return i.pattern === args[0] || i.name === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].macros);\n                        sides = sides.find(i => {\n                            return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\n                        });\n                        if (sides) return 1;\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                        sides = sides.find(i => {\n                            return i.caption === args[0] || i.name === args[0]\n                        });\n                        if (sides) return 1;\n                    }\n                    return this.client.variables.hasOwnProperty(args[0]);\n                }\n                else if (args.length === 2) {\n                    args[0] = this.stripQuotes(args[0], true);\n                    args[1] = this.stripQuotes(args[1], true).toLowerCase();\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0) return 0;\n                    //have to check each profile as the client only caches enabled items for speed\n                    for (; k < kl; k++) {\n                        switch (args[1]) {\n                            case 'alias':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                                sides = sides.find(i => {\n                                    return i.pattern === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'event':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                sides = sides.find(i => {\n                                    return i.type === TriggerType.Event && (i.pattern === args[0] || i.name === args[0]);\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'trigger':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                                sides = sides.find(i => {\n                                    return i.pattern === args[0] || i.name === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'macro':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].macros);\n                                sides = sides.find(i => {\n                                    return MacroDisplay(i).toLowerCase() === args[0].toLowerCase() || i.name === args[0];\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            case 'button':\n                                sides = SortItemArrayByPriority(this._profiles.items[keys[k]].aliases);\n                                sides = sides.find(i => {\n                                    return i.caption === args[0] || i.name === args[0]\n                                });\n                                if (sides) return 1;\n                                return 0;\n                            //case 'variable':\n                            //case 'path':\n                            //case 'status':\n                            //case 'class':\n                            //case 'menu':                        \n                            //case 'module':\n                        }\n                    }\n                    if (args[1] === 'variable')\n                        return this.client.variables.hasOwnProperty(args[0]);\n                }\n                else\n                    throw new ArgumentTooManyError('defined');\n                return 0;\n            case 'escape':\n                args = this.stripQuotes(this.parseInline(res[2]));\n                if (this._getOption('allowEscape')) {\n                    c = escape;\n                    if (escape === '\\\\')\n                        c += escape;\n                    if (this._getOption('parseDoubleQuotes'))\n                        c += '\"';\n                    if (this._getOption('parseSingleQuotes'))\n                        c += '\\'';\n                    if (this._getOption('commandStacking'))\n                        c += this._getOption('commandStackingChar');\n                    if (this._getOption('enableSpeedpaths'))\n                        c += this._getOption('speedpathsChar');\n                    if (this._getOption('enableCommands'))\n                        c += this._getOption('commandChar');\n                    if (this._getOption('enableVerbatim'))\n                        c += this._getOption('verbatimChar');\n                    if (this._getOption('enableDoubleParameterEscaping'))\n                        c += this._getOption('parametersChar');\n                    if (this._getOption('enableNParameters'))\n                        c += this._getOption('nParametersChar');\n                    return args.replace(new RegExp(`[${c}]`, 'g'), escape + '$&');\n                }\n                return args.replace(/[\\\\\"']/g, '\\$&');\n            case 'unescape':\n                args = this.stripQuotes(this.parseInline(res[2]));\n                if (this._getOption('allowEscape')) {\n                    c = escape;\n                    if (escape === '\\\\')\n                        c += escape;\n                    if (this._getOption('parseDoubleQuotes'))\n                        c += '\"';\n                    if (this._getOption('parseSingleQuotes'))\n                        c += '\\'';\n                    if (this._getOption('commandStacking'))\n                        c += this._getOption('commandStackingChar');\n                    if (this._getOption('enableSpeedpaths'))\n                        c += this._getOption('speedpathsChar');\n                    if (this._getOption('enableCommands'))\n                        c += this._getOption('commandChar');\n                    if (this._getOption('enableVerbatim'))\n                        c += this._getOption('verbatimChar');\n                    if (this._getOption('enableDoubleParameterEscaping'))\n                        c += this._getOption('parametersChar');\n                    if (this._getOption('enableNParameters'))\n                        c += this._getOption('nParametersChar');\n                    if (escape === '\\\\')\n                        return args.replace(new RegExp(`\\\\\\\\[${c}]`, 'g'), (m) => m.substr(1));\n                    return args.replace(new RegExp(`${escape}[${c}]`, 'g'), (m) => m.substr(1));\n                }\n                return args.replace(/\\\\[\\\\\"']/g, (m) => m.substr(1));\n            case 'alarm':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('alarm');\n                if (args.length > 3)\n                    throw new ArgumentTooManyError('alarm');\n                args[0] = this.stripQuotes(args[0]);\n                sides = this.client.alarms;\n                max = sides.length;\n                if (max === 0)\n                    throw new Error('No alarms set.');\n                c = 0;\n                if (args.length === 1) {\n                    for (; c < max; c++) {\n                        //only main state counts here\n                        if (sides[c].type !== TriggerType.Alarm) continue;\n                        if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\n                            if (sides[c].suspended)\n                                return 0;\n                            return this.client.getRemainingAlarmTime(c);\n                        }\n                    }\n                }\n                else if (args.length === 2) {\n                    mod = parseInt(args[1], 10);\n                    if (isNaN(mod)) {\n                        args[1] = this.stripQuotes(args[1].trim());\n                        for (; c < max; c++) {\n                            //only main state counts here\n                            if (sides[c].type !== TriggerType.Alarm) continue;\n                            if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\n                                if (sides[c].profile.name.toUpperCase() !== args[1].toUpperCase())\n                                    continue;\n                                if (sides[c].suspended)\n                                    return 0;\n                                return this.client.getRemainingAlarmTime(c);\n                            }\n                        }\n                        throw Error('Alarm not found in profile: ' + args[1] + '.');\n                    }\n                    else {\n                        for (; c < max; c++) {\n                            //only main state counts here\n                            if (sides[c].type !== TriggerType.Alarm) continue;\n                            if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\n                                if (!sides[c].suspended)\n                                    this.client.setAlarmTempTime(c, mod);\n                                return mod;\n                            }\n                        }\n                        throw Error('Alarm not found.');\n                    }\n                }\n                else if (args.length === 3) {\n                    mod = parseInt(args[1], 10);\n                    if (isNaN(mod))\n                        throw new Error('Invalid time for alarm');\n                    args[2] = this.stripQuotes(args[2].trim());\n                    for (; c < max; c++) {\n                        //only main state counts here\n                        if (sides[c].type !== TriggerType.Alarm) continue;\n                        if (sides[c].name === args[0] || sides[c].pattern === args[0]) {\n                            if (sides[c].profile.name.toUpperCase() !== args[2].toUpperCase())\n                                continue;\n                            if (!sides[c].suspended)\n                                this.client.setAlarmTempTime(c, mod);\n                            return mod;\n                        }\n                    }\n                    throw Error('Could not set time, alarm not found in profile: ' + args[2] + '.');\n                }\n                return 0;\n            case 'state':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    throw new ArgumentMissingError('state');\n                if (args.length > 2)\n                    throw new ArgumentTooManyError('state');\n                args[0] = this.stripQuotes(args[0]);\n                mod = null;\n                if (args.length === 1) {\n                    const keys = this._profiles.keys;\n                    let k = 0;\n                    const kl = keys.length;\n                    if (kl === 0)\n                        return null;\n                    if (kl === 1) {\n\n                        if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                            throw Error('No enabled profiles found!');\n                        sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                        sides = sides.find(t => {\n                            return t.name === args[0] || t.pattern === args[0];\n                        });\n                    }\n                    else {\n                        for (; k < kl; k++) {\n                            if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                                continue;\n                            sides = SortItemArrayByPriority(this._profiles.items[keys[k]].triggers);\n                            sides = sides.find(t => {\n                                return t.name === args[0] || t.pattern === args[0];\n                            });\n                            if (sides)\n                                break;\n                        }\n                    }\n                }\n                else if (args.length === 2) {\n                    args[1] = this.stripQuotes(args[1].trim());\n                    if (this._profiles.contains(args[1]))\n                        mod = this._profiles.items[args[1].toLowerCase()];\n                    else\n                        throw new ProfileNotFound(args[1]);\n                    sides = SortItemArrayByPriority(mod.triggers);\n                    sides = sides.find(t => {\n                        return t.name === args[0] || t.pattern === args[0];\n                    });\n                }\n                if (sides)\n                    return sides.triggers && sides.triggers.length ? sides.state : 0;\n                throw new TriggerNotFound();\n            case 'isnull':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    return null;\n                if (args.length !== 1)\n                    throw new ArgumentTooManyError('null');\n                return this.evaluate(args[0]) === null ? 1 : 0;\n            case 'prompt':\n                args = this.splitByQuotes(this.parseInline(res[2]), ',');\n                if (args.length === 0)\n                    return window.prompt() || '';\n                if (args.length > 3)\n                    throw new ArgumentTooManyError('prompt');\n                args = args.map(a => this.stripQuotes(a));\n                return window.prompt(...args) || '';\n            /*\n        case 'fileprompt':\n            args = this.splitByQuotes(this.parseInline(res[2]), ',');\n            if (args.length > 2)\n                throw new ArgumentTooManyError('fileprompt');\n            args = args.map(a => this.stripQuotes(a));\n            let f = [\n                { name: 'All files (*.*)', extensions: ['*'] },\n            ];\n            if (args.length > 0 && args[0].trim().length > 0) {\n                f.unshift({\n                    name: args[0],\n                    extensions: args[0].split(',').map(a => a.trim())\n                })\n            }\n            let files = dialog.showOpenDialogSync({\n                filters: f,\n                properties: ['openFile', 'promptToCreate'],\n                defaultPath: args.length >= 2 ? parseTemplate(args[1]) : ''\n            });\n            if (files && files.length) return files[0];\n            return '';\n            */\n        }\n        const data: FunctionEvent = { raw: text, name: res[1], args: res[2] && res[2].length ? this.parseOutgoing(res[2]).split(',') : [], handled: false, return: null };\n        this.client.emit('variable', data);\n        if (data.handled)\n            return data.return;\n        return null;\n    }\n\n    public GetNamedArguments(str: string, args, append?: boolean) {\n        if (str === '*')\n            return args;\n        if (append == null) append = false;\n        if (str == null || str.length === 0)\n            return append ? args : [];\n        const n = str.split(',');\n        const nl = n.length;\n        const al = args.length;\n        //no values to process\n        if (nl === 0)\n            return append ? args : [];\n        let named;\n\n        if (append)\n            named = args.slice();\n        else\n            named = [];\n        for (let s = 0; s < nl; s++) {\n            n[s] = $.trim(n[s]);\n            if (n[s].length < 1) continue;\n            if (n[s].startsWith('$')) n[s] = n[s].substring(1);\n            if (!n[s].match(/^[a-zA-Z0-9_][a-zA-Z0-9_]+$/g)) continue;\n            if (!isValidIdentifier(n[s])) continue;\n            if (named[n[s]]) continue;\n            named[n[s]] = (s + 1 < al) ? args[s + 1] : '';\n        }\n        return named;\n    }\n\n    public ExecuteAlias(alias, args) {\n        if (!alias.enabled) return;\n        let ret; // = '';\n        if (alias.value.length)\n            switch (alias.style) {\n                case 1:\n                    this._stack.push({ loops: [], args: args, named: this.GetNamedArguments(alias.params, args), append: alias.append, used: 0 });\n                    ret = this.parseOutgoing(alias.value, null, null, true);\n                    this._stack.pop();\n                    break;\n                case 2:\n                    if ((this._getOption('echo') & 2) === 2)\n                        this._echo(alias.value, -7, -8, true, true);\n                    const named = this.GetNamedArguments(alias.params, args);\n                    if (named)\n                        ret = Object.keys(named).map(v => `let ${v} = this.input.stack.named[\"${v}\"];`).join('') + '\\n';\n                    else\n                        ret = '';\n                    /*jslint evil: true */\n                    const f = new Function('try { ' + ret + alias.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\n                    this._stack.push({ loops: [], args: args, named: named, append: alias.append, used: 0 });\n                    try {\n                        ret = f.apply(this.client, args);\n                    }\n                    catch (e) {\n                        throw e;\n                    }\n                    finally {\n                        this._stack.pop();\n                    }\n                    if (typeof ret === 'string')\n                        ret = this.parseOutgoing(ret, null, null, true);\n                    break;\n                default:\n                    ret = alias.value;\n                    break;\n            }\n        if (ret == null || ret === undefined)\n            return null;\n        ret = this.ExecuteTriggers(TriggerTypes.CommandInputRegular | TriggerTypes.CommandInputPattern, ret, ret, false, true);\n        if (ret == null || ret === undefined)\n            return null;\n        //Convert to string\n        if (typeof ret !== 'string')\n            ret = ret.toString();\n        if (ret.length === 0 && !this._getOption('returnNewlineOnEmptyValue'))\n            return null;\n        if (ret.endsWith('\\n'))\n            return ret;\n        return ret + '\\n';\n    }\n\n    public ProcessMacros(keycode, alt, ctrl, shift, meta) {\n        if (!keycode || (keycode > 9 && keycode < 19)) return false;\n        //not loaded yet so cant process so just bail\n        if (!this._profiles) return false;\n        //if(!this._getOption('enableMacros')) return false;\n        //Possible cache by modifier but  not sure if it it matters as there is a limit of 1 macro per key combo so at most there probably wont be more then 5 to maybe 20 macros per key\n        //const macros = this._MacroCache[`${keycode}_${mod}`] || (this._MacroCache[`${keycode}_${mod}`] = FilterArrayByKeyValue(FilterArrayByKeyValue(this.client.macros, 'key', keycode), 'modifiers', mod));\n        const macros = this._MacroCache[keycode] || (this._MacroCache[keycode] = FilterArrayByKeyValue(this.client.macros, 'key', keycode));\n        let m = 0;\n        const ml = macros.length;\n        let mod = MacroModifiers.None;\n        if (alt)\n            mod |= MacroModifiers.Alt;\n        if (ctrl)\n            mod |= MacroModifiers.Ctrl;\n        if (shift)\n            mod |= MacroModifiers.Shift;\n        if (meta)\n            mod |= MacroModifiers.Meta;\n        for (; m < ml; m++) {\n            if (!macros[m].enabled || mod !== macros[m].modifiers) continue;\n            if (this.ExecuteMacro(macros[m]))\n                return true;\n        }\n        return false;\n    }\n\n    public ExecuteMacro(macro) {\n        if (!macro.enabled) return false;\n        let ret; // = '';\n        if (macro.value.length)\n            switch (macro.style) {\n                case 1:\n                    this._stack.push({ loops: [], args: 0, named: 0, used: 0 });\n                    try {\n                        ret = this.parseOutgoing(macro.value);\n                    }\n                    catch (e) {\n                        throw e;\n                    }\n                    finally {\n                        this._stack.pop();\n                    }\n                    break;\n                case 2:\n                    if ((this._getOption('echo') & 2) === 2)\n                        this._echo(macro.value, -7, -8, true, true);\n                    /*jslint evil: true */\n                    const f = new Function('try { ' + macro.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\n                    this._stack.push({ loops: [], args: 0, named: 0, used: 0 });\n                    try {\n                        ret = f.apply(this.client);\n                    }\n                    catch (e) {\n                        throw e;\n                    }\n                    finally {\n                        this._stack.pop();\n                    }\n                    break;\n                default:\n                    ret = macro.value;\n                    break;\n            }\n        if (ret == null || ret === undefined)\n            return true;\n        //Convert to string\n        if (typeof ret !== 'string')\n            ret = ret.toString();\n        if (ret.length === 0 && !this._getOption('returnNewlineOnEmptyValue'))\n            return null;\n        if (macro.send) {\n            if (!ret.endsWith('\\n'))\n                ret += '\\n';\n            if (macro.chain && this.client.commandInput.value.endsWith(' ')) {\n                this.client.commandInput.value = this.client.commandInput.value + ret;\n                this.client.sendCommand(null, null, this._getOption('allowCommentsFromCommand'));\n            }\n            else\n                this.client.send(ret, true);\n        }\n        else if (macro.append)\n            this.client.commandInput.value = this.client.commandInput.value + ret;\n        return true;\n    }\n\n    public ProcessPath(str, replace?: boolean) {\n        if (str.length === 0)\n            return '';\n        let out: string[] = [];\n\n        let state = 0;\n        let cmd: string = '';\n        let num: string = '';\n        let idx = 0;\n        let c: string;\n        let i: number;\n        let t;\n        let p;\n        let n = 0;\n        const tl: number = str.length;\n\n        for (; idx < tl; idx++) {\n            c = str.charAt(idx);\n            i = str.charCodeAt(idx);\n            switch (state) {\n                case 1:\n                    if (i > 47 && i < 58)\n                        num += c;\n                    else if (c === '\\\\')\n                        state = 2;\n                    else {\n                        state = 0;\n                        cmd = c;\n                    }\n                    break;\n                case 2:\n                    if (i > 47 && i < 58)\n                        cmd += c;\n                    else {\n                        cmd += '\\\\';\n                        idx--;\n                    }\n                    state = 0;\n                    break;\n                case 3:\n                    if (n === 0 && c === ')')\n                        state = 0;\n                    else {\n                        if (c === '(')\n                            n++;\n                        else if (c === ')')\n                            n--;\n                        cmd += c;\n                    }\n                    break;\n                case 4:\n                    if (n === 0 && c === '}')\n                        state = 0;\n                    else {\n                        if (c === '{')\n                            n++;\n                        else if (c === '}')\n                            n--;\n                        cmd += c;\n                    }\n                    break;\n                default:\n                    if (i > 47 && i < 58) {\n                        if (cmd.length > 0) {\n                            if (num.length === 0)\n                                t = 1;\n                            else\n                                t = parseInt(num, 10);\n                            for (p = 0; p < t; p++)\n                                out.push(cmd);\n                            cmd = '';\n                        }\n                        state = 1;\n                        num = c;\n                    }\n                    else if (c === '(') {\n                        state = 3;\n                        n = 0;\n                    }\n                    else if (c === '{') {\n                        state = 4;\n                        n = 0;\n                    }\n                    else if (c === '\\\\')\n                        state = 2;\n                    else\n                        cmd += c;\n                    break;\n            }\n        }\n\n        if (cmd.length > 0) {\n            if (num.length === 0)\n                t = 1;\n            else\n                t = parseInt(num, 10);\n            for (p = 0; p < t; p++)\n                out.push(cmd);\n        }\n        if (replace && this._pathQueue.length) {\n            this._pathQueue[0] = {\n                id: str,\n                current: out,\n                previous: []\n            };\n        }\n        else\n            this._pathQueue.push({\n                id: str,\n                current: out,\n                previous: []\n            });\n        this.ExecutePath();\n        return null;\n    }\n\n    public ExecutePath() {\n        //if already running or no queue bail\n        if (this._pathTimeout || !this._pathQueue.length || this._pathPaused) return;\n        let delay = this._getOption('pathDelay');\n        if (delay < 0) delay = 0;\n        //being processing query\n        this._pathTimeout = setTimeout(() => {\n            const pPath = this._getOption('parseSpeedpaths');\n            const ePath = this._getOption('echoSpeedpaths');\n            let cnt = this._getOption('pathDelayCount');\n            if (cnt < 1) cnt = 1;\n            const current = this._pathQueue[0];\n            /*\n            if (!current.previous.length) {\n                if (this.client.telnet.echo && this._getOption('commandEcho'))\n                    this._echo(this._getOption('speedpathsChar') + current.id);\n                else\n                    this._echo('\\n');\n            }\n            */\n            while (cnt--) {\n                let cmd = current.current.shift();\n                current.previous.push(cmd);\n                if (pPath)\n                    this.client.sendBackground(cmd + '\\n', !ePath);\n                else\n                    this.client.send(cmd + '\\n', !ePath);\n                if (!current.current.length) break;\n            }\n            //if at the end remove\n            if (!current.current.length)\n                this._pathQueue.shift();\n            this._pathTimeout = null;\n            //step manually so do not call next block, allows commands to handle steeping instead of auto moving to next one\n            if (this._pathQueue.length && this._pathQueue[0].manual)\n                return;\n            //process next paths\n            this.ExecutePath();\n        }, delay);\n    }\n\n    public toggleScrollLock() {\n        this.scrollLock = !this.scrollLock;\n    }\n\n    /*\n    private _hasTriggerType(types: TriggerTypes | SubTriggerTypes, type: TriggerType | SubTriggerTypes): boolean {\n        if (type === TriggerType.Alarm && (types & TriggerTypes.Alarm) == TriggerTypes.Alarm)\n            return true;\n        if (type === TriggerType.CommandInputPattern && (types & TriggerTypes.CommandInputPattern) == TriggerTypes.CommandInputPattern)\n            return true;\n        if (type === TriggerType.CommandInputRegular && (types & TriggerTypes.CommandInputRegular) == TriggerTypes.CommandInputRegular)\n            return true;\n        if (type === TriggerType.Event && (types & TriggerTypes.Event) == TriggerTypes.Event)\n            return true;\n        if (type === TriggerType.Pattern && (types & TriggerTypes.Pattern) == TriggerTypes.Pattern)\n            return true;\n        if (type === TriggerType.Regular && (types & TriggerTypes.Regular) == TriggerTypes.Regular)\n            return true;\n        if (type === TriggerType.LoopExpression && (types & TriggerTypes.LoopExpression) == TriggerTypes.LoopExpression)\n            return true;\n        //if (type === TriggerType.Expression && (types & TriggerTypes.Expression) == TriggerTypes.Expression)\n        //return true;            \n        return false;\n    }\n    */\n\n    private _isSubTriggerType(type) {\n        if ((type & SubTriggerTypes.Skip) == SubTriggerTypes.Skip)\n            return true;\n        if ((type & SubTriggerTypes.Wait) == SubTriggerTypes.Wait)\n            return true;\n        if ((type & SubTriggerTypes.LoopPattern) == SubTriggerTypes.LoopPattern)\n            return true;\n        if ((type & SubTriggerTypes.LoopLines) == SubTriggerTypes.LoopLines)\n            return true;\n        if ((type & SubTriggerTypes.Duration) == SubTriggerTypes.Duration)\n            return true;\n        if ((type & SubTriggerTypes.WithinLines) == SubTriggerTypes.WithinLines)\n            return true;\n        if ((type & SubTriggerTypes.Manual) == SubTriggerTypes.Manual)\n            return true;\n        if ((type & SubTriggerTypes.ReParse) == SubTriggerTypes.ReParse)\n            return true;\n        if ((type & SubTriggerTypes.ReParsePattern) == SubTriggerTypes.ReParsePattern)\n            return true;\n        return false;\n    }\n\n    private _getTriggerType(type: TriggerType | SubTriggerTypes) {\n        if (type === TriggerType.Regular)\n            return TriggerTypes.Regular;\n        if (type === TriggerType.Alarm)\n            return TriggerTypes.Alarm;\n        return type;\n    }\n\n    public ExecuteTriggers(type: TriggerTypes, line?, raw?, frag?: boolean, ret?: boolean, subtypes?: boolean) {\n        if (!this.enableTriggers || line == null) return line;\n        if (ret == null) ret = false;\n        if (frag == null) frag = false;\n        //make sure raw is set\n        raw = raw || line;\n        this.buildTriggerCache();\n        let t = 0;\n        let pattern;\n        let changed = false;\n        let val;\n        //scope to get performance\n        const triggers = this._TriggerCache;\n        const tl = triggers.length;\n        const states = this._TriggerStates;\n        const rCache = this._TriggerRegExCache;\n        let tType;\n        for (; t < tl; t++) {\n            let trigger = triggers[t];\n            const parent = trigger;\n            //extra check in case error disabled it and do not want to keep triggering the error\n            if (!trigger.enabled) continue;\n            //safety check in case a state was deleted\n            if (!parent.triggers || !parent.triggers.length || trigger.state > parent.triggers.length)\n                parent.state = 0;\n            if (trigger.state !== 0 && parent.triggers && parent.triggers.length) {\n                //trigger states are 1 based as 0 is parent trigger\n                trigger = parent.triggers[trigger.state - 1];\n                //skip disabled states\n                while (!trigger.enabled && parent.state !== 0) {\n                    //advance state\n                    parent.state++;\n                    //if no more states start over and stop\n                    if (parent.state > parent.triggers.length) {\n                        parent.state = 0;\n                        //reset to first state\n                        trigger = parent;\n                        //stop checking\n                        break;\n                    }\n                    if (parent.state)\n                        trigger = parent.triggers[parent.state - 1];\n                    else\n                        trigger = parent;\n                    changed = true;\n                }\n                //changed state save\n                if (changed) {\n                    if (this._getOption('saveTriggerStateChanges'))\n                        this.client.saveProfiles();\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\n                }\n                //last check to be 100% sure enabled\n                if (!trigger.enabled) continue;\n            }\n            tType = this._getTriggerType(trigger.type);\n            if (trigger.type !== undefined && (type & tType) !== tType) {\n                if (!subtypes || (subtypes && !this._isSubTriggerType(trigger.type)))\n                    continue;\n            }\n            //manual can only be fired with #set\n            if (trigger.type === SubTriggerTypes.Manual) continue;\n            if (frag && !trigger.triggerPrompt) continue;\n            if (!frag && !trigger.triggerNewline && (trigger.triggerNewline !== undefined))\n                continue;\n            if (states[t]) {\n                if (states[t].type === SubTriggerTypes.Wait) {\n                    //time still has not passed\n                    if (states[t].time > Date.now())\n                        continue;\n                    delete states[t];\n                }\n                else if (states[t].type === SubTriggerTypes.Duration) {\n                    //trigger time has paused, delete it and advance\n                    if (states[t].time < Date.now()) {\n                        delete states[t];\n                        this._advanceTrigger(trigger, parent, t);\n                        //need to reparse as the state is no longer valid and the next state might be\n                        if (!states[t])\n                            states[t] = { reParse: true };\n                        else\n                            states[t].reParse = true;\n                        t = this.cleanUpTriggerState(t);\n                        continue;\n                    }\n                }\n                else if (states[t].type === SubTriggerTypes.Skip) {\n                    //skip until that many lines have passed\n                    if (states[t].lineCount > 0)\n                        continue;\n                    delete states[t];\n                }\n                else if (states[t].type === SubTriggerTypes.LoopLines) {\n                    //move on after line count\n                    if (states[t].lineCount < 1) {\n                        this._advanceTrigger(trigger, parent, t);\n                        //reparse as new state may be valid\n                        if (!states[t])\n                            states[t] = { reParse: true }\n                        else\n                            states[t].reParse = true;\n                        t = this.cleanUpTriggerState(t);\n                        continue;\n                    }\n                }\n                else if (states[t].type === SubTriggerTypes.WithinLines) {\n                    if (states[t].lineCount < 1) {\n                        this._advanceTrigger(trigger, parent, t);\n                        //reparse as new state may be valid\n                        if (!states[t])\n                            states[t] = { reParse: true }\n                        else\n                            states[t].reParse = true;\n                        t = this.cleanUpTriggerState(t);\n                        continue;\n                    }\n                }\n                /*\n                else if (states[t].type === TriggerType.LoopExpression) {\n                    //move on after line count\n                    if (states[t].loop != -1 && states[t].lineCount < 1) {\n                        this.advanceTrigger(trigger, parent, t);\n                        //reparse as new state may be valid\n                        if (!states[t])\n                            states[t] = { reParse: true }\n                        else\n                            states[t].reParse = true;\n                        t = this.cleanUpTriggerState(t);\n                        continue;\n                    }\n                }\n                */\n            }\n            try {\n                if (trigger.type === TriggerType.LoopExpression) {\n                    if (this.evaluate(this.parseInline(trigger.pattern))) {\n                        if (!states[t]) {\n                            const state = this.createTriggerState(trigger, false, parent);\n                            if (state)\n                                states[t] = state;\n                        }\n                        else if (states[t].loop !== -1 && states[t].lineCount < 1)\n                            continue;\n                        this._LastTriggered = (trigger.raw ? raw : line);\n                        val = this.ExecuteTrigger(trigger, [this._LastTriggered], ret, t, [this._LastTriggered], 0, parent);\n                    }\n                    else {\n                        //this.updateTriggerState(trigger, t);\n                        this._advanceTrigger(trigger, parent, t);\n                        continue;\n                    }\n                }\n                else if (trigger.verbatim) {\n                    if (!trigger.caseSensitive && (trigger.raw ? raw : line).toLowerCase() !== trigger.pattern.toLowerCase()) {\n                        //if reparse and if failed advance anyways\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\n                            this._advanceTrigger(trigger, parent, t);\n                            t = this.cleanUpTriggerState(t);\n                        }\n                        continue;\n                    }\n                    else if (trigger.caseSensitive && (trigger.raw ? raw : line) !== trigger.pattern) {\n                        //if reparse and if failed advance anyways\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\n                            this._advanceTrigger(trigger, parent, t);\n                            t = this.cleanUpTriggerState(t);\n                        }\n                        continue;\n                    }\n                    this._LastTriggered = (trigger.raw ? raw : line);\n                    val = this.ExecuteTrigger(trigger, [this._LastTriggered], ret, t, [this._LastTriggered], 0, parent);\n                }\n                else {\n                    let re;\n                    if (trigger.type === TriggerType.Pattern || trigger.type === TriggerType.CommandInputPattern || trigger.type === SubTriggerTypes.ReParsePattern)\n                        pattern = convertPattern(trigger.pattern, this.client);\n                    else\n                        pattern = trigger.pattern;\n                    if (trigger.caseSensitive)\n                        re = rCache['g' + pattern] || (rCache['g' + pattern] = new RegExp(pattern, 'gd'));\n                    else\n                        re = rCache['gi' + pattern] || (rCache['gi' + pattern] = new RegExp(pattern, 'gid'));\n                    //reset from last use always\n                    re.lastIndex = 0;\n                    const res = re.exec(trigger.raw ? raw : line);\n                    if (!res || !res.length) {\n                        //if reparse and if failed advance anyways\n                        if (!states[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\n                            this._advanceTrigger(trigger, parent, t);\n                            t = this.cleanUpTriggerState(t);\n                        }\n                        continue;\n                    }\n                    let args;\n                    this._LastTriggered = trigger.raw ? raw : line;\n                    if ((trigger.raw ? raw : line) === res[0] || !this._getOption('prependTriggeredLine'))\n                        args = res;\n                    else {\n                        args = [this._LastTriggered, ...res];\n                        args.indices = [[0, args[0].length], ...res.indices];\n                    }\n                    if (res.groups)\n                        Object.keys(res.groups).map(v => this.client.variables[v] = res.groups[v]);\n                    val = this.ExecuteTrigger(trigger, args, ret, t, [this._LastTriggered, re], res.groups, parent);\n                }\n                if (states[t] && states[t].reParse) {\n                    if (!states[t].type || states[t].type === SubTriggerTypes.ReParse || states[t].type === SubTriggerTypes.ReParsePattern)\n                        delete states[t];\n                    else\n                        delete states[t].reParse;\n                    t--;\n                }\n                else if (ret) return val;\n            }\n            catch (e) {\n                if (this._getOption('disableTriggerOnError')) {\n                    trigger.enabled = false;\n                    setTimeout(() => {\n                        this.client.saveProfiles();\n                        this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\n                    });\n                }\n                if (this._getOption('showScriptErrors'))\n                    this.client.error(e);\n                else\n                    this.client.debug(e);\n            }\n        }\n        return line;\n    }\n\n    public TestTrigger(trigger, parent, t, line?, raw?, frag?: boolean) {\n        let pattern;\n        try {\n            if (trigger.verbatim) {\n                if (!trigger.caseSensitive && (trigger.raw ? raw : line).toLowerCase() !== trigger.pattern.toLowerCase()) {\n                    //if reparse and if failed advance anyways\n                    if (!this._TriggerStates[t]) {\n                        this._advanceTrigger(trigger, parent, t);\n                        t = this.cleanUpTriggerState(t);\n                    }\n                    return t;\n                }\n                else if (trigger.caseSensitive && (trigger.raw ? raw : line) !== trigger.pattern) {\n                    //if reparse and if failed advance anyways\n                    if (!this._TriggerStates[t]) {\n                        this._advanceTrigger(trigger, parent, t);\n                        t = this.cleanUpTriggerState(t);\n                    }\n                    return t;\n                }\n                this._LastTriggered = (trigger.raw ? raw : line);\n                this.ExecuteTrigger(trigger, [this._LastTriggered], false, t, [this._LastTriggered], 0, parent);\n            }\n            else {\n                let re;\n                if (trigger.type === TriggerType.Pattern || trigger.type === TriggerType.CommandInputPattern || trigger.type === SubTriggerTypes.ReParsePattern)\n                    pattern = convertPattern(trigger.pattern, this.client);\n                else\n                    pattern = trigger.pattern;\n                if (trigger.caseSensitive)\n                    re = this._TriggerRegExCache['g' + pattern] || (this._TriggerRegExCache['g' + pattern] = new RegExp(pattern, 'gd'));\n                else\n                    re = this._TriggerRegExCache['gi' + pattern] || (this._TriggerRegExCache['gi' + pattern] = new RegExp(pattern, 'gid'));\n                //reset from last use always\n                re.lastIndex = 0;\n                const res = re.exec(trigger.raw ? raw : line);\n                if (!res || !res.length) {\n                    //if reparse and if failed advance anyways\n                    if (!this._TriggerStates[t] && (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern)) {\n                        this._advanceTrigger(trigger, parent, t);\n                        t = this.cleanUpTriggerState(t);\n                    }\n                    return t;\n                }\n                let args;\n                this._LastTriggered = (trigger.raw ? raw : line);\n                if ((trigger.raw ? raw : line) === res[0] || !this._getOption('prependTriggeredLine'))\n                    args = res;\n                else {\n                    args = [this._LastTriggered, ...res];\n                    args.indices = [[0, args[0].length], ...res.indices];\n                }\n                if (res.groups)\n                    Object.keys(res.groups).map(v => this.client.variables[v] = res.groups[v]);\n                this.ExecuteTrigger(trigger, args, false, t, [this._LastTriggered, re], res.groups, parent);\n            }\n            t = this.cleanUpTriggerState(t);\n        }\n        catch (e) {\n            if (this._getOption('disableTriggerOnError')) {\n                trigger.enabled = false;\n                setTimeout(() => {\n                    this.client.saveProfiles();\n                    this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\n                });\n            }\n            if (this._getOption('showScriptErrors'))\n                this.client.error(e);\n            else\n                this.client.debug(e);\n        }\n        return t;\n    }\n\n    public ExecuteTrigger(trigger, args, r: boolean, idx, regex?, named?, parent?: Trigger) {\n        if (r == null) r = false;\n        if (!trigger.enabled) return '';\n        if (this._TriggerStates[idx] && this._TriggerStates[idx].type === SubTriggerTypes.Duration)\n            delete this._TriggerStates[idx];\n        if (trigger.fired) {\n            trigger.fired = false;\n            this._advanceTrigger(trigger, parent, idx);\n            if (this._TriggerStates[idx])\n                this._TriggerStates[idx].reParse = true;\n            else\n                this._TriggerStates[idx] = { reParse: true };\n            return '';\n        }\n        this._LastTrigger = trigger;\n        let ret; // = '';\n        //remove temp and advance state before executing value in case it does a trigger on trigger to avoid double triggering\n        if (trigger.temp) {\n            if (parent.triggers.length) {\n                if (parent.state === 0) {\n                    //main trigger temp, replace with first state\n                    const item = parent.triggers.shift();\n                    item.triggers = parent.triggers;\n                    item.state = parent.state;\n                    item.name = parent.name;\n                    item.profile = parent.profile;\n                    //if removed temp shift state adjust\n                    if (item.state > item.triggers.length)\n                        item.state = 0;\n                    if (idx >= 0)\n                        this._TriggerCache[idx] = item;\n                    this.client.saveProfiles();\n                    const pIdx = parent.profile.triggers.indexOf(parent);\n                    parent.profile.triggers[pIdx] = item;\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, pIdx, item);\n                }\n                else {\n                    //remove only temp sub state\n                    parent.triggers.splice(parent.state - 1, 1);\n                    //if removed temp shift state adjust\n                    if (parent.state > parent.triggers.length)\n                        parent.state = 0;\n                    this.client.saveProfiles();\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\n                }\n            }\n            else {\n                if (idx >= 0)\n                    this._TriggerCache.splice(idx, 1);\n                if (this._TriggerStates[idx])\n                    this.clearTriggerState(idx);\n                this.client.removeTrigger(parent);\n            }\n        }\n        else if (parent.triggers.length)\n            this._advanceTrigger(trigger, parent, idx);\n        if ((this._getOption('echo') & 8) === 8)\n            this._echo('Trigger fired: ' + trigger.pattern, -7, -8, true, true);\n        if (trigger.value.length)\n            switch (trigger.style) {\n                case 1:\n                    this._stack.push({ loops: [], args: args, named: 0, used: 0, regex: regex });\n                    try {\n                        ret = this.parseOutgoing(trigger.value);\n                    }\n                    catch (e) {\n                        throw e;\n                    }\n                    finally {\n                        this._stack.pop();\n                    }\n                    break;\n                case 2:\n                    if ((this._getOption('echo') & 2) === 2)\n                        this._echo(trigger.value, -7, -8, true, true);\n                    //do not cache temp triggers\n                    if (trigger.temp) {\n                        /*jslint evil: true */\n                        ret = new Function('try { ' + trigger.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\n                        ret = ret.apply(this.client, args);\n                    }\n                    else {\n                        if (!this._TriggerFunctionCache[idx]) {\n                            if (named)\n                                ret = Object.keys(named).map(v => `let ${v} = this.variables[\"${v}\"];`).join('') + '\\n';\n                            else\n                                ret = '';\n                            /*jslint evil: true */\n                            this._TriggerFunctionCache[idx] = new Function('try { ' + ret + trigger.value + '\\n} catch (e) { if(this.getOption(\\'showScriptErrors\\')) this.error(e);}');\n                        }\n                        this._stack.push({ loops: [], args: args, named: 0, used: 0, regex: regex, indices: args.indices });\n                        try {\n                            ret = this._TriggerFunctionCache[idx].apply(this.client, args);\n                        }\n                        catch (e) {\n                            throw e;\n                        }\n                        finally {\n                            this._stack.pop();\n                        }\n                    }\n                    if (typeof ret === 'string')\n                        ret = this.parseOutgoing(ret);\n                    break;\n                default:\n                    ret = trigger.value;\n                    break;\n            }\n        if (ret == null || ret === undefined)\n            return null;\n        if (r)\n            return ret;\n        //Convert to string\n        if (typeof ret !== 'string')\n            ret = ret.toString();\n        if (ret.length === 0 && !this._getOption('returnNewlineOnEmptyValue'))\n            return null;\n        if (!ret.endsWith('\\n'))\n            ret += '\\n';\n        if (this.client.connected)\n            this.client.telnet.sendData(ret);\n        if (this.client.telnet.echo && this._getOption('commandEcho')) {\n            setTimeout(() => {\n                this._echo(ret);\n            }, 1);\n        }\n    }\n\n    private _advanceTrigger(trigger, parent, idx) {\n        if (this._TriggerStates[idx]) {\n            if (this._TriggerStates[idx].type === SubTriggerTypes.LoopPattern) {\n                this._TriggerStates[idx].loop--;\n                //stay on this state until loop is done\n                if (this._TriggerStates[idx].loop > 0)\n                    return;\n                this.clearTriggerState(idx);\n            }\n            //match within the # of lines so clear state and move on\n            else if (this._TriggerStates[idx].type === SubTriggerTypes.LoopLines) {\n                //keep matching until loop is over\n                if (this._TriggerStates[idx].lineCount > 0)\n                    return;\n                this.clearTriggerState(idx);\n            }\n            else if (this._TriggerStates[idx].type === SubTriggerTypes.WithinLines)\n                this.clearTriggerState(idx);\n            else if (this._TriggerStates[idx].type === TriggerType.LoopExpression) {\n                //infinite until expression is false\n                if (this._TriggerStates[idx].loop === -1)\n                    return;\n                //else if uses a line count\n                if (this._TriggerStates[idx].lineCount > 0)\n                    return;\n            }\n        }\n        parent.state++;\n        //1 based\n        if (parent.state > parent.triggers.length)\n            parent.state = 0;\n        //changed state save\n        if (this._getOption('saveTriggerStateChanges'))\n            this.client.saveProfiles();\n        this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\n        //is new subtype a reparse? if so reparse using current trigger instant\n        if (parent.state !== 0) {\n            const state = this.createTriggerState(parent.triggers[parent.state - 1]);\n            if (state)\n                this._TriggerStates[idx] = state;\n        }\n    }\n\n    public createTriggerState(trigger, reparse?, parent?) {\n        let params;\n        let state;\n        switch (trigger.type) {\n            case SubTriggerTypes.ReParse:\n            case SubTriggerTypes.ReParsePattern:\n                state = { reParse: true };\n                break;\n            case SubTriggerTypes.Duration:\n            case SubTriggerTypes.Wait:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 0;\n                }\n                else\n                    params = 0;\n                state = { time: Date.now() + params };\n                break;\n            case SubTriggerTypes.WithinLines:\n            case SubTriggerTypes.LoopLines:\n            case SubTriggerTypes.Skip:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 1;\n                }\n                else\n                    params = 1;\n                state = { lineCount: params + 1 };\n                break;\n            /*          \n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 1;\n                }\n                else\n                    params = 1;\n                state = { remoteCount: params + 1 };\n                break;\n            */\n            case SubTriggerTypes.LoopPattern:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 0;\n                }\n                else\n                    params = 0;\n                state = { loop: params };\n                break;\n            case TriggerType.LoopExpression:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 1;\n                    if (parent === trigger)\n                        state = { lineCount: params - 1 };\n                    else\n                        state = { lineCount: params };\n                }\n                else\n                    state = { loop: -1 };\n                break;\n        }\n        if (state)\n            state.type = trigger.type;\n        if (!state && reparse)\n            return { reParse: true };\n        else if (reparse)\n            state.reparse = true;\n        return state;\n    }\n\n    public updateTriggerState(trigger, idx) {\n        if (!this._TriggerStates[idx]) return;\n        let params;\n        switch (this._TriggerStates[idx].type) {\n            case SubTriggerTypes.Wait:\n            case SubTriggerTypes.Duration:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 0;\n                }\n                else\n                    params = 0;\n                this._TriggerStates[idx].time = Date.now() + params;\n                break;\n            case SubTriggerTypes.WithinLines:\n            case SubTriggerTypes.Skip:\n            case SubTriggerTypes.LoopLines:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 0;\n                }\n                else\n                    params = 0;\n                this._TriggerStates[idx].lineCount = params;\n                break;\n            /*\n                            params = trigger.params;\n                            if (params && params.length) {\n                                params = parseInt(params, 10);\n                                if (isNaN(params))\n                                    params = 0;\n                            }\n                            else\n                                params = 0;\n                            this._TriggerStates[idx].remoteCount = params;\n                            break;\n            */\n            case SubTriggerTypes.LoopPattern:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 0;\n                }\n                else\n                    params = 0;\n                this._TriggerStates[idx].loop = params;\n                break;\n            case TriggerType.LoopExpression:\n                params = trigger.params;\n                if (params && params.length) {\n                    params = parseInt(params, 10);\n                    if (isNaN(params))\n                        params = 1;\n                    this._TriggerStates[idx].lineCount = params + 1;\n                }\n                else\n                    this._TriggerStates[idx].loop = -1;\n                break;\n        }\n    }\n\n    public getTriggerState(idx) {\n        return this._TriggerStates[idx];\n    }\n\n    public cleanUpTriggerState(idx) {\n        if (this._TriggerStates[idx] && this._TriggerStates[idx].reParse) {\n            //remove only if reparse type of no type defined, else remove just the rePrase flag\n            if (!this._TriggerStates[idx].type || this._TriggerStates[idx].type === SubTriggerTypes.ReParse || this._TriggerStates[idx].type === SubTriggerTypes.ReParsePattern)\n                delete this._TriggerStates[idx];\n            else\n                delete this._TriggerStates[idx].reParse;\n            if (idx < 0)\n                idx++;\n            else\n                idx--;\n        }\n        return idx;\n    }\n\n    public clearTriggerState(idx) {\n        delete this._TriggerStates[idx];\n    }\n\n    public setTriggerState(idx, data) {\n        this._TriggerStates[idx] = data;\n    }\n\n    public clearTriggerCache() { this._TriggerCache = null; this._TriggerStates = {}; this._TriggerFunctionCache = {}; this._TriggerRegExCache = {}; }\n\n    public resetTriggerState(idx, oldState, oldFire?) {\n        if (idx === -1) return;\n        if (idx < 0 || idx >= this._TriggerCache.length) return;\n        let trigger = this._TriggerCache[idx];\n        //let oTrigger;\n        const parent = trigger;\n        let reParse = false;\n        if (parent.state !== 0)\n            trigger = parent.triggers[parent.state - 1];\n        /*\n        if (oldState === 0)\n            oTrigger = parent;\n        else\n            oTrigger = parent.triggers[oldState - 1];\n        */\n        if (oldState === parent.state) {\n            if (this._TriggerStates[idx]) {\n                if (!trigger.fired)\n                    this.updateTriggerState(trigger, idx);\n                else\n                    this.clearTriggerState(idx);\n            }\n            else {\n                if (!trigger.fired)\n                    this.updateTriggerState(trigger, idx);\n            }\n        }\n        else {\n            if (this._TriggerStates[idx]) {\n                if (!this._TriggerStates[idx].type || (this._TriggerStates[idx].type !== SubTriggerTypes.ReParsePattern && this._TriggerStates[idx].type !== SubTriggerTypes.ReParse))\n                    reParse = this._TriggerStates[idx].reParse;\n            }\n            this.clearTriggerState(idx);\n            if (!trigger.fired) {\n                const state = this.createTriggerState(trigger, reParse);\n                if (state)\n                    this._TriggerStates[idx] = state;\n            }\n            else\n                this._TriggerStates[idx] = { reParse: true };\n        }\n    }\n\n    public buildTriggerCache() {\n        if (this._TriggerCache == null) {\n            this._TriggerCache = this.client.triggers.filter((a) => {\n                if (a && a.enabled && a.triggers.length) {\n                    if (a.type !== TriggerType.Alarm) return true;\n                    //loop sub states if one is not alarm cache it for future\n                    for (let s = 0, sl = a.triggers.length; s < sl; s++)\n                        if (a.triggers[s].enabled && a.triggers[s].type !== TriggerType.Alarm)\n                            return true;\n                    return false;\n                }\n                return a.enabled && a.type !== TriggerType.Alarm;\n            });\n        }\n    }\n\n    public clearCaches() {\n        this._TriggerCache = null;\n        this._TriggerStates = {};\n        this._TriggerFunctionCache = {};\n        this._TriggerRegExCache = {};\n        this._gamepadCaches = null;\n        this._lastSuspend = -1;\n        this._MacroCache = {};\n    }\n\n    public triggerEvent(event: string, args?) {\n        if (!this.enableTriggers) return;\n        this.buildTriggerCache();\n        let t = 0;\n        if (!args)\n            args = [event];\n        else if (!Array.isArray(args))\n            args = [event, args];\n        else\n            args.unshift(event);\n        const tl = this._TriggerCache.length;\n        for (; t < tl; t++) {\n            let trigger = this._TriggerCache[t];\n            const parent = trigger;\n            let changed = false;\n            //in case it got disabled by something\n            if (!trigger.enabled) continue;\n            //safety check in case a state was deleted\n            if (trigger.state > parent.triggers.length)\n                trigger.state = 0;\n            if (trigger.state !== 0 && parent.triggers && parent.triggers.length) {\n                //trigger states are 1 based as 0 is parent trigger\n                trigger = parent.triggers[trigger.state - 1];\n                //skip disabled states\n                while (!trigger.enabled && parent.state !== 0) {\n                    //advance state\n                    parent.state++;\n                    //if no more states start over and stop\n                    if (parent.state > parent.triggers.length) {\n                        parent.state = 0;\n                        //reset to first state\n                        trigger = parent;\n                        //stop checking\n                        break;\n                    }\n                    if (parent.state)\n                        trigger = parent.triggers[parent.state - 1];\n                    else\n                        trigger = parent;\n                    changed = true;\n                }\n                //changed state save\n                if (changed) {\n                    if (this._getOption('saveTriggerStateChanges'))\n                        this.client.saveProfiles();\n                    this.client.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\n                }\n                //last check to be 100% sure enabled\n                if (!trigger.enabled) continue;\n            }\n            if (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern) {\n                const val = this.adjustLastLine(this.client.display.lines.length, true);\n                const line = this.client.display.lines[val];\n                t = this.TestTrigger(trigger, parent, t, line, this.client.display.lines[val].raw || line, val === this.client.display.lines.length - 1);\n                continue;\n            }\n            if (trigger.type !== TriggerType.Event) continue;\n            if (trigger.caseSensitive && event !== trigger.pattern) continue;\n            if (!trigger.caseSensitive && event.toLowerCase() !== trigger.pattern.toLowerCase()) continue;\n            this._LastTriggered = event;\n            this.ExecuteTrigger(trigger, args, false, t, 0, 0, parent);\n            t = this.cleanUpTriggerState(t);\n        }\n    }\n\n    public executeWait(text, delay: number, eAlias?: boolean, stacking?: boolean, append?: boolean, noFunctions?: boolean, noComments?: boolean) {\n        if (!text || text.length === 0) return;\n        const s = { loops: this.loops.splice(0), args: 0, named: 0, used: this.stack.used, append: this.stack.append };\n        if (this.stack.args)\n            s.args = this.stack.args.slice();\n        if (this.stack.named)\n            s.named = this.stack.named.slice();\n\n        if (delay < 0)\n            delay = 0;\n        setTimeout(() => {\n            this._stack.push(s);\n            let ret = this.parseOutgoing(text, eAlias, stacking, append, noFunctions, noComments);\n            this._stack.pop();\n            if (ret == null || typeof ret === 'undefined' || ret.length === 0) return;\n            if (!ret.endsWith('\\n'))\n                ret = ret + '\\n';\n            this.client.send(ret, true);\n        }, delay);\n    }\n\n    public stripQuotes(str: string, force?: boolean, forceSingle?: boolean) {\n        if (!str || str.length === 0)\n            return str;\n        if (force || this._getOption('parseDoubleQuotes'))\n            str = str.replace(/^\\\"(.*)\\\"$/g, (v, e, w) => {\n                return e.replace(/\\\\\\\"/g, '\"');\n            });\n        if (forceSingle || this._getOption('parseSingleQuotes'))\n            str = str.replace(/^\\'(.*)\\'$/g, (v, e, w) => {\n                return e.replace(/\\\\\\'/g, '\\'');\n            });\n        return str;\n    }\n\n    public splitByQuotes(str: string, sep: string, force?: boolean, forceSingle?: boolean) {\n        let t = 0;\n        let e = 0;\n        if (!str || str.length === 0)\n            return [];\n        if (force || this._getOption('parseDoubleQuotes')) {\n            t |= 2;\n            e |= this._getOption('allowEscape') ? 2 : 0;\n        }\n        if (forceSingle || this._getOption('parseSingleQuotes')) {\n            t |= 1;\n            e |= this._getOption('allowEscape') ? 1 : 0;\n        }\n        return splitQuoted(str, sep, t, e, this._getOption('escapeChar'));\n    }\n\n    public createTrigger(pattern: string, commands: string, profile?: string | Profile, options?, name?: string, subTrigger?: boolean) {\n        let trigger;\n        let sTrigger;\n        let reload = true;\n        let isNew = false;\n        if (!pattern && !name)\n            throw new Error(`Trigger '${name || ''}' not found`);\n        if (!profile) {\n            const keys = this._profiles.keys;\n            let k = 0;\n            const kl = keys.length;\n            if (kl === 0)\n                return;\n            if (kl === 1) {\n                if (!this._profiles.items[keys[0]].enabled || !this._profiles.items[keys[0]].enableTriggers)\n                    throw Error('No enabled profiles found!');\n                profile = this._profiles.items[keys[0]];\n                if (subTrigger) {\n                    if (!name) {\n                        if (!this._profiles.items[keys[k]].triggers.length)\n                            throw new Error(`No triggers exist`);\n                        trigger = this._profiles.items[keys[k]].triggers[this._profiles.items[keys[k]].triggers.length - 1];\n                    }\n                    else\n                        trigger = this._profiles.items[keys[k]].findAny('triggers', { name: name, pattern: name });\n                }\n                else if (name !== null)\n                    trigger = this._profiles.items[keys[k]].find('triggers', 'name', name);\n                else\n                    trigger = this._profiles.items[keys[k]].find('triggers', 'pattern', pattern);\n            }\n            else {\n                for (; k < kl; k++) {\n                    if (!this._profiles.items[keys[k]].enabled || !this._profiles.items[keys[k]].enableTriggers || this._profiles.items[keys[k]].triggers.length === 0)\n                        continue;\n                    if (subTrigger) {\n                        if (!name) {\n                            if (!this._profiles.items[keys[k]].triggers.length)\n                                throw new Error(`No triggers exist`);\n                            trigger = this._profiles.items[keys[k]].triggers[this._profiles.items[keys[k]].triggers.length - 1];\n                        }\n                        else\n                            trigger = this._profiles.items[keys[k]].findAny('triggers', { name: name, pattern: name });\n                    }\n                    else if (name !== null)\n                        trigger = this._profiles.items[keys[k]].find('triggers', 'name', name);\n                    else\n                        trigger = this._profiles.items[keys[k]].find('triggers', 'pattern', pattern);\n                    if (trigger) {\n                        profile = this._profiles.items[keys[k]];\n                        break;\n                    }\n                }\n                if (!profile)\n                    profile = this.client.activeProfile;\n            }\n        }\n        else if (typeof profile === 'string') {\n            if (this._profiles.contains(profile.toLowerCase()))\n                profile = this._profiles.items[profile.toLowerCase()];\n            else\n                throw new ProfileNotFound(profile);\n            if (subTrigger) {\n                if (!name) {\n                    if (!(<Profile>profile).triggers.length)\n                        throw new Error(`No triggers exist`);\n                    trigger = (<Profile>profile).triggers[(<Profile>profile).triggers.length - 1];\n                }\n                else\n                    trigger = (<Profile>profile).findAny('triggers', { name: name, pattern: name });\n            }\n            else if (name !== null)\n                trigger = (<Profile>profile).find('triggers', 'name', name);\n            else\n                trigger = (<Profile>profile).find('triggers', 'pattern', pattern);\n        }\n        if (subTrigger) {\n            if (!trigger)\n                throw new Error(`Trigger '${name || ''}' not found`);\n            sTrigger\n            sTrigger = new Trigger();\n            sTrigger.pattern = pattern;\n            reload = false;\n            if (pattern !== null)\n                sTrigger.pattern = pattern;\n            if (commands !== null)\n                sTrigger.value = commands;\n            if (options) {\n                if (options.cmd)\n                    sTrigger.type = TriggerType.CommandInputRegular;\n\n                if (options.pattern)\n                    sTrigger.type = TriggerType.Pattern;\n                if (options.regular)\n                    sTrigger.type = TriggerType.Regular;\n                if (options.alarm)\n                    sTrigger.type = TriggerType.Alarm;\n                if (options.event)\n                    sTrigger.type = TriggerType.Event;\n                if (options.cmdpattern)\n                    sTrigger.type = TriggerType.CommandInputPattern;\n                if (options.loopexpression)\n                    sTrigger.type = TriggerType.LoopExpression;\n                //if(options.expression)\n                //sTrigger.type = TriggerType.Expression;                    \n                if (options.reparse)\n                    sTrigger.type = SubTriggerTypes.ReParse;\n                if (options.reparsepattern)\n                    sTrigger.type = SubTriggerTypes.ReParsePattern;\n                if (options.manual)\n                    sTrigger.type = SubTriggerTypes.Manual;\n                if (options.skip)\n                    sTrigger.type = SubTriggerTypes.Skip;\n                if (options.looplines)\n                    sTrigger.type = SubTriggerTypes.LoopLines;\n                if (options.looppattern)\n                    sTrigger.type = SubTriggerTypes.LoopPattern;\n                if (options.wait)\n                    sTrigger.type = SubTriggerTypes.Wait;\n                if (options.duration)\n                    sTrigger.type = SubTriggerTypes.Duration;\n                if (options.withinlines)\n                    sTrigger.type = SubTriggerTypes.WithinLines;\n\n                if (options.prompt)\n                    sTrigger.triggerPrompt = true;\n                if (options.nocr)\n                    sTrigger.triggerNewline = false;\n                if (options.case)\n                    sTrigger.caseSensitive = true;\n                if (options.raw)\n                    sTrigger.raw = true;\n                if (options.verbatim)\n                    sTrigger.verbatim = true;\n                if (options.disable)\n                    sTrigger.enabled = false;\n                else if (options.enable)\n                    sTrigger.enabled = true;\n                if (options.temporary || options.temp)\n                    sTrigger.temp = true;\n                if (options.params)\n                    sTrigger.params = options.params;\n                if (options.type) {\n                    if (this._isTriggerType(options.type))\n                        sTrigger.type = this._convertTriggerType(options.type);\n                    else\n                        throw new InvalidTrigger('type');\n                }\n            }\n            trigger.triggers.push(sTrigger);\n            this._echo('Trigger sub state added.', -7, -8, true, true);\n        }\n        else {\n            if (!trigger) {\n                if (!pattern)\n                    throw new Error(`Trigger '${name || ''}' not found`);\n                trigger = new Trigger();\n                trigger.name = name || '';\n                trigger.pattern = pattern;\n                (<Profile>profile).triggers.push(trigger);\n                this._echo('Trigger added.', -7, -8, true, true);\n                isNew = true;\n            }\n            else\n                this._echo('Trigger updated.', -7, -8, true, true);\n            if (pattern !== null)\n                trigger.pattern = pattern;\n            if (commands !== null)\n                trigger.value = commands;\n            if (options) {\n                if (options.cmd)\n                    trigger.type = TriggerType.CommandInputRegular;\n                if (options.pattern)\n                    trigger.type = TriggerType.Pattern;\n                if (options.regular)\n                    trigger.type = TriggerType.Regular;\n                if (options.alarm)\n                    trigger.type = TriggerType.Alarm;\n                if (options.event)\n                    trigger.type = TriggerType.Event;\n                if (options.cmdpattern)\n                    trigger.type = TriggerType.CommandInputPattern;\n                if (options.loopexpression)\n                    trigger.type = TriggerType.LoopExpression;\n                //if(options.expression)\n                //trigger.type = TriggerType.Expression;\n\n                if (options.prompt)\n                    trigger.triggerPrompt = true;\n                if (options.nocr)\n                    trigger.triggerNewline = false;\n                if (options.case)\n                    trigger.caseSensitive = true;\n                if (options.raw)\n                    trigger.raw = true;\n                if (options.verbatim)\n                    trigger.verbatim = true;\n                if (options.disable)\n                    trigger.enabled = false;\n                else if (options.enable)\n                    trigger.enabled = true;\n                if (options.temporary || options.temp)\n                    trigger.temp = true;\n                if (options.params)\n                    trigger.params = options.params;\n                if (options.type) {\n                    if (this._isTriggerType(options.type, TriggerTypeFilter.Main))\n                        trigger.type = this._convertTriggerType(options.type);\n                    else\n                        throw new InvalidTrigger('type');\n                }\n                trigger.priority = options.priority;\n            }\n            else\n                trigger.priority = 0;\n        }\n        this.client.saveProfiles();\n        if (reload)\n            this.client.clearCache();\n        if (isNew)\n            this.emit('item-added', 'trigger', (<Profile>profile).name, trigger.triggers.length - 1, trigger);\n        else\n            this.emit('item-updated', 'trigger', (<Profile>profile).name, (<Profile>profile).triggers.indexOf(trigger), trigger);\n        profile = null;\n    }\n\n    private _isTriggerType(type, filter?: TriggerTypeFilter) {\n        if (!filter) filter = TriggerTypeFilter.All;\n        switch (type.replace(/ /g, '').toUpperCase()) {\n            case 'REGULAREXPRESSION':\n            case 'COMMANDINPUTREGULAREXPRESSION':\n                return (filter & TriggerTypeFilter.Main) === TriggerTypeFilter.Main ? true : false;\n            case '0':\n            case '1':\n            case '2':\n            case '3':\n            case '8':\n            case '16':\n            //case '64':\n            case '128':\n            case 'REGULAR':\n            case 'COMMANDINPUTREGULAR':\n            case 'EVENT':\n            case 'ALARM':\n            case 'COMMAND':\n            case 'COMMANDINPUTPATTERN':\n            case 'LOOPEXPRSSION':\n                //case 'EXPRESSION':\n                return (filter & TriggerTypeFilter.Main) === TriggerTypeFilter.Main ? true : false;\n            case 'SKIP':\n            case '512':\n            case 'WAIT':\n            case '1024':\n            case 'LOOPPATTERN':\n            case '4096':\n            case 'LOOPLINES':\n            case '8192':\n            case 'DURATION':\n            case '16384':\n            case 'WITHINLINES':\n            case '32768':\n            case 'MANUAL':\n            case '65536':\n            case 'REPARSE':\n            case '131072':\n            case 'REPARSEPATTERN':\n            case '262144':\n                return (filter & TriggerTypeFilter.Sub) === TriggerTypeFilter.Sub ? true : false;\n        }\n        return false;\n    }\n\n    private _convertTriggerType(type) {\n        switch (type.replace(/ /g, '').toUpperCase()) {\n            case 'REGULAREXPRESSION':\n                return TriggerType.Regular;\n            case 'COMMANDINPUTREGULAREXPRESSION':\n                return TriggerType.CommandInputRegular;\n            case '0':\n            case '1':\n            case '2':\n            case '3':\n            case '8':\n            case '16':\n            case '128':\n                //case '64':\n                return TriggerType[parseInt(type, 10)];\n            case 'REGULAR':\n            case 'COMMANDINPUTREGULAR':\n            case 'EVENT':\n            case 'ALARM':\n            case 'COMMAND':\n            case 'COMMANDINPUTPATTERN':\n            case 'LOOPEXPRSSION':\n                //case 'EXPRESSION':\n                return TriggerType[type];\n            case '512':\n            case '1024':\n            case '4096':\n            case '8192':\n            case '16384':\n            case '32768':\n            case '65536':\n            case '131072':\n            case '262144':\n                return SubTriggerTypes[parseInt(type, 10)];\n            case 'SKIP':\n            case 'WAIT':\n            case 'LOOPPATTERN':\n            case 'LOOPLINES':\n            case 'DURATION':\n            case 'WITHINLINES':\n            case 'MANUAL':\n            case 'REPARSE':\n            case 'REPARSEPATTERN':\n                return SubTriggerTypes[type];\n        }\n        throw new InvalidTrigger('type');\n    }\n\n    private _colorPosition(n: number, fore, back, item) {\n        n = this.adjustLastLine(n);\n        if (!item.hasOwnProperty('yStart'))\n            this.client.display.colorSubStringByLine(n, fore, back, item.xStart, item.hasOwnProperty('xEnd') && item.xEnd >= 0 ? item.xEnd : null);\n        else {\n            const xEnd = item.hasOwnProperty('xEnd') && item.xEnd >= 0 ? item.xEnd : null;\n            const xStart = item.xStart;\n            let line = n - item.yStart;\n            let end = n;\n            if (item.hasOwnProperty('yEnd'))\n                end = n - item.yEnd;\n            while (line <= end) {\n                this.client.display.colorSubStringByLine(line, fore, back, xStart, xEnd);\n                line++;\n            }\n        }\n    }\n\n    private _getOption(option) {\n        return this.client.getOption(option);\n    }\n\n    private get _profiles() {\n        return this.client.profiles;\n    }\n\n    private _echo(str: string, fore?: number, back?: number, newline?: boolean, forceLine?: boolean) {\n        this.client.echo(str, fore, back, newline, forceLine);\n    }\n\n    private _processCommandItemArgs(args, syntax) {\n        let profile = null;\n        let n;\n        if (args[0].match(/^\\{.*\\}$/g) || args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g)) {\n            if (args.length > 2)\n                throw new Error(syntax);\n            if (args.length === 2) {\n                profile = this.parseInline(this.stripQuotes(args[1])).toLowerCase();\n                if (this._profiles.contains(profile))\n                    profile = this._profiles.items[profile];\n                else\n                    throw new ProfileNotFound(profile);\n            }\n            else\n                profile = this.client.activeProfile;\n            if (args[0].match(/^\".*\"$/g) || args[0].match(/^'.*'$/g))\n                n = this.parseInline(this.stripQuotes(args[0]));\n            else\n                n = this.parseInline(args[0].substr(1, args[0].length - 2));\n        }\n        else {\n            n = this.parseInline(args.join(' '));\n            profile = this.client.activeProfile;\n        }\n        return { profile: profile, results: n };\n    }\n}", "/**\r\n * A class to parse color values\r\n * @author Stoyan Stefanov <sstoo@gmail.com>\r\n * @link   http://www.phpied.com/rgb-color-parser-in-javascript/\r\n * @license Use it if you like it\r\n */\r\nexport function RGBColor(color_string)\r\n{\r\n    this.ok = false;\r\n\r\n    // strip any leading #\r\n    if (color_string.charAt(0) == '#') { // remove # if any\r\n        color_string = color_string.substr(1,6);\r\n    }\r\n\r\n    color_string = color_string.replace(/ /g,'');\r\n    color_string = color_string.toLowerCase();\r\n\r\n    // before getting into regexps, try simple matches\r\n    // and overwrite the input\r\n    var simple_colors = {\r\n        aliceblue: 'f0f8ff',\r\n        antiquewhite: 'faebd7',\r\n        aqua: '00ffff',\r\n        aquamarine: '7fffd4',\r\n        azure: 'f0ffff',\r\n        beige: 'f5f5dc',\r\n        bisque: 'ffe4c4',\r\n        black: '000000',\r\n        blanchedalmond: 'ffebcd',\r\n        blue: '0000ff',\r\n        blueviolet: '8a2be2',\r\n        brown: 'a52a2a',\r\n        burlywood: 'deb887',\r\n        cadetblue: '5f9ea0',\r\n        chartreuse: '7fff00',\r\n        chocolate: 'd2691e',\r\n        coral: 'ff7f50',\r\n        cornflowerblue: '6495ed',\r\n        cornsilk: 'fff8dc',\r\n        crimson: 'dc143c',\r\n        cyan: '00ffff',\r\n        darkblue: '00008b',\r\n        darkcyan: '008b8b',\r\n        darkgoldenrod: 'b8860b',\r\n        darkgray: 'a9a9a9',\r\n        darkgreen: '006400',\r\n        darkkhaki: 'bdb76b',\r\n        darkmagenta: '8b008b',\r\n        darkolivegreen: '556b2f',\r\n        darkorange: 'ff8c00',\r\n        darkorchid: '9932cc',\r\n        darkred: '8b0000',\r\n        darksalmon: 'e9967a',\r\n        darkseagreen: '8fbc8f',\r\n        darkslateblue: '483d8b',\r\n        darkslategray: '2f4f4f',\r\n        darkturquoise: '00ced1',\r\n        darkviolet: '9400d3',\r\n        deeppink: 'ff1493',\r\n        deepskyblue: '00bfff',\r\n        dimgray: '696969',\r\n        dodgerblue: '1e90ff',\r\n        feldspar: 'd19275',\r\n        firebrick: 'b22222',\r\n        floralwhite: 'fffaf0',\r\n        forestgreen: '228b22',\r\n        fuchsia: 'ff00ff',\r\n        gainsboro: 'dcdcdc',\r\n        ghostwhite: 'f8f8ff',\r\n        gold: 'ffd700',\r\n        goldenrod: 'daa520',\r\n        gray: '808080',\r\n        green: '008000',\r\n        greenyellow: 'adff2f',\r\n        honeydew: 'f0fff0',\r\n        hotpink: 'ff69b4',\r\n        indianred : 'cd5c5c',\r\n        indigo : '4b0082',\r\n        ivory: 'fffff0',\r\n        khaki: 'f0e68c',\r\n        lavender: 'e6e6fa',\r\n        lavenderblush: 'fff0f5',\r\n        lawngreen: '7cfc00',\r\n        lemonchiffon: 'fffacd',\r\n        lightblue: 'add8e6',\r\n        lightcoral: 'f08080',\r\n        lightcyan: 'e0ffff',\r\n        lightgoldenrodyellow: 'fafad2',\r\n        lightgrey: 'd3d3d3',\r\n        lightgreen: '90ee90',\r\n        lightpink: 'ffb6c1',\r\n        lightsalmon: 'ffa07a',\r\n        lightseagreen: '20b2aa',\r\n        lightskyblue: '87cefa',\r\n        lightslateblue: '8470ff',\r\n        lightslategray: '778899',\r\n        lightsteelblue: 'b0c4de',\r\n        lightyellow: 'ffffe0',\r\n        lime: '00ff00',\r\n        limegreen: '32cd32',\r\n        linen: 'faf0e6',\r\n        magenta: 'ff00ff',\r\n        maroon: '800000',\r\n        mediumaquamarine: '66cdaa',\r\n        mediumblue: '0000cd',\r\n        mediumorchid: 'ba55d3',\r\n        mediumpurple: '9370d8',\r\n        mediumseagreen: '3cb371',\r\n        mediumslateblue: '7b68ee',\r\n        mediumspringgreen: '00fa9a',\r\n        mediumturquoise: '48d1cc',\r\n        mediumvioletred: 'c71585',\r\n        midnightblue: '191970',\r\n        mintcream: 'f5fffa',\r\n        mistyrose: 'ffe4e1',\r\n        moccasin: 'ffe4b5',\r\n        navajowhite: 'ffdead',\r\n        navy: '000080',\r\n        oldlace: 'fdf5e6',\r\n        olive: '808000',\r\n        olivedrab: '6b8e23',\r\n        orange: 'ffa500',\r\n        orangered: 'ff4500',\r\n        orchid: 'da70d6',\r\n        palegoldenrod: 'eee8aa',\r\n        palegreen: '98fb98',\r\n        paleturquoise: 'afeeee',\r\n        palevioletred: 'd87093',\r\n        papayawhip: 'ffefd5',\r\n        peachpuff: 'ffdab9',\r\n        peru: 'cd853f',\r\n        pink: 'ffc0cb',\r\n        plum: 'dda0dd',\r\n        powderblue: 'b0e0e6',\r\n        purple: '800080',\r\n        red: 'ff0000',\r\n        rosybrown: 'bc8f8f',\r\n        royalblue: '4169e1',\r\n        saddlebrown: '8b4513',\r\n        salmon: 'fa8072',\r\n        sandybrown: 'f4a460',\r\n        seagreen: '2e8b57',\r\n        seashell: 'fff5ee',\r\n        sienna: 'a0522d',\r\n        silver: 'c0c0c0',\r\n        skyblue: '87ceeb',\r\n        slateblue: '6a5acd',\r\n        slategray: '708090',\r\n        snow: 'fffafa',\r\n        springgreen: '00ff7f',\r\n        steelblue: '4682b4',\r\n        tan: 'd2b48c',\r\n        teal: '008080',\r\n        thistle: 'd8bfd8',\r\n        tomato: 'ff6347',\r\n        turquoise: '40e0d0',\r\n        violet: 'ee82ee',\r\n        violetred: 'd02090',\r\n        wheat: 'f5deb3',\r\n        white: 'ffffff',\r\n        whitesmoke: 'f5f5f5',\r\n        yellow: 'ffff00',\r\n        yellowgreen: '9acd32'\r\n    };\r\n    for (var key in simple_colors) {\r\n        if (color_string == key) {\r\n            color_string = simple_colors[key];\r\n        }\r\n    }\r\n    // end of simple type-in colors\r\n\r\n    // array of color definition objects\r\n    var color_defs = [\r\n        {\r\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\r\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 10),\r\n                    parseInt(bits[2], 10),\r\n                    parseInt(bits[3], 10)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{2})(\\w{2})(\\w{2})$/,\r\n            example: ['#00ff00', '336699'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1], 16),\r\n                    parseInt(bits[2], 16),\r\n                    parseInt(bits[3], 16)\r\n                ];\r\n            }\r\n        },\r\n        {\r\n            re: /^(\\w{1})(\\w{1})(\\w{1})$/,\r\n            example: ['#fb0', 'f0f'],\r\n            process: function (bits){\r\n                return [\r\n                    parseInt(bits[1] + bits[1], 16),\r\n                    parseInt(bits[2] + bits[2], 16),\r\n                    parseInt(bits[3] + bits[3], 16)\r\n                ];\r\n            }\r\n        }\r\n    ];\r\n\r\n    // search through the definitions to find a match\r\n    for (var i = 0, cl = color_defs.length; i < cl; i++) {\r\n        var re = color_defs[i].re;\r\n        var processor = color_defs[i].process;\r\n        var bits = re.exec(color_string);\r\n        if (bits) {\r\n            var channels = processor(bits);\r\n            this.r = channels[0];\r\n            this.g = channels[1];\r\n            this.b = channels[2];\r\n            this.ok = true;\r\n        }\r\n\r\n    }\r\n\r\n    // validate/cleanup values\r\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\r\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\r\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\r\n\r\n    // some getters\r\n    this.toRGB = function () {\r\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\r\n    };\r\n    this.toHex = function () {\r\n        var r = this.r.toString(16);\r\n        var g = this.g.toString(16);\r\n        var b = this.b.toString(16);\r\n        if (r.length == 1) r = '0' + r;\r\n        if (g.length == 1) g = '0' + g;\r\n        if (b.length == 1) b = '0' + b;\r\n        return '#' + r + g + b;\r\n    };\r\n\r\n    // help\r\n    /*\r\n    this.getHelpXML = function () {\r\n\r\n        var examples = [], i, l;\r\n        // add regexps\r\n        for (i = 0, l = color_defs.length; i < l; i++) {\r\n            var example = color_defs[i].example;\r\n            for (var j = 0, el = example.length; j < el; j++) {\r\n                examples[examples.length] = example[j];\r\n            }\r\n        }\r\n        // add type-in colors\r\n        for (var sc in simple_colors) {\r\n            examples[examples.length] = sc;\r\n        }\r\n\r\n        var xml = document.createElement('ul');\r\n        xml.setAttribute('id', 'rgbcolor-examples');\r\n        for (i = 0, el = examples.length; i < el; i++) {\r\n            try {\r\n                var list_item = document.createElement('li');\r\n                var list_color = new RGBColor(examples[i]);\r\n                var example_div = document.createElement('div');\r\n                example_div.style.cssText = 'margin: 3px;border: 1px solid black;background:' + list_color.toHex() + ';color:' + list_color.toHex();\r\n                example_div.appendChild(document.createTextNode('test'));\r\n                var list_item_value = document.createTextNode(' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex());\r\n                list_item.appendChild(example_div);\r\n                list_item.appendChild(list_item_value);\r\n                xml.appendChild(list_item);\r\n\r\n            } catch(e){}\r\n        }\r\n        return xml;\r\n\r\n    };\r\n    */\r\n\r\n}\r\n\r\n", "import { EventEmitter } from './events';\nimport { RGBColor } from '../lib/rgbcolor';\nimport { ParserLine, FormatType, ParserOptions, FontStyle, LineFormat, LinkFormat, ImageFormat, Size } from './types';\nimport { stripQuotes, CharAllowedInURL, htmlDecode } from './library';\nimport { Display } from './display';\n\ninterface MXPBlock {\n    format: LineFormat | LinkFormat | ImageFormat;\n    text: string;\n}\n\n/**\n   * Enum for MXP tags.\n   * @readonly\n   * @enum {number}\n   * @typedef {number} MXPTag\n   */\nenum MXPTag {\n    None = 0,\n    B, BOLD, STRONG,\n    I, ITALIC, EM,\n    U, UNDERLINE,\n    S, STRIKEOUT, STRIKE,\n    C, COLOR, H, HIGH,\n    FONT, HR,\n    NOBR, P, BR, SBR,\n    A, SEND, EXPIRE,\n    VERSION, SUPPORT,\n    RESET, H1, H2, H3, H4, H5, H6,\n    V, VAR, USER, PASSWORD, Custom,\n    GAUGE, STAT\n}\n\n/**\n * MXP line tag types\n */\nenum lineType {\n    None = -1,\n    Open = 0,\n    Secure = 1,\n    Locked = 2,\n    Reset = 3,\n    TempSecure = 4,\n    LockOpen = 5,\n    LockSecure = 6,\n    LockLocked = 7,\n    RoomName = 10,\n    RoomDescription = 11,\n    RoomExits = 12,\n    WelcomeText = 19\n}\n\n/**\n * Enum for parser state.\n * @readonly\n * @enum {number}\n * @typedef {number} ParserState\n */\nenum ParserState {\n    None = 0,\n    Ansi = 1,\n    AnsiParams = 2,\n    XTermTitle = 3,\n    MXPTag = 4,\n    MXPTagQuoted = 5,\n    MXPTagDblQuoted = 6,\n    MXPEntity = 7,\n    MXPComment = 8,\n    MXPTagArg = 9,\n    URL = 10,\n    URLFound = 11,\n    MSPSound = 12,\n    MSPMusic = 13\n}\n\n/**\n   * Object to track current state of MXP\n   *\n   * @property {Boolean}  [on='']\t\t\t\t\t- MXP on for current block of process, determined based on line mode sent\n   * @property {Number}   [lineType=0]\t\t\t\t- Current line type, 0 to 99 based on MXP spec\n   * @property {Boolean}  [locked=false]\t\t\t- is the current line mode locked based on lineType\n   * @property {Boolean}  [paragraph=false]\t\t\t- is current block in a paragraph to ignore \\n\n   * @property {Boolean}  [noBreak=false]\t\t\t- Ignore the next \\n\n   * @property {Boolean}  [expanded=false]\t\t\t- element expanded so it knows to insert the new text before continuing to parse\n   * @property {Number}   [capture=0]\t\t\t\t- Capture any text processed while capture is one, supports nesting\n   * @property {Strung[]} [captured=[]]\t\t\t\t- Captured text buffers, an array of nested captures, as captures end the last one added is popped off, and capture is decreased by 1\n   * @property {Boolean}  [expanded=false]\t\t\t- line tag expanded\n   * @property {Boolean}  [gagged=false]\t\t\t- current block of text gagged from being displayed\n   */\nclass MXPState {\n    public on: boolean = false;\n    public lineType: (lineType | number) = 0;\n    public locked: boolean = false;\n    public paragraph: boolean = false;\n    public noBreak: boolean = false;\n    public expanded: boolean = false;\n    public lineExpanded: boolean = false;\n    public capture: number = 0;\n    public captured = [];\n    public gagged: boolean = false;\n}\n\n/**\n   * MXP Entity object\n   *\n   * @property {String}  [name='']\t\t\t\t\t- The name of the entity\n   * @property {String}  [value='']\t\t\t\t\t- The value of the entity\n   * @property {String}  [description='']\t\t- the description of the entity\n   * @property {Boolean} [publish=false]\t\t- Is the entity published to the public for users to access value\n   * @property {Boolean} [remote=false]\t\t\t- None standard, tells the parser where the entity is from for security reasons as local users should not be able to change server set entities\n   */\nclass Entity {\n    public name: string = '';\n    public value: string = '';\n    public description: string = '';\n    public publish: boolean = false;\n    public remote: boolean = false;\n    constructor(remote?: boolean) {\n        this.remote = remote == null ? false : remote;\n    }\n}\n\n/**\n * MXP Element object\n *\n * @property {String}  [name='']\t\t\t\t- The name of the element\n * @property {String}  [definition='']\t\t\t- The element definition to expand to\n * @property {String}  [closeDefinition='']\t\t- The close definition built from definition\n * @property {Object}  [attributes='']\t\t\t- Object to track attributes list\n * @property {Array}   [attributeIndexes=[]]\t- Array to link attributes to argument index\n * @property {Number}  [tag=-1]\t\t\t\t\t- Tag line, if set will present tagline codes to definition in format of <esc>[<tag>zDefinition\n * @property {String}  [flag='']\t\t\t\t- Element tag property, mostly client dependant, see MXP spec for full list of basic ones\n * @property {Boolean} [open=false]\t\t\t\t- Is this an open element that can be used on an open line type\n * @property {Boolean} [empty=false]\t\t\t- Is this an empty tag that doesn't have a CloseDefinition\n * @property {Boolean} [remote=false]\t\t\t- None standard, tells the parser where the entity is from for security reasons as local users should not be able to change server set elements\n * @property {Boolean} [gagged=false]\t\t\t- Is element gagged from display as a tag could cause a custom element to be processed but hidden\n */\nclass Element {\n    public name: string = '';\n    public definition: string = '';\n    public closeDefinition: string = '';\n    public attributes = {};\n    public attributeIndexes = [];\n    public tag: (lineType | number) = lineType.None;\n    public flag: string = '';\n    public open: boolean = false;\n    public empty: boolean = false;\n    public remote: boolean = false;\n    public gagged: boolean = false;\n    constructor(remote?: boolean) {\n        this.remote = remote == null ? false : remote;\n    }\n}\n\n/**\n * MXP Line Tag object\n *\n * @property {Number}  [index=-1]\t\t\t\t\t\t- The tag number (20-99) to change\n * @property {String}  [window='']\t\t\t\t\t- Specifies the name of a window to redirect the text to, unsupported\n * @property {Boolean} [gag=false]\t\t\t\t\t- Indicates that the text should be gagged from the main MUD window.\n * @property {String}  [fore='']\t\t\t\t\t\t- The text foreground color.\n * @property {String}  [back='']\t\t\t\t\t\t- The background color of the text.\n * @property {Boolean} [enabled=true]\t\t\t\t- Turn this tag on or off.\n * @property {Boolean} [remote=false]\t\t\t\t- None standard, tells the parser where the tag is from for security reasons as local users should not be able to change server set tag\n * @property {String}  [element='']\t\t\t\t\t- Was the tag created by an element, as it should use that elements def/closeDef\n * @property {String}  [definition='']\t\t\t- Was the tag supplied with its own colors, still link to element but these colors override any set by element\n * @property {String}  [closeDefinition='']\t- The close definition built from definition\n */\nclass Tag {\n    public index: (lineType | number) = lineType.None;\n    public window: string = '';\n    public gag: boolean = false;\n    public fore: string = '';\n    public back: string = '';\n    public enabled: boolean = true;\n    public remote: boolean = false;\n    public element: string = '';\n    public definition: string = '';\n    public closeDefinition: string = '';\n    constructor(index?: number, fore?: string, back?: string, remote?: boolean) {\n        if (index != null) this.index = index;\n        if (fore != null) this.fore = fore;\n        if (back != null) this.back = back;\n        if (remote != null) this.remote = remote;\n    }\n}\n\n/**\n * MXPStyle object, stores the current style for display block in a stack, new styles are build on prev and pushed on stack, as style are closed they are popped off\n  *\n * @property {MXPTag}    [tag=0]\t\t\t- The tag that applied this style\n * @property {String}    [custom='']\t\t- If tag is custom store its name to know the exact tag\n * @property {String}    [font='']\t\t\t- The font to apply to current display block\n * @property {String}    [fontSize='']\t    - The font size in any valid css format\n * @property {FontStyle} [style=_style]\t    - The fontStyle enum state, see fontStyle\n * @property {String}    [fore=_fore]\t\t- The foreground color, this overrides any ansi foreground set\n * @property {String}    [back=_back]\t\t- The background color, this overrides aay ansi background set\n * @property {Boolean}   [high=_high]\t\t- This will brighten what ever the current foreground color is by 50% even if it is an ansi set color\n * @property {Object}    [obj=null]\t\t\t- Store misc data that a tag may need for later processing\n */\nclass MXPStyle {\n    public tag: MXPTag = MXPTag.None;\n    public custom: string = '';\n    public font: string = null;\n    public fontSize: (string) = null;\n    public style: FontStyle = FontStyle.None;\n    public fore: string = '';\n    public back: string = '';\n    public high: boolean = false;\n    public obj: any = null;\n    public gagged: boolean = false;\n    public open: boolean = false;\n    public properties = null;\n    constructor(style?: FontStyle, fore?: string, back?: string, high?: boolean, open?: boolean) {\n        if (style != null) this.style = style;\n        if (fore != null) this.fore = fore;\n        if (back != null) this.back = back;\n        this.high = high || false;\n        this.open = open || false;\n    }\n\n}\n\n/**\n * An Ansi/MXP parser, requires requires the modules src/lib/rgbcolor for color processing and validation\n *\n * @author William\n * @copyright William 2013\n * @version 1.1\n * @requires module:src/lib/rgbcolor\n * @namespace Parser\n *\n * @todo WELCOME element - just tags text as welcome for redirection purposes, don't support redirection to other windows so don't worry about this\n * @todo <FRAME NAME ACTION(OPEN|CLOSE|REDIRECT) TITLE INTERNAL ALIGN(LEFT|RIGHT|BOTTOM|TOP) LEFT TOP WIDTH HEIGHT SCROLLING(yes|no) FLOATING>\n * @constructor\n *\n * @param {Object}\toptions\t\t\t\t\t\t\t\t\t\t\t\t\t- The options to start off with\n * @param {Boolean} [options.MXP=true]\t\t\t\t\t\t\t- Enable/disable MXP parsing\n * @param {Object}\toptions.window\t\t\t\t\t\t\t\t\t- The window view size, used for clearing screen and other ansi related systems\n * @param {Number}\t[options.window.height=0]\t\t\t\t- The window height in lines\n * @param {Number}\t[options.window.width=0]\t\t\t\t- The window width in characters\n * @param {Boolean} [options.flashing=false]\t\t\t\t- Enable/disable ansi blink\n *\n * @property {String}  [StyleVersion='']\t\t\t\t\t\t- The MXP cached version style set from the VERSION tag, used by a client to reply to a VERSION request\n * @property {Boolean} [displayControlCodes=false]\t- Display unreadable characters, code < 32 || 127\n * @property {Boolean} [emulateControlCodes=true]\t\t- Emulate control codes like escape, tabs, etc...\n * @property {Boolean} [EndOfLine=false]\t\t\t\t\t\t- Is the current parser state at end of line or on a fragment\n * @property {Number}  [textLength=0]\t\t\t\t\t\t\t\t- The current amount of text that has been parsed\n * @property {Boolean} [enableMXP=true]\t\t\t\t\t\t\t- Enable/disable MXP parsing\n * @property {Boolean} [enableMSP=true]\t\t\t\t\t\t\t- Enable/disable MSP parsing\n * @property {Boolean} window\t\t\t\t\t\t\t\t\t\t\t\t- The window size, used for clearing screen and other ansi related systems\n * @property {Number}  [options.window.height=0]\t\t- The window height in lines\n * @property {Number}  [options.window.width=0]\t\t\t- The window width in characters\n * @property {Boolean} [enableFlashing=false]\t\t\t\t- Enable/disable ansi blink\n * @property {Boolean} [emulateTerminal=false]\t\t\t- Enable/disable Terminal IBM/OEM (code page 437) extended characters, will convert them to the correct unicode character in an attempt to display like classic terminal\n */\nexport class Parser extends EventEmitter {\n\n    /** @private */\n    private _parsing = [];\n    /** @private */\n    /* Web detection protocols that are just followed by a :*/\n    private _protocols = [['m', 'a', 'i', 'l', 't', 'o'], ['s', 'k', 'y', 'p', 'e'], ['c', 'a', 'l', 'l', 't', 'o'], ['i', 'm'], ['i', 't', 'm', 's'], ['t', 'e', 'l'], ['t', 'e', 'l', 'n', 'e', 't']];\n\n    /** @private */\n    private _ColorTable: string[] = null;\n    /** @private */\n    private _CurrentForeColor: (string | number) = 37;\n    /** @private */\n    private _CurrentBackColor: (string | number) = 40;\n    /** @private */\n    private _CurrentAttributes: FontStyle = FontStyle.None;\n    /** @private */\n    private _SplitBuffer: string = '';\n    /** @private */\n    private _mxpState: MXPState = new MXPState();\n    /** @private */\n    private _mxpStyles: MXPStyle[] = [];\n    /** @private */\n    private _mxpEntities: any = {};\n    /** @private */\n    private _mxpElements: any = {};\n    /** @private */\n    private _mxpLines: Tag[] = [];\n    /** @private */\n    private _iMXPDefaultMode: (lineType | number) = lineType.Open;\n\n    public displayControlCodes: boolean = false;\n    public emulateControlCodes: boolean = true;\n    public StyleVersion: string = '';\n    public EndOfLine: boolean = false;\n    public textLength: number = 0;\n    public rawLength: number = 0;\n    public enableMXP: boolean = true;\n    public DefaultImgUrl: string = '';\n    public enableDebug: boolean = false;\n    public showInvalidMXPTags: boolean = false;\n    public enableLinks: boolean = true;\n    public enableMSP: boolean = true;\n    public enableURLDetection: boolean = true;\n    public window: Size = new Size(0, 0);\n    public enableFlashing: boolean = false;\n    public emulateTerminal: boolean = false;\n    public enableBell: boolean = true;\n    public display: Display = null;\n    public tabWidth: number = 8;\n\n    public busy = false;\n\n    constructor(options?: ParserOptions) {\n        super();\n        if (options != null) {\n            if (options.DefaultImageURL)\n                this.DefaultImgUrl = options.DefaultImageURL;\n            if (options.enableMXP != null)\n                this.enableMXP = options.enableMXP;\n            if (options.enableDebug != null)\n                this.enableDebug = options.enableDebug;\n            if (options.showInvalidMXPTags != null)\n                this.showInvalidMXPTags = options.showInvalidMXPTags;\n\n            if (options.enableMSP != null)\n                this.enableMSP = options.enableMSP;\n            if (options.enableURLDetection != null)\n                this.enableURLDetection = options.enableURLDetection;\n            if (options.window != null)\n                this.window = options.window;\n            if (options.enableFlashing != null)\n                this.enableFlashing = options.enableFlashing;\n            if (options.emulateTerminal != null)\n                this.emulateTerminal = options.emulateTerminal;\n            if (options.enableBell != null)\n                this.enableBell = options.enableBell;\n            if (options.display != null)\n                this.display = options.display;\n            if (options.enableLinks)\n                this.enableLinks = options.enableLinks;\n        }\n    }\n\n    private _getColors(mxp?: MXPStyle) {\n        if (typeof mxp === 'undefined')\n            mxp = this._GetCurrentStyle();\n        let f: (string | number);\n        let b: (string | number);\n        let fc: number = -1;\n        let bc: number = -1;\n\n        if (mxp.fore.length > 0) {\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold)\n                f = this.IncreaseColor(mxp.fore, 0.5);\n            else if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint)\n                f = this.DecreaseColor(mxp.fore, 0.5);\n            else\n                f = mxp.fore;\n        }\n        else if (typeof this._CurrentForeColor === 'string')\n            f = 'rgb(' + this._CurrentForeColor.replace(/;/g, ',') + ')';\n        else {\n            f = this._CurrentForeColor;\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold) {\n                if (f > 999)\n                    f /= 1000;\n                if (f >= 0 && f < 99)\n                    f *= 10;\n                fc = f;\n                if (f <= -16)\n                    f = this.IncreaseColor(this.GetColor(f), 0.5);\n            }\n            else if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint) {\n                if (f > 99 && f < 999)\n                    f /= 10;\n                if (f >= 0 && f < 999)\n                    f *= 100;\n                fc = f;\n                if (f <= -16)\n                    f = this.DecreaseColor(this.GetColor(f), 0.15);\n            }\n            else {\n                fc = f;\n            }\n        }\n\n        if (mxp.high) {\n            if (typeof f === 'number')\n                f = this.IncreaseColor(this.GetColor(f), 0.25);\n            else\n                f = this.IncreaseColor(f, 0.25);\n        }\n\n        if (mxp.back.length > 0)\n            b = mxp.back;\n        else if (typeof this._CurrentBackColor === 'string')\n            b = 'rgb(' + this._CurrentBackColor.replace(/;/g, ',') + ')';\n        else\n            b = bc = this._CurrentBackColor;\n\n        if ((this._CurrentAttributes & FontStyle.Inverse) === FontStyle.Inverse || (mxp.style & FontStyle.Inverse) === FontStyle.Inverse)\n            return { fore: b, back: f, foreCode: bc, backCode: fc };\n        return { fore: f, back: b, foreCode: fc, backCode: bc };\n    }\n\n    private _getFormatBlock(offset) {\n        const mxp: MXPStyle = this._GetCurrentStyle();\n        const colors = this._getColors(mxp);\n        return {\n            formatType: FormatType.Normal,\n            offset: offset,\n            color: colors.fore || 0,\n            background: colors.back || 0,\n            size: mxp.fontSize || 0,\n            font: mxp.font || 0,\n            style: mxp.style | (this._CurrentAttributes & ~FontStyle.Bold),\n            unicode: false\n        };\n    }\n\n    private _ResetColors() {\n        this._CurrentForeColor = 37;\n        this._CurrentBackColor = 40;\n        this._CurrentAttributes = FontStyle.None;\n    }\n\n    private _ProcessAnsiColorParams(params: string[]) {\n        let p: number = 0;\n        const pl: number = params.length;\n        let i: number;\n        let rgb: string;\n        for (; p < pl; p++) {\n            i = +params[p] || 0;\n            switch (i) {\n                case 0: //Reset/None\n                    this._ResetColors();\n                    break;\n                case 1: //Bold\n                    this._CurrentAttributes |= FontStyle.Bold;\n                    //can only be bold or faint not both, so when you turn on bold turn off faint\n                    this._CurrentAttributes &= ~FontStyle.Faint;\n                    break;\n                case 2: //Faint\n                    this._CurrentAttributes |= FontStyle.Faint;\n                    //can only be bold or faint not both, so when you turn on faint turn off bold\n                    this._CurrentAttributes &= ~FontStyle.Bold;\n                    break;\n                case 3: //Italics\n                    this._CurrentAttributes |= FontStyle.Italic;\n                    break;\n                case 4: //Underscore\n                    this._CurrentAttributes |= FontStyle.Underline;\n                    //this._CurrentAttributes &= ~FontStyle.DoubleUnderline;\n                    break;\n                case 5: //Blink < 150 per min\n                    this._CurrentAttributes |= FontStyle.Slow;\n                    break;\n                case 6: //Blink Rapid >= 150 per min\n                    this._CurrentAttributes |= FontStyle.Rapid;\n                    break;\n                case 7: //Reverse\n                    this._CurrentAttributes |= FontStyle.Inverse;\n                    break;\n                case 8: //hidden / Concealed\n                    this._CurrentAttributes |= FontStyle.Hidden;\n                    break;\n                case 9: //strike through on\n                    this._CurrentAttributes |= FontStyle.Strikeout;\n                    break;\n                /*\n                10 primary(default) font\n                11 first alternative font\n                12 second alternative font\n                13 third alternative font\n                14 fourth alternative font\n                15 fifth alternative font\n                16 sixth alternative font\n                17 seventh alternative font\n                18 eighth alternative font\n                19 ninth alternative font\n                20 Fraktur(Gothic)\n                */\n                case 21:\n                    this._CurrentAttributes |= FontStyle.DoubleUnderline;\n                    //this._CurrentAttributes &= ~FontStyle.Underline;\n                    break;\n                case 22: //bold off\n                    this._CurrentAttributes &= ~FontStyle.Bold;\n                    this._CurrentAttributes &= ~FontStyle.Faint;\n                    break;\n                case 23: //italics off\n                    this._CurrentAttributes &= ~FontStyle.Italic;\n                    break;\n                case 24: //underline off\n                    this._CurrentAttributes &= ~FontStyle.Underline;\n                    this._CurrentAttributes &= ~FontStyle.DoubleUnderline;\n                    break;\n                case 25:\n                    this._CurrentAttributes &= ~FontStyle.Slow;\n                    break;\n                case 26:\n                    this._CurrentAttributes &= ~FontStyle.Rapid;\n                    break;\n                case 27: //inverse off\n                    this._CurrentAttributes &= ~FontStyle.Inverse;\n                    break;\n                case 28: //visible / concealed off\n                    this._CurrentAttributes &= ~FontStyle.Hidden;\n                    break;\n                case 29: //strike through off\n                    this._CurrentAttributes &= ~FontStyle.Strikeout;\n                    break;\n                case -11: //error color\n                case -7: //info color\n                case -3: //local echo\n                case 30: //set foreground color to black\n                case 31: //set foreground color to red\n                case 32: //set foreground color to green\n                case 33:  //set foreground color to yellow\n                case 34: //set foreground color to blue\n                case 35:  //set foreground color to magenta (purple)\n                case 36:  //set foreground color to cyan\n                case 37:  //set foreground color to white\n                    this._CurrentForeColor = i;\n                    break;\n                case 38:\n                    if (p + 2 < pl && params[p + 1] === '5') {\n                        this._CurrentForeColor = +params[p + 2];\n                        if (isNaN(this._CurrentForeColor))\n                            this._CurrentForeColor = 37;\n                        else {\n                            this._CurrentForeColor += 16;\n                            this._CurrentForeColor *= -1;\n                        }\n                        p += 2;\n                    }\n                    else if (p + 4 < pl && params[p + 1] === '2') {\n                        i = +params[p + 2] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb = i + ';';\n                        i = +params[p + 3] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i + ';';\n                        i = +params[p + 4] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i;\n                        this._CurrentForeColor = rgb;\n                        p += 4;\n                    }\n                    break;\n                case 39: //set foreground color to default)\n                    this._CurrentForeColor = -1;\n                    break;\n                case -12: //error color\n                case -8:\n                case -4:\n                case 40:\n                case 41:\n                case 42:\n                case 43:\n                case 44:\n                case 45:\n                case 46:\n                case 47:\n                    this._CurrentBackColor = i;\n                    break;\n                case 48:\n                    if (p + 2 < pl && params[p + 1] === '5') {\n                        this._CurrentBackColor = +params[p + 2];\n                        if (isNaN(this._CurrentBackColor))\n                            this._CurrentBackColor = 40;\n                        else {\n                            this._CurrentBackColor += 16;\n                            this._CurrentBackColor *= -1; //prevent overlap of protocols in color grabbing code\n                        }\n                        p += 2;\n                    }\n                    else if (p + 4 < pl && params[p + 1] === '2') {\n                        i = +params[p + 2] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb = i + ';';\n                        i = +params[p + 3] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i + ';';\n                        i = +params[p + 4] || 0;\n                        if (i < 0 || i > 255)\n                            continue;\n                        rgb += i;\n                        this._CurrentBackColor = rgb;\n                        p += 4;\n                    }\n                    break;\n                case 49:\n                    this._CurrentBackColor = -2;\n                    break;\n                //zMUD log colors, seems zMUD uses the 50s for display info for bold colors, standards use it to control borders and other effects\n                //don't need zMUD colors here as we never need to open fonts, replace with the frames/overlined/etc... if it can be done in css\n                case 53: //Overlined believe this draws a line above text, opposite of underline\n                    this._CurrentAttributes |= FontStyle.Overline;\n                    break;\n                case 55: //Not overlined, turns off overlined\n                    this._CurrentAttributes &= ~FontStyle.Overline;\n                    break;\n                case 50: //Reserved\n                case 51: //Framed believe this adds a border all the way around block of text\n                case 52: //Encircled, not sure maybe draws a circle around text?\n                case 54: //Not framed or encircled, turns off framed/encircled\n                case 56: //Reserved\n                case 57: //Reserved\n                case 58: //Reserved\n                case 59: //Reserved\n                    this._CurrentForeColor = i - 20;\n                    this._CurrentAttributes |= FontStyle.Bold; //make bold\n                    break;\n                //xterm 16 but color\n                //Assume that xterm?s resources are set so that the ISO color codes are the first 8 of a set of 16.\n                //Then the aixterm colors are the bright versions of the ISO colors:\n                case 90:\n                case 91:\n                case 92:\n                case 93:\n                case 94:\n                case 95:\n                case 96:\n                case 97:\n                    this._CurrentForeColor = i;\n                    break;\n                case 100:\n                case 101:\n                case 102:\n                case 103:\n                case 104:\n                case 105:\n                case 106:\n                case 107:\n                    this._CurrentBackColor = i;\n                    break;\n            }\n        }\n    }\n\n    private _buildColorTable() {\n        const _ColorTable: string[] = [];\n        let r;\n        let g;\n        let b;\n        let idx;\n        for (r = 0; r < 6; r++) {\n            for (g = 0; g < 6; g++) {\n                for (b = 0; b < 6; b++) {\n                    idx = 16 + (r * 36) + (g * 6) + b;\n                    _ColorTable[idx] = 'rgb(';\n                    if (r > 0)\n                        _ColorTable[idx] += r * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ',';\n                    if (g > 0)\n                        _ColorTable[idx] += g * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ',';\n                    if (b > 0)\n                        _ColorTable[idx] += b * 40 + 55;\n                    else\n                        _ColorTable[idx] += '0';\n                    _ColorTable[idx] += ')';\n                }\n            }\n        }\n        for (r = 232; r <= 255; r++)//grayscale\n        {\n            g = (r - 232) * 10 + 8;\n            _ColorTable[r] = ['rgb(', g, ',', g, ',', g, ')'].join('');\n        }\n        _ColorTable[0] = 'rgb(0,0,0)'; //black fore\n        _ColorTable[1] = 'rgb(128, 0, 0)'; //red fore\n        _ColorTable[2] = 'rgb(0, 128, 0)'; //green fore\n        _ColorTable[3] = 'rgb(128, 128, 0)'; //yellow fore\n        _ColorTable[4] = 'rgb(0, 0, 238)'; //blue fore\n        _ColorTable[5] = 'rgb(128, 0, 128)'; //magenta fore\n        _ColorTable[6] = 'rgb(0, 128, 128)'; //cyan fore\n        _ColorTable[7] = 'rgb(187, 187, 187)'; //white fore\n        _ColorTable[8] = 'rgb(128, 128, 128)'; //black  bold\n        _ColorTable[9] = 'rgb(255, 0, 0)'; //Red bold\n        _ColorTable[10] = 'rgb(0, 255, 0)'; //green bold\n        _ColorTable[11] = 'rgb(255, 255, 0)'; //yellow bold\n        _ColorTable[12] = 'rgb(92, 92, 255)'; //blue bold\n        _ColorTable[13] = 'rgb(255, 0, 255)'; //magenta bold\n        _ColorTable[14] = 'rgb(0, 255, 255)'; //cyan bold\n        _ColorTable[15] = 'rgb(255, 255, 255)'; //white bold\n        _ColorTable[256] = 'rgb(0, 0, 0)'; //black faint\n        _ColorTable[257] = 'rgb(118, 0, 0)'; //red  faint\n        _ColorTable[258] = 'rgb(0, 108, 0)'; //green faint\n        _ColorTable[259] = 'rgb(145, 136, 0)'; //yellow faint\n        _ColorTable[260] = 'rgb(0, 0, 167)'; //blue faint\n        _ColorTable[261] = 'rgb(108, 0, 108)'; //magenta faint\n        _ColorTable[262] = 'rgb(0, 108, 108)'; //cyan faint\n        _ColorTable[263] = 'rgb(161, 161, 161)'; //white faint\n        _ColorTable[264] = 'rgb(0, 0, 0)'; //BackgroundBlack\n        _ColorTable[265] = 'rgb(128, 0, 0)'; //red back\n        _ColorTable[266] = 'rgb(0, 128, 0)'; //greenback\n        _ColorTable[267] = 'rgb(128, 128, 0)'; //yellow back\n        _ColorTable[268] = 'rgb(0, 0, 238)'; //blue back\n        _ColorTable[269] = 'rgb(128, 0, 128)'; //magenta back\n        _ColorTable[270] = 'rgb(0, 128, 128)';  //cyan back\n        _ColorTable[271] = 'rgb(187, 187, 187)';  //white back\n\n        _ColorTable[272] = 'rgb(0,0,0)'; //InfoBackground\n        _ColorTable[273] = 'rgb(0, 255, 255)';  //InfoText\n        _ColorTable[274] = 'rgb(0,0,0)'; //LocalEchoBackground\n        _ColorTable[275] = 'rgb(255, 255, 0)';  //LocalEchoText\n        _ColorTable[276] = 'rgb(0, 0, 0)';  //DefaultBack\n        _ColorTable[277] = 'rgb(229, 229, 229)';  //DefaultFore\n\n        _ColorTable[278] = 'rgb(205, 0, 0)';  //ErrorFore\n        _ColorTable[279] = 'rgb(229, 229, 229)';  //ErrorBack\n\n        _ColorTable[280] = 'rgb(255,255,255)';  //DefaultBrightFore\n        this._ColorTable = _ColorTable;\n    }\n\n    public GetColor(code: number) {\n        if (this._ColorTable == null)\n            this._buildColorTable();\n        switch (code) {\n            case -12:\n                return this._ColorTable[279];  //ErrorBack\n            case -11:\n                return this._ColorTable[278];  //ErrorFore\n            case -10:\n                return this._ColorTable[280];  //DefaultBrightFore\n            case -8:\n                return this._ColorTable[272]; //InfoBackground\n            case -7:\n                return this._ColorTable[273];  //InfoText\n            case -4:\n                return this._ColorTable[274]; //LocalEchoBackground\n            case -3:\n                return this._ColorTable[275];  //LocalEchoText\n            case 49:\n            case -2:\n                return this._ColorTable[276];  //DefaultBack\n            case 39:\n            case -1:\n                return this._ColorTable[277];  //DefaultBack\n            case 0:\n            case 30: //set foreground color to black\n                return this._ColorTable[0];\n            case 1:\n            case 31: //set foreground color to red\n                return this._ColorTable[1];\n            case 2:\n            case 32: //set foreground color to green\n                return this._ColorTable[2];\n            case 3:\n            case 33:  //set foreground color to yellow\n                return this._ColorTable[3];\n            case 4:\n            case 34: //set foreground color to blue\n                return this._ColorTable[4];\n            case 5:\n            case 35:  //set foreground color to magenta (purple)\n                return this._ColorTable[5];\n            case 6:\n            case 36:  //set foreground color to cyan\n                return this._ColorTable[6];\n            case 7:\n            case 37:  //set foreground color to white\n                return this._ColorTable[7];\n            case 40:  //background black\n                return this._ColorTable[264];\n            case 41:  //background red\n                return this._ColorTable[265];\n            case 42:  //background green\n                return this._ColorTable[266];\n            case 43:  //background yellow\n                return this._ColorTable[267];\n            case 44:  //background blue\n                return this._ColorTable[268];\n            case 45:  //background magenta\n                return this._ColorTable[269];\n            case 46:  //cyan\n                return this._ColorTable[270];\n            case 47:  //white\n                return this._ColorTable[271];\n            case 8:\n            case 90:\n            case 100:\n            case 300: //set foreground color to black\n            case 400:\n                return this._ColorTable[8];\n            case 9:\n            case 91:\n            case 101:\n            case 310: //set foreground color to red\n            case 410:\n                return this._ColorTable[9];\n            case 10:\n            case 92:\n            case 102:\n            case 320: //set foreground color to green\n            case 420:\n                return this._ColorTable[10];\n            case 11:\n            case 93:\n            case 103:\n            case 330:  //set foreground color to yellow\n            case 430:\n                return this._ColorTable[11];\n            case 12:\n            case 94:\n            case 104:\n            case 340: //set foreground color to blue\n            case 440:\n                return this._ColorTable[12];\n            case 13:\n            case 95:\n            case 105:\n            case 350:  //set foreground color to magenta (purple)\n            case 450:\n                return this._ColorTable[13];\n            case 14:\n            case 96:\n            case 106:\n            case 360:  //set foreground color to cyan\n            case 460:\n                return this._ColorTable[14];\n            case 15:\n            case 97:\n            case 107:\n            case 370:  //set foreground color to white\n            case 470:\n                return this._ColorTable[15];\n            case 4000:\n            case 3000: //set foreground color to black\n                return this._ColorTable[256];\n            case 4100:\n            case 3100: //set foreground color to red\n                return this._ColorTable[257];\n            case 4200:\n            case 3200: //set foreground color to green\n                return this._ColorTable[258];\n            case 4300:\n            case 3300:  //set foreground color to yellow\n                return this._ColorTable[259];\n            case 4400:\n            case 3400: //set foreground color to blue\n                return this._ColorTable[260];\n            case 4500:\n            case 3500:  //set foreground color to magenta (purple)\n                return this._ColorTable[261];\n            case 4600:\n            case 3600:  //set foreground color to cyan\n                return this._ColorTable[262];\n            case 4700:\n            case 3700:  //set foreground color to white\n                return this._ColorTable[263];\n            default:\n                if (code <= -16) {\n                    code += 16;\n                    code *= -1;\n                }\n                if (code >= 0 && code < 281)\n                    return this._ColorTable[code];\n                return this._ColorTable[277];\n        }\n    }\n\n    public SetColor(code: number, color) {\n        if (this._ColorTable == null)\n            this._buildColorTable();\n        if (code < 0 || code >= this._ColorTable.length)\n            return;\n        color = new RGBColor(color);\n        if (!color.ok) return;\n        this._ColorTable[code] = color.toRGB();\n    }\n\n    private _AddLine(line: string, raw: string, fragment: boolean, skip: boolean, formats: LineFormat[], remote: boolean) {\n        const data: ParserLine = { raw: raw, line: line, fragment: fragment, gagged: skip, formats: this._pruneFormats(formats, line.length, fragment), remote: remote };\n        this.emit('add-line', data);\n        this.EndOfLine = !fragment;\n    }\n\n    private _pruneFormats(formats, textLen, fragment) {\n        //no formats or only 1 format\n        if (!formats || formats.length < 2) return formats;\n        const l = formats.length;\n        const nF = [];\n        for (let f = 0; f < l; f++) {\n            const format = formats[f];\n            let end;\n            if (f < l - 1) {\n                const nFormat = formats[f + 1];\n                //skip format until find one that has different offset\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\n                    continue;\n                end = nFormat.offset;\n                //empty link\n                if (format.formatType === FormatType.Link && end - format.offset === 0 && nFormat.formatType === FormatType.LinkEnd)\n                    continue;\n                //empty send\n                if (format.formatType === FormatType.MXPSend && end - format.offset === 0 && nFormat.formatType === FormatType.MXPSendEnd)\n                    continue;\n                //empty link\n                if (format.formatType === FormatType.MXPLink && end - format.offset === 0 && nFormat.formatType === FormatType.MXPLinkEnd)\n                    continue;\n            }\n            //trailing link with no text or empty format block and not fragment\n            else if (!fragment && format.offset === textLen && textLen !== 0 && ((format.formatType === FormatType.Normal && !format.hr) || format.formatType === FormatType.Link || format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink))\n                continue;\n            nF.push(format);\n        }\n        return nF;\n    }\n\n    private _GetEntity(entity: string) {\n        if (entity === 'text')\n            return entity;\n        //custom entity\n        if (this._mxpEntities[entity]) {\n            //expanded it for processing\n            this._mxpState.expanded = true;\n            //return value to be processed as value could contain mxp tags and other entities\n            return this._mxpEntities[entity].value;\n        }\n        return entity;\n    }\n\n    private _ClearMXPToTag(tag: MXPTag, custom?: string, secure?: boolean) {\n        if (custom == null) custom = '';\n        let tmp = new MXPStyle();\n        tmp.tag = MXPTag.None;\n        let ml = this._mxpStyles.length - 1;\n        for (; ml >= 0; ml--) {\n            if (this._mxpStyles[ml].tag !== tag && this._mxpStyles[ml].custom !== custom) {\n                if (!this._mxpStyles[ml].open && !secure) continue;\n                tmp = this._mxpStyles.splice(ml, 1)[0];\n            }\n            else\n                break;\n        }\n        //return the matching tag\n        if (ml >= 0 && this._mxpStyles.length > 0)\n            tmp = this._mxpStyles.splice(ml, 1)[0];\n        else if (this._mxpStyles.length === 0)\n            this.ResetMXP();\n        return tmp;\n    }\n\n    private _ClearMXPOpen() {\n        let ml = this._mxpStyles.length;\n        while (ml--) {\n            if (!this._mxpStyles[ml].open) continue;\n            this._mxpStyles.splice(ml, 1);\n        }\n        if (this._mxpStyles.length === 0)\n            this.ResetMXP();\n    }\n\n    private _getMXPOpenFormatBlocks() {\n        if (!this._mxpState.on) return [];\n        let m = 0;\n        const ml = this._mxpStyles.length;\n        const formats = [];\n        for (; m < ml; m++) {\n            if (this._mxpStyles[m].tag === MXPTag.A || this._mxpStyles[m].tag === MXPTag.SEND)\n                formats.push(Object.assign({}, this._mxpStyles[m].properties));\n        }\n        return formats;\n    }\n\n    private _getMXPCloseFormatBlocks() {\n        if (!this._mxpState.on) return [];\n        let ml = this._mxpStyles.length;\n        const formats = [];\n        while (ml--) {\n            if (this._mxpStyles[ml].tag === MXPTag.A)\n                formats.push({ formatType: FormatType.MXPLinkEnd });\n            else if (this._mxpStyles[ml].tag === MXPTag.SEND)\n                formats.push({ formatType: FormatType.MXPSendEnd });\n        }\n        return formats;\n    }\n\n    private _getMXPBlock(tag: string, args, remote, oTag?, blocks?): MXPBlock {\n        let tmp;\n        let arg;\n        let sArg;\n        let sArgs;\n        let color;\n        let x;\n        let xl = args.length;\n        let e;\n        let sl;\n        let s;\n        let href = '';\n        let hint = '';\n        let expire = '';\n        let prompt = false;\n        tag = tag.toUpperCase();\n        if (this.enableDebug) {\n            this.emit('debug', 'MXP Tag: ' + tag);\n            this.emit('debug', 'MXP Tag Args: ' + args);\n        }\n        switch (tag) {\n            case 'C':\n            case 'COLOR':\n                tmp = this._CloneCurrentStyle();\n                tmp.tag = MXPTag[tag];\n                tmp.open = true;\n                if (xl > 0) {\n                    arg = args[0].split('=');\n                    if (arg.length > 1) {\n                        color = new RGBColor(stripQuotes(arg[1]));\n                        if (!color.ok) return null;\n                        if (arg[0].toUpperCase() === 'BACK')\n                            tmp.back = color.toRGB();\n                        else\n                            tmp.fore = color.toRGB();\n                    }\n                    else {\n                        color = new RGBColor(stripQuotes(arg[0]));\n                        if (color.ok)\n                            tmp.fore = color.toRGB();\n                    }\n                }\n                if (xl > 1) {\n                    arg = args[1].split('=');\n                    if (arg.length > 1) {\n                        color = new RGBColor(stripQuotes(arg[1]));\n                        if (!color.ok) return null;\n                        if (arg[0].toUpperCase() === 'FORE')\n                            tmp.fore = color.toRGB();\n                        else\n                            tmp.back = color.toRGB();\n\n                    }\n                    else {\n                        color = new RGBColor(stripQuotes(arg[0]));\n                        if (color.ok)\n                            tmp.back = color.toRGB();\n                    }\n                }\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'B':\n            case 'BOLD':\n            case 'STRONG':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Bold;\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'FONT':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                for (x = 0; x < xl; x++) {\n                    arg = args[x].split('=');\n                    if (arg.length > 1) {\n                        switch (arg[0].toUpperCase()) {\n                            case 'SIZE':\n                                if (this._isNumber(arg[1]))\n                                    tmp.fontSize = arg[1] + 'pt';\n                                else\n                                    tmp.fontSize = arg[1] || 0;\n                                break;\n                            case 'COLOR':\n                                sArgs = arg[1].split(',');\n                                color = new RGBColor(stripQuotes(sArgs[0]));\n                                if (color.ok) tmp.fore = color.toRGB();\n                                for (s = 1, sl = sArgs.length; s < sl; s++) {\n                                    switch (sArgs[s].toLowerCase()) {\n                                        case 'bold':\n                                            tmp.style |= FontStyle.Bold;\n                                            break;\n                                        case 'italic':\n                                            tmp.style |= FontStyle.Italic;\n                                            break;\n                                        case 'underline':\n                                            tmp.style |= FontStyle.Underline;\n                                            break;\n                                        case 'blink':\n                                            tmp.style |= FontStyle.Slow;\n                                            break;\n                                        case 'inverse':\n                                            tmp.style |= FontStyle.Inverse;\n                                            break;\n                                        case 'hidden':\n                                            tmp.style |= FontStyle.Hidden;\n                                            break;\n                                        case 'strikeout':\n                                            tmp.style |= FontStyle.Strikeout;\n                                            break;\n                                        case 'overline':\n                                            tmp.style |= FontStyle.Overline;\n                                            break;\n                                        case 'doubleunderline':\n                                            tmp.style |= FontStyle.DoubleUnderline;\n                                            break;\n                                    }\n                                }\n                                break;\n                            case 'BACK':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) tmp.back = color.toRGB();\n                                break;\n                            case 'FACE':\n                                tmp.font = stripQuotes(arg[1]) || 0;\n                                break;\n                            default:\n                                if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                break;\n                        }\n                    }\n                    else if (x === 0) {\n                        tmp.font = stripQuotes(args[x]) || 0;\n                    }\n                    else if (x === 1) {\n                        if (this._isNumber(args[x]))\n                            tmp.fontSize = args[x] + 'pt';\n                        else\n                            tmp.fontSize = args[x] || 0;\n                    }\n                    else if (x === 2) {\n                        color = new RGBColor(stripQuotes(args[x]));\n                        if (color.ok) tmp.fore = color.toRGB();\n                    }\n                    else if (x === 3) {\n                        color = new RGBColor(stripQuotes(args[x]));\n                        if (color.ok) tmp.back = color.toRGB();\n                    }\n                }\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'H':\n            case 'HIGH':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.high = true;\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'I':\n            case 'ITALIC':\n            case 'EM':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Italic;\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'U':\n            case 'UNDERLINE':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Underline;\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case 'S':\n            case 'STRIKEOUT':\n                tmp = this._CloneCurrentStyle();\n                tmp.open = true;\n                tmp.tag = MXPTag[tag];\n                tmp.style |= FontStyle.Strikeout;\n                tmp.custom = '';\n                this._mxpStyles.push(tmp);\n                return null;\n            case '/B':\n            case '/BOLD':\n            case '/STRONG':\n            case '/H':\n            case '/HIGH':\n            case '/I':\n            case '/ITALIC':\n            case '/EM':\n            case '/U':\n            case '/UNDERLINE':\n            case '/S':\n            case '/STRIKEOUT':\n            case '/C':\n            case '/COLOR':\n            case '/FONT':\n                this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                return null;\n        }\n        if (this._mxpState.lineType === lineType.Secure || this._mxpState.lineType === lineType.LockSecure || this._mxpState.lineType === lineType.TempSecure) {\n            switch (tag) {\n                case 'IMAGE':\n                    e = {\n                        formatType: FormatType.Image,\n                        name: '',\n                        url: this.DefaultImgUrl,\n                        t: '',\n                        h: '',\n                        w: '',\n                        hspace: '',\n                        vspace: '',\n                        align: 'bottom',\n                        ismap: false\n                    };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'FNAME':\n                                e.name = stripQuotes(arg[1]);\n                                break;\n                            case 'URL':\n                                e.url = stripQuotes(arg[1]);\n                                break;\n                            case 'TYPE':\n                            case 'T':\n                                if (arg[1].length > 0)\n                                    e.type = arg[1];\n                                break;\n                            case 'HEIGHT':\n                            case 'H':\n                                e.h = stripQuotes(arg[1]);\n                                break;\n                            case 'WIDTH':\n                            case 'W':\n                                e.w = stripQuotes(arg[1]);\n                                break;\n                            case 'HSPACE':\n                                e.hspace = arg[1];\n                                break;\n                            case 'VSPACE':\n                                e.vspace = arg[1];\n                                break;\n                            case 'ALIGN':\n                                e.align = arg[1].toLowerCase();\n                                break;\n                            case 'ISMAP':\n                                e.ismap = true;\n                                break;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.url = stripQuotes(args[x]);\n                                else if (x === 2 && args[x].length > 0)\n                                    e.type = args[x];\n                                else if (x === 3)\n                                    e.h = stripQuotes(args[x]);\n                                else if (x === 4)\n                                    e.w = stripQuotes(args[x]);\n                                else if (x === 5)\n                                    e.hspace = args[x];\n                                else if (x === 6)\n                                    e.vspace = args[x];\n                                else if (x === 7)\n                                    e.align = args[x].toLowerCase();\n                                break;\n                        }\n                    }\n                    return { format: e, text: null };\n                case '!AT':\n                case '!ATTLIST':\n                    if (args.length === 0) return null;\n                    e = args[0];\n                    //not defined or if not from the same origin and not open cant change it\n                    if (!this._mxpElements[e] || (this._mxpEntities[e].remote !== e.remote && !this._mxpEntities[e].open))\n                        return null;\n                    //clear out any old ones\n                    this._mxpElements[e].attributes = {};\n                    this._mxpElements[e].attributeIndexes = [];\n                    for (x = 1; x < xl; x++) {\n                        sArgs = args[x].split('=');\n                        if (sArgs.length > 1)\n                            this._mxpElements[e].attributes[sArgs[0].toLowerCase()] = sArgs[1];\n                        else\n                            this._mxpElements[e].attributes[sArgs[0].toLowerCase()] = '';\n                        this._mxpElements[e].attributeIndexes.push(sArgs[0].toLowerCase());\n                    }\n                    break;\n                case '!TAG':\n                    e = new Tag();\n                    e.remote = remote;\n                    for (x = 0; x < xl; x++) {\n                        //special case, as attribute list has = in it so test for it\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'WINDOWNAME':\n                                e.window = stripQuotes(arg[1]);\n                                break;\n                            case 'FORE':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) e.fore = color.toRGB();\n                                break;\n                            case 'BACK':\n                                color = new RGBColor(stripQuotes(arg[1]));\n                                if (color.ok) e.back = color.toRGB();\n                                break;\n                            case 'GAG':\n                                e.gag = true;\n                                break;\n                            case 'ENABLE':\n                                e.enabled = true;\n                                break;\n                            case 'DISABLE':\n                                e.enabled = false;\n                                break;\n                            default:\n                                if (x === 0) {\n                                    tmp = +args[x];\n                                    if (!isNaN(tmp)) e.index = tmp;\n                                }\n                                else if (x === 1)\n                                    e.window = stripQuotes(args[x]);\n                                else if (x === 2) {\n                                    color = new RGBColor(stripQuotes(args[x]));\n                                    if (color.ok) e.fore = color.toRGB();\n                                }\n                                else if (x === 3) {\n                                    color = new RGBColor(stripQuotes(args[x]));\n                                    if (color.ok) e.back = color.toRGB();\n                                }\n                                break;\n                        }\n                    }\n                    if (e.fore.length > 0 && e.back.length > 0)\n                        e.definition = `<C \"${e.fore}\" \"${e.back}\">`;\n                    else if (e.fore.length > 0)\n                        e.definition = `<C \"${e.fore}\">`;\n                    else if (e.back.length > 0)\n                        e.definition = `<C BACK=\"${e.fore}\">`;\n                    if (e.definition.length > 0)\n                        e.closeDefinition = '</C>';\n                    if (this._mxpLines[e.index]) {\n                        //mud can over ride local, but local can not override remote\n                        if (e.remote || this._mxpLines[e.index].remote === e.remote)\n                            this._mxpLines[e.index] = e;\n                    }\n                    else\n                        this._mxpLines[e.index] = e;\n                    break;\n                case '!EL':\n                case '!ELEMENT':\n                    e = new Element(remote);\n                    for (x = 0; x < xl; x++) {\n                        //special case, as attribute list has = in it so test for it\n                        if (args[x].toUpperCase().startsWith('ATT=')) {\n                            arg = stripQuotes(args[x]).substring(4).split(' ');\n                            for (s = 0, sl = arg.length; s < sl; s++) {\n                                sArgs = stripQuotes(arg[s]).split('=');\n                                if (sArgs.length > 1)\n                                    e.attributes[sArgs[0].toLowerCase()] = stripQuotes(sArgs[1]);\n                                else\n                                    e.attributes[sArgs[0].toLowerCase()] = '';\n                                e.attributeIndexes.push(sArgs[0].toLowerCase());\n                            }\n                            continue;\n                        }\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'TAG':\n                                tmp = +arg[1];\n                                if (!isNaN(tmp)) e.tag = tmp;\n                                break;\n                            case 'FLAG':\n                                e.flag = stripQuotes(arg[1]);\n                                break;\n                            case 'OPEN':\n                                e.open = true;\n                                break;\n                            case 'DELETE':\n                                if (this._mxpElements[e.name] && (this._mxpEntities[e.name].remote === e.remote || this._mxpEntities[e.name].open))\n                                    delete this._mxpEntities[e.name];\n                                return null;\n                            case 'EMPTY':\n                                e.empty = true;\n                                break;\n                            /*\n                          case \"HIDDEN\":\n                            e.hidden = true;\n                            break;\n                            */\n                            case 'SECURE':\n                                e.open = false;\n                                break;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]).toUpperCase();\n                                else if (x === 1) {\n                                    e.definition = stripQuotes(args[x]);\n                                    e.closeDefinition = this._GetCloseTags(e.definition);\n                                    if (this.enableDebug) this.emit('debug', 'MXP close definition: ' + e.closeDefinition);\n                                }\n                                else if (x === 2) {\n                                    arg = args[x].substring(4).split(' ');\n                                    for (s = 0, sl = arg.length; s < sl; s++) {\n                                        sArgs = arg[s].split('=');\n                                        if (sArgs.length > 1)\n                                            e.attributes[sArgs[0]] = sArgs[1];\n                                        else\n                                            e.attributes[sArgs[0]] = '';\n                                        e.attributeIndexes.push(sArgs[0]);\n                                    }\n                                }\n                                else if (x === 3) {\n                                    tmp = +args[x];\n                                    if (!isNaN(tmp)) e.tag = tmp;\n                                }\n                                else if (x === 4)\n                                    e.flag = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (e.tag > 19 && e.tag < 100) {\n                        tmp = new Tag(e.tag);\n                        tmp.element = e.name;\n                        if (this._mxpLines[tmp.index]) {\n                            //mud can over ride local, but local can not override remote\n                            if (e.remote || this._mxpLines[tmp.index].remote === e.remote)\n                                this._mxpLines[tmp.index] = tmp;\n                        }\n                        else\n                            this._mxpLines[tmp.index] = tmp;\n                    }\n                    if (this._mxpElements[e.name]) {\n                        //can only override if from same origin (eg from mud, or from local) or if an open tag\n                        if (this._mxpElements[e.name].remote === e.remote || this._mxpEntities[e.name].open)\n                            this._mxpElements[e.name] = e;\n                    }\n                    else\n                        this._mxpElements[e.name] = e;\n                    break;\n                case '!EN':\n                case '!ENTITY':\n                    e = new Entity(remote);\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'DESC':\n                                e.description = stripQuotes(arg[1]);\n                                break;\n                            case 'PRIVATE':\n                                e.publish = false;\n                                break;\n                            case 'PUBLISH':\n                                e.publish = true;\n                                break;\n                            case 'DELETE':\n                                //can only modify if from same origin, eg mud can only mod mud, and user can only mod user\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote)\n                                    delete this._mxpEntities[e.name];\n                                return null;\n                            case 'ADD':\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote) {\n                                    if (!this._mxpEntities[e.name].value)\n                                        this._mxpEntities[e.name].value = e.value;\n                                    else\n                                        this._mxpEntities[e.name].value += '|' + e.value;\n                                    return null;\n                                }\n                                break;\n                            case 'REMOVE':\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote) {\n                                    if (this._mxpEntities[e.name].value) {\n                                        sArgs = this._mxpEntities[e.name].value.split('|');\n                                        sArg = [];\n                                        for (s = 0, sl = sArgs.length; s < sl; s++) {\n                                            if (sArgs[s] !== e.value)\n                                                sArg.push(sArgs[s]);\n                                        }\n                                        this._mxpEntities[e.name].value = sArg.join('|');\n                                    }\n                                }\n                                return null;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.value = stripQuotes(args[x]);\n                                else if (x === 2)\n                                    e.description = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (this._mxpEntities[e.name]) {\n                        if (this._mxpEntities[e.name].remote === e.remote)\n                            this._mxpEntities[e.name] = e;\n                    }\n                    else\n                        this._mxpEntities[e.name] = e;\n                    break;\n                case '/V':\n                case '/VAR':\n                    tmp = this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    e = new Entity(remote);\n                    if (this._mxpState.captured.length > 0)\n                        e.value = this._mxpState.captured.pop().join('');\n                    else\n                        e.value = '';\n                    this._mxpState.capture--;\n                    if (this.enableDebug) this.emit('debug', 'MXP captured: ' + e.value);\n                    args = tmp.obj;\n                    xl = args.length;\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        switch (arg[0].toUpperCase()) {\n                            case 'DESC':\n                                e.description = stripQuotes(arg[1]);\n                                break;\n                            case 'PRIVATE':\n                                e.publish = false;\n                                break;\n                            case 'PUBLISH':\n                                e.publish = true;\n                                break;\n                            case 'DELETE':\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote)\n                                    delete this._mxpEntities[e.name];\n                                return null;\n                            case 'ADD':\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote) {\n                                    if (!this._mxpEntities[e.name].value)\n                                        this._mxpEntities[e.name].value = e.value;\n                                    else\n                                        this._mxpEntities[e.name].value += '|' + e.value;\n                                    return null;\n                                }\n                                break;\n                            case 'REMOVE':\n                                if (this._mxpEntities[e.name] && this._mxpEntities[e.name].remote === e.remote) {\n                                    if (this._mxpEntities[e.name].value) {\n                                        sArgs = this._mxpEntities[e.name].value.split('|');\n                                        sArg = [];\n                                        for (s = 0, sl = sArgs.length; s < sl; s++) {\n                                            if (sArgs[s] !== e.value)\n                                                sArg.push(sArgs[s]);\n                                        }\n                                        this._mxpEntities[e.name].value = sArg.join('|');\n                                    }\n                                }\n                                return null;\n                            default:\n                                if (x === 0)\n                                    e.name = stripQuotes(args[x]);\n                                else if (x === 1)\n                                    e.description = stripQuotes(args[x]);\n                                break;\n                        }\n                    }\n                    if (this._mxpEntities[e.name]) {\n                        if (this._mxpEntities[e.name].remote === e.remote)\n                            this._mxpEntities[e.name] = e;\n                    }\n                    else\n                        this._mxpEntities[e.name] = e;\n                    break;\n                case 'V':\n                case 'VAR':\n                    this._mxpState.captured.push([]);\n                    this._mxpState.capture++;\n                    tmp = this._CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    tmp.obj = args;\n                    tmp.custom = '';\n                    this._mxpStyles.push(tmp);\n                    return null;\n                case 'GAUGE':\n                    e = { value: 0, max: 1, caption: '', color: 0 };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'VALUE':\n                                    tmp = parseFloat(this._GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this._GetEntity(arg[1]);\n                                    e.value = tmp;\n                                    break;\n                                case 'MAX':\n                                    tmp = parseFloat(this._GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this._GetEntity(arg[1]);\n                                    e.max = tmp;\n                                    break;\n                                case 'CAPTION':  //volume\n                                    if (arg[1].length > 0)\n                                        e.caption = stripQuotes(arg[1]);\n                                    break;\n                                case 'COLOR':  //repeat\n                                    color = new RGBColor(stripQuotes(arg[1]));\n                                    if (color.ok) e.color = color.toRGB();\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            tmp = parseFloat(this._GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this._GetEntity(args[x]);\n                            e.value = tmp;\n                        }\n                        else if (x === 1) {\n                            tmp = parseFloat(this._GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this._GetEntity(args[x]);\n                            e.max = tmp;\n                        }\n                        else if (x === 2 && args[x].length > 0)\n                            e.caption = stripQuotes(args[x]);\n                        else if (x === 3 && args[x].length > 0) {\n                            color = new RGBColor(stripQuotes(arg[1]));\n                            if (color.ok) e.color = color.toRGB();\n                        }\n                    }\n                    this._mxpState.expanded = false;\n                    this.emit('gauge', e);\n                    break;\n                case 'STAT':\n                    e = { value: 0, max: 1, caption: '' };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'VALUE':\n                                    tmp = parseFloat(this._GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this._GetEntity(arg[1]);\n                                    e.value = tmp;\n                                    break;\n                                case 'MAX':\n                                    tmp = parseFloat(this._GetEntity(arg[1]));\n                                    if (isNaN(tmp))\n                                        tmp = this._GetEntity(arg[1]);\n                                    e.max = tmp;\n                                    break;\n                                case 'CAPTION':  //volume\n                                    if (arg[1].length > 0)\n                                        e.caption = stripQuotes(arg[1]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            tmp = parseFloat(this._GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this._GetEntity(args[x]);\n                            e.value = tmp;\n                        }\n                        else if (x === 1) {\n                            tmp = parseFloat(this._GetEntity(args[x]));\n                            if (isNaN(tmp))\n                                tmp = this._GetEntity(args[x]);\n                            e.max = tmp;\n                        }\n                        else if (x === 2 && args[x].length > 0)\n                            e.caption = stripQuotes(args[x]);\n                    }\n                    this._mxpState.expanded = false;\n                    this.emit('stat', e);\n                    break;\n                case 'MUSIC':\n                    e = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'FNAME':\n                                    e.file = stripQuotes(arg[1]);\n                                    if (e.file.toLowerCase() === 'off') {\n                                        e.off = true;\n                                        e.file = '';\n                                    }\n                                    break;\n                                case 'V':  //volume\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 100;\n                                    e.volume = tmp;\n                                    break;\n                                case 'L':  //repeat\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.repeat = tmp;\n                                    break;\n                                case 'C':  //continue\n                                    e.continue = arg[1] !== '0';\n                                    break;\n                                case 'T':  //type\n                                    if (arg[1].length > 0)\n                                        e.type = arg[1];\n                                    break;\n                                case 'U':  //url\n                                    e.url = stripQuotes(arg[1]);\n                                    if (!e.url.endsWith('/') && e.url.length > 0)\n                                        e.url += '/';\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            e.file = stripQuotes(args[x]);\n                            if (e.file.toLowerCase() === 'off') {\n                                e.off = true;\n                                e.file = '';\n                            }\n                        }\n                        else if (x === 1) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 100;\n                            e.volume = tmp;\n                        }\n                        else if (x === 2) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.repeat = tmp;\n                        }\n                        else if (x === 3)\n                            e.continue = args[x] !== '0';\n                        else if (x === 4) {\n                            if (args[x].length > 0)\n                                e.type = args[x];\n                        }\n                        else if (x === 5) {\n                            e.url = stripQuotes(args[x]);\n                            if (!e.url.endsWith('/') && e.url.length > 0)\n                                e.url += '/';\n                        }\n                    }\n                    this.emit('music', e);\n                    break;\n                case 'SOUND':\n                    e = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'FNAME':\n                                    e.file = stripQuotes(arg[1]);\n                                    if (e.file.toLowerCase() === 'off') {\n                                        e.off = true;\n                                        e.file = '';\n                                    }\n                                    break;\n                                case 'V':  //volume\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 100;\n                                    e.volume = tmp;\n                                    break;\n                                case 'L':  //repeat\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.repeat = tmp;\n                                    break;\n                                case 'P':  //priority\n                                    tmp = +arg[1];\n                                    if (isNaN(tmp))\n                                        tmp = 1;\n                                    e.priority = tmp;\n                                    break;\n                                case 'T':  //type\n                                    if (arg[1].length > 0)\n                                        e.type = arg[1];\n                                    break;\n                                case 'U':  //url\n                                    e.url = stripQuotes(arg[1]);\n                                    if (!e.url.endsWith('/') && e.url.length > 0)\n                                        e.url += '/';\n                                    break;\n                            }\n                        }\n                        else if (x === 0) {\n                            e.file = stripQuotes(args[x]);\n                            if (e.file.toLowerCase() === 'off') {\n                                e.off = true;\n                                e.file = '';\n                            }\n                        }\n                        else if (x === 1) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 100;\n                            e.volume = tmp;\n                        }\n                        else if (x === 2) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.repeat = tmp;\n                        }\n                        else if (x === 3) {\n                            tmp = +args[x];\n                            if (isNaN(tmp))\n                                tmp = 1;\n                            e.priority = tmp;\n                        }\n                        else if (x === 4) {\n                            if (args[x].length > 0)\n                                e.type = args[x];\n                        }\n                        else if (x === 5) {\n                            e.url = stripQuotes(args[x]);\n                            if (!e.url.endsWith('/') && e.url.length > 0)\n                                e.url += '/';\n                        }\n                    }\n                    this.emit('sound', e);\n                    break;\n                case 'EXPIRE':\n                    //emit expire event to handle old links\n                    this.emit('expire-links', args);\n                    //expire any links in the current line that match\n                    this._cleanMXPExpired(blocks, args?.[0] || '');\n                    break;\n                case 'VERSION':\n                    if (xl > 0)\n                        this.StyleVersion = args[0];\n                    else\n                        this.emit('MXP-tag-reply', tag, []);\n                    break;\n                case 'USER':\n                case 'PASSWORD':\n                    this.emit('MXP-tag-reply', tag, args);\n                    break;\n                case 'SUPPORT':\n                    sArgs = [];\n                    if (xl > 0) {\n                        for (x = 0; x < xl; x++) {\n                            arg = stripQuotes(args[x]);\n                            if (arg.indexOf('.') === -1) {\n                                arg = arg.toUpperCase();\n                                switch (arg) {\n                                    //TODO re-enable once font size/face  are supported\n                                    //case 'FONT':\n                                    case 'IMAGE':\n                                    case 'HR':\n                                    case 'A':\n                                    case 'SEND':\n                                    case 'B':\n                                    case 'I':\n                                    case 'COLOR':\n                                    case 'C':\n                                    case 'EM':\n                                    case 'ITALIC':\n                                    case 'STRONG':\n                                    case 'BOLD':\n                                    case 'UNDERLINE':\n                                    case 'U':\n                                    case 'S':\n                                    case 'STRIKEOUT':\n                                    case 'STRIKE':\n                                    case 'H':\n                                    case 'HIGH':\n                                    case 'EXPIRE':\n                                    case 'VERSION':\n                                    case 'SUPPORT':\n                                    case 'NOBR':\n                                    case 'P':\n                                    case 'BR':\n                                    case 'SBR':\n                                    case 'SOUND':\n                                    case 'MUSIC':\n                                    case 'VAR':\n                                    case 'USER':\n                                    case 'PASSWORD':\n                                    case 'H1':\n                                    case 'H2':\n                                    case 'H3':\n                                    case 'H4':\n                                    case 'H5':\n                                    case 'H6':\n                                    case 'RESET':\n                                    case 'GAUGE':\n                                    case 'STAT':\n                                        sArgs.push('+' + name);\n                                        break;\n                                    default:\n                                        sArgs.push('-' + name);\n                                        break;\n                                }\n                            }\n                            else {\n                                arg = args[x].split('.');\n                                arg[0] = arg[0].toUpperCase();\n                                switch (arg[0]) {\n                                    case 'IMAGE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+image.fname');\n                                            sArgs.push('+image.url');\n                                            sArgs.push('+image.t');\n                                            sArgs.push('+image.h');\n                                            sArgs.push('+image.w');\n                                            sArgs.push('+image.hspace');\n                                            sArgs.push('+image.vspace');\n                                            sArgs.push('+image.align');\n                                            sArgs.push('+image.ismap');\n                                        }\n                                        break;\n                                    case 'SOUND':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+sound.v');\n                                            sArgs.push('+sound.l');\n                                            sArgs.push('+sound.p');\n                                            sArgs.push('+sound.t');\n                                            sArgs.push('+sound.u');\n                                        }\n                                        break;\n                                    case 'MUSIC':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+music.v');\n                                            sArgs.push('+music.l');\n                                            sArgs.push('+music.c');\n                                            sArgs.push('+music.t');\n                                            sArgs.push('+music.u');\n                                        }\n                                        break;\n                                    case 'A':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+a.href');\n                                            sArgs.push('+a.hint');\n                                            sArgs.push('+a.expire');\n                                        }\n                                        break;\n                                    case 'SEND':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+send.href');\n                                            sArgs.push('+send.hint');\n                                            sArgs.push('+send.prompt');\n                                            sArgs.push('+send.expire');\n                                        }\n                                        break;\n                                    case 'COLOR':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+color.fore');\n                                            sArgs.push('+color.back');\n                                        }\n                                        break;\n                                    case 'C':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+c.fore');\n                                            sArgs.push('+c.back');\n                                        }\n                                        break;\n                                    case 'FONT':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            //TODO switch to + when face and size supported\n                                            sArgs.push('-font.face');\n                                            sArgs.push('-font.size');\n                                            sArgs.push('+font.color');\n                                            sArgs.push('+font.back');\n                                        }\n                                        break;\n                                    case 'EXPIRE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else\n                                            sArgs.push('+expire.Name');\n                                        break;\n                                    case 'GAUGE':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+gauge.max');\n                                            sArgs.push('+gauge.caption');\n                                            sArgs.push('+gauge.color');\n                                        }\n                                        break;\n                                    case 'STAT':\n                                        if (arg[1] !== '*')\n                                            sArgs.push('+' + arg[0] + '.' + arg[1]);\n                                        else {\n                                            sArgs.push('+stat.max');\n                                            sArgs.push('+stat.caption');\n                                        }\n                                        break;\n                                    default:\n                                        if (arg[1] !== '*')\n                                            sArgs.push('-' + arg[0] + '.' + arg[1]);\n                                        else\n                                            sArgs.push('-' + arg[0]);\n                                        break;\n                                }\n                            }\n                        }\n                    }\n                    else\n                        //TODO enable font once font face/size are supported\n                        sArgs = ['+A', '+SEND', '+B', '+I', '+COLOR', '+C', '+EM', '+ITALIC', '+STRONG', '+BOLD', '+UNDERLINE', '+U', '+S', '+STRIKEOUT', '+H', '+HIGH', '-FONT', '+EXPIRE', '+VERSION', '+SUPPORT', '+NOBR', '+P', '+BR', '+SBR', '+VAR', '+SOUND', '+MUSIC', '+USER', '+PASSWORD', '+RESET', '+STRIKE', '+H1', '+H2', '+H3', '+H4', '+H5', '+H6', '+IMAGE', '+STAT', '+GAUGE'];\n                    this.emit('MXP-tag-reply', tag, sArgs);\n                    break;\n                case 'A':\n                    tmp = this._CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'HREF':\n                                    href = stripQuotes(arg[1]);\n                                    break;\n                                case 'HINT':\n                                    hint = stripQuotes(arg[1]);\n                                    break;\n                                case 'EXPIRE':\n                                    expire = stripQuotes(arg[1]);\n                                    break;\n                                default:\n                                    if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0)\n                            href = stripQuotes(args[x]);\n                        else if (x === 1)\n                            hint = stripQuotes(args[x]);\n                        else if (x === 2)\n                            expire = stripQuotes(args[x]);\n                    }\n                    tmp.custom = '';\n                    tmp.properties = {\n                        formatType: FormatType.MXPLink,\n                        href: href,\n                        hint: hint,\n                        expire: expire\n                    };\n                    this._mxpStyles.push(tmp);\n                    if (hint.length === 0)\n                        hint = href;\n                    return {\n                        format: {\n                            formatType: FormatType.MXPLink,\n                            href: href,\n                            hint: hint,\n                            expire: expire\n                        },\n                        text: null\n                    };\n                case 'SEND':\n                    tmp = this._CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    for (x = 0; x < xl; x++) {\n                        arg = args[x].split('=');\n                        if (arg[0] === 'PROMPT')\n                            prompt = true;\n                        else if (arg.length > 1) {\n                            switch (arg[0].toUpperCase()) {\n                                case 'HREF':\n                                    href = stripQuotes(arg[1]);\n                                    break;\n                                case 'HINT':\n                                    hint = stripQuotes(arg[1]);\n                                    break;\n                                case 'EXPIRE':\n                                    expire = stripQuotes(arg[1]);\n                                    break;\n                                case 'PROMPT':\n                                    prompt = true;\n                                    break;\n                                default:\n                                    if (this.enableDebug) this.emit('debug', 'Invalid Argument for ' + tag + ': ' + arg[0]);\n                                    break;\n                            }\n                        }\n                        else if (x === 0)\n                            href = stripQuotes(args[x]);\n                        else if (x === 1)\n                            hint = stripQuotes(args[x]);\n                        else if (x === 2)\n                            prompt = true;\n                        else if (x === 3)\n                            expire = stripQuotes(args[x]);\n                    }\n                    tmp.custom = '';\n                    this._mxpStyles.push(tmp);\n                    if (href.length === 0)\n                        href = '&text;';\n                    if (hint.length === 0)\n                        hint = href;\n                    const cmds = href.split('|');\n                    let tt;\n                    if (cmds.length > 1) {\n                        const caps = hint.split('|');\n                        if (caps.length === cmds.length + 1) {\n                            hint = caps[0];\n                            caps.shift();\n                            tt = '[\\'' + caps.join('\\',\\'') + '\\']';\n                        }\n                        href = '[\\'' + cmds.join('\\',\\'') + '\\']';\n                    }\n                    else\n                        href = '\\'' + href + '\\'';\n                    tmp.properties = {\n                        formatType: FormatType.MXPSend,\n                        href: href,\n                        hint: hint,\n                        expire: expire,\n                        prompt: prompt,\n                        tt: tt || ''\n                    };\n                    return {\n                        format: {\n                            formatType: FormatType.MXPSend,\n                            href: href,\n                            hint: hint,\n                            expire: expire,\n                            prompt: prompt,\n                            tt: tt || ''\n                        },\n                        text: null\n                    };\n                case 'H1':\n                case 'H2':\n                case 'H3':\n                case 'H4':\n                case 'H5':\n                case 'H6':\n                    tmp = this._CloneCurrentStyle();\n                    tmp.open = true;\n                    tmp.tag = MXPTag[tag];\n                    tmp.style |= FontStyle.Bold;\n                    tmp.custom = '';\n                    this._mxpStyles.push(tmp);\n                    return null;\n                case '/A':\n                    this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return {\n                        format: {\n                            formatType: FormatType.MXPLinkEnd\n                        }, text: null\n                    };\n                case '/SEND':\n                    this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return {\n                        format: {\n                            formatType: FormatType.MXPSendEnd\n                        }, text: null\n                    };\n                case '/H1':\n                case '/H2':\n                case '/H3':\n                case '/H4':\n                case '/H5':\n                case '/H6':\n                    this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    return null;\n                case 'NOBR':\n                    this._mxpState.noBreak = true;\n                    return null;\n                case '/P':\n                    this._ClearMXPToTag(MXPTag[tag.substring(1)]);\n                    this._mxpState.paragraph = false;\n                    return null;\n                case 'P':\n                    tmp = this._CloneCurrentStyle();\n                    tmp.open = false;\n                    tmp.tag = MXPTag[tag];\n                    tmp.custom = '';\n                    this._mxpStyles.push(tmp);\n                    this._mxpState.paragraph = true;\n                    return null;\n                case 'SBR':\n                    return {\n                        format: null, text: ' \\u200B'\n                    };\n                case 'RESET':\n                    this.ResetMXP();\n                    return null;\n                case 'HR':\n                    const mxp: MXPStyle = this._GetCurrentStyle();\n                    const colors = this._getColors(mxp);\n                    return {\n                        format: {\n                            formatType: FormatType.Normal,\n                            offset: 0,\n                            color: colors.fore,\n                            background: colors.back,\n                            size: mxp.fontSize,\n                            font: mxp.font,\n                            style: mxp.style | (this._CurrentAttributes & ~FontStyle.Bold),\n                            hr: true\n                        }, text: null\n                    };\n            }\n        }\n        if (this._mxpElements[tag]) {\n            e = this._mxpElements[tag];\n            //not open and not in correct lineType\n            if (!e.open && this._mxpState.lineType !== lineType.Secure && this._mxpState.lineType !== lineType.LockSecure && this._mxpState.lineType !== lineType.TempSecure)\n                return null;\n            tmp = this._CloneCurrentStyle();\n            tmp.open = e.open;\n            tmp.tag = MXPTag.Custom;\n            tmp.custom = e.name;\n            arg = e.definition;\n            sArgs = {};\n            //setup default values\n            for (s = 0, sl = e.attributeIndexes.length; s < sl; s++)\n                sArgs[e.attributeIndexes[s]] = e.attributes[e.attributeIndexes[s]];\n            //change any based on passed argument\n            for (x = 0; x < xl; x++) {\n                sArg = args[x].split('=');\n                sArg[0] = sArg[0].toLowerCase();\n                if (e.attributes[sArg[0]])\n                    sArgs[sArg[0]] = sArg[1];\n                else if (x < e.attributeIndexes.length)\n                    sArgs[e.attributeIndexes[x]] = sArg[0];\n            }\n            for (sArg in sArgs) {\n                if (!sArgs.hasOwnProperty(sArg)) continue;\n                arg = arg.replace('&' + sArg + ';', sArgs[sArg]);\n            }\n            if (!e.empty) {\n                this._mxpState.captured.push([]);\n                this._mxpState.capture++;\n            }\n            //mxpState.hidden = e.hidden;\n            if (e.tag > 19 && e.tag < 100 && this._mxpLines[e.tag].enabled && this._mxpLines[e.tag].definition.length > 0) {\n                arg = this._mxpLines[e.tag].definition + arg;\n                tmp.gagged = this._mxpLines[e.tag].gag;\n            }\n            this._mxpState.gagged = tmp.gagged;\n            this._mxpState.expanded = true;\n            //this.mxpStyles.push(tmp);\n            return { format: null, text: arg };\n        }\n        else if (tag.startsWith('/') && this._mxpElements[tag.substring(1)] && !this._mxpElements[tag.substring(1)].empty) {\n            tag = tag.substring(1);\n            e = this._mxpElements[tag];\n\n            //not open and not in correct lineType\n            if (!e.open && this._mxpState.lineType !== lineType.Secure && this._mxpState.lineType !== lineType.LockSecure && this._mxpState.lineType !== lineType.TempSecure)\n                return null;\n\n            //get captured text\n            if (!e.empty && this._mxpState.capture > 0) {\n                if (this._mxpState.captured.length > 0)\n                    sArg = this._mxpState.captured.pop().join('');\n                this._mxpState.capture--;\n            }\n\n            //tmp = this.ClearMXPToTag(MXPTag.Custom, tag);\n            arg = e.closeDefinition;\n\n            if (e.flag.length > 0) {\n                if (e.flag.length > 4 && e.flag.toLowerCase().startsWith('set '))\n                    this.emit('set-variable', e.flag.substring(4), sArg);\n                this.emit('MXP-flag', e.flag, sArg);\n            }\n            if (e.tag > 19 && e.tag < 100 && this._mxpLines[e.tag].enabled && this._mxpLines[e.tag].closeDefinition.length > 0)\n                arg += this._mxpLines[e.tag].closeDefinition;\n            this._mxpState.gagged = !e.gagged;\n            if (e.empty)\n                return null;\n            this._mxpState.expanded = true;\n            return { format: null, text: arg };\n        }\n        if (this.showInvalidMXPTags) {\n            switch (tag) {\n                case 'IMAGE':\n                case '!AT':\n                case '!ATTLIST':\n                case '!TAG':\n                case '!EL':\n                case '!ELEMENT':\n                case '!EN':\n                case '!ENTITY':\n                case '/V':\n                case '/VAR':\n                case 'V':\n                case 'VAR':\n                case 'GAUGE':\n                case 'STAT':\n                case 'MUSIC':\n                case 'SOUND':\n                case 'EXPIRE':\n                case 'VERSION':\n                case 'USER':\n                case 'PASSWORD':\n                case 'SUPPORT':\n                case 'A':\n                case 'SEND':\n                case 'H1':\n                case 'H2':\n                case 'H3':\n                case 'H4':\n                case 'H5':\n                case 'H6':\n                case '/A':\n                case '/SEND':\n                case '/H1':\n                case '/H2':\n                case '/H3':\n                case '/H4':\n                case '/H5':\n                case '/H6':\n                case 'NOBR':\n                case '/P':\n                case 'P':\n                case 'SBR':\n                case 'RESET':\n                case 'HR':\n                    return null;\n\n            }\n            return { format: null, text: '<' + oTag + '>' };\n        }\n        return null;\n    }\n\n    private _cleanMXPExpired(blocks, args) {\n        if (!blocks || blocks.length === 0 || args === null)\n            return;\n        const bl = blocks.length;\n        for (let b = 0; b < bl; b++) {\n            let format = blocks[b];\n            //not a link move on\n            if (format.formatType !== FormatType.MXPSend && format.formatType !== FormatType.MXPLink)\n                continue;\n            //only clean if no argument or matching expire\n            if (args.length === 0 || format.expire === args) {\n                let eType, n = 0, f = 0;\n                //store current type for nest testing\n                let type = format.formatType;\n                //get end tag format type\n                if (format.formatType === FormatType.MXPLink)\n                    eType = FormatType.MXPLinkEnd;\n                else\n                    eType = FormatType.MXPSendEnd;\n                //set link to expired\n                format.formatType = FormatType.MXPExpired;\n                //loop remaining tags looking for send tag, ignoring any nested tags\n                for (; f < bl; f++) {\n                    if (blocks[f].formatType === eType) {\n                        //not nested so end tag, set to be skipped\n                        if (n === 0) {\n                            blocks[f].formatType = FormatType.MXPSkip;\n                            break;\n                        }\n                        else\n                            n--;\n                    }\n                    else if (blocks[f] === type)\n                        n++;\n                }\n                //if did not find end tag, malformed MXP continue on\n            }\n        }\n    }\n\n    private _GetCloseTags(tag) {\n        if (typeof tag === 'undefined' || tag.length === 0)\n            return '';\n        let idx = 0;\n        const tl = tag.length;\n        const ts = [];\n        let str = [];\n        let c;\n        let state = 0;\n        for (; idx < tl; idx++) {\n            c = tag.charAt(idx);\n            switch (state) {\n                case 1:\n                    if (c === ' ') {\n                        ts.push(str.join(''));\n                        str = [];\n                        state = 2;\n                    }\n                    else if (c === '>') {\n                        ts.push(str.join(''));\n                        str = [];\n                        state = 0;\n                    }\n                    else\n                        str.push(c);\n                    break;\n                case 2:\n                    //ignore every thing til a >\n                    if (c === '>')\n                        state = 0;\n                    break;\n                default:\n                    //only care about tags\n                    if (c === '<')\n                        state = 1;\n                    break;\n            }\n        }\n        if (state === 1)\n            ts.push(str.join(''));\n        if (ts.length === 0)\n            return '';\n        return '</' + ts.reverse().join('></') + '>';\n    }\n\n    private _CloneCurrentStyle() {\n        let tmp: MXPStyle;\n        if (this._mxpStyles.length === 0)\n            this._mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n        tmp = this._mxpStyles[this._mxpStyles.length - 1];\n        if (this._mxpLines[this._mxpState.lineType] && this._mxpLines[this._mxpState.lineType].enabled)\n            tmp.gagged = this._mxpLines[this._mxpState.lineType].gag;\n        return <MXPStyle>Object.assign({}, tmp);\n    }\n\n    private _GetCurrentStyle() {\n        let tmp: MXPStyle;\n        if (this._mxpStyles.length === 0)\n            this._mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n        tmp = this._mxpStyles[this._mxpStyles.length - 1];\n        if (this._mxpLines[this._mxpState.lineType] && this._mxpLines[this._mxpState.lineType].enabled)\n            tmp.gagged = this._mxpLines[this._mxpState.lineType].gag;\n        return tmp;\n    }\n\n    public DecreaseColor(clr, p) {\n        const color = new RGBColor(clr);\n        if (!color.ok) return clr;\n        color.b -= Math.ceil(color.b * p);\n        if (color.b < 0)\n            color.b = 0;\n        color.g -= Math.ceil(color.g * p);\n        if (color.g < 0)\n            color.g = 0;\n        color.r -= Math.ceil(color.r * p);\n        if (color.r < 0)\n            color.r = 0;\n        return color.toRGB();\n    }\n\n    public IncreaseColor(clr, p) {\n        const color = new RGBColor(clr);\n        if (!color.ok) return clr;\n        color.b += Math.ceil(color.b * p);\n        if (color.b > 255)\n            color.b = 255;\n        color.g += Math.ceil(color.g * p);\n        if (color.g > 255)\n            color.g = 255;\n        color.r += Math.ceil(color.r * p);\n        if (color.r > 255)\n            color.r = 255;\n        return color.toRGB();\n    }\n\n    private _MXPCapture(str) {\n        if (this._mxpState.capture < 1) return;\n        const il = this._mxpState.captured.length;\n        for (let i = 0; i < il; i++)\n            this._mxpState.captured[i].push(str);\n    }\n\n    private _MXPDeCapture(cnt) {\n        if (this._mxpState.capture < 1) return;\n        const il = this._mxpState.captured.length;\n        for (let i = 0; i < il; i++) {\n            for (let p = 0; p < cnt; p++)\n                this._mxpState.captured[i].pop();\n        }\n    }\n\n    private _isNumber(str) {\n        return (/^\\d+$/).test(str);\n    }\n\n    /**\n     * CurrentAnsiCode - return an ansi formatted code based on current ansi state\n     *\n     * @returns {String}\n     */\n    public CurrentAnsiCode() {\n        let ansi = '\\x1b[';\n        if (typeof this._CurrentForeColor === 'string')\n            ansi += '38;2;' + this._CurrentForeColor;\n        else if (this._CurrentForeColor <= -16)\n            ansi += '38;5;' + (this._CurrentForeColor * -1 - 16) + ';';\n        else\n            ansi += this._CurrentForeColor + ';';\n        if (typeof this._CurrentBackColor === 'string')\n            ansi += '48;2;' + this._CurrentBackColor;\n        else if (this._CurrentBackColor <= -16)\n            ansi += '38;5;' + (this._CurrentBackColor * -1 - 16) + ';';\n        else\n            ansi += this._CurrentBackColor + ';';\n        if (this._CurrentAttributes > 0) {\n            if ((this._CurrentAttributes & FontStyle.Inverse) === FontStyle.Inverse)\n                ansi += '7;';\n            if ((this._CurrentAttributes & FontStyle.Bold) === FontStyle.Bold)\n                ansi += '1;';\n            if ((this._CurrentAttributes & FontStyle.Italic) === FontStyle.Italic)\n                ansi += '3;';\n            if ((this._CurrentAttributes & FontStyle.Underline) === FontStyle.Underline)\n                ansi += '4;';\n            if ((this._CurrentAttributes & FontStyle.Slow) === FontStyle.Slow)\n                ansi += '5;';\n            if ((this._CurrentAttributes & FontStyle.Rapid) === FontStyle.Rapid)\n                ansi += '6;';\n            if ((this._CurrentAttributes & FontStyle.Strikeout) === FontStyle.Strikeout)\n                ansi += '9;';\n            if ((this._CurrentAttributes & FontStyle.Faint) === FontStyle.Faint)\n                ansi += '2;';\n            if ((this._CurrentAttributes & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline)\n                ansi += '21;';\n            if ((this._CurrentAttributes & FontStyle.Overline) === FontStyle.Overline)\n                ansi += '53;';\n        }\n        return ansi + 'm';\n    }\n\n    public get parseQueueLength() {\n        return this._parsing.length;\n    }\n\n    public get parseQueueEndOfLine() {\n        if (this._parsing.length)\n            return this._parsing[this._parsing.length - 1][0].endsWith('\\n');\n        return false;\n    }\n\n    public parse(text: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\n        if (text == null || text.length === 0)\n            return text;\n        if (remote == null) remote = false;\n        //query data in case already parsing\n        if (this._parsing.length > 0 && !force) {\n            this._parsing.push([text, remote, prependSplit]);\n            return;\n        }\n        let _TermTitle = '';\n        let _TermTitleType = null;\n        let _AnsiParams = null;\n        let stringBuilder = [];\n        let formatBuilder = [];\n        let rawBuilder = [];\n        let state: ParserState = ParserState.None;\n        let pState: ParserState = ParserState.None;\n        let lineLength = 0;\n        let iTmp;\n        let mOffset = 0;\n        let _MXPTag;\n        let _MXPOTag;\n        let _MXPEntity;\n        let _MXPComment;\n        let _MXPArgs;\n        let skip = false;\n        this.busy = true;\n        this._parsing.unshift([text, remote, prependSplit]);\n        let format;\n        if (this._SplitBuffer.length > 0) {\n            if (prependSplit)\n                text = text + this._SplitBuffer;\n            else\n                text = this._SplitBuffer + text;\n            this._SplitBuffer = '';\n        }\n        //not end of line but text, so fragment, re-get and re-parse to ensure proper triggering\n        if (!this.EndOfLine && (this.textLength > 0 || this.rawLength > 0)) {\n            let lines = this.display.lines;\n            if (lines.length > 0) {\n                iTmp = this.display.lines[lines.length - 1].text;\n                _MXPComment = this.display.lines[lines.length - 1].raw;\n                formatBuilder.push.apply(formatBuilder, this.display.lines[lines.length - 1].formats);\n                //remove line but do not change selection as line will be re-added back at the end\n                this.display.removeLine(lines.length - 1, true);\n                format = formatBuilder[formatBuilder.length - 1];\n                if (format.formatType === FormatType.Link) {\n                    formatBuilder.pop();\n                    format = formatBuilder[formatBuilder.length - 1];\n                }\n                format.width = 0;\n                format.height = 0;\n                format.marginWidth = 0;\n                format.marginHeight = 0;\n                lineLength = format.offset;\n                if (format.offset !== 0) {\n                    stringBuilder.push(iTmp.substring(0, format.offset));\n                    iTmp = iTmp.substring(format.offset);\n                    if (this._mxpState.locked || this._mxpState.on)\n                        mOffset = iTmp.length;\n                    text = iTmp + text;\n                }\n                else {\n                    if (this._mxpState.locked || this._mxpState.on)\n                        mOffset = iTmp.length;\n                    text = iTmp + text;\n                }\n                if (_MXPComment.endsWith(iTmp))\n                    rawBuilder.push(_MXPComment.substr(0, _MXPComment.length - iTmp.length));\n                else\n                    rawBuilder.push(_MXPComment);\n            }\n            else\n                formatBuilder.push(format = this._getFormatBlock(lineLength));\n            lines = null;\n        }\n        else\n            formatBuilder.push(format = this._getFormatBlock(lineLength));\n        let idx = 0;\n        let tl = text.length;\n        let c: string;\n        let i: number;\n        const e: boolean = this.emulateControlCodes;\n        const d: boolean = this.displayControlCodes;\n        const f: boolean = this.emulateTerminal;\n        const u: boolean = this.enableURLDetection;\n        const s: boolean = this.enableMSP;\n        const tabWidth: number = this.tabWidth;\n        let lnk = 0;\n        let fLnk = 0;\n        let lnkOffset = 0;\n        let lLnk = 0;\n        let lNest = null;\n        let p;\n        const pl = this._protocols.length;\n        try {\n            for (idx = 0; idx < tl; idx++) {\n                c = text.charAt(idx);\n                i = text.charCodeAt(idx);\n                if (idx >= mOffset)\n                    rawBuilder.push(c);\n                this.rawLength++;\n                switch (state) {\n                    case ParserState.AnsiParams:\n                        if (\n                            c === 'C' ||  //Move cursor # spaces\n                            c === 'K' || //Clear screen Left/Right\n                            c === 's' || //save cursor position: non-standard\n                            c === 'u' ||  //save cursor position: non-standard\n                            c === 'l' ||  //XTerm ?#l Private Mode Reset/Reset Mode #l\n                            c === 'h' ||  //XTerm ?#h Private Mode/Set Mode #h\n                            c === 'A' ||  //Move cursor up N lines\n                            c === 'B' ||  //Move cursor down N lines\n                            c === 'D' ||  //Move cursor left N spaces\n                            c === 'E' ||  //Moves cursor to beginning of the line n (default 1) lines down (next line).\n                            c === 'F' ||  //Moves cursor to beginning of the line n (default 1) lines up (previous line).\n                            c === 'f' ||  //Moves the cursor to row n, column m. Both default to 1 if omitted. Same as CUP\n                            c === 'G' ||  //Moves the cursor to column n.\n                            c === 'H' ||  //Moves the cursor to row n, column m. The values are 1-based, and default to 1 (top left corner) if omitted. A sequence such as CSI ;5H is a synonym for CSI 1;5H as well as CSI 17;H is the same as CSI 17H and CSI 17;1H\n                            c === 'n' ||  //Reports the cursor position to the application as (as though typed at the keyboard) ESC[n;mR, where n is the row and m is the column. (May not work on MS-DOS.)\n                            c === 'S' ||  //Scroll whole page up by n (default 1) lines. New lines are added at the bottom. (not ANSI.SYS)\n                            c === 'T' ||  //Scroll whole page down by n (default 1) lines. New lines are added at the top. (not ANSI.SYS)\n                            c === 'r'//SET SCROLLING REGION\n                        ) {\n                            this._ClearMXPOpen();\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'z') //mxp\n                        {\n                            //incase they put in a ; like e[1;z, e[1;7z or even e[;1z\n                            _MXPTag = _AnsiParams.split(';');\n                            //we only want the last valid #\n                            //start as 0 in cause invalid # or code\n                            _AnsiParams = 0;\n                            for (let mt = _MXPTag.length - 1; mt >= 0; mt--) {\n                                if (_MXPTag[mt].length > 0) {\n                                    _AnsiParams = _MXPTag[0];\n                                    break;\n                                }\n                            }\n                            iTmp = +_AnsiParams;\n                            if (isNaN(iTmp)) iTmp = 0;\n                            this._mxpState.on = true;\n                            this._mxpState.noBreak = false;\n                            this._mxpState.paragraph = false;\n                            if (this._mxpState.lineType === lineType.Open)\n                                this._ClearMXPOpen();\n                            switch (iTmp) {\n                                case 2:\n                                    this._mxpState.on = false;\n                                    this._mxpState.locked = false;\n                                    this._mxpState.lineType = lineType.Locked;\n                                    this._ClearMXPOpen();\n                                    break;\n                                case 3:\n                                    this.ResetMXP();\n                                    break;\n                                case 4:\n                                    this._mxpState.lineType = lineType.TempSecure;\n                                    if (idx + 1 >= tl) {\n                                        this._SplitBuffer += c;\n                                        break;\n                                    }\n                                    const ct = text.charAt(idx + 1);\n                                    if (ct !== '<') {\n                                        this._mxpState.lineType = lineType.Open;\n                                        this._mxpState.on = false;\n                                    }\n                                    this._mxpState.locked = false;\n                                    this._ClearMXPOpen();\n                                    break;\n                                case 5:\n                                    this._iMXPDefaultMode = lineType.Open;\n                                    this._mxpState.locked = true;\n                                    this._mxpState.lineType = lineType.LockOpen;\n                                    this._ClearMXPOpen();\n                                    break;\n                                case 6:\n                                    this._iMXPDefaultMode = lineType.Secure;\n                                    this._mxpState.lineType = lineType.LockSecure;\n                                    this._mxpState.locked = true;\n                                    this._ClearMXPOpen();\n                                    break;\n                                case 7:\n                                    this._iMXPDefaultMode = lineType.Locked;\n                                    this._mxpState.lineType = lineType.LockLocked;\n                                    this._mxpState.locked = true;\n                                    this._ClearMXPOpen();\n                                    break;\n                                default:\n                                    //invalid line so reset\n                                    if (iTmp < 0 || iTmp > 99)\n                                        this._ClearMXPOpen();\n                                    else {\n                                        this._mxpState.lineType = iTmp;\n                                        this._mxpState.locked = false;\n                                        //custom element linked to tag so expanded it into the line\n                                        if (this._mxpLines[this._mxpState.lineType] && this._mxpLines[this._mxpState.lineType].enabled) {\n                                            //strBuilder.push(EndDisplayBlock());\n                                            //strBuilder.push(StartDisplayBlock(lineLength));\n                                            iTmp = '';\n                                            if (this._mxpLines[this._mxpState.lineType].element.length > 0)\n                                                iTmp += '<' + this._mxpLines[this._mxpState.lineType].element + '>';\n                                            if (this._mxpLines[this._mxpState.lineType].definition.length > 0)\n                                                iTmp += this._mxpLines[this._mxpState.lineType].definition;\n                                            if (iTmp.length > 0) {\n                                                text = text.splice(idx + 1, iTmp);\n                                                tl = text.length;\n                                            }\n                                        }\n                                    }\n                                    break;\n                            }\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'J')  //Clear screen Up/Down\n                        {\n                            this._ClearMXPOpen();\n                            if (_AnsiParams.length > 0) {\n                                if (+_AnsiParams === 2) {\n                                    lineLength = 0;\n                                    iTmp = this.window.height;\n                                    formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                    this._AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                    stringBuilder = [];\n                                    rawBuilder = [];\n                                    formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength), ...this._getMXPCloseFormatBlocks()];\n                                    for (let j = 0; j < iTmp; j++) {\n                                        this._AddLine('', '\\n', false, false, formatBuilder, remote);\n                                        this._MXPCapture('\\n');\n                                    }\n                                    this.textLength += iTmp;\n                                    this._mxpState.noBreak = false;\n                                }\n                            }\n                            formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === 'm') {\n                            this._ProcessAnsiColorParams(_AnsiParams.split(';'));\n                            formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            this._SplitBuffer = '';\n                            _AnsiParams = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            //malformed code\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this._mxpState.on && c === '\\n')\n                                this._ClearMXPOpen();\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _AnsiParams += c;\n                        }\n                        break;\n                    case ParserState.XTermTitle:\n                        if (i === 7) {\n                            this._SplitBuffer = '';\n                            this.emit('set-title', _TermTitle, _TermTitleType == null ? 0 : _TermTitleType);\n                            _TermTitle = '';\n                            _TermTitleType = null;\n                            state = ParserState.None;\n                        }\n                        else if (c === ';' && _TermTitleType == null) {\n                            _TermTitleType = +_TermTitle;\n                            if (isNaN(_TermTitleType))\n                                _TermTitleType = 0;\n                            _TermTitle = '';\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\x1b') {\n                            if (this._SplitBuffer.charAt(this._SplitBuffer.length - 1) === '\\n')\n                                this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _TermTitle += c;\n                        }\n                        break;\n                    case ParserState.Ansi:\n                        if (c === '[') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            _AnsiParams = '';\n                            state = ParserState.AnsiParams;\n                        }\n                        /*\n                        else if(c === ']')\n                        {\n                          _SplitBuffer = '';\n                          state = ParserState.None;\n                        }\n                        */\n                        else if (c === ']') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            _TermTitle = '';\n                            state = ParserState.XTermTitle;\n                        }\n                        //Unsupported VT100 so skip them\n                        else if (\n                            c === 'D' || //Index ( down one line, scroll if at bottom )\n                            c === 'E' || //Next line ( move to column 1 of next line, scroll up if at bottom )\n                            c === 'M' || //Reverse index\t( up one line, scroll down if at top )\n                            c === '1' || //Graphic proc. option ON\n                            c === '2' || //Graphic proc. option OFF\n                            c === '7' || //Save cursor & attributes\n                            c === '8' || //Restore cursor & attributes\n                            c === '>' || //Keypad mode\t\tNumeric\n                            c === '=' || //Keypad mode\t\tApplication\n                            /*\n                            *LINE SIZE COMMANDS\n                            *<ESC>#3 Change current line to double-height top half\n                            *<ESC>#4 Change current line to double-height bottom half\n                            *<ESC>#5 Change current line to single-width single-height (normal)\n                            *<ESC>#6 Change current line to double-width single-height\n                            */\n                            c === '#'\n                        ) {\n                            if (d) {\n                                stringBuilder.push('\\u241B');\n                                if (i < 16) {\n                                    stringBuilder.push(String.fromCharCode(parseInt('240' + i.toString(16), 16)));\n                                    this._MXPCapture('&#x241B&#x240' + i.toString(16) + ';');\n                                }\n                                else {\n                                    stringBuilder.push(String.fromCharCode(parseInt('24' + i.toString(16), 16)));\n                                    this._MXPCapture('&#x241B&#x24' + i.toString(16) + ';');\n                                }\n                                lineLength += 2;\n                                this.textLength += 2;\n                                this._mxpState.noBreak = false;\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        break;\n                    case ParserState.MXPTag:\n                        if (_MXPTag === '!--') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            pState = ParserState.None;\n                            state = ParserState.MXPComment;\n                            _MXPComment = '<!--';\n                            _MXPTag = '';\n                            _MXPArgs = [];\n                        }\n                        else if (_MXPTag.endsWith('<!--')) {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            pState = state;\n                            state = ParserState.MXPComment;\n                            _MXPComment = '<!--';\n                            _MXPTag = _MXPTag.substring(0, _MXPTag.length - 4);\n                            _MXPArgs = [];\n                        }\n                        else if (c === '\"') {\n                            state = ParserState.MXPTagDblQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\'') {\n                            state = ParserState.MXPTagQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '&') {\n                            _MXPEntity = '';\n                            pState = state;\n                            state = ParserState.MXPEntity;\n                            this._SplitBuffer = '';\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this._mxpState.on && c === '\\n')\n                                this._ClearMXPOpen();\n                        }\n                        else if (c === ' ') {\n                            state = ParserState.MXPTagArg;\n                            _MXPArgs.push('');\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '>') {\n                            _MXPOTag = _MXPTag;\n                            _MXPTag = _MXPTag.toUpperCase();\n                            if (_MXPTag === 'HR' && (this._mxpState.lineType === lineType.Secure || this._mxpState.lineType === lineType.LockSecure || this._mxpState.lineType === lineType.TempSecure)) {\n                                if (lineLength > 0) {\n                                    lineLength = 0;\n                                    this._MXPCapture('\\n');\n                                    formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                    this._AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                    stringBuilder = [];\n                                    rawBuilder = [];\n                                    formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                }\n                                //skip = text.charAt(idx + 1) === '\\n';\n                                _MXPTag = this._getMXPBlock(_MXPTag, [], remote);\n                                if (_MXPTag && _MXPTag.format) {\n                                    _MXPTag.format.offset = lineLength;\n                                    formatBuilder.push(_MXPTag.format);\n                                    formatBuilder[0].hr = _MXPTag.format.hr;\n                                }\n                                formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                this._AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                this.textLength++;\n                                stringBuilder = [];\n                                rawBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                            }\n                            else if (_MXPTag === 'BR' && (this._mxpState.lineType === lineType.Secure || this._mxpState.lineType === lineType.LockSecure || this._mxpState.lineType === lineType.TempSecure)) {\n                                this._MXPCapture('\\n');\n                                formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                this._AddLine(stringBuilder.join(''), rawBuilder.join(''), false, false, formatBuilder, remote);\n                                skip = false;\n                                lineLength = 0;\n                                stringBuilder = [];\n                                rawBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                this.textLength++;\n                            }\n                            else if (_MXPTag === 'IMAGE' && (this._mxpState.lineType === lineType.Secure || this._mxpState.lineType === lineType.LockSecure || this._mxpState.lineType === lineType.TempSecure)) {\n                                _MXPTag = this._getMXPBlock(_MXPTag, _MXPArgs, remote);\n                                if (_MXPTag && _MXPTag.format !== null) {\n                                    formatBuilder.push(_MXPTag.format);\n                                    lineLength += _MXPTag.length;\n                                    this.textLength += _MXPTag.length;\n                                }\n                                formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            }\n                            else {\n                                _MXPTag = this._getMXPBlock(_MXPTag, [], remote, _MXPOTag, formatBuilder);\n                                if (this._mxpState.expanded) {\n                                    if (_MXPTag && _MXPTag.text !== null) text = text.splice(idx + 1, _MXPTag.text);\n                                    tl = text.length;\n                                    this._mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    _MXPTag = '';\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                if (_MXPTag) {\n                                    if (_MXPTag.format) {\n                                        _MXPTag.format.offset = lineLength;\n                                        formatBuilder.push(_MXPTag.format);\n                                    }\n                                    formatBuilder.push(format = this._getFormatBlock(lineLength));\n                                    if (_MXPTag.text !== null && _MXPTag.text.length > 0) {\n                                        stringBuilder.push(_MXPTag.text);\n                                        lineLength += _MXPTag.text.length;\n                                        this.textLength += _MXPTag.text.length;\n                                    }\n                                }\n                                else\n                                    formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        //Malformed broken so just display it\n                        else if (c === '<') {\n                            if (this.enableDebug)\n                                this.emit('debug', 'Malformed MXP Tag: ' + _MXPTag);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            stringBuilder.push('<' + _MXPTag);\n                            lineLength += _MXPTag.length + 1;\n                            this.textLength += _MXPTag.length + 1;\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPTag += c;\n                        }\n                        break;\n                    case ParserState.MXPTagQuoted:\n                        if (c === '\\'') {\n                            state = ParserState.MXPTagArg;\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPTagDblQuoted:\n                        if (c === '\"') {\n                            state = ParserState.MXPTagArg;\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPTagArg:\n                        if (c === '\\'') {\n                            state = ParserState.MXPTagQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\"') {\n                            state = ParserState.MXPTagDblQuoted;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            //Abnormal end, discard\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                            if (this._mxpState.on && c === '\\n')\n                                this._ClearMXPOpen();\n                        }\n                        else if (c === ' ') {\n                            state = ParserState.MXPTagArg;\n                            _MXPArgs.push('');\n                            this._SplitBuffer += c;\n                        }\n                        else if (c === '>') {\n                            if (_MXPTag.toUpperCase() === 'IMAGE' && (this._mxpState.lineType === lineType.Secure || this._mxpState.lineType === lineType.LockSecure || this._mxpState.lineType === lineType.TempSecure)) {\n                                _MXPTag = this._getMXPBlock(_MXPTag, _MXPArgs, remote, _MXPTag);\n                                if (_MXPTag !== null && _MXPTag.format !== null) {\n                                    _MXPTag.format.offset = lineLength;\n                                    formatBuilder.push(_MXPTag.format);\n                                }\n                                formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            }\n                            else {\n                                _MXPTag = this._getMXPBlock(_MXPTag, _MXPArgs, remote, _MXPTag, formatBuilder);\n                                if (this._mxpState.expanded) {\n                                    if (_MXPTag !== null) text = text.splice(idx + 1, _MXPTag.text);\n                                    tl = text.length;\n                                    this._mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                if (_MXPTag !== null) {\n                                    if (_MXPTag !== null && _MXPTag.format) {\n                                        _MXPTag.format.offset = lineLength;\n                                        formatBuilder.push(_MXPTag.format);\n                                    }\n                                    formatBuilder.push(format = this._getFormatBlock(lineLength));\n                                    if (_MXPTag.text !== null) {\n                                        stringBuilder.push(_MXPTag.text);\n                                        lineLength += _MXPTag.text.length;\n                                        this.textLength += _MXPTag.text.length;\n                                    }\n                                }\n                                else\n                                    formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            this._SplitBuffer = '';\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        }\n                        break;\n                    case ParserState.MXPEntity:\n                        if (c === '\\n' || c === '\\x1b') {\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            if (this.enableDebug) this.emit('debug', 'MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState === ParserState.MXPTag) {\n                                _MXPTag += '&' + _MXPEntity;\n                                state = pState;\n                            }\n                            else {\n                                _MXPEntity = this._GetEntity(_MXPEntity);\n                                if (this._mxpState.expanded) {\n                                    if (_MXPTag !== null)\n                                        text = text.splice(idx + 1, _MXPEntity);\n                                    tl = text.length;\n                                    this._mxpState.expanded = false;\n                                    state = ParserState.None;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                _MXPOTag = htmlDecode('&' + _MXPEntity);\n                                stringBuilder.push(_MXPOTag);\n                                this._MXPCapture('&' + _MXPEntity);\n                                lineLength += _MXPOTag.length;\n                                this.textLength += _MXPOTag.length;\n                                this._mxpState.noBreak = false;\n                                //Abnormal end, send as is\n                                state = ParserState.None;\n                                this._SplitBuffer = '';\n                                format.unicode = true;\n                            }\n                            if (this._mxpState.on && c === '\\n')\n                                this._ClearMXPOpen();\n                        }\n                        else if (c === ';') {\n                            if (this.enableDebug) this.emit('debug', 'MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState !== ParserState.MXPTag) {\n                                _MXPEntity = this._GetEntity(_MXPEntity);\n                                if (this._mxpState.expanded) {\n                                    text = text.splice(idx + 1, _MXPEntity);\n                                    tl = text.length;\n                                    this._mxpState.expanded = false;\n                                    state = pState;\n                                    this._SplitBuffer = '';\n                                    continue;\n                                }\n                                _MXPOTag = htmlDecode('&' + _MXPEntity + ';');\n                                stringBuilder.push(_MXPOTag);\n                                this._MXPCapture('&');\n                                this._MXPCapture(_MXPEntity);\n                                this._MXPCapture(';');\n                                lineLength += _MXPOTag.length;\n                                this.textLength += _MXPOTag.length;\n                                this._mxpState.noBreak = false;\n                                this._SplitBuffer = '';\n                            }\n                            else\n                                _MXPTag += '&' + _MXPEntity + ';';\n                            format.unicode = true;\n                            state = pState;\n                        }\n                        //malformed entity\n                        else if (c === '&') {\n                            if (this.enableDebug) this.emit('debug', 'Malformed MXP Entity: ' + _MXPEntity);\n                            if (<ParserState>pState !== ParserState.MXPTag) {\n                                stringBuilder.push('&' + _MXPEntity);\n                                this._MXPCapture('&');\n                                this._MXPCapture(_MXPEntity);\n                                lineLength += _MXPEntity.length + 1;\n                                this.textLength += _MXPEntity.length + 1;\n                                this._mxpState.noBreak = false;\n                                this._SplitBuffer = '';\n                                idx--;\n                                rawBuilder.pop();\n                                this.rawLength--;\n                            }\n                            else\n                                _MXPTag += '&' + _MXPEntity;\n                            format.unicode = true;\n                            state = pState;\n                        }\n                        else {\n                            this._SplitBuffer += c;\n                            _MXPEntity += c;\n                        }\n                        break;\n                    case ParserState.MXPComment:\n                        if (_MXPComment.endsWith('-->')) {\n                            if (this.enableDebug) this.emit('debug', 'MXP Comment: ' + _MXPComment);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            state = pState;\n                            if (state === ParserState.None)\n                                this._SplitBuffer = '';\n                            _MXPComment = '';\n                        }\n                        else if (c === '\\n' || c === '\\x1b') {\n                            if (this.enableDebug) this.emit('debug', 'MXP Comment: ' + _MXPComment);\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            state = pState;\n                            _MXPComment = '';\n                            if (this._mxpState.on && c === '\\n')\n                                this._ClearMXPOpen();\n                        }\n                        else\n                            _MXPComment += c;\n                        break;\n                    case ParserState.URL:\n                        if (idx > lnk + 2) {\n                            stringBuilder.pop();\n                            stringBuilder.pop();\n                            rawBuilder.pop();\n                            rawBuilder.pop();\n                            this.rawLength -= 2;\n                            lineLength -= 2;\n                            this.textLength -= 2;\n                            this._MXPDeCapture(2);\n                            idx = lnk;\n                            state = ParserState.None;\n                        }\n                        else if (c === '/') {\n                            stringBuilder.push(c);\n                            this._MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            if (idx === lnk + 2) {\n                                state = ParserState.URLFound;\n                                //Found :// so valid url\n                                lnk = stringBuilder.length - 4;\n                                lLnk = stringBuilder.length - 1;\n                                fLnk = formatBuilder.length;\n                                lnkOffset -= 2;\n                                while (lnk > 0 && CharAllowedInURL(stringBuilder[lnk], true)) {\n                                    lnk--;\n                                    lnkOffset--;\n                                }\n                                if (!CharAllowedInURL(stringBuilder[lnk], true)) {\n                                    lnk++;\n                                    lnkOffset++;\n                                }\n                                lNest = [];\n                                if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                    lNest.push(')');\n                                if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                    lNest.push(']');\n                            }\n                        }\n                        else if (idx > lnk + 1) {\n                            stringBuilder.pop();\n                            rawBuilder.pop();\n                            this.rawLength--;\n                            lineLength--;\n                            this.textLength--;\n                            this._MXPDeCapture(1);\n                            idx = lnk;\n                            state = ParserState.None;\n                        }\n                        else {\n                            idx = lnk;\n                            state = ParserState.None;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                        }\n                        break;\n                    case ParserState.URLFound:\n                        if (!CharAllowedInURL(c, false)) {\n                            if (lLnk !== stringBuilder.length - 1) {\n                                _MXPComment += stringBuilder.slice(lnk).join('');\n                                if (this.enableDebug) this.emit('debug', 'URL Found: ' + _MXPComment);\n                                formatBuilder.splice(fLnk, 0,\n                                    {\n                                        formatType: FormatType.Link,\n                                        offset: lnkOffset,\n                                        href: _MXPComment\n                                    });\n                                formatBuilder.push({\n                                    formatType: FormatType.LinkEnd,\n                                    offset: lineLength,\n                                    href: _MXPComment\n                                });\n                                formatBuilder.push(format = this._getFormatBlock(lineLength));\n                            }\n                            state = ParserState.None;\n                            idx--;\n                            rawBuilder.pop();\n                            this.rawLength--;\n                        }\n                        else {\n                            if (lNest.length > 1 && lNest[lNest.length - 1] === c) {\n                                lNest.pop();\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length > 0 && c === '(') {\n                                lNest.push(')');\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length > 0 && c === '[') {\n                                lNest.push(']');\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                if (i > 255)\n                                    format.unicode = true;\n                            }\n                            else if (lNest.length === 1 && lNest[lNest.length - 1] === c) {\n                                if (lLnk !== stringBuilder.length - 1) {\n                                    _MXPComment += stringBuilder.slice(lnk).join('');\n                                    if (this.enableDebug) this.emit('debug', 'URL Found: ' + _MXPComment);\n                                    formatBuilder.splice(fLnk, 0,\n                                        {\n                                            formatType: FormatType.Link,\n                                            href: _MXPComment,\n                                            offset: lnkOffset\n                                        });\n                                    formatBuilder.push({\n                                        formatType: FormatType.LinkEnd,\n                                        href: _MXPComment,\n                                        offset: lineLength\n                                    });\n                                    formatBuilder.push(format = this._getFormatBlock(lineLength));\n                                }\n                                state = ParserState.None;\n                                idx--;\n                                rawBuilder.pop();\n                                this.rawLength--;\n                            }\n                            else {\n                                if (i > 255)\n                                    format.unicode = true;\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                            }\n                        }\n                        break;\n                    case ParserState.MSPSound:\n                        if (c === ')') {\n                            lnk = this._mxpState.lineType;\n                            this._mxpState.lineType = lineType.TempSecure;\n                            this._getMXPBlock('SOUND', _MXPArgs, remote);\n                            this._mxpState.lineType = lnk;\n                            state = ParserState.None;\n                            if (idx + 1 < tl && text.charAt(idx + 1) === '\\n') {\n                                idx++;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                this._mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                            else if (idx + 2 < tl && text[idx + 1] === '\\r' && text[idx + 2] === '\\n') {\n                                idx += 2;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                this._mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                        }\n                        else if (c === ' ')\n                            _MXPArgs.push('');\n                        else\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        break;\n                    case ParserState.MSPMusic:\n                        if (c === ')') {\n                            lnk = this._mxpState.lineType;\n                            this._mxpState.lineType = lineType.TempSecure;\n                            this._getMXPBlock('MUSIC', _MXPArgs, remote);\n                            this._mxpState.lineType = lnk;\n                            state = ParserState.None;\n                            if (idx + 1 < tl && text.charAt(idx + 1) === '\\n') {\n                                idx++;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                this._mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                            else if (idx + 2 < tl && text[idx + 1] === '\\r' && text[idx + 2] === '\\n') {\n                                idx += 2;\n                                skip = false;\n                                stringBuilder = [];\n                                formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                                this._mxpState.noBreak = false;\n                                lineLength = 0;\n                            }\n                        }\n                        else if (c === ' ')\n                            _MXPArgs.push('');\n                        else\n                            _MXPArgs[_MXPArgs.length - 1] += c;\n                        break;\n                    default:\n                        if (e && i === 7) {\n                            if (f) {\n                                c = '\\u2407';\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                this._mxpState.noBreak = false;\n                            }\n                            else if (d) {\n                                stringBuilder.push(c);\n                                this._MXPCapture('&#x2407;');\n                                lineLength++;\n                                this.textLength++;\n                                this._mxpState.noBreak = false;\n                            }\n                            this.emit('bell');\n                        }\n                        else if (e && c === '\\b') {\n                            skip = false;\n                            //if there are characters on the line\n                            if (lineLength > 0) {\n                                if (stringBuilder.length) {\n                                    //clean up empty ones\n                                    while (stringBuilder[stringBuilder.length - 1].length === 0)\n                                        stringBuilder.pop();\n                                    if (stringBuilder[stringBuilder.length - 1].length === 1)\n                                        stringBuilder.pop();\n                                    else\n                                        stringBuilder[stringBuilder.length - 1] = stringBuilder[stringBuilder.length - 1].substring(0, stringBuilder[stringBuilder.length - 1].length - 1);\n                                }\n                                if (format.offset === lineLength)\n                                    format.offset--;\n                                lineLength--;\n                                this.textLength--;\n                            }\n                            if (d) {\n                                c = '\\u25D8';\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                            }\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (e && c === '\\t') {\n                            const _Tab = tabWidth - lineLength % tabWidth;\n                            if (_Tab > 0) {\n                                stringBuilder.push(Array(_Tab + 1).join(' '));\n                                this._MXPCapture(Array(_Tab + 1).join(' '));\n                                lineLength += _Tab;\n                                this.textLength += _Tab;\n                                this._mxpState.noBreak = false;\n                            }\n                        }\n                        else if (c === '\\n') {\n                            if (this._mxpState.noBreak || this._mxpState.paragraph) continue;\n                            if (!this._mxpState.locked) {\n                                //notify client that a tag is over, allow for tagging the 10,11,12,19 tag types for auto mapper tagging/welcome test/custom tags\n                                if (this._mxpState.lineType !== lineType.Open)\n                                    this.emit('MXP-tag-end', this._mxpState.lineType, stringBuilder.join(''), formatBuilder);\n                                //custom element linked to tag so expanded it into the line\n                                if (!this._mxpState.lineExpanded && this._mxpLines[this._mxpState.lineType] && this._mxpLines[this._mxpState.lineType].enabled) {\n                                    iTmp = '';\n                                    if (this._mxpLines[this._mxpState.lineType].element.length > 0)\n                                        iTmp += '</' + this._mxpLines[this._mxpState.lineType].element + '>';\n                                    if (this._mxpLines[this._mxpState.lineType].closeDefinition.length > 0)\n                                        iTmp += this._mxpLines[this._mxpState.lineType].closeDefinition;\n                                    if (iTmp.length > 0) {\n                                        text = text.splice(idx, iTmp);\n                                        tl = text.length;\n                                        idx--;\n                                        rawBuilder.pop();\n                                        this.rawLength--;\n                                        this._mxpState.lineExpanded = true;\n                                        continue;\n                                    }\n                                }\n                                this._mxpState.lineExpanded = false;\n                                formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                if (this._mxpState.on)\n                                    this._ClearMXPOpen();\n                                this._mxpState.on = false;\n                                if (this._mxpLines[this._mxpState.lineType] && this._mxpLines[this._mxpState.lineType].enabled && this._mxpLines[this._mxpState.lineType].gag)\n                                    skip = true;\n                                this._mxpState.lineType = this._iMXPDefaultMode;\n                                if (this._mxpState.lineType !== 2 && !this.enableMXP)\n                                    this.ResetMXP();\n                            }\n                            else {\n                                formatBuilder.push(...this._getMXPCloseFormatBlocks());\n                                if (this._mxpState.on)\n                                    this._ClearMXPOpen();\n                            }\n                            lineLength = 0;\n                            if (!skip)\n                                this._MXPCapture('\\n');\n                            this._AddLine(stringBuilder.join(''), rawBuilder.join(''), false, skip, formatBuilder, remote);\n                            skip = false;\n                            stringBuilder = [];\n                            rawBuilder = [];\n                            formatBuilder = [...this._getMXPOpenFormatBlocks(), format = this._getFormatBlock(lineLength)];\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (e && c === '\\r') {\n                            continue;\n                            /*\n                            if (this.mxpState.noBreak || this.mxpState.paragraph) continue;\n                            if (!this.mxpState.locked) {\n                                if (this.mxpState.on)\n                                    this.ClearMXPOpen();\n                                this.mxpState.on = false;\n                                this.mxpState.lineType = lineType.Open;\n                            }\n                            continue;\n                            */\n                        }\n                        else if (e && c === '\\x1b') {\n                            this._SplitBuffer += c;  //store in split buffer incase split command\n                            state = ParserState.Ansi;\n                        }\n                        else if (i < 32 || i === 127) {\n                            if (f) {\n                                if (i === 1)\n                                    c = '\\u263A';\n                                else if (i === 2)\n                                    c = '\\u263B';\n                                else if (i === 3)\n                                    c = '\\u2665';\n                                else if (i === 4)\n                                    c = '\\u2666';\n                                else if (i === 5)\n                                    c = '\\u2663';\n                                else if (i === 6)\n                                    c = '\\u2660';\n                                else if (i === 7)\n                                    c = '\\u2407';\n                                else if (i === 8)\n                                    c = '\\u25D8';\n                                else if (i === 9)\n                                    c = '\\u25CB';\n                                else if (i === 10)\n                                    c = '\\u25D9';\n                                else if (i === 11)\n                                    c = '\\u2642';\n                                else if (i === 12)\n                                    c = '\\u2640';\n                                else if (i === 13)\n                                    c = '\\u266A';\n                                else if (i === 14)\n                                    c = '\\u266B';\n                                else if (i === 15)\n                                    c = '\\u263C';\n                                else if (i === 16)\n                                    c = '\\u25BA';\n                                else if (i === 17)\n                                    c = '\\u25C4';\n                                else if (i === 18)\n                                    c = '\\u2195';\n                                else if (i === 19)\n                                    c = '\\u203C';\n                                else if (i === 20)\n                                    c = '\\u00B6';\n                                else if (i === 21)\n                                    c = '\\u00A7';\n                                else if (i === 22)\n                                    c = '\\u25AC';\n                                else if (i === 23)\n                                    c = '\\u21A8';\n                                else if (i === 24)\n                                    c = '\\u2191';\n                                else if (i === 25)\n                                    c = '\\u2193';\n                                else if (i === 26)\n                                    c = '\\u2192';\n                                else if (i === 27)\n                                    c = '\\u2190';\n                                else if (i === 28)\n                                    c = '\\u221F';\n                                else if (i === 29)\n                                    c = '\\u2194';\n                                else if (i === 30)\n                                    c = '\\u25B2';\n                                else if (i === 31)\n                                    c = '\\u25BC';\n                                else if (i === 127)\n                                    c = '\\u2302';\n                                stringBuilder.push(c);\n                                this._MXPCapture(c);\n                                lineLength++;\n                                this.textLength++;\n                                this._mxpState.noBreak = false;\n                            }\n                            else if (d) {\n                                i = 9216 + i;\n                                stringBuilder.push(String.fromCharCode(i));\n                                this._MXPCapture('&#');\n                                this._MXPCapture(i.toString());\n                                this._MXPCapture(';');\n                                lineLength++;\n                                this.textLength++;\n                                this._mxpState.noBreak = false;\n                            }\n                            else\n                                continue;\n                        }\n                        else if (c === ' ' || (this._CurrentAttributes > 0 && (this._CurrentAttributes & FontStyle.Hidden) === FontStyle.Hidden)) {\n                            stringBuilder.push(' ');\n                            this._MXPCapture(' ');\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (c === '<' && idx >= mOffset) {\n                            if (this.enableMXP && this._mxpState.on) {\n                                _MXPTag = '';\n                                _MXPArgs = [];\n                                this._SplitBuffer += c;  //store in split buffer incase split command\n                                state = ParserState.MXPTag;\n                            }\n                            else {\n                                stringBuilder.push('<');\n                                this._MXPCapture('&lt;');\n                                lineLength++;\n                                this.textLength++;\n                            }\n                        }\n                        else if (c === '>') {\n                            stringBuilder.push('>');\n                            this._MXPCapture('&gt;');\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (c === '&' && idx >= mOffset) {\n                            if (this.enableMXP && this._mxpState.on) {\n                                _MXPEntity = '';\n                                this._SplitBuffer += c;  //store in split buffer incase split command\n                                pState = state;\n                                state = ParserState.MXPEntity;\n                            }\n                            else {\n                                stringBuilder.push(c);\n                                lineLength++;\n                                this.textLength++;\n                                this._mxpState.noBreak = false;\n                            }\n                        }\n                        else if (c === '\"') {\n                            stringBuilder.push(c);\n                            this._MXPCapture('&quot;');\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (c === '\\'') {\n                            stringBuilder.push(c);\n                            this._MXPCapture('&apos;');\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (c === ':') {\n                            stringBuilder.push(c);\n                            this._MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                            if (u) {\n                                _MXPComment = '';\n                                let psk;\n                                let pFnd = false;\n                                for (p = 0; p < pl; p++) {\n                                    if (idx - this._protocols[p].length < 0)\n                                        continue;\n                                    psk = false;\n                                    const nl = this._protocols[p].length;\n                                    for (let n = 0; n < nl; n++) {\n                                        if (text[idx - (nl - n)] !== this._protocols[p][n]) {\n                                            psk = true;\n                                            break;\n                                        }\n                                    }\n                                    if (psk)\n                                        continue;\n                                    lnk = stringBuilder.length;\n                                    lnkOffset = lineLength;\n                                    fLnk = formatBuilder.length;\n                                    if (lnk > 1 + nl && stringBuilder[lnk - (2 + nl)].length === 1 && /\\S/.test(stringBuilder[lnk - (2 + nl)]) && stringBuilder[lnk - (2 + nl)] !== '(' && stringBuilder[lnk - (2 + nl)] !== '[')\n                                        continue;\n                                    lNest = [];\n                                    lnk = stringBuilder.length - (1 + nl);\n                                    lnkOffset -= (1 + nl);\n                                    lLnk = stringBuilder.length - 1;\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                        lNest.push(')');\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                        lNest.push(']');\n                                    state = ParserState.URLFound;\n                                    pFnd = true;\n                                    if (pFnd)\n                                        break;\n                                }\n                                if (!pFnd) {\n                                    state = ParserState.URL;\n                                    lnk = idx;\n                                    lnkOffset = lineLength;\n                                }\n                            }\n                        }\n                        else if (c === '.') {\n                            stringBuilder.push(c);\n                            this._MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                            if (u && idx - 3 >= 0) {\n                                _MXPComment = 'http://';\n                                if ((text[idx - 1] === 'w' || idx[lnk - 1] === 'W') &&\n                                    (text[idx - 2] === 'w' || idx[lnk - 2] === 'W') &&\n                                    (text[idx - 3] === 'w' || idx[lnk - 3] === 'W')\n                                ) {\n                                    lnk = stringBuilder.length;\n                                    lnkOffset = lineLength;\n                                    fLnk = formatBuilder.length;\n                                    if (lnk > 4 && stringBuilder[lnk - 5].length === 1 && /\\S/.test(stringBuilder[lnk - 5]) && stringBuilder[lnk - 5] !== '(' && stringBuilder[lnk - 5] !== '[')\n                                        continue;\n                                    lNest = [];\n                                    lnk = stringBuilder.length - 4;\n                                    lnkOffset -= 4;\n                                    lLnk = stringBuilder.length - 1;\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '(')\n                                        lNest.push(')');\n                                    if (lnk > 0 && stringBuilder[lnk - 1] === '[')\n                                        lNest.push(']');\n                                    state = ParserState.URLFound;\n                                }\n                            }\n                        }\n                        else if (s && lineLength === 0 && text.substring(idx, idx + 8) === '!!MUSIC(') {\n                            _MXPArgs = [''];\n                            state = ParserState.MSPMusic;\n                            idx += 7;\n                            this._mxpState.noBreak = false;\n                        }\n                        else if (s && lineLength === 0 && text.substring(idx, idx + 8) === '!!SOUND(') {\n                            _MXPArgs = [''];\n                            state = ParserState.MSPSound;\n                            idx += 7;\n                            this._mxpState.noBreak = false;\n                        }\n                        else {\n                            if (f && i > 127 && i < 255) {\n                                if (i === 128)\n                                    c = '\\u00C7';\n                                else if (i === 129)\n                                    c = '\\u00FC';\n                                else if (i === 130)\n                                    c = '\\u00E9';\n                                else if (i === 131)\n                                    c = '\\u00E2';\n                                else if (i === 132)\n                                    c = '\\u00E4';\n                                else if (i === 133)\n                                    c = '\\u00E0';\n                                else if (i === 134)\n                                    c = '\\u00E5';\n                                else if (i === 135)\n                                    c = '\\u00E7';\n                                else if (i === 136)\n                                    c = '\\u00EA';\n                                else if (i === 137)\n                                    c = '\\u00EB';\n                                else if (i === 138)\n                                    c = '\\u00E8';\n                                else if (i === 139)\n                                    c = '\\u00EF';\n                                else if (i === 140)\n                                    c = '\\u00EE';\n                                else if (i === 141)\n                                    c = '\\u00EC';\n                                else if (i === 142)\n                                    c = '\\u00C4';\n                                else if (i === 143)\n                                    c = '\\u00C5';\n                                else if (i === 144)\n                                    c = '\\u00C9';\n                                else if (i === 145)\n                                    c = '\\u00E6';\n                                else if (i === 146)\n                                    c = '\\u00C6';\n                                else if (i === 147)\n                                    c = '\\u00F4';\n                                else if (i === 148)\n                                    c = '\\u00F6';\n                                else if (i === 149)\n                                    c = '\\u00F2';\n                                else if (i === 150)\n                                    c = '\\u00FB';\n                                else if (i === 151)\n                                    c = '\\u00F9';\n                                else if (i === 152)\n                                    c = '\\u00FF';\n                                else if (i === 153)\n                                    c = '\\u00D6';\n                                else if (i === 154)\n                                    c = '\\u00DC';\n                                else if (i === 155)\n                                    c = '\\u00A2';\n                                else if (i === 156)\n                                    c = '\\u00A3';\n                                else if (i === 157)\n                                    c = '\\u00A5';\n                                else if (i === 158)\n                                    c = '\\u20A7';\n                                else if (i === 159)\n                                    c = '\\u0192';\n                                else if (i === 160)\n                                    c = '\\u00E1';\n                                else if (i === 161)\n                                    c = '\\u00ED';\n                                else if (i === 162)\n                                    c = '\\u00F3';\n                                else if (i === 163)\n                                    c = '\\u00FA';\n                                else if (i === 164)\n                                    c = '\\u00F1';\n                                else if (i === 165)\n                                    c = '\\u00D1';\n                                else if (i === 166)\n                                    c = '\\u00AA';\n                                else if (i === 167)\n                                    c = '\\u00BA';\n                                else if (i === 168)\n                                    c = '\\u00BF';\n                                else if (i === 169)\n                                    c = '\\u2310';\n                                else if (i === 170)\n                                    c = '\\u00AC';\n                                else if (i === 171)\n                                    c = '\\u00BD';\n                                else if (i === 172)\n                                    c = '\\u00BC';\n                                else if (i === 173)\n                                    c = '\\u00A1';\n                                else if (i === 174)\n                                    c = '\\u00AB';\n                                else if (i === 175)\n                                    c = '\\u00BB';\n                                else if (i === 176)\n                                    c = '\\u2591';\n                                else if (i === 177)\n                                    c = '\\u2592';\n                                else if (i === 178)\n                                    c = '\\u2593';\n                                else if (i === 179)\n                                    c = '\\u2502';\n                                else if (i === 180)\n                                    c = '\\u2524';\n                                else if (i === 181)\n                                    c = '\\u2561';\n                                else if (i === 182)\n                                    c = '\\u2562';\n                                else if (i === 183)\n                                    c = '\\u2556';\n                                else if (i === 184)\n                                    c = '\\u2555';\n                                else if (i === 185)\n                                    c = '\\u2563';\n                                else if (i === 186)\n                                    c = '\\u2551';\n                                else if (i === 187)\n                                    c = '\\u2557';\n                                else if (i === 188)\n                                    c = '\\u255D';\n                                else if (i === 189)\n                                    c = '\\u255C';\n                                else if (i === 190)\n                                    c = '\\u255B';\n                                else if (i === 191)\n                                    c = '\\u2510';\n                                else if (i === 192)\n                                    c = '\\u2514';\n                                else if (i === 193)\n                                    c = '\\u2534';\n                                else if (i === 194)\n                                    c = '\\u252C';\n                                else if (i === 195)\n                                    c = '\\u251C';\n                                else if (i === 196)\n                                    c = '\\u2500';\n                                else if (i === 197)\n                                    c = '\\u253C';\n                                else if (i === 198)\n                                    c = '\\u255E';\n                                else if (i === 199)\n                                    c = '\\u255F';\n                                else if (i === 200)\n                                    c = '\\u255A';\n                                else if (i === 201)\n                                    c = '\\u2554';\n                                else if (i === 202)\n                                    c = '\\u2569';\n                                else if (i === 203)\n                                    c = '\\u2566';\n                                else if (i === 204)\n                                    c = '\\u2560';\n                                else if (i === 205)\n                                    c = '\\u2550';\n                                else if (i === 206)\n                                    c = '\\u256C';\n                                else if (i === 207)\n                                    c = '\\u2567';\n                                else if (i === 208)\n                                    c = '\\u2568';\n                                else if (i === 209)\n                                    c = '\\u2564';\n                                else if (i === 210)\n                                    c = '\\u2565';\n                                else if (i === 211)\n                                    c = '\\u2559';\n                                else if (i === 212)\n                                    c = '\\u2558';\n                                else if (i === 213)\n                                    c = '\\u2552';\n                                else if (i === 214)\n                                    c = '\\u2553';\n                                else if (i === 215)\n                                    c = '\\u256B';\n                                else if (i === 216)\n                                    c = '\\u256A';\n                                else if (i === 217)\n                                    c = '\\u2518';\n                                else if (i === 218)\n                                    c = '\\u250C';\n                                else if (i === 219)\n                                    c = '\\u2588';\n                                else if (i === 220)\n                                    c = '\\u2584';\n                                else if (i === 221)\n                                    c = '\\u258C';\n                                else if (i === 222)\n                                    c = '\\u2590';\n                                else if (i === 223)\n                                    c = '\\u2580';\n                                else if (i === 224)\n                                    c = '\\u03B1';\n                                else if (i === 225)\n                                    c = '\\u03B2';\n                                else if (i === 226)\n                                    c = '\\u0393';\n                                else if (i === 227)\n                                    c = '\\u03C0';\n                                else if (i === 228)\n                                    c = '\\u03A3';\n                                else if (i === 229)\n                                    c = '\\u03C3';\n                                else if (i === 230)\n                                    c = '\\u00B5';\n                                else if (i === 231)\n                                    c = '\\u03C4';\n                                else if (i === 232)\n                                    c = '\\u03A6';\n                                else if (i === 233)\n                                    c = '\\u0398';\n                                else if (i === 234)\n                                    c = '\\u03A9';\n                                else if (i === 235)\n                                    c = '\\u03B4';\n                                else if (i === 236)\n                                    c = '\\u221E';\n                                else if (i === 237)\n                                    c = '\\u2205';\n                                else if (i === 238)\n                                    c = '\\u2208';\n                                else if (i === 239)\n                                    c = '\\u2229';\n                                else if (i === 240)\n                                    c = '\\u2261';\n                                else if (i === 241)\n                                    c = '\\u00B1';\n                                else if (i === 242)\n                                    c = '\\u2265';\n                                else if (i === 243)\n                                    c = '\\u2264';\n                                else if (i === 244)\n                                    c = '\\u2320';\n                                else if (i === 245)\n                                    c = '\\u2321';\n                                else if (i === 246)\n                                    c = '\\u00F7';\n                                else if (i === 247)\n                                    c = '\\u2248';\n                                else if (i === 248)\n                                    c = '\\u00B0';\n                                else if (i === 249)\n                                    c = '\\u2219';\n                                else if (i === 250)\n                                    c = '\\u00B7';\n                                else if (i === 251)\n                                    c = '\\u221A';\n                                else if (i === 252)\n                                    c = '\\u207F';\n                                else if (i === 253)\n                                    c = '\\u00B2';\n                                else if (i === 254)\n                                    c = '\\u25A0';\n                            }\n                            else if (i > 255)\n                                format.unicode = true;\n                            stringBuilder.push(c);\n                            this._MXPCapture(c);\n                            lineLength++;\n                            this.textLength++;\n                            this._mxpState.noBreak = false;\n                        }\n                        break;\n                }\n            }\n            if (this._SplitBuffer.length) {\n                this.rawLength -= this._SplitBuffer.length;\n                rawBuilder.splice(rawBuilder.length - this._SplitBuffer.length, this._SplitBuffer.length);\n            }\n            formatBuilder.push(...this._getMXPCloseFormatBlocks());\n            if (state === ParserState.URLFound) {\n                formatBuilder.splice(fLnk, 0,\n                    {\n                        formatType: FormatType.Link,\n                        offset: lnkOffset,\n                        href: _MXPComment += stringBuilder.slice(lnk).join('')\n                    });\n            }\n            this._AddLine(stringBuilder.join(''), rawBuilder.join(''), true, false, formatBuilder, remote);\n        }\n        catch (ex) {\n            if (this.enableDebug) this.emit('debug', ex);\n        }\n        this.busy = false;\n        this.emit('parse-done');\n        this._parsing.shift();\n        if (this._parsing.length > 0)\n            setTimeout(this._parseNext(), 0);\n    }\n\n    private _parseNext() {\n        const iTmp = this._parsing.shift();\n        return () => { this.parse(iTmp[0], iTmp[1], true, iTmp[2]); };\n    }\n\n    public updateWindow(width, height) {\n        this.window = { width: width, height: height };\n    }\n\n    public Clear() {\n        this._ResetColors();\n        this.textLength = 0;\n        this._SplitBuffer = '';\n    }\n\n    public ClearMXP() {\n        this._mxpEntities = {};\n        this.ResetMXP();\n        this._mxpElements = {};\n        this._mxpState = new MXPState();\n    }\n\n    public ResetMXP() {\n        this._mxpStyles = [];\n        this._mxpStyles.push(new MXPStyle(FontStyle.None, '', '', false));\n    }\n\n    public ResetMXPLine() {\n        this._iMXPDefaultMode = lineType.Open;\n        this._mxpState.lineType = lineType.Open;\n    }\n\n    //public interface, as client can only access publicly marked entities\n    public GetPublicEntity(entity) {\n        if (this._mxpEntities[entity] && this._mxpEntities[entity].publish)\n            return this._mxpEntities[entity].value;\n        return entity;\n    }\n\n}", "import '../css/ansi.css';\r\nimport '../css/display.css';\r\nimport { EventEmitter } from './events';\r\nimport { Parser } from './parser';\r\nimport { Size, DisplayOptions, ParserLine, FormatType, FontStyle, Point } from './types';\r\nimport { htmlEncode, formatUnit, getScrollbarWidth, debounce } from './library';\r\n\r\ndeclare let moment;\r\n\r\n/**\r\n * Contains parsed line data\r\n */\r\ninterface LineData {\r\n    text: string;       //the line text\r\n    formats: any[];     //the line formatting data\r\n    raw: string;        //the raw line data including all ansi codes\r\n    id: number;         //unique id for line\r\n    timestamp: number;  //timestamp the line was added\r\n}\r\n\r\nexport enum UpdateType {\r\n    none = 0,\r\n    update = 1 << 0,\r\n    display = 1 << 1,\r\n    trim = 1 << 2,\r\n    scrollEnd = 1 << 3,\r\n    updateWindow = 1 << 4,\r\n    rebuildLines = 1 << 5,\r\n    split = 1 << 6,\r\n    toggleSplit = 1 << 7\r\n}\r\n\r\nexport enum TimeStampStyle {\r\n    None = 0,\r\n    Simple = 1,\r\n    Format = 2\r\n}\r\n\r\nexport class Display extends EventEmitter {\r\n    //#region Private properties\r\n    private _model: DisplayModel;\r\n    private _container: HTMLElement;\r\n    private _view: HTMLElement;\r\n    private _updating: UpdateType = UpdateType.none;\r\n    private _enableDebug: boolean = false;\r\n    private _lastMouse: MouseEvent;\r\n    private _character: HTMLElement;\r\n    private _charHeight: number;\r\n    private _charWidth: number;\r\n    private _innerHeight;\r\n    private _maxView: number = 0;\r\n    private _padding = [0, 0, 0, 0];\r\n    private _enableColors: boolean = true;\r\n    private _enableBackgroundColors: boolean = true;\r\n    private _hideTrailingEmptyLine = true;\r\n    private _styles: HTMLStyleElement;\r\n    private _maxLines: number = 500;\r\n    private _wordWrap = false;\r\n    private _indent: number = 4;\r\n    private _indentPadding: number = 0;\r\n    private _wrapAt: number = 0;\r\n    private _split;\r\n    private _splitHeight: number;\r\n    public splitLive: boolean = false;\r\n\r\n    private _linkFunction;\r\n    private _mxpLinkFunction;\r\n    private _mxpSendFunction;\r\n    private _mxpTooltipFunction;\r\n    private _scrollAtEnd = false;\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    private _wResize;\r\n    private _wUp;\r\n    private _wMove;\r\n    private _selectionChange;\r\n\r\n    private _lineCache: string[] = [];\r\n    private _expireCache: number[] = [];\r\n\r\n    private _timestamp: TimeStampStyle = TimeStampStyle.None;\r\n    private _timestampFormat: string = '[[]MM-DD HH:mm:ss.SSS[]] ';\r\n    private _timestampWidth: number = new Date().toISOString().length + 1;\r\n    private _mouseDown = 0;\r\n    private _document: Document;\r\n    private _window: Window;\r\n    private _scrollLock: boolean = false;\r\n    private _selection = { start: null, end: null, timer: null };\r\n    private _customSelection: boolean = true;\r\n    private _highlightRange;\r\n    private _highlight;\r\n    private _bounds;\r\n\r\n    private get _horizontalScrollBarHeight() {\r\n        return (this._view.scrollWidth > this._view.clientWidth ? getScrollbarWidth() : 0);\r\n    }\r\n    private get _verticalScrollBarHeight() {\r\n        return getScrollbarWidth();\r\n    }\r\n    //#endregion\r\n    //#region Public properties\r\n    get customSelection() { return this._customSelection || this._split }\r\n    set customSelection(value) {\r\n        if (value === this._customSelection) return;\r\n        this._customSelection = value;\r\n        if (!value && this._selection.timer) {\r\n            this._window.clearTimeout(this._selection.timer);\r\n            this._selection.timer = null;\r\n        }\r\n        this._updateSelectionHighlight();\r\n    }\r\n\r\n    get scrollLock() { return this._scrollLock; }\r\n    set scrollLock(value) {\r\n        if (this._scrollLock === value) return;\r\n        this._scrollLock = value;\r\n        if (!this._scrollLock && this._split && this._split.visible) {\r\n            this.scrollDisplay(true);\r\n        }\r\n        else if (this._scrollLock && this._split && !this._split.visible)\r\n            this.scrollUp();\r\n    }\r\n\r\n    get showTimestamp() { return this._timestamp; }\r\n    set showTimestamp(value: TimeStampStyle) {\r\n        if (value === this._timestamp) return;\r\n        if (typeof value === 'boolean')\r\n            this._timestamp = value ? TimeStampStyle.Format : TimeStampStyle.None;\r\n        this._timestamp = value;\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this._buildStyleSheet();\r\n        this._doUpdate(UpdateType.display | UpdateType.update | UpdateType.rebuildLines | UpdateType.split);\r\n    }\r\n\r\n    get timestampFormat() { return this._timestampFormat; }\r\n    set timestampFormat(value: string) {\r\n        if (this._timestampFormat === value) return;\r\n        this._timestampFormat = value;\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this._doUpdate(UpdateType.display | UpdateType.rebuildLines | UpdateType.updateWindow | UpdateType.update | UpdateType.split);\r\n    }\r\n\r\n    get wordWrap(): boolean {\r\n        return this._wordWrap;\r\n    }\r\n\r\n    set wordWrap(value: boolean) {\r\n        if (value === this._wordWrap) return;\r\n        this._wordWrap = value;\r\n        this._buildStyleSheet();\r\n        this._doUpdate(UpdateType.update | UpdateType.split);\r\n    }\r\n\r\n    get wrapAt() { return this._wrapAt; }\r\n    set wrapAt(value: number) {\r\n        if (value === this._wrapAt) return;\r\n        this._wrapAt = value;\r\n        this._buildStyleSheet();\r\n        this._doUpdate(UpdateType.update | UpdateType.display | UpdateType.split);\r\n    }\r\n\r\n    get indent() { return this._indent; }\r\n    set indent(value: number) {\r\n        if (value === this._indent)\r\n            return;\r\n        this._indent = value;\r\n        this._buildStyleSheet();\r\n        this._doUpdate(UpdateType.update | UpdateType.display | UpdateType.split);\r\n    }\r\n\r\n    get splitHeight(): number { return this._splitHeight; }\r\n    set splitHeight(value: number) {\r\n        if (this._splitHeight !== value) {\r\n            this._splitHeight = value;\r\n            this._bounds.height -= this._horizontalScrollBarHeight - this._padding[2];\r\n            if (this._splitHeight <= this._bounds.top + 150)\r\n                this._splitHeight = 150;\r\n            else if (this._splitHeight > this._bounds.bottom - 150)\r\n                this._splitHeight = this._bounds.height - 150;\r\n            this._updateSplitLocation();\r\n        }\r\n    }\r\n\r\n    get enableSplit(): boolean { return this._split === null; }\r\n    set enableSplit(value: boolean) {\r\n        const id = this.id;\r\n        if (!this._split && value) {\r\n            this._split = {\r\n                _view: document.createElement('div'),\r\n                _bar: document.createElement('div'),\r\n                visible: false\r\n            }\r\n            this._split._view.id = id + '-split-view';\r\n            this._split._view.classList.add('view', 'display-split-view');\r\n            this._split._view.style.right = this._verticalScrollBarHeight + 'px';\r\n            this._split._bar.id = id + '-split-bar';\r\n            this._split._bar.classList.add('display-split-bar', 'user-select-none');\r\n            this._view.insertAdjacentElement('afterend', this._split._view);\r\n            this._container.insertAdjacentElement('afterbegin', this._split._bar);\r\n            this._updateSplitLocation();\r\n            this._split._bar.style.right = this._verticalScrollBarHeight + 'px';\r\n            this._split._bar.style.top = (this._view.clientHeight - this._split._view.clientHeight - this._horizontalScrollBarHeight) + 'px';\r\n            this._split._bar.addEventListener('mousedown', (e) => {\r\n                if (e.buttons !== 1) return;\r\n                e.preventDefault();\r\n                e.cancelBubble = true;\r\n                this._split.ghostBar = document.createElement('div');\r\n                this._split.ghostBar.id = id + '-split-ghost-bar';\r\n                this._split.ghostBar.classList.add('display-split-ghost-bar');\r\n                this._split.ghostBar.style.top = this._split._bar.style.top;\r\n                this._split.ghostBar.style.display = 'block';\r\n                this._split.ghostBar.style.right = this._verticalScrollBarHeight + 'px';\r\n                this._container.appendChild(this._split.ghostBar);\r\n                const bounds = this._bounds;\r\n                bounds.height -= this._horizontalScrollBarHeight - this._padding[2];\r\n\r\n                this._split.mouseMove = (e) => {\r\n                    e.preventDefault();\r\n                    e.cancelBubble = true;\r\n                    e.stopPropagation();\r\n                    if (e.pageY < bounds.top + 150)\r\n                        this._split.ghostBar.style.top = '150px';\r\n                    else if (e.pageY > bounds.bottom - 150)\r\n                        this._split.ghostBar.style.top = (bounds.height - 150) + 'px';\r\n                    else\r\n                        this._split.ghostBar.style.top = (e.pageY - bounds.top) + 'px';\r\n\r\n                    if (this.splitLive) {\r\n                        let h;\r\n                        if (e.pageY < bounds.top + 150)\r\n                            h = 150;\r\n                        else if (e.pageY > bounds.bottom - 150)\r\n                            h = bounds.height - 150;\r\n                        else\r\n                            h = e.pageY - bounds.top;\r\n                        this._split._view.style.top = h + 'px';\r\n                        this._split._bar.style.top = (this._view.clientHeight - this._split._view.clientHeight) + 'px';\r\n                        this._split._view.scrollTop = this._split._view.scrollHeight;\r\n                        this.emit('split-move', h);\r\n                    }\r\n                };\r\n                this._container.addEventListener('mousemove', this._split.mouseMove);\r\n                this._container.addEventListener('mouseup', this._split.moveDone);\r\n                //this._container.addEventListener('mouseleave', this._split.moveDone);\r\n            });\r\n\r\n            this._split.moveDone = (e) => {\r\n                if (this._split.ghostBar) {\r\n                    const bounds = this._bounds;\r\n                    bounds.height -= this._horizontalScrollBarHeight - this._padding[2];\r\n                    let h;\r\n                    if (e.pageY < bounds.top + 150)\r\n                        h = 150;\r\n                    else if (e.pageY > bounds.bottom - 150)\r\n                        h = bounds.height - 150;\r\n                    else\r\n                        h = e.pageY - bounds.top;\r\n                    this._split._view.style.top = h + 'px';\r\n                    this._split._bar.style.top = (this._view.clientHeight - this._split._view.clientHeight) + 'px';\r\n                    this._split._view.scrollTop = this._split._view.scrollHeight;\r\n                    this._splitHeight = h;\r\n                    this._container.removeChild(this._split.ghostBar);\r\n                    delete this._split.ghostBar;\r\n                    this.emit('split-move-done', h);\r\n                }\r\n                this._container.removeEventListener('mousemove', this._split.mouseMove);\r\n                this._container.removeEventListener('mouseup', this._split.moveDone);\r\n                //this._container.removeEventListener('mouseleave', this._split.moveDone);\r\n                this._split.mouseMove = null;\r\n            };\r\n            this._split._view.addEventListener('mousedown', (e) => {\r\n                this._container.focus();\r\n                this.emit('mousedown', e);\r\n                if (e.button === 0) {\r\n                    e.preventDefault();\r\n                    let caret = this._getMouseEventCaretRange(e);\r\n                    this._window.getSelection().removeAllRanges();\r\n                    if (caret.startContainer)\r\n                        this._window.getSelection().addRange(caret);\r\n                    else if (caret.offsetNode) {\r\n                        const range = document.createRange();\r\n                        range.setStart(caret.offsetNode, caret.offset);\r\n                        range.setEnd(caret.offsetNode, caret.offset);\r\n                        this._window.getSelection().addRange(range);\r\n                    }\r\n                    this._mouseDown = 2;\r\n                    this._split._bar.style.pointerEvents = 'none';\r\n                }\r\n            });\r\n            this._split._view.addEventListener('mousemove', async e => {\r\n                if (this._mouseDown) {\r\n                    this._lastMouse = e;\r\n                    this._extendSelection(e);\r\n                    //when near edge of view start auto scroll\r\n                    this._createScrollTimer();\r\n                }\r\n            });\r\n\r\n            this._split._view.addEventListener('mouseleave', e => {\r\n                if (this._mouseDown && e.toElement !== this._split._bar && e.target !== this._split._bar && (e.pageX >= this._split._bounds.right || e.pageY >= this._bounds.bottom - this._horizontalScrollBarHeight)) {\r\n                    this._lastMouse = e;\r\n                    this._window.getSelection().extend(this._split._view.lastChild, this._split._view.lastChild.childNodes.length);\r\n                }\r\n            });\r\n            this._split._view.addEventListener('mouseenter', e => {\r\n                if (this._mouseDown && (e.buttons & 1) !== 1) {\r\n                    this._clearMouseDown();\r\n                }\r\n                else if (this._mouseDown) {\r\n                    this._lastMouse = e;\r\n                    this._extendSelection(e);\r\n                    this._createScrollTimer();\r\n                }\r\n            });\r\n            this._split._view.addEventListener('mouseup', (e) => {\r\n                this.emit('mouseup', e);\r\n                if (e.button === 0)\r\n                    this._clearMouseDown();\r\n                if (!e.button)\r\n                    this._view.click();\r\n            });\r\n            this._split._view.addEventListener('wheel', e => {\r\n                const delta = e.deltaY || e.wheelDelta;\r\n                this._view.scrollTop += delta;\r\n            }, { passive: true });\r\n            this._toggleSplit();\r\n            this._doUpdate(UpdateType.split | UpdateType.toggleSplit);\r\n        }\r\n        else if (this._split && !value) {\r\n            this._container.removeEventListener('mouseup', this._split.moveDone);\r\n            this._container.removeEventListener('mouseleave', this._split.moveDone);\r\n            this._container.removeChild(this._split._view);\r\n            this._container.removeChild(this._split._bar);\r\n            this._split = null;\r\n        }\r\n    }\r\n\r\n    get linkFunction(): string {\r\n        return this._linkFunction || 'doLink';\r\n    }\r\n\r\n    set linkFunction(val: string) {\r\n        this._linkFunction = val;\r\n    }\r\n\r\n    get mxpLinkFunction(): string {\r\n        return this._mxpLinkFunction || 'doMXPLink';\r\n    }\r\n\r\n    set mxpLinkFunction(val: string) {\r\n        this._mxpLinkFunction = val;\r\n    }\r\n\r\n    get mxpSendFunction(): string {\r\n        return this._mxpSendFunction || 'doMXPSend';\r\n    }\r\n\r\n    set mxpSendFunction(val: string) {\r\n        this._mxpSendFunction = val;\r\n    }\r\n\r\n    get mxpTooltipFunction(): string {\r\n        return this._mxpTooltipFunction || 'doMXPTooltip';\r\n    }\r\n\r\n    set mxpTooltipFunction(val: string) {\r\n        this._mxpTooltipFunction = val;\r\n    }\r\n\r\n    get id() {\r\n        if (this._container) return this._container.id;\r\n        return '';\r\n    }\r\n\r\n    get container(): HTMLElement {\r\n        return this._container;\r\n    }\r\n\r\n    get lines(): LineData[] {\r\n        return this._model.lines;\r\n    }\r\n\r\n    get model() { return this._model; }\r\n    set model(value: DisplayModel) {\r\n        if (this._model === value) return;\r\n        //if model set remove all listeners\r\n        if (this._model)\r\n            this._model.removeAllListeners();\r\n        //set model and assign all the events needed\r\n        this._model = value;\r\n        this._model.on('debug', this.debug, this);\r\n        this._model.on('bell', () => { this.emit('bell'); });\r\n        this._model.on('add-line', data => { this.emit('add-line', data); });\r\n        this._model.on('add-line-done', data => { this.emit('add-line-done', data); });\r\n        this._model.on('line-added', (data, noUpdate) => {\r\n            this._lineCache.push(this.getLineHTML(data.idx));\r\n        });\r\n        this._model.on('expire-links', args => {\r\n            if (this._expireCache.length) {\r\n                for (let x = 0, xl = this._expireCache.length; x < xl; x++)\r\n                    this._rebuildLine(this._expireCache[x]);\r\n            }\r\n            this._expireCache = [];\r\n            this.emit('expire-links');\r\n        });\r\n        this._model.on('parse-done', () => {\r\n            this._view.insertAdjacentHTML('beforeend', this._lineCache.join(''));\r\n            this._lineCache = [];\r\n            this._doUpdate(UpdateType.display | UpdateType.split);\r\n            this.emit('parse-done');\r\n        });\r\n\r\n        this._model.on('set-title', (title, type) => {\r\n            this.emit('set-title', title, type);\r\n        });\r\n        this._model.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this._model.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this._model.on('MXP-tag-reply', (tag, args) => {\r\n            this.emit('MXP-tag-reply', tag, args);\r\n        });\r\n\r\n        this._model.on('expire-link-line', idx => {\r\n            this._expireCache.push(idx);\r\n            this._doUpdate(UpdateType.display | UpdateType.split);\r\n        });\r\n    }\r\n\r\n    get maxLines(): number { return this._maxLines; }\r\n    set maxLines(value: number) {\r\n        if (value !== this._maxLines) {\r\n            this._maxLines = value;\r\n            this._doUpdate(UpdateType.trim);\r\n        }\r\n    }\r\n\r\n    get enableDebug(): boolean {\r\n        return this._enableDebug;\r\n    }\r\n\r\n    get enableColors() { return this._enableColors; }\r\n    set enableColors(value) {\r\n        if (value === this._enableColors) return;\r\n        this._enableColors = value;\r\n        this._buildStyleSheet();\r\n    }\r\n\r\n    get enableBackgroundColors() { return this._enableBackgroundColors; }\r\n    set enableBackgroundColors(value) {\r\n        if (value === this._enableBackgroundColors) return;\r\n        this._enableBackgroundColors = value;\r\n        this._buildStyleSheet();\r\n    }\r\n\r\n    get hideTrailingEmptyLine() { return this._hideTrailingEmptyLine; }\r\n    set hideTrailingEmptyLine(value) {\r\n        if (value === this._hideTrailingEmptyLine) return;\r\n        this._hideTrailingEmptyLine = value;\r\n        this._doUpdate(UpdateType.display);\r\n    }\r\n\r\n    set enableDebug(enable: boolean) {\r\n        this._enableDebug = enable;\r\n        this._model.enableDebug = enable;\r\n    }\r\n\r\n    get tabWidth(): number {\r\n        return this._model.tabWidth;\r\n    }\r\n\r\n    set tabWidth(value) {\r\n        this._model.tabWidth = value;\r\n    }\r\n\r\n    get textLength(): number {\r\n        return this._model.textLength;\r\n    }\r\n\r\n    get EndOfLine(): boolean {\r\n        return this._model.EndOfLine;\r\n    }\r\n\r\n    get parseQueueLength(): number {\r\n        return this._model.parseQueueLength;\r\n    }\r\n\r\n    get parseQueueEndOfLine(): boolean {\r\n        return this._model.parseQueueEndOfLine;\r\n    }\r\n\r\n    get EndOfLineLength(): number {\r\n        if (this.lines.length === 0)\r\n            return 0;\r\n        return this.lines[this.lines.length - 1].text.length;\r\n    }\r\n\r\n    set enableFlashing(value: boolean) {\r\n        this._model.enableFlashing = value;\r\n    }\r\n    get enableFlashing(): boolean {\r\n        return this._model.enableFlashing;\r\n    }\r\n\r\n    set enableMXP(value: boolean) {\r\n        this._model.enableMXP = value;\r\n    }\r\n    get enableMXP(): boolean {\r\n        return this._model.enableMXP;\r\n    }\r\n\r\n    set showInvalidMXPTags(value: boolean) {\r\n        this._model.showInvalidMXPTags = value;\r\n    }\r\n    get showInvalidMXPTags(): boolean {\r\n        return this._model.showInvalidMXPTags;\r\n    }\r\n\r\n    set enableBell(value: boolean) {\r\n        this._model.enableBell = value;\r\n    }\r\n    get enableBell(): boolean {\r\n        return this._model.enableBell;\r\n    }\r\n\r\n    set enableURLDetection(value: boolean) {\r\n        this._model.enableURLDetection = value;\r\n    }\r\n    get enableURLDetection(): boolean {\r\n        return this._model.enableURLDetection;\r\n    }\r\n\r\n    set enableMSP(value: boolean) {\r\n        this._model.enableMSP = value;\r\n    }\r\n    get enableMSP(): boolean {\r\n        return this._model.enableMSP;\r\n    }\r\n\r\n    set displayControlCodes(value: boolean) {\r\n        this._model.displayControlCodes = value;\r\n    }\r\n    get displayControlCodes(): boolean {\r\n        return this._model.displayControlCodes;\r\n    }\r\n\r\n    set emulateTerminal(value: boolean) {\r\n        this._model.emulateTerminal = value;\r\n    }\r\n    get emulateTerminal(): boolean {\r\n        return this._model.emulateTerminal;\r\n    }\r\n\r\n    set emulateControlCodes(value: boolean) {\r\n        this._model.emulateControlCodes = value;\r\n    }\r\n    get emulateControlCodes(): boolean {\r\n        return this._model.emulateControlCodes;\r\n    }\r\n\r\n    set MXPStyleVersion(value: string) {\r\n        this._model.MXPStyleVersion = value;\r\n    }\r\n    get MXPStyleVersion(): string {\r\n        return this._model.MXPStyleVersion;\r\n    }\r\n\r\n    get WindowSize(): Size {\r\n        return new Size(this.WindowWidth, this.WindowHeight);\r\n    }\r\n\r\n    get WindowWidth(): number {\r\n        return Math.trunc(this._maxView / this._charWidth);\r\n    }\r\n\r\n    get WindowHeight(): number {\r\n        if (this._view.scrollWidth > this._view.clientWidth)\r\n            return Math.trunc((this._innerHeight - this._verticalScrollBarHeight - this._padding[0] - this._padding[2]) / this._charHeight);\r\n        return Math.trunc((this._innerHeight - this._padding[0] - this._padding[2]) / this._charHeight);\r\n    }\r\n\r\n    get html(): string {\r\n        const l = this.lines.length;\r\n        const html: string[] = [];\r\n        for (let idx = 0; idx < l; idx++)\r\n            html.push(this.getLineHTML(idx));\r\n        return html.join('');\r\n    }\r\n\r\n    get text(): string {\r\n        return this._model.text;\r\n    }\r\n\r\n    get raw(): string {\r\n        return this._model.raw;\r\n    }\r\n\r\n    get scrollAtBottom() {\r\n        return this._scrollAtEnd;\r\n    }\r\n    //#endregion\r\n    constructor(container: string | JQuery | HTMLElement | DisplayOptions, options?: DisplayOptions) {\r\n        super();\r\n        if (!container)\r\n            throw new Error('Container must be a selector, element, jquery object or display options');\r\n        if (typeof container === 'object' && 'container' in container) {\r\n            options = Object.assign(options || {}, container);\r\n            container = options.container;\r\n            delete options.container;\r\n        }\r\n        if (typeof container === 'string') {\r\n            this._container = document.querySelector(container);\r\n            if (!this._container)\r\n                throw new Error('Invalid selector for display.');\r\n        }\r\n        else if (container instanceof $)\r\n            this._container = container[0];\r\n        else if (container instanceof HTMLElement)\r\n            this._container = container;\r\n        else if ((<HTMLElement>container).ownerDocument.defaultView && container instanceof (<HTMLElement>container).ownerDocument.defaultView.HTMLElement)\r\n            this._container = container;\r\n        else\r\n            throw new Error('Container must be a selector, element or jquery object');\r\n\r\n        this._document = this._container.ownerDocument;\r\n        this._window = this._document.defaultView;\r\n        this._container.tabIndex = -1;\r\n        this._container.classList.add('display');\r\n        (<any>this._container).display = this;\r\n        this._styles = this._document.createElement('style');\r\n        this._container.appendChild(this._styles);\r\n        this._character = this._document.createElement('span');\r\n        this._character.id = this.id + '-Character';\r\n        this._character.className = 'line';\r\n        this._character.innerHTML = '<span style=\"border-bottom: 1px solid rgb(0, 0, 0);\">W</span>';\r\n        this._character.style.visibility = 'hidden';\r\n        this._container.appendChild(this._character);\r\n\r\n        this._view = this._document.createElement('div');\r\n        this._view.className = 'view';\r\n        this._view.addEventListener('scroll', () => {\r\n            this._scrollAtEnd = this._view.clientHeight + this._view.scrollTop >= this._view.scrollHeight;\r\n            this._doUpdate(UpdateType.toggleSplit);\r\n        });\r\n        this._view.addEventListener('click', e => {\r\n            this.emit('click', e);\r\n        })\r\n        this._view.addEventListener('contextmenu', e => {\r\n            this.emit('contextmenu', e);\r\n        });\r\n        this._view.addEventListener('mousedown', e => {\r\n            this._container.focus();\r\n            //only do custom selection if split view\r\n            if (this._split && this._split.visible) {\r\n                let caret = this._getMouseEventCaretRange(e);\r\n                if (caret) {\r\n                    this._window.getSelection().removeAllRanges();\r\n                    if (caret.startContainer)\r\n                        this._window.getSelection().addRange(caret);\r\n                    else if (caret.offsetNode) {\r\n                        const range = document.createRange();\r\n                        range.setStart(caret.offsetNode, caret.offset);\r\n                        range.setEnd(caret.offsetNode, caret.offset);\r\n                        this._window.getSelection().addRange(range);\r\n                    }\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n            this.emit('mousedown', e);\r\n            const bounds = this._bounds;\r\n            let w = bounds.width - this._view.clientWidth;\r\n            let h = bounds.height - this._view.clientHeight;\r\n            if (e.button === 0 && e.pageX < bounds.right - w && e.pageY < bounds.bottom - h) {\r\n                if (this.customSelection)\r\n                    this.clearSelection();\r\n                this._mouseDown = 1;\r\n                if (this._split)\r\n                    this._split._bar.style.pointerEvents = 'none';\r\n            }\r\n            else if (this.customSelection && e.button === 2 && this._selection.start) {\r\n                let caret = this._getMouseEventCaretRange(e);\r\n                let range = this._document.createRange();\r\n                range.setStart(this._selection.start.node, this._selection.start.offset);\r\n                range.setEnd(this._selection.end.node, this._selection.end.offset);\r\n                if ((caret.offsetNode && range.intersectsNode(caret.offsetNode)) || (caret.startContainer && range.intersectsNode(caret.startContainer))) {\r\n                    this._window.getSelection().removeAllRanges();\r\n                    this._window.getSelection().addRange(range);\r\n                }\r\n                else {\r\n                    this.clearSelection();\r\n                }\r\n            }\r\n        });\r\n        this._view.addEventListener('mousemove', async e => {\r\n            this._lastMouse = e;\r\n            if (this._mouseDown) {\r\n                this._extendSelection(e);              \r\n                //when near edge of view start auto scroll\r\n                this._createScrollTimer();\r\n            }\r\n        });\r\n        this._view.addEventListener('mouseup', e => {\r\n            this.emit('mouseup', e);\r\n            if(this._mouseDown === 2)\r\n                this._view.click();\r\n            if (e.button === 0)\r\n                this._clearMouseDown();\r\n        });\r\n        this._view.addEventListener('mouseenter', e => {\r\n            //mouse left and came back with button up so fake a mouseup\r\n            if (this._mouseDown && (e.buttons & 1) !== 1)\r\n                this._clearMouseDown();\r\n            else\r\n                this._clearScrollTimer();\r\n        });\r\n        this._view.addEventListener('mouseleave', e => {\r\n            if (this._mouseDown) {\r\n                this._lastMouse = e;\r\n                if (this._view.lastChild && e.pageY >= (this._bounds.bottom - this._horizontalScrollBarHeight)) {\r\n                    this._window.getSelection().extend(this._view.lastChild, this._view.lastChild.childNodes.length);\r\n                    this._updateSelectionHighlight();\r\n                }\r\n                this._createScrollTimer();\r\n            }\r\n        });\r\n        this._container.appendChild(this._view);\r\n\r\n        this._charHeight = parseFloat(this._window.getComputedStyle(this._character).height);\r\n        this._charWidth = parseFloat(this._window.getComputedStyle(this._character.firstElementChild).width);\r\n        if (!options)\r\n            options = { display: this };\r\n        else\r\n            options.display = this;\r\n        this.model = new DisplayModel(options);\r\n\r\n        this._wResize = (e) => {\r\n            if (this._scrollAtEnd)\r\n                this.scrollDisplay();\r\n            debounce(() => {\r\n                this._doUpdate(UpdateType.update | UpdateType.updateWindow | UpdateType.split);\r\n            }, 250, this.id + 'resize');\r\n        };\r\n        this._selectionChange = e => {\r\n            //some weird bug in chrome that with out this causes the end/start container to be the wrong nodes\r\n            if (this._window.getSelection().rangeCount)\r\n                this._window.getSelection().getRangeAt(0);\r\n            if (this._mouseDown)\r\n                debounce(() => {\r\n                    let selection = this._window.getSelection();\r\n                    if (this.customSelection && selection.rangeCount > 0) {\r\n                        const range = selection.getRangeAt(0);\r\n                        let nOffset = null;\r\n                        nOffset = this._getNodeOffset(this._view, this._view.firstChild, range.startContainer, range.startOffset, range);\r\n                        if (nOffset === null && this._split && this._split.visible)\r\n                            nOffset = this._getNodeOffset(this._split._view, this._split._view.firstChild, range.startContainer, range.startOffset, range);\r\n                        this._selection.start = nOffset;\r\n                        nOffset = null;\r\n                        if (this._split && this._split.visible)\r\n                            nOffset = this._getNodeOffset(this._split._view, this._split._view.lastChild, range.endContainer, range.endOffset, range);\r\n                        if (nOffset === null)\r\n                            nOffset = this._getNodeOffset(this._view, this._view.lastChild, range.endContainer, range.endOffset, range);\r\n                        this._selection.end = nOffset;\r\n                        this._updateSelectionHighlight();\r\n                    }\r\n                    this.emit('selection-changed', selection);\r\n                }, 10, this.id + 'selection-changed');\r\n        };\r\n        this._wUp = e => {\r\n            if (this._mouseDown && e.button === 0) {\r\n                this._lastMouse = e;\r\n                this._clearMouseDown();\r\n            }\r\n        };\r\n        this._wMove = e => {\r\n            if (this._mouseDown)\r\n                this._lastMouse = e;\r\n        };\r\n        this._window.addEventListener('resize', this._wResize.bind(this));\r\n        this._window.addEventListener('mouseup', this._wUp.bind(this));\r\n        this._window.addEventListener('mousemove', this._wMove.bind(this));\r\n        this._document.addEventListener('selectionchange', this._selectionChange.bind(this));\r\n\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            debounce(() => {\r\n                if (!this._resizeObserverCache || this._resizeObserverCache.width !== entries[0].contentRect.width || this._resizeObserverCache.height !== entries[0].contentRect.height) {\r\n                    if (this._scrollAtEnd)\r\n                        this.scrollDisplay();\r\n                    this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                    this._doUpdate(UpdateType.update | UpdateType.updateWindow | UpdateType.split);\r\n                }\r\n            }, 250, this.id + 'resize');\r\n            this._updateSplit();\r\n            this.emit('resize');\r\n        });\r\n        this._resizeObserver.observe(this._container);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    if (this._scrollAtEnd)\r\n                        this.scrollDisplay();\r\n                    this._doUpdate(UpdateType.update | UpdateType.updateWindow | UpdateType.split);\r\n                    this.emit('resize');\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._container, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n        if (!moment || this._timestamp !== TimeStampStyle.Format)\r\n            this._timestampWidth = new Date().toISOString().length + 1;\r\n        else\r\n            this._timestampWidth = moment().format(this._timestampFormat).length;\r\n        this.updateFont();\r\n        this._bounds = this._view.getBoundingClientRect();\r\n        this.splitHeight = -1;\r\n    }\r\n\r\n    public debug(msg) {\r\n        this.emit('debug', msg);\r\n    }\r\n\r\n    public scrollDisplay(force?): void {\r\n        if (this._split) {\r\n            if (force || !this.scrollLock && !this._split.visible)\r\n                this._view.scrollTop = this._view.scrollHeight;\r\n        }\r\n        else if (!this.scrollLock)\r\n            this._view.scrollTop = this._view.scrollHeight;\r\n    };\r\n\r\n    public scrollTo(x: number, y: number) {\r\n        this._view.scrollTo(x, y);\r\n    }\r\n\r\n    public scrollToCharacter(x: number, y: number) {\r\n        this._view.scrollTo(x * this._charHeight, y * this._charWidth);\r\n    }\r\n\r\n    public scrollBy(x: number, y: number) {\r\n        this._view.scrollBy(x, y);\r\n    }\r\n\r\n    public scrollUp() {\r\n        this._view.scrollBy(0, -this._charHeight);\r\n    }\r\n\r\n    public scrollDown() {\r\n        this._view.scrollBy(0, this._charHeight);\r\n    }\r\n\r\n    public pageUp() {\r\n        this._view.scrollBy(0, -this._view.clientHeight)\r\n    }\r\n\r\n    public pageDown() {\r\n        this._view.scrollBy(0, this._view.clientHeight)\r\n    }\r\n\r\n    public trimLines() {\r\n        if (this._maxLines === -1)\r\n            return;\r\n        if (this.lines.length > this._maxLines) {\r\n            const amt = this.lines.length - this._maxLines;\r\n            let r = amt;\r\n            while (r-- > 0)\r\n                this._view.removeChild(this._view.firstChild);\r\n            this._model.removeLines(0, amt);\r\n        }\r\n    }\r\n\r\n    public append(txt: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this._model.append(txt, remote || false, force || false, prependSplit || false);\r\n    }\r\n\r\n    public CurrentAnsiCode() {\r\n        return this._model.CurrentAnsiCode();\r\n    }\r\n\r\n    public removeLine(line: number, noUpdate?: boolean) {\r\n        if (line < 0 || line >= this.lines.length) return;\r\n        this.emit('line-removed', line, this.lines[line].text);\r\n        const id = this._model.getLineID(line);\r\n        const elLine = this._view.querySelector(`[data-id=\"${id}\"]`);\r\n        this._view.removeChild(elLine);\r\n        this._model.removeLine(line);\r\n        this._doUpdate(UpdateType.split);\r\n    }\r\n\r\n    public removeLines(line: number, amt: number) {\r\n        if (line < 0 || line >= this.lines.length) return;\r\n        if (amt < 1) amt = 1;\r\n        this.emit('lines-removed', line, this.lines.slice(line, line + amt - 1));\r\n        this._view.replaceChildren(...[].slice.call(this._view.children, 0, line), ...[].slice.call(this._view.children, line + amt));\r\n        this._model.removeLines(line, amt);\r\n        this._doUpdate(UpdateType.split);\r\n    }\r\n\r\n    private _updateDisplay() {\r\n        //disable animation\r\n        this._view.classList.remove('animate');\r\n        this._doUpdate(UpdateType.trim);\r\n        if (this._hideTrailingEmptyLine && this.lines.length && this.lines[this.lines.length - 1].text.length === 0)\r\n            (<HTMLElement>this._view.lastChild).style.display = 'none';\r\n        this._doUpdate(UpdateType.scrollEnd | UpdateType.updateWindow | UpdateType.split);\r\n        //re-enable animation so they are all synced\r\n        this._view.classList.add('animate');\r\n    }\r\n\r\n    public updateWindow(width?, height?) {\r\n        if (width === undefined) {\r\n            width = this.WindowWidth;\r\n            height = this.WindowHeight;\r\n        }\r\n        this._model.updateWindow(width, height);\r\n        this.emit('update-window', width, height);\r\n    }\r\n\r\n    public clear() {\r\n        this._model.clear();\r\n        this._view.innerHTML = '';\r\n    }\r\n\r\n    public dispose() {\r\n        this._document.body.removeChild(this._character);\r\n        this._document.body.removeChild(this._styles);\r\n        while (this._container.firstChild)\r\n            this._view.removeChild(this._view.firstChild);\r\n        this._window.removeEventListener('resize', this._wResize);\r\n        this._window.removeEventListener('mouseup', this._wUp);\r\n        this._window.removeEventListener('mousemove', this._wMove);\r\n        this._document.removeEventListener('selectionchange', this._selectionChange);\r\n    }\r\n\r\n    private _update() {\r\n        this._maxView = this._view.clientWidth - this._padding[1] - this._padding[3] - this._verticalScrollBarHeight - this._indentPadding;\r\n        if (this._timestamp !== TimeStampStyle.None)\r\n            this._maxView -= this._timestampWidth * this._charWidth;\r\n        this._innerHeight = this._view.clientHeight;\r\n        this._bounds = this._view.getBoundingClientRect();\r\n    }\r\n\r\n    public updateFont(font?: string, size?: string) {\r\n        if (!font || font.length === 0)\r\n            font = '\"Courier New\", Courier, monospace';\r\n        else //fall back just incase\r\n            font += ', monospace';\r\n        if (!size || size.length === 0)\r\n            size = '1em';\r\n        if (font !== this._container.style.fontFamily || size !== this._container.style.fontSize) {\r\n            //set styles using raw javascript for minor speed\r\n            this._container.style.fontSize = size;\r\n            this._container.style.fontFamily = font;\r\n            this._character.style.fontSize = size;\r\n            this._character.style.fontFamily = font;\r\n            //recalculate height/width of characters so display can be calculated\r\n            this._charHeight = parseFloat(this._window.getComputedStyle(this._character).height);\r\n            this._charWidth = parseFloat(this._window.getComputedStyle(this._character.firstElementChild).width);\r\n            setTimeout(() => {\r\n                this._charHeight = parseFloat(this._window.getComputedStyle(this._character).height);\r\n                this._charWidth = parseFloat(this._window.getComputedStyle(this._character.firstElementChild).width);\r\n            }, 250);\r\n            this._buildStyleSheet();\r\n            this._doUpdate(UpdateType.scrollEnd | UpdateType.updateWindow | UpdateType.update);\r\n        }\r\n        const pc = this._window.getComputedStyle(this._view);\r\n        const padding = [\r\n            parseInt(pc.getPropertyValue('padding-top')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-right')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-bottom')) || 0,\r\n            parseInt(pc.getPropertyValue('padding-left')) || 0\r\n        ];\r\n        if (padding[0] !== this._padding[0] ||\r\n            padding[1] !== this._padding[1] ||\r\n            padding[2] !== this._padding[2] ||\r\n            padding[3] !== this._padding[3]\r\n        ) {\r\n            this._padding = padding;\r\n            this._doUpdate(UpdateType.update);\r\n        }\r\n    }\r\n\r\n    private _buildStyleSheet() {\r\n        let styles = ''; // `.background > span, .view > span, .line, .background-line { height: ${this._charHeight}px; line-height: ${this._charHeight - 2}px; }`;\r\n        if (!this._enableColors)\r\n            styles += '#' + this.id + ' .view > span span {color: inherit !important;}';\r\n        if (!this._enableColors || !this._enableBackgroundColors)\r\n            styles += '#' + this.id + ' .background > span span {background-color: inherit !important;}';\r\n        if (this._wordWrap)\r\n            styles += '#' + this.id + ' .view {white-space: break-spaces; }';\r\n        else if (this._wrapAt > 0)\r\n            styles += `#${this.id} .view {white-space: break-spaces; } .line {width: ${this._wrapAt * this._charWidth}px !important;max-width:  ${this._wrapAt * this._charWidth}px;min-width:  ${this._wrapAt * this._charWidth}px;display: block;}`\r\n        if ((this._wordWrap || this._wrapAt > 0) && this._indent > 0)\r\n            styles += `#${this.id} .view {  text-indent: ${this._indent * this._charWidth}px hanging; }`;\r\n        //styles += `.view { padding-left: ${this._indent * this._charWidth * 2}px;text-indent: -${this._indent * this._charWidth}px; }@-moz-document url-prefix() { .view {  padding-left: 0px !important; text-indent: ${this._indent * this._charWidth}px hanging; } }`;\r\n        styles += `#${this.id} .line > span { min-height: ${this._charHeight}}`;\r\n        if (this._timestamp !== TimeStampStyle.None)\r\n            styles += '#' + this.id + ' .timestamp { display: inline-block; }';\r\n        //else\r\n        //styles += '.timestamp { display: none !important; }';\r\n        this._styles.innerHTML = styles;\r\n        if ((this._wordWrap || this._wrapAt > 0) && this._indent > 0)\r\n            this._indentPadding = parseFloat(this._window.getComputedStyle(this._view).paddingLeft) / 2;\r\n        else\r\n            this._indentPadding = 0;\r\n    }\r\n\r\n    public getLineHTML(idx?: number, start?: number, len?: number, inner?: boolean) {\r\n        if (idx === undefined || idx >= this.lines.length)\r\n            idx = this.lines.length - 1;\r\n        else if (idx < 0)\r\n            idx = 0;\r\n        if (start === undefined || start < 0)\r\n            start = 0;\r\n        if (len === undefined || len === -1)\r\n            len = this.lines[idx].text.length;\r\n        const parts: string[] = [];\r\n        let offset = 0;\r\n        let style: any = '';\r\n        let fCls: any = '';\r\n        const text = this.lines[idx].text;\r\n        const formats = this.lines[idx].formats;\r\n        const fLen = formats.length;\r\n        let right = false;\r\n        const id = this._model.getLineID(idx);\r\n        if (this._timestamp === TimeStampStyle.Format && moment)\r\n            parts.push('<span class=\"timestamp\" style=\"color:', this._model.GetColor(-7), ';background:', this._model.GetColor(-8), ';\"', fCls, '>', moment(this.lines[idx].timestamp).format(this._timestampFormat), '</span>');\r\n        else if (this._timestamp !== TimeStampStyle.None)\r\n            parts.push('<span class=\"timestamp\" style=\"color:', this._model.GetColor(-7), ';background:', this._model.GetColor(-8), ';\"', fCls, '>', new Date(this.lines[idx].timestamp).toISOString(), ' </span>');\r\n        for (let f = 0; f < fLen; f++) {\r\n            const format = formats[f];\r\n            let nFormat;\r\n            let end;\r\n            const td: string[] = [];\r\n            //let oSize;\r\n            //let oFont;\r\n            if (f < fLen - 1) {\r\n                nFormat = formats[f + 1];\r\n                //skip empty blocks\r\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                    continue;\r\n                end = nFormat.offset;\r\n            }\r\n            else\r\n                end = text.length;\r\n            offset = format.offset;\r\n\r\n            if (end > len)\r\n                end = len;\r\n            if (offset < start)\r\n                offset = start;\r\n\r\n            if (format.formatType === FormatType.Normal) {\r\n                style = [];\r\n                fCls = [];\r\n                if (typeof format.background === 'number')\r\n                    style.push('background:', this._model.GetColor(format.background), ';');\r\n                else if (format.background)\r\n                    style.push('background:', format.background, ';');\r\n                if (typeof format.color === 'number')\r\n                    style.push('color:', this._model.GetColor(format.color), ';');\r\n                else if (format.color)\r\n                    style.push('color:', format.color, ';');\r\n                if (format.font)\r\n                    style.push('font-family: ', format.font, ';');\r\n                if (format.size)\r\n                    style.push('font-size: ', format.size, ';');\r\n                if (format.style !== FontStyle.None) {\r\n                    if ((format.style & FontStyle.Bold) === FontStyle.Bold)\r\n                        style.push('font-weight: bold;');\r\n                    if ((format.style & FontStyle.Italic) === FontStyle.Italic)\r\n                        style.push('font-style: italic;');\r\n                    if ((format.style & FontStyle.Overline) === FontStyle.Overline)\r\n                        td.push('overline ');\r\n                    if ((format.style & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline || (format.style & FontStyle.Underline) === FontStyle.Underline)\r\n                        td.push('underline ');\r\n                    if ((format.style & FontStyle.DoubleUnderline) === FontStyle.DoubleUnderline)\r\n                        style.push('border-bottom: 1px solid ', (typeof format.color === 'number' ? this._model.GetColor(format.color) : format.color), ';');\r\n                    else\r\n                        //style.push('padding-bottom: 1px;');\r\n                        style.push('border-bottom: 1px solid ', (typeof format.background === 'number' ? this._model.GetColor(format.background) : format.background), ';');\r\n                    if ((format.style & FontStyle.Rapid) === FontStyle.Rapid || (format.style & FontStyle.Slow) === FontStyle.Slow) {\r\n                        if (this.enableFlashing)\r\n                            fCls.push(' ansi-blink');\r\n                        else if ((format.style & FontStyle.DoubleUnderline) !== FontStyle.DoubleUnderline && (format.style & FontStyle.Underline) !== FontStyle.Underline)\r\n                            td.push('underline ');\r\n                    }\r\n                    if ((format.style & FontStyle.Strikeout) === FontStyle.Strikeout)\r\n                        td.push('line-through ');\r\n                    if (td.length > 0)\r\n                        style.push('text-decoration:', td.join('').trim(), ';');\r\n                }\r\n                else\r\n                    style.push('border-bottom: 1px solid ', (typeof format.background === 'number' ? this._model.GetColor(format.background) : format.background), ';');\r\n                //style.push('padding-bottom: 1px;');\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                style = style.join('').trim();\r\n                if (fCls.length !== 0)\r\n                    fCls = ' class=\"' + fCls.join('').trim() + '\"';\r\n                else\r\n                    fCls = '';\r\n                if (format.hr)\r\n                    parts.push('<span style=\"', style, 'min-width:100%;width:100%;\"', fCls, '><div style=\"position:relative;top: 50%;transform: translateY(-50%);height:4px;width:100%; background-color:', (typeof format.color === 'number' ? this._model.GetColor(format.color) : format.color), '\"></div></span>');\r\n                else if (end - offset !== 0)\r\n                    parts.push('<span style=\"', style, '\"', fCls, '>', htmlEncode(text.substring(offset, end)), '</span>');\r\n            }\r\n            else if (format.formatType === FormatType.Link) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"URLLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.href.replace(/\"/g, '&quot;'));\r\n                parts.push('\" onclick=\"', this.linkFunction, '(\\'', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), '\\');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.LinkEnd || format.formatType === FormatType.MXPLinkEnd || format.formatType === FormatType.MXPSendEnd) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('</a>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPLink) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"MXPLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.href.replace(/\"/g, '&quot;'));\r\n                parts.push('\"');\r\n                if (format.expire && format.expire.length)\r\n                    parts.push(` data-expire=\"${format.expire}\"`);\r\n                parts.push(' onclick=\"', this.mxpLinkFunction, '(this, \\'', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), '\\');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPSend) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<a draggable=\"false\" class=\"MXPLink\" href=\"javascript:void(0);\" title=\"');\r\n                parts.push(format.hint.replace(/\"/g, '&quot;'));\r\n                parts.push('\"');\r\n                if (format.expire && format.expire.length)\r\n                    parts.push(` data-expire=\"${format.expire}\"`);\r\n                parts.push(' onmouseover=\"', this.mxpTooltipFunction, '(this);\"');\r\n                parts.push(' onclick=\"', this.mxpSendFunction, '(event||window.event, this, ', format.href.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), ', ', format.prompt ? '1' : '0', ', ', format.tt.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '&quot;'), ');return false;\">');\r\n                if (end - offset === 0) continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.MXPExpired && end - offset !== 0) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                parts.push('<span style=\"', style, '\"', fCls, '>');\r\n                parts.push(htmlEncode(text.substring(offset, end)));\r\n                parts.push('</span>');\r\n            }\r\n            else if (format.formatType === FormatType.Image) {\r\n                if (offset < start || end < start)\r\n                    continue;\r\n                let tmp = '';\r\n                parts.push('<img src=\"');\r\n                if (format.url.length > 0) {\r\n                    parts.push(format.url);\r\n                    tmp += format.url;\r\n                    if (!format.url.endsWith('/')) {\r\n                        parts.push('/');\r\n                        tmp += '/';\r\n                    }\r\n                }\r\n                if (format.t.length > 0) {\r\n                    parts.push(format.t);\r\n                    tmp += format.t;\r\n                    if (!format.t.endsWith('/')) {\r\n                        parts.push('/');\r\n                        tmp += '/';\r\n                    }\r\n                }\r\n                tmp += format.name;\r\n                parts.push(format.name, '\"  style=\"');\r\n                if (format.w.length > 0)\r\n                    parts.push('width:', formatUnit(format.w, this._charWidth), ';');\r\n                if (format.h.length > 0)\r\n                    parts.push('height:', formatUnit(format.h, this._charHeight), ';');\r\n                switch (format.align.toLowerCase()) {\r\n                    case 'left':\r\n                        parts.push('float:left;');\r\n                        break;\r\n                    case 'right':\r\n                        parts.push('float:right;');\r\n                        right = true;\r\n                        break;\r\n                    case 'top':\r\n                    case 'middle':\r\n                    case 'bottom':\r\n                        parts.push('vertical-align:', format.align, ';');\r\n                        break;\r\n                }\r\n                if (format.hspace.length > 0 && format.vspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push(formatUnit(format.vspace, this._charWidth), ' ');\r\n                    parts.push(formatUnit(format.hspace, this._charHeight), ';');\r\n                }\r\n                else if (format.hspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push('0px ', formatUnit(format.hspace, this._charHeight), ';');\r\n                }\r\n                else if (format.vspace.length > 0) {\r\n                    parts.push('margin:');\r\n                    parts.push(formatUnit(format.vspace, this._charWidth), ' 0px;');\r\n                }\r\n                parts.push('\"');\r\n                if (format.ismap) parts.push(' ismap onclick=\"return false;\"');\r\n                parts.push(`src=\"${tmp}\"/>`);\r\n            }\r\n        }\r\n        if (inner) {\r\n            if (right && len < this.lines[idx].text.length)\r\n                return parts.join('');\r\n            if (right)\r\n                return parts.join('') + '<br>\\n';\r\n            if (len < this.lines[idx].text.length)\r\n                return parts.join('');\r\n            return parts.join('') + '<br>\\n';\r\n        }\r\n        if (right && len < this.lines[idx].text.length)\r\n            return `<span data-id=\"${id}\" class=\"line\" style=\"min-width:100%\">${parts.join('')}</span>`;\r\n        if (right)\r\n            return `<span data-id=\"${id}\" class=\"line\" style=\"min-width:100%\">${parts.join('')}<br>\\n</span>`;\r\n        if (len < this.lines[idx].text.length)\r\n            return `<span data-id=\"${id}\" class=\"line\">${parts.join('')}</span>`;\r\n        return `<span data-id=\"${id}\" class=\"line\">${parts.join('')}<br>\\n</span>`;\r\n    }\r\n\r\n    public getLineText(line, full?: boolean) {\r\n        //if line out of range, or if for what ever reason the line is missing data return empty string\r\n        if (line < 0 || line >= this.lines.length || !this.lines[line]) return '';\r\n        //get line from id in case lines where removed\r\n        return this.lines[line].text;\r\n    }\r\n\r\n    private _rebuildLine(start: number) {\r\n        this._rebuildLines(start, start);\r\n    }\r\n\r\n    private _rebuildLines(start?: number, end?: number) {\r\n        if (!this.lines.length) return;\r\n        if (start === undefined || start < 0)\r\n            start = 0;\r\n        if (end === undefined || end === -1 || end >= this.lines.length)\r\n            end = this.lines.length - 1;\r\n        let _html = [];\r\n        let line = start;\r\n        for (; line <= end; line++) {\r\n            _html.push(this.getLineHTML(line));\r\n        }\r\n\r\n        //if all lines can speed up and reduce load by setting all view at once\r\n        if (start === 0 && end === this.lines.length - 1)\r\n            this._view.innerHTML = _html.join('');\r\n        //if selection of lines will need to update each line one at atime to not break other lines\r\n        else {\r\n            this._view.replaceChildren(...[].slice.call(this._view.children, 0, start), ...[].slice.call(this._view.children, end + 1));\r\n            if (start === 0)\r\n                this._view.firstElementChild.insertAdjacentHTML('beforebegin', _html.join(''));\r\n            else {\r\n                this._view.children[start - 1].insertAdjacentHTML('afterend', _html.join(''));\r\n            }\r\n        }\r\n    }\r\n\r\n    private _doUpdate(type?: UpdateType) {\r\n        if (!type) return;\r\n        this._updating |= type;\r\n        if (this._updating === UpdateType.none)\r\n            return;\r\n        this._window.requestAnimationFrame(() => {\r\n            if (this._updating === UpdateType.none)\r\n                return;\r\n            if ((this._updating & UpdateType.rebuildLines) === UpdateType.rebuildLines) {\r\n                this._rebuildLines();\r\n                this._updating &= ~UpdateType.rebuildLines;\r\n            }\r\n            if ((this._updating & UpdateType.update) === UpdateType.update) {\r\n                this._update();\r\n                this._updating &= ~UpdateType.update;\r\n            }\r\n            if ((this._updating & UpdateType.display) === UpdateType.display) {\r\n                this._updateDisplay();\r\n                this._updating &= ~UpdateType.display;\r\n            }\r\n            if ((this._updating & UpdateType.trim) === UpdateType.trim) {\r\n                this.trimLines();\r\n                this._updating &= ~UpdateType.trim;\r\n            }\r\n            if ((this._updating & UpdateType.scrollEnd) === UpdateType.scrollEnd) {\r\n                this.scrollDisplay();\r\n                this._updating &= ~UpdateType.scrollEnd;\r\n            }\r\n            if ((this._updating & UpdateType.updateWindow) === UpdateType.updateWindow) {\r\n                this.updateWindow();\r\n                this._updating &= ~UpdateType.updateWindow;\r\n            }\r\n            if ((this._updating & UpdateType.split) === UpdateType.split) {\r\n                this._updateSplit();\r\n                this._updating &= ~UpdateType.split;\r\n            }\r\n            if ((this._updating & UpdateType.toggleSplit) === UpdateType.toggleSplit) {\r\n                this._toggleSplit();\r\n                this._updating &= ~UpdateType.toggleSplit;\r\n            }\r\n            this._doUpdate(this._updating);\r\n        });\r\n    }\r\n\r\n    public colorSubStrByLine(idx: number, fore, back?, start?: number, len?: number, style?: FontStyle) {\r\n        this.colorSubStringByLine(idx, fore, back, start, (start || 0) + (len || 0), style);\r\n    }\r\n\r\n    public colorSubStringByLine(idx: number, fore, back?, start?: number, end?: number, style?: FontStyle) {\r\n        //only update if something changed\r\n        if (!this._model.colorSubStringByLine(idx, fore, back, start, end, style))\r\n            return;\r\n        this._rebuildLine(idx);\r\n    }\r\n\r\n    public removeStyleSubStrByLine(idx: number, style: FontStyle, start?: number, len?: number) {\r\n        this.removeStyleSubStringByLine(idx, style, start, (start || 0) + (len || 0));\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public removeStyleSubStringByLine(idx: number, style: FontStyle, start?: number, end?: number) {\r\n        //only update if something changed\r\n        if (!this._model.removeStyleSubStringByLine(idx, style, start, end))\r\n            return;\r\n        this._rebuildLine(idx);\r\n    }\r\n\r\n    public highlightSubStrByLine(idx: number, start?: number, len?: number) {\r\n        this.highlightStyleSubStringByLine(idx, start, (start || 0) + (len || 0));\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public highlightStyleSubStringByLine(idx: number, start?: number, end?: number, color?: boolean) {\r\n        //only update if something changed\r\n        if (!this._model.highlightStyleSubStringByLine(idx, start, end, color))\r\n            return;\r\n        this._rebuildLine(idx);\r\n    }\r\n\r\n    public SetColor(code: number, color) {\r\n        this._model.SetColor(code, color);\r\n    }\r\n\r\n    public ClearMXP() {\r\n        this._model.ClearMXP();\r\n    }\r\n\r\n    public ResetMXPLine() {\r\n        this._model.ResetMXPLine();\r\n    }\r\n\r\n    get hasSelection(): boolean {\r\n        if (!this.customSelection) {\r\n            const selection = this._window.getSelection();\r\n            if (selection.rangeCount > 0) {\r\n                const range = selection.getRangeAt(0);\r\n                return this._view.contains(range.commonAncestorContainer) && selection.toString().length !== 0;\r\n            }\r\n        }\r\n        else if (this._selection.start)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    get selection(): string {\r\n        if (!this.customSelection) {\r\n            const selection = this._window.getSelection();\r\n            if (selection.rangeCount > 0) {\r\n                const range = selection.getRangeAt(0);\r\n                if (this._view.contains(range.startContainer) || this._view.contains(range.endContainer)) {\r\n                    return selection.toString();\r\n                }\r\n            }\r\n        }\r\n        if (!this.hasSelection) return '';\r\n        const range = this._document.createRange();\r\n        if (this._split && this._split.visible)\r\n            this._adjustSplitSelection(this._view, this._split._view);\r\n        range.setStart(this._selection.start.node, this._selection.start.offset);\r\n        range.setEnd(this._selection.end.node, this._selection.end.offset);\r\n        if (this._split && this._split.visible)\r\n            this._adjustSplitSelection(this._split._view, this._view);\r\n        return range.toString();\r\n    }\r\n\r\n    get selectionAsHTML(): string {\r\n        if (!this.customSelection) {\r\n            let selection = this._window.getSelection();\r\n            if (selection.rangeCount > 0) {\r\n                let range = selection.getRangeAt(0);\r\n                if (!this._view.contains(range.startContainer) && !this._view.contains(range.endContainer))\r\n                    return '';\r\n                let clonedSelection = range.cloneContents();\r\n                let div = this._document.createElement('div');\r\n                div.appendChild(clonedSelection);\r\n                return div.innerHTML;\r\n            }\r\n            return '';\r\n        }\r\n        if (!this.hasSelection) return '';\r\n        const range = this._document.createRange();\r\n        if (this._split && this._split.visible)\r\n            this._adjustSplitSelection(this._view, this._split._view);\r\n        range.setStart(this._selection.start.node, this._selection.start.offset);\r\n        range.setEnd(this._selection.end.node, this._selection.end.offset);\r\n        if (this._split && this._split.visible)\r\n            this._adjustSplitSelection(this._split._view, this._view);\r\n        let clonedSelection = range.cloneContents();\r\n        let div = this._document.createElement('div');\r\n        div.appendChild(clonedSelection);\r\n        return div.innerHTML;\r\n    }\r\n\r\n    public selectAll() {\r\n        let range;\r\n        if (this._window.getSelection) {\r\n            range = document.createRange();\r\n            range.setStart(this._view.firstChild, 0);\r\n            range.setEnd(this._view.lastChild, this._view.lastChild.childNodes.length);\r\n            this._window.getSelection().removeAllRanges();\r\n            this._window.getSelection().addRange(range);\r\n        }\r\n        if (this.customSelection) {\r\n            this._selection = {\r\n                start: {\r\n                    node: this._view.firstChild,\r\n                    offset: 0\r\n                },\r\n                end: {\r\n                    node: this._view.lastChild,\r\n                    offset: this._view.lastChild.childNodes.length\r\n                },\r\n                timer: null\r\n            }\r\n            if (this._split && this._split.visible)\r\n                this._adjustSplitSelection(this._split._view, this._view);\r\n            this._updateSelectionHighlight();\r\n        }\r\n        this.emit('selection-changed', this._window.getSelection());\r\n    }\r\n\r\n    public clearSelection() {\r\n        const selection = this._window.getSelection();\r\n        if (selection.rangeCount > 0) {\r\n            const range = selection.getRangeAt(0);\r\n            if (this._view.contains(range.startContainer) || this._view.contains(range.endContainer)) {\r\n                selection.removeAllRanges();\r\n            }\r\n        }\r\n        this._selection = { start: null, end: null, timer: null };\r\n        this._updateSelectionHighlight();\r\n        this.emit('selection-changed', this._window.getSelection());\r\n    }\r\n\r\n    public getLineOffset(x, y): Point {\r\n        const elements = this._document.elementsFromPoint(x, y);\r\n        let element;\r\n        for (let e = 0, el = elements.length; e < el; e++) {\r\n            if (this._view === elements[e]) break;\r\n            if (this._view.contains(elements[e])) {\r\n                element = elements[e];\r\n                break;\r\n            }\r\n        }\r\n        //not in view so fail\r\n        if (!element || !this._view.contains(element) && this._view != element)\r\n            return { x: -1, y: -1, lineID: -1 };\r\n        if (element.classList.contains('line'))\r\n            return { x: 0, y: this.model.getLineFromID(+element.dataset.id), lineID: +element.dataset.id };\r\n        const line = element.closest('.line') as HTMLElement;\r\n        if (line)\r\n            return { x: 0, y: this.model.getLineFromID(+line.dataset.id), lineID: +line.dataset.id };\r\n        return { x: -1, y: -1, lineID: -1 };\r\n    }\r\n\r\n    public getWordFromPosition(x, y): string {\r\n        // Get the element at the specified coordinates\r\n        const elements = this._document.elementsFromPoint(x, y);\r\n        let element;\r\n        for (let e = 0, el = elements.length; e < el; e++) {\r\n            if (this._view === elements[e]) return '';\r\n            if (this._view.contains(elements[e])) {\r\n                element = elements[e];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Check if the element exists and contains text\r\n        if (element && element.textContent) {\r\n            // Get the text content of the element\r\n            const text = element.textContent;\r\n\r\n            // Find the word boundaries around the specified position\r\n            let start = text.lastIndexOf(' ', x) + 1;\r\n            let end = text.indexOf(' ', x);\r\n            if (end === -1) {\r\n                end = text.length;\r\n            }\r\n\r\n            // Extract the word\r\n            const word = text.substring(start, end);\r\n\r\n            return word;\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    private _updateSplit() {\r\n        if (!this._split || this._view.clientHeight >= this._view.scrollHeight) return;\r\n        let ll = this.lines.length;\r\n        //no height line to ensure scroll width\r\n        let lines = [];\r\n        for (let l = ll - this.WindowHeight; l < ll; l++)\r\n            lines.push(this.getLineHTML(l));\r\n        //lines.push(`<span style=\"width: ${this._view.scrollWidth}px;display: inline-block;\"></span>`);\r\n        this._split._view.classList.remove('animate');\r\n        this._split._view.innerHTML = lines.join('');\r\n        this._split._view.firstChild.style.width = this._view.scrollWidth + 'px';\r\n        if (this._hideTrailingEmptyLine && this.lines.length && this.lines[this.lines.length - 1].text.length === 0)\r\n            this._split._view.lastChild.style.display = 'none';\r\n        this._updateSplitLocation();\r\n        this._split._view.classList.add('animate');\r\n        this._split._view.scrollTop = this._split._view.scrollHeight;\r\n        this._split._bar.style.top = (this._view.clientHeight - this._split._view.clientHeight) + 'px';\r\n    }\r\n\r\n    private _updateSplitLocation() {\r\n        if (!this._split) return;\r\n        this._split._view.style.top = this._splitHeight + 'px';\r\n        if (this._view.scrollWidth > this._view.clientWidth)\r\n            this._split._view.style.bottom = this._horizontalScrollBarHeight + 'px';\r\n        else\r\n            this._split._view.style.bottom = '';\r\n        this._split._bounds = this._split._view.getBoundingClientRect();\r\n    }\r\n\r\n    private _toggleSplit() {\r\n        if (!this._split) return;\r\n        if (this._view.clientHeight + this._view.scrollTop >= this._view.scrollHeight) {\r\n            //only adjust if not already hidden\r\n            if (this._split.visible) {\r\n                this._split._view.style.visibility = 'hidden';\r\n                this._split._bar.style.display = 'none';\r\n                this._split.visible = false;\r\n                //if selected text in split adjust end container\r\n                this._adjustSplitSelection(this._view, this._split._view);\r\n                this.emit('scroll-lock', false);\r\n            }\r\n        }\r\n        else {\r\n            this._split._view.scrollTop = this._split._view.scrollHeight;\r\n            this._split._view.scrollLeft = this._view.scrollLeft;\r\n            //only adjust if not visible\r\n            if (!this._split.visible) {\r\n                this._split._view.style.visibility = 'visible';\r\n                this._split._bar.style.display = 'block';\r\n                this._split._bar.style.top = (this._view.clientHeight - this._split._view.clientHeight) + 'px';\r\n                this._split.visible = true;\r\n                this._split._bounds = this._split._view.getBoundingClientRect();\r\n                this._adjustSplitSelection(this._split._view, this._view);\r\n                this.emit('scroll-lock', true);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _adjustSplitSelection(target, source) {\r\n        const selection = this._window.getSelection();\r\n        let range\r\n        if (selection.isCollapsed || selection.rangeCount === 0) {\r\n            if (!this._selection.start)\r\n                return;\r\n            else {\r\n                range = this._document.createRange();\r\n                range.setStart(this._selection.start.node, this._selection.start.offset);\r\n                range.setEnd(this._selection.end.node, this._selection.end.offset);\r\n            }\r\n        }\r\n        else\r\n            range = selection.getRangeAt(0);\r\n\r\n        let so = range.startOffset;\r\n        let eo = range.endOffset;\r\n        let eElement = this._getElement(target, source, range.endContainer);\r\n        let sElement = this._getElement(target, source, range.startContainer);\r\n        //test if element is visible in split\r\n        if (eElement && this._isElementVisible(eElement, target)) {\r\n            range.setEnd(eElement, eo);\r\n            this._selection.end = { node: eElement, offset: eo };\r\n        }\r\n        else if (!eElement && this._selection.start) {\r\n            eElement = this._getElement(target, source, this._selection.end.node);\r\n            eo = this._selection.end.offset;\r\n            if (eElement && this._isElementVisible(eElement, target))\r\n                this._selection.end = { node: eElement, offset: eo };\r\n        }\r\n        if (sElement && this._isElementVisible(sElement, target)) {\r\n            range.setStart(sElement, so);\r\n            this._selection.start = { node: sElement, offset: so };\r\n        }\r\n        else if (!sElement && this._selection.start) {\r\n            sElement = this._getElement(target, source, this._selection.start.node);\r\n            so = this._selection.start.offset;\r\n            if (eElement && this._isElementVisible(sElement, target))\r\n                this._selection.start = { node: sElement, offset: so };\r\n        }\r\n        this._updateSelectionHighlight();\r\n    }\r\n\r\n    private _getMouseEventCaretRange(evt) {\r\n        var range, x = evt.clientX, y = evt.clientY;\r\n\r\n        // Try the simple IE way first\r\n        if ((<any>document.body).createTextRange) {\r\n            range = (<any>document.body).createTextRange();\r\n            range.moveToPoint(x, y);\r\n        }\r\n\r\n        else if (typeof document.createRange != \"undefined\" && document.createRange !== null) {\r\n            // Try Mozilla's rangeOffset and rangeParent properties,\r\n            // which are exactly what we want\r\n            if (typeof evt.rangeParent != \"undefined\" && evt.rangeParent !== null) {\r\n                range = document.createRange();\r\n                range.setStart(evt.rangeParent, evt.rangeOffset);\r\n                range.collapse(true);\r\n            }\r\n\r\n            // Try the standards-based way next\r\n            else if ((<any>document.body).caretPositionFromPoint) {\r\n                var pos = (<any>document.body).caretPositionFromPoint(x, y);\r\n                range = document.createRange();\r\n                range.setStart(pos.offsetNode, pos.offset);\r\n                range.collapse(true);\r\n            }\r\n\r\n            // Next, the WebKit way\r\n            else if (document.caretRangeFromPoint) {\r\n                range = document.caretRangeFromPoint(x, y);\r\n            }\r\n        }\r\n\r\n        return range;\r\n    }\r\n\r\n    private _getElement(target, source, node) {\r\n        let id = -1;\r\n        let element;\r\n        let tree\r\n        let idx;\r\n        //already extended so no need\r\n        if (!target.contains(node)) {\r\n            tree = [{ node: node, idx: -1 }];\r\n            element = node;\r\n            while (element && element.parentNode && source.contains(element) && source.contains(element.parentNode) && (!element.classList || !element.classList.contains('line'))) {\r\n                tree.push({ node: element.parentNode, idx: Array.from(element.parentNode.childNodes).indexOf(element) })\r\n                element = element.parentNode;\r\n            }\r\n            idx = tree.length - 1;\r\n            if (tree[idx].node && tree[idx].node.dataset)\r\n                id = tree[idx].node.dataset.id;\r\n            if (element = target.querySelector(`[data-id=\"${id}\"]`)) {\r\n                for (; idx > 0; idx--) {\r\n                    element = element.childNodes[tree[idx].idx];\r\n                }\r\n                return element;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private _isElementVisible(element, container) {\r\n        if (!element || !container) return false;\r\n        if (!container.contains(element)) return false;\r\n        let elRect;\r\n        if (element.nodeType === 3) {\r\n            if (element.parentNode.style.display === 'none') return true;\r\n            elRect = element.parentNode.getBoundingClientRect();\r\n        }\r\n        else {\r\n            if (element.style.display === 'none') return true;\r\n            elRect = element.getBoundingClientRect();\r\n        }\r\n        const conRect = container.getBoundingClientRect();\r\n        if (elRect.y >= conRect.y)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    private _getNodeOffset(view, node, container, containerOffset, range) {\r\n        if (view.contains(container) || node === container)\r\n            return { node: container, offset: containerOffset };\r\n        else if (node && range.intersectsNode(node))\r\n            return { node: node, offset: 0 };\r\n        return null;\r\n    }\r\n\r\n    private _updateSelectionHighlight() {\r\n        if (!('Highlight' in window)) return;\r\n        if (!this._selection.start || !this.customSelection) {\r\n            if (this._highlightRange) {\r\n                this._highlight.delete(this._highlightRange);\r\n                this._highlightRange = null;\r\n            }\r\n            if (!this.customSelection && this._highlight) {\r\n                CSS.highlights.delete('oiMUD-selection');\r\n                this._highlight = null;\r\n            }\r\n            return;\r\n        }\r\n        this._highlight = this._highlight || CSS.highlights.get('oiMUD-selection');\r\n        if (!this._highlight) {\r\n            this._highlight = new Highlight();\r\n            CSS.highlights.set('oiMUD-selection', this._highlight);\r\n        }\r\n        if (!this._highlightRange) {\r\n            this._highlightRange = this._document.createRange();\r\n            this._highlight.add(this._highlightRange);\r\n        }\r\n        this._highlightRange.setStart(this._selection.start.node, this._selection.start.offset);\r\n        if(this._selection.end)\r\n            this._highlightRange.setEnd(this._selection.end.node, this._selection.end.offset);\r\n        else\r\n            this._highlightRange.setEnd(this._selection.start.node, this._selection.start.offset);\r\n\r\n    }\r\n\r\n    private _extendSelection(e) {\r\n        let caret = this._getMouseEventCaretRange(e);\r\n        if (!caret) return;\r\n        if (caret.startContainer) {\r\n            if (this._window.getSelection().rangeCount === 0) {\r\n                let range = this._document.createRange();\r\n                range.setStart(caret.startContainer, caret.startOffset);\r\n                range.setEnd(caret.startContainer, caret.startOffset);\r\n                this._window.getSelection().addRange(range);\r\n            }\r\n            else\r\n                this._window.getSelection().extend(caret.endContainer, caret.endOffset);\r\n        }\r\n        else if (caret.offsetNode) {\r\n            if (this._window.getSelection().rangeCount === 0) {\r\n                let range = this._document.createRange();\r\n                range.setStart(caret.offsetNode, caret.offset);\r\n                range.setEnd(caret.offsetNode, caret.offset);\r\n                this._window.getSelection().addRange(range);\r\n            }\r\n            else\r\n                this._window.getSelection().extend(caret.offsetNode, caret.offset);\r\n        }\r\n    }\r\n\r\n    private _clearMouseDown() {\r\n        if (this._mouseDown)\r\n            this.emit('selection-done');\r\n        this._mouseDown = 0;\r\n        if (this._split)\r\n            this._split._bar.style.pointerEvents = '';\r\n        this._clearScrollTimer();\r\n    }\r\n\r\n    private _clearScrollTimer() {\r\n        if (this.customSelection || this._selection.timer) {\r\n            clearInterval(this._selection.timer);\r\n            this._selection.timer = null;\r\n        }\r\n    }\r\n\r\n    private _createScrollTimer() {\r\n        if (!this.customSelection) return;\r\n        var bounds = this._bounds;\r\n        var viewportX = this._lastMouse.clientX;\r\n        var viewportY = this._lastMouse.clientY;\r\n        var viewportWidth = this._view.clientWidth;\r\n        var viewportHeight = this._view.clientHeight;\r\n        var edgeSize = 20\r\n        var edgeTop = bounds.top + edgeSize;\r\n        var edgeLeft = bounds.left + edgeSize;\r\n        var edgeBottom = bounds.top + (viewportHeight - edgeSize);\r\n        var edgeRight = bounds.left + (viewportWidth - edgeSize);\r\n\r\n        var isInLeftEdge = (viewportX < edgeLeft);\r\n        var isInRightEdge = (viewportX > edgeRight);\r\n        var isInTopEdge = (viewportY < edgeTop);\r\n        var isInBottomEdge = (viewportY > edgeBottom);\r\n        if (!(isInLeftEdge || isInRightEdge || isInTopEdge || isInBottomEdge)) {\r\n            this._clearScrollTimer();\r\n            return;\r\n        }\r\n        var viewWidth = Math.max(\r\n            this._view.scrollWidth,\r\n            this._view.offsetWidth,\r\n            this._view.clientWidth\r\n        );\r\n        var viewHeight = Math.max(\r\n            this._view.scrollHeight,\r\n            this._view.offsetHeight,\r\n            this._view.clientHeight\r\n        );\r\n        var maxScrollX = (viewWidth - viewportWidth);\r\n        var maxScrollY = (viewHeight - viewportHeight);\r\n        var _display = this;\r\n        var _selection = this._selection;\r\n        var _view = this._view;\r\n        (function checkForViewScroll() {\r\n            clearTimeout(_selection.timer);\r\n            if (_adjustViewScroll()) {\r\n                _selection.timer = setTimeout(checkForViewScroll, 30);\r\n            }\r\n        })();\r\n\r\n        function _adjustViewScroll() {\r\n\r\n            // Get the current scroll position of the document.\r\n            var currentScrollX = _view.scrollLeft;\r\n            var currentScrollY = _view.scrollTop;\r\n\r\n            // Determine if the window can be scrolled in any particular direction.\r\n            var canScrollUp = (currentScrollY > 0);\r\n            var canScrollDown = (currentScrollY < maxScrollY);\r\n            var canScrollLeft = (currentScrollX > 0);\r\n            var canScrollRight = (currentScrollX < maxScrollX);\r\n\r\n            // Since we can potentially scroll in two directions at the same time,\r\n            // let's keep track of the next scroll, starting with the current scroll.\r\n            // Each of these values can then be adjusted independently in the logic\r\n            // below.\r\n            var nextScrollX = currentScrollX;\r\n            var nextScrollY = currentScrollY;\r\n\r\n            // As we examine the mouse position within the edge, we want to make the\r\n            // incremental scroll changes more \"intense\" the closer that the user\r\n            // gets the viewport edge. As such, we'll calculate the percentage that\r\n            // the user has made it \"through the edge\" when calculating the delta.\r\n            // Then, that use that percentage to back-off from the \"max\" step value.\r\n            var maxStep = 50;\r\n\r\n            // Should we scroll left?\r\n            if (isInLeftEdge && canScrollLeft) {\r\n                var intensity = ((edgeLeft - viewportX) / edgeSize);\r\n                nextScrollX = (nextScrollX - (maxStep * intensity));\r\n                // Should we scroll right?\r\n            } else if (isInRightEdge && canScrollRight) {\r\n                var intensity = ((viewportX - edgeRight) / edgeSize);\r\n                nextScrollX = (nextScrollX + (maxStep * intensity));\r\n            }\r\n\r\n            // Should we scroll up?\r\n            if (isInTopEdge && canScrollUp) {\r\n                var intensity = ((edgeTop - viewportY) / edgeSize);\r\n                nextScrollY = (nextScrollY - (maxStep * intensity));\r\n                // Should we scroll down?\r\n            } else if (isInBottomEdge && canScrollDown) {\r\n                var intensity = ((viewportY - edgeBottom) / edgeSize);\r\n                nextScrollY = (nextScrollY + (maxStep * intensity));\r\n            }\r\n            nextScrollX = Math.max(0, Math.min(maxScrollX, nextScrollX));\r\n            nextScrollY = Math.max(0, Math.min(maxScrollY, nextScrollY));\r\n            if (\r\n                (nextScrollX !== currentScrollX) ||\r\n                (nextScrollY !== currentScrollY)\r\n            ) {\r\n                _display.scrollTo(nextScrollX, nextScrollY);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        /*\r\n        this._currentSelection.scrollTimer = setInterval(() => {\r\n            /// pull as long as you can scroll either direction\r\n\r\n            if (!this._lastMouse) {\r\n                clearInterval(this._currentSelection.scrollTimer);\r\n                this._currentSelection.scrollTimer = null;\r\n                return;\r\n            }\r\n            const os = this._os;\r\n            let x = this._lastMouse.pageX - os.left;\r\n            let y = this._lastMouse.pageY - os.top;\r\n\r\n            if (y <= 0 && this._VScroll.position > 0) {\r\n                y = -1 * this._charHeight;\r\n                this._currentSelection.end.y--;\r\n            }\r\n            else if (y >= this._innerHeight && this._VScroll.position < this._VScroll.scrollSize) {\r\n                y = this._charHeight;\r\n                this._currentSelection.end.y++;\r\n                if (this._lines.length === 0)\r\n                    this._currentSelection.end.x = 0;\r\n                else if (this._currentSelection.end.y >= this._lines.length)\r\n                    this._currentSelection.end.x = this.getLineText(this._lines.length - 1).length;\r\n            }\r\n            else\r\n                y = 0;\r\n\r\n            if (x < 0 && this._HScroll.position > 0) {\r\n                x = -1 * this._charWidth;\r\n                this._currentSelection.end.x--;\r\n            }\r\n            else if (x >= this._innerWidth && this._HScroll.position < this._HScroll.scrollSize) {\r\n                x = this._charWidth;\r\n                this._currentSelection.end.x++;\r\n            }\r\n            else if (x > 0 && this._currentSelection.end.y >= this._lines.length) {\r\n                x = 0;\r\n                if (this._lines.length === 0)\r\n                    this._currentSelection.end.x = 0;\r\n                else\r\n                    this._currentSelection.end.x = this.getLineText(this.lines.length - 1).length;\r\n            }\r\n            else {\r\n                x = 0;\r\n                this._currentSelection.end.x = 0;\r\n            }\r\n            if (this._lines.length === 0) {\r\n                this._currentSelection.end.lineID = null;\r\n                this._currentSelection.end.lineOffset = null;\r\n            }\r\n            else if (this._currentSelection.end.y >= this._lines.length) {\r\n                this._currentSelection.end.lineID = this._lines[this._lines.length - 1].id;\r\n                this._currentSelection.end.lineOffset = this._lines[this._lines.length - 1].endOffset;\r\n            }\r\n            else {\r\n                this._currentSelection.end.lineID = this._lines[this._currentSelection.end.y].id;\r\n            }\r\n            if (x === 0 && y === 0)\r\n                return;\r\n\r\n            this.emit('selection-changed');\r\n            this._VScroll.scrollBy(y);\r\n            this._HScroll.scrollBy(x);\r\n            this.doUpdate(UpdateType.selection);\r\n        }, 20);\r\n        */\r\n    }\r\n}\r\n\r\nexport class DisplayModel extends EventEmitter {\r\n    private _lineID = 0;\r\n    private _parser: Parser;\r\n    public lines: LineData[] = [];\r\n    private _lineIDs: number[] = [];\r\n    private _expire = {};\r\n    private _expire2 = [];\r\n\r\n    get enableDebug() {\r\n        return this._parser.enableDebug;\r\n    }\r\n\r\n    set enableDebug(value) {\r\n        this._parser.enableDebug = value;\r\n    }\r\n\r\n    get tabWidth(): number {\r\n        return this._parser.tabWidth;\r\n    }\r\n\r\n    set tabWidth(value) {\r\n        this._parser.tabWidth = value;\r\n    }\r\n\r\n    get textLength(): number {\r\n        return this._parser.textLength;\r\n    }\r\n\r\n    get EndOfLine(): boolean {\r\n        return this._parser.EndOfLine;\r\n    }\r\n\r\n    get parseQueueLength(): number {\r\n        return this._parser.parseQueueLength;\r\n    }\r\n\r\n    get parseQueueEndOfLine(): boolean {\r\n        return this._parser.parseQueueEndOfLine;\r\n    }\r\n\r\n    set enableFlashing(value: boolean) {\r\n        this._parser.enableFlashing = value;\r\n    }\r\n    get enableFlashing(): boolean {\r\n        return this._parser.enableFlashing;\r\n    }\r\n\r\n    set enableMXP(value: boolean) {\r\n        this._parser.enableMXP = value;\r\n    }\r\n    get enableMXP(): boolean {\r\n        return this._parser.enableMXP;\r\n    }\r\n\r\n    set showInvalidMXPTags(value: boolean) {\r\n        this._parser.showInvalidMXPTags = value;\r\n    }\r\n    get showInvalidMXPTags(): boolean {\r\n        return this._parser.showInvalidMXPTags;\r\n    }\r\n\r\n    set enableBell(value: boolean) {\r\n        this._parser.enableBell = value;\r\n    }\r\n    get enableBell(): boolean {\r\n        return this._parser.enableBell;\r\n    }\r\n\r\n    set enableURLDetection(value: boolean) {\r\n        this._parser.enableURLDetection = value;\r\n    }\r\n    get enableURLDetection(): boolean {\r\n        return this._parser.enableURLDetection;\r\n    }\r\n\r\n    set enableMSP(value: boolean) {\r\n        this._parser.enableMSP = value;\r\n    }\r\n    get enableMSP(): boolean {\r\n        return this._parser.enableMSP;\r\n    }\r\n\r\n    set displayControlCodes(value: boolean) {\r\n        this._parser.displayControlCodes = value;\r\n    }\r\n    get displayControlCodes(): boolean {\r\n        return this._parser.displayControlCodes;\r\n    }\r\n\r\n    set emulateTerminal(value: boolean) {\r\n        this._parser.emulateTerminal = value;\r\n    }\r\n    get emulateTerminal(): boolean {\r\n        return this._parser.emulateTerminal;\r\n    }\r\n\r\n    set emulateControlCodes(value: boolean) {\r\n        this._parser.emulateControlCodes = value;\r\n    }\r\n    get emulateControlCodes(): boolean {\r\n        return this._parser.emulateControlCodes;\r\n    }\r\n\r\n    set MXPStyleVersion(value: string) {\r\n        this._parser.StyleVersion = value;\r\n    }\r\n    get MXPStyleVersion(): string {\r\n        return this._parser.StyleVersion;\r\n    }\r\n\r\n    constructor(options: DisplayOptions) {\r\n        super();\r\n        this._parser = new Parser(options);\r\n        this._parser.on('debug', (msg) => { this.emit('debug', msg); });\r\n\r\n        this._parser.on('bell', () => { this.emit('bell'); });\r\n\r\n        this._parser.on('add-line', (data: ParserLine) => {\r\n            this.addParserLine(data, true);\r\n        });\r\n\r\n        this._parser.on('expire-links', (args) => {\r\n            let lines;\r\n            let line;\r\n            let expire;\r\n            if (!args || args.length === 0) {\r\n                for (line in this._expire2) {\r\n                    if (!this._expire2.hasOwnProperty(line))\r\n                        continue;\r\n                    this._expireLineLinkFormat(this._expire2[line], +line);\r\n                }\r\n                for (expire in this._expire) {\r\n                    if (!this._expire.hasOwnProperty(expire))\r\n                        continue;\r\n                    lines = this._expire[expire];\r\n                    for (line in lines) {\r\n                        if (!lines.hasOwnProperty(line))\r\n                            continue;\r\n                        this._expireLineLinkFormat(lines[line], +line);\r\n                    }\r\n                }\r\n                this._expire2 = [];\r\n                this._expire = {};\r\n                this.emit('expire-links', args);\r\n            }\r\n            else if (this._expire[args]) {\r\n                lines = this._expire[args];\r\n                for (line in lines) {\r\n                    if (!lines.hasOwnProperty(line))\r\n                        continue;\r\n                    this._expireLineLinkFormat(lines[line], +line);\r\n                }\r\n                delete this._expire[args];\r\n                this.emit('expire-links', args);\r\n            }\r\n        });\r\n\r\n        this._parser.on('parse-done', () => {\r\n            this.emit('parse-done');\r\n        });\r\n\r\n        this._parser.on('set-title', (title, type) => {\r\n            this.emit('set-title', title, type);\r\n        });\r\n        this._parser.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this._parser.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this._parser.on('MXP-tag-reply', (tag, args) => {\r\n            this.emit('MXP-tag-reply', tag, args);\r\n        });\r\n\r\n    }\r\n\r\n    public addParserLine(data: ParserLine, noUpdate?: boolean) {\r\n        data.timestamp = Date.now();\r\n        this.emit('add-line', data);\r\n        if (data == null || typeof data === 'undefined' || data.line == null || typeof data.line === 'undefined')\r\n            return;\r\n        this.emit('add-line-done', data);\r\n        if (data.gagged)\r\n            return;\r\n        const line: LineData = {\r\n            text: (data.line === '\\n' || data.line.length === 0) ? '' : data.line,\r\n            raw: data.raw,\r\n            formats: data.formats,\r\n            id: this._lineID,\r\n            timestamp: data.timestamp\r\n        }\r\n        this.lines.push(line);\r\n        this._lineIDs.push(this._lineID);\r\n        this._lineID++;\r\n        this._buildLineExpires(this.lines.length - 1);\r\n        this.emit('line-added', data, noUpdate);\r\n    }\r\n\r\n    public appendLines(data: ParserLine[]) {\r\n        for (let d = 0, dl = data.length; d < dl; d++)\r\n            this.addParserLine(data[d]);\r\n        this._parser.emit('parse-done');\r\n    }\r\n\r\n    private _expireLineLinkFormat(formats, idx: number) {\r\n        let f;\r\n        let fs;\r\n        let fl;\r\n        let fsl;\r\n        let type;\r\n        let eType;\r\n        let format;\r\n        let n = 0;\r\n        for (fs = 0, fsl = formats.length; fs < fsl; fs++) {\r\n            fl = this.lines[idx].formats.length;\r\n            f = formats[fs];\r\n            format = this.lines[idx].formats[f];\r\n            type = format.formatType;\r\n            if (format.formatType === FormatType.MXPLink)\r\n                eType = FormatType.MXPLinkEnd;\r\n            else\r\n                eType = FormatType.MXPSendEnd;\r\n            format.formatType = FormatType.MXPExpired;\r\n            f++;\r\n            for (; f < fl; f++) {\r\n                if (this.lines[idx].formats[f] === eType) {\r\n                    if (n === 0) {\r\n                        this.lines[idx].formats[f].formatType = FormatType.MXPSkip;\r\n                        break;\r\n                    }\r\n                    else\r\n                        n--;\r\n                }\r\n                else if (this.lines[idx].formats[f] === type)\r\n                    n++;\r\n            }\r\n        }\r\n        this.emit('expire-link-line', idx);\r\n    }\r\n\r\n    public clear() {\r\n        this._parser.Clear();\r\n        this.lines = [];\r\n        this._expire = {};\r\n        this._expire2 = [];\r\n        this._lineIDs = [];\r\n        this._lineID = 0;\r\n    }\r\n\r\n    public IncreaseColor(color, percent) {\r\n        return this._parser.IncreaseColor(color, percent);\r\n    }\r\n\r\n    public GetColor(color) {\r\n        return this._parser.GetColor(color);\r\n    }\r\n\r\n    public append(txt: string, remote?: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this._parser.parse(txt, remote || false, force || false, prependSplit || false);\r\n    }\r\n\r\n    public CurrentAnsiCode() {\r\n        return this._parser.CurrentAnsiCode();\r\n    }\r\n\r\n    public updateWindow(width?, height?) {\r\n        this._parser.updateWindow(width, height);\r\n    }\r\n\r\n    public SetColor(code: number, color) {\r\n        this._parser.SetColor(code, color);\r\n    }\r\n\r\n    public ClearMXP() {\r\n        this._parser.ClearMXP();\r\n    }\r\n\r\n    public ResetMXPLine() {\r\n        this._parser.ResetMXPLine();\r\n    }\r\n\r\n    get busy() {\r\n        return this._parser.busy;\r\n    }\r\n\r\n    public removeLine(line: number) {\r\n        this.lines.splice(line, 1);\r\n        this._lineIDs.splice(line, 1);\r\n        this._expire2.splice(line, 1);\r\n    }\r\n\r\n    public removeLines(line: number, amt: number) {\r\n        this.lines.splice(line, amt);\r\n        this._lineIDs.splice(line, amt);\r\n        this._expire2.splice(line, amt);\r\n        for (let ol in this._expire) {\r\n            if (!this._expire.hasOwnProperty(ol) || this._expire[ol].length === 0 || line >= this._expire[ol].length)\r\n                continue;\r\n            this._expire[ol].splice(line, amt);\r\n        }\r\n    }\r\n\r\n    public getLineID(line: number) {\r\n        if (line < 0 || line >= this._lineIDs.length) return -1;\r\n        return this._lineIDs[line];\r\n    }\r\n\r\n    public get getNextLineID() {\r\n        return this._lineID;\r\n    }\r\n\r\n    public getLineFromID(id) {\r\n        return this._lineIDs.indexOf(id);\r\n    }\r\n\r\n    private _buildLineExpires(idx) {\r\n        if (idx === undefined)\r\n            idx = this.lines.length - 1;\r\n        const formats = this.lines[idx].formats;\r\n        for (const ol in this._expire) {\r\n            if (!this._expire.hasOwnProperty(ol))\r\n                continue;\r\n            if (this._expire[ol][idx])\r\n                delete this._expire[ol][idx];\r\n        }\r\n        delete this._expire2[idx];\r\n        let f = formats.length;\r\n        let format;\r\n        while (f--) {\r\n            format = formats[f];\r\n            if (format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink) {\r\n                if (format.expire && format.expire.length > 0) {\r\n                    if (!this._expire[format.expire])\r\n                        this._expire[format.expire] = [];\r\n                    if (!this._expire[format.expire][idx])\r\n                        this._expire[format.expire][idx] = [];\r\n                    this._expire[format.expire][idx].push(f);\r\n                }\r\n                else {\r\n                    if (!this._expire2[idx])\r\n                        this._expire2[idx] = [];\r\n                    this._expire2[idx].push(f);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    //color like javascript.substr using 0 index and length\r\n    public colorSubStrByLine(idx: number, fore, back?, start?: number, len?: number, style?: FontStyle) {\r\n        return this.colorSubStringByLine(idx, fore, back, start, start + len, style);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public colorSubStringByLine(idx: number, fore, back?, start?: number, end?: number, style?: FontStyle) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n        if (start === end)\r\n            return false;\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                format.color = fore || format.color;\r\n                format.background = back || format.background;\r\n                format.style |= style || FontStyle.None;\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: fore || 0,\r\n                    background: back || 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: style || FontStyle.None,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: fore || format.color,\r\n                        background: back || format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style | (style || FontStyle.None),\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                else {\r\n                    format.color = fore || format.color;\r\n                    format.background = back || format.background;\r\n                    format.style |= (style || FontStyle.None);\r\n                }\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this._pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public removeStyleSubStrByLine(idx: number, style: FontStyle, start?: number, len?: number) {\r\n        return this.removeStyleSubStringByLine(idx, style, start, start + len);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public removeStyleSubStringByLine(idx: number, style: FontStyle, start?: number, end?: number) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                format.style &= ~(style || FontStyle.None);\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: 0,\r\n                    background: 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: FontStyle.None,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style & ~(style || FontStyle.None),\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                else {\r\n                    format.style &= ~(style || FontStyle.None);\r\n                }\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this._pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public highlightSubStrByLine(idx: number, start?: number, len?: number) {\r\n        return this.highlightStyleSubStringByLine(idx, start, start + len);\r\n    }\r\n\r\n    //color like javascript.substring using 0 index for start and end\r\n    public highlightStyleSubStringByLine(idx: number, start?: number, end?: number, color?: boolean) {\r\n        //invalid line bail\r\n        if (idx < 0 || idx >= this.lines.length) return false;\r\n        const lineLength = this.lines[idx].text.length;\r\n        //passed line skip\r\n        if (start >= lineLength) return false;\r\n        if (!start || start < 0) start = 0;\r\n        if (!end || end > lineLength)\r\n            end = lineLength;\r\n\r\n        const formats = this.lines[idx].formats;\r\n        let len = formats.length;\r\n        let found: boolean = false;\r\n        //whole line so just do everything\r\n        if (start === 0 && end >= lineLength) {\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                    if (typeof format.color === 'number')\r\n                        format.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                    else\r\n                        format.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                }\r\n                else\r\n                    format.style |= FontStyle.Bold;\r\n            }\r\n            //found no text block must create one\r\n            if (!found) {\r\n                formats.unshift({\r\n                    formatType: FormatType.Normal,\r\n                    offset: 0,\r\n                    color: color ? 370 : 0,\r\n                    background: 0,\r\n                    size: 0,\r\n                    font: 0,\r\n                    style: color ? FontStyle.None : FontStyle.Bold,\r\n                    unicode: false\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            let nFormat;\r\n            let formatEnd;\r\n            for (let f = 0; f < len; f++) {\r\n                const format = formats[f];\r\n                //only worry about normal types\r\n                if (format.formatType !== FormatType.Normal)\r\n                    continue;\r\n                //find the end of he format\r\n                if (f < len - 1) {\r\n                    let nF = f + 1;\r\n                    nFormat = formats[nF];\r\n                    //skip empty blocks\r\n                    if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                        continue;\r\n                    //find next block that is not same offset\r\n                    while (format.offset === nFormat.offset && nFormat.formatType === format.formatType && nF < len - 1)\r\n                        nFormat = formats[++nF];\r\n                    //last block same offset use total length\r\n                    if (nF === len && format.offset === nFormat.offset)\r\n                        formatEnd = lineLength;\r\n                    else\r\n                        formatEnd = nFormat.offset;\r\n                }\r\n                else\r\n                    formatEnd = lineLength;\r\n                if (start < format.offset) continue;\r\n                //passed end so try next block\r\n                if (start >= formatEnd) continue;\r\n                //after this block move on.\r\n                //not offset so need to insert a new block\r\n                found = true;\r\n                if (format.bStyle) {\r\n                    format.bStyle = 0;\r\n                    format.fStyle = 0;\r\n                    format.fCls = 0;\r\n                }\r\n                //if end middle of block, add new block with old info to split\r\n                if (end < formatEnd) {\r\n                    format.width = 0;\r\n                    formats.splice(f + 1, 0, {\r\n                        formatType: format.formatType,\r\n                        offset: end,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    });\r\n                    len++;\r\n                }\r\n                if (start != format.offset) {\r\n                    //clean old width\r\n                    format.width = 0;\r\n                    //insert new block with new colors\r\n                    nFormat = {\r\n                        formatType: format.formatType,\r\n                        offset: start,\r\n                        color: format.color,\r\n                        background: format.background,\r\n                        size: format.size,\r\n                        font: format.font,\r\n                        style: format.style,\r\n                        unicode: format.unicode\r\n                    }\r\n                    if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                        if (typeof format.color === 'number')\r\n                            nFormat.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                        else\r\n                            nFormat.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                    }\r\n                    else\r\n                        nFormat.style |= FontStyle.Bold;\r\n                    formats.splice(f + 1, 0, nFormat);\r\n                    len++;\r\n                }\r\n                else if (color || (format.style & FontStyle.Bold) === FontStyle.Bold) {\r\n                    if (typeof format.color === 'number')\r\n                        format.color = this._parser.IncreaseColor(this._parser.GetColor(format.color), 0.25);\r\n                    else\r\n                        format.color = this._parser.IncreaseColor(format.color, 0.25);\r\n                }\r\n                else\r\n                    format.style |= FontStyle.Bold;\r\n\r\n                //not end so shift start to next block\r\n                if (end > formatEnd)\r\n                    start = formatEnd;\r\n            }\r\n            //clean out duplicates and other no longer needed blocks\r\n            this.lines[idx].formats = this._pruneFormats(formats, this.textLength);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private _pruneFormats(formats, textLen) {\r\n        //no formats or only 1 format\r\n        if (!formats || formats.length < 2) return formats;\r\n        const l = formats.length;\r\n        const nF = [];\r\n        for (let f = 0; f < l; f++) {\r\n            const format = formats[f];\r\n            let end;\r\n            if (f < l - 1) {\r\n                const nFormat = formats[f + 1];\r\n                //old links that have expired so no longer needed clean\r\n                //if (format.formatType === FormatType.MXPSkip) continue;\r\n                //skip format until find one that has different offset\r\n                if (format.offset === nFormat.offset && nFormat.formatType === format.formatType)\r\n                    continue;\r\n                end = nFormat.offset;\r\n                //empty link\r\n                if (format.formatType === FormatType.Link && end - format.offset === 0 && nFormat.formatType === FormatType.LinkEnd)\r\n                    continue;\r\n                //empty send\r\n                if (format.formatType === FormatType.MXPSend && end - format.offset === 0 && nFormat.formatType === FormatType.MXPSendEnd)\r\n                    continue;\r\n                //empty link\r\n                if (format.formatType === FormatType.MXPLink && end - format.offset === 0 && nFormat.formatType === FormatType.MXPLinkEnd)\r\n                    continue;\r\n                //same data but offset is higher, set next block current offset, clear width and continue;\r\n                if (\r\n                    format.formatType === nFormat.formatType &&\r\n                    format.color === nFormat.color &&\r\n                    format.background === nFormat.background &&\r\n                    format.size === nFormat.size &&\r\n                    format.font === nFormat.font &&\r\n                    format.style === nFormat.style &&\r\n                    format.unicode === nFormat.unicode\r\n                ) {\r\n                    nFormat.offset = format.offset;\r\n                    nFormat.width = 0;\r\n                    continue;\r\n                }\r\n            }\r\n            //trailing link with no text or empty format block and not fragment\r\n            else if (format.offset === textLen && textLen !== 0 && ((format.formatType === FormatType.Normal && !format.hr) || format.formatType === FormatType.Link || format.formatType === FormatType.MXPSend || format.formatType === FormatType.MXPLink))\r\n                continue;\r\n            nF.push(format);\r\n        }\r\n        return nF;\r\n    }\r\n\r\n    get text(): string {\r\n        return this.lines.map(line => line.text).join('\\n');\r\n    }\r\n\r\n    get raw(): string {\r\n        return this.lines.map(line => line.raw).join('');\r\n    }\r\n\r\n    public getText(line, start, end?) {\r\n        if (line < 0 || line >= this.lines.length) return '';\r\n        if (start < 0) start = 0;\r\n        if (typeof end === 'undefined' || end > this.lines[line].text.length)\r\n            return this.lines[line].text.substring(start);\r\n        return this.lines[line].text.substring(start, end);\r\n    }\r\n}\r\n", "{\n  \"name\": \"oimud\",\n  \"productName\": \"oiMUD\",\n  \"icon\": \"./assets/icons/oiMUD.png.png\",\n  \"website\": \"https://github.com/icewolfz/oiMUD\",\n  \"homepage\": \"https://github.com/icewolfz/oiMUD\",\n  \"url\": \"https://github.com/icewolfz/oiMUD/issues\",\n  \"version\": \"1.0.0-alpha\",\n  \"main\": \"dist/index.htm\",\n  \"description\": \"A MUD websocket client.\",\n  \"author\": \"Icewolfz\",\n  \"email\": \"icewolfz@users.noreply.github.com\",\n  \"license\": \"Personal\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/icewolfz/oiMUD.git\"\n  },\n  \"private\": true,\n  \"scripts\": {\n    \"tslint\": \"tsc -p . --listEmittedFiles  --noEmit\",\n    \"build\": \"node build.js --debug --release -p:all --bundled --tinymce\",\n    \"build:all\": \"node build.js -a -p:all\",\n    \"build:debug\": \"node build.js --debug -p:all --bundled --tinymce\",\n    \"build:release\": \"node build.js --release -p:all --bundled --tinymce\"\n  },\n  \"devDependencies\": {\n    \"@types/jquery\": \"^3.5.32\",\n    \"esbuild\": \"0.24.0\",\n    \"eslint\": \"^9.15.0\",\n    \"eslint-plugin-html\": \"^8.1.2\",\n    \"html-minifier-terser\": \"^7.2.0\",\n    \"terser\": \"^5.36.0\"\n  },\n  \"dependencies\": {\n    \"@types/jstorage\": \"^0.3.33\",\n    \"jquery\": \"^3.7.1\",\n    \"mathjs\": \"^13.2.3\",\n    \"moment\": \"^2.30.1\"\n  }\n}\n", "//MSP = 90 // MUD Sound Protocol (MSP)(unofficial)\n/**\n * Implementation of the MSP (MUD Sound Protocol) and GMCP Client.Media module for oiMUD as a plugin\n *\n * @author Icewolfz\n * @copyright Icewolfz 2013\n * @version 1.2\n * MSP requires the modules {@link module:telnet}.\n * MSP requires the modules {@link module:src/lib/buzz}.\n * @requires module:src/lib/buzz\n * @requires module:telnet\n * @namespace MSP\n * @constructor\n *\n * @property {Object} [server=false]\t- Weather the server willing to do MSP\n * @property {Object} [enabled=true]\t- Is MSP module enabled\n *\n * @todo make Music/Sound play music either using soundmanager2(larger but more compatible) or buzz (HTML5 old)\n */\ndeclare global {\n    interface Window {\n        MSP: MSP;\n    }\n}\n\nimport * as buzz from './../lib/buzz.js'\n\nimport { EventEmitter } from '../core/events.js';\nimport { stripQuotes } from '../core/library.js';\nimport { TelnetOption } from '../core/telnet.js';\nimport { Client } from '../core/client.js';\nimport { Plugin } from '../core/plugin.js';\nimport { AnsiColorCode } from '../core/ansi.js';\nimport { FunctionEvent, MenuItem } from '../core/types.js';\n\nenum ParseMode {\n    default = 0,\n    inline = 1,\n    strict = 2\n}\n\ninterface MSPData {\n    off: boolean;\n    file?: string;\n    url?: string;\n    volume?: number;\n    repeat?: number;\n    priority?: number;\n    type?: string;\n    continue?: boolean;\n}\n\nclass SoundState extends EventEmitter {\n    public _file: string = '';\n    private _repeats: number = 1;\n    private _volume: number = 100;\n    private _priority: number = 50;\n    private _retries: number = 0;\n\n    public current: number = 0;\n    public sound = null;\n    public playing: boolean = false;\n    public url: string = '';\n    public continue: boolean = true;\n    public maxErrorRetries: number = 0;\n\n    set file(file: string) {\n        if (!this.continue)\n            this.close();\n        this._file = file;\n    }\n    get file(): string {\n        return this._file;\n    }\n\n    set repeats(repeats: number) {\n        if (repeats >= -1)\n            this._repeats = repeats;\n        else\n            this._repeats = 1;\n        this.current = 0;\n    }\n\n    get repeats(): number {\n        return this._repeats;\n    }\n\n    set volume(volume: number) {\n        if (volume >= 0 && volume <= 100)\n            this._volume = volume;\n        else\n            this._volume = 1;\n    }\n\n    get volume(): number {\n        return this._volume;\n    }\n\n    set priority(priority: number) {\n        if (priority >= 0 && priority <= 100)\n            this._priority = priority;\n        else\n            this._priority = 50;\n    }\n\n    get priority(): number {\n        return this._priority;\n    }\n\n    public play() {\n        this.playing = true;\n        if (this._repeats > 0 && this.current < this._repeats) {\n            this.current++;\n            this.close();\n            this.open().then(() => {\n                //reset to 0 as it was successful in prep of next sound\n                this._retries = 0;\n                this.sound.setVolume(this._volume).play();\n                if (this.current < this._repeats) {\n                    this.sound.bind('ended abort', (e) => {\n                        this.play();\n                    });\n                }\n                else\n                    this.sound.bind('ended abort', (e) => {\n                        this.playing = false;\n                        this.emit('ended');\n                    });\n                if (this.sound.isEnded())\n                    this.playing = false;\n            }).catch(err => {\n                //only retry until reaches max error retries to prevent infinite looping\n                if (this._retries < this.maxErrorRetries) {\n                    //reduce current as failed to play\n                    this.current--;\n                    this.play();\n                    this._retries++;\n                }\n                //if at max retries do nothing and reset to 0\n                else\n                    this._retries = 0;\n            });\n        }\n        else if (this._repeats === -1) {\n            this.close();\n            this.open().then(() => {\n                //reset to 0 as it was successful in prep of next sound\n                this._retries = 0;\n                this.sound.setVolume(this._volume).loop().play();\n                if (this.sound.isEnded())\n                    this.playing = false;\n            }).catch(err => {\n                //only retry until reaches max error retries to prevent infinite looping\n                if (this._retries < this.maxErrorRetries) {\n                    this.play();\n                    this._retries++;\n                }\n                //if at max retries do nothing and reset to 0\n                else\n                    this._retries = 0;\n            });\n        }\n        else\n            this.playing = false;\n    }\n\n    public async open() {\n        this.close();\n        return new Promise((resolve, reject) => {\n            this.sound = (new buzz.sound as any)(this.url + this._file);\n            this.sound.bind('loadeddata', (e) => {\n                this.emit('playing', { file: this._file, sound: this.sound, state: this, duration: buzz.toTimer(this.sound.getDuration()) });\n                resolve(1);\n            });\n            this.sound.bind('error', (e) => {\n                if (e && e.currentTarget && e.currentTarget.error) {\n                    switch (e.currentTarget.error.code) {\n                        case 1:\n                            this.emit('error', new Error(`MSP - Aborted: ${this.url}${this._file}`));\n                            break;\n                        case 2:\n                            this.emit('error', new Error(`MSP - Network error: ${this.url}${this._file}`));\n                            break;\n                        case 3:\n                            this.emit('error', new Error(`MSP - Could not decode: ${this.url}${this._file}`));\n                            break;\n                        case 4:\n                            this.emit('error', new Error(`MSP - Source not supported: ${this.url}${this._file}`));\n                            break;\n                    }\n                }\n                else if (e && e.currentTarget && e.currentTarget.networkState === 3)\n                    this.emit('error', new Error(`MSP - Source not found or unable to play: ${this.url}${this._file}`));\n                else\n                    this.emit('error', new Error('MSP - Unknown error'));\n                reject();\n            });\n            this.emit('opened');\n        });\n    }\n\n    public close() {\n        if (this.sound) {\n            this.stop();\n            delete this.sound;\n            this.sound = null;\n        }\n        else if (this.playing)\n            this.playing = false;\n        this.emit('closed');\n    }\n\n    public stop() {\n        if (this.sound)\n            this.sound.stop();\n        this.playing = false;\n        this.emit('stopped');\n    }\n}\n\nexport interface MSPOptions {\n    client: Client;\n    forcedDefaultMusicURL?: string;\n    forcedDefaultSoundURL?: string;\n}\n\n/**\n * Implementation of the MSP (MUD Sound Protocol)\n *\n * @author William\n * @copyright William 2013\n * @version 1.1\n * MSP requires the modules {@link module:telnet}.\n * MSP requires the modules {@link module:buzz}.\n * @requires module:buzz\n * @requires module:telnet\n * @namespace MSP\n * @constructor\n *\n * @property {Object} [server=false]\t- Weather the server willing to do MSP\n * @property {Object} [enabled=true]\t- Is MSP module enabled\n */\nexport class MSP extends Plugin {\n    private _enabled: boolean = true;\n    private _enableSound: boolean = true;\n    private _maxErrorRetries: number = 1;\n    public server: boolean = false;\n    public enableDebug: boolean = false;\n\n    public defaultSoundURL: string = '';\n    public defaultMusicURL: string = '';\n    public forcedDefaultMusicURL: string = 'http://' + window.location.hostname + '/sounds/';\n    public forcedDefaultSoundURL: string = 'http://' + window.location.hostname + '/sounds/';\n    public defaultSoundExt: string = '.m4a';\n    public defaultMusicExt: string = '.m4a';\n    public MusicState: SoundState = new SoundState();\n    public SoundState: SoundState = new SoundState();\n    public parseMode: ParseMode = ParseMode.default;\n\n    constructor(options?: MSPOptions | Client) {\n        super(options instanceof Client ? options : options?.client);\n        if (options && !(options instanceof Client)) {\n            if ('forcedDefaultMusicURL' in options)\n                this.forcedDefaultMusicURL = options.forcedDefaultMusicURL;\n            if ('forcedDefaultSoundURL' in options)\n                this.forcedDefaultSoundURL = options.forcedDefaultSoundURL;\n        }\n        this.MusicState.on('playing', (data) => { data.type = 1; this.emit('playing', data); });\n        this.SoundState.on('playing', (data) => { data.type = 0; this.emit('playing', data); });\n        this.MusicState.on('error', (err) => { this.emit('error', err); });\n        this.SoundState.on('error', (err) => { this.emit('error', err); });\n        this.MusicState.maxErrorRetries = this._maxErrorRetries;\n        this.SoundState.maxErrorRetries = this._maxErrorRetries;\n    }\n\n    public remove() {\n        if (!this.client) return;\n        this.client.removeListenersFromCaller(this);\n        let idx = this.client.telnet.GMCPSupports.indexOf('Client.Media 1');\n        this.client.telnet.GMCPSupports.splice(idx, 1);\n    }\n\n    public initialize() {\n        if (!this.client) return;\n        this.client.telnet.GMCPSupports.push('Client.Media 1');\n        this.client.on('connecting', () => this.reset(), this);\n        this.client.on('close', () => this.reset(), this);\n        this.client.on('received-option', this.processOption, this);\n        this.client.on('received-GMCP', this.processGMCP, this);\n        this.client.on('music', this.music, this);\n        this.client.on('sound', this.sound, this);\n        this.client.on('options-loaded', this.loadOptions, this);\n        this.client.on('option-loaded', this.setOption, this);\n        this.client.on('function', this._processFunction, this);\n        this.on('playing', (data) => {\n            if (!this.client) return;\n            this.debug('MSP ' + (data.type ? 'Music' : 'Sound') + ' Playing ' + data.file + ' for ' + data.duration);\n            this.debug(data);\n            if (!this.client.getOption('notifyMSPPlay')) return;\n            this.client.echo((data.type ? 'Music' : 'Sound') + ' Playing ' + data.file + ' for ' + data.duration, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\n        });\n        this.on('debug', e => this.client.debug(e), this);\n        this.on('error', e => this.client.error(e), this);\n        this.loadOptions();\n    }\n\n    public get menu() {\n        return [];\n    }\n\n    public get settings(): MenuItem[] {\n        return [];\n    }\n\n    public loadOptions() {\n        this.enableDebug = this.client.getOption('enableDebug');\n        this.enabled = this.client.getOption('enableMSP');\n        this.enableSound = this.client.getOption('enableSound');\n        this.maxErrorRetries = this.client.getOption('mspMaxRetriesOnError');\n    }\n\n    public setOption(option, value) {\n        switch (option) {\n            case 'enableMSP':\n                this.enabled = this.client.getOption('enableMSP');\n                break;\n            case 'mspMaxRetriesOnError':\n                this.maxErrorRetries = this.client.getOption('mspMaxRetriesOnError');\n                break;\n            case 'enableSound':\n            case 'enableDebug':\n                this[option] = value;\n                break;\n        }\n    }\n\n    /**\n     * enable or disable MSP\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get enabled() { return this._enabled; }\n    set enabled(value) {\n        if (value === this._enabled) return;\n        this._enabled = value;\n        this.MusicState?.close();\n        this.SoundState?.close();\n    }\n\n    /**\n     * the number of retries to try before stopping when an error happens MSP\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get maxErrorRetries() { return this._maxErrorRetries; }\n    set maxErrorRetries(value) {\n        if (value === this._maxErrorRetries) return;\n        this._maxErrorRetries = value;\n        if (this.MusicState)\n            this.MusicState.maxErrorRetries = value;\n        if (this.SoundState)\n            this.SoundState.maxErrorRetries = value;\n    }\n\n\n    /**\n     * enable or disable enableSound, allow processing of msp\n     *\n     * @type {boolean}\n     * @memberof MSP\n     */\n    get enableSound() { return this._enableSound; }\n    set enableSound(value) {\n        if (value === this._enableSound) return;\n        this._enableSound = value;\n        this.MusicState?.close();\n        this.SoundState?.close();\n    }\n\n    /**\n     * getArguments - process a line of text and extract any arguments and return\n     * them as an object for consuming and handle it due to being a web browser can't\n     * save sounds, so they either need a url or be on the local http server using\n     * the default url set\n     *\n     * @param {String} text the line of text extract arguments from\n     * @param {Number} type the type of arguments to process, 0 SOUND, 1 MUSIC\n     * @returns {Object} return a MUSIC or SOUND argument object\n     */\n    public getArguments(text: string, type: number) {\n        const e: MSPData = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n        const args = [];\n        let state: number = 0;\n        let str = [];\n        let x: number = 0;\n        let xl: number = text.length;\n        let c: string;\n        let arg;\n        let tmp;\n        for (; x < xl; x++) {\n            c = text.charAt(x);\n            switch (state) {\n                case 1:\n                    if (c === '\\'') {\n                        state = 0;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n                    break;\n                case 2:\n                    if (c === '\\'') {\n                        state = 0;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n                    break;\n                default:\n                    if (c === ' ') {\n                        args.push(str.join(''));\n                        str = [];\n                    }\n                    else if (c === '\\'') {\n                        state = 1;\n                        str.push(c);\n                    }\n                    else if (c === '\\'') {\n                        state = 2;\n                        str.push(c);\n                    }\n                    else\n                        str.push(c);\n\n                    break;\n            }\n        }\n        if (str.length > 0) {\n            args.push(str.join(''));\n            str = [];\n        }\n        x = 0;\n        xl = args.length;\n        this.debug('MSP arguments found: ' + args);\n        for (x = 0; x < xl; x++) {\n            arg = args[x].split('=');\n            if (arg.length > 1) {\n                switch (arg[0].toUpperCase()) {\n                    case 'FNAME':\n                        e.file = stripQuotes(arg[1]);\n                        if (e.file.toLowerCase() === 'off') {\n                            e.off = true;\n                            e.file = '';\n                        }\n                        break;\n                    case 'V': //volume\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 100;\n                        e.volume = tmp;\n                        break;\n                    case 'L': //repeat\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 1;\n                        e.repeat = tmp;\n                        break;\n                    //Sound only\n                    case 'P': //priority\n                        tmp = parseInt(arg[1], 10);\n                        if (isNaN(tmp))\n                            tmp = 1;\n                        e.priority = tmp;\n                        break;\n                    //Music only\n                    case 'C': //continue\n                        e.continue = arg[1] !== '0';\n                        break;\n                    case 'T': //type\n                        if (arg[1].length > 0)\n                            e.type = arg[1];\n                        break;\n                    case 'U': //url\n                        e.url = stripQuotes(arg[1]);\n                        if (!e.url.endsWith('/') && e.url.length > 0)\n                            e.url += '/';\n                        break;\n                }\n            }\n            else if (x === 0) {\n                e.file = stripQuotes(args[x]);\n                if (e.file.toLowerCase() === 'off') {\n                    e.off = true;\n                    e.file = '';\n                }\n            }\n            else if (x === 1) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 100;\n                e.volume = tmp;\n            }\n            else if (x === 2) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 1;\n                e.repeat = tmp;\n            }\n            else if (x === 3 && type === 1)\n                e.continue = args[x] !== '0';\n            else if (x === 3) {\n                tmp = parseInt(args[x], 10);\n                if (isNaN(tmp))\n                    tmp = 1;\n                e.priority = tmp;\n            }\n            else if (x === 4) {\n                if (args[x].length > 0)\n                    e.type = args[x];\n            }\n            else if (x === 5) {\n                e.url = stripQuotes(args[x]);\n                if (!e.url.endsWith('/') && e.url.length > 0)\n                    e.url += '/';\n            }\n        }\n        this.debug(e);\n        return e;\n    }\n\n    public reset() {\n        this.server = false;\n    }\n\n    /**\n     * music - process music object and player/stop based on object options\n     *\n     * @param {Object} data Music argument object, contains all settings\n     */\n    public music(data: MSPData) {\n        if (!this.enabled && !this.enableSound) return false;\n        if (!data.file || data.file.length === 0) {\n            if (data.off && data.url && data.url.length > 0)\n                this.defaultMusicURL = data.url;\n            else if (data.off)\n                this.MusicState.stop();\n            return;\n        }\n        else if (data.off) {\n            this.MusicState.stop();\n            return;\n        }\n        this.MusicState.volume = data.volume;\n        this.MusicState.repeats = data.repeat;\n        this.MusicState.continue = data.continue;\n        const old = this.MusicState.file;\n\n        if (data.file.lastIndexOf('.') === -1)\n            this.MusicState.file = data.file + this.defaultMusicExt;\n        else\n            this.MusicState.file = data.file;\n        if (data.url && data.url.length > 0)\n            this.MusicState.url = data.url;\n        else if (this.forcedDefaultMusicURL && this.forcedDefaultMusicURL.length > 0)\n            this.MusicState.url = this.forcedDefaultMusicURL;\n        else if (this.defaultMusicURL && this.defaultMusicURL.length > 0)\n            this.MusicState.url = this.defaultMusicURL;\n        else\n            this.MusicState.url = '';\n        if (this.MusicState.url.length > 0 && !this.MusicState.url.endsWith('/'))\n            this.MusicState.url += '/';\n        if (data.type && data.type.length > 0) {\n            this.MusicState.url += data.type;\n            if (this.MusicState.url.length > 0 && !this.MusicState.url.endsWith('/'))\n                this.MusicState.url += '/';\n        }\n        if (old !== this.MusicState.file || !data.continue || !this.MusicState.playing) {\n            if (this.enableSound)\n                this.MusicState.play();\n            else\n                this.emit('playing', { type: 1, file: this.MusicState.file, sound: this.MusicState.sound, state: this.MusicState, duration: '--:--' });\n        }\n    }\n\n    /**\n     * sound - process music object and player/stop based on object options\n     *\n     * @param {Object} data Sound argument object, contains all settings\n     * @todo make it play/stop sound\n     */\n    public sound(data: MSPData) {\n        if (!this.enabled && !this.enableSound) return false;\n        if (!data.file || data.file.length === 0) {\n            if (data.off && data.url && data.url.length > 0)\n                this.defaultSoundURL = data.url;\n            else if (data.off)\n                this.SoundState.stop();\n            return;\n        }\n        else if (data.off) {\n            this.SoundState.stop();\n            return;\n        }\n        //if playing and new priority is lower, do not play new sound\n        if (this.SoundState.playing && data.priority < this.SoundState.priority)\n            return false;\n\n        this.SoundState.volume = data.volume;\n        this.SoundState.repeats = data.repeat;\n        this.SoundState.priority = data.priority;\n        if (data.file.lastIndexOf('.') === -1)\n            this.SoundState.file = data.file + this.defaultSoundExt;\n        else\n            this.SoundState.file = data.file;\n        if (data.url && data.url.length > 0)\n            this.SoundState.url = data.url;\n        else if (this.forcedDefaultSoundURL && this.forcedDefaultSoundURL.length > 0)\n            this.SoundState.url = this.forcedDefaultSoundURL;\n        else if (this.defaultSoundURL && this.defaultSoundURL.length > 0)\n            this.SoundState.url = this.defaultSoundURL;\n        else\n            this.SoundState.url = '';\n        if (this.SoundState.url.length > 0 && !this.SoundState.url.endsWith('/'))\n            this.SoundState.url += '/';\n        if (data.type && data.type.length > 0) {\n            this.SoundState.url += data.type;\n            if (this.SoundState.url.length > 0 && !this.SoundState.url.endsWith('/'))\n                this.SoundState.url += '/';\n        }\n        if (this.enableSound)\n            this.SoundState.play();\n        else\n            this.emit('playing', { type: 0, file: this.SoundState.file, sound: this.SoundState.sound, state: this.SoundState, duration: '--:--' });\n    }\n\n    /**\n     * processOption - process telnet options, if its MSP handle it and correctly reply yes we support MSP or no don't\n     *\n     * @param {Object} data Telnet#replyToOption event object\n     */\n    public processOption(data: TelnetOption) {\n        if (data.option === 90) {\n            this.debug('<MSP>');\n            if (data.verb === 253) {\n                this.server = true;\n                if (this.enabled) {\n                    this.debug('REPLY: <IAC><WILL><MSP>');\n                    data.telnet.sendData([255, 251, 90], true);\n                }\n                else {\n                    this.debug('REPLY: <IAC><DONT><MSP>');\n                    data.telnet.sendData([255, 254, 90], true);\n                }\n            }\n            else if (data.verb === 254) {\n                this.server = false;\n                this.debug('REPLY: <IAC><WONT><MSP>');\n                data.telnet.sendData([255, 252, 90], true);\n            }\n            else if (data.verb === 251) {\n                this.server = true;\n                if (this.enabled) {\n                    this.debug('REPLY: <IAC><DO><MSP>');\n                    data.telnet.sendData([255, 253, 90], true);\n                }\n                else {\n                    this.debug('REPLY: <IAC><DONT><MSP>');\n                    data.telnet.sendData([255, 254, 90], true);\n                }\n            }\n            else if (data.verb === 252) {\n                this.server = false;\n                this.debug('REPLY: <IAC><DONT><MSP>');\n                data.telnet.sendData([255, 254, 90], true);\n            }\n            data.handled = true;\n        }\n    }\n\n    /**\n     * processGMCP - process incoming GMCP for Client.Media events\n     * @param {string} mod Client#received-GMCP module\n     * @param {Object} data Client#received-GMCP data object\n     */\n    public async processGMCP(mod: string, data: any) {\n        switch (mod) {\n            case 'Client.Media.Default':\n                if (data.type === 'sound' || !data.type)\n                    this.sound({ off: true, url: data.url });\n                else if (data.type === 'music')\n                    this.music({ off: true, url: data.url });\n                break;\n            //as we don't support loading and caching of media ignore this\n            case 'Client.Media.Load':\n                break;\n            case 'Client.Media.Play':\n                //start off with default values\n                const sound: MSPData = { off: false, file: data.name, url: '', volume: 50, repeat: 1, priority: 50, type: '', continue: true };\n                //process incoming data and set as needed\n                if (data.hasOwnProperty('url'))\n                    sound.url = data.url;\n                if (data.hasOwnProperty('tag'))\n                    sound.type = data.tag;\n                if (data.hasOwnProperty('volume'))\n                    sound.volume = data.volume;\n                if (data.hasOwnProperty('loops'))\n                    sound.repeat = data.loops;\n                if (data.hasOwnProperty('priority'))\n                    sound.priority = data.priority;\n                if (data.type === 'sound' || !data.type)\n                    this.sound(sound);\n                else if (data.type === 'music') {\n                    if (data.hasOwnProperty('continue') && (data.continue === 'false' || !data.continue))\n                        sound.continue = false;\n                    this.music(sound);\n                }\n                break;\n            case 'Client.Media.Stop':\n                if (data.type === 'sound' || !data.type)\n                    this.sound({ off: true });\n                else if (data.type === 'music')\n                    this.music({ off: true });\n                break;\n        }\n    }\n\n    /**\n     * debug - emit debug event if enabledDebug on\n     * @param {string | object} e The debug message or an object of data \n     */\n    public debug(e) {\n        if (!this.enableDebug) return;\n        this.emit('debug', e);\n    }\n\n    /**\n     * Process function event to execute custom text functions\n     * @param data {FunctionEvent} The data about the function to execute\n     */\n    private _processFunction(data: FunctionEvent) {\n        let args;\n        let tmp;\n        let i;\n        if (!data) return;\n        switch (data.name.toLowerCase()) {\n            case 'soundinfo':\n                if (this.SoundState.playing)\n                    this.client.echo('Playing Sound - ' + this.SoundState.file + ' - ' + buzz.toTimer(this.SoundState.sound.getTime()) + '/' + buzz.toTimer(this.SoundState.sound.getDuration()), -7, -8, true, true);\n                else\n                    this.client.echo('No sound currently playing.', -7, -8, true, true);\n                data.handled = true;\n                break;\n            case 'musicinfo':\n                if (this.MusicState.playing)\n                    this.client.echo('Playing Music - ' + this.MusicState.file + ' -  ' + buzz.toTimer(this.MusicState.sound.getTime()) + '/' + buzz.toTimer(this.MusicState.sound.getDuration()), -7, -8, true, true);\n                else\n                    this.client.echo('No music currently playing.', -7, -8, true, true);\n                data.handled = true;\n                break;\n            case 'playmusic':\n            case 'playm':\n                args = this.client.input.parseOutgoing(data.args.join(' '), false);\n                tmp = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                i = args.lastIndexOf('/');\n                if (i === -1)\n                    tmp.file = args;\n                else {\n                    tmp.file = args.substring(i + 1);\n                    tmp.url = args.substring(0, i + 1);\n                }\n                this.music(tmp);\n                data.handled = true;\n                break;\n            case 'playsound':\n            case 'plays':\n                args = this.client.input.parseOutgoing(data.args.join(' '), false);\n                tmp = { off: false, file: '', url: '', volume: 100, repeat: 1, priority: 50, type: '', continue: true };\n                i = args.lastIndexOf('/');\n                if (i === -1)\n                    tmp.file = args;\n                else {\n                    tmp.file = args.substring(i + 1);\n                    tmp.url = args.substring(0, i + 1);\n                }\n                this.sound(tmp);\n                data.handled = true;\n                break;\n            case 'stopmusic':\n            case 'stopm':\n                this.MusicState.close();\n                data.handled = true;\n                break;\n            case 'stopsound':\n            case 'stops':\n                this.SoundState.close();\n                data.handled = true;\n                break;\n            case 'stopallsound':\n            case 'stopa':\n                this.MusicState.close();\n                this.SoundState.close();\n                data.handled = true;\n                break;\n\n        }\n    }\n}", "import { Client } from './client';\r\nimport { EventEmitter } from './events.js';\r\nimport { MenuItem } from './types';\r\n\r\nexport abstract class Plugin extends EventEmitter {\r\n    #client;\r\n    public get client() { return this.#client; }\r\n    public set client(value: Client) {\r\n        if (value === this.#client) return;\r\n        this.remove();\r\n        this.#client = value;\r\n        this.initialize();\r\n    }\r\n\r\n    constructor(client: Client) {\r\n        super();\r\n        this.#client = client;\r\n    }\r\n\r\n    public abstract remove(): void;\r\n    public abstract initialize(): void;\r\n    abstract get menu(): MenuItem[];\r\n    abstract get settings(): MenuItem[];\r\n}", "import { Plugin } from '../core/plugin';\r\nimport { MenuItem, FunctionEvent } from '../core/types';\r\nimport { Client } from '../core/client';\r\nimport { Ansi, AnsiColorCode } from '../core/ansi';\r\nimport { openFileDialog, readFile, StringToUint8Array } from '../core/library'\r\n\r\nexport class Test extends Plugin {\r\n    /**\r\n     * Contains a list of functions\r\n     * @type {object}\r\n     * @memberof Tests\r\n     */\r\n    public functions: object = {};\r\n    private _event;\r\n\r\n    constructor(client: Client) {\r\n        super(client);\r\n        this._event = data => this._processFunction(data);\r\n        this.functions['testfile'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let n = this.client.getOption('enableCommands');\r\n                    this.client.setOption('enableCommands', true);\r\n                    let i = new Date().getTime();\r\n                    console.time('testfile parse');\r\n                    this.client.sendCommand(contents, null, this.client.getOption('allowCommentsFromCommand'));\r\n                    console.timeEnd('testfile parse');\r\n                    let p = new Date().getTime();\r\n                    this.client.setOption('enableCommands', n);\r\n                    this.client.print(`Time: ${p - i}\\n`, true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testfiler'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let n = this.client.getOption('enableCommands');\r\n                    this.client.setOption('enableCommands', true);\r\n                    let i = new Date().getTime();\r\n                    console.time('testfiler parse');\r\n                    this.client.telnet.receivedData(StringToUint8Array(contents), true, true);\r\n                    console.timeEnd('testfiler parse');\r\n                    let p = new Date().getTime();\r\n                    this.client.setOption('enableCommands', n);\r\n                    this.client.print(`Time: ${p - i}\\n`, true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testspeedfile'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testspeedfile');\r\n            openFileDialog().then(files => {\r\n                console.time('testspeedfile readFile');\r\n                readFile(files[0]).then((contents: any) => {\r\n                    console.timeEnd('testspeedfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let avg = 0;\r\n                    let max = 0;\r\n                    let min = 0;\r\n                    let items = [];\r\n                    let p;\r\n                    console.time(`testspeedfile`);\r\n                    for (let i = 0; i < 10; i++) {\r\n                        const start = new Date().getTime();\r\n                        console.time(`testspeedfile parse ${i}`);\r\n                        this.client.sendCommand(contents, null, this.client.getOption('allowCommentsFromCommand'));\r\n                        console.timeEnd(`testspeedfile parse ${i}`);\r\n                        const end = new Date().getTime();\r\n                        p = end - start;\r\n                        avg += p;\r\n                        if (p > max) max = p;\r\n                        if (!min || p < min) min = p;\r\n                        items.push(`${i} - ${p}`);\r\n                    }\r\n                    console.timeEnd(`testspeedfile`);\r\n                    items.push(`Total - ${avg}`);\r\n                    items.push(`Average - ${avg / 10}`);\r\n                    items.push(`Min - ${min}`);\r\n                    items.push(`Max - ${max}`);\r\n                    this.client.print(items.join('\\n') + '\\n', true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n        this.functions['testspeedfiler'] = data => {\r\n            if (data && data.args && data.args.length)\r\n                throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'testspeedfiler');\r\n            openFileDialog().then(files => {\r\n                console.time('testspeedfile readFile');\r\n                readFile(files[0]).then(contents => {\r\n                    console.timeEnd('testspeedfile readFile');\r\n                    if (data && data.raw && (this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    let avg = 0;\r\n                    let max = 0;\r\n                    let min = 0;\r\n                    let items = [];\r\n                    let p;\r\n                    console.time(`testspeedfile`);\r\n                    for (let i = 0; i < 10; i++) {\r\n                        const start = new Date().getTime();\r\n                        console.time(`testspeedfile parse ${i}`);\r\n                        this.client.telnet.receivedData(StringToUint8Array(contents), true, true);\r\n                        console.timeEnd(`testspeedfile parse ${i}`);\r\n                        const end = new Date().getTime();\r\n                        p = end - start;\r\n                        avg += p;\r\n                        if (p > max) max = p;\r\n                        if (!min || p < min) min = p;\r\n                        items.push(`${i} - ${p}`);\r\n                    }\r\n                    console.timeEnd(`testspeedfile`);\r\n                    items.push(`Total - ${avg}`);\r\n                    items.push(`Average - ${avg / 10}`);\r\n                    items.push(`Min - ${min}`);\r\n                    items.push(`Max - ${max}`);\r\n                    this.client.print(items.join('\\n') + '\\n', true);\r\n                }).catch(this.client.error);\r\n            }).catch(() => { });\r\n        };\r\n\r\n        this.functions['testlist'] = () => {\r\n            let sample = 'Test commands:\\n';\r\n            let t;\r\n            for (t in this.functions) {\r\n                if (!this.functions.hasOwnProperty(t)) continue;\r\n                sample += `\\t${this.client.getOption('commandChar') + t}\\n`;\r\n            }\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testcolors'] = () => {\r\n            let r;\r\n            let sample = 'Colors and Styles\\n-------------------------------------------------------------------------------------------\\n';\r\n            for (r = 30; r < 38; r++) {\r\n                sample += '\\x1b[' + r + ';0m' + r + '\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1mBold\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';53mOverline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1;2;3;4;5;9;21;53mAll\\x1b[0m';\r\n                sample += '\\x1b[0m\\n';\r\n            }\r\n            for (r = 40; r < 48; r++) {\r\n                sample += '\\x1b[' + r + ';0m' + r + '\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1mBold\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';53mOverline\\x1b[0m ';\r\n                sample += '\\x1b[' + r + ';1;2;3;4;5;9;21;53mAll\\x1b[0m';\r\n                sample += '\\x1b[0m\\n';\r\n            }\r\n            sample += '-------------------------------------------------------------------------------------------\\n';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testcolorsdetails'] = () => {\r\n            let sample = '';\r\n            if (this.client.telnet.prompt)\r\n                sample = '\\n';\r\n            sample += 'Table for 16-color terminal escape sequences.\\n';\r\n            sample += '\\n';\r\n            sample += 'Background        | Foreground colors\\n';\r\n            sample += '------------------------------------------------------------------------------------\\n';\r\n            for (let bg = 40; bg <= 47; bg++) {\r\n                let a;\r\n                for (a in Ansi) {\r\n                    if (typeof Ansi[a] !== 'number') continue;\r\n                    if (a === 'Rapid') continue;\r\n                    //-16\r\n                    if (a === 'None')\r\n                        sample += '\\x1B[0m ' + AnsiColorCode[(bg - 10)].toString().padEnd(16) + ' | ';\r\n                    else\r\n                        sample += '\\x1B[0m ' + a.padEnd(16) + ' | ';\r\n                    //-7\r\n                    for (let fg = 30; fg <= 37; fg++) {\r\n                        if (a === 'None')\r\n                            sample += '\\x1B[' + bg + 'm\\x1B[' + fg + 'm ' + ('[' + fg + 'm').padEnd(7);\r\n                        else\r\n                            sample += '\\x1B[' + bg + 'm\\x1B[' + Ansi[a] + ';' + fg + 'm ' + ('[' + Ansi[a] + ';' + fg + 'm').padEnd(7);\r\n                    }\r\n                    sample += '\\x1B[0m\\n';\r\n                }\r\n                sample += '------------------------------------------------------------------------------------\\n';\r\n            }\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testxterm'] = title => {\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let c;\r\n            let sample = '';\r\n            if (typeof title !== 'undefined' && title.length > 0) {\r\n                sample += 'Set Title: ';\r\n                sample += title;\r\n                sample += '\\x1B]0;';\r\n                sample += title;\r\n                sample += '\\u0007\\n';\r\n            }\r\n            sample += 'System colors:\\n';\r\n\r\n            for (c = 0; c < 8; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n';\r\n            for (c = 8; c < 16; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n\\n';\r\n            sample += 'Color cube, 6x6x6:\\n';\r\n\r\n            for (g = 0; g < 6; g++) {\r\n                for (r = 0; r < 6; r++) {\r\n                    for (b = 0; b < 6; b++) {\r\n                        c = (16 + (r * 36) + (g * 6) + b);\r\n                        sample += '\\x1B[48;5;' + c + 'm  ';\r\n                    }\r\n                    sample += '\\x1B[0m ';\r\n                }\r\n                sample += '\\n';\r\n            }\r\n            sample += 'Grayscale ramp:\\n';\r\n\r\n            for (c = 232; c < 256; c++)\r\n                sample += '\\x1B[48;5;' + c + 'm  ';\r\n            sample += '\\x1B[0m\\n';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:disable\r\n        this.functions['testmxp'] = () => {\r\n            let sample = 'Text Formatting\\n';\r\n            sample += '\\t\\x1B[6z';\r\n            sample += '<!--Test-->&lt;!--Test--&gt;\\n';\r\n            sample += '\\t<!--Test>-->&lt;!--Test&gt;--&gt;\\n';\r\n            sample += '\\t<STRONG>STRONG</STRONG>\\n';\r\n            sample += '\\t<BOLD>BOLD</BOLD>\\n';\r\n            sample += '\\t<B>B</B>\\n';\r\n            sample += '\\t<I>I</I>\\n';\r\n            sample += '\\t<ITALIC>ITALIC</ITALIC>\\n';\r\n            sample += '\\t<EM>EM</EM>\\n';\r\n            sample += '\\t<U>U</U>\\n';\r\n            sample += '\\t<UNDERLINE>UNDERLINE</UNDERLINE>\\n';\r\n            sample += '\\t<S>S</S>\\n';\r\n            sample += '\\t<STRIKEOUT>STRIKEOUT</STRIKEOUT>\\n';\r\n            sample += '\\t<H>H</H>\\n';\r\n            sample += '\\t<HIGH>HIGH</HIGH>\\n';\r\n            sample += '\\t<C RED>C RED</C>\\n';\r\n            sample += '\\t<COLOR #F00>COLOR #F00</COLOR>\\n';\r\n            sample += '\\t<C Maroon>C Maroon</C>\\n';\r\n            sample += '\\t<COLOR #800000>COLOR #800000</COLOR>\\n';\r\n            sample += '\\t<H><C Maroon>H C Maroon</C></H>\\n';\r\n            sample += '\\t<H><COLOR #800000>H COLOR #800000</COLOR></H>\\n';\r\n            sample += '\\tRun <send PROMPT>#testmxpcolors</send> for a detailed list.\\n';\r\n            sample += '\\t<FONT \"Times New Roman\">FONT \"Times New Roman\"</FONT>\\n';\r\n            sample += '\\t<FONT \"Webdings\">FONT \"Webdings\"</FONT>\\n';\r\n            sample += '\\t<FONT COLOR=Red,Blink>FONT COLOR=Red,Blink</FONT>\\n';\r\n            sample += '\\t<FONT \"Times New Roman\" 24 RED GREEN>FONT \"Times New Roman\" 24 RED GREEN</FONT>\\n';\r\n            sample += 'Line Spacing\\n';\r\n            sample += '\\tNOBR<NOBR>\\n';\r\n            sample += ' Continued<NOBR>\\n';\r\n            sample += ' More\\n';\r\n            sample += '\\t<P>P\\n';\r\n            sample += '\\t1\\n';\r\n            sample += '\\t2\\n';\r\n            sample += '\\t3\\n';\r\n            sample += '\\t4</P>\\n';\r\n            sample += '\\tBR Line<BR>Break\\n';\r\n            sample += '\\tSBR Soft<SBR>Break\\n';\r\n            sample += 'Links\\n';\r\n            sample += '\\t<A \"http://shadowmud.com\">Click here for ShadowMUD</A> \\n';\r\n            sample += '\\t<send>test command</send>\\n';\r\n            sample += '\\t<send href=\"command2\">test command2</send>\\n';\r\n            sample += '\\t<send \"command1|command2|command3\" hint=\"click to see menu|Item 1|Item 2|Item 3\">this is a menu link</SEND>\\n';\r\n            sample += '\\t<SEND \"sample\" PROMPT EXPIRE=prompt>Prompt sample</SEND>\\n';\r\n            sample += '\\t<send PROMPT href=\"#testmxpexpire\">&lt;EXPIRE&gt; - #testmxpexpire</send> \\n';\r\n            sample += 'Horizontal Rule\\n';\r\n            sample += '<hr>\\n';\r\n            sample += '<hr>Text After\\n';\r\n            sample += 'Text Before<hr>\\n';\r\n            sample += '<c red blue><hr></c>\\n';\r\n            sample += 'Text Before<hr>Text After\\n';\r\n            sample += 'Custom Element\\n';\r\n            sample += '\\t<!ELEMENT help \\'<send href=\"help &text;\">\\'>&lt;!ELEMENT help \\'&lt;send href=\"help &amp;text;\"&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;help&gt;test&lt;/help&gt; = <help>test</help>\\n';\r\n            sample += '\\t<!ELEMENT redbu \\'<c red><b><u>\\'>&lt;!ELEMENT redbu \\'&lt;c red&gt;&lt;b&gt;&lt;u&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;redbu&gt;test&lt;/redbu&gt; = <redbu>test</redbu>\\n';\r\n            sample += 'Entities\\n';\r\n            sample += '\\t&#243;&brvbar;&copy;&plusmn;&sup3;&para;&frac34;&infin;&Dagger;&dagger;&spades;&clubs;&hearts;&diams;\\n';\r\n            sample += 'Custom Entity\\n';\r\n            sample += '\\t<!ENTITY version \"' + this.client.version + '\">&lt;!ENTITY version \"' + this.client.version + '\"&gt;\\n';\r\n            sample += '\\t&amp;version; = &version;\\n';\r\n            sample += '\\t&lt;V Hp&gt;<V Hp>100</V>&lt;/V&gt; &amp;Hp; = &Hp; &amp;hp; = &hp;\\n';\r\n            sample += '\\t&lt;VAR Sp&gt;<VAR Sp>200</VAR>&lt;/VAR&gt; &amp;Sp; = &Sp; &amp;sp; = &sp;\\n';\r\n            sample += 'Image\\n';\r\n            sample += 'default      <image connected.png URL=\"./images/\" w=48 h=48>\\n';\r\n            sample += 'align left <image connected.png URL=\"./images/\" align=left w=48 h=48> align left\\n';\r\n            sample += 'align right  <image connected.png URL=\"./images/\" align=right w=48 h=48> align right\\n';\r\n            sample += 'align top    <image connected.png URL=\"./images/\" align=top w=48 h=48> align top \\n';\r\n            sample += 'align middle <image connected.png URL=\"./images/\" align=middle w=48 h=48> align middle\\n';\r\n            sample += 'align bottom <image connected.png URL=\"./images/\" align=bottom w=48 h=48> align bottom\\n';\r\n            sample += 'map          <send showmap><image connected.png URL=\"./images/\" ismap w=48 h=48></send>\\n';\r\n            sample += '<STAT Hp version Test>';\r\n            sample += '<GAUGE Hp version Test>';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxp2'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += '<!-- Elements to support the Auto mapper -->';\r\n            sample += '<!ELEMENT RName \\'<FONT COLOR=Red><B>\\' FLAG=\"RoomName\">';\r\n            sample += '<!ELEMENT RDesc FLAG=\\'RoomDesc\\'>';\r\n            sample += '<!ELEMENT RExits \\'<FONT COLOR=Blue>\\' FLAG=\\'RoomExit\\'>';\r\n            sample += '<!-- The next element is used to define a room exit link that sends ';\r\n            sample += 'the exit direction to the MUD if the user clicks on it -->';\r\n            sample += '<!ELEMENT Ex \\'<SEND>\\'>';\r\n            sample += '<!ELEMENT Chat \\'<FONT COLOR=Gray>\\' OPEN>';\r\n            sample += '<!ELEMENT Gossip \\'<FONT COLOR=Cyan>\\' OPEN>';\r\n            sample += '<!-- in addition to standard HTML Color specifications, you can use ';\r\n            sample += 'color attribute names such as blink -->';\r\n            sample += '<!ELEMENT ImmChan \\'<FONT COLOR=Red,Blink>\\'>';\r\n            sample += '<!ELEMENT Auction \\'<FONT COLOR=Purple>\\' OPEN>';\r\n            sample += '<!ELEMENT Group \\'<FONT COLOR=Blue>\\' OPEN>';\r\n            sample += '<!-- the next elements deal with the MUD prompt -->';\r\n            sample += '<!ELEMENT Prompt FLAG=\"Prompt\">';\r\n            sample += '<!ELEMENT Hp FLAG=\"Set hp\">';\r\n            sample += '<!ELEMENT MaxHp FLAG=\"Set maxhp\">';\r\n            sample += '<!ELEMENT Mana FLAG=\"Set mana\">';\r\n            sample += '<!ELEMENT MaxMana FLAG=\"Set maxmana\">';\r\n            sample += '<!-- now the MUD text -->';\r\n            sample += '<RName>The Main Temple</RName>\\n';\r\n            sample += '<RDesc>This is the main hall of the MUD where everyone starts.\\n';\r\n            sample += 'Marble arches lead south into the town, and there is a <i>lovely</i>\\n';\r\n            sample += '<send \"drink &text;\">fountain</send> in the center of the temple,</RDesc>\\n';\r\n            sample += '<RExits>Exits: <Ex>N</Ex>, <Ex>S</Ex>, <Ex>E</Ex>, <Ex>W</Ex></RExits>\\n\\n';\r\n            sample += '<Prompt>[<Hp>100</Hp>/<MaxHp>120</MaxHp>hp <Mana>50</Mana>/<MaxMana>55</MaxMana>mana]</Prompt>\\n<hr>';\r\n            sample += '<!ELEMENT boldtext \\'<COLOR &col;><B>\\' ATT=\\'col=red\\'>';\r\n            sample += '<boldtext>This is bold red</boldtext>\\n';\r\n            sample += '<boldtext col=blue>This is bold blue text</boldtext>\\n';\r\n            sample += '<boldtext blue>This is also bold blue text</boldtext>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:enable\r\n        this.functions['testmxpexpire'] = () => {\r\n            this.client.print('\\t\\x1B[6z<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\n', true);\r\n            this.client.print('\\t\\x1B[6z\\x1b[36m<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\x1b[0m\\n', true);\r\n            this.client.print('\\t\\x1B[6z\\x1b[46;30m<SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire sample2</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire sample3</SEND>\\x1B[0z\\x1b[0m\\n', true);\r\n            this.client.print('\\t\\x1B[6z<SEND \"sample\" PROMPT EXPIRE=prompt>Expire \\x1b[36msample\\x1b[0m</SEND> <SEND \"sample\" PROMPT EXPIRE=prompt2>Expire \\x1b[36msample2\\x1b[0m</SEND><EXPIRE prompt> <SEND \"sample\" PROMPT EXPIRE=prompt>Expire \\x1b[36msample3\\x1b[0m</SEND>\\x1B[0z\\n', true);\r\n        };\r\n\r\n        this.functions['testmxpcolors'] = () => {\r\n            const colors = ['IndianRed', 'LightCoral', 'Salmon', 'DarkSalmon', 'LightSalmon',\r\n                'Crimson', 'Red', 'FireBrick', 'DarkRed', 'Pink', 'LightPink', 'HotPink', 'DeepPink',\r\n                'MediumVioletRed', 'PaleVioletRed', 'LightSalmon', 'Coral', 'Tomato', 'OrangeRed',\r\n                'DarkOrange', 'Orange', 'Gold', 'Yellow', 'LightYellow', 'LemonChiffon',\r\n                'LightGoldenrodYellow', 'PapayaWhip', 'Moccasin', 'PeachPuff', 'PaleGoldenrod',\r\n                'Khaki', 'DarkKhaki', 'Lavender', 'Thistle', 'Plum', 'Violet', 'Orchid', 'Fuchsia',\r\n                'Magenta', 'MediumOrchid', 'MediumPurple', 'BlueViolet', 'DarkViolet',\r\n                'DarkOrchid', 'DarkMagenta', 'Purple', 'Indigo', 'SlateBlue', 'DarkSlateBlue',\r\n                'MediumSlateBlue', 'GreenYellow', 'Chartreuse', 'LawnGreen', 'Lime', 'LimeGreen',\r\n                'PaleGreen', 'LightGreen', 'MediumSpringGreen', 'SpringGreen', 'MediumSeaGreen',\r\n                'SeaGreen', 'ForestGreen', 'Green', 'DarkGreen', 'YellowGreen', 'OliveDrab',\r\n                'Olive', 'DarkOliveGreen', 'MediumAquamarine', 'DarkSeaGreen', 'LightSeaGreen',\r\n                'DarkCyan', 'Teal', 'Aqua', 'Cyan', 'LightCyan', 'PaleTurquoise', 'Aquamarine',\r\n                'Turquoise', 'MediumTurquoise', 'DarkTurquoise', 'CadetBlue', 'SteelBlue',\r\n                'LightSteelBlue', 'PowderBlue', 'LightBlue', 'SkyBlue', 'LightSkyBlue',\r\n                'DeepSkyBlue', 'DodgerBlue', 'CornflowerBlue', 'MediumSlateBlue', 'RoyalBlue',\r\n                'Blue', 'MediumBlue', 'DarkBlue', 'Navy', 'MidnightBlue', 'Cornsilk',\r\n                'BlanchedAlmond', 'Bisque', 'NavajoWhite', 'Wheat', 'BurlyWood', 'Tan',\r\n                'RosyBrown', 'SandyBrown', 'Goldenrod', 'DarkGoldenrod', 'Peru', 'Chocolate',\r\n                'SaddleBrown', 'Sienna', 'Brown', 'Maroon', 'White', 'Snow', 'Honeydew',\r\n                'MintCream', 'Azure', 'AliceBlue', 'GhostWhite', 'WhiteSmoke', 'Seashell',\r\n                'Beige', 'OldLace', 'FloralWhite', 'Ivory', 'AntiqueWhite', 'Linen',\r\n                'LavenderBlush', 'MistyRose', 'Gainsboro', 'LightGrey', 'Silver', 'DarkGray',\r\n                'Gray', 'DimGray', 'LightSlateGray', 'SlateGray', 'DarkSlateGray', 'Black'];\r\n            let sample = '\\x1B[6z';\r\n            const cl = colors.length - 1;\r\n            for (let c = 0; c < cl; c++) {\r\n                sample += '' + colors[c] + ': ';\r\n                sample += Array(22 - colors[c].length).join(' ');\r\n                sample += '<C ' + colors[c] + '>Fore</C> ';\r\n                sample += '<C black ' + colors[c] + '>Back</C> ';\r\n                sample += '<h><C ' + colors[c] + '>High</C></h> ';\r\n                sample += '<b><C ' + colors[c] + '>Bold</C></b> ';\r\n                sample += '<C ' + colors[c] + '>\\x1b[1mAnsiBold\\x1b[0m ';\r\n                sample += '\\x1b[2mFaint\\x1b[0m ';\r\n                sample += '\\x1b[3mItalic\\x1b[0m ';\r\n                sample += '\\x1b[4mUnderline\\x1b[0m ';\r\n                sample += '\\x1b[5mFlash\\x1b[0m ';\r\n                sample += '\\x1b[7mInverse\\x1b[0m ';\r\n                sample += '\\x1b[8mConceal\\x1b[0m ';\r\n                sample += '\\x1b[9mStrikeout\\x1b[0m ';\r\n                sample += '\\x1b[21mDoubleUnderline\\x1b[0m ';\r\n                sample += '\\x1b[53mOverline\\x1b[0m';\r\n                sample += '</C>\\n';\r\n            }\r\n            sample += 'Black: ';\r\n            sample += Array(17).join(' ');\r\n            sample += '<C Black silver>Fore</C> ';\r\n            sample += '<C silver Black>Back</C> ';\r\n            sample += '<h><C Black silver>High</C></h> ';\r\n            sample += '<b><C Black silver>Bold</C></b> ';\r\n            sample += '<C Black silver>\\x1b[1mAnsiBold\\x1b[0m ';\r\n            sample += '\\x1b[2mFaint\\x1b[0m ';\r\n            sample += '\\x1b[3mItalic\\x1b[0m ';\r\n            sample += '\\x1b[4mUnderline\\x1b[0m ';\r\n            sample += '\\x1b[5mFlash\\x1b[0m ';\r\n            sample += '\\x1b[7mInverse\\x1b[0m ';\r\n            sample += '\\x1b[8mConceal\\x1b[0m ';\r\n            sample += '\\x1b[9mStrikeout\\x1b[0m ';\r\n            sample += '\\x1b[21mDoubleUnderline\\x1b[0m ';\r\n            sample += '\\x1b[53mOverline\\x1b[0m';\r\n            sample += '</C>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxpelements'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += 'Custom Element\\n';\r\n            sample += '\\t<!ELEMENT help \\'<send href=\"help &text;\">\\'>&lt;!ELEMENT help \\'&lt;send href=\"help &amp;text;\"&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;help&gt;test&lt;/help&gt; = <help>test</help>\\n';\r\n            sample += '\\t<!ELEMENT redbu \\'<c red><b><u>\\'>&lt;!ELEMENT redbu \\'&lt;c red&gt;&lt;b&gt;&lt;u&gt;\\'&gt;\\n';\r\n            sample += '\\t&lt;redbu&gt;test&lt;/redbu&gt; = <redbu>test</redbu>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmxplines'] = () => {\r\n            let sample = '\\x1B[6z';\r\n            sample += '<!ELEMENT Auction \\'<FONT COLOR=red>\\' TAG=20 OPEN>';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>';\r\n            sample += '<!ELEMENT Auction TAG=20>\\n';\r\n            sample += '<!TAG 20 Fore=red>\\n';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>\\n';\r\n            sample += '\\x1B[6z<!TAG 20 Fore=blue>\\n';\r\n            sample += '\\x1B[20zA nice shiny sword is being auctioned.\\n';\r\n            sample += '\\x1B[6z<Auction>Also, a gold ring is being auctioned.</Auction>\\n';\r\n            sample += '\\x1B[0z';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testmapper'] = () => {\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 0, dir: '', area: '' },\r\n                area: 'Doc Build Samples Area',\r\n                exits: {\r\n                    south: { num: 87723359, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -329701270, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 1',\r\n                num: 1968208336,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 1968208336, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'wood',\r\n                exits: {\r\n                    south: { num: 1916648905, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -1688332036, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 1968208336, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 2',\r\n                num: -329701270,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -329701270, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'jungle',\r\n                exits: {\r\n                    south: { num: -348853133, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: -329701270, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 3',\r\n                num: -1688332036,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -1688332036, dir: 'south', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'grass',\r\n                exits: {\r\n                    north: { num: -1688332036, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: 2072768994, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 1916648905, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                }, name: 'Sample room 6',\r\n                num: -348853133,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -348853133, dir: 'west', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'desert',\r\n                exits: {\r\n                    north: { num: -329701270, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: 210551156, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: -348853133, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 87723359, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 5',\r\n                num: 1916648905,\r\n                indoors: 1\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 1916648905, dir: 'west', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'tundra',\r\n                exits: {\r\n                    north: { num: 1968208336, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    south: { num: -1674322715, dir: 'south', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 87723359, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 4',\r\n                num: 87723359,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 87723359, dir: 'south', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'water',\r\n                exits: {\r\n                    north: { num: 87723359, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 210551156, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 7',\r\n                num: -1674322715,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: -1674322715, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                environment: 'jungle',\r\n                exits: {\r\n                    north: { num: 1916648905, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    east: { num: 2072768994, dir: 'east', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: -1674322715, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 8',\r\n                num: 210551156,\r\n                indoors: 0\r\n            });\r\n            this.client.emit('received-GMCP', 'Room.Info', {\r\n                details: [],\r\n                doors: {},\r\n                prevroom: { num: 210551156, dir: 'east', area: 'Doc Build Samples Area' },\r\n                area: 'Doc Build Samples Area',\r\n                exits: {\r\n                    north: { num: -348853133, dir: 'north', area: 'Doc Build Samples Area', isdoor: 0 },\r\n                    west: { num: 210551156, dir: 'west', area: 'Doc Build Samples Area', isdoor: 0 }\r\n                },\r\n                name: 'Sample room 9',\r\n                num: 2072768994,\r\n                indoors: 0\r\n            });\r\n        };\r\n\r\n        this.functions['teststatus'] = data => {\r\n            this.client.emit('received-GMCP', 'Char.Base', {\r\n                name: 'Tester',\r\n                class: 'fighter',\r\n                subclass: 'None',\r\n                race: 'human',\r\n                level: 1,\r\n                gender: 'male'\r\n            });\r\n            this.client.emit('received-GMCP', 'Char.Vitals', {\r\n                hp: 75,\r\n                hpmax: 100,\r\n                sp: 50,\r\n                spmax: 100,\r\n                mp: 25,\r\n                mpmax: 100\r\n            });\r\n            this.client.emit('received-GMCP', 'Char.Experience', {\r\n                current: 50,\r\n                need: 100,\r\n                needPercent: 50,\r\n                earned: 200,\r\n                banked: 300\r\n            });\r\n            this.client.emit('received-GMCP', 'oMUD.limb', {\r\n                head: 10,\r\n                torso: 20,\r\n                'left arm': 30,\r\n                'right arm': 40,\r\n                'left hand': 50,\r\n                'right hand': 60,\r\n                'left leg': 70,\r\n                'right leg': 80,\r\n                'right foot': 90,\r\n                'left foot': 100,\r\n                'left wing': 90,\r\n                'right wing': 80,\r\n                tail: 70\r\n            });\r\n            this.client.emit('received-GMCP', 'oMUD.ac', {\r\n                head: 0,\r\n                torso: 1,\r\n                'left arm': 2,\r\n                'right arm': 3,\r\n                'left hand': 3.5,\r\n                'right hand': 4,\r\n                'left leg': 4.5,\r\n                'right leg': 5,\r\n                'right foot': 5.5,\r\n                'left foot': 6,\r\n                'left wing': 6.5,\r\n                'right wing': 5,\r\n                tail: 4,\r\n                overall: 4\r\n            });\r\n            this.client.emit('received-GMCP', 'oMUD.weapons', {\r\n                'right hand': { 'name': 'knife', 'type': 'knife', 'subtype': 'dagger', 'material': 'iron', 'quality': 'poor', 'dominant': 1 },\r\n                'left hand': { 'name': 'club', 'type': 'blunt', 'subtype': 'club', 'material': 'wood', 'quality': 'ordinary', 'dominant': 0 }\r\n            });\r\n            if (data && data.args && data.args.length && data.args[0] === 'night')\r\n                this.client.emit('received-GMCP', 'oMUD.Environment', { tod: 'night', moons: ['waning', 'full', 'waxing'] });\r\n            else\r\n                this.client.emit('received-GMCP', 'oMUD.Environment', { 'tod': 'day' });\r\n            this.client.emit('received-GMCP', 'oMUD.skill', { skill: 'knife', percent: 60 });\r\n            this.client.emit('received-GMCP', 'oMUD.skill', { skill: 'knife', amount: 100, bonus: 5, category: 'weapon' });\r\n            this.client.emit('received-GMCP', 'oMUD.skill', { skill: 'small sword', percent: 100 });\r\n            let found = false;\r\n            this.client.emit('received-GMCP', 'oMUD.skill', { skill: 'small sword', amount: 1150, bonus: 0, category: 'weapon' });\r\n            if (data && data.args && data.args.length) {\r\n                data.args.forEach(arg => {\r\n                    if (arg.startsWith('party:')) {\r\n                        found = true;\r\n                        let s = parseInt(arg.split(':')[1], 10);\r\n                        for (let m = 0; m < s; m++)\r\n                            this.client.emit('received-GMCP', 'oMUD.party', { 'action': 'update', 'name': 'Party ' + (m + 1), 'hp': 50, race: 'human', 'id': m });\r\n                    }\r\n                });\r\n            }\r\n            if (!found) {\r\n                this.client.emit('received-GMCP', 'oMUD.party', { 'action': 'update', 'name': 'Elf', 'hp': 50, race: 'elf', 'id': 1 });\r\n                this.client.emit('received-GMCP', 'oMUD.party', { 'action': 'update', 'name': 'Dwarf', 'hp': 100, race: 'dwarf', 'id': 2 });\r\n            }\r\n            found = false\r\n            if (data && data.args && data.args.length) {\r\n                data.args.forEach(arg => {\r\n                    if (arg.startsWith('monster:')) {\r\n                        found = true;\r\n                        let s = parseInt(arg.split(':')[1], 10);\r\n                        for (let m = 0; m < s; m++)\r\n                            this.client.emit('received-GMCP', 'oMUD.combat', { 'action': 'update', 'name': 'Monster ' + (m + 1), 'hp': 50, race: 'orc', 'id': m, order: 0 });\r\n                    }\r\n                });\r\n            }\r\n            if (!found) {\r\n                this.client.emit('received-GMCP', 'oMUD.combat', { 'action': 'update', 'name': 'Monster', 'hp': 50, race: 'orc', 'id': 3, order: 0 });\r\n                this.client.emit('received-GMCP', 'oMUD.combat', { 'action': 'update', 'name': \"Monster 2\", 'hp': 100, race: 'dragon', 'id': 4, order: 1 });\r\n                this.client.emit('received-GMCP', 'oMUD.combat', { 'action': 'update', 'name': 'Monster with extra super long name to test', 'hp': 100, race: 'dragon', 'id': 5, order: 2 });\r\n            }\r\n        };\r\n\r\n        this.functions['testfansi'] = () => {\r\n            let sample = '';\r\n            let i;\r\n            sample = String.fromCharCode(1);\r\n            for (i = 3; i <= 6; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 14; i <= 26; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 28; i <= 31; i++)\r\n                sample += String.fromCharCode(i);\r\n            for (i = 127; i <= 254; i++)\r\n                sample += String.fromCharCode(i);\r\n            sample += '\\n';\r\n            const dcc = this.client.display.displayControlCodes;\r\n            this.client.display.displayControlCodes = true;\r\n            if (!this.client.display.emulateTerminal) {\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = true;\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = false;\r\n            }\r\n            else {\r\n                this.client.display.emulateTerminal = false;\r\n                this.client.print(sample, true);\r\n                this.client.display.emulateTerminal = true;\r\n                this.client.print(sample, true);\r\n            }\r\n            this.client.display.displayControlCodes = dcc;\r\n        };\r\n\r\n        this.functions['testcontrolchars'] = () => {\r\n            let i;\r\n            let sample = '1:  ' + String.fromCharCode(1) + ',';\r\n            for (i = 3; i <= 9; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 11; i <= 27; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 28; i <= 31; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            for (i = 127; i <= 254; i++)\r\n                sample += `${i}: ${String.fromCharCode(i)},`;\r\n            sample += '\\n';\r\n            const dcc = this.client.display.displayControlCodes;\r\n            this.client.display.displayControlCodes = true;\r\n            this.client.print(sample, true)\r\n            this.client.display.displayControlCodes = dcc;\r\n        }\r\n\r\n        //spell-checker:disable\r\n        this.functions['testurldetect'] = () => {\r\n            let sample = '\\x1B[0mhttp://www.google.com\\n';\r\n            sample += '\\thttp://www.google.com\\x1B[44m\\n';\r\n            sample += 'http://www.google.com\\n';\r\n            sample += '\\ttry this http://www.google.com\\n';\r\n            sample += 'http://www.google.com try this\\n';\r\n            sample += '\\ttry this http://www.google.com try this\\n';\r\n            sample += '\\x1B[36mhttp://www.google.com\\n';\r\n            sample += '\\t\\x1B[0mhttp://www.google.com\\n';\r\n            sample += 'http://www.google.com\\x1B[44m\\n';\r\n            sample += '\\thttp://www.google.com\\n';\r\n            sample += 'try this http://www.google.com\\n';\r\n            sample += '\\thttp://www.google.com try this\\n';\r\n            sample += 'try this http://www.google.com try this\\n';\r\n            sample += '\\t\\x1B[36mhttp://www.google.com\\n';\r\n            sample += '\\thttps://localhost telnet://localhost\\n';\r\n            sample += '\\tnews://test.edu/default.asp?t=1#1111 torrent://localhost/\\n';\r\n            sample += '\\tftp://localhost gopher://localhost im://talk\\n';\r\n            sample += '\\tmailto:address@localhost irc://<host>[:<port>]/[<channel>[?<password>]]\\n';\r\n            sample += 'awww... www.google.com awww.com\\n';\r\n            sample += 'www.google.com www.google.com\\x1B[0m';\r\n            this.client.print(sample, true);\r\n        };\r\n        //spell-checker:enable\r\n\r\n        this.functions['testxtermrgb'] = () => {\r\n            let sample = '';\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let i = 0;\r\n            for (r = 0; r < 256; r += 16) {\r\n                for (g = 0; g < 256; g += 16) {\r\n                    for (b = 0; b < 256; b += 16) {\r\n                        sample += '\\x1B[48;2;' + r + ';' + g + ';' + b + 'm  ';\r\n                        if (i % 63 === 0)\r\n                            sample += '\\n';\r\n                        i++;\r\n                    }\r\n                }\r\n            }\r\n            sample += '\\x1B[0m';\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testsize'] = () => {\r\n            const ws = this.client.display.WindowSize;\r\n            let sample = ws.width + 'x' + ws.height + ' ';\r\n            ws.width -= sample.length;\r\n            for (let w = 0; w < ws.width; w++)\r\n                sample += 'w';\r\n            for (let h = 1; h < ws.height; h++)\r\n                sample += '\\n' + h;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testspeed'] = () => {\r\n            const sample = [];\r\n            const commands = this.client.getOption('commandChar') + ['testmxpcolors', 'testmxp', 'testcolors', 'testcolorsdetails', 'testxterm', 'testxtermrgb'].join('\\n' + this.client.getOption('commandChar'));\r\n            const e = this.client.getOption('enableCommands');\r\n            this.client.setOption('enableCommands', true);\r\n            let avg = 0;\r\n            let max = 0;\r\n            let min = 0;\r\n            let t;\r\n            for (let i = 0; i < 10; i++) {\r\n                const start = new Date().getTime();\r\n                this.client.sendCommand(commands);\r\n                const end = new Date().getTime();\r\n                t = end - start;\r\n                avg += t;\r\n                if (t > max) max = t;\r\n                if (!min || t < min) min = t;\r\n                sample.push(`${i} - ${t}`);\r\n            }\r\n            sample.push(`Total - ${avg}`);\r\n            sample.push(`Average - ${avg / 10}`);\r\n            sample.push(`Min - ${min}`);\r\n            sample.push(`Max - ${max}`);\r\n            this.client.print(sample.join('\\n') + '\\n', true);\r\n            this.client.setOption('enableCommands', e);\r\n        };\r\n\r\n        this.functions['testperiod'] = () => {\r\n            if (window['periodID']) {\r\n                clearInterval(window['periodID']);\r\n                delete window['period'];\r\n                delete window['periodID'];\r\n                return;\r\n            }\r\n            window['period'] = 0;\r\n            window['periodID'] = setInterval(() => {\r\n                if (window['period'] % 3 === 1)\r\n                    this.client.sendCommand('#testcolors');\r\n                else if (window['period'] % 3 === 2)\r\n                    this.client.sendCommand('#testxterm');\r\n                else\r\n                    this.client.sendCommand('#testlist');\r\n                window['period']++;\r\n            }, 2000);\r\n        };\r\n\r\n        this.functions['testutf8'] = () => {\r\n            const sample = `Armenian\r\n\u0531 \u0532 \u0533 \u0534 \u0535 \u0536 \u0537 \u0538 \u0539 \u053A \u053B \u053C \u053D \u053E \u053F \u0540 \u0541 \u0542 \u0543 \u0544 \u0545 \u0546 \u0547 \u0548 \u0549 \u054A \u054B \u054C \u054D \u054E \u054F \u0550 \u0551 \u0552 \u0553 \u0554 \u0555 \u0556 \u0559 \u055A \u055B \u055C \u055D \u055E \u055F \u0561 \u0562 \u0563 \u0564 \u0565 \u0566 \u0567 \u0568 \u0569 \u056A \u056B \u056C \u056D \u056E \u056F \u0570 \u0571 \u0572 \u0573 \u0574 \u0575 \u0576 \u0577 \u0578 \u0579 \u057A \u057B \u057C \u057D \u057E \u057F \u0580 \u0581 \u0582 \u0583 \u0584 \u0585 \u0586 \u0587 \u0589\r\nHebrew\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DC \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\r\nArabic\r\n\u060C \u061B \u061F \u0621 \u0622 \u0623 \u0624 \u0625 \u0626 \u0627 \u0628 \u0629 \u062A \u062B \u062C \u062D \u062E \u062F \u0630 \u0631 \u0632 \u0633 \u0634 \u0635 \u0636 \u0637 \u0638 \u0639 \u063A \u0640 \u0641 \u0642 \u0643 \u0644 \u0645 \u0646 \u0647 \u0648 \u0649 \u064A \u064B \u064C \u064D \u064E \u064F \u0650 \u0651 \u0652 \u0660 \u0661 \u0662 \u0663 \u0664 \u0665 \u0666 \u0667 \u0668 \u0669 \u066A \u066B \u066C \u066D \u0670 \u0671 \u0672 \u0673 \u0674 \u0675 \u0676 \u0677 \u0678 \u0679 \u067A \u067B \u067C \u067D \u067E \u067F \u0680 \u0681 \u0682 \u0683 \u0684 \u0685 \u0686 \u0687 \u0688 \u0689 \u068A \u068B \u068C \u068D \u068E \u068F \u0690 \u0691 \u0692 \u0693 \u0694 \u0695 \u0696 \u0697 \u0698 \u0699 \u069A \u069B \u069C \u069D \u069E \u069F \u06A0 \u06A1 \u06A2 \u06A3 \u06A4 \u06A5 \u06A6 \u06A7 \u06A8 \u06A9 \u06AA \u06AB \u06AC \u06AD \u06AE \u06AF \u06B0 \u06B1 ...\r\nDevanagari\r\n\u0901 \u0902 \u0903 \u0905 \u0906 \u0907 \u0908 \u0909 \u090A \u090B \u090C \u090D \u090E \u090F \u0910 \u0911 \u0912 \u0913 \u0914 \u0915 \u0916 \u0917 \u0918 \u0919 \u091A \u091B \u091C \u091D \u091E \u091F \u0920 \u0921 \u0922 \u0923 \u0924 \u0925 \u0926 \u0927 \u0928 \u0929 \u092A \u092B \u092C \u092D \u092E \u092F \u0930 \u0931 \u0932 \u0933 \u0934 \u0935 \u0936 \u0937 \u0938 \u0939 \u093C \u093D \u093E \u093F \u0940 \u0941 \u0942 \u0943 \u0944 \u0945 \u0946 \u0947 \u0948 \u0949 \u094A \u094B \u094C \u094D \u0950 \u0951 \u0952 \u0953 \u0954 \u0958 \u0959 \u095A \u095B \u095C \u095D \u095E \u095F \u0960 \u0961 \u0962 \u0963 \u0964 \u0965 \u0966 \u0967 \u0968 \u0969 \u096A \u096B \u096C \u096D \u096E \u096F \u0970\r\nArmenian\r\n\u0531 \u0532 \u0533 \u0534 \u0535 \u0536 \u0537 \u0538 \u0539 \u053A \u053B \u053C \u053D \u053E \u053F \\x1b[33m\u0540 \u0541 \u0542 \u0543 \u0544 \u0545 \u0546 \u0547 \u0548 \u0549 \u054A \u054B \u054C \u054D \u054E \u054F \u0550 \u0551 \u0552 \\x1b[34m\u0553 \u0554 \u0555 \u0556 \u0559 \u055A \u055B \u055C \u055D \u055E \u055F \u0561 \u0562 \u0563 \u0564 \u0565 \u0566 \u0567 \u0568 \u0569 \u056A \u056B \u056C \u056D \u056E \u056F \u0570\\x1b[35m \u0571 \u0572 \u0573 \u0574 \u0575 \u0576 \u0577 \u0578 \u0579 \u057A \u057B \u057C \u057D \u057E \u057F \u0580 \u0581 \u0582 \u0583 \u0584 \u0585 \u0586 \u0587 \u0589\\x1b[0m\r\nHebrew\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E\\x1b[33m \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DC\\x1b[34m \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\\x1b[0m\r\n\u0591 \u0592 \u0593 \u0594 \u0595 \u0596 \u0597 \u0598 \u0599 \u059A \u059B \u059C \u059D \u059E\\x1b[33m \u059F \u05A0 \u05A1 \u05A3 \u05A4 \u05A5 \u05A6 \u05A7 \u05A8 \u05A9 \u05AA \u05AB \u05AC \u05AD \u05AE \u05AF \u05B0 \u05B1 \u05B2 \u05B3 \u05B4 \u05B5 \u05B6 \u05B7 \u05B8 \u05B9 \u05BB \u05BC \u05BD \u05BE \u05BF \u05C0 \u05C1 \u05C2 \u05C3 \u05C4 \u05D0 \u05D1 \u05D2 \u05D3 \u05D4 \u05D5 \u05D6 \u05D7 \u05D8 \u05D9 \u05DA \u05DB \u05DCa\\x1b[34m \u05DD \u05DE \u05DF \u05E0 \u05E1 \u05E2 \u05E3 \u05E4 \u05E5 \u05E6 \u05E7 \u05E8 \u05E9 \u05EA \u05F0 \u05F1 \u05F2 \u05F3 \u05F4\\x1b[0m\r\nArabic\r\n\u060C \u061B \u061F \u0621 \u0622 \u0623 \u0624 \u0625 \u0626 \u0627 \u0628 \u0629 \u062A \u062B \u062C \u062D \u062E \u062F \u0630 \u0631 \u0632 \u0633 \u0634 \u0635 \u0636 \u0637 \u0638 \u0639\\x1b[34m \u063A \u0640 \u0641 \u0642 \u0643 \u0644 \u0645 \u0646 \u0647 \u0648 \u0649 \u064A \u064B \u064C \u064D \u064E \u064F \u0650 \u0651 \u0652 \u0660 \u0661 \u0662 \u0663 \u0664 \u0665 \u0666 \u0667 \u0668 \u0669 \u066A \u066B \u066C \u066D \u0670 \u0671 \u0672 \u0673 \u0674 \u0675 \u0676 \u0677 \u0678 \u0679 \u067A \u067B \u067C \u067D \u067E \u067F \u0680 \u0681 \u0682 \u0683 \u0684 \u0685 \u0686 \u0687 \u0688 \u0689 \u068A \u068B \u068C \u068D \u068E \u068F \u0690 \u0691 \u0692 \u0693 \u0694 \u0695 \u0696 \u0697 \u0698 \u0699 \u069A \u069B \u069C \u069D \u069E \u069F \u06A0 \u06A1 \u06A2 \u06A3 \u06A4 \u06A5 \u06A6 \\x1b[33m\u06A7 \u06A8 \u06A9 \u06AA \u06AB \u06AC \u06AD \u06AE \u06AF \u06B0 \u06B1 ...\\x1b[0m\r\nDevanagari\r\n\u0901 \u0902 \u0903 \u0905 \u0906 \u0907 \u0908 \u0909 \u090A \u090B \u090C \u090D \u090E \u090F \u0910 \u0911 \u0912 \u0913 \u0914 \u0915 \u0916 \u0917 \u0918 \u0919 \u091A \u091B \u091C \u091D \u091E \u091F \u0920 \u0921 \u0922 \u0923 \u0924 \u0925 \u0926 \u0927 \u0928 \u0929 \u092A \\x1b[33m\u092B \u092C \u092D \u092E \u092F \u0930 \u0931 \u0932 \u0933 \u0934 \u0935 \u0936 \u0937 \u0938 \u0939 \u093C \u093D \u093E \u093F \u0940 \u0941 \u0942 \u0943 \u0944 \u0945 \u0946 \u0947 \u0948 \u0949 \u094A \u094B \u094C \u094D \u0950 \u0951 \u0952 \u0953 \u0954 \u0958 \u0959 \u095A \u095B\\x1b[34m \u095C \u095D \u095E \u095F \u0960 \u0961 \u0962 \u0963 \u0964 \u0965 \u0966 \u0967 \u0968 \u0969 \u096A \u096B \u096C \u096D \u096E \u096F \u0970\\x1b[0m`;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testunicodeemoji'] = () => {\r\n            let sample = '';\r\n            //https://apps.timwhitlock.info/emoji/tables/unicode\r\n            let emojiRange = [\r\n                [0x1F601, 0x1F64F],//Emoticons ( 1F601 - 1F64F ) \r\n                [0x2702, 0x27B0], //Dingbats ( 2702 - 27B0 ) \r\n                [0x1F680, 0x1F6C0], //Transport and map symbols ( 1F680 - 1F6C0 ) \r\n                //[0x24C2, 0x1F251], //Enclosed characters ( 24C2 - 1F251 ) \r\n                [0x1F600, 0x1F636],  //Additional emoticons ( 1F600 - 1F636 )\r\n                [0x1F681, 0x1F6C5], //Additional transport and map symbols ( 1F681 - 1F6C5 ) \r\n                [0x1F30D, 0x1F567] //Other additional symbols ( 1F30D - 1F567 ) \r\n            ];\r\n            let n = 0;\r\n            for (let i = 0; i < emojiRange.length; i++) {\r\n                let range = emojiRange[i];\r\n                for (let x = range[0]; x < range[1]; x++) {\r\n                    sample += String.fromCodePoint(x);\r\n                    n++;\r\n                    if (n == 36) {\r\n                        sample += '\\n';\r\n                        n = 0;\r\n                    }\r\n                }\r\n                sample += '\\x1B[4z<hr>';\r\n                n = 0\r\n            }\r\n            let sample2 = '\\x1B[4z<hr>' + `\u00A9\u00AE\u203C\u2049#\u20E38\u20E39\u20E37\u20E30\u20E36\u20E35\u20E34\u20E33\u20E32\u20E31\u20E3\u2122\u2139\u2194\u2195\u2196\u2197\u2198\u2199\u21A9\u21AA\u231A\u231B\u23E9\u23EA\u23EB\u23EC\u23F0\u23F3\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FD\u25FE\u2600\u2601\u260E\u2611\u2614\u2615\r\n\u261D\u263A\u2648\u2649\u264A\u264B\u264C\u264D\u264E\u264F\u2650\u2651\u2652\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2693\u26A0\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\r\n\u26FA\u26FD\u2934\u2935\u2B05\u2B06\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299\uD83C\uDC04\uD83C\uDCCF\uD83C\uDF00\uD83C\uDF01\uD83C\uDF02\uD83C\uDF03\uD83C\uDF04\uD83C\uDF05\uD83C\uDF06\uD83C\uDF07\uD83C\uDF08\uD83C\uDF09\uD83C\uDF0A\uD83C\uDF0B\uD83C\uDF0C\uD83C\uDF0F\uD83C\uDF11\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\r\n\uD83C\uDF19\uD83C\uDF1B\uD83C\uDF1F\uD83C\uDF20\uD83C\uDF30\uD83C\uDF31\uD83C\uDF34\uD83C\uDF35\uD83C\uDF37\uD83C\uDF38\uD83C\uDF39\uD83C\uDF3A\uD83C\uDF3B\uD83C\uDF3C\uD83C\uDF3D\uD83C\uDF3E\uD83C\uDF3F\uD83C\uDF40\uD83C\uDF41\uD83C\uDF42\uD83C\uDF43\uD83C\uDF44\uD83C\uDF45\uD83C\uDF46\uD83C\uDF47\uD83C\uDF48\uD83C\uDF49\uD83C\uDF4A\uD83C\uDF4C\uD83C\uDF4D\uD83C\uDF4E\uD83C\uDF4F\uD83C\uDF51\r\n\uD83C\uDF52\uD83C\uDF53\uD83C\uDF54\uD83C\uDF55\uD83C\uDF56\uD83C\uDF57\uD83C\uDF58\uD83C\uDF59\uD83C\uDF5A\uD83C\uDF5B\uD83C\uDF5C\uD83C\uDF5D\uD83C\uDF5E\uD83C\uDF5F\uD83C\uDF60\uD83C\uDF61\uD83C\uDF62\uD83C\uDF63\uD83C\uDF64\uD83C\uDF65\uD83C\uDF66\uD83C\uDF67\uD83C\uDF68\uD83C\uDF69\uD83C\uDF6A\uD83C\uDF6B\uD83C\uDF6C\uD83C\uDF6D\uD83C\uDF6E\uD83C\uDF6F\uD83C\uDF70\uD83C\uDF71\uD83C\uDF72\r\n\uD83C\uDF73\uD83C\uDF74\uD83C\uDF75\uD83C\uDF76\uD83C\uDF77\uD83C\uDF78\uD83C\uDF79\uD83C\uDF7A\uD83C\uDF7B\uD83C\uDF80\uD83C\uDF81\uD83C\uDF82\uD83C\uDF83\uD83C\uDF84\uD83C\uDF85\uD83C\uDF86\uD83C\uDF87\uD83C\uDF88\uD83C\uDF89\uD83C\uDF8A\uD83C\uDF8B\uD83C\uDF8C\uD83C\uDF8D\uD83C\uDF8E\uD83C\uDF8F\uD83C\uDF90\uD83C\uDF91\uD83C\uDF92\uD83C\uDF93\uD83C\uDFA0\uD83C\uDFA1\uD83C\uDFA2\uD83C\uDFA3\uD83C\uDFA4\r\n\uD83C\uDFA5\uD83C\uDFA6\uD83C\uDFA7\uD83C\uDFA8\uD83C\uDFA9\uD83C\uDFAA\uD83C\uDFAB\uD83C\uDFAC\uD83C\uDFAD\uD83C\uDFAE\uD83C\uDFAF\uD83C\uDFB0\uD83C\uDFB1\uD83C\uDFB2\uD83C\uDFB3\uD83C\uDFB4\uD83C\uDFB5\uD83C\uDFB6\uD83C\uDFB7\uD83C\uDFB8\uD83C\uDFB9\uD83C\uDFBA\uD83C\uDFBB\uD83C\uDFBC\uD83C\uDFBD\uD83C\uDFBE\uD83C\uDFBF\uD83C\uDFC0\uD83C\uDFC1\uD83C\uDFC2\uD83C\uDFC3\uD83C\uDFC4\r\n\uD83C\uDFC6\uD83C\uDFC8\uD83C\uDFCA\uD83C\uDFE0\uD83C\uDFE1\uD83C\uDFE2\uD83C\uDFE3\uD83C\uDFE5\uD83C\uDFE6\uD83C\uDFE7\uD83C\uDFE8\uD83C\uDFE9\uD83C\uDFEA\uD83C\uDFEB\uD83C\uDFEC\uD83C\uDFED\uD83C\uDFEE\uD83C\uDFEF\uD83C\uDFF0\uD83D\uDC0C\uD83D\uDC0D\uD83D\uDC0E\uD83D\uDC11\uD83D\uDC12\uD83D\uDC14\uD83D\uDC17\uD83D\uDC18\uD83D\uDC19\uD83D\uDC1A\uD83D\uDC1B\uD83D\uDC1C\uD83D\uDC1D\r\n\uD83D\uDC1E\uD83D\uDC1F\uD83D\uDC20\uD83D\uDC21\uD83D\uDC22\uD83D\uDC23\uD83D\uDC24\uD83D\uDC25\uD83D\uDC26\uD83D\uDC27\uD83D\uDC28\uD83D\uDC29\uD83D\uDC2B\uD83D\uDC2C\uD83D\uDC2D\uD83D\uDC2E\uD83D\uDC2F\uD83D\uDC30\uD83D\uDC31\uD83D\uDC32\uD83D\uDC33\uD83D\uDC34\uD83D\uDC35\uD83D\uDC36\uD83D\uDC37\uD83D\uDC38\uD83D\uDC39\uD83D\uDC3A\uD83D\uDC3B\uD83D\uDC3C\uD83D\uDC3D\uD83D\uDC3E\r\n\uD83D\uDC40\uD83D\uDC42\uD83D\uDC43\uD83D\uDC44\uD83D\uDC45\uD83D\uDC46\uD83D\uDC47\uD83D\uDC48\uD83D\uDC49\uD83D\uDC4A\uD83D\uDC4B\uD83D\uDC4C\uD83D\uDC4D\uD83D\uDC4E\uD83D\uDC4F\uD83D\uDC50\uD83D\uDC51\uD83D\uDC52\uD83D\uDC53\uD83D\uDC54\uD83D\uDC55\uD83D\uDC56\uD83D\uDC57\uD83D\uDC58\uD83D\uDC59\uD83D\uDC5A\uD83D\uDC5B\uD83D\uDC5C\uD83D\uDC5D\uD83D\uDC5E\uD83D\uDC5F\uD83D\uDC60\uD83D\uDC61\uD83D\uDC62\r\n\uD83D\uDC63\uD83D\uDC64\uD83D\uDC66\uD83D\uDC67\uD83D\uDC68\uD83D\uDC69\uD83D\uDC6A\uD83D\uDC6B\uD83D\uDC6E\uD83D\uDC6F\uD83D\uDC70\uD83D\uDC71\uD83D\uDC72\uD83D\uDC73\uD83D\uDC74\uD83D\uDC75\uD83D\uDC76\uD83D\uDC77\uD83D\uDC78\uD83D\uDC79\uD83D\uDC7A\uD83D\uDC7B\uD83D\uDC7C\uD83D\uDC7D\uD83D\uDC7E\uD83D\uDC7F\uD83D\uDC80\uD83D\uDC81\uD83D\uDC82\uD83D\uDC83\uD83D\uDC84\uD83D\uDC85\uD83D\uDC86\r\n\uD83D\uDC87\uD83D\uDC88\uD83D\uDC89\uD83D\uDC8A\uD83D\uDC8B\uD83D\uDC8C\uD83D\uDC8D\uD83D\uDC8E\uD83D\uDC8F\uD83D\uDC90\uD83D\uDC91\uD83D\uDC92\uD83D\uDC93\uD83D\uDC94\uD83D\uDC95\uD83D\uDC96\uD83D\uDC97\uD83D\uDC98\uD83D\uDC99\uD83D\uDC9A\uD83D\uDC9B\uD83D\uDC9C\uD83D\uDC9D\uD83D\uDC9E\uD83D\uDC9F\uD83D\uDCA0\uD83D\uDCA1\uD83D\uDCA2\uD83D\uDCA3\uD83D\uDCA4\uD83D\uDCA5\uD83D\uDCA6\uD83D\uDCA7\r\n\uD83D\uDCA8\uD83D\uDCA9\uD83D\uDCAA\uD83D\uDCAB\uD83D\uDCAC\uD83D\uDCAE\uD83D\uDCAF\uD83D\uDCB0\uD83D\uDCB1\uD83D\uDCB2\uD83D\uDCB3\uD83D\uDCB4\uD83D\uDCB5\uD83D\uDCB8\uD83D\uDCB9\uD83D\uDCBA\uD83D\uDCBB\uD83D\uDCBC\uD83D\uDCBD\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDCC0\uD83D\uDCC1\uD83D\uDCC2\uD83D\uDCC3\uD83D\uDCC4\uD83D\uDCC5\uD83D\uDCC6\uD83D\uDCC7\uD83D\uDCC8\uD83D\uDCC9\uD83D\uDCCA\uD83D\uDCCB\r\n\uD83D\uDCCC\uD83D\uDCCD\uD83D\uDCCE\uD83D\uDCCF\uD83D\uDCD0\uD83D\uDCD1\uD83D\uDCD2\uD83D\uDCD3\uD83D\uDCD4\uD83D\uDCD5\uD83D\uDCD6\uD83D\uDCD7\uD83D\uDCD8\uD83D\uDCD9\uD83D\uDCDA\uD83D\uDCDB\uD83D\uDCDC\uD83D\uDCDD\uD83D\uDCDE\uD83D\uDCDF\uD83D\uDCE0\uD83D\uDCE1\uD83D\uDCE2\uD83D\uDCE3\uD83D\uDCE4\uD83D\uDCE5\uD83D\uDCE6\uD83D\uDCE7\uD83D\uDCE8\uD83D\uDCE9\uD83D\uDCEA\uD83D\uDCEB\uD83D\uDCEE\uD83D\uDCF0\r\n\uD83D\uDCF1\uD83D\uDCF2\uD83D\uDCF3\uD83D\uDCF4\uD83D\uDCF6\uD83D\uDCF7\uD83D\uDCF9\uD83D\uDCFA\uD83D\uDCFB\uD83D\uDCFC\uD83D\uDD03\uD83D\uDD0A\uD83D\uDD0B\uD83D\uDD0C\uD83D\uDD0D\uD83D\uDD0E\uD83D\uDD0F\uD83D\uDD10\uD83D\uDD11\uD83D\uDD12\uD83D\uDD13\uD83D\uDD14\uD83D\uDD16\uD83D\uDD17\uD83D\uDD18\uD83D\uDD19\uD83D\uDD1A\uD83D\uDD1B\uD83D\uDD1C\uD83D\uDD1D\uD83D\uDD1E\uD83D\uDD1F\uD83D\uDD20\r\n\uD83D\uDD21\uD83D\uDD22\uD83D\uDD23\uD83D\uDD24\uD83D\uDD25\uD83D\uDD26\uD83D\uDD27\uD83D\uDD28\uD83D\uDD29\uD83D\uDD2A\uD83D\uDD2B\uD83D\uDD2E\uD83D\uDD2F\uD83D\uDD30\uD83D\uDD31\uD83D\uDD32\uD83D\uDD33\uD83D\uDD34\uD83D\uDD35\uD83D\uDD36\uD83D\uDD37\uD83D\uDD38\uD83D\uDD39\uD83D\uDD3A\uD83D\uDD3B\uD83D\uDD3C\uD83D\uDD3D\uD83D\uDD50\uD83D\uDD51\uD83D\uDD52\uD83D\uDD53\uD83D\uDD54\uD83D\uDD55\r\n\uD83D\uDD56\uD83D\uDD57\uD83D\uDD58\uD83D\uDD59\uD83D\uDD5A\uD83D\uDD5B\uD83D\uDDFB\uD83D\uDDFC\uD83D\uDDFD\uD83D\uDDFE\uD83D\uDDFF`;\r\n            this.client.print(sample, true);\r\n            this.client.print(sample2, true);\r\n        };\r\n\r\n        this.functions['testlines'] = () => {\r\n            const maxLines = this.client.display.maxLines;\r\n            let sample = '';\r\n            const id = this.client.display.model.getNextLineID;\r\n            for (let h = 0; h < maxLines; h++)\r\n                sample += `Line: ${h}, LineID: ${id + h}\\n`;\r\n            this.client.print(sample, true);\r\n        };\r\n\r\n        this.functions['testscreen'] = () => {\r\n            let sample = 'Window innerWidth: ' + window.innerWidth;\r\n            sample += '\\nWindow innerHeight: ' + window.innerHeight;\r\n            sample += '\\nDocument clientWidth: ' + document.body.clientWidth;\r\n            sample += '\\nDocument clientHeight: ' + document.body.clientHeight;\r\n            sample += '\\nDisplay clientWidth: ' + this.client.display.container.clientWidth;\r\n            sample += '\\nDisplay clientHeight: ' + this.client.display.container.clientHeight;\r\n            sample += '\\nScreen orientation: ' + screen?.orientation?.type;\r\n            this.client.print(sample, true);\r\n        }\r\n    }\r\n\r\n    public remove(): void {\r\n        if (!this.client) return;\r\n        this.client.off('function', this._event);\r\n    }\r\n\r\n    public initialize(): void {\r\n        if (!this.client) return;\r\n        this.client.on('function', this._event);\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [];\r\n    }\r\n\r\n    public get settings(): MenuItem[] {\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Process function event to execute custom text functions\r\n     * @param data {FunctionEvent} The data about the function to execute\r\n     */\r\n    private _processFunction(data: FunctionEvent) {\r\n        let name;\r\n        //const data = { name: fun, args: args, raw: raw, handled: false, return: null };\r\n        if (!data) return;\r\n        name = data.name.toLowerCase();\r\n        //old name() format\r\n        if (name.endsWith('()'))\r\n            name = name.substring(0, name.length - 2);\r\n        if (this.functions[name]) {\r\n            console.time(name);\r\n            this.functions[name].apply(this, [data || {}]);\r\n            console.timeEnd(name);\r\n            data.handled = true;\r\n        }\r\n    }\r\n}", "import '../css/mapper.css';\r\nimport { EventEmitter } from '../core/events';\r\nimport { copyText } from '../core/library';\r\nimport * as PF from './../lib/pathfinding3D.js'\r\nimport { Map, Room, RoomDetails } from '../core/map';\r\n\r\ndeclare let fileSaveAs;\r\n\r\ninterface MouseData {\r\n    x: number;\r\n    y: number;\r\n    button: number;\r\n    state: boolean;\r\n}\r\n\r\nexport enum UpdateType { none = 0, draw = 1 }\r\n\r\ninterface MapOptions {\r\n    container?: string | JQuery | HTMLElement;\r\n    map?: Map;\r\n}\r\n\r\nexport class MapDisplay extends EventEmitter {\r\n    private _container: HTMLElement;\r\n    private _canvas: HTMLCanvasElement;\r\n    private _context: CanvasRenderingContext2D;\r\n    private _MousePrev: MouseData;\r\n    private _Mouse: MouseData;\r\n    private _MouseDown: MouseData;\r\n    private _MouseDrag: MouseData = { x: 0, y: 0, button: 0, state: false };\r\n    private _drag: boolean = false;\r\n    private _vscroll: number = 0;\r\n    private _hscroll: number = 0;\r\n    private _markers = {};\r\n    private _markedRooms;\r\n    private _updating: UpdateType = UpdateType.none;\r\n    private _rTimeout = 0;\r\n    private _drawCache;\r\n    private _focused = false;\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    private _active: Room;\r\n    private _selected: Room;\r\n    private _showLegend: boolean = false;\r\n    private _splitArea: boolean = false;\r\n    private _fillWalls: boolean = false;\r\n    private _enabled: boolean = true;\r\n    private _follow: boolean = true;\r\n    public commandDelay: number = 500;\r\n    public commandDelayCount: number = 5;\r\n    private _scale: number = 1.0;\r\n    private _mapperNavDown = false;\r\n    private _pointerCache: PointerEvent[] = [];\r\n    private _pointerDistance: number = -1;\r\n    private _showNav: boolean = true;\r\n    private _document;\r\n    private _window;\r\n    private _map: Map;\r\n\r\n    get showNavigation() { return this._showNav; }\r\n    set showNavigation(value) {\r\n        if (value === this._showNav) return;\r\n        this._showNav = value;\r\n        this._container.querySelectorAll('.MapperNavButton').forEach((e: HTMLElement) => {\r\n            e.style.display = this._showNav ? '' : 'none';\r\n        });\r\n        this._canvas.style.top = this._showNav ? '' : '0';\r\n        this._canvas.style.left = this._showNav ? '' : '0';\r\n        this._canvas.style.right = this._showNav ? '' : '0';\r\n        this._canvas.style.bottom = this._showNav ? '' : '0';\r\n        this._resizeCanvas();\r\n    }\r\n    get selected() { return this._selected; }\r\n    set selected(value: Room) {\r\n        this.emit('room-before-selected', this._selected ? this._selected.clone() : null);\r\n        this._selected = value.clone();\r\n        this.emit('room-selected', value.clone());\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    get container() { return this._container; }\r\n\r\n    set scale(value: number) {\r\n        if (value < 25)\r\n            value = 25;\r\n        if (value > 300)\r\n            value = 300;\r\n        if (this._scale !== value) {\r\n            this._scale = value / 100;\r\n            this.emit('setting-changed', 'scale', value);\r\n            this._drawCache = 0;\r\n            this._doUpdate(UpdateType.draw);\r\n        }\r\n    }\r\n    get scale(): number { return Math.round(this._scale * 100); }\r\n    set enabled(value: boolean) {\r\n        if (this._enabled !== value) {\r\n            this._enabled = value;\r\n            this.emit('setting-changed', 'enabled', value);\r\n        }\r\n    }\r\n    get enabled(): boolean { return this._enabled; }\r\n    set follow(value: boolean) {\r\n        if (this._follow !== value) {\r\n            this._follow = value;\r\n            this.emit('setting-changed', 'follow', value);\r\n        }\r\n    }\r\n    get follow(): boolean { return this._follow; }\r\n\r\n    set showLegend(value: boolean) {\r\n        if (this._showLegend !== value) {\r\n            this._showLegend = value;\r\n            this._drawCache = 0;\r\n            this._doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'legend', value);\r\n        }\r\n    }\r\n    get showLegend(): boolean { return this._showLegend; }\r\n\r\n    set splitArea(value: boolean) {\r\n        if (this._splitArea !== value) {\r\n            this._splitArea = value;\r\n            this._drawCache = 0;\r\n            this._doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'split', value);\r\n        }\r\n    }\r\n\r\n    get splitArea(): boolean { return this._splitArea; }\r\n\r\n    set fillWalls(value: boolean) {\r\n        if (this._fillWalls !== value) {\r\n            this._fillWalls = value;\r\n            this._drawCache = 0;\r\n            this._doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'fill', value);\r\n        }\r\n    }\r\n\r\n    get fillWalls(): boolean { return this._fillWalls; }\r\n\r\n    constructor(container: string | JQuery | HTMLElement | MapOptions, options?: MapOptions) {\r\n        super();\r\n        if (!container)\r\n            throw new Error('Container must be a selector, element, jquery object or Map options');\r\n        if (typeof container === 'object' && 'container' in container) {\r\n            options = Object.assign(options || {}, container);\r\n            container = options.container;\r\n            delete options.container;\r\n        }\r\n        else if (!options)\r\n            options = {};\r\n        if (typeof container === 'string') {\r\n            this._container = document.querySelector(container);\r\n            if (!this._container)\r\n                throw new Error('Invalid selector for display.');\r\n        }\r\n        else if (container instanceof $)\r\n            this._container = container[0];\r\n        else if (container instanceof HTMLElement)\r\n            this._container = container;\r\n        else if ((<HTMLElement>container).ownerDocument.defaultView && container instanceof (<HTMLElement>container).ownerDocument.defaultView.HTMLElement)\r\n            this._container = container;\r\n        else\r\n            throw new Error('Container must be a selector, element or jquery object');\r\n\r\n        this._document = this._container.ownerDocument;\r\n        this._window = this._document.defaultView;\r\n\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            //debounce(() => {\r\n            if (!this._resizeObserverCache || this._resizeObserverCache.height !== entries[0].contentRect.height || this._resizeObserverCache.width !== entries[0].contentRect.width) {\r\n                this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                this._resizeCanvas();\r\n            }\r\n            //}, 50, 'resize');\r\n        });\r\n        this._resizeObserver.observe(this._container);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    this._resizeCanvas()\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._container, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n\r\n        this._canvas = this._document.createElement('canvas');\r\n        this._canvas.id = this._container.id + '-canvas';\r\n        this._canvas.classList.add('map-canvas');\r\n        this._canvas.style.touchAction = 'none';\r\n        this._canvas.tabIndex = 1;\r\n        this._resizeCanvas()\r\n        this._container.appendChild(this._canvas);\r\n\r\n        this._container.insertAdjacentHTML('afterbegin', `<div class=\"MapperNavButton\" title=\"Scroll northwest\" style=\"top:4px;left:4px;background-position: 0px 0px;\" data-x=\"-1\" data-y=\"-1\"></div><div class=\"MapperNavButton\" title=\"Scroll north\" style=\"top:4px;left:50%;background-position: -22px 0px;margin-left:-11px;\" data-x=\"0\" data-y=\"-1\"></div><div class=\"MapperNavButton\" title=\"Scroll northeast\" style=\"top:4px;left:100%;background-position: -44px 0px;margin-left:-26px;\" data-x=\"1\" data-y=\"-1\"></div><div class=\"MapperNavButton\" title=\"Scroll west\" style=\"top:50%;left:4px;background-position: 0px -22px;margin-top:-11px;\" data-x=\"-1\" data-y=\"0\"></div><div class=\"MapperNavButton\" title=\"Scroll east\" style=\"top:50%;left:100%;background-position: -44px -22px;margin-top:-11px;margin-left:-26px;\" data-x=\"1\" data-y=\"0\"></div><div class=\"MapperNavButton\" title=\"Scroll southwest\" style=\"bottom:4px;left:4px;background-position: 0px -44px;\" data-x=\"-1\" data-y=\"1\"></div><div class=\"MapperNavButton\" title=\"Scroll south\" style=\"bottom:4px;left:50%;background-position: -22px -44px;margin-left:-11px;\" data-x=\"0\" data-y=\"1\"></div><div class=\"MapperNavButton\" title=\"Scroll southeast\" style=\"bottom:4px;left:100%;background-position: -44px -44px;margin-left:-26px;\" data-x=\"1\" data-y=\"1\"></div>`);\r\n        this._container.querySelectorAll('.MapperNavButton').forEach(e => {\r\n            e.addEventListener('wheel', (e: WheelEvent) => {\r\n                this._mapperNavDown = true;\r\n                const target = (e.currentTarget || e.target) as HTMLElement;\r\n                if (e.deltaY >= 0)\r\n                    this._mapperNavClick(-parseInt(target.dataset.x, 10), -parseInt(target.dataset.y, 10));\r\n                else\r\n                    this._mapperNavClick(parseInt(target.dataset.x, 10), parseInt(target.dataset.y, 10));\r\n                this._mapperNavDown = false;\r\n            }, { passive: true });\r\n            e.addEventListener('mouseleave', () => this._mapperNavDown = false);\r\n            e.addEventListener('mouseup', () => this._mapperNavDown = false);\r\n            e.addEventListener('mousedown', e => {\r\n                this._mapperNavDown = true;\r\n                const target = (e.currentTarget || e.target) as HTMLElement;\r\n                this._mapperNavClick(parseInt(target.dataset.x, 10), parseInt(target.dataset.y, 10));\r\n            });\r\n        });\r\n\r\n        this._context = this._canvas.getContext('2d');\r\n        this._context.mozImageSmoothingEnabled = false;\r\n        this._context.webkitImageSmoothingEnabled = false;\r\n        this._context.imageSmoothingEnabled = false;\r\n\r\n        this._canvas.addEventListener('pointerdown', e => {\r\n            this._pointerCache.push(e);\r\n            //if (this._pointerCache.length === 2)\r\n            //this._pointerDistance = Math.hypot(this._pointerCache[0].clientX - this._pointerCache[1].clientX, this._pointerCache[0].clientY - this._pointerCache[1].clientY);\r\n        });\r\n        this._canvas.addEventListener('pointermove', e => {\r\n            const index = this._pointerCache.findIndex(\r\n                (cached) => cached.pointerId === e.pointerId,\r\n            );\r\n            this._pointerCache[index] = e;\r\n            if (this._pointerCache.length === 2) {\r\n                // Calculate the distance between the two pointers\r\n                const curDiff = Math.abs(this._pointerCache[0].clientX - this._pointerCache[1].clientX);\r\n\r\n                if (this._pointerDistance > 0) {\r\n                    if (curDiff > this._pointerDistance) {\r\n                        // The distance between the two pointers has increased\r\n                        if (this.scale < 300)\r\n                            this.scale += 1;\r\n                    }\r\n                    if (curDiff < this._pointerDistance) {\r\n                        if (this.scale > 25)\r\n                            this.scale -= 1;\r\n                    }\r\n                }\r\n\r\n                // Cache the distance for the next move event\r\n                this._pointerDistance = curDiff;\r\n            }\r\n        });\r\n\r\n        const pointerUp = e => {\r\n            // Remove this event from the target's cache\r\n            const index = this._pointerCache.findIndex(\r\n                (cachedEv) => cachedEv.pointerId === e.pointerId,\r\n            );\r\n            this._pointerCache.splice(index, 1);\r\n            if (this._pointerCache.length < 2) {\r\n                this._pointerDistance = -1;\r\n            }\r\n        };\r\n        this._canvas.addEventListener('pointerup', pointerUp);\r\n        this._canvas.addEventListener('pointercancel', pointerUp);\r\n        this._canvas.addEventListener('pointerout', pointerUp);\r\n        this._canvas.addEventListener('pointerleave', pointerUp);\r\n\r\n\r\n        this._canvas.addEventListener('touchstart', e => {\r\n            this._Mouse = this.getMapMousePos(e);\r\n            this._MouseDown = this.getMapMousePos(e);\r\n            this._MouseDrag.state = true;\r\n            this._drag = e.touches.length === 1;\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('touchmove', e => {\r\n            this._MousePrev = this._Mouse;\r\n            this._Mouse = this.getMapMousePos(event);\r\n            if (this._drag) {\r\n                this._MouseDrag.x += this._MousePrev.x - this._Mouse.x;\r\n                this._MouseDrag.y += this._MousePrev.y - this._Mouse.y;\r\n                const x = Math.floor(this._MouseDrag.x / 32 / this._scale);\r\n                const y = Math.floor(this._MouseDrag.y / 32 / this._scale);\r\n                if (x > 0 || x < 0 || y < 0 || y > 0) {\r\n                    this._MouseDrag.x -= x * 32 * this._scale;\r\n                    this._MouseDrag.y -= y * 32 * this._scale;\r\n                    this.scrollBy(x, y);\r\n                }\r\n                this._canvas.style.cursor = 'move';\r\n            }\r\n            e.preventDefault();\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('touchend', e => {\r\n            this._Mouse = this.getMapMousePos(e);\r\n            if (!this._MouseDown)\r\n                this._MouseDown = this.getMapMousePos(e);\r\n            if (this._Mouse.button === 0 && Math.floor(this._Mouse.x / 32 / this._scale) === Math.floor(this._MouseDown.x / 32 / this._scale) && Math.floor(this._Mouse.y / 32 / this._scale) === Math.floor(this._MouseDown.y / 32 / this._scale)) {\r\n                const x = this._Mouse.x;\r\n                const y = this._Mouse.y;\r\n                const room = this.findActiveRoomByCoords(x, y);\r\n                if (!this.selected || (room && room.num !== this.selected.num))\r\n                    this.selected = room;\r\n            }\r\n            this._MouseDrag.state = false;\r\n            this._drag = false;\r\n            this._canvas.style.cursor = 'default;'\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('mousemove', event => {\r\n            this._MousePrev = this._Mouse;\r\n            this._Mouse = this.getMapMousePos(event);\r\n            if (this._drag) {\r\n                this._MouseDrag.x += this._MousePrev.x - this._Mouse.x;\r\n                this._MouseDrag.y += this._MousePrev.y - this._Mouse.y;\r\n                const x = Math.floor(this._MouseDrag.x / 32 / this._scale);\r\n                const y = Math.floor(this._MouseDrag.y / 32 / this._scale);\r\n                if (x > 0 || x < 0 || y < 0 || y > 0) {\r\n                    this._MouseDrag.x -= x * 32 * this._scale;\r\n                    this._MouseDrag.y -= y * 32 * this._scale;\r\n                    this.scrollBy(x, y);\r\n                }\r\n                this._canvas.style.cursor = 'move';\r\n            }\r\n            event.preventDefault();\r\n        });\r\n        this._canvas.addEventListener('mousedown', event => {\r\n            this._Mouse = this.getMapMousePos(event);\r\n            this._MouseDown = this.getMapMousePos(event);\r\n            this._MouseDrag.state = true;\r\n            this._drag = this._MouseDown.button === 0;\r\n        });\r\n        this._canvas.addEventListener('mouseup', event => {\r\n            this._Mouse = this.getMapMousePos(event);\r\n            if (!this._MouseDown)\r\n                this._MouseDown = this.getMapMousePos(event);\r\n            if (this._Mouse.button === 0 && Math.floor(this._Mouse.x / 32 / this._scale) === Math.floor(this._MouseDown.x / 32 / this._scale) && Math.floor(this._Mouse.y / 32 / this._scale) === Math.floor(this._MouseDown.y / 32 / this._scale)) {\r\n                const x = this._Mouse.x;\r\n                const y = this._Mouse.y;\r\n                const room = this.findActiveRoomByCoords(x, y);\r\n                if (!this.selected || (room && room.num !== this.selected.num))\r\n                    this.selected = room;\r\n            }\r\n            this._MouseDrag.state = false;\r\n            this._drag = false;\r\n            this._canvas.style.cursor = 'default;'\r\n        });\r\n        this._canvas.addEventListener('wheel', e => {\r\n            if (e.deltaY >= 0)\r\n                this.scale -= 5;\r\n            else\r\n                this.scale += 5;\r\n        }, { passive: true });\r\n        this._canvas.addEventListener('mouseenter', event => {\r\n            this._Mouse = this.getMapMousePos(event);\r\n        });\r\n        this._canvas.addEventListener('mouseleave', event => {\r\n            this._Mouse = this.getMapMousePos(event);\r\n            if (this._drag) {\r\n                this._doUpdate(UpdateType.draw);\r\n                this._drag = false;\r\n                $(this._canvas).css('cursor', 'default');\r\n            }\r\n        });\r\n        this._canvas.addEventListener('contextmenu', event => {\r\n            event.preventDefault();\r\n            const m = this.getMapMousePos(event);\r\n            this.emit('context-menu', this.findActiveRoomByCoords(m.x, m.y).clone());\r\n            return false;\r\n        });\r\n        this._canvas.addEventListener('click', event => {\r\n            event.preventDefault();\r\n            this._MouseDrag.state = false;\r\n            this._drag = false;\r\n            $(this._canvas).css('cursor', 'default');\r\n        });\r\n        this._canvas.addEventListener('dblclick', event => {\r\n            event.preventDefault();\r\n            this._Mouse = this.getMapMousePos(event);\r\n            this._MouseDown = this.getMapMousePos(event);\r\n            this._MouseDrag.state = true;\r\n            this._drag = true;\r\n            $(this._canvas).css('cursor', 'move');\r\n        });\r\n        this._canvas.onselectstart = () => { return false; };\r\n        this._canvas.addEventListener('focus', (e) => {\r\n            this._setFocus(true);\r\n        });\r\n        this._canvas.addEventListener('blur', (e) => {\r\n            this._setFocus(false);\r\n        });\r\n        this._canvas.addEventListener('keydown', (e) => {\r\n            if (!this._focused) return;\r\n            switch (e.which) {\r\n                case 27:\r\n                    e.preventDefault();\r\n                    this._MouseDrag.state = false;\r\n                    this._drag = false;\r\n                    $(this._canvas).css('cursor', 'default');\r\n                    break;\r\n                case 38: //up\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, -1);\r\n                    break;\r\n                case 40: //down\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, 1);\r\n                    break;\r\n                case 37: //left\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 0);\r\n                    break;\r\n                case 39: //right\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 0);\r\n                    break;\r\n                case 110:\r\n                case 46: //delete\r\n                    e.preventDefault();\r\n                    this.emit('delete-selected');\r\n                    break;\r\n                case 97: //num1\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 1);\r\n                    break;\r\n                case 98: //num2\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, 1);\r\n                    break;\r\n                case 99: //num3\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 1);\r\n                    break;\r\n                case 100: //num4\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, 0);\r\n                    break;\r\n                case 101: //num5\r\n                case 36: //home\r\n                    e.preventDefault();\r\n                    this.focusCurrentRoom();\r\n                    break;\r\n                case 102: //num6\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, 0);\r\n                    break;\r\n                case 103: //num7\r\n                    e.preventDefault();\r\n                    this.scrollBy(-1, -1);\r\n                    break;\r\n                case 104: //num8\r\n                    e.preventDefault();\r\n                    this.scrollBy(0, -1);\r\n                    break;\r\n                case 105: //num9\r\n                    e.preventDefault();\r\n                    this.scrollBy(1, -1);\r\n                    break;\r\n                case 107: //+\r\n                    e.preventDefault();\r\n                    this.setLevel(this.active.z + 1);\r\n                    break;\r\n                case 109: //-\r\n                    e.preventDefault();\r\n                    this.setLevel(this.active.z - 1);\r\n                    break;\r\n                case 111: // /\r\n                    e.preventDefault();\r\n                    this.setZone(this.active.zone - 1);\r\n                    break;\r\n                case 106: // *\r\n                    e.preventDefault();\r\n                    this.setZone(this.active.zone + 1);\r\n                    break;\r\n            }\r\n        });\r\n        this.reset();\r\n        this.map = options.map;\r\n        this.refresh();\r\n    }\r\n\r\n    public getMapMousePos(evt): MouseData {\r\n        const rect = this._canvas.getBoundingClientRect();\r\n        if (evt.touches && evt.touches.length)\r\n            return {\r\n                x: evt.touches[0].clientX - rect.left,\r\n                y: evt.touches[0].clientY - rect.top,\r\n                button: 0,\r\n                state: false\r\n            };\r\n\r\n        return {\r\n            x: evt.clientX - rect.left,\r\n            y: evt.clientY - rect.top,\r\n            button: evt.button,\r\n            state: false\r\n        };\r\n    }\r\n\r\n    public scrollBy(x: number, y: number) {\r\n        this._vscroll += x;\r\n        this._hscroll += y;\r\n        this._doUpdate(UpdateType.draw);\r\n        this.emit('setting-changed', 'vscroll', this._vscroll);\r\n        this.emit('setting-changed', 'hscroll', this._hscroll);\r\n    }\r\n\r\n    public scrollTo(x: number, y: number) {\r\n        this._vscroll = x;\r\n        this._hscroll = y;\r\n        this._doUpdate(UpdateType.draw);\r\n        this.emit('setting-changed', 'vscroll', this._vscroll);\r\n        this.emit('setting-changed', 'hscroll', this._hscroll);\r\n    }\r\n\r\n    public findActiveRoomByCoords(rx: number, ry: number) {\r\n        let x = this._vscroll - (this._canvas.width / 32 / 2 / this._scale);\r\n        let y = this._hscroll - (this._canvas.height / 32 / 2 / this._scale);\r\n        let ox = 15.5 * this._scale;\r\n        let oy = 15.5 * this._scale;\r\n        if (this._canvas.width % 2 !== 0)\r\n            ox = 15 * this._scale;\r\n        if (this._canvas.height % 2 !== 0)\r\n            oy = 15 * this._scale;\r\n        x += (rx - ox) / 32 / this._scale;\r\n        y += (ry - oy) / 32 / this._scale;\r\n        x = Math.floor(x);\r\n        y = Math.floor(y);\r\n        if (this._splitArea)\r\n            return this.map.getRoom({ x: x, y: y, z: this.active.z, zone: this.active.zone, area: this.active.area }) || new Room();\r\n        return this.map.getRoom({ x: x, y: y, z: this.active.z, zone: this.active.zone }) || new Room();\r\n    }\r\n\r\n    public draw(canvas?: HTMLCanvasElement, context?: CanvasRenderingContext2D, ex?: boolean) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!canvas)\r\n                canvas = this._canvas;\r\n            if (!context)\r\n                context = this._context;\r\n            if (!ex) ex = false;\r\n            //cant get map canvas bail\r\n            if (!canvas || !context || !this._map) {\r\n                reject();\r\n                return;\r\n            }\r\n\r\n            const x = this._vscroll - (canvas.width / 32 / 2 / this._scale);\r\n            const y = this._hscroll - (canvas.height / 32 / 2 / this._scale);\r\n            const z = this.active.z || 0;\r\n            const area = this.active.area || '';\r\n            const zone = this.active.zone || 0;\r\n            let ox = 15.5 * this._scale;\r\n            let oy = 15.5 * this._scale;\r\n            if (canvas.width % 2 !== 0)\r\n                ox = 15 * this._scale;\r\n            if (canvas.height % 2 !== 0)\r\n                oy = 15 * this._scale;\r\n\r\n            context.font = '8pt Arial';\r\n            const s = new Date().getTime();\r\n            const $w = canvas.width / 32 / this._scale + 1;\r\n            const $h = canvas.height / 32 / this._scale + 1;\r\n            const $x = x - 1;\r\n            const $y = y - 1;\r\n            const rooms: Room[] = Object.values(this._map.Rooms).filter(room => {\r\n                if (room.zone !== zone || room.z !== z) return false;\r\n                if (this._splitArea && room.area !== area) return false;\r\n                if (((0 <= (room.x - $x) && (room.x - $x) <= $w) && (0 <= (room.y - $y) && (room.y - $y) <= $h) || (0 <= (room.x - $x) && (room.x - $x) <= $w) && (0 <= (room.y - $y + 1) && (room.y - $y + 1) <= $h) || (0 <= (room.x - $x + 1) && (room.x - $x + 1) <= $w) && (0 <= (room.y - $y + 1) && (room.y - $y + 1) <= $h) || (0 <= (room.x - $x + 1) && (room.x - $x + 1) <= $w) && (0 <= (room.y - $y) && (room.y - $y) <= $h)))\r\n                    return true;\r\n                return false;\r\n            });\r\n\r\n\r\n            this.emit('debug', 'Mapper: Draw - room query time: ' + (new Date().getTime() - s));\r\n            const d = new Date().getTime();\r\n            if (ex) {\r\n                context.fillStyle = '#eae4d6';\r\n                context.fillRect(0, 0, canvas.width, canvas.height);\r\n            }\r\n            else\r\n                context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n            this.emit('debug', 'Mapper: Draw - room calculations time: ' + (new Date().getTime() - s));\r\n            for (let r = 0, rl = rooms.length; r < rl; r++) {\r\n                const room = rooms[r];\r\n                this.DrawRoom(context, (room.x - x) * 32 * this._scale + ox, (room.y - y) * 32 * this._scale + oy, room, ex, this._scale);\r\n            }\r\n\r\n            this.emit('debug', 'Mapper: Draw - display time: ' + (new Date().getTime() - d));\r\n            this.emit('debug', 'Mapper: Draw - final time: ' + (new Date().getTime() - s));\r\n            this.DrawLegend(context, 1, -4, 0);\r\n            resolve(true);\r\n        });\r\n    }\r\n\r\n    public reset(type?) {\r\n        if (this._map && (!type || type === 1)) {\r\n            this._map.current = new Room();\r\n            this.emit('current-changed', this._map.current);\r\n        }\r\n        if (!type) {\r\n            this.active = new Room();\r\n            this.selected = new Room();\r\n        }\r\n    }\r\n\r\n    public refresh() {\r\n        this._drawCache = 0;\r\n        this._doUpdate(UpdateType.draw);\r\n        this.emit('refresh');\r\n    }\r\n\r\n    public focusCurrentRoom() {\r\n        if (this._map && this._map.current && this._map.current.num) {\r\n            this.active = this._map.current;\r\n            this.emit('active-room-changed', this.active.clone());\r\n        }\r\n        this.focusActiveRoom();\r\n    }\r\n\r\n    public focusActiveRoom() {\r\n        if (!this.active) return;\r\n        this.scrollTo(this.active.x + 1, this.active.y + 1);\r\n    }\r\n\r\n    public set active(value) {\r\n        this._active = value && value.clone ? value.clone() : value;\r\n        this.emit('active-room-changed', this._active);\r\n    }\r\n    public get active() { return this._active; }\r\n\r\n    public get current() { return this._map.current; }\r\n    public set current(value) {\r\n        this.emit('path-cleared');\r\n        if (!value || !value.num) value = this.selected;\r\n        this._map.current = value.clone();\r\n        this._markers = {};\r\n        this._markedRooms = 0;\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public setArea(area: string) {\r\n        this.active.area = area;\r\n        if (this._map.current.num !== null && this._map.current.area === this.active.area) {\r\n            this.active = this._map.current;\r\n            this.focusActiveRoom();\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n        else {\r\n            const room = this._map.getRoom({ area: area });\r\n            if (room) {\r\n                this.active = room;\r\n                this.focusActiveRoom();\r\n                this.emit('setting-changed', 'active', this.active);\r\n            }\r\n        }\r\n    }\r\n\r\n    public setLevel(level: number) {\r\n        if (level !== this.active.z) {\r\n            this.active.z = level;\r\n            this._doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n    }\r\n\r\n    public setZone(zone: number) {\r\n        if (zone !== this.active.zone) {\r\n            this.active.zone = zone;\r\n            this._doUpdate(UpdateType.draw);\r\n            this.emit('setting-changed', 'active', this.active);\r\n        }\r\n    }\r\n\r\n    public removeRoom(room) {\r\n        if (this._map.roomExists({ num: room.num })) {\r\n            this._map.removeRoom(room);\r\n            this.emit('remove-done', room);\r\n            if (room.num === this._map.current.num) {\r\n                this._map.current = new Room();\r\n                this.emit('current-changed', this._map.current);\r\n                this.clearPath();\r\n            }\r\n            else if (this._markers[room.num])\r\n                this.clearPath();\r\n            if (room.num === this.active.num)\r\n                this.active = new Room();\r\n            if (room.num === this.selected.num)\r\n                this.selected = new Room();\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    public clearSelectedRoom() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-selected', es)\r\n        if (es.preventDefault) return;\r\n        this.removeRoom(this.selected);\r\n    }\r\n\r\n    public clearCurrentRoom() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-current', es)\r\n        if (es.preventDefault) return;\r\n        this.removeRoom(this._map.current);\r\n    }\r\n\r\n    public clearArea() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-area', es)\r\n        if (es.preventDefault) return;\r\n        this._map.removeRooms({ area: this.active.area });\r\n        this.emit('clear-area-done', this.active.area);\r\n        this.reset();\r\n        this.refresh();\r\n    }\r\n\r\n    public clearAll() {\r\n        const es = { preventDefault: false };\r\n        this.emit('clear-all', es)\r\n        if (es.preventDefault) return;\r\n        this._map.removeAllRooms();\r\n        this.emit('clear-done');\r\n        this.reset();\r\n        this.refresh();\r\n        this.focusActiveRoom();\r\n    }\r\n\r\n    public set map(map: Map) {\r\n        //prevent double events\r\n        if (map === this._map) return;\r\n        if (this._map)\r\n            this._map.removeListenersFromCaller(this);\r\n        this._map = map;\r\n        if (map) {\r\n            map.on('current-changed', room => {\r\n                this.clearPath();\r\n                this.emit('current-changed', this._map.current);\r\n                if (this.selected && this.selected.num === room.num)\r\n                    this.emit('room-selected', room.clone());\r\n                if (this.follow)\r\n                    this.focusCurrentRoom();\r\n                else\r\n                    this.active = room;\r\n                this.refresh();\r\n            }, this);\r\n            map.on('before-room-changed', room => {\r\n                if (room)\r\n                    delete this._drawCache[(room.background ? room.background : room.env) + ',' + room.indoors + ',' + room.exitsID + ',' + room.details];\r\n            }, this);\r\n            map.on('room-changed', room => {\r\n                if (this.selected && this.selected.num === room.num)\r\n                    this.selected = room;\r\n                if (this.follow)\r\n                    this.focusCurrentRoom();\r\n                else\r\n                    this.active = this.current;\r\n                this.refresh();\r\n            }, this);\r\n            map.on('rooms-changed', rooms => {\r\n                if (this.selected && this.selected.num) {\r\n                    const idx = rooms.findIndex(room => room.num === this.selected.num);\r\n                    if (idx !== -1)\r\n                        this.selected = rooms[idx];\r\n                }\r\n                if (this.follow)\r\n                    this.focusCurrentRoom();\r\n                else\r\n                    this.active = this.current;\r\n                this.refresh();\r\n            }, this);\r\n            if (this.follow) {\r\n                if (this._map.current.num)\r\n                    this._active = this.map.current && this.map.current.clone ? this.map.current.clone() : this.map.current;\r\n                this.focusActiveRoom();\r\n            }\r\n            else\r\n                this._active = this.map.current && this.map.current.clone ? this.map.current.clone() : this.map.current;\r\n        }\r\n\r\n        this.refresh();\r\n    }\r\n    public get map() { return this._map; }\r\n\r\n    public set rooms(rooms: object | Room[]) {\r\n        this._map.Rooms = rooms;\r\n    }\r\n    public get rooms() { return this._map.Rooms; }\r\n\r\n    public roomExists(x, y, z, zone, area?) {\r\n        if (area)\r\n            return this._map.roomExists({ x: x, y: y, z: z, zone: zone || 0, area: area });\r\n        return this._map.roomExists({ x: x, y: y, z: z, zone: zone || 0 });\r\n    }\r\n\r\n    public setRoom(room: Room) {\r\n        this._map.setRoom(room);\r\n    }\r\n\r\n    public DrawLegend(ctx, x, y, nc) {\r\n        if (!this._showLegend) return;\r\n        ctx.strokeStyle = 'black';\r\n        if (!nc) {\r\n            ctx.fillStyle = '#eae4d6';\r\n            //ctx.clearRect(x + 30, y + 35, 130, 145);\r\n            ctx.fillRect(x + 30, y + 35, 130, 175);\r\n        }\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeRect(x + 30, y + 35, 130, 175);\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillText('Dock', x + 50, y + 50);\r\n        ctx.fillStyle = 'chocolate';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 45, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Pier', x + 50, y + 65);\r\n        ctx.fillStyle = 'gray';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 60, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Water Source', x + 50, y + 80);\r\n        ctx.fillStyle = 'aqua';\r\n        ctx.beginPath();\r\n        ctx.arc(x + 40, y + 75, 2, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bank', x + 50, y + 95);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'goldenrod';\r\n        ctx.beginPath();\r\n        ctx.fillText('$', x + 38, y + 95);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Shop', x + 50, y + 110);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'purple';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u23CF', x + 38, y + 110);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Hospital', x + 50, y + 125);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'blue';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2665', x + 38, y + 125);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bar & Restaurant', x + 50, y + 140);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2617', x + 38, y + 140);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Bar', x + 50, y + 155);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u266A', x + 38, y + 155);\r\n        ctx.closePath();\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Restaurant', x + 50, y + 170);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'green';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2616', x + 38, y + 170);\r\n        ctx.closePath();\r\n\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Train', x + 50, y + 185);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'red';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u260D', x + 38, y + 185);\r\n        ctx.closePath();\r\n\r\n        ctx.font = 'italic bold 8pt Georgia';\r\n        ctx.fillStyle = 'black';\r\n        ctx.fillText('Stable', x + 50, y + 200);\r\n        ctx.font = '8pt Arial';\r\n        ctx.fillStyle = 'rgb(153, 102, 0)';\r\n        ctx.beginPath();\r\n        ctx.fillText('\\u2658', x + 38, y + 200);\r\n        ctx.closePath();\r\n\r\n    }\r\n\r\n    private _translate(ctx, amt, scale) {\r\n        if (scale === 3) return;\r\n        //if (scale < 1) {\r\n        const o = amt - amt * scale;\r\n        ctx.translate(amt * scale + o, amt * scale + o);\r\n        /*\r\n    }\r\n    else if (scale % 0.25 === 0)\r\n        ctx.translate(amt, amt);\r\n    else\r\n        ctx.translate(amt * scale, amt * scale);\r\n        */\r\n    }\r\n\r\n    public DrawRoom(ctx, x, y, room, ex, scale?) {\r\n        if (!this._drawCache)\r\n            this._drawCache = {};\r\n        if (!scale) scale = this._scale;\r\n        const key = (room.background ? room.background : room.env) + ',' + room.indoors + ',' + room.exitsID + ',' + room.details;\r\n\r\n        if (!this._drawCache[key]) {\r\n            this._drawCache[key] = this._document.createElement('canvas');\r\n            this._drawCache[key].classList.add('map-canvas');\r\n            this._drawCache[key].height = 32 * scale;\r\n            this._drawCache[key].width = 32 * scale;\r\n            const tx = this._drawCache[key].getContext('2d');\r\n            this._translate(tx, 0.5, scale);\r\n            tx.beginPath();\r\n            let f = false;\r\n            if (room.background) {\r\n                tx.fillStyle = room.background;\r\n                f = true;\r\n            }\r\n            else if (room.env) {\r\n                switch (room.env) {\r\n                    case 'wood':\r\n                        tx.fillStyle = '#966F33';\r\n                        f = true;\r\n                        break;\r\n                    case 'jungle':\r\n                        tx.fillStyle = '#347C2C';\r\n                        f = true;\r\n                        break;\r\n                    case 'forest':\r\n                        tx.fillStyle = '#4E9258';\r\n                        f = true;\r\n                        break;\r\n                    case 'grass':\r\n                    case 'grassland':\r\n                    case 'plains':\r\n                    case 'prairie':\r\n                    case 'savannah':\r\n                        tx.fillStyle = '#4AA02C';\r\n                        f = true;\r\n                        break;\r\n                    case 'desert':\r\n                    case 'dirt':\r\n                    case 'dirtroad':\r\n                    case 'beach':\r\n                    case 'sand':\r\n                    case 'sanddesert':\r\n                        tx.fillStyle = '#C2B280';\r\n                        f = true;\r\n                        break;\r\n                    case 'snow':\r\n                        tx.fillStyle = '#F0F8FF';\r\n                        f = true;\r\n                        break;\r\n                    case 'tundra':\r\n                    case 'icesheet':\r\n                        tx.fillStyle = '#368BC1';\r\n                        f = true;\r\n                        break;\r\n                    case 'underwater':\r\n                    case 'water':\r\n                    case 'lake':\r\n                    case 'river':\r\n                        tx.fillStyle = '#EBF4FA';\r\n                        f = true;\r\n                        break;\r\n                    case 'ocean':\r\n                        tx.fillStyle = '#C2DFFF';\r\n                        f = true;\r\n                        break;\r\n                    case 'bog':\r\n                    case 'city':\r\n                    case 'cliff':\r\n                    case 'highmountain':\r\n                    case 'hills':\r\n                    case 'mountain':\r\n                    case 'swamp':\r\n                        f = false;\r\n                        break;\r\n                    case 'farmland':\r\n                        f = true;\r\n                        tx.fillStyle = '#A9DFBF';\r\n                        break;\r\n                    case 'rockdesert':\r\n                        tx.fillStyle = '#6E2C00';\r\n                        f = true;\r\n                        break;\r\n                    case 'pavedroad':\r\n                        tx.fillStyle = '#D0D3D4';\r\n                        f = true;\r\n                        break;\r\n                    case 'cobble':\r\n                    case 'rocky':\r\n                    case 'stone':\r\n                        tx.fillStyle = '#D5DBDB';\r\n                        f = true;\r\n                        break;\r\n                    default:\r\n                        f = false;\r\n                        break;\r\n                }\r\n            }\r\n            else\r\n                f = false;\r\n            tx.strokeStyle = 'black';\r\n            tx.lineWidth = 0.6 * scale;\r\n            if (!room.indoors) {\r\n                tx.arc(16 * scale, 16 * scale, 8 * scale, 0, Math.PI * 2, false);\r\n                if (f) tx.fill();\r\n                tx.stroke();\r\n            }\r\n            else {\r\n                if (f) tx.fillRect(8 * scale, 8 * scale, 16 * scale, 16 * scale);\r\n                tx.strokeRect(8 * scale, 8 * scale, 16 * scale, 16 * scale);\r\n            }\r\n            tx.closePath();\r\n\r\n            tx.beginPath();\r\n            tx.fillStyle = '#cccccc';\r\n            if (room.exits.north) {\r\n                tx.moveTo(16 * scale, 0 * scale);\r\n                tx.lineTo(16 * scale, 8 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(9 * scale, 0 * scale, 14 * scale, 4 * scale);\r\n            if (room.exits.northwest) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(0 * scale, 0 * scale);\r\n                    tx.lineTo(10 * scale, 10 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(0 * scale, 0 * scale);\r\n                    tx.lineTo(8 * scale, 8 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(2 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                tx.fillRect(0 * scale, 2 * scale, 4 * scale, 2 * scale);\r\n                if (!room.exits.north)\r\n                    tx.fillRect(4 * scale, 0 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.west)\r\n                    tx.fillRect(0 * scale, 4 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.northeast) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(32 * scale, 0 * scale);\r\n                    tx.lineTo(22 * scale, 10 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(32 * scale, 0 * scale);\r\n                    tx.lineTo(24 * scale, 8 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(28 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                tx.fillRect(28 * scale, 2 * scale, 4 * scale, 2 * scale);\r\n                tx.clearRect(30 * scale, 0 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.north)\r\n                    tx.fillRect(23 * scale, 0 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.east)\r\n                    tx.fillRect(28 * scale, 4 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.east) {\r\n                tx.moveTo(24 * scale, 16 * scale);\r\n                tx.lineTo(32 * scale, 16 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(28 * scale, 9 * scale, 4 * scale, 14 * scale);\r\n            if (room.exits.west) {\r\n                tx.moveTo(0 * scale, 16 * scale);\r\n                tx.lineTo(8 * scale, 16 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(0 * scale, 9 * scale, 4 * scale, 14 * scale);\r\n            if (room.exits.south) {\r\n                tx.moveTo(16 * scale, 24 * scale);\r\n                tx.lineTo(16 * scale, 32 * scale);\r\n            }\r\n            else if (this._fillWalls)\r\n                tx.fillRect(9 * scale, 28 * scale, 14 * scale, 4 * scale);\r\n            if (room.exits.southeast) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(32 * scale, 32 * scale);\r\n                    tx.lineTo(22 * scale, 22 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(32 * scale, 32 * scale);\r\n                    tx.lineTo(24 * scale, 24 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(28 * scale, 28 * scale, 4 * scale, 2 * scale);\r\n                tx.fillRect(28 * scale, 30 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.south)\r\n                    tx.fillRect(23 * scale, 28 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.east)\r\n                    tx.fillRect(28 * scale, 23 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            if (room.exits.southwest) {\r\n                if (!room.Indoors) {\r\n                    tx.moveTo(0 * scale, 32 * scale);\r\n                    tx.lineTo(10 * scale, 22 * scale);\r\n                }\r\n                else {\r\n                    tx.moveTo(0 * scale, 32 * scale);\r\n                    tx.lineTo(8 * scale, 24 * scale);\r\n                }\r\n            }\r\n            else if (this._fillWalls) {\r\n                tx.fillRect(0 * scale, 28 * scale, 4 * scale, 2 * scale);\r\n                tx.fillRect(2 * scale, 30 * scale, 2 * scale, 2 * scale);\r\n                if (!room.exits.south)\r\n                    tx.fillRect(4 * scale, 28 * scale, 5 * scale, 4 * scale);\r\n                if (!room.exits.west)\r\n                    tx.fillRect(0 * scale, 23 * scale, 4 * scale, 5 * scale);\r\n            }\r\n            tx.closePath();\r\n            tx.stroke();\r\n            tx.fillStyle = 'black';\r\n            tx.strokeStyle = 'black';\r\n            if (room.exits.up) {\r\n                tx.beginPath();\r\n                tx.moveTo(1 * scale, 11 * scale);\r\n                tx.lineTo(7 * scale, 11 * scale);\r\n                tx.lineTo(4 * scale, 8 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if (room.exits.down) {\r\n                tx.beginPath();\r\n                tx.moveTo(1 * scale, 21 * scale);\r\n                tx.lineTo(7 * scale, 21 * scale);\r\n                tx.lineTo(4 * scale, 24 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if (room.exits.out) {\r\n                tx.beginPath();\r\n                tx.moveTo(26 * scale, 8 * scale);\r\n                tx.lineTo(29 * scale, 11 * scale);\r\n                tx.lineTo(26 * scale, 14 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n\r\n            }\r\n            if (room.exits.enter) {\r\n                tx.beginPath();\r\n                tx.moveTo(29 * scale, 19 * scale);\r\n                tx.lineTo(26 * scale, 22 * scale);\r\n                tx.lineTo(29 * scale, 25 * scale);\r\n                tx.closePath();\r\n                tx.fill();\r\n            }\r\n            if ((room.details & RoomDetails.Dock) === RoomDetails.Dock) {\r\n                tx.fillStyle = 'chocolate';\r\n                tx.beginPath();\r\n                tx.arc(20 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Pier) === RoomDetails.Pier) {\r\n                tx.fillStyle = 'gray';\r\n                tx.beginPath();\r\n                tx.arc(12 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.WaterSource) === RoomDetails.WaterSource) {\r\n                tx.fillStyle = 'aqua';\r\n                tx.beginPath();\r\n                tx.arc(12 * scale, 5 * scale, 2 * scale, 0, Math.PI * 2);\r\n                tx.fill();\r\n                tx.closePath();\r\n            }\r\n            tx.scale(scale, scale);\r\n            if ((room.details & RoomDetails.Bank) === RoomDetails.Bank) {\r\n                tx.fillStyle = 'goldenrod';\r\n                tx.beginPath();\r\n                tx.fillText('$', 9, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Shop) === RoomDetails.Shop) {\r\n                tx.fillStyle = 'purple';\r\n                tx.beginPath();\r\n                tx.fillText('\\u23CF', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Hospital) === RoomDetails.Hospital) {\r\n                tx.fillStyle = 'blue';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2665', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Trainer) === RoomDetails.Trainer) {\r\n                tx.fillStyle = 'red';\r\n                tx.beginPath();\r\n                tx.fillText('\\u260D', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Stable) === RoomDetails.Stable) {\r\n                tx.fillStyle = 'rgb(153, 102, 0)';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2658', 7, 17);\r\n                tx.closePath();\r\n            }\r\n            if ((room.details & RoomDetails.Restaurant) === RoomDetails.Restaurant && (room.details & RoomDetails.Bar) === RoomDetails.Bar) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2617', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Bar) === RoomDetails.Bar) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u266A', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            else if ((room.details & RoomDetails.Restaurant) === RoomDetails.Restaurant) {\r\n                tx.fillStyle = 'green';\r\n                tx.beginPath();\r\n                tx.fillText('\\u2616', 15, 17);\r\n                tx.closePath();\r\n            }\r\n            tx.setTransform(1, 0, 0, 1, 0, 0);\r\n            this._translate(tx, -0.5, scale);\r\n        }\r\n        //this.translate(ctx, -0.5, scale);\r\n        ctx.drawImage(this._drawCache[key], x | 0, y | 0);\r\n        //this.translate(ctx, 0.5, scale);\r\n        this.DrawDoor(ctx, x + 12 * scale, y - 2 * scale, 8 * scale, 3 * scale, room.exits.north);\r\n        this.DrawDoor(ctx, x + 31 * scale, y + 12 * scale, 3 * scale, 8 * scale, room.exits.east);\r\n        this.DrawDoor(ctx, x - 1 * scale, y + 12 * scale, 3 * scale, 8 * scale, room.exits.west);\r\n        this.DrawDoor(ctx, x + 12 * scale, y + 30 * scale, 8 * scale, 3 * scale, room.exits.south);\r\n        this.DrawDDoor(ctx, x, y, 5 * scale, 5 * scale, room.exits.northwest);\r\n        this.DrawDDoor(ctx, x + 32 * scale, y, -5 * scale, 5 * scale, room.exits.northeast);\r\n        this.DrawDDoor(ctx, x + 32 * scale, y + 32 * scale, -5 * scale, -5 * scale, room.exits.southeast);\r\n        this.DrawDDoor(ctx, x, y + 32 * scale, 5 * scale, -5 * scale, room.exits.southwest);\r\n\r\n        if (!ex && this.selected.num === room.num) {\r\n            if (this._focused) {\r\n                ctx.fillStyle = 'rgba(135, 206, 250, 0.5)';\r\n                ctx.strokeStyle = 'LightSkyBlue';\r\n            }\r\n            else {\r\n                ctx.fillStyle = 'rgba(142, 142, 142, 0.5)';\r\n                ctx.strokeStyle = 'rgba(142, 142, 142, 0.5)';\r\n            }\r\n            ctx.fillRoundedRect(x, y, 32 * scale, 32 * scale, 8 * scale);\r\n            ctx.strokeRoundedRect(x, y, 32 * scale, 32 * scale, 8 * scale);\r\n        }\r\n        if (this._markers[room.num] === 2)\r\n            this.drawMarker(ctx, x, y, 'green', scale);\r\n        else if (this._markers[room.num] === 3)\r\n            this.drawMarker(ctx, x, y, 'blue', scale);\r\n        else if (this._markers[room.num])\r\n            this.drawMarker(ctx, x, y, 'yellow', scale);\r\n        if (!ex && room.num === this._map.current.num)\r\n            this.drawMarker(ctx, x, y, 'red', scale);\r\n    }\r\n\r\n    public drawMarker(ctx, x, y, color, scale) {\r\n        if (!color) color = 'yellow';\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color;\r\n        ctx.strokeStyle = 'black';\r\n        ctx.arc(x + 16 * scale, y + 16 * scale, 4 * scale, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n    }\r\n\r\n    public DrawDoor(ctx, x, y, w, h, exit) {\r\n        if (!exit || !exit.isdoor) return;\r\n        ctx.beginPath();\r\n        ctx.clearRect(x, y, w, h);\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeStyle = 'black';\r\n        /*\r\n        if (exit.islocked) {\r\n            ctx.fillStyle = 'red';\r\n            ctx.fillRect(x, y, w, h);\r\n            ctx.strokeRect(x, y, w, h);\r\n        }\r\n        else\r\n        */\r\n        if (exit.isclosed)\r\n            ctx.fillRect(x, y, w, h);\r\n        else\r\n            ctx.strokeRect(x, y, w, h);\r\n        ctx.closePath();\r\n    }\r\n\r\n    public DrawDDoor(ctx, x, y, w, h, exit) {\r\n        if (!exit || !exit.isdoor) return;\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'black';\r\n        ctx.strokeStyle = 'black';\r\n        ctx.moveTo(x, y);\r\n        ctx.lineTo(x + w, y);\r\n        ctx.lineTo(x, y + h);\r\n        ctx.lineTo(x, y);\r\n        /*\r\n        if (exit.islocked) {\r\n            ctx.fillStyle = 'red';\r\n            ctx.fill();\r\n            ctx.stroke();\r\n        }\r\n        else\r\n        */\r\n        if (exit.isclosed)\r\n            ctx.fill();\r\n        else\r\n            ctx.stroke();\r\n        ctx.closePath();\r\n    }\r\n\r\n    public PointInRect(x, y, x1, x2, y1, y2) {\r\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2))\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    public getRoom(id) {\r\n        return this._map.Rooms[id];\r\n    }\r\n\r\n    public getRooms(filter?): Room[] {\r\n        if (!filter)\r\n            return Object.values(this._map.Rooms);\r\n        return this._map.getRooms(filter);\r\n    }\r\n\r\n    public showPath(destRoom?: Room) {\r\n        if (!destRoom || !destRoom.num)\r\n            destRoom = this.selected;\r\n        if (this._map.current.num == null || destRoom.num == null)\r\n            return;\r\n        if (this._splitArea && this._map.current.area !== destRoom.area)\r\n            return;\r\n        if (this._map.current.zone !== destRoom.zone)\r\n            return;\r\n        let rooms;\r\n        if (this._splitArea)\r\n            rooms = this.getRooms({ area: this._map.current.area, zone: this._map.current.zone });\r\n        else\r\n            rooms = this.getRooms({ zone: this._map.current.zone });\r\n        let room;\r\n        let id;\r\n        const roomsC: Room[][][] = [];\r\n        let ox = null;\r\n        let oy = 0;\r\n        let oz = 0;\r\n        let w = 0;\r\n        let h = 0;\r\n        let d = 0;\r\n        let r;\r\n        let rl;\r\n        let x;\r\n        let y;\r\n        let z;\r\n        let cx;\r\n        let cy;\r\n        let cz;\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            if (ox == null) {\r\n                ox = room.x;\r\n                w = room.x + 1;\r\n                oy = room.y;\r\n                h = room.y + 1;\r\n                oz = room.z;\r\n                d = room.z + 1;\r\n                continue;\r\n            }\r\n            if (room.x < ox) ox = room.x; else if (room.x > w) w = room.x;\r\n            if (room.y < oy) oy = room.y; else if (room.y > h) h = room.y;\r\n            if (room.z < oz) oz = room.z; else if (room.z > d) d = room.z;\r\n        }\r\n\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            if (room == null) continue;\r\n            if (!roomsC[room.y - oy]) roomsC[room.y - oy] = [];\r\n            if (!roomsC[room.y - oy][room.x - ox]) roomsC[room.y - oy][room.x - ox] = [];\r\n            roomsC[room.y - oy][room.x - ox][room.z - oz] = room;\r\n        }\r\n\r\n        w = Math.sqrt(Math.pow(w - ox, 2)) + 1;\r\n        h = Math.sqrt(Math.pow(oy - h, 2)) + 1;\r\n        d = Math.sqrt(Math.pow(oz - d, 2)) + 1;\r\n        const matrix = [];\r\n\r\n        for (y = 0; y < h; y++) {\r\n            matrix[y] = [];\r\n            for (x = 0; x < w; x++) {\r\n                matrix[y][x] = [];\r\n                for (z = 0; z < d; z++)\r\n                    matrix[y][x][z] = 0;\r\n            }\r\n        }\r\n\r\n        for (id in rooms) {\r\n            if (!rooms.hasOwnProperty(id)) continue;\r\n            room = rooms[id];\r\n            x = (room.x - ox);\r\n            y = (room.y - oy);\r\n            z = (room.z - oz);\r\n            if (room.exits.northwest)\r\n                matrix[y][x][z] |= 1;\r\n            if (room.exits.north)\r\n                matrix[y][x][z] |= 128;\r\n            if (room.exits.northeast)\r\n                matrix[y][x][z] |= 64;\r\n            if (room.exits.west)\r\n                matrix[y][x][z] |= 2;\r\n            if (room.exits.east)\r\n                matrix[y][x][z] |= 32;\r\n            if (room.exits.southwest)\r\n                matrix[y][x][z] |= 4;\r\n            if (room.exits.south)\r\n                matrix[y][x][z] |= 8;\r\n            if (room.exits.southeast)\r\n                matrix[y][x][z] |= 16;\r\n            if (room.exits.up)\r\n                matrix[y][x][z] |= 512;\r\n            if (room.exits.down)\r\n                matrix[y][x][z] |= 256;\r\n        }\r\n        const grid = new PF.Grid(w, h, d, matrix);\r\n\r\n        const finder = new PF.AStarFinder({ allowDiagonal: true, dontCrossCorners: false });\r\n        x = (this._map.current.x - ox);\r\n        y = (this._map.current.y - oy);\r\n        z = (this._map.current.z - oz);\r\n        cx = (destRoom.x - ox);\r\n        cy = (destRoom.y - oy);\r\n        cz = (destRoom.z - oz);\r\n        const fPath = finder.findPath(x, y, z, cx, cy, cz, grid);\r\n        rl = fPath.length;\r\n        this._markers = {};\r\n        this._markedRooms = [this._map.current, destRoom];\r\n        for (r = 0; r < rl; r++) {\r\n            x = Math.floor(fPath[r][0]);\r\n            y = Math.floor(fPath[r][1]);\r\n            z = Math.floor(fPath[r][2]);\r\n            if (roomsC[y] && roomsC[y][x] && roomsC[y][x][z]) {\r\n                if (roomsC[y][x][z].num === this._map.current.num)\r\n                    this._markers[roomsC[y][x][z].num] = 2;\r\n                else if (roomsC[y][x][z].num === destRoom.num)\r\n                    this._markers[roomsC[y][x][z].num] = 3;\r\n                else\r\n                    this._markers[roomsC[y][x][z].num] = 1;\r\n            }\r\n        }\r\n        this.emit('path-shown');\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public clearPath() {\r\n        this.emit('path-cleared');\r\n        this._markers = {};\r\n        this._markedRooms = 0;\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public get hasMarked() {\r\n        return this._markedRooms && this._markedRooms.length !== 0;\r\n    }\r\n\r\n    public get markedStart() {\r\n        if (!this._markedRooms) return 0;\r\n        return this._markedRooms[0];\r\n    }\r\n\r\n    public get markedEnd() {\r\n        if (!this._markedRooms) return 0;\r\n        return this._markedRooms[1];\r\n    }\r\n\r\n    public getMarkedPath() {\r\n        return new Promise((resolve, reject) => {\r\n            if (!this._markedRooms)\r\n                this.getPath().then(resolve).catch(reject);\r\n            else\r\n                this.getPath(this._markedRooms[1], this._markedRooms[0]).then(resolve).catch(reject);\r\n        });\r\n    }\r\n\r\n    public getPath(destRoom?: Room, startRoom?: Room) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!destRoom || !destRoom.num)\r\n                destRoom = this.selected;\r\n            if (!startRoom || !startRoom.num)\r\n                startRoom = this._map.current;\r\n            if (startRoom.num == null || destRoom.num == null) {\r\n                reject('Invalid start or end room.');\r\n                return;\r\n            }\r\n            if (this._splitArea && startRoom.area !== destRoom.area) {\r\n                reject('Start and end rooms must be in same the area.');\r\n                return;\r\n            }\r\n            if (startRoom.zone !== destRoom.zone) {\r\n                reject('Start and end rooms must be in the same zone.');\r\n                return;\r\n            }\r\n            let rooms;\r\n            if (this._splitArea)\r\n                rooms = this.getRooms({ area: startRoom.area, zone: startRoom.zone });\r\n            else\r\n                rooms = this.getRooms({ zone: startRoom.zone });\r\n            let room;\r\n            let id;\r\n            let ox = null;\r\n            let oy = 0;\r\n            let oz = 0;\r\n            let w = 0;\r\n            let h = 0;\r\n            let d = 0;\r\n            let r;\r\n            let rl;\r\n            let x;\r\n            let y;\r\n            let z;\r\n            let cx;\r\n            let cy;\r\n            let cz;\r\n            let x2;\r\n            let y2;\r\n            let z2;\r\n            for (id in rooms) {\r\n                if (!rooms.hasOwnProperty(id)) continue;\r\n                room = rooms[id];\r\n                if (ox == null) {\r\n                    ox = room.x;\r\n                    w = room.x + 1;\r\n                    oy = room.y;\r\n                    h = room.y + 1;\r\n                    oz = room.z;\r\n                    d = room.z + 1;\r\n                    continue;\r\n                }\r\n                if (room.x < ox) ox = room.x; else if (room.x > w) w = room.x;\r\n                if (room.y < oy) oy = room.y; else if (room.y > h) h = room.y;\r\n                if (room.z < oz) oz = room.z; else if (room.z > d) d = room.z;\r\n            }\r\n\r\n            w = Math.sqrt(Math.pow(w - ox, 2)) + 1;\r\n            h = Math.sqrt(Math.pow(oy - h, 2)) + 1;\r\n            d = Math.sqrt(Math.pow(oz - d, 2)) + 1;\r\n            const matrix = [];\r\n\r\n            for (y = 0; y < h; y++) {\r\n                matrix[y] = [];\r\n                for (x = 0; x < w; x++) {\r\n                    matrix[y][x] = [];\r\n                    for (z = 0; z < d; z++)\r\n                        matrix[y][x][z] = 0;\r\n                }\r\n            }\r\n\r\n            for (id in rooms) {\r\n                if (!rooms.hasOwnProperty(id)) continue;\r\n                room = rooms[id];\r\n                x = (room.x - ox);\r\n                y = (room.y - oy);\r\n                z = (room.z - oz);\r\n                if (room.exits.northwest)\r\n                    matrix[y][x][z] |= 1;\r\n                if (room.exits.north)\r\n                    matrix[y][x][z] |= 128;\r\n                if (room.exits.northeast)\r\n                    matrix[y][x][z] |= 64;\r\n                if (room.exits.west)\r\n                    matrix[y][x][z] |= 2;\r\n                if (room.exits.east)\r\n                    matrix[y][x][z] |= 32;\r\n                if (room.exits.southwest)\r\n                    matrix[y][x][z] |= 4;\r\n                if (room.exits.south)\r\n                    matrix[y][x][z] |= 8;\r\n                if (room.exits.southeast)\r\n                    matrix[y][x][z] |= 16;\r\n                if (room.exits.up)\r\n                    matrix[y][x][z] |= 512;\r\n                if (room.exits.down)\r\n                    matrix[y][x][z] |= 256;\r\n            }\r\n            const grid = new PF.Grid(w, h, d, matrix);\r\n\r\n            const finder = new PF.AStarFinder({ allowDiagonal: true, dontCrossCorners: false });\r\n            x = (startRoom.x - ox);\r\n            y = (startRoom.y - oy);\r\n            z = (startRoom.z - oz);\r\n            cx = (destRoom.x - ox);\r\n            cy = (destRoom.y - oy);\r\n            cz = (destRoom.z - oz);\r\n            const fPath = finder.findPath(x, y, z, cx, cy, cz, grid);\r\n            rl = fPath.length;\r\n            const walk = [];\r\n            for (r = 0; r < rl - 1; r++) {\r\n                x = Math.floor(fPath[r][0]);\r\n                y = Math.floor(fPath[r][1]);\r\n                z = Math.floor(fPath[r][2]);\r\n                x2 = Math.floor(fPath[r + 1][0]);\r\n                y2 = Math.floor(fPath[r + 1][1]);\r\n                z2 = Math.floor(fPath[r + 1][2]);\r\n\r\n                if (z - 1 === z2)\r\n                    walk.push('down');\r\n                else if (z + 1 === z2)\r\n                    walk.push('up');\r\n                else if (x - 1 === x2 && y - 1 === y2)\r\n                    walk.push('northwest');\r\n                else if (x === x2 && y - 1 === y2)\r\n                    walk.push('north');\r\n                else if (x + 1 === x2 && y - 1 === y2)\r\n                    walk.push('northeast');\r\n\r\n                else if (x - 1 === x2 && y + 1 === y2)\r\n                    walk.push('southwest');\r\n                else if (x === x2 && y + 1 === y2)\r\n                    walk.push('south');\r\n                else if (x + 1 === x2 && y + 1 === y2)\r\n                    walk.push('southeast');\r\n                else if (x - 1 === x2 && y === y2)\r\n                    walk.push('west');\r\n                else\r\n                    walk.push('east');\r\n            }\r\n            resolve(walk);\r\n        });\r\n    }\r\n\r\n    public walkPath(destRoom?: Room, startRoom?: Room) {\r\n        this.getPath(destRoom, startRoom).then(walk => {\r\n            this.SendCommands(walk);\r\n        }).catch(() => { });\r\n    }\r\n\r\n    public walkMarkedPath() {\r\n        const destRoom = this._markedRooms ? this._markedRooms[1] : 0;\r\n        const startRoom = this._markedRooms ? this._markedRooms[0] : 0;\r\n        return new Promise((resolve, reject) => {\r\n            this.getPath(destRoom, startRoom).then(walk => {\r\n                this.SendCommands(walk);\r\n            }).catch(() => { });\r\n        });\r\n    }\r\n\r\n    public SendCommands(cmds) {\r\n        let tmp;\r\n        let cnt = this.commandDelayCount;\r\n        if (cnt < 0) cnt = 1;\r\n        if (cmds.length > cnt) {\r\n            tmp = cmds.slice(cnt);\r\n            cmds = cmds.slice(0, cnt);\r\n            setTimeout(() => { this.SendCommands(tmp); }, this.commandDelay);\r\n        }\r\n        this.emit('send-commands', cmds.join('\\n') + '\\n');\r\n    }\r\n\r\n    private _doUpdate(type?: UpdateType) {\r\n        if (!type) return;\r\n        this._updating |= type;\r\n        if (this._updating === UpdateType.none || this._rTimeout)\r\n            return;\r\n        this._rTimeout = this._window.requestAnimationFrame(() => {\r\n            if ((this._updating & UpdateType.draw) === UpdateType.draw) {\r\n                this.draw().catch(() => { });\r\n                this._updating &= ~UpdateType.draw;\r\n            }\r\n            this._rTimeout = 0;\r\n            this._doUpdate(this._updating);\r\n        });\r\n    }\r\n\r\n    private _setFocus(value) {\r\n        if (this._focused === value) return;\r\n        this._focused = value;\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    public updateOptions(options) {\r\n        if (!options) return;\r\n        for (let option in options) {\r\n            if (!Object.prototype.hasOwnProperty.call(options, option))\r\n                continue;\r\n            if (option in this)\r\n                this[option] = options[option];\r\n        }\r\n    }\r\n\r\n    private _resizeCanvas() {\r\n        if (!this._context || this.container.clientHeight === 0 || this.container.clientWidth === 0) return;\r\n        //buffer the current canvas state as when resizing canvases are cleared so we want to restore it after resizing\r\n        //let temp = this._context.getImageData(0, 0, this._canvas.width, this._canvas.height);\r\n        //create a temp canvas to store current state\r\n        const tempCanvas = this._document.createElement('canvas');\r\n        tempCanvas.width = this._canvas.width;\r\n        tempCanvas.height = this._canvas.height\r\n        //create context to access data\r\n        const tempContext = tempCanvas.getContext(\"2d\");\r\n        //draw current state to temp\r\n        tempContext.drawImage(this._canvas, 0, 0);\r\n        //resize canvas\r\n        if (this._showNav) {\r\n            this._canvas.width = this.container.clientWidth - 60;\r\n            this._canvas.height = this.container.clientHeight - 60;\r\n        }\r\n        else {\r\n            const computedStyle = this._window.getComputedStyle(this._canvas);\r\n            const borderLeftWidth = parseFloat(computedStyle.borderLeftWidth);\r\n            const borderRightWidth = parseFloat(computedStyle.borderRightWidth);\r\n            const borderTopWidth = parseFloat(computedStyle.borderTopWidth);\r\n            const borderBottomWidth = parseFloat(computedStyle.borderBottomWidth);\r\n\r\n            this._canvas.width = this.container.clientWidth - borderLeftWidth - borderRightWidth;\r\n            this._canvas.height = this.container.clientHeight - borderTopWidth - borderBottomWidth;\r\n        }\r\n        //this._context.putImageData(temp, 0, 0)\r\n        //restore stae\r\n        this._context.drawImage(tempCanvas, 0, 0);\r\n        //redraw to ensure any new exposed areas are drawn\r\n        this._doUpdate(UpdateType.draw);\r\n    }\r\n\r\n    private _mapperNavClick(x, y) {\r\n        if (!this._mapperNavDown) return;\r\n        this.scrollBy(x, y);\r\n        setTimeout(() => { this._mapperNavClick(x, y); }, 100);\r\n    }\r\n\r\n    public copyPath(separator?) {\r\n        separator = separator || client.getOption('commandStackingChar') || ';';\r\n        this.getPath().then((walk: string[]) => {\r\n            copyText(walk.join(separator || '\\n'));\r\n            this.emit('debug', 'Directions: ' + walk);\r\n        }).catch(err => this.emit('error', err));\r\n    }\r\n\r\n    public copyMarkedPath(separator?) {\r\n        separator = separator || client.getOption('commandStackingChar') || ';';\r\n        this.getMarkedPath().then((walk: string[]) => {\r\n            copyText(walk.join(separator || '\\n'));\r\n            this.emit('debug', 'Directions: ' + walk);\r\n        }).catch(err => this.emit('error', err));\r\n    }\r\n\r\n    public copySpeedpath() {\r\n        this.getPath().then((walk: string[]) => {\r\n            let cnt = 0;\r\n            let cmd = '';\r\n            let cmds = [client.getOption('speedpathsChar') || '!'];\r\n            const wl = walk.length;\r\n            for (let w = 0; w < wl; w++) {\r\n                if (cmd.length && cmd !== walk[w]) {\r\n                    cmds.push(cnt);\r\n                    cmds.push(cmd);\r\n                    cnt = 0;\r\n                }\r\n                cnt++;\r\n                cmd = walk[w];\r\n            }\r\n            cmds.push(cnt);\r\n            cmds.push(cmd);\r\n            copyText(cmds.join(''));\r\n            this.emit('debug', 'Speedpath: ' + cmds);\r\n        }).catch(err => this.emit('error', err))\r\n    }\r\n\r\n    public copyMarkedSpeedpath() {\r\n        this.getMarkedPath().then((walk: string[]) => {\r\n            let cnt = 0;\r\n            let cmd = '';\r\n            let cmds = [client.getOption('speedpathsChar') || '!'];\r\n            const wl = walk.length;\r\n            for (let w = 0; w < wl; w++) {\r\n                if (cmd.length && cmd !== walk[w]) {\r\n                    cmds.push(cnt);\r\n                    cmds.push(cmd);\r\n                    cnt = 0;\r\n                }\r\n                cnt++;\r\n                cmd = walk[w];\r\n            }\r\n            cmds.push(cnt);\r\n            cmds.push(cmd);\r\n            copyText(cmds.join(''));\r\n            this.emit('debug', 'Speedpath: ' + cmds);\r\n        }).catch(err => this.emit('error', err))\r\n    }\r\n\r\n    public exportImage(scaled?) {\r\n        const rooms = this.getRooms({ area: this.active.area, z: this.active.z, zone: this.active.zone });\r\n        let x = null, y = 0, w = 0, h = 0, r;\r\n        const rl = rooms.length;\r\n        let room, cx, cy;\r\n        const t = this.active.area === null || !this._splitArea ? '' : this.active.area;\r\n        const scale = scaled ? this._scale : 1.0;\r\n        for (r = 0; r < rl; r++) {\r\n            room = rooms[r];\r\n            if (room === null) continue;\r\n            if (x === null) {\r\n                x = room.x;\r\n                w = room.x + 1;\r\n                y = room.y;\r\n                h = room.y + 1;\r\n                continue;\r\n            }\r\n            if (room.x < x) x = room.x; else if (room.x > w) w = room.x;\r\n            if (room.y < y) y = room.y; else if (room.y > h) h = room.y;\r\n        }\r\n        this._context.font = 'italic bold 16pt Georgia';\r\n        let fx = this._context.measureText(t).width;\r\n        let rectWidth = Math.ceil(Math.sqrt(Math.pow(w - x, 2)) * 32 * scale + 60 + 32);\r\n        let rectHeight = Math.ceil(Math.sqrt(Math.pow(y - h, 2)) * 32 * scale + 60 + 32);\r\n        if (rectWidth < fx) rectWidth = fx + 60;\r\n        if (this._showLegend) {\r\n            rectWidth += 155;\r\n            if (rectHeight < 200) rectHeight = 200;\r\n        }\r\n        const tempCanvas = this._document.createElement('canvas');\r\n        tempCanvas.id = 'mapper-export';\r\n        tempCanvas.style.height = rectHeight + 'px';\r\n        tempCanvas.style.width = rectWidth + 'px';\r\n        tempCanvas.width = rectWidth;\r\n        tempCanvas.height = rectHeight;\r\n\r\n\r\n        let ctx;\r\n        if (tempCanvas && tempCanvas.getContext)\r\n            ctx = tempCanvas.getContext('2d');\r\n        else {\r\n            this.emit('error', 'Mapper image export: Error generating map!');\r\n            return;\r\n        }\r\n        ctx.strokeStyle = 'black';\r\n        ctx.fillStyle = '#eae4d6';\r\n        ctx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);\r\n\r\n        ctx.font = '8pt Arial';\r\n        for (r = 0; r < rl; r++) {\r\n            room = rooms[r];\r\n            //no room\r\n            if (room === null) continue;\r\n            cx = (room.x - x) * 32 * scale + 30.5;\r\n            cy = (room.y - y) * 32 * scale + 30.5;\r\n            this.DrawRoom(ctx, cx, cy, room, true, scale);\r\n        }\r\n        ctx.save();\r\n        ctx.strokeStyle = 'black';\r\n        ctx.fillStyle = 'black';\r\n        ctx.font = 'italic bold 16pt Georgia';\r\n        fx = rectWidth / 2 - fx / 2;\r\n        ctx.fillText(t, fx, 20);\r\n        ctx.translate(rectWidth - 25, rectHeight - 25);\r\n        ctx.font = 'italic bold 12pt Georgia';\r\n        ctx.fillText('N', 3, -5);\r\n        ctx.beginPath();\r\n        ctx.moveTo(10, 0);\r\n        ctx.lineTo(5, 15);\r\n        ctx.lineTo(10, 20);\r\n        ctx.lineTo(15, 15);\r\n        ctx.lineTo(10, 0);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        ctx.restore();\r\n        this.DrawLegend(ctx, rectWidth - 185, -10, 1);\r\n\r\n        tempCanvas.toBlob((blob) => {\r\n            let reader = new FileReader();\r\n            reader.addEventListener('loadend', (evt) => {\r\n                fileSaveAs.show(evt.target.result, this._splitArea && t.length ? ('OoMUD.' + t + '.png') : ('OoMUD.png'), 'image/png');\r\n            });\r\n            reader.readAsArrayBuffer(blob);\r\n        });\r\n    }\r\n\r\n    public exportCurrentImage() {\r\n        let tempCanvas = this._document.createElement('canvas');\r\n        let context = tempCanvas.getContext('2d');\r\n        tempCanvas.width = this._canvas.width;\r\n        tempCanvas.height = this._canvas.height;\r\n        this.draw(tempCanvas, context, true).then(() => {\r\n            tempCanvas.toBlob((blob) => {\r\n                let reader = new FileReader();\r\n                reader.addEventListener('loadend', (evt) => {\r\n                    fileSaveAs.show(evt.target.result, 'OoMUD.current.png', 'image/png');\r\n                });\r\n                reader.readAsArrayBuffer(blob);\r\n            });\r\n        });\r\n    }\r\n\r\n    public exportArea() {\r\n        fileSaveAs.show(JSON.stringify(this.getRooms({ area: this.active.area })), this._splitArea ? ('OoMUD.' + this.active.area + '.map.txt') : ('OoMUD.map.txt'), 'text/plain');\r\n    }\r\n\r\n    public exportAll() {\r\n        fileSaveAs.show(JSON.stringify(this.map.Rooms), 'OoMUD.map.txt', 'text/plain');\r\n    }\r\n}", "import { EventEmitter } from './events';\r\nimport { copy } from './library';\r\n\r\ndeclare let localforage;\r\n\r\nexport enum ImportType {\r\n    Merge = 0,\r\n    Replace = 1\r\n}\r\n\r\nexport enum RoomDetails {\r\n    None = 0,\r\n    Dock = 1,\r\n    Pier = 2,\r\n    Bank = 4,\r\n    Shop = 8,\r\n    Hospital = 16,\r\n    Bar = 32,\r\n    Restaurant = 64,\r\n    WaterSource = 128,\r\n    Trainer = 256,\r\n    Stable = 512\r\n}\r\n\r\nexport const RoomExits = {\r\n    out: 4096,\r\n    enter: 2048,\r\n    unknown: 1024,\r\n    up: 512,\r\n    down: 256,\r\n    north: 128,\r\n    northeast: 64,\r\n    east: 32,\r\n    southeast: 16,\r\n    south: 8,\r\n    southwest: 4,\r\n    west: 2,\r\n    northwest: 1,\r\n    none: 0\r\n};\r\n\r\nexport class Room {\r\n    public num: string = null;\r\n    public x: number = 0;\r\n    public y: number = 0;\r\n    public z: number = 0;\r\n    public area: string = '';\r\n    public zone: number = 0;\r\n    public notes?: string;\r\n    public background?: string;\r\n    public env?: string;\r\n    public details?: RoomDetails = RoomDetails.None;\r\n    public indoors?: number;\r\n    public exits?: any = {};\r\n    public name?: string;\r\n\r\n    constructor(data?) {\r\n        if (data) {\r\n            for (let prop in data) {\r\n                if (!data.hasOwnProperty(prop)) continue;\r\n                this[prop] = data[prop];\r\n            }\r\n        }\r\n    }\r\n\r\n    get exitsID() {\r\n        return Object.keys(this.exits).map(exit => RoomExits[exit]).reduce((a, c) => a | c, 0);\r\n    }\r\n\r\n    public clone() {\r\n        return new Room(copy(this));\r\n    }\r\n}\r\n\r\nexport class Map extends EventEmitter {\r\n    private _rooms: object;\r\n    private _areas: string[];\r\n    private _zone: number;\r\n    private _keys: string[];\r\n    private _keysZones: string[];\r\n    private _current: Room;\r\n    public changed = false;\r\n\r\n    public get current() { return this._current; }\r\n    public set current(value) {\r\n        this._current = value;\r\n        this.emit('current-changed', value);\r\n    }\r\n\r\n    public get Rooms() { return this._rooms; }\r\n    public set Rooms(value: object | Room[]) {\r\n        if (Array.isArray(value)) {\r\n            const or = value;\r\n            const rooms = {};\r\n            for (let r = 0, rl = or.length; r < rl; r++)\r\n                rooms[or[r].num] = or[r];\r\n            this._rooms = rooms;\r\n        }\r\n        else\r\n            this._rooms = value || {};\r\n        this._buildKeys();\r\n        this._keys.forEach(key => {\r\n            this._rooms[key] = this._normalizeRoom(this._rooms[key]);\r\n            if (this._rooms[key].zone > this._zone)\r\n                this._zone = this._rooms[key].zone;\r\n            if (this._areas.indexOf(this._rooms[key].area) === -1)\r\n                this._areas.push(this._rooms[key].area);\r\n        });\r\n        this._areas.sort();\r\n    }\r\n    public get Areas() {\r\n        if (!this._areas) this._buildAreas();\r\n        return this._areas;\r\n    }\r\n    public get zone() { return this._zone; }\r\n    public set zone(value) { this._zone = value || 0; }\r\n\r\n    public get count() { return this._keys.length; }\r\n\r\n    constructor() {\r\n        super();\r\n        this._rooms = {};\r\n        this._areas = [];\r\n        this._zone = 0;\r\n        this._keys = [];\r\n        this._keysZones = [];\r\n        this._current = new Room();\r\n    }\r\n\r\n    static load() {\r\n        return new Promise((resolve, reject) => {\r\n            localforage.getItem('nMapperData').then((value: any) => {\r\n                const map = new Map()\r\n                if (value && value.Rooms)\r\n                    map.Rooms = value.Rooms;\r\n                resolve(map);\r\n\r\n            }).catch(reject);\r\n        })\r\n    }\r\n\r\n    public save() {\r\n        this.changed = false;\r\n        return localforage.setItem('nMapperData', { Rooms: this._rooms, Areas: this.Areas, Keys: this._keys });\r\n    }\r\n\r\n    public getRoom(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        roomLoop:\r\n        for (let k = 0, kl = keys.length; k < kl; k++) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            return room;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public getRooms(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        const rooms = [];\r\n        roomLoop:\r\n        for (let k = 0, kl = keys.length; k < kl; k++) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            rooms.push(room);\r\n        }\r\n        return rooms;\r\n    }\r\n\r\n    public roomExists(filter) {\r\n        const keys = this._keysZones;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        if (keys.findIndex(key => {\r\n            let room = this._rooms[key];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    return false;\r\n            }\r\n            return true;\r\n        }) !== -1)\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n    public removeRoom(room) {\r\n        if (typeof room === 'string')\r\n            room = this._rooms[room];\r\n        if (!room) return;\r\n        if (this.Rooms[room.num]) {\r\n            let idx = this._keys.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keys.splice(idx, 1);\r\n            idx = this._keysZones.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keysZones.splice(idx, 1);\r\n            delete this._rooms[room.num];\r\n            this.changed = true;\r\n            this.emit('rooms-removed', [room]);\r\n            if (!this.getRoom({ area: room.area })) {\r\n                let idx = this._areas.indexOf(room.area);\r\n                this._areas.splice(idx, 1);\r\n                this.emit('areas-removed', [room.area]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public removeRooms(filter) {\r\n        const keys = this._keys;\r\n        const filterKeys = Object.keys(filter);\r\n        const fl = filterKeys.length;\r\n        const rooms = [];\r\n        let idx;\r\n        let areas = {};\r\n        roomLoop:\r\n        for (let k = keys.length - 1; k >= 0; k--) {\r\n            let room = this._rooms[keys[k]];\r\n            for (let f = 0; f < fl; f++) {\r\n                if (room[filterKeys[f]] !== filter[filterKeys[f]])\r\n                    continue roomLoop;\r\n            }\r\n            rooms.push(room);\r\n            idx = this._keys.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keys.splice(idx, 1);\r\n            idx = this._keysZones.indexOf(room.num);\r\n            if (idx !== -1)\r\n                this._keysZones.splice(idx, 1);\r\n            areas[room.area] = true;\r\n            delete this._rooms[room.num];\r\n        }\r\n        if (rooms.length) {\r\n            this.changed = true;\r\n            this.emit('rooms-removed', rooms);\r\n            for (let area in areas) {\r\n                if (!this.getRoom({ area: area })) {\r\n                    let idx = this._areas.indexOf(area);\r\n                    this._areas.splice(idx, 1);\r\n                }\r\n            }\r\n            this.emit('areas-removed', Object.keys(areas));\r\n        }\r\n    }\r\n\r\n    public removeAllRooms() {\r\n        const rooms = this._keys.map(key => this._rooms[key]);\r\n        const areas = this._areas;\r\n        this._rooms = {};\r\n        this._keys = [];\r\n        this._keysZones = [];\r\n        this._areas = [];\r\n        this._zone = 0;\r\n        this.current = new Room();\r\n        this.changed = true;\r\n        this.emit('rooms-removed', rooms);\r\n        this.emit('areas-removed', areas);\r\n    }\r\n\r\n    public setRoom(room: Room) {\r\n        if (!room) return;\r\n        this.changed = true;\r\n        room = this._normalizeRoom(room);\r\n        this.emit('before-room-changed', this._rooms[room.num]);\r\n        this._rooms[room.num] = room;\r\n        if (room.zone > this._zone)\r\n            this._zone = room.zone;\r\n        this._buildKeys();\r\n        this.addArea(room.area);\r\n        this.emit('room-changed', this._rooms[room.num]);\r\n        return this._rooms[room.num];\r\n    }\r\n\r\n    public addArea(area) {\r\n        if (!area) return 0;\r\n        if (this._areas.indexOf(area) !== -1) return;\r\n        this._areas.push(area);\r\n        this._areas.sort();\r\n        this.emit('areas-added', [area]);\r\n    }\r\n\r\n    public getFreeZone(zone) {\r\n        if (!zone) zone = 0;\r\n        if (zone > this.zone)\r\n            return zone;\r\n        return ++this.zone;\r\n    }\r\n\r\n    private _normalizeRoom(r) {\r\n        const id = '' + (r.num || r.ID);\r\n        const room = {\r\n            area: r.Area || r.area || '',\r\n            details: r.Details || r.details || RoomDetails.None,\r\n            name: r.Name || r.name || '',\r\n            env: r.Env || r.env || r.environment || '',\r\n            x: +r.X || +r.x || 0,\r\n            y: +r.Y || +r.y || 0,\r\n            z: +r.Z || +r.z || 0,\r\n            zone: +r.Zone || +r.zone || 0,\r\n            indoors: +r.Indoors || +r.indoors || 0,\r\n            background: r.Background || r.background || '',\r\n            notes: r.Notes || r.notes || '',\r\n            num: id ? '' + id : null,\r\n            exits: r.exits || {}\r\n        };\r\n        if (room.exits) {\r\n            let exit;\r\n            let dest;\r\n            for (exit in room.exits) {\r\n                if (!room.exits.hasOwnProperty(exit)) continue;\r\n                dest = room.exits[exit].DestID || room.exits[exit].num || null;\r\n                room.exits[exit] = {\r\n                    num: dest ? '' + dest : null,\r\n                    isdoor: +room.exits[exit].IsDoor || +room.exits[exit].isdoor || null,\r\n                    isclosed: +room.exits[exit].IsClosed || +room.exits[exit].isclosed || null\r\n                };\r\n            }\r\n        }\r\n        return new Room(room);\r\n    }\r\n\r\n    private _buildKeys() {\r\n        this._keys = Object.keys(this._rooms).sort((a, b) => {\r\n            const aRoom = this._rooms[a];\r\n            const bRoom = this._rooms[b];\r\n            if (aRoom.x > bRoom.x) return 1;\r\n            if (aRoom.x < bRoom.x) return -1;\r\n            if (aRoom.y > bRoom.y) return 1;\r\n            if (aRoom.y < bRoom.y) return -1;\r\n            if (aRoom.z > bRoom.z) return 1;\r\n            if (aRoom.z < bRoom.z) return -1;\r\n            if (aRoom.zone > bRoom.zone) return 1;\r\n            if (aRoom.zone < bRoom.zone) return -1;\r\n            return a.localeCompare(b);\r\n        });\r\n        this._keysZones = this._keys.slice().sort((a, b) => {\r\n            const aRoom = this._rooms[a];\r\n            const bRoom = this._rooms[b];\r\n            if (aRoom.zone > bRoom.zone) return 1;\r\n            if (aRoom.zone < bRoom.zone) return -1;\r\n            return a.localeCompare(b);\r\n        });\r\n    }\r\n\r\n    private _buildAreas() {\r\n        this._areas = [];\r\n        this._keys.forEach(key => {\r\n            if (this._areas.indexOf(this._rooms[key].area) === -1)\r\n                this._areas.push(this._rooms[key].area);\r\n        });\r\n        this._areas.sort();\r\n    }\r\n\r\n    private _cancel;\r\n    public cancelImport() {\r\n        this._cancel = true;\r\n    }\r\n\r\n    public async import(data, type: ImportType) {\r\n        if (!data || data === null || typeof data == 'undefined') {\r\n            return;\r\n        }\r\n        this._cancel = false;\r\n        if (!Array.isArray(data))\r\n            data = Object.values(data);\r\n        if (type === ImportType.Replace)\r\n            this.removeAllRooms();\r\n        this.emit('import-progress', 0);\r\n        const rl = data.length;\r\n        let room;\r\n        const areas = {};\r\n        this._areas.forEach(area => areas[area] = true);\r\n        const rooms = [];\r\n        for (let r = 0; r < rl; r++) {\r\n            if (this._cancel)\r\n                break;\r\n            this.emit('import-progress', Math.floor(r / rl * 100));\r\n            if (data[r] === null) continue;\r\n            room = this._normalizeRoom(data[r]);\r\n            this._rooms[room.num] = room;\r\n            if (room.zone > this._zone)\r\n                this._zone = room.zone;\r\n            areas[room.area] = true;\r\n            rooms.push(room);\r\n        }\r\n        this.emit('rooms-changed', rooms);\r\n        this._areas = Object.keys(areas);\r\n        this._areas.sort();\r\n        this.emit('areas-added', Object.keys(areas));\r\n        this._buildKeys();\r\n        this.changed = true;\r\n        if (this._cancel)\r\n            this.emit('import-canceled');\r\n        else\r\n            this.emit('import-complete');\r\n\r\n    }\r\n}\r\n", "<div class=\"mb-3\"><label class=\"form-label\" for=\"pasteSpecial-replace\">Replace with</label><div class=\"input-group\"><input id=\"pasteSpecial-replace\" class=\"form-control\"><div class=\"input-group-text\"><input class=\"form-check-input\" type=\"checkbox\" id=\"pasteSpecial-replace-enable\" checked=\"checked\"></div></div></div><div class=\"mb-3\"><label class=\"form-label\" for=\"pasteSpecial-prefix\">Prefix</label><div class=\"input-group\"><input id=\"pasteSpecial-prefix\" class=\"form-control\"><div class=\"input-group-text\"><input class=\"form-check-input\" type=\"checkbox\" id=\"pasteSpecial-prefix-enable\" checked=\"checked\"></div></div></div><div class=\"mb-3\"><label class=\"form-label\" for=\"pasteSpecial-postfix\">Postfix</label><div class=\"input-group\"><input id=\"pasteSpecial-postfix\" class=\"form-control\"><div class=\"input-group-text\"><input class=\"form-check-input\" type=\"checkbox\" id=\"pasteSpecial-postfix-enable\" checked=\"checked\"></div></div></div>", "import '../css/dialog.css';\r\nimport { EventEmitter } from '../core/events';\r\nimport { debounce } from '../core/library';\r\n\r\n// @ts-ignore\r\nimport _pasteSpecialBody from '../html/paste.special.htm'\r\n\r\nexport interface DialogOptions {\r\n    title?: string;\r\n    width?: string | number;\r\n    height?: string | number;\r\n    minWidth?: string | number;\r\n    minHeight?: string | number;\r\n    x?: string | number;\r\n    y?: string | number;\r\n    id?: string;\r\n    buttons?: DialogButtons;\r\n    resizable?: boolean;\r\n    moveable?: boolean;\r\n    maximizable?: boolean;\r\n    noAdaptive?: boolean;\r\n    maximized?: boolean;\r\n    showModal?: boolean;\r\n    show?: boolean | number;\r\n    center?: boolean;\r\n    keepCentered?: boolean;\r\n    noFooter?: boolean;\r\n    position?: Position;\r\n    closeable?: boolean;\r\n    document?: Document;\r\n    persistent?: boolean;\r\n}\r\n\r\nenum ResizeType {\r\n    None = 0,\r\n    Right = 1 << 0,\r\n    Bottom = 1 << 1,\r\n    Left = 1 << 2,\r\n    Top = 1 << 3,\r\n}\r\n\r\nenum Position {\r\n    Left = 1 << 0,\r\n    Right = 1 << 1,\r\n    Top = 1 << 2,\r\n    Bottom = 1 << 3,\r\n    CenterVertical = 1 << 4,\r\n    CenterHorizontal = 1 << 5,\r\n    Center = Position.CenterHorizontal | Position.CenterVertical\r\n}\r\n\r\nexport enum DialogButtons {\r\n    None = 0,\r\n    Ok = 1 << 0,\r\n    Cancel = 1 << 1,\r\n    Yes = 1 << 2,\r\n    No = 1 << 3,\r\n    YesNo = Yes | No,\r\n    Standard = Ok | Cancel\r\n}\r\n\r\nexport enum DialogIcon {\r\n    question = 1,\r\n    info = 2,\r\n    error = 3,\r\n    exclamation = 4\r\n}\r\n\r\nexport class Dialog extends EventEmitter {\r\n    private _dialog;\r\n    private _body;\r\n    private _footer;\r\n    private _header;\r\n    private _title;\r\n    private _id;\r\n    private _state = { x: 0, y: 0, height: 0, width: 0, zIndex: 100, maximized: false, show: 0, persistent: false };\r\n    private _resize = { x: 0, y: 0, height: 0, width: 0, type: ResizeType.None, minHeight: 150, minWidth: 300, borderHeight: 1, borderWidth: 1 };\r\n    private _dragPosition = { x: 0, y: 0 };\r\n\r\n    private _resizeObserver;\r\n    private _resizeObserverCache;\r\n    private _observer: MutationObserver;\r\n\r\n    private _document;\r\n    private _window;\r\n\r\n    private _windowResize = () => {\r\n        //if window resized ensure top left corner is visible\r\n        debounce(() => {\r\n            if (this.keepCentered || (this._state.show === 2 && !this.moveable))\r\n                this.center();\r\n            else\r\n                this.makeVisible();\r\n            if (this._footer.style.display !== 'none')\r\n                this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n            this.emit(this.id + 'resizing');\r\n        }, 250, this._id + 'dialogResize');\r\n    };\r\n\r\n    private _resizeDoDrag = e => {\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.clientY - this._resize.y;\r\n            if (t > window.innerWidth - 16) t = window.innerHeight - 16;\r\n            this._dialog.style.height = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                let rect = this._dialog.getBoundingClientRect();\r\n                this._dialog.style.top = (rect.bottom - this._resize.minHeight) + 'px';\r\n                this._dialog.style.height = this._resize.minHeight + 'px';\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + 'px';\r\n            t = e.clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                let rect = this._dialog.getBoundingClientRect();\r\n                this._dialog.style.left = (rect.right - this._resize.minWidth) + 'px';\r\n                this._dialog.style.width = this._resize.minWidth + 'px';\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + 'px';\r\n            t = e.clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + 'px';\r\n        }\r\n        if (this._footer.style.display !== 'none')\r\n            this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n        this.emit('resizing');\r\n    };\r\n\r\n    private _resizeTouchDrag = e => {\r\n        if (!e.touches.length) return;\r\n        let t;\r\n        if ((this._resize.type & ResizeType.Right) === ResizeType.Right) {\r\n            t = this._resize.width + e.touches[0].clientX - this._resize.x;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.width = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Bottom) === ResizeType.Bottom) {\r\n            t = this._resize.height + e.touches[0].clientY - this._resize.y;\r\n            if (t > window.innerWidth) t = window.innerHeight;\r\n            this._dialog.style.height = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Top) === ResizeType.Top) {\r\n            t = this._resize.height - e.touches[0].clientY + this._resize.y - this._resize.borderHeight;\r\n            if (t + this._resize.borderHeight > window.innerHeight) t = window.innerHeight;\r\n            if (t + this._resize.borderHeight <= this._resize.minHeight) {\r\n                let rect = this._dialog.getBoundingClientRect();\r\n                this._dialog.style.top = (rect.bottom - this._resize.minHeight) + 'px';\r\n                this._dialog.style.height = this._resize.minHeight + 'px';\r\n                return;\r\n            }\r\n            this._dialog.style.height = t + 'px';\r\n            t = e.touches[0].clientY;\r\n            if (t > window.innerHeight) t = window.innerHeight;\r\n            this._dialog.style.top = t + 'px';\r\n        }\r\n        if ((this._resize.type & ResizeType.Left) === ResizeType.Left) {\r\n            t = this._resize.width - e.touches[0].clientX + this._resize.x - this._resize.borderWidth;\r\n            if (t + this._resize.borderWidth > window.innerWidth) t = window.innerWidth;\r\n            if (t + this._resize.borderWidth <= this._resize.minWidth) {\r\n                let rect = this._dialog.getBoundingClientRect();\r\n                this._dialog.style.left = (rect.right - this._resize.minWidth) + 'px';\r\n                this._dialog.style.width = this._resize.minWidth + 'px';\r\n                return;\r\n            }\r\n            this._dialog.style.width = t + 'px';\r\n            t = e.touches[0].clientX;\r\n            if (t > window.innerWidth) t = window.innerWidth;\r\n            this._dialog.style.left = t + 'px';\r\n        }\r\n        if (this._footer.style.display !== 'none')\r\n            this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n        this.emit('resizing');\r\n    };\r\n\r\n    private _resizeStopDrag = e => {\r\n        this._document.documentElement.removeEventListener('mousemove', this._resizeDoDrag);\r\n        this._document.documentElement.removeEventListener('mouseup', this._resizeStopDrag);\r\n        this._document.documentElement.removeEventListener('touchmove', this._resizeTouchDrag);\r\n        this._document.documentElement.removeEventListener('touchend', this._resizeStopDrag);\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this._body.style.pointerEvents = '';\r\n        this.emit('resized', this._state);\r\n    }\r\n\r\n    private _dragMouseDown = e => {\r\n        if (this.maximized) return;\r\n        let tag = e.srcElement ? e.srcElement.tagName : '';\r\n        if (tag && ((e.srcElement.parentElement && e.srcElement.parentNode.tagName === 'BUTTON') || tag === 'BUTTON' || tag === 'INPUT' || tag === 'SELECT' || tag === 'SELECT' || tag === 'TEXTAREA')) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        this._document.documentElement.addEventListener('mouseup', this._dragMouseUp);\r\n        this._document.documentElement.addEventListener('mousemove', this._dragMouseMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private _dragTouchStart = e => {\r\n        if (this.maximized) return;\r\n        let tag = e.srcElement ? e.srcElement.tagName : '';\r\n        if (tag && ((e.srcElement.parentElement && e.srcElement.parentNode.tagName === 'BUTTON') || tag === 'BUTTON' || tag === 'INPUT' || tag === 'SELECT' || tag === 'SELECT' || tag === 'TEXTAREA')) return;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        this._document.documentElement.addEventListener('touchend', this._dragMouseUp);\r\n        this._document.documentElement.addEventListener('touchmove', this._dragTouchMove);\r\n        this._header.style.cursor = 'move';\r\n    };\r\n\r\n    private _dragMouseMove = e => {\r\n        let x = this._dragPosition.x - e.clientX;\r\n        let y = this._dragPosition.y - e.clientY;\r\n        this._dragPosition.x = e.clientX;\r\n        this._dragPosition.y = e.clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        let size = this._size;\r\n        if (this._state.x < 16 - size.width)\r\n            this._state.x = 16 - size.width;\r\n        if (this._state.y < 16 - size.height)\r\n            this._state.y = 16 - size.height;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private _dragTouchMove = e => {\r\n        if (!e.touches.length) return;\r\n        let x = this._dragPosition.x - e.touches[0].clientX;\r\n        let y = this._dragPosition.y - e.touches[0].clientY;\r\n        this._dragPosition.x = e.touches[0].clientX;\r\n        this._dragPosition.y = e.touches[0].clientY;\r\n        this._state.x = this._dialog.offsetLeft - x;\r\n        this._state.y = this._dialog.offsetTop - y;\r\n        if (this._state.x > window.innerWidth - 16)\r\n            this._state.x = window.innerWidth - 16;\r\n        if (this._state.y > window.innerHeight - 16)\r\n            this._state.y = window.innerHeight - 16;\r\n        let size = this._size;\r\n        if (this._state.x < 16 - size.width)\r\n            this._state.x = 16 - size.width;\r\n        if (this._state.y < 16 - size.height)\r\n            this._state.y = 16 - size.height;\r\n        this._dialog.style.left = this._state.x + 'px'\r\n        this._dialog.style.top = this._state.y + 'px'\r\n    };\r\n\r\n    private _dragMouseUp = () => {\r\n        this._document.documentElement.removeEventListener('mouseup', this._dragMouseUp);\r\n        this._document.documentElement.removeEventListener('mousemove', this._dragMouseMove);\r\n        this._document.documentElement.removeEventListener('touchend', this._dragMouseUp);\r\n        this._document.documentElement.removeEventListener('touchmove', this._dragTouchMove);\r\n        this._header.style.cursor = '';\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._state.x = parseInt(styles.left, 10);;\r\n        this._state.width = parseInt(styles.width, 10);\r\n        this._state.y = parseInt(styles.top, 10);;\r\n        this._state.height = parseInt(styles.height, 10);\r\n        this.emit('moved', this._state);\r\n    };\r\n\r\n    public keepCentered: boolean = false;\r\n    public moveable: boolean = true;\r\n    public resizable: boolean = true;\r\n    private _maximizable: boolean = true;\r\n    private _closable: boolean = true;\r\n\r\n    public get persistent() { return this._state.persistent; }\r\n    public set persistent(value) {\r\n        if (value === this._state.persistent) return;\r\n        this._state.persistent = value;\r\n        if (value && this._dialog && !this._dialog.parentElement)\r\n            this._document.body.appendChild(this._dialog);\r\n        else if (!value && this._dialog.parentElement)\r\n            this._document.body.removeChild(this._dialog);\r\n    }\r\n\r\n    public get maximizable() { return this._maximizable; }\r\n    public set maximizable(value) {\r\n        if (value === this._maximizable) return;\r\n        this._maximizable = value;\r\n        if (this.maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n    }\r\n\r\n    public get closeable() { return this._closable; }\r\n    public set closeable(value) {\r\n        if (value === this._closable) return;\r\n        this._closable = value;\r\n        if (this._closable)\r\n            this._dialog.querySelector(`#${this._id}-header-close`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-header-close`).style.display = 'none';\r\n    }\r\n\r\n    public set maximized(value: boolean) {\r\n        if (this._state.maximized === value) return;\r\n        this._state.maximized = value;\r\n    }\r\n    public get maximized(): boolean {\r\n        return this._state.maximized;\r\n    }\r\n\r\n    constructor(options?: DialogOptions) {\r\n        super();\r\n        this._window = window;\r\n        this._document = options ? options.document || document : document;\r\n        this._window = this._document.defaultView;\r\n        if (options && 'type' in options && options.type == 1) {\r\n            this._dialog = this._document.createElement('div');\r\n            this._dialog.open = false;\r\n        }\r\n        else\r\n            this._dialog = this._document.createElement('dialog');\r\n\r\n        if (typeof this._dialog.showModal !== 'function') {\r\n            this._dialog.showModal = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 2;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n                if (!this._dialog._keydown) {\r\n                    this._dialog._keydown = e => {\r\n                        if (e.key === 'Escape' && e.srcElement.tagName !== 'TEXTAREA' && e.srcElement.tagName !== 'INPUT' && e.srcElement.tagName !== 'SELECT') {\r\n                            this._dialog.returnValue = 'canceled';\r\n                            this.close();\r\n                        }\r\n                    }\r\n                }\r\n                if (!this._dialog.backdrop_) {\r\n                    this._dialog.backdrop_ = this._document.createElement('div');\r\n                    this._dialog.backdrop_.className = 'backdrop';\r\n                    this._dialog.backdrop_MouseEvent = function (e) {\r\n                        if (!this.hasAttribute('tabindex')) {\r\n                            let fake = this._document.createElement('div');\r\n                            this.insertBefore(fake, this.firstChild);\r\n                            fake.tabIndex = -1;\r\n                            fake.focus();\r\n                            this.removeChild(fake);\r\n                        }\r\n                        else\r\n                            this.focus();\r\n                        let redirectedEvent = this._document.createEvent('MouseEvents');\r\n                        redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\r\n                            e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\r\n                            e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\r\n                        this.dispatchEvent(redirectedEvent);\r\n                        e.stopPropagation();\r\n                    }\r\n                    this._dialog.backdrop_.addEventListener('mouseup', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('mousedown', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                    this._dialog.backdrop_.addEventListener('click', this._dialog.backdrop_MouseEvent.bind(this._dialog));\r\n                }\r\n                this._dialog.parentNode.insertBefore(this._dialog.backdrop_, this._dialog.nextSibling);\r\n                this._document.addEventListener('keydown', this._dialog._keydown);\r\n            };\r\n        }\r\n        //poly fill functions if not found to fake dialog\r\n        if (typeof this._dialog.show !== 'function') {\r\n            this._dialog.show = () => {\r\n                if (this._dialog.open) return;\r\n                this._dialog.style.display = 'block';\r\n                this._dialog.style.visibility = 'visible';\r\n                this._dialog.open = true;\r\n                this._state.show = 1;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n            };\r\n        }\r\n        if (typeof this._dialog.close !== 'function') {\r\n            this._dialog.close = () => {\r\n                this._dialog.style.display = '';\r\n                this._dialog.style.visibility = '';\r\n                this._dialog.open = false;\r\n                this._state.show = 0;\r\n                this._dialog.dataset.show = '' + this._state.show;\r\n                this._window.removeEventListener('resize', this._windowResize);\r\n                this.emit('closed');\r\n            };\r\n        }\r\n        this._dialog.dialog = this;\r\n        if (options && 'id' in options && options.id && options.id.length)\r\n            this._id = options.id;\r\n        else if (!this._id || !this._id.length)\r\n            this._id = 'dialog' + new Date().getTime();\r\n        this._dialog.id = this._id;\r\n        this._dialog.style.zIndex = '100';\r\n        this._dialog.style.margin = '0';\r\n        this._dialog.classList.add('dialog');\r\n        if (!options || !options.noAdaptive)\r\n            this._dialog.classList.add('adaptive');\r\n        if (options && 'moveable' in options)\r\n            this.moveable = options.moveable;\r\n        if (options && 'resizable' in options)\r\n            this.resizable = options.resizable;\r\n        if (options && 'maximizable' in options)\r\n            this._maximizable = options.maximizable;\r\n        if (options && 'persistent' in options)\r\n            this._state.persistent = options.persistent;\r\n        if (typeof options?.height === 'number')\r\n            this._dialog.style.height = options.height + 'px';\r\n        else if (options?.height && options?.height.length > 0)\r\n            this._dialog.style.height = options.height;\r\n        else\r\n            this._dialog.style.height = '480px';\r\n\r\n        if (typeof options?.minHeight === 'number')\r\n            this._dialog.style.minHeight = options.minHeight + 'px';\r\n        else if (options?.minHeight && options?.minHeight.length > 0)\r\n            this._dialog.style.minHeight = options.minHeight;\r\n        else\r\n            this._dialog.style.minHeight = '150px';\r\n\r\n        if (typeof options?.minWidth === 'number')\r\n            this._dialog.style.minWidth = options.minWidth + 'px';\r\n        else if (options?.minWidth && options?.minWidth.length > 0)\r\n            this._dialog.style.minWidth = options.minWidth;\r\n        else\r\n            this._dialog.style.minWidth = '300px';\r\n\r\n        if (typeof options?.width === 'number')\r\n            this._dialog.style.width = options.width + 'px';\r\n        else if (options?.width && options?.width.length > 0)\r\n            this._dialog.style.width = options.width;\r\n        else\r\n            this._dialog.style.width = '640px';\r\n        if (typeof options?.y === 'number')\r\n            this._dialog.style.top = options.y + 'px';\r\n        else if (options?.y && options?.y.length > 0)\r\n            this._dialog.style.top = options.y;\r\n        else\r\n            this._dialog.style.top = '0';\r\n        if (typeof options?.x === 'number')\r\n            this._dialog.style.left = options.x + 'px';\r\n        else if (options?.x && options?.x.length > 0)\r\n            this._dialog.style.left = options.x;\r\n        else\r\n            this._dialog.style.left = '0';\r\n        let footer = '';\r\n        if (options && (options.buttons & DialogButtons.Cancel) === DialogButtons.Cancel)\r\n            footer += `<button id=\"${this._id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Cancel dialog\">Cancel</button>`\r\n        if (options && (options.buttons & DialogButtons.Ok) === DialogButtons.Ok)\r\n            footer += `<button id=\"${this._id}-ok\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Confirm dialog\">Ok</button>`;\r\n        if (options && (options.buttons & DialogButtons.No) === DialogButtons.No)\r\n            footer += `<button id=\"${this._id}-no\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"No\">No</button>`\r\n        if (options && (options.buttons & DialogButtons.Yes) === DialogButtons.Yes)\r\n            footer += `<button id=\"${this._id}-yes\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Yes\">Yes</button>`;\r\n        this._dialog.innerHTML = `<div class=\"dialog-header\"><button id=\"${this._id}-header-close\" style=\"padding: 4px;\" type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" title=\"Close window\"></button><button type=\"button\" class=\"btn btn-light float-end maximize\" id=\"${this._id}-max\" title=\"Maximize window\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-arrows-fullscreen\"></i></button><div>${options?.title || ''}</div></div><div class=\"dialog-body\"></div><div class=\"dialog-footer\">${footer}</div>`;\r\n        this._dialog.querySelector(`#${this._id}-header-close`).addEventListener('click', () => {\r\n            this.close();\r\n        });\r\n        this._dialog.querySelector(`#${this._id}-max`).addEventListener('click', () => {\r\n            if (!this.maximized)\r\n                this.maximize();\r\n            else\r\n                this.restore();\r\n        });\r\n        this._dialog.addEventListener('close', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('closing', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            if (!this._state.persistent)\r\n                this._document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            this._dialog.dataset.show = '' + this._state.show;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                this._window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            this._window.removeEventListener('resize', this._windowResize);\r\n            this.emit('closed', this._dialog.returnValue);\r\n        });\r\n        this._dialog.addEventListener('cancel', e => {\r\n            if (e.target !== this._dialog) return;\r\n            const ec = { preventDefault: false };\r\n            this.emit('canceling', ec);\r\n            if (ec.preventDefault) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //prevent closing ig in edit field, note this does not stop chrome from closing dialog if esc is pressed multiple times\r\n            if (this._document.activeElement && (this._document.activeElement.tagName === 'TEXTAREA' ||\r\n                this._document.activeElement.tagName === 'iNPUT' ||\r\n                this._document.activeElement.tagName === 'SELECT')\r\n            ) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            //left true sometimes so lets just always make it false to ensure modal dialogs open right\r\n            this._dialog.open = false;\r\n            if (!this._state.persistent)\r\n                this._document.body.removeChild(this._dialog);\r\n            this._state.show = 0;\r\n            this._dialog.dataset.show = '' + this._state.show;\r\n            if (this._dialog.backdrop_)\r\n                this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n            if (this._dialog._keydown)\r\n                this._window.document.removeEventListener('keydown', this._dialog._keydown);\r\n            this._window.removeEventListener('resize', this._windowResize);\r\n            if (this._dialog.returnValue !== 'ok')\r\n                this.emit('canceled');\r\n        });\r\n        this._document.body.appendChild(this._dialog);\r\n\r\n        if (this._maximizable)\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = '';\r\n        else\r\n            this._dialog.querySelector(`#${this._id}-max`).style.display = 'none';\r\n        if (options && 'closeable' in options)\r\n            this.closeable = options.closeable;\r\n        if (options && (options.buttons & DialogButtons.Cancel) === DialogButtons.Cancel)\r\n            this._dialog.querySelector(`#${this._id}-cancel`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Cancel };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'cancel';\r\n                this.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.No) === DialogButtons.No)\r\n            this._dialog.querySelector(`#${this._id}-no`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.No };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'no';\r\n                this.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.Ok) === DialogButtons.Ok)\r\n            this._dialog.querySelector(`#${this._id}-ok`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Ok };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'ok';\r\n                this._dialog.close();\r\n            });\r\n        if (options && (options.buttons & DialogButtons.Yes) === DialogButtons.Yes)\r\n            this._dialog.querySelector(`#${this._id}-yes`).addEventListener('click', () => {\r\n                const e = { preventDefault: false, button: DialogButtons.Yes };\r\n                this.emit('button-click', e);\r\n                if (e.preventDefault) return;\r\n                this._dialog.returnValue = 'yes';\r\n                this._dialog.close();\r\n            });\r\n        this._body = this._dialog.querySelector('[class=\"dialog-body\"]');\r\n        this._title = this._dialog.querySelector('[class=\"dialog-header\"] div');\r\n        this._footer = this._dialog.querySelector('[class=\"dialog-footer\"]');\r\n        this._header = this._dialog.querySelector('[class=\"dialog-header\"]');\r\n\r\n        if (this.resizable) {\r\n            this._dialog.classList.add('resizable');\r\n            let right = this._document.createElement('div');\r\n            right.className = 'resizer-right';\r\n            this._dialog.appendChild(right);\r\n            right.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Right) }, false);\r\n            right.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Right) }, { passive: true });\r\n\r\n            let bottom = this._document.createElement('div');\r\n            bottom.className = 'resizer-bottom';\r\n            this._dialog.appendChild(bottom);\r\n            bottom.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Bottom) }, false);\r\n            bottom.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Bottom) }, { passive: true });\r\n\r\n            let corner = this._document.createElement('div');\r\n            corner.className = 'resizer-se';\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Right | ResizeType.Bottom) }, false);\r\n            corner.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Right | ResizeType.Bottom) }, { passive: true });\r\n\r\n            corner = this._document.createElement('div');\r\n            corner.className = 'resizer-ne';\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Right | ResizeType.Top) }, false);\r\n            corner.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Right | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = this._document.createElement('div');\r\n            corner.className = 'resizer-nw';\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Left | ResizeType.Top) }, false);\r\n            corner.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Left | ResizeType.Top) }, { passive: true });\r\n\r\n            corner = this._document.createElement('div');\r\n            corner.className = 'resizer-sw';\r\n            this._dialog.appendChild(corner);\r\n            corner.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Left | ResizeType.Bottom) }, false);\r\n            corner.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Left | ResizeType.Bottom) }, { passive: true });\r\n\r\n            let left = this._document.createElement('div');\r\n            left.className = 'resizer-left';\r\n            this._dialog.appendChild(left);\r\n            left.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Left) }, false);\r\n            left.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Left) }, { passive: true });\r\n\r\n            let top = this._document.createElement('div');\r\n            top.className = 'resizer-top';\r\n            this._dialog.appendChild(top);\r\n            top.addEventListener('mousedown', e => { this._initResize(e, ResizeType.Top) }, false);\r\n            top.addEventListener('touchstart', e => { this._initResizeTouch(e, ResizeType.Top) }, { passive: true });\r\n        }\r\n\r\n        if (this.moveable) {\r\n            this._dialog.addEventListener('mousedown', () => {\r\n                this.focus();\r\n            })\r\n            this._header.addEventListener('mousedown', this._dragMouseDown);\r\n            this._header.addEventListener('touchstart', this._dragTouchStart, { passive: true });\r\n        }\r\n\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._state.x = this._resize.x = parseInt(styles.left, 10);;\r\n        this._state.width = this._resize.width = parseInt(styles.width, 10);\r\n        this._state.y = this._resize.y = parseInt(styles.top, 10);;\r\n        this._state.height = this._resize.height = parseInt(styles.height, 10);\r\n        if (options && 'noFooter' in options && options.noFooter)\r\n            this.hideFooter();\r\n        if (options && 'maximized' in options && options.maximized)\r\n            this.maximize();\r\n        if (options && 'showModal' in options && options.showModal)\r\n            this.showModal();\r\n        else if (options && 'show' in options && options.show) {\r\n            if (options.show === 2)\r\n                this.showModal();\r\n            else\r\n                this.show();\r\n        }\r\n        if ((options && 'keepCentered' in options && options.keepCentered))\r\n            this.keepCentered = options.keepCentered;\r\n        if (this.keepCentered || (options && 'center' in options && options.center))\r\n            this.center();\r\n        if (options && 'position' in options && options.position > 0)\r\n            this.position(options.position);\r\n        this._windowResize();\r\n        this._resizeObserver = new ResizeObserver((entries, observer) => {\r\n            if (entries.length === 0) return;\r\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\r\n                return;\r\n            //debounce(() => {\r\n            if (!this._resizeObserverCache || this._resizeObserverCache.height !== entries[0].contentRect.height) {\r\n                this._resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\r\n                if (this._footer.style.display !== 'none')\r\n                    this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n            }\r\n            //}, 50, 'resize');\r\n        });\r\n        this._resizeObserver.observe(this._footer);\r\n        this._observer = new MutationObserver((mutationsList) => {\r\n            let mutation;\r\n            for (mutation of mutationsList) {\r\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\r\n                    if (this._footer.style.display !== 'none')\r\n                        this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n                }\r\n            }\r\n        });\r\n        this._observer.observe(this._footer, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\r\n    }\r\n\r\n    private _initResize(e, type) {\r\n        if (this.maximized) return;\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._resize.x = e.clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        this._resize.borderHeight = parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        this._document.documentElement.addEventListener('mousemove', this._resizeDoDrag, false);\r\n        this._document.documentElement.addEventListener('mouseup', this._resizeStopDrag, false);\r\n    }\r\n\r\n    private _initResizeTouch(e, type) {\r\n        if (!e.touches.length || this.maximized) return;\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._resize.x = e.touches[0].clientX;\r\n        this._resize.width = parseInt(styles.width, 10);\r\n        this._resize.y = e.touches[0].clientY;\r\n        this._resize.height = parseInt(styles.height, 10);\r\n        this._resize.type = type;\r\n        this._resize.minHeight = parseInt(styles.minHeight, 10);\r\n        this._resize.minWidth = parseInt(styles.minWidth, 10);\r\n        //let rect = e.target.getBoundingClientRect();\r\n        //let x = e.targetTouches[0].clientX - rect.x;\r\n        //let y = e.targetTouches[0].clientY - rect.y;\r\n        this._resize.borderHeight = parseInt(styles.borderTopWidth);\r\n        this._resize.borderWidth = parseInt(styles.borderLeftWidth);\r\n        this._body.style.pointerEvents = 'none';\r\n        this._document.documentElement.addEventListener('touchmove', this._resizeTouchDrag, false);\r\n        this._document.documentElement.addEventListener('touchend', this._resizeStopDrag, false);\r\n    }\r\n\r\n    public get id() {\r\n        return this._id;\r\n    }\r\n\r\n    public set id(value) {\r\n        if (this._id === value) return;\r\n        this._id = value;\r\n        if (this._dialog) {\r\n            this._dialog.id = this._id;\r\n            let el = this._dialog.querySelector(`#${this._id}-cancel`);\r\n            if (el) el.id = this._id + '-cancel';\r\n            el = this._dialog.querySelector(`#${this._id}-ok`);\r\n            if (el) el.id = this._id + '-ok';\r\n            el = this._dialog.querySelector(`#${this._id}-max`);\r\n            if (el) el.id = this._id + '-max';\r\n            el = this._dialog.querySelector(`#${this._id}-header-close`);\r\n            if (el) el.id = this._id + '-header-close';\r\n        }\r\n    }\r\n\r\n    public get title() {\r\n        return this._title.innerHTML;\r\n    }\r\n    public set title(value) {\r\n        this._title.innerHTML = value;\r\n    }\r\n\r\n    public showModal() {\r\n        if (!this._dialog.parentElement)\r\n            this._document.body.appendChild(this._dialog);\r\n        this.makeVisible(true);\r\n        this._dialog.returnValue = '';\r\n        if (this._dialog.open) {\r\n            this.focus();\r\n            return;\r\n        }\r\n        this._dialog.showModal();\r\n        this._state.show = 2;\r\n        this._dialog.dataset.show = '' + this._state.show;\r\n        this._window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', true);\r\n        this.focus();\r\n    }\r\n\r\n    public show() {\r\n        if (!this._dialog.parentElement)\r\n            this._document.body.appendChild(this._dialog);\r\n        this.makeVisible(true);\r\n        this._dialog.returnValue = '';\r\n        if (this._dialog.open) {\r\n            this.focus();\r\n            return;\r\n        }\r\n        this._dialog.show();\r\n        this._state.show = 1;\r\n        this._dialog.dataset.show = '' + this._state.show;\r\n        this._window.addEventListener('resize', this._windowResize);\r\n        this.emit('shown', false);\r\n        this.focus();\r\n    }\r\n\r\n    public get opened() {\r\n        return this._dialog.open;\r\n    }\r\n\r\n    public close(returnValue?) {\r\n        if (!this._dialog.open) return;\r\n        if (this._dialog.backdrop_)\r\n            this._dialog.parentNode.removeChild(this._dialog.backdrop_);\r\n        if (this._dialog._keydown)\r\n            this._document.removeEventListener('keydown', this._dialog._keydown);\r\n        if (returnValue)\r\n            this._dialog.returnValue = returnValue;\r\n        this._dialog.close();\r\n    }\r\n\r\n    public get header() {\r\n        return this._header;\r\n    }\r\n    public get body() {\r\n        return this._body;\r\n    }\r\n    public get footer() {\r\n        return this._footer;\r\n    }\r\n    public get dialog() {\r\n        return this._dialog;\r\n    }\r\n\r\n    public get left() {\r\n        return this._dialog.style.left;\r\n    }\r\n    public set left(value) {\r\n        this._dialog.style.left = value;\r\n    }\r\n\r\n    public get top() {\r\n        return this._dialog.style.top;\r\n    }\r\n    public set top(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get width() {\r\n        return this._dialog.style.width;\r\n    }\r\n    public set width(value) {\r\n        this._dialog.style.width = value;\r\n    }\r\n\r\n    public get height() {\r\n        return this._dialog.style.height;\r\n    }\r\n    public set height(value) {\r\n        this._dialog.style.top = value;\r\n    }\r\n\r\n    public get windowState() {\r\n        return this._state;\r\n    }\r\n\r\n    /*\r\n    private _width() {\r\n        let w = this.dialog.offsetWidth || this._dialog.clientWidth;\r\n        if (!w) {\r\n            const styles = this._window.getComputedStyle(this._dialog);\r\n            w = w || parseInt(styles.width, 10);\r\n        }\r\n        return w;\r\n    }\r\n\r\n    private _height() {\r\n        let h = this.dialog.offsetHeight || this._dialog.clientHeight;\r\n        if (!h) {\r\n            const styles = this._window.getComputedStyle(this._dialog);\r\n            h = h || parseInt(styles.height, 10);\r\n        }\r\n        return h;\r\n    }\r\n    */\r\n\r\n    private get _size() {\r\n        let w = this._dialog.offsetWidth || this._dialog.clientWidth;\r\n        let h = this._dialog.offsetHeight || this._dialog.clientHeight;\r\n        if (!w || !h) {\r\n            const styles = this._window.getComputedStyle(this._dialog);\r\n            w = w || parseInt(styles.width, 10);\r\n            h = h || parseInt(styles.height, 10);\r\n        }\r\n        return { width: w, height: h };\r\n    }\r\n\r\n    public center() {\r\n        this.position(Position.Center);\r\n    }\r\n\r\n    public position(position: Position) {\r\n        if (position < 1) return;\r\n        //styles2.width\r\n        let size = this._size;\r\n        if ((position & Position.Top) === Position.Top)\r\n            this._state.y = 0;\r\n        else if ((position & Position.Bottom) === Position.Bottom)\r\n            this._state.y = this._window.innerHeight - size.height;\r\n        else if ((position & Position.CenterVertical) === Position.CenterVertical)\r\n            this._state.y = (this._window.innerHeight / 2 - size.height / 2);\r\n\r\n        if ((position & Position.Left) === Position.Left)\r\n            this._state.x = 0;\r\n        else if ((position & Position.Right) === Position.Right)\r\n            this._state.x = this._window.innerWidth - size.width;\r\n        else if ((position & Position.CenterHorizontal) === Position.CenterHorizontal)\r\n            this._state.x = (this._window.innerWidth / 2 - size.width / 2);\r\n\r\n        this._dialog.style.left = this._state.x + 'px';\r\n        this._dialog.style.top = this._state.y + 'px';\r\n        this._state.width = size.width;\r\n        this._state.height = size.height;\r\n        this.emit('moved', this._state);\r\n    }\r\n\r\n    public maximize() {\r\n        if (this.maximized) return;\r\n        this.maximized = true;\r\n        this._dialog.classList.add('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-angle-contract');\r\n        this.emit('maximized');\r\n    }\r\n\r\n    public restore() {\r\n        if (!this.maximized) return;\r\n        this.maximized = false;\r\n        this._dialog.classList.remove('maximized');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.add('bi-arrows-fullscreen');\r\n        this._dialog.querySelector(`#${this._id}-max`).firstElementChild.classList.remove('bi-arrows-angle-contract');\r\n        this.emit('restored');\r\n    }\r\n\r\n    private _getMaxZIndex(forceReset?: boolean) {\r\n        const dialogs = this._document.getElementsByTagName('dialog');\r\n        let d = 0;\r\n        const dl = dialogs.length;\r\n        let i = parseInt(this._dialog.style.zIndex, 10);;\r\n        const order = [];\r\n        for (; d < dl; d++) {\r\n            if (!dialogs[d].style.zIndex || !dialogs[d].style.zIndex.length) continue;\r\n            let z = parseInt(dialogs[d].style.zIndex, 10);\r\n            if (z > i)\r\n                i = z;\r\n            order.push({ z: z, idx: d, show: parseInt(dialogs[d].dataset.show || '', 10) || 0 });\r\n        }\r\n        this._state.zIndex = i;\r\n        if (forceReset || this._state.zIndex > 1000) {\r\n            this._state.zIndex = 100;\r\n            d = 0;\r\n            //show by show type then old z-index, we do this to ensure modal style dialogs are on top\r\n            order.sort((a, b) => ((a.show > b.show) ? 1 : (a.z < b.z) ? -1 : (a.z > b.z ? 1 : 0)))\r\n            for (; d < dl; d++) {\r\n                if ((<any>dialogs[order[d]]).backdrop_)\r\n                    (<any>dialogs[order[d]]).backdrop_.style.zIndex = '' + (this._state.zIndex++);\r\n                dialogs[order[d].idx].style.zIndex = '' + (this._state.zIndex++);\r\n            }\r\n        }\r\n    }\r\n\r\n    public showFooter() {\r\n        this._footer.style.display = '';\r\n        this._body.style.bottom = (this._footer.clientHeight + 1) + 'px';\r\n    }\r\n\r\n    public hideFooter() {\r\n        this._footer.style.display = 'none';\r\n        this._body.style.bottom = '0';\r\n    }\r\n\r\n    public focus() {\r\n        this._dialog.focus();\r\n        this._getMaxZIndex();\r\n        this._dialog.style.zIndex = '' + ++this._state.zIndex;\r\n        this.emit('focus');\r\n    }\r\n\r\n    public makeVisible(full?, silent?) {\r\n        let rect = this._dialog.getBoundingClientRect();\r\n        if (full) {\r\n            if (rect.right > this._window.innerWidth) {\r\n                this._state.x = this._window.innerWidth - this._state.width - 16;\r\n                if (rect.left < 0) this._state.x = 0;\r\n                this._dialog.style.left = this._state.x + 'px';\r\n            }\r\n            if (rect.bottom > this._window.innerHeight) {\r\n                this._state.y = this._window.innerHeight - this._state.height - 16;\r\n                if (rect.top < 0) this._state.y = 0;\r\n                this._dialog.style.top = this._state.y + 'px';\r\n            }\r\n        }\r\n        else {\r\n            if (rect.left > this._window.innerWidth - 16) {\r\n                this._state.x = (this._window.innerWidth - 16);\r\n                this._dialog.style.left = this._state.x + 'px';\r\n            }\r\n            if (rect.top > this._window.innerHeight - 16) {\r\n                this._state.y = (this._window.innerHeight - 16);\r\n                this._dialog.style.top = this._state.y + 'px';\r\n            }\r\n        }\r\n        if (!silent)\r\n            this.emit('moved', this._state);\r\n    }\r\n\r\n    public resetState(options: DialogOptions) {\r\n        this._state.persistent = options.persistent;\r\n        if (typeof options?.height === 'number')\r\n            this._dialog.style.height = options.height + 'px';\r\n        else if (options?.height && options?.height.length > 0)\r\n            this._dialog.style.height = options.height;\r\n        else\r\n            this._dialog.style.height = '480px';\r\n\r\n        if (typeof options?.minHeight === 'number')\r\n            this._dialog.style.minHeight = options.minHeight + 'px';\r\n        else if (options?.minHeight && options?.minHeight.length > 0)\r\n            this._dialog.style.minHeight = options.minHeight;\r\n        else\r\n            this._dialog.style.minHeight = '150px';\r\n\r\n        if (typeof options?.minWidth === 'number')\r\n            this._dialog.style.minWidth = options.minWidth + 'px';\r\n        else if (options?.minWidth && options?.minWidth.length > 0)\r\n            this._dialog.style.minWidth = options.minWidth;\r\n        else\r\n            this._dialog.style.minWidth = '300px';\r\n\r\n        if (typeof options?.width === 'number')\r\n            this._dialog.style.width = options.width + 'px';\r\n        else if (options?.width && options?.width.length > 0)\r\n            this._dialog.style.width = options.width;\r\n        else\r\n            this._dialog.style.width = '640px';\r\n        if (typeof options?.y === 'number')\r\n            this._dialog.style.top = options.y + 'px';\r\n        else if (options?.y && options?.y.length > 0)\r\n            this._dialog.style.top = options.y;\r\n        else\r\n            this._dialog.style.top = '0';\r\n        if (typeof options?.x === 'number')\r\n            this._dialog.style.left = options.x + 'px';\r\n        else if (options?.x && options?.x.length > 0)\r\n            this._dialog.style.left = options.x;\r\n        else\r\n            this._dialog.style.left = '0';\r\n\r\n        const styles = this._window.getComputedStyle(this._dialog);\r\n        this._state.x = this._resize.x = parseInt(styles.left, 10);;\r\n        this._state.width = this._resize.width = parseInt(styles.width, 10);\r\n        this._state.y = this._resize.y = parseInt(styles.top, 10);;\r\n        this._state.height = this._resize.height = parseInt(styles.height, 10);\r\n\r\n        if (!this._state.show)\r\n            if (this._state.persistent && this._dialog && !this._dialog.parentElement)\r\n                this._document.body.appendChild(this._dialog);\r\n            else if (!this._state.persistent && this._dialog.parentElement)\r\n                this._document.body.removeChild(this._dialog);\r\n\r\n        if (options && 'maximized' in options && options.maximized)\r\n            this.maximize();\r\n        else\r\n            this.restore();\r\n        if (this.keepCentered || (options && 'center' in options && options.center))\r\n            this.center();\r\n        if (options && 'position' in options && options.position > 0)\r\n            this.position(options.position);\r\n        this._windowResize();\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        this._body.innerHTML = contents;\r\n        args = args || {};\r\n        const scripts: HTMLScriptElement[] = this._body.querySelectorAll('script');\r\n        for (let s = 0, sl = scripts.length; s < sl; s++) {\r\n            /*jslint evil: true */\r\n            let script = new Function('body', 'dialog', ...Object.keys(args), scripts[s].textContent);\r\n            script.apply(client, [this._body, this, ...Object.values(args), this]);\r\n        }\r\n    }\r\n}\r\n\r\nexport class AlertDialog extends Dialog {\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon, win?: Window) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.exclamation) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Ok, document: win ? win.document : document } : title);\r\n        this.body.classList.add('d-flex', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        if (message)\r\n            this.body.innerHTML = `<div class=\"text-center\" style=\"width: 64px;height:64px;font-size: 40px;\">${getIcon(icon || DialogIcon.exclamation)}</div><div class=\"ms-3 align-self-center flex-fill\">${message}</div></div>`;\r\n    }\r\n}\r\n\r\n\r\nexport class ConfirmDialog extends Dialog {\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon, buttons?: DialogButtons, win?: Window) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.question) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: buttons === undefined ? DialogButtons.YesNo : buttons, document: win ? win.document : document } : title);\r\n        this.body.classList.add('d-flex', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        if (message)\r\n            this.body.innerHTML = `<div class=\"text-center\" style=\"width: 64px;height:64px;font-size: 40px;\">${getIcon(icon || DialogIcon.question)}</div><div class=\"ms-3 align-self-center flex-fill\">${message}</div></div>`;\r\n    }\r\n}\r\n\r\nexport class ProgressDialog extends Dialog {\r\n    private _progress;\r\n    constructor(title: string | DialogOptions, message?, icon?: string | DialogIcon, win?: Window) {\r\n        super(typeof title === 'string' ? { title: getIcon(icon || DialogIcon.question) + title, width: 300, height: 150, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Cancel, closeable: false, document: win ? win.document : document } : title);\r\n        this.body.classList.add('text-center', 'justify-content-center', 'align-content-center', 'align-items-center');\r\n        this.body.innerHTML = `<div class=\"align-self-center flex-fill\" id=\"progress-message\" style=\"padding:0 5px\">${message || ''}</div></div><div class=\"progress\" role=\"progressbar\" aria-label=\"${title}\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"margin: 5px;\"><div class=\"progress-bar\" style=\"width: 0%\"></div></div>`;\r\n        this._progress = this.body.querySelector('.progress-bar');\r\n    }\r\n\r\n    public set label(value) {\r\n        this._progress.innerHTML = value;\r\n    }\r\n    public get label() { return this._progress.innerHTML; }\r\n    public set progress(value: number) {\r\n        if (value < 0) value = 0;\r\n        if (value > 100) value = 100;\r\n        this._progress.style.width = value + '%';\r\n    }\r\n    public get progress() {\r\n        return parseInt(this._progress.style.width, 10);\r\n    }\r\n\r\n    public get message() { return this.body.querySelector('#progress-message').textContent; }\r\n    public set message(value) { this.body.querySelector('#progress-message').textContent = value; }\r\n}\r\n\r\nfunction getIcon(icon: string | DialogIcon) {\r\n    if (typeof icon === 'string')\r\n        return icon + ' ';\r\n    switch (icon) {\r\n        case DialogIcon.error:\r\n            return '<i class=\"fa-regular fa-circle-xmark\"></i> ';\r\n        case DialogIcon.exclamation:\r\n            return '<i class=\"fa-solid fa-circle-exclamation\"></i> ';\r\n        case DialogIcon.question:\r\n            return '<i class=\"fa-regular fa-circle-question\"></i> '\r\n    }\r\n    return '<i class=\"fa-solid fa-circle-info\"></i> ';\r\n}\r\n\r\nwindow.confirm_box = (title, message?, icon?, buttons?, win?) => {\r\n    return new Promise((resolve, reject) => {\r\n        const confirm = new ConfirmDialog(title, message, icon, buttons, win);\r\n        confirm.showModal();\r\n        confirm.on('button-click', e => resolve(e));\r\n        confirm.on('canceled', () => reject(null));\r\n        confirm.on('closed', reason => reason === 'Yes' ? 0 : reject(null));\r\n    });\r\n}\r\nwindow.alert_box = (title, message?, icon?, win?) => {\r\n    new AlertDialog(title, message, icon, win).showModal();\r\n}\r\nwindow.progress_box = (title, message?, icon?, win?) => {\r\n    return new ProgressDialog(title, message, icon, win);\r\n}\r\n\r\nexport function pasteSpecial(options?) {\r\n    return new Promise((resolve, reject) => {\r\n        options = Object.assign({\r\n            prefixEnabled: true,\r\n            postfixEnabled: true,\r\n            replaceEnabled: true,\r\n            prefix: '',\r\n            postfix: '',\r\n            replace: '',\r\n            disable: true,\r\n            showDisable: true,\r\n        }, options || {});\r\n        const paste = new Dialog({ title: '<i class=\"bi bi-clipboard-plus\"></i> Paste special...', width: 350, height: 358, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Standard });\r\n        paste.body.innerHTML = _pasteSpecialBody;\r\n        paste.body.style.padding = '10px';\r\n        paste.body.style.overflow = 'hidden';\r\n\r\n        paste.body.querySelector('#pasteSpecial-prefix').disabled = !options.prefixEnabled;\r\n        paste.body.querySelector('#pasteSpecial-postfix').disabled = !options.postfixEnabled;\r\n        paste.body.querySelector('#pasteSpecial-prefix').value = options.prefix;\r\n        paste.body.querySelector('#pasteSpecial-postfix').value = options.postfix;\r\n        paste.body.querySelector('#pasteSpecial-prefix-enable').checked = options.prefixEnabled;\r\n        paste.body.querySelector('#pasteSpecial-postfix-enable').checked = options.postfixEnabled;\r\n        paste.body.querySelector('#pasteSpecial-replace').value = options.replace;\r\n        paste.body.querySelector('#pasteSpecial-replace').disabled = !options.replaceEnabled;\r\n        paste.body.querySelector('#pasteSpecial-replace-enable').checked = options.replaceEnabled;\r\n        const forms = paste.body.querySelectorAll('input[type=\"checkbox\"]');\r\n        for (let f = 0, fl = forms.length; f < fl; f++) {\r\n            forms[f].addEventListener('click', e => {\r\n                (document.getElementById(e.target.id.slice(0, -7)) as HTMLInputElement).disabled = !e.target.checked;\r\n            });\r\n        };\r\n        const _keydown = e => {\r\n            if (e.which === 13) {\r\n                var i;\r\n                if (document.activeElement.id === 'pasteSpecial-replace') {\r\n                    if (!(document.getElementById('pasteSpecial-prefix') as HTMLInputElement).disabled)\r\n                        i = document.getElementById('pasteSpecial-prefix');\r\n                    else if (!(document.getElementById('pasteSpecial-postfix') as HTMLInputElement).disabled)\r\n                        i = document.getElementById('pasteSpecial-postfix');\r\n                }\r\n                else if (document.activeElement.id === 'pasteSpecial-prefix' && !(document.getElementById('pasteSpecial-postfix') as HTMLInputElement).disabled)\r\n                    i = document.getElementById('pasteSpecial-postfix');\r\n                if (i)\r\n                    i.focus();\r\n                else\r\n                    paste.footer.querySelector(`#${paste.id}-ok`).click();\r\n                e.preventDefault();\r\n            }\r\n        }\r\n        document.addEventListener('keydown', _keydown);\r\n        if (options.showDisable)\r\n            paste.footer.insertAdjacentHTML('afterbegin', `<div class=\"form-check float-start\" style=\"margin-top: 3px;\"><input type=\"checkbox\" class=\"form-check-input\" id=\"pasteSpecial-disable\"><label class=\"form-check-label\" for=\"pasteSpecial-disable\">Disable</label></div>`);\r\n        paste.footer.insertAdjacentHTML('afterbegin', `<button id=\"btn-pasteSpecial-reset\" class=\"btn-sm float-start btn btn-outline-secondary\" type=\"button\" title=\"Show menu\" style=\"margin-right: 4px;\">Reset</button>`);\r\n        if (options.showDisable)\r\n            paste.footer.querySelector('#pasteSpecial-disable').checked = options.disable;\r\n        paste.footer.querySelector('#btn-pasteSpecial-reset').addEventListener('click', e => {\r\n            (document.getElementById('pasteSpecial-replace') as HTMLInputElement).disabled = false;\r\n            (document.getElementById('pasteSpecial-replace-enable') as HTMLInputElement).checked = true;\r\n            (document.getElementById('pasteSpecial-replace') as HTMLInputElement).value = '';\r\n            (document.getElementById('pasteSpecial-prefix') as HTMLInputElement).disabled = false;\r\n            (document.getElementById('pasteSpecial-postfix') as HTMLInputElement).disabled = false;\r\n            (document.getElementById('pasteSpecial-prefix') as HTMLInputElement).value = '';\r\n            (document.getElementById('pasteSpecial-postfix') as HTMLInputElement).value = '';\r\n            (document.getElementById('pasteSpecial-prefix-enable') as HTMLInputElement).checked = true;\r\n            (document.getElementById('pasteSpecial-postfix-enable') as HTMLInputElement).checked = true;\r\n        });\r\n        paste.showModal();\r\n        if (!paste.body.querySelector('#pasteSpecial-replace').disabled)\r\n            paste.body.querySelector('#pasteSpecial-replace').focus();\r\n        else if (!paste.body.querySelector('#pasteSpecial-prefix').disabled)\r\n            paste.body.querySelector('#pasteSpecial-prefix').focus();\r\n        else if (!paste.body.querySelector('#pasteSpecial-postfix').disabled)\r\n            paste.body.querySelector('#pasteSpecial-postfix').focus();\r\n        else\r\n            paste.footer.querySelector(`#${paste.id}-cancel`).focus();\r\n        paste.on('button-click', e => {\r\n            options.prefix = (document.getElementById('pasteSpecial-prefix') as HTMLInputElement).value;\r\n            options.postfix = (document.getElementById('pasteSpecial-postfix') as HTMLInputElement).value;\r\n            options.prefixEnabled = (document.getElementById('pasteSpecial-prefix-enable') as HTMLInputElement).checked;\r\n            options.postfixEnabled = (document.getElementById('pasteSpecial-postfix-enable') as HTMLInputElement).checked;\r\n            options.replace = (document.getElementById('pasteSpecial-replace') as HTMLInputElement).value;\r\n            options.replaceEnabled = (document.getElementById('pasteSpecial-replace-enable') as HTMLInputElement).checked;\r\n            if (options.showDisable)\r\n                options.disable = (document.getElementById('pasteSpecial-disable') as HTMLInputElement).checked;\r\n            e.options = options;\r\n            document.addEventListener('keydown', _keydown);\r\n            resolve(e);\r\n        });\r\n        paste.on('canceled', () => {\r\n            reject(null);\r\n            document.removeEventListener('keydown', _keydown);\r\n        });\r\n        paste.on('closed', reason => {\r\n            document.removeEventListener('keydown', _keydown);\r\n            if (reason !== 'Yes') reject(null);\r\n        });\r\n    });\r\n}\r\n\r\nwindow.Dialog = Dialog;", "declare let client;\ndeclare let bootstrap;\n\nimport { showDialog, toggleButtons, doPasteSpecial } from './interface';\nimport { isPasteSupported, pasteText, insertValue } from '../core/library';\n\nexport function closeMenu() {\n    const instance = bootstrap.Offcanvas.getInstance(document.getElementById('clientMenu'));\n    if (!instance) return\n    instance.hide();\n}\n\nexport function showMenu() {\n    bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('clientMenu')).show();\n}\n\nexport function initMenu() {\n    var clientMenu = document.getElementById('clientMenu')\n    clientMenu.addEventListener('hidden.bs.offcanvas', function () {\n        client.commandInput.focus();\n    });\n\n    document.getElementById('btn-menu').addEventListener('click', showMenu);\n    client.on('connected', () => {\n        let el = document.getElementById('menu-connect');\n        let text = document.querySelector('#menu-connect a span');\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\n        el.title = 'Disconnect';\n        el.classList.add('active');\n        text.textContent = 'Disconnect';\n        icon.classList.add('fa-plug-circle-xmark');\n        icon.classList.remove('fa-plug');\n    });\n    client.on('closed', () => {\n        let el = document.getElementById('menu-connect');\n        let text = document.querySelector('#menu-connect a span');\n        let icon = document.querySelector('#menu-connect svg') || document.querySelector('#menu-connect i');\n        el.title = 'Connect';\n        el.classList.remove('active');\n        text.textContent = 'Connect';\n        icon.classList.remove('fa-plug-circle-xmark');\n        icon.classList.add('fa-plug');\n    })\n    client.on('scroll-lock', updateScrollLock);\n    document.querySelector('#menu-connect a').addEventListener('click', e => {\n        if (client.connected)\n            client.close();\n        else {\n            client.connect();\n            closeMenu();\n        }\n    });\n    document.querySelector('#menu-clear a').addEventListener('click', e => {\n        client.clear();\n        closeMenu()\n    });\n    document.querySelector('#menu-lock a').addEventListener('click', e => {\n        client.toggleScrollLock();\n        closeMenu();\n    });\n    document.querySelector('#menu-editor a').addEventListener('click', e => {\n        closeMenu();\n        document.getElementById('btn-adv-editor').click();\n    });\n    document.querySelector('#menu-about a').addEventListener('click', e => {\n        showDialog('about');\n        closeMenu();\n    });\n    document.querySelector('#menu-settings a').addEventListener('click', e => {\n        showDialog('settings');\n        closeMenu();\n    });\n    document.querySelector('#menu-profiles a').addEventListener('click', e => {\n        showDialog('profiles');\n        closeMenu();\n    });\n    document.querySelector('#menu-help a').addEventListener('click', e => {\n        showDialog('help');\n        closeMenu();\n    });\n    document.querySelector('#menu-fullscreen a').addEventListener('click', e => {\n        let doc: any = window.document;\n        let docEl: any = doc.documentElement;\n\n        let requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;\n        let cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;\n        let el = document.getElementById('menu-fullscreen');\n        let icon = document.querySelector('#menu-fullscreen svg') || document.querySelector('#menu-fullscreen i');\n        let text = document.querySelector('#menu-fullscreen a span');\n        if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {\n            el.title = 'Exit fullscreen';\n            text.textContent = 'Exit fullscreen';\n            requestFullScreen.call(docEl);\n            icon.classList.add('fa-minimize');\n            icon.classList.remove('fa-maximize');\n        }\n        else {\n            el.title = 'Enter fullscreen';\n            text.textContent = 'Enter fullscreen';\n            cancelFullScreen.call(doc);\n            icon.classList.add('fa-maximize');\n            icon.classList.remove('fa-minimize');\n        }\n        closeMenu();\n    });\n    document.querySelector('#menu-buttons a').addEventListener('click', e => {\n        toggleButtons();\n        let button = document.querySelector('#menu-buttons') as HTMLElement;\n        if (client.getOption('showButtons')) {\n            button.title = 'Hide buttons';\n            button.classList.add('active');\n            document.querySelector('#menu-buttons a span').textContent = 'Hide buttons';\n        }\n        else {\n            button.title = 'Show buttons';\n            button.classList.remove('active');\n            document.querySelector('#menu-buttons a span').textContent = 'Show buttons';\n        }\n        closeMenu();\n    });\n    document.querySelector('#menu-paste a').addEventListener('click', e => {\n        if (isPasteSupported())\n            pasteText().then(doPasteSpecial);\n        else {\n            document.querySelector('#menu-paste').classList.toggle('active');\n            client.commandInput.focus();\n        }\n        closeMenu();\n    })\n    updateScrollLock();\n\n    let pl = client.plugins.length;\n    let s;\n    let sl;\n    const list = document.querySelector('#clientMenu ul')\n    for (let p = 0; p < pl; p++) {\n        if (!client.plugins[p].menu) continue;\n        if (client.plugins[p].menu.length) {\n            sl = client.plugins[p].menu.length;\n            for (s = 0; s < sl; s++) {\n                let item = client.plugins[p].menu[s];\n                let code;\n                let id = 'menu-' + (item.id || item.name || s).trim().toLowerCase().replace(/ /g, '-');\n                if (item.name === '-')\n                    code = `<li id=\"${id}\"${item.hidden ? ' style=\" display:none;visibility:hiddem\"' : ''}><hr class=\"dropdown-divider\"></li>`;\n                else if (typeof item.action === 'string')\n                    code = `<li id=\"${id}\"${item.hidden ? ' style=\" display:none;visibility:hiddem\"' : ''} class=\"nav-item${item.active ? ' active' : ''}\" title=\"${item.name || ''}\"><a class=\"nav-link\" href=\"#${item.action}\">${item.icon || ''}<span>${item.name || ''}</span></a></li>`;\n                else\n                    code = `<li id=\"${id}\"${item.hidden ? ' style=\" display:none;visibility:hiddem\"' : ''} class=\"nav-item${item.active ? ' active' : ''}\" title=\"${item.name || ''}\"><a class=\"nav-link\" href=\"javascript:void(0)\">${item.icon || ''}<span>${item.name || ''}</span></a></li>`;\n                if (item.exists && list.querySelector(item.exists)) continue;\n                if ('position' in item) {\n                    if (typeof item.position === 'string') {\n                        if (list.querySelector(item.position))\n                            list.querySelector(item.position).insertAdjacentHTML('afterend', code);\n                    }\n                    else if (item.position < 0 || item.position >= 0) {\n                        let pos = item.position;\n                        if (pos >= list.children.length)\n                            pos = list.children.length - 1;\n                        else if (pos < 0)\n                            pos = list.children.length + item.position;\n                        if (pos < 0) pos = 0;\n                        if (pos < list.children.length)\n                            list.children[pos].insertAdjacentHTML('afterend', code);\n                    }\n                    else\n                        list.insertAdjacentHTML('beforeend', code);\n                }\n                else\n                    list.insertAdjacentHTML('beforeend', code);\n                if (item.name === '-') continue;\n                if (typeof item.action === 'function' && document.querySelector(`#${id} a`))\n                    document.querySelector(`#${id} a`).addEventListener('click', e => {\n                        const ie = { client: client, preventDefault: false };\n                        item.action(ie);\n                        if (ie.preventDefault) return;\n                        closeMenu();\n                    });\n            }\n        }\n    }\n    let button = document.querySelector('#menu-buttons') as HTMLElement;\n    if (client.getOption('showButtons')) {\n        button.title = 'Hide buttons';\n        button.classList.add('active');\n        document.querySelector('#menu-buttons a span').textContent = 'Hide buttons';\n    }\n    else {\n        button.title = 'Show buttons';\n        button.classList.remove('active');\n        document.querySelector('#menu-buttons a span').textContent = 'Show buttons';\n    }\n}\n\nfunction updateScrollLock() {\n    let el = document.getElementById('menu-lock');\n    let text = document.querySelector('#menu-lock a span');\n    let icon = document.querySelector('#menu-lock svg') || document.querySelector('#menu-lock i');\n    if (client.scrollLock) {\n        el.title = 'Unlock display';\n        el.classList.add('active');\n        text.textContent = 'Unlock display';\n        icon.classList.add('fa-unlock');\n        icon.classList.remove('fa-lock');\n    }\n    else {\n        el.title = 'Lock display';\n        el.classList.remove('active');\n        text.textContent = 'Lock display';\n        icon.classList.remove('fa-unlock');\n        icon.classList.add('fa-lock');\n    }\n}\n", "import '../css/tinymce.css';\r\nimport { EventEmitter } from '../core/events';\r\nimport { RGBColor } from '../lib/rgbcolor';\r\nimport { insertValue, htmlEncode, getColors, copyText, openFileDialog, readFile, pinkfishToHTML, isPasteSupported, pasteText, pasteType } from '../core/library'\r\nimport { Dialog } from './dialog';\r\n\r\nexport class AdvEditor extends EventEmitter {\r\n    private _element;\r\n    private _simple = true;\r\n    private _colors;\r\n    private _ColorTable;\r\n    private _init = false;\r\n    //private _colorCodes;\r\n    private _colorNames = {\r\n        'No color': 'Default',\r\n        'BLACK': 'Black',\r\n        'RED': 'Maroon',\r\n        'GREEN': 'Green',\r\n        'ORANGE': 'Olive',\r\n        'BLUE': 'Navy',\r\n        'MAGENTA': 'Purple',\r\n        'WHITE': 'Silver',\r\n        'CYAN': 'Teal',\r\n        'BOLD BLACK': 'Grey',\r\n        'BOLD RED': 'Red',\r\n        'BOLD GREEN': 'Lime',\r\n        'YELLOW': 'Yellow',\r\n        'BOLD YELLOW': 'Yellow',\r\n        'BOLD BLUE': 'Blue',\r\n        'BOLD MAGENTA': 'Fuchsia',\r\n        'BOLD CYAN': 'Aqua',\r\n        'BOLD': 'White',\r\n        'BOLD WHITE': 'White',\r\n        'RGB000': 'Black',\r\n        'RGB001': 'Navy Blue',\r\n        'RGB002': 'Dark Blue',\r\n        'RGB003': 'Blue',\r\n        'RGB004': 'Blue',\r\n        'RGB005': 'Blue',\r\n        'RGB010': 'Dark Green',\r\n        'RGB011': 'Deep Sky Blue',\r\n        'RGB012': 'Deep Sky Blue',\r\n        'RGB013': 'Deep Sky Blue',\r\n        'RGB014': 'Cobalt/Dodger Blue',\r\n        'RGB015': 'Dodger Blue',\r\n        'RGB020': 'Green',\r\n        'RGB021': 'Spring Green',\r\n        'RGB022': 'Turquoise',\r\n        'RGB023': 'Deep Sky Blue',\r\n        'RGB024': 'Deep Sky Blue',\r\n        'RGB025': 'Dodger Blue',\r\n        'RGB030': 'Green',\r\n        'RGB031': 'Spring Green',\r\n        'RGB032': 'Dark Cyan',\r\n        'RGB033': 'Light Sea Green',\r\n        'RGB034': 'Deep Sky Blue',\r\n        'RGB035': 'Deep Sky Blue',\r\n        'RGB040': 'Green',\r\n        'RGB041': 'Spring Green',\r\n        'RGB042': 'Spring Green',\r\n        'RGB043': 'Cyan',\r\n        'RGB044': 'Dark Turquoise',\r\n        'RGB045': 'Turquoise',\r\n        'RGB050': 'Green',\r\n        'RGB051': 'Spring Green',\r\n        'RGB052': 'Spring Green',\r\n        'RGB053': 'Medium Spring Green',\r\n        'RGB054': 'Cyan',\r\n        'RGB055': 'Cyan',\r\n        'RGB100': 'Dark Red',\r\n        'RGB101': 'Deep Pink',\r\n        'RGB102': 'Purple',\r\n        'RGB103': 'Purple',\r\n        'RGB104': 'Purple',\r\n        'RGB105': 'Blue Violet',\r\n        'RGB110': 'Orange',\r\n        'RGB111': 'Dark Grey',\r\n        'RGB112': 'Medium Purple',\r\n        'RGB113': 'Slate Blue',\r\n        'RGB114': 'Slate Blue',\r\n        'RGB115': 'Royal Blue',\r\n        'RGB120': 'Chartreuse',\r\n        'RGB121': 'Dark Sea Green',\r\n        'RGB122': 'Pale Turquoise',\r\n        'RGB123': 'Steel Blue',\r\n        'RGB124': 'Steel Blue',\r\n        'RGB125': 'Cornflower Blue',\r\n        'RGB130': 'Chartreuse',\r\n        'RGB131': 'Dark Sea Green',\r\n        'RGB132': 'Cadet Blue',\r\n        'RGB133': 'Cadet Blue',\r\n        'RGB134': 'Sky Blue',\r\n        'RGB135': 'Steel Blue',\r\n        'RGB140': 'Chartreuse',\r\n        'RGB141': 'Pale Green',\r\n        'RGB142': 'Sea Green',\r\n        'RGB143': 'Aquamarine',\r\n        'RGB144': 'Medium Turquoise',\r\n        'RGB145': 'Steel Blue',\r\n        'RGB150': 'Chartreuse',\r\n        'RGB151': 'Sea Green',\r\n        'RGB152': 'Sea Green',\r\n        'RGB153': 'Sea Green',\r\n        'RGB154': 'Aquamarine',\r\n        'RGB155': 'Dark Slate Gray',\r\n        'RGB200': 'Dark Red',\r\n        'RGB201': 'Deep Pink',\r\n        'RGB202': 'Dark Magenta',\r\n        'RGB203': 'Dark Magenta',\r\n        'RGB204': 'Dark Violet',\r\n        'RGB205': 'Purple',\r\n        'RGB210': 'Orange',\r\n        'RGB211': 'Light Pink',\r\n        'RGB212': 'Plum',\r\n        'RGB213': 'Medium Purple',\r\n        'RGB214': 'Medium Purple',\r\n        'RGB215': 'Slate Blue',\r\n        'RGB220': 'Yellow',\r\n        'RGB221': 'Wheat',\r\n        'RGB222': 'Grey',\r\n        'RGB223': 'Light Slate Grey',\r\n        'RGB224': 'Medium Purple',\r\n        'RGB225': 'Light Slate Blue',\r\n        'RGB230': 'Yellow',\r\n        'RGB231': 'Dark Olive Green',\r\n        'RGB232': 'Dark Sea Green',\r\n        'RGB233': 'Light Sky Blue',\r\n        'RGB234': 'Light Sky Blue',\r\n        'RGB235': 'Sky Blue',\r\n        'RGB240': 'Chartreuse',\r\n        'RGB241': 'Dark Olive Green',\r\n        'RGB242': 'Pale Green',\r\n        'RGB243': 'Dark Sea Green',\r\n        'RGB244': 'Dark Slate Gray',\r\n        'RGB245': 'Sky Blue',\r\n        'RGB250': 'Chartreuse',\r\n        'RGB251': 'Light Green',\r\n        'RGB252': 'Light Green',\r\n        'RGB253': 'Pale Green',\r\n        'RGB254': 'Aquamarine',\r\n        'RGB255': 'Dark Slate Gray',\r\n        'RGB300': 'Red',\r\n        'RGB301': 'Deep Pink',\r\n        'RGB302': 'Medium Violet Red',\r\n        'RGB303': 'Magenta',\r\n        'RGB304': 'Dark Violet',\r\n        'RGB305': 'Purple',\r\n        'RGB310': 'Dark Orange',\r\n        'RGB311': 'Indian Red',\r\n        'RGB312': 'Hot Pink',\r\n        'RGB313': 'Medium Orchid',\r\n        'RGB314': 'Medium Orchid',\r\n        'RGB315': 'Medium Purple',\r\n        'RGB320': 'Dark Goldenrod',\r\n        'RGB321': 'Light Salmon',\r\n        'RGB322': 'Rosy Brown',\r\n        'RGB323': 'Grey',\r\n        'RGB324': 'Medium Purple',\r\n        'RGB325': 'Medium Purple',\r\n        'RGB330': 'Gold',\r\n        'RGB331': 'Dark Khaki',\r\n        'RGB332': 'Navajo White',\r\n        'RGB333': 'Grey',\r\n        'RGB334': 'Light Steel Blue',\r\n        'RGB335': 'Light Steel Blue',\r\n        'RGB340': 'Yellow',\r\n        'RGB341': 'Dark Olive Green',\r\n        'RGB342': 'Dark Sea Green',\r\n        'RGB343': 'Dark Sea Green',\r\n        'RGB344': 'Light Cyan',\r\n        'RGB345': 'Light Sky Blue',\r\n        'RGB350': 'Green Yellow',\r\n        'RGB351': 'Dark Olive Green',\r\n        'RGB352': 'Pale Green',\r\n        'RGB353': 'Dark Sea Green',\r\n        'RGB354': 'Dark Sea Green',\r\n        'RGB355': 'Pale Turquoise',\r\n        'RGB400': 'Crimson/Red',\r\n        'RGB401': 'Deep Pink',\r\n        'RGB402': 'Deep Pink',\r\n        'RGB403': 'Magenta',\r\n        'RGB404': 'Magenta',\r\n        'RGB405': 'Magenta',\r\n        'RGB410': 'Dark Orange',\r\n        'RGB411': 'Indian Red',\r\n        'RGB412': 'Hot Pink',\r\n        'RGB413': 'Hot Pink',\r\n        'RGB414': 'Orchid',\r\n        'RGB415': 'Medium Orchid',\r\n        'RGB420': 'Orange',\r\n        'RGB421': 'Light Salmon/Bronze',\r\n        'RGB422': 'Light Pink',\r\n        'RGB423': 'Pink',\r\n        'RGB424': 'Plum',\r\n        'RGB425': 'Violet',\r\n        'RGB430': 'Gold',\r\n        'RGB431': 'Light Goldenrod',\r\n        'RGB432': 'Tan',\r\n        'RGB433': 'Misty Rose',\r\n        'RGB434': 'Thistle',\r\n        'RGB435': 'Plum',\r\n        'RGB440': 'Yellow',\r\n        'RGB441': 'Khaki',\r\n        'RGB442': 'Light Goldenrod',\r\n        'RGB443': 'Light Yellow',\r\n        'RGB444': 'Grey',\r\n        'RGB445': 'Light Steel Blue',\r\n        'RGB450': 'Yellow',\r\n        'RGB451': 'Dark Olive Green',\r\n        'RGB452': 'Dark Olive Green',\r\n        'RGB453': 'Dark Sea Green',\r\n        'RGB454': 'Honeydew',\r\n        'RGB455': 'Light Cyan',\r\n        'RGB500': 'Red',\r\n        'RGB501': 'Deep Pink',\r\n        'RGB502': 'Deep Pink',\r\n        'RGB503': 'Deep Pink',\r\n        'RGB504': 'Magenta',\r\n        'RGB505': 'Magenta',\r\n        'RGB510': 'Orangered',\r\n        'RGB511': 'Indian Red',\r\n        'RGB512': 'Indian Red',\r\n        'RGB513': 'Hot Pink',\r\n        'RGB514': 'Hot Pink',\r\n        'RGB515': 'Medium Orchid',\r\n        'RGB520': 'Dark Orange',\r\n        'RGB521': 'Salmon',\r\n        'RGB522': 'Light Coral',\r\n        'RGB523': 'Pale Violet Red',\r\n        'RGB524': 'Orchid',\r\n        'RGB525': 'Orchid',\r\n        'RGB530': 'Orange',\r\n        'RGB531': 'Sandy Brown',\r\n        'RGB532': 'Light Salmon',\r\n        'RGB533': 'Light Pink',\r\n        'RGB534': 'Pink',\r\n        'RGB535': 'Plum',\r\n        'RGB540': 'Gold',\r\n        'RGB541': 'Light Goldenrod',\r\n        'RGB542': 'Light Goldenrod',\r\n        'RGB543': 'Navajo White',\r\n        'RGB544': 'Misty Rose',\r\n        'RGB545': 'Thistle',\r\n        'RGB550': 'Yellow',\r\n        'RGB551': 'Light Goldenrod',\r\n        'RGB552': 'Khaki',\r\n        'RGB553': 'Wheat',\r\n        'RGB554': 'Corn Silk',\r\n        'RGB555': 'White',\r\n        'mono00': 'Grey 3',\r\n        'mono01': 'Grey 7',\r\n        'mono02': 'Grey 11',\r\n        'mono03': 'Grey 15',\r\n        'mono04': 'Grey 19',\r\n        'mono05': 'Grey 23',\r\n        'mono06': 'Grey 27',\r\n        'mono07': 'Grey 30',\r\n        'mono08': 'Grey 35',\r\n        'mono09': 'Grey 39',\r\n        'mono10': 'Grey 32',\r\n        'mono11': 'Grey 46',\r\n        'mono12': 'Grey 50',\r\n        'mono13': 'Grey 54',\r\n        'mono14': 'Grey 58',\r\n        'mono15': 'Grey 62',\r\n        'mono16': 'Grey 66',\r\n        'mono17': 'Grey 70',\r\n        'mono18': 'Grey 74',\r\n        'mono19': 'Grey 78',\r\n        'mono20': 'Grey 82',\r\n        'mono21': 'Grey 85',\r\n        'mono22': 'Grey 89',\r\n        'mono23': 'Grey 93'\r\n    };\r\n\r\n    private _colorDialog: Dialog;\r\n\r\n    constructor(element: string | JQuery | HTMLElement, enabledAdvanced?: boolean) {\r\n        super();\r\n        if (!element)\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        if (typeof element === 'string') {\r\n            this._element = document.querySelector(element);\r\n            if (!this._element)\r\n                throw new Error('Invalid selector for AdvEditor.');\r\n        }\r\n        else if (element instanceof $)\r\n            this._element = element[0];\r\n        else if (element instanceof HTMLElement)\r\n            this._element = element;\r\n        else\r\n            throw new Error('AdvEditor must be a selector, element or jquery object');\r\n        this.simple = !enabledAdvanced;\r\n    }\r\n\r\n    get id() {\r\n        if (this._element) return this._element.id;\r\n        return '';\r\n    }\r\n\r\n    get element(): HTMLElement {\r\n        return this._element;\r\n    }\r\n\r\n    get simple() { return this._simple; }\r\n    set simple(value) {\r\n        if (value === this._simple) return;\r\n        this._simple = value;\r\n        if (TINYMCE && !this.tinymceExist) return;\r\n        //was disabled\r\n        if (value)\r\n            this.remove();\r\n        else\r\n            this.initialize();\r\n    }\r\n    public clear() {\r\n        if (TINYMCE && !this.isSimple)\r\n            tinymce.activeEditor.setContent('');\r\n        else\r\n            this._element.value = '';\r\n    }\r\n    public get value() {\r\n        if (!this.isSimple)\r\n            return this.getFormattedText().replace(/(?:\\r)/g, '')\r\n        return this._element.value;\r\n    }\r\n    public set value(value) {\r\n        if (this.isSimple)\r\n            this._element.value = value;\r\n        else\r\n            tinymce.activeEditor.setContent(value);\r\n    }\r\n\r\n    public insert(value) {\r\n        if (!this.isSimple) {\r\n            value = htmlEncode(value);\r\n            value = value.replace(/ /g, '&nbsp;');\r\n            value = value.replace(/\\t/g, '&nbsp;&nbsp;&nbsp;');\r\n            value = value.replace(/(?:\\r\\n|\\r|\\n)/g, '<br/>');\r\n            let content = this.getText();\r\n            if (content === '\\n') {\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.setContent(value);\r\n                });\r\n            }\r\n            else {\r\n                if (!content.endsWith('\\n'))\r\n                    value = '<br>' + value;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    tinymce.activeEditor.dom.add(tinymce.activeEditor.getBody(), 'span', {}, value);\r\n                });\r\n            }\r\n\r\n        }\r\n        else\r\n            insertValue(this._element, value); {\r\n        }\r\n\r\n    }\r\n\r\n    get tinymceExist() {\r\n        return TINYMCE && typeof (tinymce) !== 'undefined';\r\n    }\r\n\r\n    get isSimple(): boolean {\r\n        return this._simple || !this.tinymceExist;\r\n    }\r\n\r\n    private _loadColors() {\r\n        let _dColors = getColors();\r\n        let c, color, r, g, b, idx, _bold = [], bl;\r\n        this._ColorTable = [];\r\n        this._colors = {};\r\n        let clientColors = client.getOption('colors') || [];\r\n        let cNames = ['BLACK', 'RED', 'GREEN', 'ORANGE', 'BLUE', 'MAGENTA', 'CYAN', 'WHITE'];\r\n        for (c = 0, bl = cNames.length; c < bl; c++) {\r\n            color = new RGBColor(clientColors[c] || _dColors[c]).toHex().substr(1).toUpperCase();\r\n            this._colors[color] = cNames[c];\r\n            this._ColorTable.push(color, cNames[c]);\r\n        }\r\n\r\n        color = new RGBColor(clientColors[8] || _dColors[8]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'mono11';\r\n        this._ColorTable.push(color, 'BOLD BLACK');\r\n        _bold.push(color);\r\n        cNames[3] = 'YELLOW';\r\n        //cNames = ['BOLD BLACK', 'BOLD RED', 'BOLD GREEN', 'BOLD YELLOW', 'BOLD BLUE', 'BOLD MAGENTA', 'BOLD CYAN'];\r\n        for (c = 1, bl = cNames.length - 1; c < bl; c++) {\r\n            color = new RGBColor(clientColors[c + 8] || _dColors[c + 8]).toHex().substr(1).toUpperCase();\r\n            this._colors[color] = 'BOLD%^%^' + cNames[c];\r\n            this._ColorTable.push(color, 'BOLD ' + cNames[c]);\r\n            _bold.push(color);\r\n            if (c === 3) {\r\n                color = new RGBColor(clientColors[11] || _dColors[11]).toHex().substr(1).toUpperCase();\r\n                this._colors[color] = 'YELLOW';\r\n                this._ColorTable.push(color, 'YELLOW');\r\n                _bold.push(color);\r\n            }\r\n        }\r\n        color = new RGBColor(clientColors[15] || _dColors[15]).toHex().substr(1).toUpperCase();\r\n        this._colors[color] = 'BOLD%^%^WHITE';\r\n        this._ColorTable.push(color, 'BOLD WHITE');\r\n\r\n\r\n        for (r = 0; r < 6; r++) {\r\n            for (g = 0; g < 6; g++) {\r\n                for (b = 0; b < 6; b++) {\r\n                    idx = `RGB${r}${g}${b}`;\r\n                    color = '';\r\n                    c = 0;\r\n                    c = r * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = g * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    c = 0;\r\n                    c = b * 40 + 55;\r\n                    if (c < 16)\r\n                        color += '0';\r\n                    color += c.toString(16);\r\n                    color = color.toUpperCase();\r\n                    //_ColorTable.push(color);\r\n                    //_ColorTable.push(idx);\r\n                    if (!this._colors[color])\r\n                        this._colors[color] = idx;\r\n                    this._colorList.push({ color: idx, hex: '#' + color, rgb: { r: r * 40 + 55, g: g * 40 + 55, b: b * 40 + 55 } });\r\n                }\r\n            }\r\n        }\r\n\r\n        for (r = 232; r <= 255; r++) {\r\n            g = (r - 232) * 10 + 8;\r\n            if (g < 16)\r\n                g = '0' + g.toString(16).toUpperCase();\r\n            else\r\n                g = g.toString(16).toUpperCase();\r\n            g = g + g + g;\r\n            //_ColorTable.push(g);\r\n            if (r < 242) {\r\n                //_ColorTable.push('mono0' + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono0' + (r - 232);\r\n            }\r\n            else {\r\n                //_ColorTable.push('mono' + (r - 232));\r\n                if (!this._colors[g])\r\n                    this._colors[g] = 'mono' + (r - 232);\r\n            }\r\n        }\r\n        //this._colorCodes = invert(this._colors);\r\n        for (b = 0, bl = _bold.length; b < bl; b++) {\r\n            this._colors['B' + _bold[b]] = this._colors[this._nearestHex('#' + _bold[b]).substr(1)].toUpperCase();\r\n        }\r\n        this._colors['BFFFFFF'] = 'RGB555';\r\n        tinymce.activeEditor.options.set('color_map', this._ColorTable);\r\n    }\r\n\r\n    private _initPlugins() {\r\n        if (!TINYMCE) return\r\n        const _editor = this;\r\n        tinymce.PluginManager.add('pinkfishtextcolor', function (editor, url) {\r\n            type ColorFormat = 'forecolor' | 'hilitecolor';\r\n\r\n            const fallbackColor = '#000000';\r\n            const _colors = ['000000', 'BLACK', '800000', 'RED', '008000', 'GREEN', '808000', 'ORANGE', '0000EE', 'BLUE', '800080', 'MAGENTA', '008080', 'CYAN', 'BBBBBB', 'WHITE', '808080', 'BOLD BLACK', 'FF0000', 'BOLD RED', '00FF00', 'BOLD GREEN', 'FFFF00', 'YELLOW', '5C5CFF', 'BOLD BLUE', 'FF00FF', 'BOLD MAGENTA', '00FFFF', 'BOLD CYAN', 'FFFFFF', 'BOLD WHITE'];\r\n\r\n            let _lastButton;\r\n\r\n            interface Cell<T> {\r\n                get: () => T;\r\n                set: (value: T) => void;\r\n            }\r\n\r\n            const Cell = <T>(initial: T): Cell<T> => {\r\n                let value = initial;\r\n\r\n                const get = () => {\r\n                    return value;\r\n                };\r\n\r\n                const set = (v: T) => {\r\n                    value = v;\r\n                };\r\n\r\n                return {\r\n                    get,\r\n                    set\r\n                };\r\n            };\r\n\r\n            let _forecolor = Cell(fallbackColor);\r\n            let _backcolor = Cell(fallbackColor);\r\n\r\n            const getCurrentColor = (editor, format: ColorFormat) => {\r\n                let color: string | undefined;\r\n\r\n                editor.dom.getParents(editor.selection.getStart(), (elm) => {\r\n                    let value;\r\n\r\n                    if ((value = elm.style[format === 'forecolor' ? 'color' : 'background-color'])) {\r\n                        color = color ? color : value;\r\n                    }\r\n                });\r\n\r\n                return color;\r\n            };\r\n\r\n            const applyFormat = (editor, format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.apply(format, { value });\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const removeFormat = (editor, format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    editor.nodeChanged();\r\n                });\r\n            };\r\n\r\n            const registerCommands = (editor) => {\r\n                editor.addCommand('mceApplyPinkfishcolor', (format, value) => {\r\n                    applyFormat(editor, format, value);\r\n                });\r\n\r\n                editor.addCommand('mceRemovePinkfishcolor', (format) => {\r\n                    removeFormat(editor, format);\r\n                });\r\n\r\n                editor.addCommand('mceSetPinkfishcolor', (name, color) => {\r\n                    if (_lastButton) {\r\n                        setIconColor(_lastButton, name === 'forecolor' ? 'pinkfishforecolor' : name, color);\r\n                        (name === 'forecolor' ? _forecolor : _backcolor).set(color);\r\n                    }\r\n                });\r\n            };\r\n\r\n            const getAdditionalColors = (hasCustom: boolean) => {\r\n                const type: 'choiceitem' = 'choiceitem';\r\n                const remove = {\r\n                    type,\r\n                    text: 'Remove color',\r\n                    icon: 'color-swatch-remove-color',\r\n                    value: 'remove'\r\n                };\r\n                const custom = {\r\n                    type,\r\n                    text: 'Custom color',\r\n                    icon: 'color-picker',\r\n                    value: 'custom'\r\n                };\r\n                return hasCustom ? [\r\n                    remove,\r\n                    custom\r\n                ] : [remove];\r\n            };\r\n\r\n            const applyColor = (editor, format, value, onChoice: (v: string) => void) => {\r\n                if (value === 'custom') {\r\n                    _editor._openColorDialog(format, '');\r\n                } else if (value === 'remove') {\r\n                    onChoice('');\r\n                    editor.execCommand('mceRemovePinkfishcolor', format);\r\n                } else {\r\n                    onChoice(value);\r\n                    editor.execCommand('mceApplyPinkfishcolor', format, value);\r\n                }\r\n            };\r\n\r\n            const mapColors = (colorMap: string[]) => {\r\n                const colors = [];\r\n\r\n                for (let i = 0; i < colorMap.length; i += 2) {\r\n                    colors.push({\r\n                        text: colorMap[i + 1],\r\n                        value: '#' + colorMap[i],\r\n                        type: 'choiceitem'\r\n                    });\r\n                }\r\n\r\n                return colors;\r\n            }\r\n\r\n            const getColors = (colors, hasCustom: boolean) => mapColors(_colors).concat(getAdditionalColors(hasCustom));\r\n\r\n            const getFetch = (colors, hasCustom: boolean) => (callback) => {\r\n                callback(getColors(colors, hasCustom));\r\n            };\r\n\r\n            const setIconColor = (splitButtonApi, name: string, newColor: string) => {\r\n                const id = name === 'pinkfishforecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\r\n                splitButtonApi.setIconFill(id, newColor);\r\n            };\r\n\r\n            const registerTextColorButton = (editor, name: string, format: ColorFormat, tooltip: string, lastColor) => {\r\n                editor.ui.registry.addSplitButton(name, {\r\n                    tooltip,\r\n                    presets: 'color',\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    select: (value) => {\r\n                        const optCurrentRgb = new RGBColor(getCurrentColor(editor, format) || '').toHex();\r\n                        return optCurrentRgb.toLowerCase() === value.toLowerCase();\r\n                    },\r\n                    columns: 5,\r\n                    fetch: getFetch(_colors, true),\r\n                    onAction: (_splitButtonApi) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, lastColor.get(), () => { });\r\n                    },\r\n                    onItemAction: (_splitButtonApi, value) => {\r\n                        _lastButton = _splitButtonApi;\r\n                        applyColor(editor, format, value, (newColor) => {\r\n                            lastColor.set(newColor);\r\n                            editor.fire('TextColorChange', {\r\n                                name,\r\n                                color: newColor\r\n                            });\r\n                        });\r\n                    },\r\n                    onSetup: (splitButtonApi) => {\r\n                        setIconColor(splitButtonApi, name, lastColor.get());\r\n\r\n                        const handler = (e) => {\r\n                            if (e.name === name) {\r\n                                setIconColor(splitButtonApi, e.name, e.color);\r\n                            }\r\n                        };\r\n\r\n                        editor.on('TextColorChange', handler);\r\n\r\n                        return () => {\r\n                            editor.off('TextColorChange', handler);\r\n                        };\r\n                    }\r\n                });\r\n            };\r\n\r\n            const registerTextColorMenuItem = (editor, name: string, format: ColorFormat, text: string) => {\r\n                editor.ui.registry.addNestedMenuItem(name, {\r\n                    text,\r\n                    icon: name === 'pinkfishforecolor' ? 'text-color' : 'highlight-bg-color',\r\n                    getSubmenuItems: () => [\r\n                        {\r\n                            type: 'fancymenuitem',\r\n                            fancytype: 'colorswatch',\r\n                            onAction: (data) => {\r\n                                applyColor(editor, format, data.value, () => { });\r\n                            }\r\n                        }\r\n                    ]\r\n                });\r\n            };\r\n\r\n            registerCommands(editor);\r\n            registerTextColorButton(editor, 'pinkfishforecolor', 'forecolor', 'Text color', _forecolor);\r\n            registerTextColorButton(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color', _backcolor);\r\n\r\n            registerTextColorMenuItem(editor, 'pinkfishforecolor', 'forecolor', 'Text color');\r\n            registerTextColorMenuItem(editor, 'pinkfishbackcolor', 'hilitecolor', 'Background color');\r\n        });\r\n        tinymce.PluginManager.add('pinkfish', function (editor) {\r\n\r\n            editor.addCommand('mceApplyFormat', (format, value) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor._clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    if (value)\r\n                        editor.formatter.apply(format, { value: value });\r\n                    else\r\n                        editor.formatter.apply(format);\r\n                    _editor._addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            editor.addCommand('mceRemoveFormat', (format) => {\r\n                editor.undoManager.transact(() => {\r\n                    editor.focus();\r\n                    _editor._clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.formatter.remove(format, { value: null }, null, true);\r\n                    _editor._addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.nodeChanged();\r\n                });\r\n            });\r\n\r\n            function buttonPostRender(buttonApi, format) {\r\n                editor.on('init', () => {\r\n                    editor.formatter.formatChanged(format, function (state) {\r\n                        buttonApi.setActive(state);\r\n                    });\r\n                });\r\n            }\r\n\r\n            function toggleFormat(format) {\r\n                if (!format || typeof format !== 'string') format = this.settings.format;\r\n                tinymce.activeEditor.undoManager.transact(() => {\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).removeClass('animate');\r\n                    this.clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    editor.execCommand('mceToggleFormat', false, format);\r\n                    this.addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    $('#tinymce', tinymce.activeEditor.getDoc()).addClass('animate');\r\n                });\r\n            }\r\n\r\n\r\n            editor.ui.registry.addIcon('overline', '<i class=\"mce-i-overline\"></i>');\r\n            editor.ui.registry.addIcon('dblunderline', '<i class=\"mce-i-dblunderline\"></i>');\r\n            editor.ui.registry.addIcon('flash', '<i class=\"mce-i-flash\"></i>');\r\n            editor.ui.registry.addIcon('reverse', '<i class=\"mce-i-reverse\"></i>');\r\n            if (isPasteSupported())\r\n                editor.ui.registry.addIcon('pasteformatted', '<i class=\"mce-i-pasteformatted\"></i>');\r\n            editor.ui.registry.addIcon('copyformatted', '<i class=\"mce-i-copyformatted\"></i>');\r\n\r\n            editor.ui.registry.addSplitButton('send', {\r\n                icon: 'send',\r\n                tooltip: 'Send to mud',\r\n                onAction: () => {\r\n                    client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                    if (client.getOption('editorClearOnSend'))\r\n                        tinymce.activeEditor.setContent('');\r\n                    if (client.getOption('editorCloseOnSend'))\r\n                        _editor.emit('close');\r\n                },\r\n                onItemAction: (api, value) => {\r\n                    switch (value) {\r\n                        case 'formatted':\r\n                            client.sendCommand(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                        case 'text':\r\n                            client.sendCommand(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                        case 'formattednoecho':\r\n                            client.sendBackground(_editor.getFormattedText().replace(/(?:\\r)/g, ''), true);\r\n                            break;\r\n                        case 'textnoecho':\r\n                            client.sendBackground(_editor.getText().replace(/(?:\\r)/g, ''), true);\r\n                            break;\r\n                        case 'formattedverbatim':\r\n                            client.send(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                        case 'textverbatim':\r\n                            client.send(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                        case 'rawformatted':\r\n                            client.sendRaw(_editor.getFormattedText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                        case 'rawtext':\r\n                            client.sendRaw(_editor.getText().replace(/(?:\\r)/g, ''));\r\n                            break;\r\n                    }\r\n                    if (client.getOption('editorClearOnSend'))\r\n                        tinymce.activeEditor.setContent('');\r\n                    if (client.getOption('editorCloseOnSend'))\r\n                        _editor.emit('close');\r\n                },\r\n                fetch: callback => {\r\n                    callback([\r\n                        {\r\n                            text: 'Formatted as commands',\r\n                            value: 'formatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands',\r\n                            value: 'text',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted as commands (No echo)',\r\n                            value: 'formattednoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text as commands (No echo)',\r\n                            value: 'textnoecho',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Formatted verbatim (No echo)',\r\n                            value: 'formattedverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Text verbatim (No echo)',\r\n                            value: 'textverbatim',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw formatted (No echo)',\r\n                            value: 'rawformatted',\r\n                            type: 'choiceitem'\r\n                        },\r\n                        {\r\n                            text: 'Raw text (No echo)',\r\n                            value: 'rawtext',\r\n                            type: 'choiceitem'\r\n                        }\r\n                    ]);\r\n                }\r\n            });\r\n            editor.ui.registry.addButton('append', {\r\n                icon: 'browse',\r\n                tooltip: 'Append file...',\r\n                onAction: () => _editor._appendFile()\r\n            });\r\n            editor.ui.registry.addButton('clear', {\r\n                icon: 'remove',\r\n                tooltip: 'Clear',\r\n                onAction: () => _editor.clear()\r\n            });\r\n            if (isPasteSupported()) {\r\n                editor.ui.registry.addButton('pastecustom', {\r\n                    icon: 'paste',\r\n                    tooltip: 'Paste',\r\n                    onAction: buttonApi => {\r\n                        pasteType('text/html', 'text/plain').then(text => {\r\n                            _editor.insertFormatted(text || '');\r\n                        }).catch(err => {\r\n                            if (client.enableDebug)\r\n                                client.debug(err);\r\n                            if (err.message && err.message === 'Permission not granted!')\r\n                                alert('Paste permission not granted.');\r\n                            else\r\n                                alert('Paste not supported.');\r\n                        });\r\n                    }\r\n                });\r\n                editor.ui.registry.addButton('pasteformatted', {\r\n                    icon: 'pasteformatted',\r\n                    tooltip: 'Paste formatted',\r\n                    onAction: buttonApi => {\r\n                        pasteText().then(text => {\r\n                            _editor.insertFormatted(text || '');\r\n                        }).catch(err => {\r\n                            if (client.enableDebug)\r\n                                client.debug(err);\r\n                            if (err.message && err.message === 'Permission not granted!')\r\n                                alert('Paste permission not granted.');\r\n                            else\r\n                                alert('Paste not supported.');\r\n                        });\r\n                    }\r\n                });\r\n                editor.ui.registry.addButton('pasteastext', {\r\n                    icon: 'paste-text',\r\n                    tooltip: 'Paste as text',\r\n                    onAction: buttonApi => {\r\n                        pasteText().then(text => {\r\n                            tinymce.activeEditor.execCommand('mceInsertContent', false, (text || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                        }).catch(err => {\r\n                            if (client.enableDebug)\r\n                                client.debug(err);\r\n                            if (err.message && err.message === 'Permission not granted!')\r\n                                alert('Paste permission not granted.');\r\n                            else\r\n                                alert('Paste not supported.');\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            editor.ui.registry.addButton('copyformatted', {\r\n                icon: 'copyformatted',\r\n                tooltip: 'Copy formatted',\r\n                onAction: buttonApi => copyText(_editor.getFormattedSelection().replace(/(?:\\r)/g, ''))\r\n            });\r\n\r\n            editor.ui.registry.addToggleButton('overline', {\r\n                icon: 'overline',\r\n                tooltip: 'Overline',\r\n                format: 'overline',\r\n                onAction: buttonApi => toggleFormat('overline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'overline')\r\n            });\r\n            editor.ui.registry.addToggleButton('dblunderline', {\r\n                icon: 'dblunderline',\r\n                tooltip: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onAction: buttonApi => toggleFormat('dblunderline'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'dblunderline')\r\n            });\r\n            editor.ui.registry.addToggleButton('flash', {\r\n                tooltip: 'Flash',\r\n                format: 'flash',\r\n                icon: 'flash',\r\n                onAction: buttonApi => toggleFormat('flash'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'flash')\r\n            });\r\n            editor.ui.registry.addToggleButton('reverse', {\r\n                icon: 'reverse',\r\n                tooltip: 'Reverse',\r\n                format: 'reverse',\r\n                onAction: buttonApi => toggleFormat('reverse'),\r\n                onSetup: buttonApi => buttonPostRender(buttonApi, 'reverse')\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('style', {\r\n                text: 'Style',\r\n                menu: [\r\n                    {\r\n                        image: 'overline',\r\n                        text: 'Overline',\r\n                        format: 'overline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }, {\r\n                        image: 'dblunderline',\r\n                        text: 'Double Underline',\r\n                        format: 'dblunderline',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        text: 'Flash',\r\n                        format: 'flash',\r\n                        image: 'flash',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    },\r\n                    {\r\n                        image: 'reverse',\r\n                        text: 'Reverse',\r\n                        format: 'reverse',\r\n                        onclick: toggleFormat,\r\n                        onpostrender: buttonPostRender\r\n                    }\r\n                ]\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('overline', {\r\n                image: 'overline',\r\n                text: 'Overline',\r\n                format: 'overline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('dblunderline', {\r\n                image: 'dblunderline',\r\n                text: 'Double Underline',\r\n                format: 'dblunderline',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.ui.registry.addMenuItem('flash', {\r\n                text: 'Flash',\r\n                format: 'flash',\r\n                image: 'flash',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n            editor.ui.registry.addMenuItem('reverse', {\r\n                image: 'reverse',\r\n                text: 'Reverse',\r\n                format: 'reverse',\r\n                onclick: toggleFormat,\r\n                onpostrender: buttonPostRender\r\n            });\r\n\r\n            editor.on('Change', () => {\r\n                _editor._addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n            });\r\n            editor.addShortcut('ctrl+s', 'Strikethrough', () => {\r\n                toggleFormat('strikethrough');\r\n            });\r\n            editor.addShortcut('ctrl+o', 'Overline', () => {\r\n                toggleFormat('overline');\r\n            });\r\n            editor.addShortcut('ctrl+d', 'Double Underline', () => {\r\n                toggleFormat('dblunderline');\r\n            });\r\n            editor.addShortcut('ctrl+f', 'Flash', () => {\r\n                toggleFormat('flash');\r\n            });\r\n            editor.addShortcut('ctrl+r', 'Reverse', () => {\r\n                toggleFormat('reverse');\r\n            });\r\n        });\r\n    }\r\n\r\n    private _clearReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (!$(this).data('reverse'))\r\n                    return;\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                let back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    fore = $(this).parent().css('color');\r\n                    back = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'black')\r\n                    back = '';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                if ($(this).children().length)\r\n                    this.clearReverse($(this).children(), true);\r\n            }\r\n        );\r\n    }\r\n\r\n    private _addReverse(els, c?) {\r\n        els.each(\r\n            function () {\r\n                if (c && $(this).hasClass('reverse'))\r\n                    return;\r\n                let back, fore;\r\n                if (c) {\r\n                    back = $(this).css('color');\r\n                    fore = $(this).css('background-color');\r\n                }\r\n                else {\r\n                    back = $(this).parent().css('color');\r\n                    fore = $(this).parent().css('background-color');\r\n                }\r\n                if (back === 'rgba(0, 0, 0, 0)')\r\n                    back = 'black';\r\n                if (fore === 'rgba(0, 0, 0, 0)')\r\n                    fore = 'black';\r\n                if ($(this).children().length) {\r\n                    this.clearReverse($(this).children(), true);\r\n                    this.addReverse($(this).children(), true);\r\n                }\r\n                $(this).css('color', fore);\r\n                $(this).css('background-color', back);\r\n                $(this).data('reverse', true);\r\n\r\n            }\r\n        );\r\n    }\r\n\r\n    private _colorCell(color, idx) {\r\n        let cell = '<td class=\"mce-grid-cell' + (color === 'transparent' ? ' mce-colorbtn-trans' : '') + '\">';\r\n        cell += '<div id=\"' + idx + '\"';\r\n        cell += ' data-mce-color=\"' + color + '\"';\r\n        cell += ' role=\"option\"';\r\n        cell += ' tabIndex=\"-1\"';\r\n        cell += ' style=\"background-color: ' + (color === 'transparent' ? color : '#' + color) + '\"';\r\n        if (this._colorNames[idx])\r\n            cell += ' title=\"' + idx + ', ' + this._colorNames[idx] + '\">';\r\n        else\r\n            cell += ' title=\"' + idx + '\">';\r\n        if (color === 'transparent') cell += '&#215;';\r\n        cell += '</div>';\r\n        cell += '</td>';\r\n        return cell;\r\n    }\r\n\r\n    private _openColorDialog(type, color) {\r\n        if (!this._colorDialog) {\r\n            this._colorDialog = new Dialog({ noFooter: true, title: '<i class=\"fas fa-palette\"></i> Pick color', center: true, resizable: false, moveable: false, maximizable: false, width: 380, height: 340 });\r\n            this._colorDialog.body.style.alignItems = 'center';\r\n            this._colorDialog.body.style.display = 'flex';\r\n            let c;\r\n            let cl;\r\n            let r;\r\n            let g;\r\n            let b;\r\n            let idx;\r\n            let html = '<table style=\"border-spacing: 0;margin : auto !important;\" class=\"mce-grid mce-grid-border mce-colorbutton-grid\" role=\"list\" cellspacing=\"0\"><tbody><tr>';\r\n            for (c = 0, cl = this._ColorTable.length; c < cl; c += 2) {\r\n                if (this._ColorTable[c + 1] === 'BOLD YELLOW') continue;\r\n                html += this._colorCell(this._ColorTable[c], this._ColorTable[c + 1]);\r\n                if (c / 2 % 6 === 5 || this._ColorTable[c + 1] === 'YELLOW')\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n            }\r\n            html += '<td class=\"mce-grid-cell\"></td>';\r\n            html += this._colorCell('transparent', 'No color');\r\n            html += '</tr><tr><td></td></tr>';\r\n            let html2 = '';\r\n            for (r = 0; r < 6; r++) {\r\n                if (g < 3)\r\n                    html += '<tr>';\r\n                else\r\n                    html2 += '<tr>';\r\n                for (g = 0; g < 6; g++) {\r\n                    for (b = 0; b < 6; b++) {\r\n                        idx = `RGB${r}${g}${b}`;\r\n                        color = '';\r\n                        c = 0;\r\n                        c = r * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = g * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        c = 0;\r\n                        c = b * 40 + 55;\r\n                        if (c < 16)\r\n                            color += '0';\r\n                        color += c.toString(16);\r\n                        color = color.toUpperCase();\r\n                        if (g < 3)\r\n                            html += this._colorCell(color, idx);\r\n                        else\r\n                            html2 += this._colorCell(color, idx);\r\n                    }\r\n                    if (g === 2)\r\n                        html += '</tr>';\r\n                    else if (g < 3)\r\n                        html += '<td class=\"mce-grid-cell\"></td>';\r\n                    else if (g < 5)\r\n                        html2 += '<td class=\"mce-grid-cell\"></td>';\r\n                }\r\n                if (g < 3)\r\n                    html += '</tr>';\r\n                else\r\n                    html2 += '</tr>';\r\n            }\r\n            html += html2;\r\n            html += '<tr><td></td></tr><tr>';\r\n            for (r = 232; r <= 255; r++) {\r\n                g = (r - 232) * 10 + 8;\r\n                if (g < 16)\r\n                    g = '0' + g.toString(16).toUpperCase();\r\n                else\r\n                    g = g.toString(16).toUpperCase();\r\n                g = g + g + g;\r\n                html += this._colorCell(g, color);\r\n                if (r === 237 || r === 249)\r\n                    html += '<td class=\"mce-grid-cell\"></td>';\r\n                if (r === 243)\r\n                    html += '</tr><tr>';\r\n            }\r\n            html += '</tr></tbody></table>';\r\n            html += `<style>.mce-colorbtn-trans div {line-height: 14px;overflow: hidden;}.mce-grid td.mce-grid-cell div{border:1px solid #c5c5c5;width:15px;height:15px;margin:0;cursor:pointer}.mce-grid td.mce-grid-cell div:focus{border-color:#91bbe9}.mce-grid td.mce-grid-cell div[disabled]{cursor:not-allowed}.mce-grid{border-spacing:2px;border-collapse:separate}.mce-grid a{display:block;border:1px solid transparent}.mce-grid a:hover,.mce-grid a:focus{border-color:#91bbe9}.mce-grid-border{margin:0 4px 0 4px}.mce-grid-border a{border-color:#c5c5c5;width:13px;height:13px}.mce-grid-border a:hover,.mce-grid-border a.mce-active{border-color:#91bbe9;background:#bdd6f2}</style>`;\r\n            this._colorDialog.body.innerHTML = html;\r\n            let cells = this._colorDialog.body.querySelectorAll('div');\r\n            for (c = 0, cl = cells.length; c < cl; c++)\r\n                cells[c].addEventListener('click', e => {\r\n                    color = (e.currentTarget as HTMLElement).dataset.mceColor;\r\n                    if (color === 'transparent')\r\n                        tinymce.activeEditor.execCommand('mceRemoveFormat', this._colorDialog.dialog.dataset.type);\r\n                    else\r\n                        tinymce.activeEditor.execCommand('mceApplyFormat', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    tinymce.activeEditor.execCommand('mceSetTextcolor', this._colorDialog.dialog.dataset.type, '#' + color);\r\n                    this._colorDialog.close();\r\n                });\r\n        }\r\n        this._colorDialog.dialog.dataset.type = type;\r\n        this._colorDialog.showModal();\r\n    }\r\n\r\n    private _appendFile() {\r\n        openFileDialog('Append file(s)', true).then(files => {\r\n            for (let f = 0, fl = files.length; f < fl; f++)\r\n                readFile(files[f]).then((contents: any) => {\r\n                    this.insert(contents);\r\n                }).catch(client.error);\r\n        }).catch(() => { });\r\n    }\r\n\r\n    public insertFormatted(text) {\r\n        if (this.isSimple)\r\n            insertValue(this._element, text);\r\n        else\r\n            tinymce.activeEditor.execCommand('insertHTML', false, pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'));\r\n    }\r\n\r\n    public setFormatted(text) {\r\n        if (this.isSimple)\r\n            this._element.value = text;\r\n        else {\r\n            tinymce.activeEditor.getBody().innerHTML = pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>');\r\n            //tinymce.activeEditor.setContent(pinkfishToHTML(text).replace(/(\\r\\n|\\r|\\n)/g, '<br/>'), { format: 'html' });\r\n        }\r\n    }\r\n\r\n    private _buildHTMLStack(els) {\r\n        let tag, $el, t, tl;\r\n        let stack = [];\r\n        let tags;\r\n        for (let e = 0, el = els.length; e < el; e++) {\r\n            $el = $(els[e]);\r\n            tag = $el.prop('tagName');\r\n            if (tag === 'EM' || tag === 'I')\r\n                tag = 'ITALIC';\r\n            else if (tag === 'STRONG' || tag === 'B')\r\n                tag = 'BOLD';\r\n            if (!tag)\r\n                stack.push('\"' + $el.text() + '\"');\r\n            else if (tag === 'SPAN') {\r\n                tags = [];\r\n                if (els[e].className != '') {\r\n                    tag = els[e].className.toUpperCase().split(/\\s+/g);\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t] === 'NOFLASH')\r\n                            tags.push('FLASH');\r\n                        else if (tag[t].length > 0)\r\n                            tags.push(tag[t]);\r\n                    }\r\n                }\r\n                if ($el.css('text-decoration') === 'line-through')\r\n                    tags.push('STRIKEOUT');\r\n                if ($el.css('text-decoration') === 'underline')\r\n                    tags.push('UNDERLINE');\r\n                if ($el.data('mce-style')) {\r\n                    tag = $el.data('mce-style').toUpperCase().split(';');\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].endsWith('INHERIT') || tag[t].endsWith('BLACK'))\r\n                            continue;\r\n                        tag[t] = tag[t].trim();\r\n                        tag[t] = tag[t].replace('BACKGROUND:', 'BACKGROUND-COLOR:');\r\n                        if (tag[t].length > 0)\r\n                            tags.push(tag[t]);\r\n                    }\r\n                }\r\n                else if ($el.css('color') || $el.css('background-color') || $el.css('background')) {\r\n                    tag = [];\r\n                    if ($el.css('color'))\r\n                        tag.push('COLOR: ' + new RGBColor($el.css('color')).toHex().toUpperCase());\r\n                    if ($el.css('background-color'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background-color')).toHex().toUpperCase());\r\n                    if ($el.css('background'))\r\n                        tag.push('BACKGROUND-COLOR: ' + new RGBColor($el.css('background')).toHex().toUpperCase());\r\n                    tl = tag.length;\r\n                    for (t = 0; t < tl; t++) {\r\n                        if (tag[t].length > 0)\r\n                            tags.push(tag[t].trim());\r\n                    }\r\n                }\r\n                tl = tags.length;\r\n                for (t = 0; t < tl; t++) {\r\n                    if (!tags[t].length) continue;\r\n                    stack.push(tags[t].trim());\r\n                }\r\n                stack = stack.concat(this._buildHTMLStack($el.contents()));\r\n                for (t = tl - 1; t >= 0; t--) {\r\n                    if (!tags[t].length) continue;\r\n                    stack.push('/' + tags[t].trim());\r\n                }\r\n            }\r\n            else if (tag == 'BR' && $el.data('mce-bogus'))\r\n                stack.push('RESET');\r\n            else {\r\n                stack.push(tag);\r\n                stack = stack.concat(this._buildHTMLStack($el.contents()));\r\n                stack.push('/' + tag);\r\n            }\r\n        }\r\n        return stack;\r\n    }\r\n\r\n    public getFormattedSelection() {\r\n        //build all previous nodes to ensure all formatting is captures\r\n        let nodes = tinymce.activeEditor.dom.getParents(tinymce.activeEditor.selection.getNode());\r\n        let n = 0, nl = nodes.length;\r\n        let start = '<html>';\r\n        let end = '</html>';\r\n        for (; n < nl; n++) {\r\n            let tag = nodes[n].tagName;\r\n            if (tag === 'EM' || tag === 'I' || tag === 'STRONG' || tag === 'B') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'SPAN') {\r\n                start += '<' + tag;\r\n                if (nodes[n].className != '')\r\n                    start += ' class=\"' + nodes[n].className + '\"';\r\n                let style = '';\r\n                if (nodes[n].style.textDecoration != '')\r\n                    style += 'text-decoration:' + nodes[n].style.textDecoration + ';';\r\n                if (nodes[n].style.color != '')\r\n                    style += 'color:' + nodes[n].style.color + ';';\r\n                if (nodes[n].style.background != '')\r\n                    style += 'background:' + nodes[n].style.background + ';';\r\n                if (nodes[n].style.backgroundColor != '')\r\n                    style += 'background-color:' + nodes[n].style.backgroundColor + ';';\r\n                if (style.length > 0)\r\n                    start += ' style=\"' + style + '\"';\r\n                if (nodes[n].dataset && nodes[n].dataset.mceStyle)\r\n                    start += ' data-mce-style=\"' + nodes[n].dataset.mceStyle + '\"';\r\n                start += ' >';\r\n                end = '</' + tag + '>' + end;\r\n            }\r\n            else if (tag === 'BODY') {\r\n                start += '<' + tag + '>';\r\n                end = '</' + tag + '>' + end;\r\n                break;\r\n            }\r\n        }\r\n        return this._formatHtml($(start + tinymce.activeEditor.selection.getContent({ format: 'raw' }).replace(/<\\/div><div>/g, '<br>') + end));\r\n    }\r\n\r\n    public getFormattedText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return this._formatHtml($('<html>' + this.getRaw() + '</html>'));\r\n        //return this.formatHtml($('<html>' + this.getRaw().replace(/<\\/div><div>/g, '<br>') + '</html>'));\r\n    }\r\n\r\n    public getText() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'text' });\r\n    }\r\n\r\n    // eslint-disable-next-line no-unused-vars\r\n    public getHTML() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'html' });\r\n    }\r\n\r\n    public getRaw() {\r\n        if (this.isSimple)\r\n            return this._element.value;\r\n        return tinymce.activeEditor.getContent({ format: 'raw' });\r\n    }\r\n\r\n    private _formatHtml(text) {\r\n        let data = this._buildHTMLStack(text);\r\n        let buffer = [];\r\n        let codes = [];\r\n        let color, d, dl, rgb;\r\n        if (DEBUG && client.getOption('enableDebug'))\r\n            client.debug('Advanced Editor Get Raw HTML: ' + this.getRaw());\r\n        for (d = data.length - 1; d >= 0; d--) {\r\n            if (!data[d].startsWith('\"') && data[d] != 'BR' && data[d] != 'RESET')\r\n                data.pop();\r\n            else\r\n                break;\r\n        }\r\n        if (data[0] === 'DIV')\r\n            data.shift();\r\n\r\n        for (d = 0, dl = data.length; d < dl; d++) {\r\n            switch (data[d]) {\r\n                case 'BOLD':\r\n                case 'ITALIC':\r\n                case 'UNDERLINE':\r\n                case 'STRIKEOUT':\r\n                case 'DBLUNDERLINE':\r\n                case 'OVERLINE':\r\n                case 'FLASH':\r\n                case 'REVERSE':\r\n                    codes.push('%^' + data[d] + '%^');\r\n                    buffer.push('%^' + data[d] + '%^');\r\n                    break;\r\n                case '/DBLUNDERLINE':\r\n                case '/OVERLINE':\r\n                case '/FLASH':\r\n                case '/REVERSE':\r\n                case '/UNDERLINE':\r\n                case '/BOLD':\r\n                case '/ITALIC':\r\n                case '/STRIKEOUT':\r\n                    codes.pop();\r\n                    this._cleanReset(buffer);\r\n                    buffer.push('%^RESET%^');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'SPAN':\r\n                case '/SPAN':\r\n                case '/BR':\r\n                case '/DIV':\r\n                    break;\r\n                case 'DIV':\r\n                case 'BR':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this._cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    buffer.push('\\n');\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                case 'RESET':\r\n                    if (codes.length > 0 && buffer.length > 0 && !buffer[buffer.length - 1].endsWith('%^RESET%^')) {\r\n                        this._cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                    }\r\n                    if (codes.length > 0)\r\n                        buffer.push(codes.join(''));\r\n                    break;\r\n                default:\r\n                    if (data[d].startsWith('COLOR: #')) {\r\n                        color = data[d].substr(8);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this._nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n                    }\r\n                    else if (data[d].startsWith('COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(7)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this._nearestHex('#' + color).substr(1);\r\n                        color = this._colors[color];\r\n                        if (color === 'BOLD BLACK' || color === 'BOLD%^%^BLACK')\r\n                            color = 'mono11';\r\n                        codes.push('%^' + color + '%^');\r\n                        buffer.push('%^' + color + '%^');\r\n\r\n                    }\r\n                    else if (data[d].startsWith('/COLOR: ')) {\r\n                        codes.pop();\r\n                        this._cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: #')) {\r\n                        color = data[d].substr(19);\r\n                        if (!this._colors[color]) {\r\n                            rgb = new RGBColor(color);\r\n                            color = this._nearestHex(rgb.toHex()).substr(1);\r\n                        }\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('BACKGROUND-COLOR: ')) {\r\n                        color = new RGBColor(data[d].substr(18)).toHex().substr(1);\r\n                        if (!this._colors[color])\r\n                            color = this._nearestHex('#' + color).substr(1);\r\n                        if (this._colors['B' + color])\r\n                            color = this._colors['B' + color];\r\n                        else\r\n                            color = this._colors[color];\r\n                        color = '%^B_' + color + '%^';\r\n                        codes.push(color);\r\n                        buffer.push(color);\r\n                    }\r\n                    else if (data[d].startsWith('/BACKGROUND-COLOR: ')) {\r\n                        codes.pop();\r\n                        this._cleanReset(buffer);\r\n                        buffer.push('%^RESET%^');\r\n                        if (codes.length > 0)\r\n                            buffer.push(codes.join(''));\r\n                    }\r\n                    else if (data[d].startsWith('\"'))\r\n                        buffer.push(data[d].substring(1, data[d].length - 1));\r\n                    break;\r\n            }\r\n        }\r\n        return buffer.join('');\r\n    }\r\n\r\n    private _cleanReset(buffer) {\r\n        let b = buffer.length - 1;\r\n        for (; b >= 0; b--) {\r\n            if (buffer[b].startsWith('%^'))\r\n                buffer.pop();\r\n            else\r\n                return buffer;\r\n        }\r\n        return buffer;\r\n    }\r\n\r\n    //{ color: 'red', hex: '#EA4235', rgb: { r: 234, g: 66, b: 53 } },\r\n    private _colorList = [];\r\n\r\n    private _nearestHex(hex) {\r\n        let _editor = this;\r\n        //https://codereview.stackexchange.com/questions/132225/given-hexadecimal-rgb-color-find-the-closest-predefined-color\r\n        let hexToRgb = function (hex) {\r\n            let shortRegEx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n            //hex = hex.replace(shortRegEx, '$1$1$2$2$3$3');\r\n            hex = hex.replace(shortRegEx, function (full, r, g, b) {\r\n                return [r, r, g, g, b, b].join();\r\n            });\r\n            let longRegEx = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})?/i;\r\n            let rgbArray = longRegEx.exec(hex);\r\n            let rgbObj = rgbArray ? {\r\n                r: parseInt(rgbArray[1], 16),\r\n                g: parseInt(rgbArray[2], 16),\r\n                b: parseInt(rgbArray[3], 16)\r\n            } : null;\r\n            return rgbObj;\r\n        };\r\n\r\n        let closestHexFromRgb = function (rgbObj) {\r\n            if (!rgbObj) {\r\n                throw new Error('The hex you provided is not formatted correctly. Please try in a format such as \\'#FFF\\' or \\'#DDFFDD\\'.');\r\n            }\r\n\r\n            let minDistance = Number.MAX_SAFE_INTEGER;\r\n            let nearestHex = null;\r\n\r\n            for (let i = 0; i < _editor._colorList.length; i++) {\r\n                let currentColor = _editor._colorList[i];\r\n                let distance = Math.sqrt(\r\n                    Math.pow((rgbObj.r - currentColor.rgb.r), 2) +\r\n                    Math.pow((rgbObj.g - currentColor.rgb.g), 2) +\r\n                    Math.pow((rgbObj.b - currentColor.rgb.b), 2)\r\n                );\r\n                if (distance < minDistance) {\r\n                    minDistance = distance;\r\n                    nearestHex = currentColor.hex;\r\n                }\r\n            }\r\n            return nearestHex;\r\n        };\r\n\r\n        return closestHexFromRgb(hexToRgb(hex));\r\n\r\n    }\r\n\r\n    public remove() {\r\n        tinymce.remove(`#${this._element.id}`);\r\n    }\r\n\r\n    public initialize() {\r\n        if (this.isSimple) return;\r\n        this._initPlugins();\r\n        tinymce.init({\r\n            license_key: 'gpl',\r\n            custom_colors: false,\r\n            selector: `textarea#${this._element.id}`,\r\n            height: 500,\r\n            menubar: false,\r\n            browser_spellcheck: true,\r\n            //contextmenu: false,\r\n            resize: true,\r\n            statusbar: false,\r\n            nowrap: true,\r\n            force_br_newlines: true,\r\n            forced_root_block: 'div',\r\n            plugins: 'pinkfish insertdatetime pinkfishtextcolor nonbreaking',\r\n            color_picker_callback: (editor, color, format) => { this._openColorDialog(format, color || ''); },\r\n            color_picker_caption: 'More&hellip;',\r\n            textcolor_rows: '3',\r\n            textcolor_cols: '8',\r\n            toolbar: `send | append | undo redo ${isPasteSupported() ? '| pastecustom pasteastext pasteformatted ' : ''}| pinkfishforecolor pinkfishbackcolor | italic underline strikethrough overline dblunderline flash reverse | clear | copy copyformatted | insertdatetime`,\r\n            toolbar_mode: 'sliding',\r\n            content_css: 'css/tinymce.content.min.css',\r\n            formats: {\r\n                bold: { inline: 'strong', exact: true, links: true, remove_similar: true },\r\n                italic: { inline: 'em', exact: true, links: true, remove_similar: true },\r\n                overline: { inline: 'span', 'classes': 'overline', links: true, remove_similar: true },\r\n                dblunderline: { inline: 'span', 'classes': 'dblunderline', links: true, remove_similar: true },\r\n                flash: { inline: 'span', 'classes': 'flash', links: true, remove_similar: true },\r\n                reverse: { inline: 'span', 'classes': 'reverse', links: true, remove_similar: true },\r\n                underline: { inline: 'span', 'classes': 'underline', links: true, remove_similar: true },\r\n                strikethrough: { inline: 'span', 'classes': 'strikeout', links: true, remove_similar: true },\r\n                //forecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                //hilitecolor: { inline: 'span', styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n                //forecolor: { block: 'span', attributes: { 'data-color': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', color: '%value' }, exact: true, links: true, remove_similar: true },\r\n                //hilitecolor: { block: 'span', attributes: { 'data-backcolor': '%value' }, styles: { textDecoration: 'inherit', border: 'inherit', backgroundColor: '%value' }, exact: true, links: true, remove_similar: true }\r\n            },\r\n            init_instance_callback: (editor) => {\r\n                editor.shortcuts.add('ctrl+shift+c', 'Copy formatted', () => copyText(this.getFormattedSelection().replace(/(?:\\r)/g, '')));\r\n                if (isPasteSupported()) {\r\n                    editor.shortcuts.add('ctrl+shift+p', 'Paste formatted', () => {\r\n                        pasteText().then(text => {\r\n                            this.insertFormatted(text || '');\r\n                        }).catch(err => {\r\n                            if (client.enableDebug)\r\n                                client.debug(err);\r\n                            if (err.message && err.message === 'Permission not granted!')\r\n                                alert('Paste permission not granted.');\r\n                            else\r\n                                alert('Paste not supported.');\r\n                        });\r\n                    });\r\n                    editor.shortcuts.add('ctrl+alt+p', 'Paste as text', () => {\r\n                        pasteText().then(text => {\r\n                            tinymce.activeEditor.execCommand('mceInsertContent', false, (text || '').replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;'));\r\n                        }).catch(err => {\r\n                            if (client.enableDebug)\r\n                                client.debug(err);\r\n                            if (err.message && err.message === 'Permission not granted!')\r\n                                alert('Paste permission not granted.');\r\n                            else\r\n                                alert('Paste not supported.');\r\n                        });\r\n                    });\r\n                }\r\n                editor.on('PastePreProcess', e => {\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced Before Editor PastePreProcess: ' + e.content);\r\n                    this._clearReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                    e.content = e.content.replace(/<\\/p>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/h[1-6]>/g, '<br>');\r\n                    e.content = e.content.replace(/<\\/li>/g, '<br>');\r\n                    e.content = e.content.replace(/ background: #000000;/g, '');\r\n                    e.content = e.content.replace(/background: #000000;/g, '');\r\n                    e.content = e.content.replace(/ background-color: #000000;/g, '');\r\n                    e.content = e.content.replace(/background-color: #000000;/g, '');\r\n                    e.content = e.content.replace(/ color: #BBBBBB;/g, '');\r\n                    e.content = e.content.replace(/color: #BBBBBB;/g, '');\r\n                    let regex = /<pre(.*?)>((.|\\s)*)<\\/pre>/mgi;\r\n                    let m;\r\n                    while ((m = regex.exec(e.content)) !== null) {\r\n                        if (m.index === regex.lastIndex) {\r\n                            regex.lastIndex++;\r\n                        }\r\n                        e.content = e.content.substring(0, m.index) + e.content.substring(m.index, regex.lastIndex).replace(/(\\r\\n|\\r|\\n)/g, '<br/>').replaceAll('  ', '&nbsp;&nbsp;') + e.content.substring(regex.lastIndex);\r\n                    }\r\n                    if (client.getOption('enableDebug'))\r\n                        client.debug('Advanced After Editor PastePreProcess: ' + e.content);\r\n                });\r\n                editor.on('PastePreProcess', () => {\r\n                    this._addReverse($('.reverse', $(editor.getDoc()).contents()));\r\n                });\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-size', client.getOption('cmdfontSize'));\r\n                $('.mce-content-body', tinymce.activeEditor.getDoc()).css('font-family', client.getOption('cmdfont') + ', monospace');\r\n                if (tinymce.activeEditor.formatter)\r\n                    tinymce.activeEditor.formatter.register('flash', { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true });\r\n                else\r\n                    tinymce.activeEditor.settings.formats['flash'] = { inline: 'span', 'classes': client.getOption('flashing') ? 'flash' : 'noflash', links: true, remove_similar: true };\r\n                this._loadColors();\r\n                this.setFormatted(this._element.value);\r\n                editor.on('click', e => {\r\n                    this.emit('click', e);\r\n                })\r\n                this.emit('editor-init');\r\n                this._init = true;\r\n            },\r\n            paste_data_images: false,\r\n            paste_webkit_styles: 'color background background-color text-decoration',\r\n            valid_elements: 'strong/b,em/i,u,span[style|class],strike/s,br',\r\n            valid_styles: {\r\n                '*': 'color,background,background-color,text-decoration,font-weight'\r\n            },\r\n            color_map: this._ColorTable,\r\n        });\r\n    }\r\n\r\n    public focus() {\r\n        if (this.isSimple)\r\n            this._element.focus();\r\n        else if (this._init && TINYMCE && tinymce.activeEditor && tinymce.activeEditor.initialized)\r\n            tinymce.activeEditor.focus();\r\n    }\r\n}", "import { capitalize } from '../core/library';\r\n\r\nexport interface breadcrumbOptions {\r\n    small?;\r\n    sep?;\r\n    formatter?;\r\n    icon?;\r\n}\r\n\r\nexport function buildBreadcrumb(pages, options?: breadcrumbOptions) {\r\n    let breadcrumb = '';\r\n    let last = pages.length - 1;\r\n    options = Object.assign({\r\n        sep: '-',\r\n        formatter: (item => capitalize(item.match(/([A-Z]|^[a-z]|[0-9])[a-z0-9]*/g).join(' '))),\r\n        icon: '<i class=\"bi bi-question-circle\"></i>'\r\n    }, options || {})\r\n\r\n    if (pages.length === 1)\r\n        breadcrumb += `<li class=\"breadcrumb-icon\">${options.icon}</li>`;\r\n    else\r\n        breadcrumb += `<li class=\"breadcrumb-icon\"><a href=\"#${pages.slice(0, 1).join('-')}\">${options.icon}</a></li>`;\r\n    for (let p = 0, pl = pages.length; p < pl; p++) {\r\n        let title = options.formatter(pages[p], p, last);\r\n        if (p === last)\r\n            breadcrumb += '<li class=\"breadcrumb-item active\">' + title + '</li>';\r\n        else\r\n            breadcrumb += '<li class=\"breadcrumb-item\" aria-current=\"page\"><a href=\"#' + pages.slice(0, p + 1).join(options.sep) + '\">' + title + '</a></li>';\r\n    }\r\n    if (options.small)\r\n        return `<ol class=\"breadcrumb${this._small ? ' breadcrumb-sm' : ''}\" style=\"overflow: hidden;white-space: nowrap;text-overflow: ellipsis;flex-wrap: nowrap;\">${breadcrumb}</ol>`;\r\n    return '<ol class=\"float-start breadcrumb\">' + breadcrumb + '</ol>';\r\n}", "<div class=\"contents list-group list-group-flush\" style=\"top:0;position:absolute;left:0;bottom:49px;right:0\"><a href=\"#settings-general\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-cogs\"></i> General</a> <a href=\"#settings-display\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-display\"></i> Display</a> <a href=\"#settings-colors\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-palette\"></i> Colors</a> <a href=\"#settings-commandLine\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-terminal\"></i> Command line</a> <a href=\"#settings-tabCompletion\" class=\"list-group-item list-group-item-action\"><i class=\"fa-solid fa-arrow-right-to-bracket\"></i> Tab completion</a> <a href=\"#settings-telnet\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-network-wired\"></i> Telnet</a> <a href=\"#settings-scripting\" class=\"list-group-item list-group-item-action\"><i class=\"fas fa-code\"></i> Scripting</a> <a href=\"#settings-specialCharacters\" class=\"list-group-item list-group-item-action\"><i class=\"fa-regular fa-file-code\"></i> Special characters</a> <a href=\"#settings-advanced\" class=\"list-group-item list-group-item-action\"><i class=\"fa-solid fa-sliders\"></i> Advanced</a></div>", "import { Dialog, DialogButtons, DialogIcon } from './dialog';\r\nimport { capitalize, clone, openFileDialog, readFile, scrollChildIntoView } from '../core/library';\r\nimport { Settings, SettingList } from '../core/settings';\r\nimport { RGBColor } from '../lib/rgbcolor';\r\nimport { removeHash } from './interface';\r\nimport { buildBreadcrumb } from './breadcrumb'\r\n\r\n// @ts-ignore\r\nimport menuTemplate from '../html/settings.menu.htm'\r\n\r\ndeclare let fileSaveAs;\r\ndeclare let confirm_box;\r\ndeclare let alert_box;\r\nexport class SettingsDialog extends Dialog {\r\n    private _menu;\r\n    private _page;\r\n\r\n    public settings: Settings;\r\n\r\n    constructor() {\r\n        super(({ title: '<i class=\"fas fa-cogs\"></i> Settings', id:'settings-dialog', keepCentered: true, resizable: false, moveable: false, center: true, maximizable: false }));\r\n        this.body.style.padding = '10px';\r\n        this._buildMenu();\r\n        let footer = '';\r\n        footer += `<button id=\"${this.id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Cancel dialog\"><i class=\"bi bi-x-lg\"></i><span class=\"icon-only\"> Cancel</span></button>`;\r\n        footer += `<button id=\"${this.id}-save\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Confirm dialog\"><i class=\"bi bi-save\"></i><span class=\"icon-only\"> Save</span></button>`;\r\n        footer += `<button id=\"${this.id}-reset\" type=\"button\" class=\"btn-sm float-start btn btn-warning\" title=\"Reset settings\"><i class=\"bi bi-arrow-clockwise\"></i><span class=\"icon-only\"> Reset</span></button>`\r\n        footer += `<button id=\"${this.id}-reset-all\" type=\"button\" class=\"btn-sm float-start btn btn-warning\" title=\"Reset All settings\"><i class=\"bi bi-arrow-repeat\"></i><span class=\"icon-only\"> Reset All</span></button>`\r\n        footer += '<div class=\"vr float-start\" style=\"margin-right: 4px;height: 29px;\"></div>';\r\n        footer += `<button id=\"${this.id}-export\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Export settings\"><i class=\"bi bi-box-arrow-up\"></i><span class=\"icon-only\"> Export</span></button>`;\r\n        footer += `<button id=\"${this.id}-import\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Import settings\"><i class=\"bi bi-box-arrow-in-down\"></i><span class=\"icon-only\"> Import</span></button>`;\r\n        this.footer.innerHTML = footer;\r\n        this.footer.querySelector(`#${this.id}-cancel`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            this.close();\r\n        });\r\n        this.footer.querySelector(`#${this.id}-export`).addEventListener('click', () => {\r\n            let data = clone(this.settings);\r\n            data.version = 2;\r\n            fileSaveAs.show(JSON.stringify(data), 'oiMUD.settings.txt', 'text/plain');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-import`).addEventListener('click', () => {\r\n            openFileDialog('Import settings').then(files => {\r\n                readFile(files[0]).then((contents: any) => {\r\n                    try {\r\n                        let data = JSON.parse(contents);\r\n                        let s, sl;\r\n                        if (data.version === 1) {\r\n                            for (s = 0, sl = SettingList.length; s < sl; s++) {\r\n                                this.settings[SettingList[s][0]] = data[SettingList[s][0]];\r\n                            }\r\n                            //TODO not supported, should be sent to mapper to import\r\n                            this.emit('import-rooms', data.rooms);\r\n                        }\r\n                        else if (data.version === 2 && !data.profiles) {\r\n                            for (s = 0, sl = SettingList.length; s < sl; s++) {\r\n                                this.settings[SettingList[s][0]] = data[SettingList[s][0]];\r\n                            }\r\n                        }\r\n                        else\r\n                            setTimeout(function () {\r\n                                alert_box('Invalid file', 'Unable to import file, not a valid settings file', DialogIcon.exclamation);\r\n                            }, 50);\r\n                        this._loadPageSettings();\r\n                    }\r\n                    catch (err) {\r\n                        setTimeout(function () {\r\n                            alert_box('Error importing', 'Error importing file.', DialogIcon.error);\r\n                        }, 50);\r\n                        client.error(err);\r\n                    }\r\n                }).catch(client.error);\r\n            }).catch(() => { });\r\n        });\r\n\r\n        this.footer.querySelector(`#${this.id}-reset`).addEventListener('click', () => {\r\n            if (this._page === 'settings-colors') {\r\n                confirm_box('Reset colors', 'Reset colors?').then(e => {\r\n                    if (e.button === DialogButtons.Yes) {\r\n                        let c;\r\n                        let colors = this.settings.colors = [];\r\n                        for (c = 0; c < 16; c++)\r\n                            this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n                        for (c = 256; c < 280; c++)\r\n                            this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n                        this.body.querySelector(`#colorScheme`).value = 0;\r\n                    }\r\n                });\r\n            }\r\n            else if (this._page && this._page !== 'settings' && this._page.length) {\r\n                const pages = this._page.split('-');\r\n                let title = capitalize(pages[pages.length - 1].match(/([A-Z]|^[a-z])[a-z]+/g).join(' '));\r\n                confirm_box(`Reset ${title} settings`, `Reset ${title} settings?`).then(e => {\r\n                    if (e.button === DialogButtons.Yes) {\r\n                        const forms: HTMLInputElement[] = this.body.querySelectorAll('input,select,textarea');\r\n                        for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                            let id = forms[f].name || forms[f].id;\r\n                            this.settings[id] = Settings.defaultValue(id);\r\n                            if (forms[f].type === 'checkbox' || forms[f].type === 'radio')\r\n                                forms[f].checked = this.settings[id];\r\n                            else\r\n                                forms[f].value = this.settings[id];\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n            else {\r\n                confirm_box('Reset all settings', 'Reset all settings?').then(e => {\r\n                    if (e.button === DialogButtons.Yes)\r\n                        this.settings.reset();\r\n                });\r\n            }\r\n        })\r\n\r\n        this.footer.querySelector(`#${this.id}-reset-all`).addEventListener('click', () => {\r\n            confirm_box('Reset all settings', 'Reset all settings?').then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this.settings.reset();\r\n            });\r\n        })\r\n        this.footer.querySelector(`#${this.id}-save`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            for (let s in this.settings) {\r\n                if (!this.settings.hasOwnProperty(s)) continue\r\n                Settings.setValue(s, this.settings[s]);\r\n            }\r\n            client.clearCache();\r\n            client.loadOptions();\r\n            this.close();\r\n        })\r\n        this.settings = new Settings();\r\n        this.on('closed', () => {\r\n            removeHash(this._page);\r\n        });\r\n        this.on('canceled', () => {\r\n            removeHash(this._page);\r\n        });\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        super.setBody(this.dialog.dataset.path === 'settings' ? menuTemplate : contents, args);\r\n        this._page = this.dialog.dataset.path;\r\n        const pages = this._page.split('-');\r\n        this.title = buildBreadcrumb(pages, { icon: '<i class=\"float-start fas fa-cogs\" style=\"padding: 2px;margin-right: 2px;\"></i>' });\r\n        if (this._menu) {\r\n            let items = this._menu.querySelectorAll('a.active');\r\n            items.forEach(item => item.classList.remove('active'));\r\n            items = this._menu.querySelector(`a[href=\"#${this._page}\"]`);\r\n            if (items)\r\n                items.classList.add('active');\r\n        }\r\n        if (this._page === 'settings') {\r\n            if (this._menu)\r\n                this._menu.style.display = 'none';\r\n            this.body.style.left = '';\r\n            if (this.footer.querySelector(`#${this.id}-reset`))\r\n                this.footer.querySelector(`#${this.id}-reset`).style.display = 'none';\r\n            SettingsDialog.addPlugins(this.body.querySelector('div.contents'));\r\n        }\r\n        else {\r\n            if (this._menu)\r\n                this._menu.style.display = '';\r\n            if (this.footer.querySelector(`#${this.id}-reset`))\r\n                this.footer.querySelector(`#${this.id}-reset`).style.display = '';\r\n            this.body.style.left = '200px';\r\n            scrollChildIntoView(this._menu, this._menu.querySelector(`a[href=\"#${this._page}\"]`));\r\n        }\r\n        this.body.scrollTop = 0;\r\n        this._loadPageSettings();\r\n    }\r\n\r\n    private _buildMenu() {\r\n        this.dialog.insertAdjacentHTML(\"beforeend\", menuTemplate.replace(' style=\"top:0;position:absolute;left:0;bottom:49px;right:0\"', ''));\r\n        this._menu = this.dialog.querySelector('.contents');\r\n        this._menu.classList.add('settings-menu');\r\n        SettingsDialog.addPlugins(this._menu);\r\n        if (this._page === 'settings')\r\n            this._menu.style.display = 'none';\r\n        this.body.style.left = '200px';\r\n    }\r\n\r\n    private _loadPageSettings() {\r\n        const forms: HTMLInputElement[] = this.body.querySelectorAll('input,select,textarea');\r\n        let required;\r\n        if (this._page === 'settings-colors') {\r\n            let c;\r\n            let colors = this.settings.colors || [];\r\n            for (c = 0; c < 16; c++)\r\n                this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n            for (c = 256; c < 280; c++)\r\n                this.setColor('color' + c, colors[c] || this.getDefaultColor(c));\r\n            for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                forms[f].addEventListener('change', e => {\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    let value = target.value;\r\n                    let id = parseInt(target.id.substring(5), 10);\r\n                    let colors = this.settings.colors || [];\r\n                    if (!colors[id] || colors[id].length === 0) {\r\n                        if (this.getDefaultColor(id) !== value)\r\n                            colors[id] = value;\r\n                    }\r\n                    else if (this.getDefaultColor(id) !== value)\r\n                        delete colors[id];\r\n                    else\r\n                        colors[id] = value;\r\n                    this.settings.colors = colors;\r\n                });\r\n                forms[f].addEventListener('input', e => {\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    let value = target.value;\r\n                    let id = parseInt(target.id.substring(5), 10);\r\n                    if (!this.settings.colors[id] || this.settings.colors[id].length === 0) {\r\n                        if (this.getDefaultColor(id) !== value)\r\n                            this.settings.colors[id] = value;\r\n                    }\r\n                    else if (this.getDefaultColor(id) !== value)\r\n                        delete this.settings.colors[id];\r\n                    else\r\n                        this.settings.colors[id] = value;\r\n\r\n                })\r\n            }\r\n        }\r\n        else {\r\n            for (let f = 0, fl = forms.length; f < fl; f++) {\r\n                const defaultValue = forms[f].dataset.default || '';\r\n                if (forms[f].dataset.parent && !(forms[f].dataset.parent in this.settings))\r\n                    this.settings[forms[f].dataset.parent] = Settings.getValue(forms[f].dataset.parent);\r\n                if (forms[f].type === 'radio') {\r\n                    if (!forms[f].dataset.parent && !(forms[f].name in this.settings))\r\n                        this.settings[forms[f].name] = Settings.getValue(forms[f].name);\r\n                    let value;\r\n                    if (forms[f].dataset.parent) {\r\n                        if (this.settings[forms[f].dataset.parent] && this.settings[forms[f].dataset.parent][forms[f].dataset.field] !== null)\r\n                            value = '' + this.settings[forms[f].dataset.parent][forms[f].dataset.field];\r\n                        else\r\n                            value = defaultValue;\r\n                    }\r\n                    else if (this.settings[forms[f].name] === null)\r\n                        value = defaultValue;\r\n                    else\r\n                        value = '' + this.settings[forms[f].name];\r\n                    forms[f].checked = value === forms[f].value;\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.checked) {\r\n                            if (target.dataset.parent) {\r\n                                if (!this.settings[target.dataset.parent])\r\n                                    this.settings[target.dataset.parent] = {};\r\n                                this.settings[target.dataset.parent][target.dataset.field] = this.convertType(target.value, typeof this.settings[target.dataset.parent][target.dataset.field]);\r\n                            }\r\n                            else\r\n                                this.settings[target.name] = this.convertType(target.value, typeof this.settings[target.name]);\r\n                        }\r\n                    });\r\n                }\r\n                else if (forms[f].type === 'checkbox') {\r\n                    let name;\r\n                    if (forms[f].dataset.enum === 'true') {\r\n                        name = forms[f].name || forms[f].id.substring(0, forms[f].id.lastIndexOf('-'));\r\n                        if (!(name in this.settings))\r\n                            this.settings[name] = Settings.getValue(name);\r\n                        const value = +forms[f].id.substring(forms[f].id.lastIndexOf('-') + 1);\r\n                        forms[f].checked = (this.settings[name] & value) === value;\r\n                    }\r\n                    else if (forms[f].dataset.parent) {\r\n                        if (this.settings[forms[f].dataset.parent] && forms[f].dataset.field in this.settings[forms[f].dataset.parent])\r\n                            forms[f].checked = this.settings[forms[f].dataset.parent][forms[f].dataset.field];\r\n                        else\r\n                            forms[f].checked = defaultValue === 'true';\r\n                    }\r\n                    else {\r\n                        name = forms[f].name || forms[f].id;\r\n                        if (!(name in this.settings))\r\n                            this.settings[name] = Settings.getValue(name);\r\n                        if (this.settings[name] !== null)\r\n                            forms[f].checked = this.settings[name];\r\n                        else\r\n                            forms[f].checked = defaultValue === 'true';\r\n                    }\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        let name;\r\n                        if (target.dataset.enum === 'true') {\r\n                            name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\r\n                            const enums = this.body.querySelectorAll(`[name=\"${name}\"]`);\r\n                            let value = 0;\r\n                            for (let e = 0, el = enums.length; e < el; e++) {\r\n                                if (enums[e].checked)\r\n                                    value |= +enums[e].value;\r\n                            }\r\n                            if (target.dataset.parent) {\r\n                                if (!this.settings[target.dataset.parent])\r\n                                    this.settings[target.dataset.parent] = {};\r\n                                this.settings[target.dataset.parent][target.dataset.field] = value;\r\n                            }\r\n                            else\r\n                                this.settings[name] = value;\r\n                        }\r\n                        else if (target.dataset.parent) {\r\n                            if (!this.settings[target.dataset.parent])\r\n                                this.settings[target.dataset.parent] = {};\r\n                            this.settings[target.dataset.parent][target.dataset.field] = target.checked || false\r\n                        }\r\n                        else {\r\n                            name = target.name || target.id;\r\n                            this.settings[name] = target.checked || false;\r\n                        }\r\n                        let required = this.body.querySelectorAll(`[data-require=\"${name}\"]`);\r\n                        required.forEach(r => {\r\n                            r.disabled = !this.settings[name];\r\n                        });\r\n                    });\r\n                    required = this.body.querySelectorAll(`[data-require=\"${name}\"]`);\r\n                    required.forEach(r => {\r\n                        r.disabled = !this.settings[name];\r\n                    });\r\n                }\r\n                else {\r\n                    let value;\r\n                    if (forms[f].dataset.parent) {\r\n                        if (this.settings[forms[f].dataset.parent] && forms[f].dataset.field in this.settings[forms[f].dataset.parent]) {\r\n                            if (forms[f].dataset.join && forms[f].dataset.join.length)\r\n                                forms[f].value = (this.settings[forms[f].dataset.parent][forms[f].dataset.field] || []).map(v => v.trim()).join(forms[f].dataset.join);\r\n                            else\r\n                                forms[f].value = this.settings[forms[f].dataset.parent][forms[f].dataset.field];\r\n                        }\r\n                        else\r\n                            value = defaultValue;\r\n                    }\r\n                    else if (forms[f].dataset.join && forms[f].dataset.join.length) {\r\n                        if (!(forms[f].id in this.settings))\r\n                            this.settings[forms[f].id] = Settings.getValue(forms[f].id);\r\n                        if (this.settings[forms[f].id] !== null)\r\n                            value = (this.settings[forms[f].id] || []).map(v => v.trim()).join(forms[f].dataset.join);\r\n                        else\r\n                            value = defaultValue;\r\n                    }\r\n                    else {\r\n                        if (!(forms[f].id in this.settings))\r\n                            this.settings[forms[f].id] = Settings.getValue(forms[f].id);\r\n                        if (this.settings[forms[f].id] !== null)\r\n                            value = this.settings[forms[f].id];\r\n                        else\r\n                            value = defaultValue;\r\n                    }\r\n                    forms[f].value = value;\r\n                    forms[f].addEventListener('change', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.dataset.parent) {\r\n                            let value;\r\n                            if (target.dataset.join && target.dataset.join.length)\r\n                                value = target.value.split(target.dataset.join).map(v => v.trim());\r\n                            else\r\n                                value = target.value;\r\n                            if (!this.settings[target.dataset.parent])\r\n                                this.settings[target.dataset.parent] = {};\r\n                            this.settings[target.dataset.parent][target.dataset.field] = this.getValue(value, this.settings[target.dataset.parent][target.dataset.field]);\r\n                        }\r\n                        else if (target.dataset.join && target.dataset.join.length)\r\n                            this.setValue(target.name || target.id, target.value.split(target.dataset.join).map(v => v.trim()));\r\n                        else\r\n                            this.setValue(target.name || target.id, target.value);\r\n                    });\r\n                    forms[f].addEventListener('input', e => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        if (target.dataset.parent) {\r\n                            let value;\r\n                            if (target.dataset.join && target.dataset.join.length)\r\n                                value = target.value.split(target.dataset.join).map(v => v.trim());\r\n                            else\r\n                                value = target.value;\r\n                            if (!this.settings[target.dataset.parent])\r\n                                this.settings[target.dataset.parent] = {};\r\n                            this.settings[target.dataset.parent][target.dataset.field] = this.getValue(value, this.settings[target.dataset.parent][target.dataset.field]);\r\n                        }\r\n                        else if (target.dataset.join && target.dataset.join.length)\r\n                            this.setValue(target.name || target.id, target.value.split(target.dataset.join).map(v => v.trim()));\r\n                        else\r\n                            this.setValue(target.name || target.id, target.value);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public setColor(id, color?) {\r\n        if (!color || typeof color === 'undefined' || color.length === 0)\r\n            this.body.querySelector('#' + id).value = '';\r\n        else\r\n            this.body.querySelector('#' + id).value = this.colorHex(color);\r\n    }\r\n\r\n    public colorHex(color) {\r\n        if (!color) return false;\r\n        color = new RGBColor(color);\r\n        if (!color.ok)\r\n            return '';\r\n        return color.toHex();\r\n    };\r\n\r\n    public getDefaultColor(code) {\r\n        if (code === 0) return 'rgb(0,0,0)'; //black fore\r\n        if (code === 1) return 'rgb(128, 0, 0)';//red fore\r\n        if (code === 2) return 'rgb(0, 128, 0)';//green fore\r\n        if (code === 3) return 'rgb(128, 128, 0)';//yellow fore\r\n        if (code === 4) return 'rgb(0, 0, 128)';//blue fore\r\n        if (code === 5) return 'rgb(128, 0, 128)';//magenta fore\r\n        if (code === 6) return 'rgb(0, 128, 128)';//cyan fore\r\n        if (code === 7) return 'rgb(192, 192, 192)';//white fore\r\n        if (code === 8) return 'rgb(128, 128, 128)';//black  bold\r\n        if (code === 9) return 'rgb(255, 0, 0)'; //Red bold\r\n        if (code === 10) return 'rgb(0, 255, 0)'; //green bold\r\n        if (code === 11) return 'rgb(255, 255, 0)';//yellow bold\r\n        if (code === 12) return 'rgb(0, 0, 255)';//blue bold\r\n        if (code === 13) return 'rgb(255, 0, 255)';//magenta bold\r\n        if (code === 14) return 'rgb(0, 255, 255)';//cyan bold\r\n        if (code === 15) return 'rgb(255, 255, 255)';//white bold\r\n        if (code === 256) return 'rgb(0, 0, 0)';//black faint\r\n        if (code === 257) return 'rgb(118, 0, 0)';//red  faint\r\n        if (code === 258) return 'rgb(0, 108, 0)';//green faint\r\n        if (code === 259) return 'rgb(145, 136, 0)';//\"rgb(108, 108, 0)\";//yellow faint\r\n        if (code === 260) return 'rgb(0, 0, 108)';//blue faint\r\n        if (code === 261) return 'rgb(108, 0, 108)';//magenta faint\r\n        if (code === 262) return 'rgb(0, 108, 108)';//cyan faint\r\n        if (code === 263) return 'rgb(160, 160, 160)';//white faint\r\n        if (code === 264) return 'rgb(0, 0, 0)'; //BackgroundBlack\r\n        if (code === 265) return 'rgb(128, 0, 0)';//red back\r\n        if (code === 266) return 'rgb(0, 128, 0)';//greenback\r\n        if (code === 267) return 'rgb(128, 128, 0)';//yellow back\r\n        if (code === 268) return 'rgb(0, 0, 128)';//blue back\r\n        if (code === 269) return 'rgb(128, 0, 128)';//magenta back\r\n        if (code === 270) return 'rgb(0, 128, 128)';//cyan back\r\n        if (code === 271) return 'rgb(192, 192, 192)';//white back\r\n        if (code === 272) return 'rgb(0,0,0)'; //iceMudInfoBackground\r\n        if (code === 273) return 'rgb(0, 255, 255)';//iceMudInfoText\r\n        if (code === 274) return 'rgb(0,0,0)'; //LocalEchoBackground\r\n        if (code === 275) return 'rgb(255, 255, 0)';//LocalEchoText\r\n        if (code === 276) return 'rgb(0, 0, 0)';//DefaultBack\r\n        if (code === 277) return 'rgb(192, 192, 192)';//DefaultFore\r\n        if (code === 278) return 'rgb(128, 0, 0)';//ErrorFore\r\n        if (code === 279) return 'rgb(192, 192, 192)';//ErrorBack\r\n        if (code === 280) return 'rgb(255,255,255)';//DefaultBrightFore\t\r\n        return '';\r\n    }\r\n\r\n    public setValue(option, value) {\r\n        if (value == 'false') value = false;\r\n        else if (value == 'true') value = true;\r\n        else if (value == 'null') value = null;\r\n        else if (value == 'undefined') value = undefined;\r\n        else if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n            value = parseFloat(value);\r\n        this.settings[option] = this.convertType(value, typeof this.settings[option]);\r\n    }\r\n\r\n    public getValue(value, current) {\r\n        if (value == 'false') return false;\r\n        if (value == 'true') return true;\r\n        if (value == 'null') return null;\r\n        if (value == 'undefined') return undefined;\r\n        if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n            return parseFloat(value);\r\n        return this.convertType(value, typeof current);\r\n    }\r\n\r\n    public convertType(value, type) {\r\n        if (typeof value === type)\r\n            return value;\r\n        switch (type) {\r\n            case 'number':\r\n                if (typeof value == 'string' && parseFloat(value).toString() == value)\r\n                    return parseFloat(value);\r\n                return Number(value);\r\n            case 'boolean':\r\n                return Boolean(value);\r\n            case 'string':\r\n                return '' + value;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    static addPlugins(menu) {\r\n        let pl = client.plugins.length;\r\n        let plugins = client.plugins\r\n        let s;\r\n        let sl;\r\n        for (let p = 0; p < pl; p++) {\r\n            if (!plugins[p].settings) continue;\r\n            if (plugins[p].settings.length) {\r\n                sl = plugins[p].settings.length;\r\n                for (s = 0; s < sl; s++) {\r\n                    let item = plugins[p].settings[s];\r\n                    if (typeof item.action !== 'string') continue;\r\n                    let code = `<a href=\"#${item.action}\" class=\"list-group-item list-group-item-action\">${item.icon || ''}${item.name || ''}</a>`;\r\n                    if ('position' in item) {\r\n                        if (typeof item.position === 'string') {\r\n                            if (menu.querySelector(item.position)) {\r\n                                menu.querySelector(item.position).insertAdjacentHTML('afterend', code);\r\n                                continue;\r\n                            }\r\n                        }\r\n                        else if (item.position >= 0 && item.position < menu.children.length) {\r\n                            menu.children[item.position].insertAdjacentHTML('afterend', code);\r\n                            continue;\r\n                        }\r\n                    }\r\n                    menu.insertAdjacentHTML('beforeend', code);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}", "//spellchecker:ignore\nimport '../css/splitter.css';\nimport { EventEmitter } from '../core/events';\n\nexport interface SplitterOptions {\n    container?: any;\n    orientation?: Orientation;\n    parent?: any;\n    id?: string;\n    panel1?: HTMLElement;\n    panel2?: HTMLElement;\n    anchor?: PanelAnchor;\n}\n\nexport enum Orientation {\n    horizontal, vertical\n}\n\nexport enum PanelAnchor {\n    panel1 = 1, panel2 = 2\n}\n\n/**\n * Splitter display control\n *\n * @export\n * @class Splitter\n * @extends {EventEmitter}\n */\nexport class Splitter extends EventEmitter {\n    private $el: HTMLElement;\n    private $parent: HTMLElement;\n    private $panel1: HTMLElement;\n    private $panel2: HTMLElement;\n    private $orientation: Orientation;\n    private $panel1MinSize = 200;\n    private $panel2MinSize = 200;\n    private $splitterWidth = 4;\n    private $dragBar: HTMLElement;\n    private $ghostBar: HTMLElement;\n    private $splitterDistance = 204;\n    private $dragging = false;\n    private $id;\n    private $collapsed = 0;\n    private $resizeObserver;\n    private $resizeObserverCache;\n    private $observer: MutationObserver;\n    private $anchor: PanelAnchor;\n\n    public live = true;\n\n    private $elBounds;\n\n    public hide() {\n        this.$el.style.display = 'none';\n    }\n\n    public show() {\n        this.$el.style.display = '';\n    }\n\n    constructor(options?: SplitterOptions) {\n        super();\n        if (options && options.id)\n            this.$id = options.id;\n        if (options) {\n            this.$panel1 = options.panel1;\n            this.$panel2 = options.panel2;\n        }\n        if (options && options.container)\n            this.parent = options.container.container ? options.container.container : options.container;\n        else if (options && options.parent)\n            this.parent = options.parent;\n        else\n            this.parent = document.body;\n        if (options) {\n            if ('anchor' in options)\n                this.$anchor = options.anchor;\n            else\n                this.$anchor = PanelAnchor.panel2;\n            this.orientation = options.orientation || Orientation.horizontal;\n        }\n        else {\n            this.$anchor = PanelAnchor.panel2;\n            this.orientation = Orientation.horizontal;\n        }\n    }\n\n    get splitterWidth() { return this.$splitterWidth; }\n    set splitterWidth(value) {\n        if (this.$splitterWidth === value) return;\n        this.$splitterWidth = value;\n        this._updatePanels();\n    }\n\n    get id() { return this.$id || this.parent.id; }\n    set id(value) {\n        if (value === this.$id) return;\n        this.$id = value;\n        this.$el.id = this.id + '-splitter';\n        this.$panel1.id = this.id + '-splitter-panel1';\n        this.$panel2.id = this.id + '-splitter-panel2';\n        this.$dragBar.id = this.id + '-splitter-drag-bar';\n        if (this.$ghostBar)\n            this.$ghostBar.id = this.id + '-splitter-ghost-bar';\n    }\n\n    set parent(parent) {\n        if (typeof parent === 'string') {\n            if ((<string>parent).startsWith('#'))\n                this.$parent = document.getElementById((<string>parent).substr(1));\n            else\n                this.$parent = document.getElementById(parent);\n        }\n        else if (parent instanceof $)\n            this.$parent = parent[0];\n        else if (parent instanceof HTMLElement)\n            this.$parent = parent;\n        if (!this.$parent)\n            this.$parent = document.body;\n        this._createControl();\n    }\n\n    get parent(): HTMLElement { return this.$parent; }\n\n    get panel1(): HTMLElement { return this.$panel1; }\n\n    get panel2(): HTMLElement { return this.$panel2; }\n\n    get anchor(): PanelAnchor { return this.$anchor; }\n    set anchor(value: PanelAnchor) {\n        if (this.$anchor === value) return;\n        this.$anchor = 2;\n        this._updatePanels();\n    }\n\n    set SplitterDistance(value) {\n        if (this.$splitterDistance === value)\n            return;\n        this.$splitterDistance = value;\n        this._updatePanels();\n        this.emit('splitter-moved', value);\n    }\n    get SplitterDistance() { return this.$splitterDistance; }\n\n    set Panel1MinSize(value) {\n        if (this.$panel1MinSize === value)\n            return;\n        this.$panel1MinSize = value;\n        if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel1.clientWidth < value)\n                this.$splitterDistance = this.parent.clientWidth - this.$panel1MinSize;\n        }\n        else if (this.$panel1.clientHeight < value)\n            this.$splitterDistance = this.parent.clientHeight - this.$panel1MinSize;\n        this._updatePanels();\n    }\n    get Panel1MinSize() { return this.$panel1MinSize; }\n\n    set Panel2MinSize(value) {\n        if (this.$panel2MinSize === value)\n            return;\n        this.$panel2MinSize = value;\n        if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel2.clientWidth < value)\n                this.$splitterDistance = value;\n        }\n        else if (this.$panel2.clientHeight < value)\n            this.$splitterDistance = value;\n        this._updatePanels();\n    }\n    get Panel2MinSize() { return this.$panel2MinSize; }\n\n    get orientation(): Orientation { return this.$orientation; }\n    set orientation(value: Orientation) {\n        if (value === this.$orientation) return;\n        this.$orientation = value;\n        this._updatePanels();\n        this.resize();\n    }\n\n    get panel1Collapsed() { return this.$collapsed === 1; }\n    set panel1Collapsed(value) {\n        if (value) {\n            if (this.$collapsed === 1) return;\n            this.$collapsed = 1;\n            this.panel1.dataset.collapsed = 'true';\n            this.panel2.dataset.collapsed = 'false';\n            this.emit('collapsed', 1);\n            this._updatePanels();\n        }\n        else if (this.$collapsed === 1) {\n            this.$collapsed = 0;\n            delete this.panel1.dataset.collapsed;\n            delete this.panel2.dataset.collapsed;\n            this.emit('collapsed', 0);\n            this._updatePanels();\n        }\n    }\n\n    get panel2Collapsed() { return this.$collapsed === 2; }\n    set panel2Collapsed(value) {\n        if (value) {\n            if (this.$collapsed === 2) return;\n            this.$collapsed = 2;\n            this.panel1.dataset.collapsed = 'false';\n            this.panel2.dataset.collapsed = 'true';\n            this.emit('collapsed', 2);\n            this._updatePanels();\n        }\n        else if (this.$collapsed === 2) {\n            this.$collapsed = 0;\n            delete this.panel1.dataset.collapsed;\n            delete this.panel2.dataset.collapsed;\n            this.emit('collapsed', 0);\n            this._updatePanels();\n        }\n    }\n\n    private _updatePanels() {\n        if (this.$orientation === Orientation.horizontal) {\n            this.$panel1.style.left = '0';\n            this.$panel1.style.top = '0';\n            this.$panel1.style.right = '0';\n            this.$panel1.style.bottom = '';\n\n            this.$panel2.style.left = '0';\n            this.$panel2.style.top = '';\n            this.$panel2.style.right = '0';\n            this.$panel2.style.bottom = '0';\n\n            this.$dragBar.style.left = '0';\n            this.$dragBar.style.right = '0';\n            if (this.$anchor === PanelAnchor.panel1) {\n                this.$dragBar.style.bottom = '';\n                this.$dragBar.style.top = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            else {\n                this.$dragBar.style.top = '';\n                this.$dragBar.style.bottom = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            this.$dragBar.style.height = this.$splitterWidth + 'px';\n            this.$dragBar.style.width = '';\n            this.$dragBar.style.cursor = 'ns-resize';\n            this.$panel1.style.width = '';\n            this.$panel2.style.width = '';\n            if (this.$collapsed === 1) {\n                this.$panel1.style.display = 'none';\n                this.$panel2.style.display = '';\n                this.$panel2.style.top = '0';\n                this.$panel2.style.height = '';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$collapsed === 2) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.bottom = '0';\n                this.$panel1.style.height = '';\n                this.$panel2.style.display = 'none';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$anchor === PanelAnchor.panel1) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.height = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.top = (this.$splitterDistance) + 'px';\n                this.$panel2.style.height = '';\n                this.$dragBar.style.display = '';\n            }\n            else {\n                this.$panel1.style.display = '';\n                this.$panel1.style.bottom = this.$splitterDistance + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.height = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$dragBar.style.display = '';\n            }\n\n            this.$el.classList.remove('vertical');\n            this.$el.classList.add('horizontal');\n        }\n        else {\n            this.$panel1.style.left = '0';\n            this.$panel1.style.top = '0';\n            this.$panel1.style.right = '';\n            this.$panel1.style.bottom = '0';\n            this.$panel1.classList.remove('horizontal');\n            this.$panel1.classList.add('vertical');\n\n            this.$panel2.style.left = '';\n            this.$panel2.style.top = '0';\n            this.$panel2.style.right = '0';\n            this.$panel2.style.bottom = '0';\n            if (this.$anchor === PanelAnchor.panel1) {\n                this.$dragBar.style.right = '';\n                this.$dragBar.style.left = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            else {\n                this.$dragBar.style.left = '';\n                this.$dragBar.style.right = (this.$splitterDistance - this.$splitterWidth) + 'px';\n            }\n            this.$dragBar.style.top = '0';\n            this.$dragBar.style.bottom = '0';\n            this.$dragBar.style.width = this.$splitterWidth + 'px';\n            this.$dragBar.style.height = '';\n            this.$dragBar.style.cursor = 'ew-resize';\n            this.$panel1.style.height = '';\n            this.$panel2.style.height = '';\n            if (this.$collapsed === 1) {\n                this.$panel1.style.display = 'none';\n                this.$panel2.style.display = '';\n                this.$panel2.style.left = '0';\n                this.$panel2.style.width = '';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$collapsed === 2) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.right = '0';\n                this.$panel1.style.width = '';\n                this.$panel2.style.display = 'none';\n                this.$dragBar.style.display = 'none';\n            }\n            else if (this.$anchor === PanelAnchor.panel1) {\n                this.$panel1.style.display = '';\n                this.$panel1.style.width = (this.$splitterDistance - this.$splitterWidth) + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.left = this.$splitterDistance + 'px';\n                this.$panel2.style.width = '';\n                this.$dragBar.style.display = '';\n            }\n            else {\n                this.$panel1.style.display = '';\n                this.$panel1.style.right = this.$splitterDistance + 'px';\n                this.$panel2.style.display = '';\n                this.$panel2.style.width = this.$splitterDistance - this.$splitterWidth + 'px';\n                this.$dragBar.style.display = '';\n            }\n            this.$el.classList.remove('horizontal');\n            this.$el.classList.add('vertical');\n\n        }\n    }\n\n    private _createControl() {\n        this.$el = document.createElement('div');\n        this.$el.id = this.id + '-splitter';\n        this.$el.classList.add('splitter');\n        if (!this.$panel1) {\n            this.$panel1 = document.createElement('div');\n            this.$panel1.id = this.id + '-splitter-panel1';\n        }\n        this.$panel1.classList.add('splitter-panel', 'splitter-panel-1');\n        this.$el.appendChild(this.$panel1);\n        if (!this.$panel2) {\n            this.$panel2 = document.createElement('div');\n            this.$panel2.id = this.id + '-splitter-panel2';\n        }\n        this.$panel2.classList.add('splitter-panel', 'splitter-panel-2');\n        this.$el.appendChild(this.$panel2);\n        this.$dragBar = document.createElement('div');\n        this.$dragBar.id = this.id + '-splitter-drag-bar';\n        this.$dragBar.classList.add('spitter-drag-bar');\n        this.$el.appendChild(this.$dragBar);\n        this.$dragBar.tabIndex = 1;\n        this.$dragBar.addEventListener('mousedown', (e) => {\n            this.$dragBar.focus();\n            e.preventDefault();\n            //disable pointer events as some elements capture mouse events like iframes\n            this.$panel1.style.pointerEvents = 'none';\n            this.$panel2.style.pointerEvents = 'none';\n            this.$dragging = true;\n            this.$ghostBar = document.createElement('div');\n            this.$ghostBar.id = this.id + '-splitter-ghost-bar';\n            this.$ghostBar.classList.add('splitter-ghost-bar');\n            let bnd = this.$panel2.getBoundingClientRect();\n            if (this.$anchor === PanelAnchor.panel1)\n                bnd = this.$panel1.getBoundingClientRect();\n            if (this.$orientation === Orientation.horizontal) {\n                this.$ghostBar.style.left = '0';\n                if (this.$anchor === PanelAnchor.panel1)\n                    this.$ghostBar.style.top = (bnd.bottom - this.$elBounds.top) + 'px';\n                else\n                    this.$ghostBar.style.top = (bnd.top - this.$elBounds.top - this.$splitterWidth) + 'px';\n                this.$ghostBar.style.right = '0';\n                this.$ghostBar.style.bottom = '';\n                this.$ghostBar.style.width = '';\n                this.$ghostBar.style.height = this.$splitterWidth + 'px';\n                this.$ghostBar.style.cursor = 'ns-resize';\n            }\n            else {\n                if (this.$anchor === PanelAnchor.panel1)\n                    this.$ghostBar.style.left = (bnd.right - this.$elBounds.left) + 'px';\n                else\n                    this.$ghostBar.style.left = (bnd.left - this.$elBounds.left - this.$splitterWidth) + 'px';\n                this.$ghostBar.style.top = '0';\n                this.$ghostBar.style.bottom = '0';\n                this.$ghostBar.style.right = '';\n                this.$ghostBar.style.height = '';\n                this.$ghostBar.style.width = this.$splitterWidth + 'px';\n                this.$ghostBar.style.cursor = 'ew-resize';\n            }\n            (<any>this.$ghostBar).move = (ge) => {\n                let l;\n                if (this.$orientation === Orientation.horizontal && this.$anchor === PanelAnchor.panel1) {\n                    l = ge.pageY - this.$elBounds.top;\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.$ghostBar.style.top = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                        this.$ghostBar.style.top = (this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth) + 'px';\n                    else\n                        this.$ghostBar.style.top = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize + this.$splitterWidth)\n                            this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                        else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                            this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = l - 2 + this.$splitterWidth;\n                    }\n                }\n                else if (this.$orientation === Orientation.horizontal) {\n                    l = ge.pageY - this.$elBounds.top;\n                    if (l < this.$panel1MinSize)\n                        this.$ghostBar.style.top = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                        this.$ghostBar.style.top = (this.parent.clientHeight - this.$panel2MinSize) + 'px';\n                    else\n                        this.$ghostBar.style.top = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize)\n                            this.SplitterDistance = this.parent.clientHeight - this.$panel1MinSize;\n                        else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                            this.SplitterDistance = this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = this.parent.clientHeight - l + 2;\n                    }\n                }\n                else if (this.$orientation === Orientation.vertical && this.$anchor === PanelAnchor.panel1) {\n                    l = ge.pageX - this.$elBounds.left;\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.$ghostBar.style.left = this.$panel1MinSize + 'px';\n                    else if (l >= this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                        this.$ghostBar.style.left = (this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth) + 'px';\n                    else\n                        this.$ghostBar.style.left = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize + this.$splitterWidth)\n                            this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                        else if (l >= this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                            this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = l - 2 + this.$splitterWidth;\n                    }\n                }\n                else {\n                    l = ge.pageX - this.$elBounds.left;\n                    if (l < this.$panel1MinSize)\n                        this.$ghostBar.style.left = this.$panel1MinSize + 'px';\n                    else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                        this.$ghostBar.style.left = (this.parent.clientWidth - this.$panel2MinSize) + 'px';\n                    else\n                        this.$ghostBar.style.left = (l - 2) + 'px';\n                    if (this.live) {\n                        if (l < this.$panel1MinSize)\n                            this.SplitterDistance = this.parent.clientWidth - this.$panel1MinSize;\n                        else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                            this.SplitterDistance = this.$panel2MinSize;\n                        else\n                            this.SplitterDistance = this.parent.clientWidth - l + 2;\n                    }\n                }\n                this.emit('splitter-moving', l);\n            };\n            this.$el.appendChild(this.$ghostBar);\n            document.addEventListener('mousemove', (<any>this.$ghostBar).move);\n        });\n        this.$dragBar.addEventListener('dblclick', (e) => {\n            this.emit('dblclick', e);\n        });\n        window.addEventListener('resize', () => {\n            this.resize();\n        });\n        document.addEventListener('mouseup', (e) => {\n            if (!this.$dragging) return;\n            e.preventDefault();\n            e.stopPropagation();\n            e.cancelBubble = true;\n            let l;\n            if (this.$orientation === Orientation.horizontal) {\n                l = e.pageY - this.$elBounds.top;\n                if (this.$anchor === PanelAnchor.panel1) {\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                    else if (l > this.parent.clientHeight - this.$panel2MinSize - this.$splitterWidth)\n                        this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n                    else\n                        this.SplitterDistance = l - 2 + this.$splitterWidth;\n                }\n                else if (l < this.$panel1MinSize)\n                    this.SplitterDistance = this.parent.clientHeight - this.$panel1MinSize - 2;\n                else if (l > this.parent.clientHeight - this.$panel2MinSize)\n                    this.SplitterDistance = this.$panel2MinSize;\n                else\n                    this.SplitterDistance = this.parent.clientHeight - l + 2;\n            }\n            else {\n                l = e.pageX - this.$elBounds.left;\n                if (this.$anchor === PanelAnchor.panel1) {\n                    if (l < this.$panel1MinSize + this.$splitterWidth)\n                        this.SplitterDistance = this.$panel1MinSize + this.$splitterWidth;\n                    else if (l > this.parent.clientWidth - this.$panel2MinSize - this.$splitterWidth)\n                        this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n                    else\n                        this.SplitterDistance = l - 2 + this.$splitterWidth;\n                }\n                else if (l < this.$panel1MinSize)\n                    this.SplitterDistance = this.parent.clientWidth - this.$panel1MinSize - 2;\n                else if (l > this.parent.clientWidth - this.$panel2MinSize)\n                    this.SplitterDistance = this.$panel2MinSize;\n                else\n                    this.SplitterDistance = this.parent.clientWidth - l + 2;\n            }\n            this.$el.removeChild(this.$ghostBar);\n            document.removeEventListener('mousemove', (<any>this.$ghostBar).move);\n            this.$ghostBar = null;\n            this.$dragging = false;\n            this.$panel1.style.pointerEvents = '';\n            this.$panel2.style.pointerEvents = '';\n        });\n        this.parent.appendChild(this.$el);\n        setTimeout(() => {\n            this.$elBounds = this.$el.getBoundingClientRect();\n        }, 10);\n\n        this.$resizeObserver = new ResizeObserver((entries, observer) => {\n            if (entries.length === 0) return;\n            if (!entries[0].contentRect || entries[0].contentRect.width === 0 || entries[0].contentRect.height === 0)\n                return;\n            if (!this.$resizeObserverCache || this.$resizeObserverCache.width !== entries[0].contentRect.width || this.$resizeObserverCache.height !== entries[0].contentRect.height) {\n                this.$resizeObserverCache = { width: entries[0].contentRect.width, height: entries[0].contentRect.height };\n                this.resize();\n            }\n        });\n        this.$resizeObserver.observe(this.$el);\n        this.$observer = new MutationObserver((mutationsList) => {\n            let mutation;\n            for (mutation of mutationsList) {\n                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {\n                    if (mutation.oldValue === 'display: none;')\n                        this.resize();\n                }\n            }\n        });\n        this.$observer.observe(this.$el, { attributes: true, attributeOldValue: true, attributeFilter: ['style'] });\n    }\n\n    public resize() {\n        if (this.$orientation === Orientation.horizontal && this.$anchor === PanelAnchor.panel1) {\n            if (this.$panel2.clientHeight && this.$panel2.clientHeight < this.$panel2MinSize && this.$panel1.clientHeight > this.$panel1MinSize)\n                this.SplitterDistance = this.parent.clientHeight - this.$panel2MinSize;\n        }\n        else if (this.$orientation === Orientation.horizontal) {\n            if (this.$panel1.clientHeight && this.$panel1.clientHeight < this.$panel1MinSize && this.$panel2.clientHeight > this.$panel2MinSize)\n                this.SplitterDistance = this.$panel1MinSize;\n        }\n        else if (this.$orientation === Orientation.vertical && this.$anchor === PanelAnchor.panel1) {\n            if (this.$panel2.clientWidth && this.$panel2.clientWidth < this.$panel2MinSize && this.$panel1.clientWidth > this.$panel1MinSize)\n                this.SplitterDistance = this.parent.clientWidth - this.$panel2MinSize;\n        }\n        else if (this.$panel1.clientWidth < this.$panel1MinSize && this.$panel2.clientWidth > this.$panel2MinSize)\n            this.SplitterDistance = this.$panel1MinSize;\n        this.$elBounds = this.$el.getBoundingClientRect();\n    }\n}\n", "//spell-checker:words keycode\nimport '../css/profiles.search.css';\nimport { EventEmitter } from '../core/events';\nimport { ProfilesDialog, GetDisplay } from './profilesdialog';\n/**\n * Simple search box dialog\n *\n * @export\n * @class Search\n * @extends {EventEmitter}\n */\nexport class ProfileSearch extends EventEmitter {\n    private $parent;\n    private _control;\n\n    private _timer;\n    private _results;\n    private _position;\n    private _case;\n    private _word;\n    private _reverse;\n    private _regex;\n    private _key;\n    private _value;\n\n    public manager: ProfilesDialog;\n\n    constructor(manager, parent?) {\n        super();\n        this.parent = parent;\n        this.manager = manager;\n        this.createControl();\n        this._key = (e) => {\n            if (e.keyCode === 27) { // escape key maps to keycode `27`\n                this.hide();\n            }\n        };\n        window.document.addEventListener('keyup', this._key.bind(this));\n\n        this._control.on('keydown', (e) => {\n            if (e.keyCode !== 8) return;\n            clearTimeout(this._timer);\n            //delay find update to try and batch group text updates ot improve speeds, make regex a little slower as regex can be more complex\n            this._timer = setTimeout(() => { this.find(true); }, this._regex ? 500 : 250);\n        });\n\n        this._control.on('keypress', () => {\n            clearTimeout(this._timer);\n            //delay find update to try and batch group text updates ot improve speeds, make regex a little slower as regex can be more complex\n            this._timer = setTimeout(() => { this.find(true); }, this._regex ? 500 : 250);\n        });\n\n        this._control.on('paste', (e) => {\n            clearTimeout(this._timer);\n            //delay find update to try and batch group text updates ot improve speeds, make regex a little slower as regex can be more complex\n            this._timer = setTimeout(() => { this.find(true); }, this._regex ? 500 : 250);\n        });\n\n        this._control.on('cut', (e) => {\n            clearTimeout(this._timer);\n            //delay find update to try and batch group text updates ot improve speeds, make regex a little slower as regex can be more complex\n            this._timer = setTimeout(() => { this.find(true); }, this._regex ? 500 : 250);\n        });\n\n    }\n\n    get id() {\n        if (!this.parent) return '';\n        return this.parent.id;\n    }\n\n    set parent(parent) {\n        if (typeof parent === 'string') {\n            if ((<string>parent).startsWith('#'))\n                this.$parent = document.getElementById((<string>parent).substr(1));\n            else\n                this.$parent = document.getElementById(parent);\n        }\n        else if (parent instanceof $)\n            this.$parent = parent[0];\n        else if (parent instanceof HTMLElement)\n            this.$parent = parent;\n        if (!this.$parent)\n            this.$parent = document.body;\n    }\n\n    get parent(): HTMLElement { return this.$parent; }\n\n    get MatchCase(): boolean {\n        return this._case;\n    }\n\n    set MatchCase(value: boolean) {\n        if (value !== this._case) {\n            this._case = value;\n            if (this._case)\n                $('#' + this.id + '-find-case', this._control).addClass('active');\n            else\n                $('#' + this.id + '-find-case', this._control).removeClass('active');\n            this.find(true);\n            this.emit('case');\n        }\n    }\n\n    get RegularExpression(): boolean {\n        return this._regex;\n    }\n\n    set RegularExpression(value: boolean) {\n        if (value !== this._regex) {\n            this._regex = value;\n            if (this._regex)\n                $('#' + this.id + '-find-regex', this._control).addClass('active');\n            else\n                $('#' + this.id + '-find-regex', this._control).removeClass('active');\n            this.find(true);\n            this.emit('regex');\n        }\n    }\n\n    get MatchWord(): boolean {\n        return this._word;\n    }\n\n    set MatchWord(value: boolean) {\n        if (value !== this._word) {\n            this._word = value;\n            if (this._word)\n                $('#' + this.id + '-find-word', this._control).addClass('active');\n            else\n                $('#' + this.id + '-find-word', this._control).removeClass('active');\n            this.find(true);\n            this.emit('word');\n        }\n    }\n\n    get Reverse(): boolean {\n        return this._reverse;\n    }\n\n    set Reverse(value: boolean) {\n        if (value !== this._reverse) {\n            this._reverse = value;\n            if (this._reverse) {\n                $('#' + this.id + '-find-reverse', this._control).addClass('active');\n                $('#' + this.id + '-find-next', this._control).html('<i class=\"bi bi-arrow-up\"></i>');\n                $('#' + this.id + '-find-prev', this._control).html('<i class=\"bi bi-arrow-down\"></i>');\n            }\n            else {\n                $('#' + this.id + '-find-reverse', this._control).removeClass('active');\n                $('#' + this.id + '-find-next', this._control).html('<i class=\"bi bi-arrow-down\"></i>');\n                $('#' + this.id + '-find-prev', this._control).html('<i class=\"bi bi-arrow-up\"></i>');\n            }\n            this._position = this._results.length - this._position - 1;\n            this.updateButtons();\n            this.updateCount();\n            this.find(true);\n            this.emit('reverse');\n        }\n    }\n\n    get SearchValue(): boolean {\n        return this._value;\n    }\n\n    set SearchValue(value: boolean) {\n        if (value !== this._value) {\n            this._value = value;\n            if (this._value)\n                $('#' + this.id + '-find-value', this._control).addClass('active');\n            else\n                $('#' + this.id + '-find-value', this._control).removeClass('active');\n            this.find(true);\n            this.emit('value');\n        }\n    }\n\n    private createControl() {\n        this._control = $('<div id=\"' + this.id + '-find\" class=\"find\"><div class=\"input-group flex-grow-1\" style=\"width: auto;\"><input placeholder=\"Find\" class=\"form-control\" /><button id=\"' + this.id + '-find-case\" title=\"Match Case\" class=\"find-case btn btn-outline-secondary\">Aa</button><button id=\"' + this.id + '-find-word\" title=\"Match Whole Word\" class=\"find-word btn btn-outline-secondary\">Aa|</button><button id=\"' + this.id + '-find-regex\" title=\"Use Regular Expression\" class=\"find-regex btn btn-outline-secondary\">.*</button><button id=\"' + this.id + '-find-value\" title=\"Search values\" class=\"find-value btn btn-outline-secondary\"><i class=\"bi bi-code\"></i></button></div><div id=\"' + this.id + '-find-count\" class=\"find-count flex-grow-1\"></div><div class=\"btn-group me-1\" role=\"group\" aria-label=\"Find navigation\"><button id=\"' + this.id + '-find-prev\" title=\"Previous Match\" disabled=\"disabled\" class=\"find-prev btn btn-outline-secondary\"><i class=\"bi bi-arrow-up\"></i></button><button id=\"' + this.id + '-find-next\" title=\"Next Match\" disabled=\"disabled\" class=\"find-next btn btn-outline-secondary\"><i class=\"bi bi-arrow-down\"></i></button><button id=\"' + this.id + '-find-selection\" title=\"Find in selection\" disabled=\"disabled\" class=\"find-selection btn btn-outline-secondary\"><i class=\"fa fa-align-left\"></i></button><button id=\"' + this.id + '-find-reverse\" title=\"Search Up\" class=\"find-reverse btn btn-outline-secondary\"><i class=\"bi bi-caret-up-fill\"></i></button></div><button id=\"' + this.id + '-find-close\" title=\"Close\" class=\"find-close btn btn-secondary\"><i class=\"bi bi-x-lg\"></i></button></div>');\n        $('#' + this.id + '-find-close', this._control).on('click', () => {\n            this.hide();\n        });\n        $('#' + this.id + '-find-prev', this._control).on('click', () => {\n            this.gotoPrevious();\n        });\n        $('#' + this.id + '-find-next', this._control).on('click', () => {\n            this.gotoNext();\n        });\n        $('#' + this.id + '-find-case', this._control).on('click', () => {\n            this.MatchCase = !this.MatchCase;\n        });\n        $('#' + this.id + '-find-word', this._control).on('click', () => {\n            this.MatchWord = !this.MatchWord;\n        });\n        $('#' + this.id + '-find-reverse', this._control).on('click', () => {\n            this.Reverse = !this.Reverse;\n        });\n        $('#' + this.id + '-find-regex', this._control).on('click', () => {\n            this.RegularExpression = !this.RegularExpression;\n        });\n        $('#' + this.id + '-find-value', this._control).on('click', () => {\n            this.SearchValue = !this.SearchValue;\n        });\n        this.$parent.insertAdjacentElement('afterbegin', this._control[0]);\n    }\n\n    public show(selection?) {\n        this._control.css('display', 'flex');\n        if (selection && selection.length)\n            $('input', this._control).val(selection);\n        $('input', this._control).focus().select();\n        this.find();\n        this.emit('shown');\n    }\n\n    public get open() {\n        return this._control.css('display') !== 'none';\n    }\n\n    public hide() {\n        this._control.css('display', 'none');\n        $('input', this._control).val('');\n        this.clear();\n        this.emit('closed');\n    }\n\n    public find(focus?: boolean) {\n        const val = <string>$('input', this._control).val();\n        this.clear();\n        if (val.length === 0) {\n            this.updateCount();\n            this.emit('found-results', this._results);\n            return;\n        }\n\n        if (!this.manager.profiles.length) {\n            this.updateCount();\n            this.emit('found-results', this._results);\n            return;\n        }\n        let pattern;\n        if (this._regex)\n            pattern = val;\n        else\n            pattern = val.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n        let re;\n        if (this._word)\n            pattern = '\\\\b' + pattern + '\\\\b';\n        if (this._case)\n            re = new RegExp(pattern, 'g');\n        else\n            re = new RegExp(pattern, 'gi');\n        let items = [];\n        let m;\n        let i;\n        let il;\n        let item;\n        const profiles = Object.values<any>(this.manager.profiles.items);\n        for (let p = 0, pl = profiles.length; p < pl; p++) {\n            let profile = profiles[p];\n            m = re.exec(profile.name);\n            const key = 'profiles/' + encodeURIComponent(profile.name.toLowerCase());\n            if (m) {\n                items.push({\n                    key: key,\n                });\n            }\n            il = profile.aliases.length;\n            for (i = 0; i < il; i++) {\n                item = profile.aliases[i];\n                if (this.matchItem(re, item) || re.exec(item.pattern))\n                    items.push({ key: key + '/aliases/' + i });\n            }\n            il = profile.macros.length;\n            for (i = 0; i < il; i++) {\n                item = profile.macros[i];\n                if (this.matchItem(re, item))\n                    items.push({ key: key + '/macros/' + i });\n            }\n            il = profile.triggers.length;\n            for (i = 0; i < il; i++) {\n                item = profile.triggers[i];\n                if (this.matchItem(re, item) || re.exec(item.pattern))\n                    items.push({ key: key + '/triggers/' + i });\n                else if (item.triggers.length) {\n                    for (let t = 0, tl = item.triggers.length; t < tl; t++)\n                        if (this.matchItem(re, item.triggers[t]) || re.exec(item.triggers[t].pattern))\n                            items.push({ key: `${key}/triggers/${i}/${t + 1}` });\n                }\n            }\n            il = profile.buttons.length;\n            for (i = 0; i < il; i++) {\n                item = profile.buttons[i];\n                if (this.matchItem(re, item) || re.exec(item.caption))\n                    items.push({ key: key + '/buttons/' + i });\n            }\n            il = profile.contexts.length;\n            for (i = 0; i < il; i++) {\n                item = profile.contexts[i];\n                if (this.matchItem(re, item) || re.exec(item.caption))\n                    items.push({ key: key + '/contexts/' + i });\n            }\n        }\n        this._results.push.apply(this._results, items);\n\n        if (this.Reverse)\n            this._results.reverse();\n        this.gotoResult(0, focus);\n        this.emit('found-results', this._results);\n    }\n\n    private matchItem(re, item) {\n        if (re.exec(item.name))\n            return true;\n        if (re.exec(GetDisplay(item)))\n            return true;\n        if (this._value && re.exec(item.value))\n            return true;\n        return false;\n    }\n\n    public gotoNext() {\n        this._position++;\n        this.gotoResult(this._position, true);\n    }\n\n    public gotoPrevious() {\n        this._position--;\n        this.gotoResult(this._position, true);\n    }\n\n    public gotoCurrent() {\n        this.gotoResult(this._position, true);\n    }\n\n    public gotoResult(idx: number, focus?: boolean) {\n        if (!this.manager.profiles.length) return;\n        if (idx < 0) idx = 0;\n        if (idx >= this._results.length)\n            idx = this._results.length - 1;\n        this._position = idx;\n        this.updateCount();\n        if (this._results.length > 0) {\n            const r = this._results[idx];\n            this.manager.loadPage(r.key);\n        }\n        setTimeout(() => { this.emit('moved', this._position, idx); }, 0);\n        this.updateButtons();\n    }\n\n    public clear() {\n        this._results = [];\n        this._position = 0;\n        this.updateButtons();\n        this.emit('reset');\n    }\n\n    private updateButtons() {\n        if (this._position >= this._results.length - 1)\n            $('#' + this.id + '-find-next', this._control).prop('disabled', true);\n        else\n            $('#' + this.id + '-find-next', this._control).prop('disabled', false);\n        if (this._position === 0 || this._results.length === 0)\n            $('#' + this.id + '-find-prev', this._control).prop('disabled', true);\n        else\n            $('#' + this.id + '-find-prev', this._control).prop('disabled', false);\n    }\n\n    private updateCount() {\n        if (this._results.length === 0)\n            $('#' + this.id + '-find-count', this._control).html('<span class=\\'find-no-results\\'>No Results</span>');\n        else if (this._results.length > 999)\n            $('#' + this.id + '-find-count', this._control).html((this._position + 1) + ' of 999+');\n        else\n            $('#' + this.id + '-find-count', this._control).html((this._position + 1) + ' of ' + this._results.length);\n    }\n\n    public dispose() {\n        this._control.remove();\n        window.document.removeEventListener('keyup', this._key);\n    }\n}", "import '../css/nav.css';\nimport '../css/profiles.css';\nimport { Dialog, DialogButtons, DialogIcon } from './dialog';\nimport { Splitter, Orientation, PanelAnchor } from './splitter';\nimport { capitalize, openFileDialog, readFile, keyCodeToChar, keyCharToCode, scrollChildIntoView, debounce, FilterArrayByKeyValue, htmlEncode } from '../core/library';\nimport { removeHash, updateHash } from './interface';\nimport { ProfileCollection, MacroDisplay, Profile, Alias, Trigger, Button, Macro, Context } from '../core/profile';\nimport { buildBreadcrumb } from './breadcrumb';\nimport { ProfileSearch } from './profilesdialog.search';\n\ndeclare let confirm_box;\ndeclare let fileSaveAs;\ndeclare let alert_box;\n\nenum ClipAction {\n    cut, copy\n}\n\nexport class ProfilesDialog extends Dialog {\n    private _client;\n    private _menu;\n    private _contents;\n    private _splitter;\n    private _page;\n    private _contentPage;\n    public profiles: ProfileCollection;\n    private _profilesChanged = false;\n    private _outsideChange = false;\n    private _errorField;\n    private _current = {\n        profile: null,\n        profileName: '',\n        item: null,\n        parent: null,\n        itemIdx: -1,\n        collection: '',\n        itemSubIdx: -1\n    }\n    private _canClose: boolean = false;\n    private _small: boolean = false;\n    private _clip;\n    private _clipId;\n    private _search;\n\n    public set errorField(value) {\n        this._errorField = value;\n    }\n    public get errorField() { return this._errorField; }\n\n    public get current() { return this._current; }\n\n    public set changed(value) {\n        if (value === this._profilesChanged) return;\n        this._profilesChanged = value;\n        this.footer.querySelector(`#${this.id}-save`).disabled = !value;\n        this.footer.querySelector(`#${this.id}-apply`).disabled = !value;\n\n    }\n    public get changed() { return this._profilesChanged }\n\n    public get contents() { return this._contents; }\n\n    constructor() {\n        super(Object.assign({}, client.getWindowState('profiles') || { center: true }, { id: 'profiles', title: '<i class=\"fas fa-users\"></i> Profiles', minWidth: 550, minHeight: 350 }));\n        this._client = client;\n        this.on('resized', e => {\n            this._updateSmall(e.width);\n            this._client.setOption('windows.profiles', e);\n        })\n        this._client.on('profiles-loaded', () => {\n            if (!this.profiles) {\n                this.profiles = this._client.profiles.clone();\n                this.profiles.SortByPriority();\n                this._buildMenu();\n            }\n        });\n        this._client.on('profiles-updated', () => {\n\n        });\n        this._client.on('options-loaded', () => {\n            this.resetState(this._client.getWindowState('profiles') || { center: true });\n        })\n        this._client.on('initialized', () => {\n            if (!this.profiles) {\n                this.profiles = this._client.profiles.clone();\n                this.profiles.SortByPriority();\n                this._buildMenu();\n            }\n        });\n        this._client.on('item-added', (type, profileName, index, item) => {\n            if (!this._client.getOption('profiles.updateOnChange'))\n                this._outsideChange = true;\n            else if (this.profiles.contains(profileName))\n                this._addItem(type + (type === 'alias' ? 'es' : 's'), item, this.profiles.items[profileName]);\n\n        });\n        this._client.on('item-removed', (type, profileName, index, item) => {\n            if (!this._client.getOption('profiles.updateOnChange'))\n                this._outsideChange = true;\n            else if (this.profiles.contains(profileName)) {\n                let collection = type + (type === 'alias' ? 'es' : 's');\n                let profile = this.profiles.items[profileName];\n                if (index < 0 || index >= profile[collection].length || !profile[collection][index].equals(item)) return;\n                const id = `${this._sanitizeID(profileName)}-${collection}`;\n                const items = profile[collection];\n                items.splice(index, 1);\n                this._menu.querySelector(`#${id}-${index}`).remove();\n                if (this._current.itemIdx === -1)\n                    this.setBody(this._page);\n                if (items.length === 0) {\n                    this._menu.querySelector(`#${id} i`).remove();\n                    this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\n                    if (this._menu.querySelector(`#${id} a`).dataset.lazy !== 'true')\n                        this._menu.querySelector(`#${id} .dropdown-menu`).innerHTML = '';\n                }\n                else {\n                    const menuItems = this._menu.querySelector(`#${id} ul`);\n                    let i = menuItems.children.length;\n                    const href = `#profiles/${encodeURIComponent(profileName)}/${collection}/`;\n                    for (; index < i; index++) {\n                        const item = menuItems.children[index];\n                        item.id = `${id}-${index}`;\n                        item.firstChild.href = `${href}${index}`;\n                        item.firstChild.children[1].id = `enabled-${id}-${index}`;\n                    }\n                }\n                this.changed = true;\n                if (id === this._clipId)\n                    this._resetClip(true);\n            }\n        });\n        this._client.on('item-updated', (type, profileName, index, item) => {\n            if (!this._client.getOption('profiles.updateOnChange'))\n                this._outsideChange = true;\n            else if (this.profiles.contains(profileName)) {\n                let collection = type + (type === 'alias' ? 'es' : 's');\n                let profile = this.profiles.items[profileName];\n                if (index < 0 || index >= profile[collection].length) return;\n                profile[collection][index] = item;\n                if (this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-${this._current.collection}-${index}`))\n                    this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-${this._current.collection}-${index}`).checked = item.enabled;\n                if (this._current.profileName === profileName && collection === this._current.collection && this._current.itemIdx === index)\n                    this.loadPage(this._page);\n            }\n        });\n        this.body.style.padding = '10px';\n        this._splitter = new Splitter({ id: 'profile', parent: this.body, orientation: Orientation.vertical, anchor: PanelAnchor.panel1 });\n        if (this._client.getOption('profiles.split') >= 200)\n            this._splitter.SplitterDistance = this._client.getOption('profiles.split');\n        this._splitter.on('splitter-moved', distance => {\n            this._client.setOption('profiles.split', distance);\n        });\n        this._menu = this._splitter.panel1;\n        this._menu.style.overflow = 'hidden';\n        this._menu.style.overflowY = 'auto';\n        this._contents = this._splitter.panel2;\n        this._contents.style.overflow = 'auto';\n        this._contents.style.padding = '10px';\n        this._contents.style.paddingLeft = '14px';\n        if (this._client.profiles) {\n            this.profiles = this._client.profiles.clone();\n            this.profiles.SortByPriority();\n            this._buildMenu();\n        }\n        let footer = '';\n        footer += `<button id=\"${this.id}-back\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Go back\"><i class=\"bi bi-arrow-left\"></i><span class=\"icon-only\"> Back</span></button>`;\n        footer += `<button id=\"btn-profile-menu\" class=\"btn-sm float-start btn btn-outline-secondary\" type=\"button\" aria-controls=\"profile-menu\" title=\"Show menu\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" style=\"margin-right: 4px;\"><i class=\"fa-solid fa-bars\"></i></button>`;\n        footer += `<ul id=\"${this.id}-dropdown-menu\" class=\"dropdown-menu\" style=\"overflow: auto;\">`;\n        footer += `<li id=\"${this.id}-add-profile\"><a class=\"dropdown-item\">Add profile</a></li>`;\n        footer += `<li id=\"${this.id}-add-empty-profile\"><a class=\"dropdown-item\">Add empty profile</a></li>`;\n        footer += `<li id=\"${this.id}-add-sep\"><hr class=\"dropdown-divider\"></li>`;\n        footer += `<li id=\"${this.id}-add-alias\"><a class=\"dropdown-item\">Add alias</a></li>`;\n        footer += `<li id=\"${this.id}-add-macro\"><a class=\"dropdown-item\">Add macro</a></li>`;\n        footer += `<li id=\"${this.id}-add-trigger\"><a class=\"dropdown-item\">Add trigger</a></li>`;\n        footer += `<li id=\"${this.id}-add-button\"><a class=\"dropdown-item\">Add button</a></li>`;\n        footer += `<li id=\"${this.id}-add-sep2\"><hr class=\"dropdown-divider\"></li>`;\n        footer += `<li id=\"${this.id}-add-default-buttons\"><a class=\"dropdown-item\">Add default buttons</a></li>`;\n        footer += `<li id=\"${this.id}-add-default-macros\"><a class=\"dropdown-item\">Add default macros</a></li>`;\n        footer += '<li><hr class=\"dropdown-divider\"></li>';\n        footer += `<li id=\"${this.id}-export-current\"><a class=\"dropdown-item\">Export current profile</a></li>`;\n        footer += `<li id=\"${this.id}-export\"><a class=\"dropdown-item\">Export profiles</a></li>`;\n        footer += `<li id=\"${this.id}-import\"><a class=\"dropdown-item\">Import profiles</a></li>`;\n        footer += '<li><hr class=\"dropdown-divider\"></li>';\n        footer += `<li id=\"${this.id}-refresh\"><a class=\"dropdown-item\">Refresh</a></li>`;\n        footer += `<li id=\"${this.id}-reload\"><a class=\"dropdown-item\">Reload</a></li>`;\n        footer += '</ul>';\n        footer += `<button id=\"btn-profile-edit-menu\" class=\"btn-sm float-start btn btn-outline-secondary\" type=\"button\" aria-controls=\"edit-menu\" title=\"Show edit menu\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" style=\"margin-right: 4px;\"><i class=\"bi bi-pencil-square\"></i></button>`;\n        footer += `<ul id=\"${this.id}-edit-menu\" class=\"dropdown-menu\" style=\"overflow: auto;\">`;\n        footer += `<li id=\"${this.id}-find\"><a class=\"dropdown-item\">Find <span class=\"float-end\" style=\"padding-left: 40px;\">(Ctrl or Cmd)+F</span></a></li>`;\n        footer += `<li id=\"${this.id}-find-div\"><hr class=\"dropdown-divider\"></li>`;\n        footer += `<li id=\"${this.id}-cut\"><a class=\"dropdown-item\">Cut <span class=\"float-end\" style=\"padding-left: 40px;\">(Ctrl or Cmd)+X</span></a></li>`;\n        footer += `<li id=\"${this.id}-copy\"><a class=\"dropdown-item\">Copy <span class=\"float-end\" style=\"padding-left: 40px;\">(Ctrl or Cmd)+C</span></a></li>`;\n        footer += `<li id=\"${this.id}-paste\"><a class=\"dropdown-item\">Paste <span class=\"float-end\" style=\"padding-left: 40px;\">(Ctrl or Cmd)+V</span></a></li>`;\n        footer += '</ul>';\n        footer += '<span id=\"profile-page-buttons\"></span>';\n        footer += `<button id=\"${this.id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Close dialog\"><i class=\"bi bi-x-lg\"></i><span class=\"icon-only\"> Cancel</span></button>`;\n        footer += `<button id=\"${this.id}-save\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Save changes\" disabled><i class=\"bi bi-save\"></i><span class=\"icon-only\"> Save</span></button>`;\n        footer += `<button id=\"${this.id}-apply\" type=\"button\" class=\"btn-sm float-end btn btn-secondary\" title=\"Apply changes\" disabled><i class=\"bi bi-check-lg\"></i><span class=\"icon-only\"> Apply</span></button>`;\n        this.footer.id = 'profiles-footer';\n        this.footer.innerHTML = footer;\n        this.footer.classList.add('dropup');\n\n        document.getElementById('btn-profile-menu').addEventListener('shown.bs.dropdown', () => {\n            setTimeout(() => {\n                let el = this.footer.querySelector('#' + this.id + '-dropdown-menu');\n                let rect = el.getBoundingClientRect();\n                if (rect.y < 10)\n                    el.style.height = (rect.height + rect.y - 10) + 'px';\n                if (rect.bottom > document.body.clientHeight - 10)\n                    el.style.height = (document.body.clientHeight - rect.y - 10) + 'px';\n            }, 0);\n        })\n\n        document.getElementById('btn-profile-menu').addEventListener('hidden.bs.dropdown', () => {\n            let el = this.footer.querySelector('#' + this.id + '-dropdown-menu');\n            el.style.height = '';\n        });\n        this.footer.querySelector(`#${this.id}-cancel`).addEventListener('click', () => {\n            removeHash(this._page);\n            this.close();\n        });\n        this.footer.querySelector(`#${this.id}-back`).addEventListener('click', () => {\n            this._goBack();\n        });\n        this.footer.querySelector(`#${this.id}-cut`).addEventListener('click', () => {\n            this._cutItem();\n        });\n        this.footer.querySelector(`#${this.id}-copy`).addEventListener('click', () => {\n            this._copyItem();\n        });\n        this.footer.querySelector(`#${this.id}-paste`).addEventListener('click', () => {\n            this._paste();\n        });\n        this.footer.querySelector(`#${this.id}-find`).addEventListener('click', () => {\n            this._search.show();\n        });\n        this.on('closed', () => {\n            this._client.setOption('windows.profiles', this.windowState);\n            removeHash(this._page);\n        });\n        this.on('canceled', () => {\n            this._client.setOption('windows.profiles', this.windowState);\n            removeHash(this._page);\n        });\n        this.on('moved', e => {\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\n            this._client.setOption('windows.profiles', e);\n        })\n        this.on('maximized', () => {\n            this._client.setOption('windows.profiles', this.windowState);\n        });\n        this.on('restored', () => {\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\n            this._client.setOption('windows.profiles', this.windowState);\n        });\n        this.on('shown', () => {\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\n            this._client.setOption('windows.profiles', this.windowState);\n        });\n        this.footer.querySelector(`#${this.id}-add-profile a`).addEventListener('click', () => {\n            this._createProfile(true);\n        });\n\n        this.footer.querySelector(`#${this.id}-add-empty-profile a`).addEventListener('click', () => {\n            this._createProfile(false);\n        });\n        this.footer.querySelector(`#${this.id}-add-alias a`).addEventListener('click', () => {\n            this._addItem('aliases');\n        });\n        this.footer.querySelector(`#${this.id}-add-macro a`).addEventListener('click', () => {\n            this._addItem('macros');\n        });\n        this.footer.querySelector(`#${this.id}-add-trigger a`).addEventListener('click', () => {\n            this._addItem('triggers');\n        });\n        this.footer.querySelector(`#${this.id}-add-button a`).addEventListener('click', () => {\n            this._addItem('buttons');\n        });\n        this.footer.querySelector(`#${this.id}-add-default-buttons a`).addEventListener('click', () => {\n            const items = Profile.DefaultButtons;\n            let il = items.length;\n            for (let i = 0; i < il; i++)\n                this._addItem('buttons', items[i]);\n\n        });\n        this.footer.querySelector(`#${this.id}-add-default-macros a`).addEventListener('click', () => {\n            const items = Profile.DefaultMacros;\n            let il = items.length;\n            for (let i = 0; i < il; i++)\n                this._addItem('macros', items[i]);\n        });\n        this.footer.querySelector(`#${this.id}-export-current a`).addEventListener('click', () => {\n            const data = {\n                version: 2, profiles: {}\n            };\n            data.profiles[this._current.profileName] = this._current.profile.clone(2);\n            fileSaveAs.show(JSON.stringify(data), `oiMUD.${this._current.profileName}.txt`, 'text/plain');\n        });\n        this.footer.querySelector(`#${this.id}-export a`).addEventListener('click', () => {\n            const data = {\n                version: 2, profiles: this.profiles.clone(2)\n            };\n            fileSaveAs.show(JSON.stringify(data), 'oiMUD.profiles.txt', 'text/plain');\n        });\n        this.footer.querySelector(`#${this.id}-import a`).addEventListener('click', () => {\n            openFileDialog('Import profile(s)').then(files => {\n                readFile(files[0]).then((contents: any) => {\n                    try {\n                        let data = JSON.parse(contents);\n                        if (data.version == 2) {\n                            if (data.profiles) {\n                                let keys = Object.keys(data.profiles);\n                                let k = 0, kl = keys.length;\n                                for (; k < kl; k++) {\n                                    //set the new name\n                                    data.profiles[keys[k]].name = this._profileCopyName(keys[k]);\n                                    //load the profile\n                                    const p = Profile.load(data.profiles[keys[k]]);\n                                    //add to collection\n                                    this.profiles.add(p);\n                                }\n                                //no profiles so just bail\n                                if (kl === 0) return;\n                                this.changed = true;\n                                //rebuild the menu as could have added multiple profiles or not and this ensures ordered correctly by priority\n                                this._buildMenu();\n                                //reselect current item\n                                this.expandPath(this._page);\n                            }\n                        }\n                        else\n                            setTimeout(function () {\n                                alert_box('Invalid file', 'Unable to import file, not a valid profile file', DialogIcon.exclamation);\n                            }, 50);\n                    }\n                    catch (err) {\n                        setTimeout(function () {\n                            alert_box('Error importing', 'Error importing file.', DialogIcon.error);\n                        }, 50);\n                        this._client.error(err);\n                    }\n                }).catch(this._client.error);\n            }).catch(() => { });\n        });\n        this.footer.querySelector(`#${this.id}-refresh a`).addEventListener('click', () => {\n            this._buildMenu();\n            this.setBody(this._page);\n        });\n\n        this.footer.querySelector(`#${this.id}-reload a`).addEventListener('click', () => {\n            if (this.changed) {\n                confirm_box('Reload profiles?', `Reload and lose changes?`).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        this.profiles = this._client.profiles.clone();\n                        this.profiles.SortByPriority();\n                        this._buildMenu();\n                        this.setBody(this._page);\n                    }\n                })\n            }\n            else {\n                this.profiles = this._client.profiles.clone();\n                this.profiles.SortByPriority();\n                this._buildMenu();\n                this.setBody(this._page);\n            }\n        });\n\n        this.footer.querySelector(`#${this.id}-save`).addEventListener('click', () => {\n            if (this._errorField) {\n                this._errorField.focus();\n                return;\n            }\n            if (this._outsideChange) {\n                confirm_box('Profiles changed', `Profiles have been changed outside of manager, overwrite?`, null, DialogButtons.YesNo).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        this._save();\n                        this.close();\n                        this._outsideChange = false;\n                    }\n                });\n            }\n            else {\n                this._save();\n                this.close();\n            }\n        });\n        this.footer.querySelector(`#${this.id}-apply`).addEventListener('click', () => {\n            if (this._errorField) {\n                this._errorField.focus();\n                return;\n            }\n            if (this._outsideChange) {\n                confirm_box('Profiles changed', `Profiles have been changed outside of manager, overwrite?`, null, DialogButtons.YesNo).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        this._save();\n                        this._outsideChange = false;\n                    }\n                });\n            }\n            else\n                this._save();\n        });\n        this.dialog.addEventListener('keydown', e => {\n            if (e.ctrlKey && !e.shiftKey && !e.altKey && !e.metaKey) {\n                if (e.code === 'KeyF') {\n                    const sOpen = this._search.open;\n                    this._search.show();\n                    //if it was not open prevent browser find open for first time\n                    if (!sOpen) {\n                        e.preventDefault();\n                        e.returnValue = false;\n                        return false;\n                    }\n                    return true;\n                }\n                if (document.activeElement) {\n                    if (document.activeElement.nodeName === 'TEXTAREA' || (document.activeElement as HTMLElement).isContentEditable)\n                        return;\n                    if (document.activeElement.nodeName === 'INPUT' && (document.activeElement as HTMLInputElement).type !== 'checkbox' && (document.activeElement as HTMLInputElement).type !== 'radio')\n                        return\n                }\n                if (e.code === 'KeyC') {\n                    this._copyItem();\n                    e.preventDefault();\n                    e.returnValue = false;\n                    return false;\n                }\n                else if (e.code === 'KeyX') {\n                    this._cutItem();\n                    e.preventDefault();\n                    e.returnValue = false;\n                    return false;\n                }\n                else if (e.code === 'KeyV' && this._clip) {\n                    this._paste();\n                    e.preventDefault();\n                    e.returnValue = false;\n                    return false;\n                }\n            }\n\n        });\n        this._search = new ProfileSearch(this, this.footer);\n        this._search.MatchCase = this._client.getOption('profiles.find.case');\n        this._search.MatchWord = this._client.getOption('profiles.find.word');\n        this._search.Reverse = this._client.getOption('profiles.find.reverse');\n        this._search.RegularExpression = this._client.getOption('profiles.find.regex');\n        this._search.SearchValue = this._client.getOption('profiles.find.value');\n        if (this._client.getOption('profiles.find.show'))\n            this._search.show();\n        this._search.on('word', () => {\n            this._client.setOption('profiles.find.word', this._search.MatchWord);\n        });\n        this._search.on('case', () => {\n            this._client.setOption('profiles.find.case', this._search.MatchCase);\n        });\n        this._search.on('reverse', () => {\n            this._client.setOption('profiles.find.reverse', this._search.Reverse);\n        });\n        this._search.on('regex', () => {\n            this._client.setOption('profiles.find.regex', this._search.RegularExpression);\n        });\n        this._search.on('value', () => {\n            this._client.setOption('profiles.find.value', this._search.SearchValue);\n        });\n        this._search.on('shown', () => {\n            this._client.setOption('profiles.find.show', true);\n        });\n        this._search.on('closed', () => {\n            this._client.setOption('profiles.find.show', false);\n        });\n    }\n\n    private _getItem(collection, index, idPrefix, hrefPrefix, indent?) {\n        if (!collection || collection.length === 0) return '';\n        let menu = '';\n        indent = indent || 0;\n        let padding = indent * 20 + 16;\n        const id = `${idPrefix + '-' + (collection[index].useName ? this._sanitizeID(collection[index].name.toLowerCase()) : index)}`;\n        menu += `<li class=\"nav-item${this._clipId === id ? ' cut-item' : ''}\" title=\"${htmlEncode(GetDisplay(collection[index]))}\" id=\"${id}\">`;\n        if (collection[index].items && collection[index].items.length)\n            menu += `<a data-indent=\"${indent}\" data-id=\"${idPrefix + '-' + this._sanitizeID(collection[index].name.toLowerCase())}\" data-lazy=\"true\" style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\"><i class=\"align-middle float-start bi bi-chevron-right\"></i> <input data-page=\"${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\" type=\"checkbox\" class=\"form-check-input\" id=\"enabled-${idPrefix}-${this._sanitizeID(collection[index].name.toLowerCase())}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\n        else if (collection[index].useName)\n            menu += `<a style=\"padding-left: ${padding}px\" class=\"nav-link text-dark \" href=\"#${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\"><i class=\"align-middle float-start no-icon\"></i> <input data-page=\"${hrefPrefix}/${encodeURIComponent(collection[index].name.toLowerCase())}\" type=\"checkbox\" class=\"form-check-input\" id=\"enabled-${idPrefix}-${this._sanitizeID(collection[index].name.toLowerCase())}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\n        else\n            menu += `<a style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#${hrefPrefix}/${index}\"><i class=\"align-middle float-start no-icon\"></i><input type=\"checkbox\" class=\"form-check-input\" data-page=\"${hrefPrefix}/${index}\" id=\"enabled-${idPrefix}-${index}\"${collection[index].enabled ? ' checked' : ''}> ${htmlEncode(GetDisplay(collection[index]))}</a>`;\n        menu += '</li>';\n        return menu;\n    }\n\n    private _getItems(collection, idPrefix, hrefPrefix, indent?) {\n        if (!collection || collection.length === 0) return '';\n        let menu = '';\n        for (let c = 0, cl = collection.length; c < cl; c++) {\n            menu += this._getItem(collection, c, idPrefix, hrefPrefix, indent);\n        }\n        return '<ul class=\"dropdown-menu dropdown-inline\">' + menu + '</ul>';\n    }\n\n    private _buildMenu() {\n        let nav = '';\n        for (let k = 0, kl = this.profiles.keys.length; k < kl; k++) {\n            nav += this._profile(this.profiles.keys[k]);\n        }\n        this._menu.innerHTML = '<ul class=\"nav\" id=\"profile-menu\">' + nav + '</ul>'\n        let items = this._menu.querySelectorAll('a');\n        for (let i = 0, il = items.length; i < il; i++) {\n            this._profileEvents(items[i]);\n        }\n    }\n\n    private _lazyLoad(item) {\n        const data = item.getAttribute('href').split('/');\n        if (item.dataset.type === 'profile') {\n            item.insertAdjacentHTML('afterend', this._getItems([{\n                name: 'Aliases',\n                items: this.profiles.items[data[1]].aliases,\n                useName: true,\n                enabled: this.profiles.items[data[1]].enableAliases,\n            },\n            {\n                name: 'Macros',\n                items: this.profiles.items[data[1]].macros,\n                useName: true,\n                enabled: this.profiles.items[data[1]].enableMacros\n            },\n            {\n                name: 'Triggers',\n                items: this.profiles.items[data[1]].triggers,\n                useName: true,\n                enabled: this.profiles.items[data[1]].enableTriggers\n            },\n            {\n                name: 'Buttons',\n                items: this.profiles.items[data[1]].buttons,\n                useName: true,\n                enabled: this.profiles.items[data[1]].enableButtons\n            }], this._sanitizeID(data[1]), 'profiles/' + encodeURIComponent(data[1]), 1));\n        }\n        else {\n            const collection = this.profiles.items[data[1]][data[2]];\n            item.insertAdjacentHTML('afterend', this._getItems(collection, item.dataset.id, item.getAttribute('href').substring(1), +item.dataset.indent + 1))\n        }\n        item.dataset.lazy = 'false';\n        this._profileEvents(item.nextElementSibling);\n    }\n\n    private _profileEvents(item) {\n        let items = item.querySelectorAll('.bi-chevron-right');\n        let i, il;\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].addEventListener('click', e => {\n                if (e.currentTarget.parentElement.dataset.lazy === 'true')\n                    this._lazyLoad(e.currentTarget.parentElement);\n                e.target.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\n                e.target.classList.toggle('bi-chevron-right');\n                e.target.classList.toggle('bi-chevron-down');\n                //e.stopPropagation();\n                //e.cancelBubble = true;\n                e.preventDefault();\n            });\n        items = item.querySelectorAll('input');\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].addEventListener('change', e => {\n                const data = e.target.dataset.page.split('/');\n                const value = e.target.checked;\n                switch (data.length) {\n                    case 2:\n                        if (!value && this.profiles.keys.filter(k => this.profiles.enabled(k)).length === 1) {\n                            alert_box('Cannot disable', 'One profile must always be enabled.');\n                            e.target.checked = true;\n                            return;\n                        }\n                        this._menu.querySelector(`#enabled-${this._sanitizeID(data[1])}`).checked = value;\n                        this._menu.querySelector(`#enabled-${this._sanitizeID(data[1])}-switch`).checked = value;\n                        if (this._page === e.target.dataset.page)\n                            this._contents.querySelector('#enabled').checked = value;\n                        this.profiles.items[data[1]].enabled = value;\n                        this.changed = true;\n                        break;\n                    case 3:\n                        this._menu.querySelector(`#enabled-${this._sanitizeID(data[1])}-${data[2]}`).checked = value;\n                        if (this._page === `profiles/${data[1]}`)\n                            this._contents.querySelector('#enable' + capitalize(data[2])).checked = value;\n                        this.profiles.items[data[1]]['enable' + capitalize(data[2])] = value;\n                        this.changed = true;\n                        break;\n                    case 4:\n                        this._menu.querySelector(`#enabled-${this._sanitizeID(data[1])}-${data[2]}-${data[3]}`).checked = value;\n                        if (this._page === e.target.dataset.page)\n                            this._contents.querySelector('#enabled').checked = value;\n                        else if (this._page === `profiles/${data[1]}/${data[2]}`)\n                            this._contents.querySelector('#check-' + data[3]).checked = value;\n                        this.profiles.items[data[1]][data[2]][+data[3]].enabled = value;\n                        this.changed = true;\n                        break;\n                }\n                e.stopPropagation();\n                e.cancelBubble = true;\n            });\n        items = item.querySelectorAll('.list-badge-button.text-bg-danger');\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].addEventListener('click', (e: MouseEvent) => {\n                this._deleteProfile((e.target as HTMLElement).parentElement.dataset.profile);\n                e.preventDefault();\n            });\n        items = item.querySelectorAll('.list-badge-button.text-bg-light');\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].addEventListener('click', (e: MouseEvent) => {\n                this._copyItem({ type: 'profile', profileName: (e.target as HTMLElement).parentElement.dataset.profile });\n                e.preventDefault();\n            });\n        items = item.querySelectorAll('.list-badge-button.text-bg-warning');\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].addEventListener('click', (e: MouseEvent) => {\n                this._cutItem({ type: 'profile', profileName: (e.target as HTMLElement).parentElement.dataset.profile });\n                e.preventDefault();\n            });\n    }\n\n    private _profile(profile) {\n        let nav = `<li class=\"nav-item\" data-profile=\"${profile}\" title=\"${capitalize(profile)}\" id=\"${this._sanitizeID(profile)}\">`;\n        nav += `<a data-lazy=\"true\" data-type=\"profile\" data-id=\"${this._sanitizeID(profile)}\" class=\"nav-link text-dark\" href=\"#profiles/${encodeURIComponent(profile)}\">`;\n        if (profile !== 'default')\n            nav += `<span class=\"list-badge-button badge text-bg-danger\" data-profile=\"${profile}\" title=\"Remove profile\"><i class=\"bi bi-trash\"></i></span>`;\n        nav += `<span class=\"list-badge-button badge text-bg-light me-1\" data-profile=\"${profile}\" title=\"Copy profile\"><i class=\"bi bi-copy\"></i></span>`;\n        if (profile !== 'default')\n            nav += `<span class=\"list-badge-button badge text-bg-warning me-1\" data-profile=\"${profile}\" title=\"Cut profile\"><i class=\"bi bi-scissors\"></i></span>`;\n        nav += `<i class=\"align-middle float-start bi bi-chevron-right\"></i> `;\n        nav += this._item(capitalize(profile), 'enabled-' + profile, this.profiles.items[profile].enabled);\n        nav += `</a>`;\n        nav += '</li>';\n        return nav;\n    }\n\n    private _item(title, id, enabled) {\n        return `<span><input type=\"checkbox\" data-page=\"profiles/${title.toLowerCase()}\" class=\"form-check-input\" id=\"${this._sanitizeID(id)}\"${enabled ? ' checked' : ''}> ${title}</span><div class=\"form-check form-switch\"><input type=\"checkbox\" class=\"form-check-input\" id=\"${id}-switch\"${enabled ? ' checked' : ''}> ${title}</div>`;\n    }\n\n    public setBody(contents: string, args?: any) {\n        if (!this.profiles) {\n            setTimeout(() => {\n                this.setBody(contents, args);\n            }, 100);\n            return;\n        }\n        if (this._errorField) {\n            setTimeout(() => this._errorField.focus(), 100);\n            window.location.hash = this._page;\n            return;\n        }\n        this._page = this.dialog.dataset.path;\n        if (this._page === 'profiles')\n            this.dialog.dataset.panel = 'left';\n        else\n            this.dialog.dataset.panel = 'right';\n        const pages = this._page.split('/');\n        let k, kl, p;\n        this.expandPath(pages);\n        this.footer.querySelector('#profile-page-buttons').innerHTML = '';\n        this.footer.querySelector(`#${this.id}-export-current`).style.display = '';\n        this._contents.scrollTop = 0;\n        if (!this._setCurrent(pages)) {\n            this.title = buildBreadcrumb(pages, { small: this._small, sep: '/', icon: '<i class=\"fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i>' });\n            if (pages.length > 2)\n                this._splitter.panel2Collapsed = false;\n            return;\n        }\n        if (pages.length === 4)\n            this.title = buildBreadcrumb(pages, { small: this._small, sep: '/', formatter: (item, index, last) => index === last ? htmlEncode(GetDisplay(this._current.item)) : capitalize(item), icon: '<i class=\"fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i>' });\n        else if (pages.length === 5)\n            this.title = buildBreadcrumb(pages, { small: this._small, sep: '/', formatter: (item, index, last) => index === last ? htmlEncode(GetDisplay(this._current.parent)) : index === last - 1 ? htmlEncode(GetDisplay(this._current.item)) : capitalize(item), icon: '<i class=\"fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i>' });\n        else\n            this.title = buildBreadcrumb(pages, { small: this._small, sep: '/', icon: '<i class=\"fas fa-users\" style=\"padding: 2px;margin-right: 2px;\"></i>' });\n        if (pages.length < 2) {\n            this.footer.querySelector(`#${this.id}-export-current`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-sep`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-alias`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-macro`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-trigger`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-button`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-sep2`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-default-buttons`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-add-default-macros`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-cut`).style.display = 'none';\n            this.footer.querySelector(`#${this.id}-copy`).style.display = 'none';\n            this._splitter.panel2Collapsed = true;\n            this.footer.querySelector(`#${this.id}-back`).style.display = 'none';\n        }\n        else {\n            this.footer.querySelector(`#${this.id}-add-sep`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-alias`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-macro`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-trigger`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-button`).style.display = '';\n            this.footer.querySelector(`#${this.id}-back`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-sep2`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-default-buttons`).style.display = '';\n            this.footer.querySelector(`#${this.id}-add-default-macros`).style.display = '';\n            this.footer.querySelector(`#${this.id}-cut`).style.display = '';\n            this.footer.querySelector(`#${this.id}-copy`).style.display = '';\n            this._splitter.panel2Collapsed = false;\n        }\n        this._updateEditMenu();\n        if (pages.length === 2) {\n            if (this._contentPage !== 'properties') {\n                this._loadPage('properties').then(contents => {\n                    this._contentPage = 'properties';\n                    this._setContents(contents);\n                    const forms = this._contents.querySelectorAll('input');\n                    this._contents.querySelector('#name').disabled = this._current.profileName === 'default';\n                    for (let f = 0, fl = forms.length; f < fl; f++)\n                        if (forms[f].type === 'checkbox') {\n                            forms[f].checked = this._current.profile[forms[f].id];\n                            forms[f].addEventListener('change', e => {\n                                const value = e.target.checked;\n                                if (e.target.id === 'enabled') {\n\n                                    if (!value && this.profiles.keys.filter(k => this.profiles.enabled(k)).length === 1) {\n                                        alert_box('Cannot disable', 'One profile must always be enabled.');\n                                        e.target.checked = true;\n                                        return;\n                                    }\n                                    this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}`).checked = value;\n                                    this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-switch`).checked = value;\n                                    if (this._page === e.target.dataset.page)\n                                        this._contents.querySelector('#enabled').checked = value;\n                                    this.profiles.items[this._current.profileName].enabled = value;\n                                }\n                                else {\n                                    this._current.profile[e.target.id] = value;\n                                    this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-${e.target.id.substring(6).toLowerCase()}`).checked = value;\n                                    this.changed = true;\n                                }\n                                this.changed = true;\n                            });\n                        }\n                        else {\n                            forms[f].value = this._current.profile[forms[f].id];\n                            forms[f].addEventListener('change', e => {\n                                const target = (e.currentTarget || e.target) as HTMLInputElement;\n                                if (target.id === 'name') {\n                                    debounce(() => {\n                                        let err = this._renameProfile(target.value);\n                                        if (err === true) {\n                                            forms[f].classList.remove('is-invalid');\n                                            this._errorField = null;\n                                        }\n                                        else {\n                                            forms[f].classList.add('is-invalid');\n                                            this._errorField = forms[f];\n                                            this._contents.querySelector('#name-feedback').textContent = err;\n                                        }\n                                        this._sortProfiles();\n                                    }, 200, 'renameProfile');\n                                }\n                                else {\n                                    this._current.profile[target.id] = target.value;\n                                    debounce(() => this._sortProfiles(), 200, 'sortProfiles');\n                                }\n                                this.changed = true;\n                            });\n                            forms[f].addEventListener('input', e => {\n                                const target = (e.currentTarget || e.target) as HTMLInputElement;\n                                if (target.id === 'name') {\n                                    debounce(() => {\n                                        let err = this._renameProfile(target.value);\n                                        if (err === true) {\n                                            forms[f].classList.remove('is-invalid');\n                                            this._errorField = null;\n                                        }\n                                        else {\n                                            forms[f].classList.add('is-invalid');\n                                            this._errorField = forms[f];\n                                            this._contents.querySelector('#name-feedback').textContent = err;\n                                        }\n                                        this._sortProfiles();\n                                    }, 200, 'renameProfile');\n                                }\n                                else {\n                                    this._current.profile[target.id] = target.value;\n                                    debounce(() => this._sortProfiles(), 200, 'sortProfiles');\n                                }\n                                this.changed = true;\n                            });\n                        }\n                }\n                ).catch(() => {\n                });\n            }\n            else {\n                this._contents.querySelector('#name').disabled = this._current.profileName === 'default';\n                const forms = this._contents.querySelectorAll('input');\n                for (let f = 0, fl = forms.length; f < fl; f++) {\n                    if (forms[f].type === 'checkbox')\n                        forms[f].checked = this._current.profile[forms[f].id];\n                    else\n                        forms[f].value = this._current.profile[forms[f].id];\n                }\n            }\n            if (this._current.profileName !== 'default') {\n                let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove profile\"><i class=\"bi bi-trash\"></i></button>`;\n                this.footer.querySelector('#profile-page-buttons').innerHTML = b;\n                this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', (e: MouseEvent) => {\n                    if (this._errorField)\n                        this._errorField = null;\n                    this._deleteProfile(this._current.profileName);\n                });\n            }\n            this.footer.querySelector(`#${this.id}-cut`).style.display = 'none';\n        }\n        else if (pages.length === 3) {\n            let pp = '';\n            let b = `<button id=\"${this.id}-add\" type=\"button\" class=\"btn-sm float-start btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\"><i class=\"bi bi-plus-lg\"></i></button>`;\n            if (this._current.item.length === 0) {\n                p = '<h1 id=\"empty\" style=\"width: 100%;text-align:center\">No ' + this._current.collection + '.</h1>';\n                p += `<button id=\"${this.id}-add-contents\" type=\"button\" class=\"btn-sm float-start btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\"><i class=\"bi bi-plus-lg\"></i> Add ${this._getItemType()}</button>`;\n                this.footer.querySelector(`#${this.id}-cut`).style.display = 'none';\n                this.footer.querySelector(`#${this.id}-copy`).style.display = 'none';\n                this._updateEditMenu();\n            }\n            else {\n                p = '';\n                for (k = 0, kl = this._current.item.length; k < kl; k++) {\n                    p += `<a data-profile =\"${this._current.profileName}\" id=\"item-${k}\" data-index=\"${k}\" href=\"#profiles/${encodeURIComponent(this._current.profileName)}/${this._current.collection}/${k}\" class=\"list-group-item list-group-item-action\">`\n                    p += `<span data-index=\"${k}\" class=\"list-badge-button badge text-bg-danger\"><i class=\"bi bi-trash\" title=\"Remove ${this._getItemType()}\"></i></span>`;\n                    p += `<span data-index=\"${k}\" class=\"list-badge-button badge text-bg-light me-1\" title=\"Copy ${this._getItemType()}\"><i class=\"bi bi-copy\"></i></span>`;\n                    p += `<span data-index=\"${k}\" class=\"list-badge-button badge text-bg-warning me-1\" title=\"Cut ${this._getItemType()}\"><i class=\"bi bi-scissors\"></i></span>`;\n                    p += `<div class=\"form-check-inline form-switch\" style=\"margin: 0;\">`;\n                    p += `<input type=\"checkbox\" class=\"form-check-input\" id=\"check-${k}\" data-profile=\"${this._current.profileName}\" data-index=\"${k}\" data-field=\"enabled\" data-items=\"${this._current.collection}\"${this._current.item[k].enabled ? ' checked=\"checked\"' : ''}>`\n                    p += `</div>${htmlEncode(GetDisplay(this._current.item[k]))}</a>`;\n                }\n                pp = `<button id=\"${this.id}-add-contents\" type=\"button\" class=\"btn-sm btn btn-outline-secondary\" title=\"Add ${this._getItemType()}\" style=\"margin-bottom: 5px;width:100%;\"><i class=\"bi bi-plus-lg\"></i> Add ${this._getItemType()}</button>`;\n                b = `<button id=\"${this.id}-remove-all\" type=\"button\" class=\"btn-sm float-start btn btn-danger\" title=\"Remove all ${this._getItemType() === 'alias' ? 'aliases' : this._getItemType() + 's'}\"><i class=\"bi bi-trash\"></i></button>` + b;\n            }\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\n            this._setContents(pp + '<div class=\"list-group\">' + p + '</div>');\n            let items = this._contents.querySelectorAll('.list-badge-button.text-bg-danger');\n            for (let i = 0, il = items.length; i < il; i++)\n                items[i].addEventListener('click', e => {\n                    this._removeItem(+e.target.parentElement.dataset.index);\n                    e.stopPropagation();\n                    e.cancelBubble = true;\n                    e.preventDefault();\n                });\n            items = this._contents.querySelectorAll('.list-badge-button.text-bg-light,.list-badge-button.text-bg-warning');\n            for (let i = 0, il = items.length; i < il; i++)\n                items[i].addEventListener('click', e => {\n                    let idx = +e.target.parentElement.dataset.index;\n                    let data = {\n                        type: this._getItemType(),\n                        item: this._current.item[idx],\n                        index: idx,\n                        profile: this._current.profile,\n                        profileName: this._current.profileName,\n                        collection: this._current.collection\n                    };\n                    if (e.currentTarget.classList.contains('text-bg-warning'))\n                        this._cutItem(data);\n                    else\n                        this._copyItem(data);\n                    e.stopPropagation();\n                    e.cancelBubble = true;\n                    e.preventDefault();\n                });\n\n            this._contentPage = null;\n            this.footer.querySelector(`#${this.id}-add`).addEventListener('click', () => {\n                this._addItem();\n            });\n            if (this.footer.querySelector(`#${this.id}-remove-all`))\n                this.footer.querySelector(`#${this.id}-remove-all`).addEventListener('click', () => {\n                    this._removeItems();\n                });\n            if (this._contents.querySelector(`#${this.id}-add-contents`))\n                this._contents.querySelector(`#${this.id}-add-contents`).addEventListener('click', () => {\n                    this._addItem();\n                });\n\n            items = this._contents.querySelectorAll('input');\n            for (let i = 0, il = items.length; i < il; i++)\n                items[i].addEventListener('change', (e: MouseEvent) => {\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\n                    const value = target.checked;\n                    this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-${this._current.collection}-${target.dataset.index}`).checked = value;\n                    this._current.profile[this._current.collection][+target.dataset.index].enabled = value;\n                    this.changed = true;\n                });\n\n        }\n        else if (pages.length === 4) {\n            let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove ${this._getItemType()}\"><i class=\"bi bi-trash\"></i></button>`;\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\n            this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', e => {\n                this._removeItem(this._current.itemIdx, 0, true);\n                e.stopPropagation();\n                e.cancelBubble = true;\n                e.preventDefault();\n            });\n            if (this._contentPage !== this._current.collection) {\n                this._contentPage = this._current.collection;\n                this._loadPage(this._current.collection).then(contents => {\n                    this._setContents(contents);\n                    this._loadItem(true);\n                }).catch(() => { });\n            }\n            else\n                this._loadItem();\n\n        }\n        else if (pages.length === 5) {\n            let b = `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove ${this._getItemType()}\"><i class=\"bi bi-trash\"></i></button>`;\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\n            this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', e => {\n                this._removeItem(this._current.itemIdx, 0, true);\n                e.stopPropagation();\n                e.cancelBubble = true;\n                e.preventDefault();\n            });\n            if (this._contentPage !== this._current.collection) {\n                this._contentPage = this._current.collection;\n                this._loadPage(this._current.collection).then(contents => this._setContents(contents)).catch(() => {\n                    this._loadItem(true);\n                });\n            }\n            else\n                this._loadItem();\n        }\n        else {\n            let b = `<button id=\"btn-${this.id}-add-profile\" type=\"button\" class=\"btn-sm btn btn-outline-secondary\" title=\"Add profile\"><i class=\"bi bi-plus-lg\"></i></button>`;\n            this.footer.querySelector('#profile-page-buttons').innerHTML = b;\n            this.footer.querySelector(`#btn-${this.id}-add-profile`).addEventListener('click', () => {\n                this._createProfile(true);\n            });\n            this._contentPage = null;\n            this._setContents('');\n        }\n    }\n\n    private _setCurrent(pages) {\n        if (!pages)\n            return false;\n        this._current.itemIdx = this._current.itemSubIdx = -1;\n        this._current.parent = null;\n        this._current.collection = '';\n        this._current.item = null;\n        if (pages.length > 1) {\n            this._current.profileName = pages[1];\n            if (!this.profiles.contains(this._current.profileName)) {\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Profile ${this._current.profileName} not found.</h1>`);\n                this._contentPage = null;\n                return false;\n            }\n            this._current.profile = this.profiles.items[this._current.profileName];\n        }\n        if (pages.length > 2) {\n            this._current.collection = pages[2];\n            if (!this._current.profile[this._current.collection]) {\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">${capitalize(this._current.collection)} not found in ${this._current.profileName}.</h1>`);\n                this._contentPage = null;\n                return false;\n            }\n            this._current.item = this._current.profile[pages[2]];\n        }\n        if (pages.length > 3) {\n            this._current.itemIdx = +pages[3];\n            if (isNaN(this._current.itemIdx) || this._current.itemIdx < 0 || this._current.itemIdx >= this._current.item.length) {\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">${capitalize(this._getItemType())} not found.</h1>`);\n                this._contentPage = null;\n                return false;\n            }\n            this._current.item = this._current.profile[pages[2]][this._current.itemIdx];\n        }\n        if (pages.length > 4) {\n            this._current.itemSubIdx = +pages[4];\n            if (!this._current.item.triggers) {\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Invalid trigger.</h1>`);\n                this._contentPage = null;\n                return;\n            }\n            if (this._current.itemSubIdx < 0 || this._current.itemSubIdx >= this._current.item.triggers.length) {\n                this._setContents(`<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Trigger state not found.</h1>`);\n                this._contentPage = null;\n                return;\n            }\n            this._current.parent = this._current.item;\n            this._current.item = this._current.item.triggers[this._current.itemSubIdx];\n        }\n        return true;\n    }\n\n    private _loadPage(page) {\n        return new Promise((resolve, reject) => {\n            $.ajax({\n                url: 'dialogs/profiles-' + page + '.htm',\n                cache: false,\n                type: 'GET',\n            })\n                .done((data) => {\n                    data = data.replace(/{profileURL}/g, encodeURIComponent(this._current.profileName)).replace(/{profile}/g, this._current.profileName)\n                    resolve(data);\n                })\n                .fail(function () {\n                    reject('');\n                });\n        });\n    }\n\n    private _setContents(contents) {\n        this._contents.innerHTML = contents;\n        const scripts: HTMLScriptElement[] = this._contents.querySelectorAll('script');\n        const args = {\n            client: client,\n            item: this._current.item,\n            FilterArrayByKeyValue: FilterArrayByKeyValue,\n            keyCharToCode: keyCharToCode,\n            profile: this._current.profile,\n            profileName: this._current.profileName,\n            parent: this._current.parent,\n            current: this._current,\n            GetDisplay: GetDisplay,\n            Trigger: Trigger,\n            debounce: debounce,\n            updateHash: updateHash,\n            DialogButtons: DialogButtons\n        };\n        this.emit('content-changing');\n        for (let s = 0, sl = scripts.length; s < sl; s++) {\n            /*jslint evil: true */\n            let script = new Function('body', 'dialog', ...Object.keys(args), 'try { ' + scripts[s].textContent + '}catch(e){this._client.error(e)}');\n            script.apply(client, [this._contents, this, ...Object.values(args), this]);\n        }\n        this.emit('content-changed');\n    }\n\n    private _loadItem(events?) {\n        const forms: HTMLInputElement[] = this._contents.querySelectorAll('input,select,textarea');\n\n        for (let f = 0, fl = forms.length; f < fl; f++) {\n            if (!(forms[f].id in this._current.item) && forms[f].dataset.enum !== 'true')\n                continue;\n            if (forms[f].type === 'checkbox') {\n                if (forms[f].dataset.enum === 'true') {\n                    const name = forms[f].name || forms[f].id.substring(0, forms[f].id.lastIndexOf('-'));\n                    const value = +forms[f].id.substring(forms[f].id.lastIndexOf('-') + 1);\n                    forms[f].checked = (this._current.item[name] & value) === value;\n                }\n                else\n                    forms[f].checked = this._current.item[forms[f].id];\n                if (events)\n                    forms[f].addEventListener('change', e => {\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\n                        if (target.style.display === 'none') return;\n                        if (target.dataset.enum === 'true') {\n                            const name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\n                            const enums = this.body.querySelectorAll(`[name=${name}]`);\n                            let value = 0;\n                            for (let e = 0, el = enums.length; e < el; e++) {\n                                if (enums[e].checked)\n                                    value |= +enums[e].value;\n                            }\n                            this._current.item[name] = value;\n                        }\n                        else {\n                            this._current.item[target.id] = target.checked || false;\n                            if (target.id === 'enabled')\n                                this._menu.querySelector(`#enabled-${this._sanitizeID(this._current.profileName)}-${this._current.collection}-${this._current.itemIdx}`).checked = this._current.item[target.id];\n                        }\n                        this.changed = true;\n                        this._updateItemMenu();\n                    });\n            }\n            else {\n                forms[f].value = this._current.item[forms[f].id];\n                if (events) {\n                    forms[f].addEventListener('change', e => {\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\n                        if (target.style.display === 'none') return;\n                        this.setValue(this._current.item, target.id, target.value);\n                        this.changed = true;\n                        this._updateItemMenu();\n                    });\n                    forms[f].addEventListener('input', e => {\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\n                        if (target.style.display === 'none') return;\n                        this.setValue(this._current.item, target.id, target.value);\n                        this.changed = true;\n                        this._updateItemMenu();\n                    });\n                }\n                let c = this.changed;\n                forms[f].dispatchEvent(new Event('change'));\n                this.changed = c;\n            }\n        }\n        this.emit('item-loaded', this._current);\n    }\n\n    private _updateItemMenu(currentItem?, profile?, collection?, index?) {\n        profile = profile || this._current.profileName;\n        collection = collection || this._current.collection;\n        if (typeof index !== 'number')\n            index = this._current.itemIdx;\n        const currentParent = this._current.parent;\n        currentItem = currentItem || this._current.item;\n        debounce(() => {\n            let item = this.body.querySelector(`#${this._sanitizeID(profile)}-${collection}-${index}`);\n            if (!item) return;\n            let display\n            display = GetDisplay(currentParent || currentItem);\n            item.title = display;\n            item.firstChild.childNodes[2].textContent = ' ' + display;\n            let bc = this.header.querySelector('ol').children;\n            if (bc.length > 4) {\n                if (bc[4].children.length)\n                    bc[4].children[0].textContent = display;\n                else\n                    bc[4].textContent = display;\n            }\n            if (bc.length > 5) {\n                bc[5].textContent = GetDisplay(currentItem);\n            }\n        }, 200, 'updateItemMenu');\n    }\n\n    public expandPath(pages, select?) {\n        if (!Array.isArray(pages))\n            pages = pages.split('/');\n        let id;\n        let el;\n        let expand;\n        let po = 0;\n        if (pages[0] === 'profiles')\n            po = 1;\n        let last = pages.length - 1;\n        for (let p = po, pl = pages.length; p < pl; p++) {\n            id = this._sanitizeID(pages.slice(po, p + 1).join('-'));\n            el = document.getElementById(id);\n            if (!el) continue;\n            if (p === last) {\n                setTimeout(() => {\n                    const items = this._menu.querySelectorAll('.active');\n                    for (let i = 0, il = items.length; i < il; i++)\n                        items[i].classList.remove('active');\n                    scrollChildIntoView(this._menu, el);\n                    el.classList.add('active');\n                    if (select)\n                        el.firstChild.click();\n                }, 100);\n            }\n            else {\n                expand = el.querySelector('.dropdown-menu');\n                if (!expand) {\n                    expand = el.querySelector('[data-lazy=\"true\"]')\n                    if (!expand) return;\n                    this._lazyLoad(expand);\n                    expand = el.querySelector('.dropdown-menu');\n                }\n                if (!expand || expand.classList.contains('show')) continue;\n                el = el.querySelector('i.bi-chevron-right') || el.querySelector('i.bi-chevron-down');\n                if (el) {\n                    el.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\n                    el.classList.toggle('bi-chevron-right');\n                    el.classList.toggle('bi-chevron-down');\n                }\n            }\n        }\n\n    }\n\n    private _goBack() {\n        if (this._errorField) {\n            this._errorField.focus();\n            return;\n        }\n        const pages = this._page.split('/');\n        if (pages.length === 5)\n            this.loadPage(pages.slice(0, pages.length - 2).join('/'));\n        else\n            this.loadPage(pages.slice(0, pages.length - 1).join('/'));\n    }\n\n    private _createProfile(defaults: boolean) {\n        let i = this.profiles.length;\n        let name = 'NewProfile' + i;\n        while (this.profiles.contains(name)) {\n            i++;\n            name = 'NewProfile' + i\n        }\n        const profile = new Profile(name, defaults);\n        name = name.toLowerCase();\n        this.profiles.add(profile);\n        this.profiles.SortByPriority();\n        let menuItem = this._profile(name);\n        i = this.profiles.keys.indexOf(name);\n        const menu = document.getElementById('profile-menu');\n        if (i === -1 || i >= menu.children.length)\n            i = menu.children.length - 1;\n        if (i < 0) i = 0;\n        menu.children[i].insertAdjacentHTML(\"afterend\", menuItem);\n        this._profileEvents(menu.children[i + 1]);\n        this.changed = true;\n        this.loadPage('profiles/' + name);\n    }\n\n    private _deleteProfile(profile) {\n        if (!profile) return false;\n        confirm_box('Remove profile?', `Delete \"${profile}\"?`).then(e => {\n            if (e.button === DialogButtons.Yes) {\n                this.profiles.remove(profile);\n                this._menu.querySelector('#' + profile).remove();\n                if (this._page.startsWith('profiles/' + profile))\n                    this.loadPage('profiles');\n                this.changed = true;\n            }\n        });\n    }\n\n    private _renameProfile(name, oldProfile?) {\n        if (!name) return 'Name can not be empty!';\n        oldProfile = (oldProfile || this._current.profileName).toLowerCase();\n        name = name.toLowerCase();\n        if (name === oldProfile) return true;\n        if (this.profiles.contains(name))\n            return 'A profile named ' + name + ' already exists!';\n        this.profiles.remove(oldProfile);\n        this._current.profile.name = name;\n        this._current.profileName = name;\n        this.profiles.add(this._current.profile);\n        const oldID = this._sanitizeID(oldProfile);\n        const newID = this._sanitizeID(name);\n        let items;\n        items = this.body.querySelector(`#${oldID} a`);\n        items.children[2].childNodes[1].textContent = ' ' + capitalize(name);\n        document.querySelector(`#${oldID} a`).children[3].childNodes[1].textContent = ' ' + capitalize(name);\n        items = this.body.querySelector(`#${oldID}`);\n        items.id = newID;\n        items.title = name;\n        this._replaceProfileName(this._menu.firstChild, oldProfile, name);\n        this._replaceProfileName(this._contents, oldProfile, name);\n        this.header.querySelector('ol').children[2].textContent = capitalize(name);\n        return true;\n    }\n\n    private _replaceProfileName(container, oldName, newName) {\n        let items;\n        let i, il;\n        const oldID = this._sanitizeID(oldName);\n        const newID = this._sanitizeID(newName);\n        items = container.querySelectorAll(`[id*=\"-${oldID}-\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].id = items[i].id.replace(`-${oldID}-`, `-${newID}-`);\n        items = container.querySelectorAll(`[id$=\"-${oldID}\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].id = items[i].id.replace(`-${oldID}`, `-${newID}`);\n        items = container.querySelectorAll(`[id^=\"${oldID}-\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].id = items[i].id.replace(`${oldID}-`, `${newID}-`);\n        items = container.querySelectorAll(`[data-profile=\"${oldID}\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].dataset.profile = newID;\n        const oldPath = encodeURIComponent(oldName);\n        const newPath = encodeURIComponent(newName);\n        items = container.querySelectorAll(`[href*=\"/${oldPath}/\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].href = items[i].getAttribute('href').replace(`/${oldPath}/`, `/${newPath}/`);\n        items = container.querySelectorAll(`[href$=\"/${oldPath}\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].href = items[i].getAttribute('href').replace(`/${oldPath}`, `/${newPath}`);\n        items = container.querySelectorAll(`[href^=\"${oldPath}/\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].href = items[i].getAttribute('href').replace(`${oldPath}/`, `${newPath}/`);\n        items = container.querySelectorAll(`[data-path*=\"/${oldPath}/\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].dataset.path = items[i].dataset.path.replace(`/${oldPath}`, `/${newPath}`);\n        items = container.querySelectorAll(`[data-page*=\"/${oldPath}/\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].dataset.page = items[i].dataset.page.replace(`/${oldPath}/`, `/${newPath}/`);\n        items = container.querySelectorAll(`[data-page$=\"/${oldPath}\"]`);\n        for (i = 0, il = items.length; i < il; i++)\n            items[i].dataset.page = items[i].dataset.page.replace(`/${oldPath}`, `/${newPath}`);\n    }\n\n    private _sortProfiles() {\n        this.profiles.SortByPriority();\n        const menu = this._menu.firstChild;\n        const items = Array.from(menu.children);\n        items.sort((a: HTMLElement, b: HTMLElement) => {\n            let ap = this.profiles.items[a.dataset.profile].priority\n            let bp = this.profiles.items[b.dataset.profile].priority\n            if (ap > bp)\n                return -1;\n            if (ap < bp)\n                return 1;\n            if (a.dataset.profile === 'default')\n                return -1;\n            if (b.dataset.profile === 'default')\n                return 1;\n            ap = a.dataset.profile;\n            bp = b.dataset.profile;\n            if (ap > bp)\n                return 1;\n            if (ap < bp)\n                return -1;\n            return 0;\n        })\n\n        items.forEach(item => menu.appendChild(item));\n    }\n\n    private _save() {\n        if (!this.changed) return true;\n        if (this._errorField) {\n            this._errorField.focus();\n            return false;\n        }\n        this.profiles.save().then(() => {\n            this._client.loadProfiles().then(() => {\n\n            });\n        })\n        this.changed = false;\n        return true;\n    }\n\n    public close() {\n        if (!this._canClose) {\n            if (this._outsideChange) {\n                confirm_box('Profiles changed', `Profiles have been changed outside of manager, overwrite?`, null, DialogButtons.YesNo).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        this._outsideChange = false;\n                        this.close();\n                    }\n                });\n            }\n            else\n                this._confirmSave().then(r => {\n                    if (r)\n                        if (!this._save()) return;\n                    this._canClose = true;\n                    this.close();\n                }).catch(() => {\n                    this._canClose = false;\n                });\n        }\n        else\n            super.close();\n    }\n\n    public reload() {\n        if (!this._setCurrent(this._page.split('/')))\n            return\n        this._loadItem();\n        this._updateItemMenu();\n    }\n\n    private _confirmSave() {\n        return new Promise((resolve, reject) => {\n            if (this._profilesChanged) {\n                confirm_box('Save changes?', `Save changes to profiles?`, null, DialogButtons.YesNo | DialogButtons.Cancel).then(e => {\n                    if (e.button === DialogButtons.Yes)\n                        resolve(true);\n                    else if (e.button === DialogButtons.No)\n                        resolve(false);\n                    else\n                        reject();\n                }).catch(e => {\n                    reject();\n                });\n            }\n            else\n                resolve(true);\n        });\n    }\n\n    private _sanitizeID(name) {\n        return name.toLowerCase().replace(/[^a-z0-9:.-]+/gi, '_');\n    }\n\n    private _getItemType(collection?) {\n        collection = collection || this._current.collection;\n        if (!collection) return;\n        if (collection === 'aliases') return 'alias';\n        return collection.substring(0, collection.length - 1);\n    }\n\n    private _addItem(collection?, item?, profile?) {\n        if (!collection) collection = this._current.collection;\n        if (!collection) return;\n        if (!profile) profile = this._current.profile;\n        let profileName = profile.name.toLowerCase();\n        let index = profile[collection].length;\n        let menuItem;\n        if (!item) {\n            if (collection === 'aliases')\n                item = new Alias();\n            else if (collection === 'triggers')\n                item = new Trigger();\n            else if (collection === 'buttons')\n                item = new Button();\n            else if (collection === 'macros')\n                item = new Macro();\n            else if (collection === 'context')\n                item = new Context();\n        }\n        profile[collection].push(item);\n        let m = this._menu.querySelector(`#${this._sanitizeID(profileName)}-${collection}`);\n        //if no m it has not been loaded yet so let the updateHash expand it\n        if (m)\n            if (index === 0) {\n                menuItem = this._getItem([{\n                    name: capitalize(collection),\n                    items: profile[collection],\n                    useName: true,\n                    enabled: profile[collection],\n                }], 0, this._sanitizeID(profileName), 'profiles/' + encodeURIComponent(profileName), 1);\n                let newNode = document.createElement('div');\n                newNode.innerHTML = menuItem;\n                if (m.replaceWith)\n                    m.replaceWith(newNode.firstChild);\n                else if (m.replaceChild)\n                    m.parentNode.replaceChild(newNode.firstChild, m);\n                else\n                    m.outerHTML = menuItem;\n                m = this._menu.querySelector(`#${this._sanitizeID(profileName)}-${collection}`);\n                this._profileEvents(m);\n            }\n            else {\n                menuItem = this._getItem(profile[collection], index, `${this._sanitizeID(profileName)}-${collection}`, `profiles/${encodeURIComponent(profileName)}/${collection}`, 2);\n                //only add if already loaded as the tree will be created when the alias is selected below\n                if (m.firstChild.dataset.lazy !== 'true') {\n                    m = m.querySelector('ul');\n                    m.insertAdjacentHTML('beforeend', menuItem);\n                    m = this._menu.querySelector(`#${this._sanitizeID(profileName)}-${collection}`);\n                    this._profileEvents(m.lastChild);\n                }\n            }\n        this.loadPage(`profiles/${encodeURIComponent(profileName)}/${collection}/${index}`);\n        this.changed = true;\n    }\n\n    private _removeItem(index, collection?, back?, profile?) {\n        if (!collection) collection = this._current.collection;\n        if (!collection) return;\n        if (!profile) profile = this._current.profile;\n        let profileName = profile.name.toLowerCase();\n        confirm_box(`Remove ${this._getItemType()}?`, `Delete ${this._getItemType()}?`).then(e => {\n            if (e.button === DialogButtons.Yes) {\n                const id = `${this._sanitizeID(profileName)}-${collection}`;\n                const items = profile[collection];\n                items.splice(index, 1);\n                this._menu.querySelector(`#${id}-${index}`).remove();\n                if (this._current.itemIdx === -1)\n                    this.setBody(this._page);\n                if (items.length === 0) {\n                    this._menu.querySelector(`#${id} i`).remove();\n                    this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\n                    if (this._menu.querySelector(`#${id} a`).dataset.lazy !== 'true')\n                        this._menu.querySelector(`#${id} .dropdown-menu`).innerHTML = '';\n                }\n                else {\n                    const menuItems = this._menu.querySelector(`#${id} ul`);\n                    let i = menuItems.children.length;\n                    const href = `#profiles/${encodeURIComponent(profileName)}/${collection}/`;\n                    for (; index < i; index++) {\n                        const item = menuItems.children[index];\n                        item.id = `${id}-${index}`;\n                        item.firstChild.href = `${href}${index}`;\n                        item.firstChild.children[1].id = `enabled-${id}-${index}`;\n                    }\n                }\n                this.changed = true;\n                if (back)\n                    this._goBack();\n                if (id === this._clipId)\n                    this._resetClip(true);\n            }\n        });\n    }\n\n    private _removeItems(collection?, back?, profile?) {\n        if (!collection) collection = this._current.collection;\n        if (!collection) return;\n        if (!profile) profile = this._current.profile;\n        let profileName = profile.name.toLowerCase();\n        let type = this._getItemType();\n        type += type === 'alias' ? 'es' : 's';\n        confirm_box(`Remove all ${type}?`, `Delete all ${type}?`).then(e => {\n            if (e.button === DialogButtons.Yes) {\n                const id = `${this._sanitizeID(profileName)}-${collection}`;\n                profile[collection] = [];\n                this.setBody(this._page);\n                this._menu.querySelector(`#${id} i`).remove();\n                this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\n                if (this._menu.querySelector(`#${id} a`).dataset.lazy !== 'true')\n                    this._menu.querySelector(`#${id} .dropdown-menu`).innerHTML = '';\n                this.changed = true;\n                if (back)\n                    this._goBack();\n                if (id === this._clipId)\n                    this._resetClip(true);\n            }\n        });\n    }\n\n    private _resetClip(clear?) {\n        if (this._clip && this._clip.action === ClipAction.cut) {\n            let items = this.body.querySelectorAll('.cut-item');\n            items.forEach(item => item.classList.remove('cut-item'));\n        }\n        if (clear) {\n            this._clip = null;\n            this._clipId = null;\n            this._updateEditMenu();\n        }\n    }\n\n    private _copyItem(data?) {\n        this._resetClip();\n        this._clip = data || this._getClipData();\n        this._clip.action = ClipAction.copy;\n        this._updateEditMenu();\n    }\n\n    private _cutItem(data?) {\n        this._resetClip();\n        this._clip = data || this._getClipData();\n        this._clip.action = ClipAction.cut;\n        this._updateEditMenu();\n        if (this._clip.type.endsWith('s') && !this._clip.collection)\n            this._clipId = `${this._sanitizeID(this._clip.profileName)}-${this._clip.type}`;\n        else if (this._clip.type === 'profile')\n            this._clipId = `${this._sanitizeID(this._clip.profileName)}`;\n        else\n            this._clipId = `${this._sanitizeID(this._clip.profileName)}-${this._clip.type === 'alias' ? 'aliase' : this._clip.type}s-${this._clip.index}`;\n        if (this.body.querySelector('#' + this._clipId))\n            this.body.querySelector('#' + this._clipId).classList.add('cut-item');\n    }\n\n    private _getClipData() {\n        let data: any = {\n            type: 'profile',\n            profileName: this._current.profileName\n        }\n        if (this._current.itemIdx != -1) {\n            data.type = this._getItemType();\n            data.item = this._current.itemSubIdx !== -1 ? this._current.parent : this._current.item;\n            data.index = this._current.itemIdx;\n            data.profile = this._current.profile;\n            data.collection = this._current.collection;\n        }\n        else if (this._current.collection.length) {\n            data.type = this._current.collection;\n            data.items = this._current.item;\n            data.profile = this._current.profile;\n        }\n        return data;\n    }\n\n    private _paste() {\n        let i;\n        let il;\n        let item;\n        if (!this._clip) return;\n        //as long as not same profile and not cutting, as pasting back a cut just leaves it where it started\n        if (!(this._clip.profileName === this._current.profileName && this._clip.action === ClipAction.cut)) {\n            if (this._clip.type.endsWith('s') && !this._clip.collection) {\n                let items = this._clip.items;\n                for (i = 0, il = items.length; i < il; i++) {\n                    item = items[i].clone();\n                    item.profile = this._current.profile;\n                    this._addItem(this._clip.type, item);\n                }\n                if (this._clip.action === ClipAction.cut) {\n                    const id = `${this._sanitizeID(this._clip.profileName)}-${this._clip.type}`;\n                    this._clip.profile[this._clip.type] = [];\n                    this.setBody(this._page);\n                    this._menu.querySelector(`#${id} i`).remove();\n                    this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\n                    if (this._menu.querySelector(`#${id} a`).dataset.lazy !== 'true')\n                        this._menu.querySelector(`#${id} .dropdown-menu`).innerHTML = '';\n                }\n            }\n            else if (this._clip.type === 'profile') {\n                if (this.profiles.contains(this._clip.profileName)) {\n                    const profile = this.profiles.items[this._clip.profileName].clone();\n                    profile.name = this._profileCopyName(profile.name);\n                    let name = profile.name.toLowerCase();\n                    this.profiles.add(profile);\n                    this.profiles.SortByPriority();\n                    let menuItem = this._profile(name);\n                    i = this.profiles.keys.indexOf(name);\n                    const menu = document.getElementById('profile-menu');\n                    if (i === -1 || i >= menu.children.length)\n                        i = menu.children.length - 1;\n                    if (i < 0) i = 0;\n                    menu.children[i].insertAdjacentHTML(\"afterend\", menuItem);\n                    this._profileEvents(menu.children[i + 1]);\n                }\n            }\n            else {\n                if (this._clip.action === ClipAction.copy)\n                    item = this._clip.item.clone();\n                else\n                    item = this._clip.item;\n                item.profile = this._current.profile;\n                this._addItem(this._clip.collection, item);\n                if (this._clip.action === ClipAction.cut) {\n                    const id = `${this._sanitizeID(this._clip.profileName)}-${this._clip.collection}`;\n                    const items = this._clip.profile[this._clip.collection];\n                    items.splice(this._clip.index, 1);\n                    this._menu.querySelector(`#${id}-${this._clip.index}`).remove();\n                    this.setBody(this._page);\n                    if (items.length === 0) {\n                        this._menu.querySelector(`#${id} i`).remove();\n                        this._menu.querySelector(`#${id} a`).insertAdjacentHTML('afterbegin', '<i class=\"align-middle float-start no-icon\"></i>');\n                        if (this._menu.querySelector(`#${id} a`).dataset.lazy !== 'true')\n                            this._menu.querySelector(`#${id} .dropdown-menu`).innerHTML = '';\n                    }\n                    else {\n                        const menuItems = this._menu.querySelector(`#${id} ul`);\n                        let i = menuItems.children.length;\n                        const href = `#profiles/${encodeURIComponent(this._clip.profileName)}/${this._clip.collection}/`;\n                        let index = this._clip.index;\n                        for (; index < i; index++) {\n                            const item = menuItems.children[index];\n                            item.id = `${id}-${index}`;\n                            item.firstChild.href = `${href}${index}`;\n                            item.firstChild.children[1].id = `enabled-${id}-${index}`;\n                        }\n                    }\n                }\n            }\n            this.changed = true;\n            //only reset if cut as the data has been moved\n            if (this._clip.action === ClipAction.cut)\n                this._resetClip(true);\n        }\n    }\n\n    private _updateEditMenu() {\n        this.footer.querySelector(`#${this.id}-paste`).style.display = this._clip && (this._clip.action === ClipAction.copy || this._clip.profileName !== this._current.profileName || this._clip.type === 'profile') ? '' : 'none';\n        this.footer.querySelector(`#${this.id}-find-div`).style.display = this.footer.querySelector(`#${this.id}-paste`).style.display === 'none' && this.footer.querySelector(`#${this.id}-cut`).style.display === 'none' && this.footer.querySelector(`#${this.id}-copy`).style.display === 'none' ? 'none' : '';\n    }\n\n    public setValue(obj, prop, value) {\n        if (value == 'false') value = false;\n        if (value == 'true') value = true;\n        if (value == 'null') value = null;\n        if (value == 'undefined') value = undefined;\n        if (typeof value == 'string' && parseFloat(value).toString() == value)\n            value = parseFloat(value);\n        obj[prop] = this.convertType(value, typeof obj[prop]);\n    }\n\n    public convertType(value, type) {\n        if (typeof value === type)\n            return value;\n        switch (type) {\n            case 'number':\n                if (typeof value == 'string' && parseFloat(value).toString() == value)\n                    return parseFloat(value);\n                return Number(value);\n            case 'boolean':\n                return Boolean(value);\n            case 'string':\n                return '' + value;\n        }\n        return value;\n    }\n\n    private _updateSmall(width) {\n        if (!this.header.querySelector('.breadcrumb')) {\n            setTimeout(() => {\n                this._updateSmall(width);\n            }, 10);\n            return;\n        }\n        if (width < 430) {\n            if (this._small) return;\n            const item = this.header.querySelector('.breadcrumb');\n            item.classList.add('breadcrumb-sm');\n            this._small = true;\n        }\n        else if (this._small) {\n            const item = this.header.querySelector('.breadcrumb');\n            item.classList.remove('breadcrumb-sm');\n            this._small = false;\n        }\n    }\n\n    private _profileCopyName(name) {\n        let n = name;\n        let i = 0;\n        while (this.profiles.contains(n)) {\n            if (i === 0)\n                n = name + ' Copy';\n            else\n                n = name + ' Copy (' + i + ')';\n            i++;\n        }\n        return n\n    }\n\n    public loadPage(page) {\n        updateHash(page, this._page);\n    }\n}\n\nexport function GetDisplay(arr) {\n    if (!arr) return '';\n    if (arr.displaytype === 1) {\n        /*jslint evil: true */\n        const f = new Function('item', 'keyCodeToChar', 'MacroDisplay', arr.display);\n        return f(arr, keyCodeToChar, MacroDisplay);\n    }\n    if ($.isFunction(arr.display))\n        return arr.display(arr);\n    if ($.isFunction(arr[arr.display]))\n        return arr[arr.display](arr);\n    if (!arr[arr.display])\n        return arr['name'];\n    return arr[arr.display];\n}", "import '../css/help.css';\r\nimport { Dialog } from './dialog';\r\nimport { Splitter, Orientation, PanelAnchor } from './splitter';\r\nimport { removeHash, updateHash, closeDropdowns } from './interface';\r\nimport { buildBreadcrumb } from './breadcrumb';\r\nimport { debounce, scrollChildIntoView, capitalize } from '../core/library';\r\n\r\nexport class HelpDialog extends Dialog {\r\n    private _menu;\r\n    private _contents;\r\n    private _splitter;\r\n    private _small: boolean = false;\r\n    private _page;\r\n    private _menuData: any[];\r\n    private _md;\r\n    private _path;\r\n    private _lastSelected;\r\n    private _history = [];\r\n    private _current = 0;\r\n    private _client;\r\n\r\n    constructor() {\r\n        super(Object.assign({}, client.getWindowState('help') || { center: true }, { title: '<ol class=\"float-start breadcrumb\"><li class=\"breadcrumb-icon\"><i class=\"bi bi-question-circle\" style=\"margin-right: 2px;\"></i></li><li class=\"breadcrumb-item active\">Help</li></ol>', minWidth: 410, noFooter: true }));\r\n        this._client = client;\r\n        this.on('resized', e => {\r\n            this._updateSmall(e.width);\r\n            debounce(() => {\r\n                this._splitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'help-resize');\r\n            this._client.setOption('windows.help', e);\r\n        });\r\n        this._client.on('options-loaded', () => {\r\n            this.resetState(this._client.getWindowState('help') || { center: true });\r\n        });\r\n        this.on('closed', () => {\r\n            this._client.setOption('windows.help', this.windowState);\r\n            this._setContents('');\r\n            removeHash(this._page);\r\n            delete this._md;\r\n            this._md = null;\r\n        });\r\n        this.on('canceled', () => {\r\n            this._client.setOption('windows.help', this.windowState);\r\n            removeHash(this._page);\r\n            delete this._md;\r\n            this._md = null;\r\n        });\r\n        this.on('moved', e => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            this._client.setOption('windows.help', e);\r\n        })\r\n        this.on('maximized', () => {\r\n            this._client.setOption('windows.help', this.windowState);\r\n        });\r\n        this.on('restored', () => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            this._client.setOption('windows.help', this.windowState);\r\n            this._splitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n        this.on('shown', () => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            this._client.setOption('windows.help', this.windowState);\r\n            this._splitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n\r\n        this.body.style.padding = '10px';\r\n        this._splitter = new Splitter({ id: 'help', parent: this.body, orientation: Orientation.vertical, anchor: PanelAnchor.panel1 });\r\n        if (this._client.getOption('help.split') >= 200)\r\n            this._splitter.SplitterDistance = this._client.getOption('help.split');\r\n        this._splitter.on('splitter-moved', distance => {\r\n            this._client.setOption('help.split', distance);\r\n        });\r\n        this._menu = this._splitter.panel1;\r\n        this._menu.style.overflow = 'hidden';\r\n        this._menu.style.overflowY = 'auto';\r\n        this._contents = document.createElement('iframe');\r\n        this._contents.src = 'about:blank';\r\n        this._contents.addEventListener('load', () => {\r\n            this._contents.contentWindow.document.body.onclick = () => {\r\n                this.focus();\r\n                closeDropdowns();\r\n            }\r\n            let script = this._contents.contentWindow.document.createElement('script');\r\n            script.addEventListener('load', () => {\r\n                this._md = this._contents.contentWindow.markdownit({ html: true, typographer: true });\r\n                let old_render = this._md.renderer.rules.link_open || function (tokens, idx, options, env, self) {\r\n                    return self.renderToken(tokens, idx, options);\r\n                };\r\n                this._md.renderer.rules.link_open = (tokens, idx, options, env, self) => {\r\n                    let ref = tokens[idx].attrGet('href');\r\n                    if (ref) {\r\n                        if (ref.startsWith('https:') || ref.startsWith('http:') || ref.startsWith('mailto:'))\r\n                            tokens[idx].attrPush(['target', '_blank']);\r\n                        else {\r\n                            tokens[idx].attrs[tokens[idx].attrIndex('href')][1] = '#';\r\n                            tokens[idx].attrPush(['onclick', `event.preventDefault();openLink('${ref}', 1);return false;`]);\r\n                        }\r\n                    }\r\n                    return old_render(tokens, idx, options, env, self);\r\n                };\r\n            });\r\n            script.setAttribute('src', 'https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js');\r\n            script.setAttribute('type', 'text/javascript');\r\n            this._contents.contentWindow.document.querySelector('head').appendChild(script);\r\n            script = this._contents.contentWindow.document.createElement('link');\r\n            script.setAttribute('href', 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css');\r\n            script.setAttribute('rel', 'stylesheet');\r\n            this._contents.contentWindow.document.querySelector('head').appendChild(script);\r\n            this._contents.contentWindow.document.openLink = (url, p) => {\r\n                this._lastSelected = document.querySelector('#help-jump-menu option:checked');\r\n                if (url.startsWith('docs/'))\r\n                    url = url.substr(5);\r\n                else if (p)\r\n                    url = this._path + url;\r\n                url = url.split('#');\r\n                url = url[0].substr(0, url[0].length - 3);\r\n                //this.body.querySelector('#help-jump-menu').value = url);\r\n                updateHash('help/' + url, this._page);\r\n            }\r\n            this._contents.contentWindow.document.body.style.margin = '10px';\r\n        });\r\n\r\n        this._contents.classList.add('full-page');\r\n        this._contents.style.backgroundColor = 'white';\r\n        this._splitter.panel2.append(this._contents);\r\n        const toolbar = document.createElement('nav');\r\n        toolbar.id = 'help-toolbar';\r\n        toolbar.classList.add('navbar', 'bg-light', 'align-items-center');\r\n        toolbar.innerHTML = `<form class=\"container-fluid justify-content-start\"><div class=\"btn-group me-2 mb-1\" role=\"group\" aria-label=\"History navigation\"><button id=\"btn-help-back\" type=\"button\" class=\"btn btn-sm btn-outline-secondary\" title=\"Back\" disabled><i class=\"bi bi-arrow-left\"></i></button><button id=\"btn-help-forward\" type=\"button\" class=\"btn btn-sm btn-outline-secondary\" title=\"Forward\" disabled><i class=\"bi bi-arrow-right\"></i></button><button id=\"btn-help-history\" type=\"button\" class=\"btn btn-sm btn-outline-secondary dropdown-toggle dropdown-toggle-split\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\" disabled><span class=\"visually-hidden\">Toggle Dropdown</span></button><ul class=\"dropdown-menu\" id=\"help-history-menu\"></ul></div><select id=\"help-jump-menu\" class=\"form-select form-select-sm mb-1\" title=\"Select help topic\"></select></form>`;\r\n        //<li><a class=\"dropdown-item\" href=\"#\">Dropdown link</a></li>\r\n        this.body.appendChild(toolbar);\r\n        toolbar.querySelector('#help-jump-menu').addEventListener('change', e => {\r\n            let value = (<HTMLSelectElement>toolbar.querySelector('#help-jump-menu')).value;\r\n            if ((!value || !value.length))\r\n                value = this._lastSelected ? this._lastSelected.value : '';\r\n            else\r\n                this._updateHistory('help/' + value);\r\n            if (!value || !value.length)\r\n                updateHash('help', this._page);\r\n            else\r\n                updateHash('help/' + value, this._page);\r\n        });\r\n        toolbar.querySelector('#btn-help-back').addEventListener('click', () => this._navigate(-1));\r\n        toolbar.querySelector('#btn-help-forward').addEventListener('click', () => this._navigate(1));\r\n        toolbar.querySelector('#btn-help-history').addEventListener('show.bs.dropdown', () => {\r\n            let h = '';\r\n            const menu = document.getElementById('help-history-menu');\r\n            let history = this._history;\r\n            for (let i = 0, il = history.length; i < il; i++)\r\n                h += `<li id=\"help-history-item-${i}\"><a data-index=\"${i}\" class=\"dropdown-item${i === this._current ? ' active' : ''}\" href=\"#${history[i]}\">${toolbar.querySelector(`#help-jump-menu option[value=\"${history[i].substring(5)}\"]`).textContent.trim()}</a></li>`;\r\n            menu.innerHTML = h;\r\n            const items = document.querySelectorAll('[id^=\"help-history-item\"] a');\r\n            for (let i = 0, il = items.length; i < il; i++) {\r\n                items[i].addEventListener('click', e => {\r\n                    this._current = +(<HTMLElement>e.currentTarget).dataset.index;\r\n                });\r\n            }\r\n        });\r\n        toolbar.querySelector('#btn-help-history').addEventListener('shown.bs.dropdown', () => {\r\n            setTimeout(() => {\r\n                let el = toolbar.querySelector('#help-history-menu') as HTMLElement;\r\n                let rect = el.getBoundingClientRect();\r\n                if (rect.height > this.body.clientHeight - 50 && rect.height > 150) {\r\n                    if (this.body.clientHeight - 50 < 150)\r\n                        el.style.height = '150px';\r\n                    else\r\n                        el.style.height = (this.body.clientHeight - 50) + 'px';\r\n                }\r\n            }, 0);\r\n        })\r\n        toolbar.querySelector('#btn-help-history').addEventListener('hidden.bs.dropdown', function () {\r\n            let el = toolbar.querySelector('#help-history-menu') as HTMLElement;\r\n            el.style.height = '';\r\n        });\r\n        this._splitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        this._splitter.panel2Collapsed = location.hash.indexOf('help-') === -1;\r\n        this._buildMenu();\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        if (!this._menuData) {\r\n            setTimeout(() => {\r\n                this.setBody(contents, args);\r\n            }, 10);\r\n            return;\r\n        }\r\n        if (this._page === this.dialog.dataset.path) return;\r\n        this._page = this.dialog.dataset.path;\r\n        if (this._page === 'help')\r\n            this.dialog.dataset.panel = 'left';\r\n        else\r\n            this.dialog.dataset.panel = 'right';\r\n        const pages = this._page.split('/');\r\n        if (!this._history.length || this._history[this._current] !== this._page)\r\n            this._updateHistory(this._page);\r\n        this._expandPath(pages);\r\n        this.body.querySelector('#help-jump-menu').value = pages.slice(1).join('/');\r\n        this.title = buildBreadcrumb(pages, {\r\n            small: this._small, sep: '/', icon: '<i class=\"bi bi-question-circle\" style=\"margin-right: 2px;\"></i>',\r\n            formatter: (item, index) => {\r\n                if (index === 0) return capitalize(item);\r\n                let d = this._menuData.findIndex(value => value.id === pages[1]);\r\n                if (d === -1 || !this._menuData[d])\r\n                    return item;\r\n                if (index === 1 || !this._menuData[d].nodes)\r\n                    return this._menuData[d].text;\r\n                const id = pages.slice(1, index + 1).join('/');\r\n                let d2 = this._menuData[d].nodes.findIndex(value => value.id === id);\r\n                if (d2 === -1)\r\n                    return item;\r\n                return this._menuData[d].nodes[d2].text;\r\n            }\r\n        });\r\n        this._splitter.panel2Collapsed = pages.length < 2;\r\n        if (this._splitter.panel2Collapsed) {\r\n            this._setContents('');\r\n            this._path = '';\r\n        }\r\n        else {\r\n            if (pages.length < 3)\r\n                this._path = '';\r\n            else\r\n                this._path = pages.slice(1, pages.length - 1).join('/') + '/';\r\n            this._loadPage(pages.slice(1).join('/')).then(data => this._setContents(data)).catch(() => this._setContents('<h1 id=\"empty\" style=\"width: 100%;text-align:center\">Help not found for: ' + pages[pages.length - 1] + '.</h1>'));\r\n        }\r\n    }\r\n\r\n    private _setContents(contents) {\r\n        if (!this._contents.contentWindow || !this._md) {\r\n            setTimeout(() => {\r\n                this._setContents(contents);\r\n            }, 10);\r\n            return;\r\n        }\r\n        this._contents.contentWindow.document.body.innerHTML = this._md.render(contents);\r\n        this._contents.contentWindow.scroll(0, 0);\r\n        this.emit('content-changed');\r\n    }\r\n\r\n    private _sanitizeID(name) {\r\n        return name.toLowerCase().replace(/[^a-z0-9:.-]+/gi, '_');\r\n    }\r\n\r\n    private _expandPath(pages, select?) {\r\n        if (!Array.isArray(pages))\r\n            pages = pages.split('/');\r\n        let id;\r\n        let el;\r\n        let expand;\r\n        let po = 0;\r\n        if (pages[0] === 'help')\r\n            po = 1;\r\n        let last = pages.length - 1;\r\n        for (let p = po, pl = pages.length; p < pl; p++) {\r\n            id = this._sanitizeID(pages.slice(po, p + 1).join('/'));\r\n            el = document.getElementById(id);\r\n            if (!el) continue;\r\n            if (p === last) {\r\n                setTimeout(() => {\r\n                    const items = this._menu.querySelectorAll('.active');\r\n                    for (let i = 0, il = items.length; i < il; i++)\r\n                        items[i].classList.remove('active');\r\n                    scrollChildIntoView(this._menu, el);\r\n                    el.classList.add('active');\r\n                    if (select)\r\n                        el.firstChild.click();\r\n                }, 100);\r\n            }\r\n            else {\r\n                expand = el.querySelector('.dropdown-menu');\r\n                if (!expand || expand.classList.contains('show')) continue;\r\n                el = el.querySelector('i');\r\n                if (el) {\r\n                    el.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\r\n                    el.classList.toggle('bi-chevron-right');\r\n                    el.classList.toggle('bi-chevron-down');\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private _loadPage(page) {\r\n        return new Promise((resolve, reject) => {\r\n            $.ajax({\r\n                url: 'docs/' + page + '.md',\r\n                cache: false,\r\n                type: 'GET',\r\n            }).done(resolve).fail(reject);\r\n        });\r\n    }\r\n\r\n    private _menuItem(data, indent?) {\r\n        let menu = '';\r\n        indent = indent || 0;\r\n        let padding = indent * 20 + 16;\r\n        indent++;\r\n        menu += `<li class=\"nav-item\" title=\"${data.text}\" id=\"${this._sanitizeID(data.id)}\">`;\r\n        if (data.nodes && data.nodes.length) {\r\n            menu += `<a data-id=\"help/${data.id}\" style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#help/${data.id}\"><i class=\"align-middle float-start bi bi-chevron-right\"></i> ${data.text}</a>`;\r\n            menu += '<ul class=\"dropdown-menu dropdown-inline\">';\r\n            for (let n = 0, nl = data.nodes.length; n < nl; n++)\r\n                menu += this._menuItem(data.nodes[n], indent);\r\n            menu += '</ul>';\r\n        }\r\n        else\r\n            menu += `<a data-id=\"help/${data.id}\" style=\"padding-left: ${padding}px\" class=\"nav-link text-dark\" href=\"#help/${data.id}\"><i class=\"align-middle float-start no-icon\"></i> ${data.text}</a>`;\r\n        menu += '</li>';\r\n        return menu;\r\n    }\r\n\r\n    private _menuItemEvents(item) {\r\n        let items = item.querySelectorAll('.bi-chevron-right');\r\n        let i, il;\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].addEventListener('click', e => {\r\n                e.target.closest('li').querySelector('.dropdown-menu').classList.toggle('show');\r\n                e.target.classList.toggle('bi-chevron-right');\r\n                e.target.classList.toggle('bi-chevron-down');\r\n                e.preventDefault();\r\n            });\r\n    }\r\n\r\n    private _buildMenu() {\r\n        if (this._menuData) return;\r\n        $.ajax({\r\n            url: 'docs/menu.json',\r\n            cache: false,\r\n            type: 'GET',\r\n            dataType: 'json',\r\n        }).done(data => {\r\n            this._menuData = data;\r\n            let nav = '';\r\n            for (let m = 0, ml = data.length; m < ml; m++)\r\n                nav += this._menuItem(data[m]);\r\n            this._menu.innerHTML = '<ul class=\"nav\" id=\"help-menu\">' + nav + '</ul>';\r\n            let items = this._menu.querySelectorAll('a');\r\n            for (let i = 0, il = items.length; i < il; i++) {\r\n                this._menuItemEvents(items[i]);\r\n                items[i].addEventListener('click', e => {\r\n                    if (!this._history.length || this._history[this._current] !== e.currentTarget.dataset.id)\r\n                        this._updateHistory(e.currentTarget.dataset.id);\r\n                });\r\n            }\r\n            let ops = ['<option value=\"\">Table of contents</option>'];\r\n            for (let i = 0; i < data.length; i++) {\r\n                ops.push('<option value=\"', data[i].id, '\">', data[i].text, '</option>');\r\n                if (data[i].nodes && data[i].nodes.length)\r\n                    for (let c = 0; c < data[i].nodes.length; c++)\r\n                        ops.push('<option value=\"', data[i].nodes[c].id, '\">&nbsp;&nbsp;&nbsp;&nbsp;', data[i].nodes[c].text, '</option>');\r\n            }\r\n            this.body.querySelector('#help-jump-menu').innerHTML = ops.join('');\r\n        }).fail(err => this._client.error(err));\r\n    }\r\n\r\n    private _updateButtons() {\r\n        if (this._current === 0 || this._history.length === 0)\r\n            this.body.querySelector('#btn-help-back').disabled = true;\r\n        else\r\n            this.body.querySelector('#btn-help-back').disabled = false;\r\n        if (this._current === this._history.length - 1 || this._history.length === 0)\r\n            this.body.querySelector('#btn-help-forward').disabled = true;\r\n        else\r\n            this.body.querySelector('#btn-help-forward').disabled = false;\r\n        this.body.querySelector('#btn-help-history').disabled = this._history.length <= 1;\r\n    }\r\n\r\n    private _navigate(direction) {\r\n        this._current += direction;\r\n        if (this._current < 0)\r\n            this._current = 0;\r\n        if (this._current >= this._history.length)\r\n            this._current = this._history.length;\r\n        this._updateButtons();\r\n        this.body.querySelector('#help-jump-menu').value = this._history[this._current];\r\n        updateHash(this._history[this._current], this._page);\r\n    }\r\n\r\n    private _updateHistory(page) {\r\n        if (this._history.length !== 0)\r\n            this._history.length = this._current + 1;\r\n        this._history.push(page);\r\n        this._current = this._history.length - 1;\r\n        this._updateButtons();\r\n    }\r\n\r\n    private _updateSmall(width) {\r\n        if (!this.header.querySelector('.breadcrumb')) {\r\n            setTimeout(() => {\r\n                this._updateSmall(width);\r\n            }, 10);\r\n            return;\r\n        }\r\n        if (width < 430) {\r\n            if (this._small) return;\r\n            const item = this.header.querySelector('.breadcrumb');\r\n            item.classList.add('breadcrumb-sm');\r\n            this._small = true;\r\n        }\r\n        else if (this._small) {\r\n            const item = this.header.querySelector('.breadcrumb');\r\n            item.classList.remove('breadcrumb-sm');\r\n            this._small = false;\r\n        }\r\n    }\r\n}", "import { EventEmitter } from '../core/events';\r\nimport { MenuItem } from '../core/types';\r\n\r\nexport class Contextmenu extends EventEmitter {\r\n    private _items: MenuItem[];\r\n    private _menu;\r\n    private _id;\r\n\r\n    constructor(items?: MenuItem[], id?) {\r\n        super();\r\n        this._items = items || [];\r\n        this._id = id || new Date().getTime();\r\n        this._createMenu();\r\n    }\r\n\r\n    private _createMenu() {\r\n        if (!this._menu) {\r\n            let menu: any = `<ul id=\"${this._id}\" class=\"dropdown-menu show\">`;\r\n            for (let i = 0, il = this._items.length; i < il; i++) {\r\n                menu += `<li><a class=\"dropdown-item\" data-index=\"${i}\" href=\"#\">${this._items[i].name}</a></li>`;\r\n            }\r\n            menu += '</ul>';\r\n            document.body.insertAdjacentHTML('afterend', menu);\r\n            this._menu = document.getElementById(this._id);\r\n        }\r\n        let items = this._menu.querySelectorAll('li a');\r\n        for (let i = 0, il = items.length; i < il; i++) {\r\n            items[i].addEventListener('click', e => {\r\n                let index = +e.currentTarget.dataset.index;\r\n                if (typeof this._items[index].action === 'function')\r\n                    (this._items[index].action as any)(this._items[i], e);\r\n                this._cleanUp();\r\n            });\r\n        }\r\n    }\r\n\r\n    private _cleanUp = () => {\r\n        window.removeEventListener('click', this._cleanUp);\r\n        window.removeEventListener('mousedown', this._mouseup);\r\n        window.removeEventListener('keydown', this._cleanUp);\r\n        if (this._menu)\r\n            this._menu.remove();\r\n    }\r\n    private _mouseup = e => {\r\n        if(this._menu.contains(e.srcElement)) return;\r\n        this._cleanUp()\r\n    }\r\n\r\n    public close() {\r\n        this._cleanUp();\r\n    }\r\n\r\n    public show(x, y) {\r\n        this._menu.style.left = x + 'px';\r\n        this._menu.style.top = y + 'px';\r\n        this._menu.style.display = 'block';\r\n        this._menu.style.position = 'absolute';\r\n        setTimeout(() => {\r\n            window.addEventListener('click', this._cleanUp);\r\n            window.addEventListener('mousedown', this._mouseup);\r\n            window.addEventListener('keydown', this._cleanUp);\r\n        }, 100);\r\n    }\r\n\r\n    static popup(items, x, y) {\r\n        new Contextmenu(items).show(x, y);\r\n    }\r\n}", "import '../css/interface.css';\nimport '../css/buttons.css';\nimport '../css/theme.css';\nimport { initMenu } from './menu';\nimport { Client } from '../core/client';\nimport { Dialog, DialogButtons, pasteSpecial } from './dialog';\nimport { openFileDialog, readFile, debounce, copyText, pasteText, setSelectionRange, offset, isPasteSupported, insertValue } from '../core/library';\nimport { AdvEditor } from './adv.editor';\nimport { SettingsDialog } from './settingsdialog';\nimport { ProfilesDialog } from './profilesdialog';\nimport { HelpDialog } from './help';\nimport { Contextmenu } from './contextmenu';\n\ndeclare global {\n    interface Window {\n        initializeInterface;\n        readClipboard;\n        writeClipboard;\n        readClipboardHTML;\n        doLink;\n        doMXPLink;\n        doMXPSend;\n        MXPMenuHandler;\n        doMXPTooltip;\n    }\n    let client: Client;\n}\ndeclare let confirm_box;\n\n//cache the objects once made for later use\nlet editor: AdvEditor;\nlet editorDialog: Dialog;\nlet _currentIcon = -1;\n\n//TODO these are set for context menu\nlet _selword = '';\nlet _selurl = '';\nlet _selline = '';\nlet lastMouse;\n\n//#region MXP display hooks\nfunction doLink(url) {\n    confirm_box('Open?', `Open '${url}'?`).then(e => {\n        if (e.button === DialogButtons.Yes) {\n            window.open(url);\n            if (client.getOption('CommandonClick'))\n                client.commandInput.focus();\n        }\n    });\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction doMXPLink(el, url) {\n    if (url.startsWith('OoMUD://') || url.startsWith('jiMUD://') || url.startsWith('client://'))\n        doMXPSend(0, el, url.substring(8));\n    else {\n        confirm_box('Open?', `Open '${url}'?`).then(e => {\n            if (e.button === DialogButtons.Yes) {\n                window.open(url);\n                if (client.getOption('CommandonClick'))\n                    client.commandInput.focus();\n            }\n        });\n    }\n}\n\nfunction doMXPSend(e, el, url, pmt?, tt?) {\n    let im = el.querySelector('img[ismap]');\n    let extra = '';\n    if (im) {\n        let os = offset(im);\n        let x = Math.floor(e.clientX - os.left);\n        let y = Math.floor(e.clientY - os.top);\n        extra = '?' + x + ',' + y;\n    }\n    if (url.constructor === Array || url.__proto__.constructor === Array || Object.prototype.toString.call(url) === '[object Array]') {\n        let items = [];\n        for (let i = 0, il = url.length; i < il; i++) {\n            url[i] = url[i].replace('&text;', el.textContent);\n            if (i < tt.length)\n                items.push({\n                    name: tt[i],\n                    action: item => MXPMenuHandler(item.cmd, item.pmt),\n                    pmt: pmt,\n                    cmd: url[i] + extra\n                });\n            else\n                items.push({\n                    name: url[i],\n                    action: item => MXPMenuHandler(item.cmd, item.pmt),\n                    pmt: pmt,\n                    cmd: url[i] + extra\n                });\n        }\n        Contextmenu.popup(items, e.clientX, e.clientY);\n    }\n    else if (pmt) {\n        url = url.replace('&text;', el.textContent) + extra;\n        client.commandInput.value = url;\n        setSelectionRange(client.commandInput, url.length, url.length);\n    }\n    else\n        client.send(url.replace('&text;', el.textContent) + extra + '\\n', true);\n    setTimeout(() => {\n        if (client.getOption('CommandonClick'))\n            client.commandInput.focus();\n    }, 0);\n}\n\nfunction MXPMenuHandler(cmd, pmt) {\n    if (pmt) {\n        client.commandInput.value = cmd;\n        setSelectionRange(client.commandInput, cmd.length, cmd.length);\n    }\n    else\n        client.send(cmd, true);\n    setTimeout(() => {\n        if (client.getOption('CommandonClick'))\n            client.commandInput.focus();\n    }, 0);\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction doMXPTooltip(el) {\n    el.title = el.title.replace('&text;', el.textContent);\n}\nwindow.doLink = doLink;\nwindow.doMXPLink = doMXPLink;\nwindow.doMXPSend = doMXPSend;\nwindow.MXPMenuHandler = MXPMenuHandler;\nwindow.doMXPTooltip = doMXPTooltip;\n//#endregion\n\nexport function initializeInterface() {\n    let options;\n    _setIcon(0);\n    initMenu();\n    //#region global scripting functions\n    //not supported bu add stubs to prevent errors from imported scripts\n    window.readClipboard = () => pasteText();\n    window.readClipboardHTML = () => pasteText();\n    (client as any).readClipboard = window.readClipboard;\n    (client as any).readClipboardHTML = window.readClipboardHTML;\n\n    window.writeClipboard = (txt, html) => copyText(txt);\n    (client as any).writeClipboard = window.writeClipboard;\n\n    (client as any).closeWindow = window => {\n        switch (window) {\n            case 'editor':\n            case 'help':\n            case 'about':\n                closeDialog(window);\n                break;\n            case 'profiles':\n            case 'profiles-manager':\n            case 'profile-manager':\n            case 'manager':\n                closeDialog('profiles');\n                break;\n            case 'prefs':\n            case 'options':\n            case 'preferences':\n                closeDialog('settings');\n                break;\n            case 'history':\n            case 'command-history':\n                closeDialog('history');\n                break;\n            default:\n                client.emit('close-window', window);\n                break;\n        }\n    };\n    //#endregion\n    //#region global variables for scripting\n    ['repeatnum', 'i'].forEach((a) => {\n        Object.defineProperty(window, a, {\n            get: function () {\n                if (!client) return undefined;\n                return client.repeatnum;\n            },\n            configurable: true\n        });\n    });\n\n    Object.defineProperty(window, '$selected', {\n        get: function () {\n            if (!client) return '';\n            return client.display.selection;\n        },\n        configurable: true\n    });\n\n    //Not supported but return blank to prevent errors on scripts that use it\n    Object.defineProperty(window, '$copied', {\n        get: function () {\n            return '';\n        },\n        configurable: true\n    });\n\n    Object.defineProperty(window, '$selword', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$selword'] || _selword || (lastMouse ? client.display.getWordFromPosition(lastMouse.pageX, lastMouse.pageY) : '');\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selurl', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selurl'] || _selurl || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            let parent = lastMouse.srcElement.parentNode;\n            if (parent && parent.classList && parent.classList.contains('URLLink'))\n                return parent.title;\n            else if (parent && parent.classList && parent.classList.contains('MXPLink') && parent.dataset && parent.dataset.href && parent.dataset.href.length > 0)\n                return parent.dataset.href;\n            return '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selline', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selline'] || _selline || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            let pos = client.display.getLineOffset(lastMouse.pageX, lastMouse.pageY);\n            if (pos.y < 0 || pos.y >= client.display.lines.length)\n                return '';\n            return client.display.getLineText(pos.y, true);\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedword', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$selectedword'] || _selword || (lastMouse ? client.display.getWordFromPosition(lastMouse.pageX, lastMouse.pageY) : '');\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedurl', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selectedurl'] || _selurl || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            let parent = lastMouse.srcElement.parentNode;\n            if (parent && parent.classList && parent.classList.contains('URLLink'))\n                return parent.title;\n            else if (parent && parent.classList && parent.classList.contains('MXPLink') && parent.dataset && parent.dataset.href && parent.dataset.href.length > 0)\n                return parent.dataset.href;\n            return '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$selectedline', {\n        get: function () {\n            if (!client) return '';\n            let value = client.input.vStack['$selectedline'] || _selline || '';\n            if (value) return value;\n            if (!lastMouse) return '';\n            let pos = client.display.getLineOffset(lastMouse.pageX, lastMouse.pageY);\n            if (pos.y < 0 || pos.y >= client.display.lines.length)\n                return '';\n            return client.display.getLineText(pos.y, true);\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$action', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$action'] || (client.input.lastTriggerExecuted ? client.input.lastTriggerExecuted.value : '') || '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$trigger', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$trigger'] || client.input.lastTriggered || '';\n        },\n        configurable: true\n    });\n    Object.defineProperty(window, '$caption', {\n        get: function () {\n            if (!client) return '';\n            return client.input.vStack['$caption'] || '';\n        },\n        configurable: true\n    });\n    //#endregion\n    //#region client events\n    client.input.on('history-navigate', () => {\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n            resizeCommandInput();\n    });\n    client.on('options-loaded', () => {\n        client.commandInput.removeEventListener('input', resizeCommandInput);\n        client.commandInput.removeEventListener('change', resizeCommandInput);\n        initCommandInput();\n        updateCommandInput();\n        if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n            resizeCommandInput();\n        if (editorDialog) {\n            editorDialog.resetState(client.getWindowState('editor') || { center: true });\n            editorDialog.persistent = client.getOption('editorPersistent');\n            if (editor.simple != client.getOption('simpleEditor')) {\n                let value = '';\n                if (!editor.isSimple)\n                    value = editor.getFormattedText().replace(/(?:\\r)/g, '');\n                editor.simple = client.getOption('simpleEditor');\n                if (!editor.isSimple) {\n                    editorDialog.hideFooter();\n                    if (editorDialog.header.querySelector('#adv-editor-switch'))\n                        editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                }\n                else {\n                    editor.value = value;\n                    editorDialog.showFooter();\n                    if (editorDialog.header.querySelector('#adv-editor-switch'))\n                        editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to advanced';\n                    setTimeout(() => editor.focus(), 100);\n                }\n            }\n        }\n        if (_dialogs.history) _dialogs.history.resetState(client.getWindowState('history') || { center: true, width: 400, height: 275 });\n        if (_dialogs.profiles) _dialogs.profiles.resetState(client.getWindowState('profiles') || { center: true, width: 400, height: 275 });\n        if (_dialogs.help) _dialogs.help.resetState(client.getWindowState('help') || { center: true, width: 400, height: 275 });\n    });\n    client.on('set-title', title => {\n        if (!title || !title.length)\n            title = client.defaultTitle;\n        else if (title.indexOf(client.defaultTitle) === -1)\n            title += ' - ' + client.defaultTitle;\n        if (client.connecting)\n            title = 'Connecting - ' + title;\n        else if (client.connected)\n            title = 'Connected - ' + title;\n        else\n            title = 'Disconnected - ' + title;\n\n        window.document.title = title;\n    });\n    client.on('connected', () => _setIcon(1));\n    client.on('closed', () => _setIcon(0));\n    client.on('received-data', () => {\n        if (!client.active && client.connected)\n            _setIcon(2);\n    })\n    client.on('focus', () => {\n        if (client.connected)\n            _setIcon(1);\n        else\n            _setIcon(0);\n    })\n    client.on('print', () => {\n        if (!client.active && client.connected)\n            _setIcon(2);\n    });\n    client.display.on('selection-done', e => {\n        if (client.getOption('AutoCopySelectedToClipboard') && client.display.hasSelection) {\n            copyText(client.display.selection);\n            client.display.clearSelection();\n        }\n    });\n    client.on('profiles-loaded', () => {\n        buildButtons();\n    });\n    client.on('notify', (title, message, options) => {\n        if (!client.getOption('enableNotifications') || !('Notification' in window)) return;\n        options = options || { silent: true };\n        if (!Object.prototype.hasOwnProperty.call(options, 'silent'))\n            options.silent = true;\n        switch (_currentIcon) {\n            case 1:\n                options.icon = options.icon || 'images/connected.png';\n                break;\n            case 2:\n                options.icon = options.icon || 'images/connectednonactive.png';\n                break;\n            default:\n                options.icon = options.icon || 'images/disconnected.png';\n                break;\n        }\n        if (message) {\n            options.body = message;\n            if (options.body.length > 127)\n                options.body = options.body.substr(0, 127) + '...';\n        }\n        if (Notification.permission === 'granted') {\n            let notify = new window.Notification(title, options);\n            notify.onclick = () => {\n                client.emit('notify-clicked', title, message);\n                client.raise('notify-clicked', [title, message]);\n            };\n            notify.onclose = () => {\n                client.emit('notify-closed', title, message);\n                client.raise('notify-closed', [title, message]);\n            };\n        } else if (Notification.permission !== 'denied') {\n            Notification.requestPermission().then((permission) => {\n                if (permission === 'granted') {\n                    let notify = new window.Notification(title, options);\n                    notify.onclick = () => {\n                        client.emit('notify-clicked', title, message);\n                        client.raise('notify-clicked', [title, message]);\n                    };\n                    notify.onclose = () => {\n                        client.emit('notify-closed', title, message);\n                        client.raise('notify-closed', [title, message]);\n                    };\n                }\n                else\n                    client.echo('Notification permission denied.', -7, -8, true, true);\n            });\n        }\n        else\n            client.echo('Notification permission denied.', -7, -8, true, true);\n    });\n    client.on('window', (window, args, name) => {\n        switch (window) {\n            case 'editor':\n            case 'help':\n            case 'about':\n                if (args === 'close')\n                    closeDialog(window);\n                else\n                    showDialog(window);\n                break;\n            case 'profiles':\n            case 'profiles-manager':\n            case 'profile-manager':\n            case 'manager':\n                if (args === 'close')\n                    closeDialog('profiles');\n                else\n                    showDialog('profiles');\n                break;\n            case 'prefs':\n            case 'options':\n            case 'preferences':\n                if (args === 'close')\n                    closeDialog('settings');\n                else\n                    showDialog('settings');\n                break;\n            case 'history':\n            case 'command-history':\n                if (args === 'close')\n                    closeDialog('history');\n                else\n                    showDialog('history');\n                break;\n        }\n    });\n    //setup advanced editor footer button\n    document.getElementById('btn-adv-editor').addEventListener('click', e => {\n        showDialog('editor');\n    });\n    //#endregion\n    //#region restore dialogs\n    //restore advanced editor\n    options = client.getWindowState('editor');\n    if (options && options.show)\n        document.getElementById('btn-adv-editor').click();\n    options = client.getWindowState('history');\n    if (options && options.show)\n        showDialog('history');\n    options = client.getWindowState('profiles');\n    if (options && options.show)\n        showDialog('profiles');\n    options = client.getWindowState('help');\n    if (options && options.show)\n        showDialog('help');\n    //#endregion\n    document.getElementById('btn-command-history').addEventListener('show.bs.dropdown', function () {\n        document.body.appendChild(document.getElementById('command-history-menu'));\n        let h = '';\n        const menu = document.getElementById('command-history-menu');\n        let history = client.commandHistory;\n        for (let i = 0, il = history.length; i < il; i++)\n            h += `<li id=\"command-history-item-${i}\"><a data-index=\"${i}\" class=\"dropdown-item\" href=\"javascript:void(0)\">${history[i]}</a></li>`;\n        if (history.length) {\n            h += '<li><hr class=\"dropdown-divider\"></li>';\n            h += `<li><a id=\"history-clear\" class=\"dropdown-item\" href=\"javascript:void(0)\">Clear history</a></li>`;\n        }\n        h += `<li><a id=\"history-show\" class=\"dropdown-item\" href=\"javascript:void(0)\">Show history window...</a></li>`;\n        menu.innerHTML = h;\n        if (history.length)\n            menu.querySelector('#history-clear').addEventListener('click', () => {\n                confirm_box('Clear history?', `Clear all history`).then(e => {\n                    if (e.button === DialogButtons.Yes) {\n                        client.clearCommandHistory()\n                    }\n                });\n            });\n        menu.querySelector('#history-show').addEventListener('click', () => showDialog('history'));\n        const items = document.querySelectorAll('[id^=\"command-history-item\"] a');\n        for (let i = 0, il = items.length; i < il; i++) {\n            items[i].addEventListener('click', e => {\n                let cmd = client.commandHistory[parseInt((e.currentTarget as HTMLElement).dataset.index, 10)];\n                client.AddCommandToHistory(cmd);\n                client.sendCommand(cmd, null, client.getOption('allowCommentsFromCommand'));\n            });\n        }\n    });\n    document.getElementById('btn-command-history').addEventListener('hidden.bs.dropdown', function () {\n        document.getElementById('btn-command-history').parentElement.appendChild(document.getElementById('command-history-menu'));\n    });\n    client.commandInput.removeEventListener('input', resizeCommandInput);\n    client.commandInput.removeEventListener('change', resizeCommandInput);\n    initCommandInput();\n    updateCommandInput();\n\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars'))\n        resizeCommandInput();\n    //#region window events\n    window.addEventListener('keydown', (event) => {\n        if (event.which === 33) //page up\n            client.display.pageUp();\n        else if (event.which === 34) //page up\n            client.display.pageDown();\n        else if (event.ctrlKey && event.shiftKey && !event.metaKey && !event.altKey && event.code === 'KeyV') {\n            client.commandInput.dataset.selectionStart = '' + client.commandInput.selectionStart;\n            client.commandInput.dataset.selectionEnd = '' + client.commandInput.selectionEnd;\n            event.preventDefault();\n            event.stopPropagation();\n            (document.querySelector('#menu-paste a') as HTMLAnchorElement).click();\n        }\n    });\n\n    window.addEventListener('error', (e) => {\n        const { message, filename, lineno, colno, error } = e;\n        //not important so ignore it to prevent error spamming when reizing\n        if (message.includes(\"ResizeObserver loop completed with undelivered notifications\"))\n            return;\n        if (client) {\n            if (error)\n                client.error(error);\n            else if (message.startsWith('Uncaught Error: '))\n                client.error(`${message.substr(16)}`);\n            else\n                client.error(`${message}`);\n            if (client.getOption('enableDebug')) {\n                client.error('Url: ' + filename);\n                client.error('Line: ' + lineno);\n                client.error('Column: ' + colno);\n                client.error(error);\n            }\n        }\n        else {\n            console.error('Message: ' + message);\n            console.error('Url: ' + filename);\n            console.error('Line: ' + lineno);\n            console.error('Column: ' + colno);\n            console.error(error);\n        }\n        return true;\n    });\n\n    window.addEventListener('mousemove', event => {\n        lastMouse = event;\n    });\n    window.addEventListener('hashchange', hashChange, false);\n    window.addEventListener('load', hashChange);\n    //#endregion\n    client.on('command-history-changed', history => {\n        _loadHistory();\n    });\n    showButtons();\n    document.addEventListener('copy', e => {\n        const ae = document.activeElement as any;\n        //if active control has a display use that display selection if set so we can add html formating\n        if (ae && ae.display && ae.display.hasSelection) {\n            e.preventDefault();\n            e.clipboardData.setData('text/plain', ae.display.selection);\n            e.clipboardData.setData('text/html', ae.display.selectionAsHTML);\n        }\n        //else if no selection but the main display has a selection copy that\n        else if (!window.getSelection().toString().length && client.display.hasSelection) {\n            if ((ae.tagName === 'TEXTAREA' || ae.tagName === 'INPUT') && ae.value.substring(ae.selectionStart, ae.selectionEnd).length)\n                return;\n            e.preventDefault();\n            e.clipboardData.setData('text/plain', client.display.selection);\n            e.clipboardData.setData('text/html', client.display.selectionAsHTML);\n        }\n    });\n    client.commandInput.addEventListener('paste', async e => {\n        if (isPasteSupported() || !document.querySelector('#menu-paste').classList.contains('active')) {\n            client.commandInput.focus();\n            return true;\n        }\n        try {\n            e.preventDefault();\n            doPasteSpecial(e.clipboardData.getData('text/plain'), true);\n        }\n        catch (err) { }\n        //console.log(await confirm_box('test'));\n    });\n}\n\nexport function removeHash(string) {\n    if (!string || string.length === 0) return;\n    string = string.trim();\n    if (string.startsWith('#'))\n        string = string.substring(1);\n    let hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => s.trim() !== string);\n    window.location.hash = hashes.join(',');\n}\n\nexport function addHash(string) {\n    if (!string || string.length === 0) return;\n    string = string.trim();\n    if (string.startsWith('#'))\n        string = string.substring(1);\n    let hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => s.trim() !== string);\n    hashes.push(string);\n    window.location.hash = hashes.join(',');\n}\n\nexport function updateHash(add: string | string[], remove?: string | string[]) {\n    if (!Array.isArray(add))\n        add = [add];\n    remove = remove || [];\n    if (!Array.isArray(remove))\n        remove = [remove];\n    //remove add, new to ensure no dups\n    remove = remove.concat(...add);\n    let hashes = decodeURI(window.location.hash.substring(1)).split(',').filter(s => s.length && !remove.includes(s.trim()));\n    hashes = hashes.concat(...add);\n    window.location.hash = hashes.join(',');\n}\n\nexport function hashContains(string) {\n    if (!string || !string.length) return false;\n    return decodeURI(window.location.hash.substring(1)).split(',').map(s => s.trim()).indexOf(string) !== -1;\n}\n\nexport function hashStartsWith(string) {\n    if (!string || !string.length) return false;\n    return decodeURI(window.location.hash.substring(1)).split(',').map(s => s.startsWith(string)).length !== 0;\n}\n\nfunction hashChange() {\n    if (!window.location.hash || window.location.hash.length < 2) return;\n    let dialogs = decodeURI(window.location.hash.substring(1)).split(',').map(s => s.trim());\n    for (let d = dialogs.length - 1; d >= 0; d--)\n        switch (dialogs[d]) {\n            case 'about':\n                showDialog('about');\n                break;\n            case 'editor':\n                document.getElementById('btn-adv-editor').click();\n                break;\n            default:\n                if (dialogs[d] === 'history' || dialogs[d].startsWith('settings') || dialogs[d].startsWith('profiles') || dialogs[d].startsWith('help'))\n                    showDialog(dialogs[d]);\n                else\n                    client.emit('window', dialogs[d]);\n                break;\n        }\n}\n\nlet _dialogs: any = {};\nexport function showDialog(name: string) {\n    switch (name) {\n        case 'about':\n            if (!_dialogs.about) {\n                _dialogs.about = new Dialog(({ title: '<i class=\"bi-info-circle\"></i> About', width: 350, height: 400, noFooter: true, resizable: false, center: true, maximizable: false }));\n                _dialogs.about.on('closed', () => {\n                    _dialogs.about.removeAllListeners();\n                    delete _dialogs.about;\n                    removeHash(name);\n                });\n                _dialogs.about.on('canceled', () => {\n                    _dialogs.about.removeAllListeners();\n                    delete _dialogs.about;\n                    removeHash(name);\n                });\n            }\n            loadDialog(_dialogs.about, name, 1, true).catch(e => {\n                client.error(e);\n            });\n            return _dialogs.about;\n        case 'history':\n            if (!_dialogs.history) {\n                _dialogs.history = new Dialog(Object.assign({}, client.getWindowState('history') || { center: true, width: 400, height: 275 }, { title: '<i class=\"bi bi-clock-history\"></i> Command history', id: 'command-history' }));\n                _dialogs.history.on('closed', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                    _dialogs.history.removeAllListeners();\n                    delete _dialogs.history;\n                    removeHash(name);\n                });\n                _dialogs.history.on('canceled', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                    removeHash('history');\n                    _dialogs.history.removeAllListeners();\n                    delete _dialogs.history;\n                    removeHash(name);\n                });\n                _dialogs.history.on('resized', e => {\n                    client.setOption('windows.history', e);\n                });\n                _dialogs.history.on('moved', e => {\n                    client.setOption('windows.history', e);\n                })\n                _dialogs.history.on('maximized', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                _dialogs.history.on('restored', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                _dialogs.history.on('shown', () => {\n                    client.setOption('windows.history', _dialogs.history.windowState);\n                });\n                let footer = '';\n                footer += `<button id=\"${_dialogs.history.id}-clear\" type=\"button\" class=\"btn-sm float-end btn btn-danger\" title=\"Clear history\"><i class=\"bi bi-trash\"></i><span class=\"icon-only\"> Clear</span></button>`;\n                footer += `<button id=\"${_dialogs.history.id}-send\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Send\"><i class=\"bi bi-send-fill\"></i><span class=\"icon-only\"> Send</span></button>`;\n                footer += `<button id=\"${_dialogs.history.id}-refresh\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Refresh\"><i class=\"bi bi-arrow-repeat\"></i><span class=\"icon-only\"> Refresh</span></button>`\n                _dialogs.history.footer.innerHTML = footer;\n                _dialogs.history.body.innerHTML = `<select id=\"history-list\" multiple=\"multiple\" class=\"form-select\"></select>`;\n\n                _dialogs.history.body.querySelector('#history-list').addEventListener('dblclick', e => {\n                    const cmd = e.currentTarget.value;\n                    client.AddCommandToHistory(cmd);\n                    client.sendCommand(cmd, false, client.getOption('allowCommentsFromCommand'));\n                    _dialogs.history.close();\n                });\n                _dialogs.history.body.querySelector('#history-list').addEventListener('change', e => {\n                    client.setHistoryIndex(e.currentTarget.selectedIndex);\n                    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).style.display = history.length && _dialogs.history.body.querySelector('#history-list').selectedIndex !== -1 ? '' : 'none';\n                });\n\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-refresh`).addEventListener('click', () => _loadHistory())\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).addEventListener('click', () => {\n                    const list = _dialogs.history.body.querySelector('#history-list');\n                    let cmds = []\n                    for (let l = 0, ll = list.options.length; l < ll; l++) {\n                        if (list.options[l].selected) {\n                            cmds.push(list.options[l].value);\n                        }\n                    }\n                    for (let c = 0, cl = cmds.length; c < cl; c++) {\n                        client.AddCommandToHistory(cmds[c]);\n                        client.sendCommand(cmds[c], false, client.getOption('allowCommentsFromCommand'));\n                    }\n                });\n                _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-clear`).addEventListener('click', () => {\n                    confirm_box('Clear history?', `Clear all history`).then(e => {\n                        if (e.button === DialogButtons.Yes) {\n                            client.clearCommandHistory();\n                        }\n                    });\n                });\n            }\n            _loadHistory();\n            _dialogs.history.show();\n            return _dialogs.history;\n        case 'editor':\n            if (!editorDialog) {\n                editorDialog = new Dialog(Object.assign({}, client.getWindowState('editor') || { center: true }, { title: '<i class=\"fas fa-edit\"></i> Advanced editor', id: 'adv-editor', persistent: client.getOption('editorPersistent') }));\n                editorDialog.on('resized', e => {\n                    client.setOption('windows.editor', e);\n                });\n                editorDialog.on('moved', e => {\n                    client.setOption('windows.editor', e);\n                })\n                editorDialog.on('maximized', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                });\n                editorDialog.on('restored', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                });\n                editorDialog.on('shown', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    editor.initialize();\n                });\n                editorDialog.on('closing', () => {\n                    if (!client.getOption('editorPersistent'))\n                        editor.remove();\n                    else\n                        editor.clear();\n                });\n                editorDialog.on('closed', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    if (!client.getOption('editorPersistent')) {\n                        editorDialog.dialog.editor.removeAllListeners();\n                        delete editorDialog.dialog.editor;\n                        editorDialog.removeAllListeners();\n                        editor = null;\n                        editorDialog = null;\n                    }\n                    removeHash('editor');\n                });\n                editorDialog.on('canceling', () => {\n                    if (!client.getOption('editorPersistent'))\n                        editor.remove();\n                    else\n                        editor.clear();\n                });\n                editorDialog.on('canceled', () => {\n                    client.setOption('windows.editor', editorDialog.windowState);\n                    if (!client.getOption('editorPersistent')) {\n                        editorDialog.dialog.editor.removeAllListeners();\n                        delete editorDialog.dialog.editor;\n                        editor.removeAllListeners();\n                        editor = null;\n                        editorDialog = null;\n                    }\n                    removeHash('editor');\n                });\n                editorDialog.on('focus', () => editor.focus());\n                const textarea = document.createElement('textarea');\n                textarea.classList.add('form-control', 'form-control-sm');\n                textarea.id = 'adv-editor-txt';\n                editorDialog.body.appendChild(textarea);\n                editorDialog.body.style.overflow = 'hidden';\n                if (!editor) editor = new AdvEditor(textarea, !client.getOption('simpleEditor'));\n                editor.on('close', () => {\n                    editorDialog.close();\n                });\n                editor.on('editor-init', () => editor.focus());\n                editor.on('click', () => editorDialog.focus());\n                editorDialog.dialog.editor = editor;\n                if (TINYMCE && tinymce)\n                    editorDialog.header.querySelector('#adv-editor-max').insertAdjacentHTML('afterend', '<button type=\"button\" class=\"btn btn-light float-end\" id=\"adv-editor-switch\" title=\"Switch to advanced\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi-shuffle\"></i></button>');\n                editorDialog.footer.innerHTML = `<button id=\"btn-adv-editor-clear\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Clear editor\"><i class=\"bi bi-journal-x\"></i><span class=\"icon-only\"> Clear</span></button><button id=\"btn-adv-editor-append\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Append file...\"><i class=\"bi bi-box-arrow-in-down\"></i><span class=\"icon-only\"> Append file...</span></button><button id=\"btn-adv-editor-send\" type=\"button\" class=\"btn-sm float-end btn btn-primary\" title=\"Send\"><i class=\"bi bi-send-fill\"></i><span class=\"icon-only\"> Send</span></button>`;\n                if (editorDialog.header.querySelector('#adv-editor-switch')) {\n                    if (!editor.isSimple)\n                        editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                    editorDialog.header.querySelector('#adv-editor-switch').addEventListener('click', () => {\n                        client.setOption('simpleEditor', !editor.simple);\n                        let value = '';\n                        if (!editor.isSimple)\n                            value = editor.getFormattedText().replace(/(?:\\r)/g, '');\n                        editor.simple = !editor.simple;\n                        if (!editor.isSimple) {\n                            editorDialog.hideFooter();\n                            editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to simple';\n                        }\n                        else {\n                            editor.value = value;\n                            editorDialog.showFooter();\n                            editorDialog.header.querySelector('#adv-editor-switch').title = 'Switch to advanced';\n                            setTimeout(() => editor.focus(), 100);\n                        }\n                    });\n                }\n                document.getElementById('btn-adv-editor-append').addEventListener('click', () => {\n                    openFileDialog('Append file', false).then(files => {\n                        readFile(files[0]).then((contents: any) => {\n                            editor.insert(contents);\n                        }).catch(client.error);\n                    }).catch(() => { });\n                });\n                document.getElementById('btn-adv-editor-send').addEventListener('click', () => {\n                    client.sendCommand(editor.value());\n                    if (client.getOption('editorClearOnSend'))\n                        editor.clear();\n                    if (client.getOption('editorCloseOnSend'))\n                        editorDialog.close();\n                });\n                document.getElementById('btn-adv-editor-clear').addEventListener('click', () => {\n                    editor.clear();\n                    editor.focus();\n                });\n                if (!editor.isSimple)\n                    editorDialog.hideFooter();\n            }\n            editorDialog.show();\n            if (editor.isSimple)\n                editor.focus();\n            return editorDialog;\n    }\n    if (name.startsWith('settings')) {\n        if (!_dialogs.settings) {\n            _dialogs.settings = new SettingsDialog();\n            _dialogs.settings.on('closed', () => {\n                _dialogs.settings.removeAllListeners();\n                delete _dialogs.settings;\n            });\n            _dialogs.settings.on('canceled', () => {\n                _dialogs.settings.removeAllListeners();\n                delete _dialogs.settings;\n            });\n        }\n        if (name === 'settings') {\n            _dialogs.settings.dialog.dataset.path = name;\n            _dialogs.settings.dialog.dataset.fullPath = name;\n            _dialogs.settings.dialog.dataset.hash = window.location.hash;\n            _dialogs.settings.setBody('', { client: client });\n            _dialogs.settings.showModal();\n        }\n        else\n            loadDialog(_dialogs.settings, name, 2, false).catch(e => {\n                client.error(e);\n            });\n        return _dialogs.settings;\n    }\n    if (name.startsWith('profiles')) {\n        if (!_dialogs.profiles) {\n            _dialogs.profiles = new ProfilesDialog();\n            _dialogs.profiles.on('closed', () => {\n                _dialogs.profiles.removeAllListeners();\n                delete _dialogs.profiles;\n            });\n            _dialogs.profiles.on('canceled', () => {\n                _dialogs.profiles.removeAllListeners();\n                delete _dialogs.profiles;\n            });\n            if (name === 'profiles' && (window.location.hash.length < 2 || hashContains('profiles'))) {\n                if (this.client.profiles && this.client.profiles.contains(this.client.getOption('profiles.profileSelected'))) {\n                    setTimeout(() => {\n                        _dialogs.profiles.expandPath(this.client.getOption('profiles.profileSelected') + '/aliases')\n                        updateHash('profiles/' + this.client.getOption('profiles.profileSelected'), name);\n                    }, 100);\n                }\n                else if (!this.client.profiles)\n                    this.client.once('profiles-loaded', () => {\n                        if (this.client.profiles.contains(this.client.getOption('profiles.profileSelected'))) {\n                            _dialogs.profiles.expandPath(this.client.getOption('profiles.profileSelected') + '/aliases')\n                            updateHash('profiles/' + this.client.getOption('profiles.profileSelected'), name);\n                        }\n                    });\n            }\n        }\n        _dialogs.profiles.dialog.dataset.path = name;\n        _dialogs.profiles.dialog.dataset.fullPath = name;\n        _dialogs.profiles.dialog.dataset.hash = window.location.hash;\n        _dialogs.profiles.setBody('', { client: client });\n        _dialogs.profiles.show();\n        return _dialogs.profiles;\n    }\n    if (name.startsWith('help')) {\n        if (!_dialogs.help) {\n            _dialogs.help = new HelpDialog();\n            _dialogs.help.on('closed', () => {\n                _dialogs.help.removeAllListeners();\n                delete _dialogs.help;\n            });\n            _dialogs.help.on('canceled', () => {\n                _dialogs.help.removeAllListeners();\n                delete _dialogs.help;\n            });\n        }\n        if (name !== window.location.hash.substring(1)) {\n            let hashes = decodeURI(window.location.hash.substring(1)).split(',').map(s => s.trim());\n            for (let h = 0, hl = hashes.length; h < hl; h++) {\n                if (hashes[h].startsWith('help')) {\n                    name = hashes[h];\n                    break;\n                }\n            }\n        }\n        _dialogs.help.dialog.dataset.path = name;\n        _dialogs.help.dialog.dataset.fullPath = name;\n        _dialogs.help.dialog.dataset.hash = window.location.hash;\n        _dialogs.help.setBody('', true);\n        _dialogs.help.show();\n        return _dialogs.help;\n    }\n}\n\nexport function loadDialog(dialog: Dialog, path, show?, showError?) {\n    return new Promise((resolve, reject) => {\n        let subpath = path.split('/');\n        $.ajax({\n            url: 'dialogs/' + subpath[0] + '.htm',\n            cache: false,\n            type: 'GET',\n        })\n            .done(function (data) {\n                dialog.dialog.dataset.path = subpath[0];\n                dialog.dialog.dataset.fullPath = path;\n                dialog.dialog.dataset.hash = window.location.hash;\n                dialog.setBody(data, { client: client });\n                if (show == 1)\n                    dialog.show();\n                else if (show === 2)\n                    dialog.showModal();\n                resolve(data);\n            })\n            .fail(function (err) {\n                if (showError && client.enableDebug)\n                    dialog.setBody(`<h1 style=\"width: 100%;text-align:center\">Error loading ${path}</h1> ${err.statusText}`);\n                else if (showError)\n                    dialog.setBody(`<h1 style=\"width: 100%;text-align:center\">Error loading ${path}</h1>`);\n                else\n                    dialog.setBody('');\n                reject(path + ': ' + subpath.statusText);\n            });\n    });\n}\n\nexport function closeDialog(dialog) {\n    if (_dialogs[dialog])\n        _dialogs[dialog].close();\n    else if (dialog === 'editor') {\n        if (editorDialog)\n            editorDialog.close();\n    }\n}\n\nfunction _loadHistory() {\n    if (!_dialogs.history) return;\n    const list: HTMLSelectElement = document.getElementById('history-list') as HTMLSelectElement;\n    list.innerHTML = '';\n    let history = client.commandHistory;\n    let fragment = document.createDocumentFragment();\n    for (let i = 0, l = history.length; i < l; i++) {\n        let opt = document.createElement('option');\n        opt.appendChild(document.createTextNode(history[i]));\n        opt.value = history[i];\n        fragment.append(opt);\n    }\n    list.appendChild(fragment);\n    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-clear`).style.display = history.length ? '' : 'none';\n    _dialogs.history.footer.querySelector(`#${_dialogs.history.id}-send`).style.display = history.length && list.selectedIndex !== -1 ? '' : 'none';\n}\n\nfunction resizeCommandInput() {\n    debounce(() => {\n        _resizeCommandInput();\n    }, 250, 'resizeCommand');\n}\n\nasync function initCommandInput() {\n    if (client.getOption('commandAutoSize') || client.getOption('commandScrollbars')) {\n        client.commandInput.addEventListener('input', resizeCommandInput);\n        client.commandInput.addEventListener('change', resizeCommandInput);\n    }\n    if (client.getOption('commandWordWrap')) {\n        document.getElementById('commandMeasure').style.whiteSpace = 'pre-wrap';\n        document.getElementById('commandMeasure').style.overflowWrap = 'anywhere';\n    }\n    else {\n        document.getElementById('commandMeasure').style.whiteSpace = '';\n        document.getElementById('commandMeasure').style.overflowWrap = '';\n    }\n    if (client.getOption('commandScrollbars')) {\n        document.getElementById('commandMeasure').style.overflow = 'auto';\n        client.commandInput.style.overflow = 'auto';\n    }\n    else {\n        document.getElementById('commandMeasure').style.overflow = '';\n        client.commandInput.style.overflow = '';\n    }\n}\n\nlet commandInputResize: any = {};\nfunction updateCommandInput() {\n    const measure = document.getElementById('commandMeasure');\n    document.body.appendChild(measure);\n    const cmd = client.commandInput.parentElement;\n    const cmdSize = window.getComputedStyle(cmd);\n    measure.style.fontSize = client.commandInput.style.fontSize;\n    measure.style.fontFamily = client.commandInput.style.fontFamily;\n    measure.style.width = client.commandInput.offsetWidth + 'px';\n    const oldMeasure = measure.innerHTML;\n    measure.innerHTML = 'W';\n    let minHeight = client.getOption('commandMinLines');\n    const height = measure.offsetHeight;\n    minHeight = height * (minHeight < 1 ? 1 : minHeight);\n    let padding = parseFloat(cmdSize.borderTopWidth) || 0;\n    padding += parseFloat(cmdSize.borderBottomWidth) || 0;\n    padding += parseFloat(cmdSize.paddingTop) || 0;\n    padding += parseFloat(cmdSize.paddingBottom) || 0;\n    let inset = cmdSize.inset.split(' ');\n    padding += (parseFloat(inset[0]) || 0) * 2;\n    measure.innerHTML = oldMeasure;\n    cmd.style.height = (height + padding) + 'px';\n    /*\n    TODO need to rethink this logic and in _resizeCommandInput, as the current interface has 3 layers the nav group, then input group, then the input itself\n    may need to walk the chain up til body or until it finds shared container with display and resize each one based on positions/paddings/margins\n    */\n    client.commandInput.parentElement.style.height = height + 'px';\n    client.commandInput.closest('nav').style.height = height + 'px';\n    client.display.container.style.bottom = (height + padding) + 'px';\n\n    commandInputResize = {\n        measure: measure,\n        cmd: cmd,\n        cmdSize: cmdSize,\n        height: height,\n        padding: padding,\n        minHeight: minHeight\n    }\n}\n\nfunction _resizeCommandInput() {\n    const measure = commandInputResize.measure;\n    const cmd = commandInputResize.cmd;\n    measure.innerHTML = client.commandInput.value + '\\n';\n    let height = measure.offsetHeight;\n    if (height < commandInputResize.minHeight)\n        height = commandInputResize.minHeight;\n    const padding = commandInputResize.padding;\n    cmd.style.height = (height + padding) + 'px';\n    client.commandInput.parentElement.style.height = height + 'px';\n    client.commandInput.closest('nav').style.height = height + 'px';\n    client.display.container.style.bottom = (height + padding) + 'px';\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction _setIcon(ico) {\n    if (_currentIcon === ico)\n        return;\n    _currentIcon = ico;\n    let icon = 'disconnected';\n    switch (ico) {\n        case 1:\n            icon = 'connected';\n            break;\n        case 2:\n            icon = 'connectednonactive';\n            break;\n    }\n    document.getElementById('icon1').remove();\n    document.getElementById('icon2').remove();\n    document.getElementById('icon3').remove();\n    document.querySelector('head').insertAdjacentHTML('afterbegin', `<link id=\"icon1\" rel=\"shortcut icon\" href=\"images/${icon}.ico\" /><link id=\"icon2\" rel=\"icon\" href=\"images/${icon}.ico\" /><link id=\"icon3\" rel=\"icon\" type=\"image/x-icon\" href=\"images/${icon}.png\" />`);\n}\n\nexport function toggleButtons() {\n    client.setOption('showButtons', !client.getOption('showButtons'));\n    showButtons();\n}\n\nfunction createButton(button, index) {\n    let c = '';\n    let tt = '';\n    let caption = button.caption;\n    let bh = 0;\n    if (caption.substring(0, 3) === 'fa-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fas ' + caption[0] + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fas ' + caption[0] + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fas-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fas fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fas fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'far-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"far fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"far fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fab-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fab fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fab fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fal-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fal fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fal fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 4) === 'fat-') {\n        caption = caption.split(',');\n        if (caption.length > 1)\n            caption = '<i class=\"fat fa-' + caption[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + caption[1] + '\"></i>';\n        else\n            caption = '<i class=\"fat fa-' + caption[0].substring(4) + ' fa-fw\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 3) === 'bi-') {\n        caption = '<i class=\"bi ' + caption + '\"></i>';\n        bh = 26;\n    }\n    else if (caption.substring(0, 7) === 'http://' || caption.substring(0, 7) === 'https://')\n        caption = '<img src=\"' + caption + '\" style=\"max-width: ' + button.width + 'px;max-height:' + button.height + 'px\"/>';\n    else {\n        if (!button.iconOnly)\n            caption = button.caption;\n        tt = button.caption;\n    }\n    if (button.icon && button.icon.length) {\n        let icon = button.icon;\n        if (icon.substring(0, 3) === 'fa-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fas ' + icon[0] + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fas ' + icon[0] + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'fas-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fas fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fas fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'far-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"far fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"far fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'fab-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fab fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fab fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'fal-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fal fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fal fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 4) === 'falt-') {\n            icon = icon.split(',');\n            if (icon.length > 1)\n                icon = '<i class=\"fat fa-' + icon[0].substring(4) + ' fa-fw\" data-fa-transform=\"' + icon[1] + '\"></i>';\n            else\n                icon = '<i class=\"fat fa-' + icon[0].substring(4) + ' fa-fw\"></i>';\n            bh = 26;\n        }\n        else if (icon.substring(0, 3) === 'bi-') {\n            icon = '<i class=\"bi ' + icon[0] + '\"></i>';\n            bh = 26;\n        }\n        else if (button.icon.length) {\n            icon = '<img src=\"' + icon + '\" style=\"max-width: ' + button.width + 'px;max-height:' + button.height + 'px\"/>';\n        }\n        if (button.iconOnly)\n            caption = icon;\n        else\n            caption = icon + caption;\n    }\n    c += '<button';\n    c += ' data-index=\"' + index + '\"';\n    if (button.name && button.name.length !== 0)\n        c += ' id=\"button-' + button.name + '\"';\n    c += ' class=\"user-button\" style=\"';\n    if (button.left === -1 && button.right === -1 && button.top === -1 && button.bottom === -1) {\n        c += 'position: static;margin-right:2px;margin-top:2px;';\n    }\n    else {\n        if (button.left >= 0)\n            c += 'left:' + (button.left || 0) + 'px;';\n        if (button.top >= 0)\n            c += 'top:' + (button.top || 0) + 'px;';\n        if (button.bottom >= 0)\n            c += 'bottom:' + (button.bottom || 0) + 'px;';\n        if (button.right >= 0)\n            c += 'right:' + (button.right || 0) + 'px;';\n        if (button.right === -1 && button.left === -1)\n            c += 'right:0px;';\n        if (button.bottom === -1 && button.top === -1)\n            c += 'top:0px;';\n    }\n    if (button.width)\n        c += 'width: ' + button.width + 'px;';\n    else if (bh === 26)\n        c += 'min-width: 26px;';\n    if (button.height)\n        c += 'height: ' + button.height + 'px;';\n    c += '\" title=\"' + tt + '\" draggable=\"true\" data-index=\"' + index + '\">' + caption + '</button>';\n    return c;\n}\n\nfunction showButtons() {\n    if (client.getOption('showButtons'))\n        document.getElementById('buttons').style.visibility = 'visible';\n    else\n        document.getElementById('buttons').style.visibility = '';\n}\n\nfunction buildButtons() {\n    let c = '';\n    let buttons = client.buttons;\n    let b, bl;\n    for (b = 0, bl = buttons.length; b < bl; b++) {\n        if (!buttons[b].enabled) continue;\n        c += createButton(buttons[b], b);\n    }\n    document.getElementById('buttons').innerHTML = c;\n    const items = document.querySelectorAll('#buttons button');\n    for (let i = 0, il = items.length; i < il; i++) {\n        items[i].addEventListener('click', e => {\n            ExecuteButton(e.currentTarget, +(e.currentTarget as HTMLElement).dataset.index);\n        });\n        dragButton(items[i]);\n    }\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction ExecuteButton(el, idx) {\n    if (idx < 0) return false;\n    if (el.dataset.moving === 'true') {\n        delete el.dataset.moving;\n        return;\n    }\n    let buttons = client.buttons;\n    if (idx >= buttons.length) return false;\n    let button = buttons[idx];\n    if (!button.enabled) return false;\n    let ret;// = '';\n    switch (button.style) {\n        case 1:\n            ret = client.parseOutgoing(button.value);\n            break;\n        case 2:\n            /*jslint evil: true */\n            let f = new Function('try { ' + button.value + '} catch (e) { if(this.options.showScriptErrors) this.error(e);}');\n            ret = f.apply(client);\n            break;\n        default:\n            ret = button.value;\n            break;\n    }\n    if (ret === null || typeof ret == 'undefined')\n        return true;\n    if (button.send) {\n        if (!ret.endsWith('\\n'))\n            ret += '\\n';\n        if (button.chain) {\n            if (client.commandInput.value.endsWith(' ')) {\n                client.commandInput.value += ret;\n                client.sendCommand();\n                return true;\n            }\n        }\n        if (client.connected)\n            client.send(ret);\n        if (client.telnet.echo && client.getOption('commandEcho'))\n            client.echo(ret);\n    }\n    else if (button.append)\n        client.commandInput.value += ret;\n    return true;\n}\n\nfunction dragButton(elmnt) {\n    let pos3 = 0, pos4 = 0;\n    let delay;\n    if (document.getElementById(elmnt.id + 'header')) {\n        // if present, the header is where you move the DIV from:\n        document.getElementById(elmnt.id + 'header').onmousedown = dragMouseDown;\n    } else {\n        // otherwise, move the DIV from anywhere inside the DIV:\n        elmnt.onmousedown = dragMouseDown;\n        elmnt.ontouchstart = dragTouchStart;\n        elmnt.onmouseleave = dragMouseleave;\n    }\n\n    function dragMouseDown(e) {\n        e = e || window.event;\n        if (e.buttons !== 1) return;\n        e.preventDefault();\n        let b = elmnt.getBoundingClientRect();\n        pos3 = e.pageX - b.left;\n        pos4 = e.pageY - b.top;\n        document.onmouseup = closeDragButton;\n        delay = setTimeout(function () {\n            document.onmousemove = elementDrag;\n            delay = null;\n        }, 500);\n    }\n\n    function dragMouseleave() {\n        if (delay)\n            closeDragButton();\n    }\n\n    function elementDrag(e) {\n        e = e || window.event;\n        e.preventDefault();\n        // calculate the new cursor position:\n\n        // set the element's new position:\n        elmnt.style.position = 'absolute';\n        elmnt.style.top = (e.pageY - pos4) + 'px';\n        elmnt.style.left = (e.pageX - document.body.clientWidth - pos3) + 'px';\n        elmnt.dataset.moving = 'true';\n    }\n\n    function dragTouchStart(e) {\n        e = e || window.event;\n        if (!e.touches.length) return;\n        //e.preventDefault();\n        let b = elmnt.getBoundingClientRect();\n        pos3 = e.touches[0].pageX - b.left;\n        pos4 = e.touches[0].pageY - b.top;\n        document.ontouchend = closeDragButton;\n        delay = setTimeout(function () {\n            document.ontouchmove = elementMove;\n            delay = null;\n        }, 500);\n    }\n\n    function elementMove(e) {\n        e = e || window.event;\n        e.preventDefault();\n        // calculate the new cursor position:\n\n        // set the element's new position:\n        elmnt.style.position = 'absolute';\n        if (!e.touches.length) return;\n        elmnt.style.top = (e.touches[0].pageY - pos4) + 'px';\n        elmnt.style.left = (e.touches[0].pageX - document.body.clientWidth - pos3) + 'px';\n        elmnt.dataset.moving = 'true';\n    }\n\n    function closeDragButton() {\n        // stop moving when mouse button is released:\n        let b = elmnt.getBoundingClientRect();\n        let idx = parseInt(elmnt.dataset.index, 10);\n        if (idx < 0) return;\n        let buttons = client.buttons;\n        if (idx >= buttons.length) return;\n        let button = buttons[idx];\n        if (!button.enabled) return;\n        if (button.left === -1 && button.right === -1 && button.top === -1 && button.bottom === -1) {\n            button.top = b.top || -1;\n            button.right = document.body.clientWidth - b.right || -1;\n        }\n        else {\n            if (button.left >= 0)\n                button.left = (document.body.clientWidth - b.left) || -1;\n            if (button.top >= 0)\n                button.top = b.top || -1;\n            if (button.bottom >= 0)\n                button.bottom = b.bottom || -1;\n            if (button.right >= 0)\n                button.right = document.body.clientWidth - b.right || -1;\n            if (button.right === -1 && button.left === -1)\n                button.right = document.body.clientWidth - b.right || -1;\n            if (button.bottom === -1 && button.top === -1)\n                button.top = b.top || -1;\n        }\n\n        document.onmouseup = null;\n        document.onmousemove = null;\n        document.ontouchend = null;\n        document.ontouchmove = null;\n        clearTimeout(delay);\n        client.saveProfiles();\n    }\n}\n\nexport function closeDropdowns() {\n    document.querySelectorAll('.dropdown-menu.show,.dropdown-toggle.show').forEach(d => {\n        d.classList.remove('show');\n        if (d.ariaExpanded === 'true')\n            d.ariaExpanded = 'false';\n    });\n}\n\nwindow.initializeInterface = initializeInterface;\n/*\n//auto load the interface if client created\n//limit how many times to to avoid infinite loop\nlet cnt = 0;\nfunction readyInterface() {\n    //try only 10 times to prevent infinite loop\n    if(cnt > 10) return;\n    //if defined init the interface\n    if (window.client)\n        initializeInterface();\n    else //not defined so try again after cnt delay\n        setTimeout(() => readyInterface(), cnt);\n    cnt++;\n}\nreadyInterface();\n*/\n\nexport async function doPasteSpecial(txt, showDisable?) {\n    let results: any = await pasteSpecial({\n        prefixEnabled: client.getOption('pasteSpecialPrefixEnabled'),\n        postfixEnabled: client.getOption('pasteSpecialPostfixEnabled'),\n        replaceEnabled: client.getOption('pasteSpecialReplaceEnabled'),\n        prefix: client.getOption('pasteSpecialPrefix'),\n        postfix: client.getOption('pasteSpecialPostfix'),\n        replace: client.getOption('pasteSpecialReplace'),\n        disable: client.getOption('pasteSpecialDisable'),\n        showDisable: showDisable\n    });\n    if (results.button === 1) {\n        client.setOption('pasteSpecialPrefixEnabled', results.options.prefixEnabled);\n        client.setOption('pasteSpecialPostfixEnabled', results.options.postfixEnabled);\n        client.setOption('pasteSpecialReplaceEnabled', results.options.replaceEnabled);\n        client.setOption('pasteSpecialPrefix', results.options.prefix);\n        client.setOption('pasteSpecialPostfix', results.options.postfix);\n        client.setOption('pasteSpecialReplace', results.options.replace);\n        client.setOption('pasteSpecialDisable', results.options.disable);\n        var post = results.options.postfixEnabled ? results.options.postfix : 0;\n        var pre = results.options.prefixEnabled ? results.options.prefix : 0;\n        var replace = results.options.replaceEnabled ? results.options.replace : 0;\n        if (replace && replace.length)\n            txt = txt.replace(/\\n/g, replace);\n        if (pre && pre.length && post && post.length)\n            txt = pre + txt.replace(/\\n/g, `${post}\\n${pre}`) + post;\n        else if (pre && pre.length)\n            txt = pre + txt.replace(/\\n/g, `\\n${pre}`);\n        else if (post && post.length)\n            txt = txt.replace(/\\n/g, `${post}\\n`) + post;\n        if (client.commandInput.dataset.selectionStart && client.commandInput.dataset.selectionStart.length) {\n            client.commandInput.selectionStart = +client.commandInput.dataset.selectionStart;\n            client.commandInput.selectionEnd = +client.commandInput.dataset.selectionEnd;\n        }        \n        insertValue(client.commandInput, txt);\n        client.commandInput.dataset.selectionStart = '';\n        client.commandInput.dataset.selectionEnd = '';        \n        if (results.options.disable)\n            document.querySelector('#menu-paste').classList.remove('active');\n    }\n    client.commandInput.focus();\n}", "<div class=\"offcanvas offcanvas-start\" data-bs-scroll=\"true\" data-bs-backdrop=\"false\" tabindex=\"-1\" id=\"mapper-menu\" aria-labelledby=\"mapper-menu-Label\" style=\"position:absolute\"><div class=\"offcanvas-body\"><button type=\"button\" class=\"btn btn-close text-reset btn-danger btn-close text-reset\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\" style=\"position:absolute;right:5px;top:5px\"></button><ul class=\"navbar-nav justify-content-end flex-grow-1\"><li id=\"mapper-enable\" class=\"nav-item\" title=\"Enable\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"bi bi-map\"></i>&nbsp;<span>Enabled</span></a></li><li id=\"mapper-legend\" class=\"nav-item\" title=\"Show legend\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-map-marker\"></i>&nbsp;<span>Show legend</span></a></li><li id=\"mapper-room\" class=\"nav-item\" title=\"Show room properties\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-list-alt\"></i>&nbsp;<span>Show room properties</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-refresh\" class=\"nav-item\" title=\"Refresh\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-refresh\"></i>&nbsp;<span>Refresh</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-split\" class=\"nav-item\" title=\"Split areas\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-object-ungroup\"></i>&nbsp;<span>Split areas</span></a></li><li id=\"mapper-fill\" class=\"nav-item\" title=\"Display walls\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"fa fa-building\"></i>&nbsp;<span>Display walls</span></a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-remove\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#remove-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"remove-submenu\"><i class=\"fa fa-eraser\"></i>&nbsp;<span>Remove</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"remove-submenu\"><li class=\"nav-item\" id=\"mapper-remove-selected\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Remove selected room</a></li><li class=\"nav-item\" id=\"mapper-remove-current\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Remove current room</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-remove-current-area\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Remove current area</a></li><li id=\"mapper-remove-all\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Remove all</a></li></ul></li><li id=\"mapper-export\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#export-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"export-submenu\"><i class=\"fa fa-exchange\"></i>&nbsp;<span>Export/Import</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"export-submenu\"><li id=\"mapper-export-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Export as image</a></li><li id=\"mapper-export-scaled-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Export as scaled image</a></li><li id=\"mapper-export-current-image\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Export current view as image</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-export-current-area\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Export current area</a></li><li id=\"mapper-export-all\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Export all</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-import-merge\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Import and merge</a></li><li id=\"mapper-import-replace\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Import and replace</a></li></ul></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-export\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\" role=\"button\" data-bs-target=\"#actions-submenu\" data-bs-toggle=\"collapse\" aria-expanded=\"false\" aria-controls=\"actions-submenu\"><i class=\"fa-solid fa-shoe-prints\"></i>&nbsp;<span>Actions</span></a><ul class=\"navbar-nav justify-content-end flex-grow-1 collapse\" id=\"actions-submenu\"><li id=\"mapper-follow\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Follow</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-focus\" class=\"nav-item\"><a class=\"nav-link\" href=\"javascript:void(0)\">Focus on current room</a></li><li id=\"mapper-set-current\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Set selected as current</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-highlight-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Highlight path</a></li><li id=\"mapper-clear-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Clear path</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-walk-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Walk path</a></li><li id=\"mapper-walk-highlighted-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Walk highlighted path</a></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-copy-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy path</a></li><li id=\"mapper-copy-stacked\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy as stacked</a></li><li id=\"mapper-copy-speedpath\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy as speedpath</a></li><li id=\"mapper-copy-highlighted-path\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy highlighted path</a></li><li id=\"mapper-copy-highlighted-stacked\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy highlighted as stacked</a></li><li id=\"mapper-copy-highlighted-speedpath\" class=\"nav-item\"><a class=\"nav-link disabled\" href=\"javascript:void(0)\">Copy highlighted as speedpath</a></li></ul></li><li><hr class=\"dropdown-divider\"></li><li id=\"mapper-about\" class=\"nav-item\" title=\"About map\"><a class=\"nav-link\" href=\"javascript:void(0)\"><i class=\"bi-info-circle\"></i>&nbsp;<span>About</span></a></li></ul></div></div>", "<div class=\"dialog-header\"><button id=\"mapper-room-close\" style=\"padding:4px\" type=\"button\" class=\"btn btn-close float-end btn-danger\" data-dismiss=\"modal\" title=\"Hide properties\"></button><div><i class=\"fa fa-list-alt\"></i>&nbsp;Room properties</div></div><div class=\"accordion\" id=\"mapper-room-accordion\"><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-general\" aria-expanded=\"true\" aria-controls=\"General\">General</button></h2><div id=\"mapper-room-general\" class=\"accordion-collapse collapse show\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding:5px\"><div class=\"mb-3\"><label for=\"mapper-room-name\">Name</label><input type=\"text\" class=\"form-control\" id=\"mapper-room-name\" placeholder=\"\"></div><div class=\"mb-3\"><label for=\"mapper-room-background\">Background</label><input type=\"text\" class=\"form-control\" id=\"mapper-room-background\" placeholder=\"\"></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-location\" aria-expanded=\"true\" aria-controls=\"mapper-room-location\">Location</button></h2><div id=\"mapper-room-location\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding:5px\"><div class=\"mb-3\"><label for=\"mapper-room-area\" class=\"form-label\">Area</label><select id=\"mapper-room-area\" class=\"form-select\"></select></div><div class=\"mb-3\"><label for=\"mapper-room-x\" class=\"form-label\">X</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-x\"></div><div class=\"mb-3\"><label for=\"mapper-room-y\" class=\"form-label\">Y</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-y\"></div><div class=\"mb-3\"><label for=\"mapper-room-z\" class=\"form-label\">Z</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-z\"></div><div class=\"mb-3\"><label for=\"mapper-room-zone\" class=\"form-label\">Zone</label><input type=\"number\" class=\"form-control\" id=\"mapper-room-zone\"></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-details\" aria-expanded=\"true\" aria-controls=\"mapper-room-details\">Details</button></h2><div id=\"mapper-room-details\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding:5px\"><div class=\"form-check form-switch\"><input type=\"checkbox\" class=\"form-check-input\" id=\"mapper-room-indoors\"><label class=\"form-check-label\" for=\"mapper-room-indoors\">Indoors</label></div><div class=\"mb-3\"><label for=\"font\" class=\"form-label\">Terrain</label><div class=\"input-group\"><input id=\"mapper-room-env\" type=\"text\" class=\"form-control\" aria-label=\"Room terrain\"><button type=\"button\" class=\"btn btn-outline-secondary dropdown-toggle dropdown-toggle-split\" style=\"border:var(--bs-border-width) solid var(--bs-border-color)\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\"><span class=\"visually-hidden\">Toggle Dropdown</span></button><ul id=\"mapper-room-terrains\" class=\"dropdown-menu dropdown-menu-end\" style=\"height:200px;overflow:auto\"><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">beach</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">bog</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">city</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">cliff</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">cobble</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">desert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">dirt</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">dirtroad</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">farmland</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">forest</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">grass</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">grassland</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">highmountain</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">hills</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">icesheet</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">jungle</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">lake</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">mountain</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">ocean</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">pavedroad</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">plains</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">prairie</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">river</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">rockdesert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">rocky</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">sand</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">sanddesert</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">savannah</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">stone</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">swamp</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">tundra</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">underwater</a></li><li><a class=\"dropdown-item\" href=\"javascript:void(0)\">water</a></li></ul></div></div><div><label for=\"font\" class=\"form-label\">Details</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"1\" id=\"mapper-room-details-1\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-1\">Dock</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"2\" id=\"mapper-room-details-2\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-2\">Pier</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"4\" id=\"mapper-room-details-4\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-4\">Bank</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"8\" id=\"mapper-room-details-8\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-8\">Shop</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"16\" id=\"mapper-room-details-16\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-16\">Hospital</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"32\" id=\"mapper-room-details-32\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-32\">Bar</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"64\" id=\"mapper-room-details-64\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-64\">Restaurant</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"128\" id=\"mapper-room-details-128\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-128\">WaterSource</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"256\" id=\"mapper-room-details-256\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-256\">Trainer</label></div><div class=\"form-check\"><input class=\"form-check-input\" type=\"checkbox\" value=\"512\" id=\"mapper-room-details-512\" name=\"details\" data-enum=\"true\"><label class=\"form-check-label\" for=\"mapper-room-details-512\">Stable</label></div></div></div></div><div class=\"accordion-item\"><h2 class=\"accordion-header\"><button class=\"accordion-button collapsed\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#mapper-room-notes\" aria-expanded=\"true\" aria-controls=\"mapper-room-notes\">Notes</button></h2><div id=\"mapper-room-notes\" class=\"accordion-collapse collapse\" data-bs-parent=\"#mapper-room-accordion\"><div class=\"accordion-body\" style=\"padding:5px\"><textarea class=\"form-control\" rows=\"10\" style=\"width:100%\" id=\"mapper-room-notes\"></textarea></div></div></div></div>", "import '../css/mapper.css';\r\nimport { Client } from '../core/client';\r\nimport { Plugin } from '../core/plugin';\r\nimport { MenuItem } from '../core/types';\r\nimport { MapDisplay } from '../interface/mapdisplay';\r\nimport { Map, Room, RoomDetails, ImportType } from '../core/map';\r\nimport { Dialog, DialogButtons, ProgressDialog } from '../interface/dialog';\r\nimport { removeHash } from '../interface/interface';\r\nimport { debounce, readFile, openFileDialog } from '../core/library';\r\nimport { Splitter, Orientation } from '../interface/splitter';\r\n\r\n//store menu and room editor as htm file for easier editing\r\n// @ts-ignore\r\nimport mapperMenu from '../html/mapper.menu.htm'\r\n// @ts-ignore\r\nimport mapperRoom from '../html/mapper.room.htm'\r\n\r\ndeclare let bootstrap;\r\ndeclare let confirm_box;\r\ndeclare let alert_box;\r\ndeclare let progress_box;\r\n\r\ninterface MapperOptions {\r\n    client: Client;\r\n}\r\n\r\nexport class Mapper extends Plugin {\r\n    private _map: Map;\r\n\r\n    private _dialog: Dialog;\r\n    private _dialogMap: MapDisplay;\r\n    private _dialogSplitter: Splitter;\r\n    private _dialogProgress: ProgressDialog;\r\n\r\n    constructor(options?: MapperOptions | Client) {\r\n        super(options instanceof Client ? options : options?.client);\r\n        if (options && !(options instanceof Client)) {\r\n\r\n        }\r\n        Map.load().then((map: Map) => {\r\n            this.map = map;\r\n            this.client.sendGMCP('Room.Info');\r\n        }).catch(err => this.client.error(err));\r\n    }\r\n\r\n    public remove(): void {\r\n        if (!this.client) return;\r\n        this.client.removeListenersFromCaller(this);\r\n        let idx = this.client.telnet.GMCPSupports.indexOf('Room 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n    }\r\n    public initialize(): void {\r\n        if (!this.client) return;\r\n        this.client.telnet.GMCPSupports.push('Room 1');\r\n        this.client.on('received-GMCP', this.processGMCP, this);\r\n        this.client.on('window', (window, args, name) => {\r\n            if (window === 'mapper') {\r\n                if (args === 'close') {\r\n                    if (this._dialog) this._dialog.close();\r\n                }\r\n                else\r\n                    this.show();\r\n            }\r\n        });\r\n        this.client.on('close-window', window => {\r\n            if (window === 'mapper' && this._dialog) this._dialog.close();\r\n        });\r\n        this.client.on('options-loaded', () => {\r\n            if (this._dialogMap) {\r\n                this._dialogMap.commandDelay = client.getOption('commandDelay');\r\n                this._dialogMap.commandDelayCount = client.getOption('commandDelayCount');\r\n\r\n                this._dialogMap.enabled = this.client.getOption('mapper.enabled');\r\n                if (this._dialogMap.enabled)\r\n                    this._dialog.body.querySelector('#mapper-enable').classList.add('active');\r\n                else\r\n                    this._dialog.body.querySelector('#mapper-enable').classList.remove('active');\r\n\r\n                this._dialogMap.showLegend = this.client.getOption('mapper.legend');\r\n                if (this._dialogMap.showLegend)\r\n                    this._dialog.body.querySelector('#mapper-legend').classList.add('active');\r\n                else\r\n                    this._dialog.body.querySelector('#mapper-legend').classList.remove('active');\r\n\r\n                this._dialogMap.follow = this.client.getOption('mapper.follow');\r\n                if (this._dialogMap.follow)\r\n                    this._dialog.body.querySelector('#mapper-follow').classList.add('active');\r\n                else\r\n                    this._dialog.body.querySelector('#mapper-follow').classList.remove('active');\r\n\r\n                this._dialogMap.splitArea = this.client.getOption('mapper.split');\r\n                if (this._dialogMap.splitArea)\r\n                    this._dialog.body.querySelector('#mapper-split').classList.add('active');\r\n                else\r\n                    this._dialog.body.querySelector('#mapper-split').classList.remove('active');\r\n\r\n                this._dialogMap.fillWalls = this.client.getOption('mapper.fill');\r\n                if (this._dialogMap.fillWalls)\r\n                    this._dialog.body.querySelector('#mapper-fill').classList.add('active');\r\n                else\r\n                    this._dialog.body.querySelector('#mapper-fill').classList.remove('active');\r\n\r\n                if (this._dialogMap.follow)\r\n                    this._dialogMap.focusCurrentRoom();\r\n            }\r\n            if (this._dialog)\r\n                this._dialog.resetState(Object.assign({ persistent: true }, client.getWindowState('mapper') || { center: true }));\r\n            let options = client.getWindowState('mapper');\r\n            if ((options && options.show) || this.client.getOption('showMapper'))\r\n                this.show();\r\n        });\r\n        /*\r\n        this.client.on('function', data => {\r\n            if (!data) return;\r\n            let args = data.args;\r\n            switch (data.name.toLowerCase()) {\r\n                //spell-checker:ignore setmap\r\n                case 'setmap':\r\n                    if ((this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    if (args.length === 0)\r\n                        throw new Error('Invalid syntax use ' + this.client.getOption('commandChar') + 'setmap file \\x1b[3msetCharacter\\x1b[0;-11;-12m');\r\n                    let tmp = this.client.input.stripQuotes(this.client.parseInline(args.shift())) || '';\r\n                    let p;\r\n                    if (!tmp || !tmp.length)\r\n                        throw new Error('Empty file\\x1b[0;-11;-12m');\r\n                    if (args.length > 1)\r\n                        p = this.client.input.stripQuotes(this.client.parseInline(args.join(' '))).toLocaleLowerCase().trim();\r\n                    else\r\n                        p = '';\r\n                    this.client.input.emit('setmap', tmp, p === 'true' || p === 'yes', true);\r\n                    data.handled = true;\r\n                    break;\r\n            }\r\n        }, this);\r\n        */\r\n        this.on('debug', e => this.client.debug(e), this);\r\n        this.on('error', e => this.client.error(e), this);\r\n        let options = client.getWindowState('mapper');\r\n        if ((options && options.show) || this.client.getOption('showMapper'))\r\n            this.show();\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [\r\n            {\r\n                name: '-',\r\n                position: 5,\r\n                exists: '#menu-plugins',\r\n                id: 'plugins'\r\n            },\r\n            {\r\n                name: ' Show mapper',\r\n                action: e => { this.show() },\r\n                icon: '<i class=\"bi bi-map\"></i>',\r\n                position: 6\r\n            }]\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' Mapper',\r\n            action: 'settings-mapper',\r\n            icon: '<i class=\"bi bi-map\"></i>',\r\n            position: 7\r\n        }]\r\n    }\r\n\r\n    get map(): Map { return this._map; }\r\n    set map(map: Map) {\r\n        this._map = map;\r\n        if (this._dialogMap)\r\n            this._dialogMap.map = map;\r\n        this.emit('map-loaded');\r\n    }\r\n\r\n    /**\r\n     * processGMCP - process incoming GMCP for Room events\r\n     * @param {string} mod Client#received-GMCP module\r\n     * @param {Object} data Client#received-GMCP data object\r\n     */\r\n    public async processGMCP(mod: string, data: any) {\r\n        if (!this.client.getOption('mapper.enabled')) return;\r\n        switch (mod) {\r\n            case 'Room.Info':\r\n                this.processData(data);\r\n                break;\r\n            case 'Room.WrongDir':\r\n                break;\r\n        }\r\n    }\r\n\r\n    public processData(data) {\r\n        if (!this._map) {\r\n            setTimeout(() => {\r\n                this.processData(data);\r\n            }, 10);\r\n            return;\r\n        }\r\n        try {\r\n\r\n            let room = this._map.getRoom({ num: '' + data.num });;\r\n            if (!room) {\r\n                room = new Room();\r\n                room.zone = this._map.current.zone;\r\n                if (this._map.current.num !== null) {\r\n                    switch (data.prevroom.dir) {\r\n                        case 'west':\r\n                            room.x--;\r\n                            break;\r\n                        case 'east':\r\n                            room.x++;\r\n                            break;\r\n                        case 'north':\r\n                            room.y--;\r\n                            break;\r\n                        case 'south':\r\n                            room.y++;\r\n                            break;\r\n                        case 'northeast':\r\n                            room.y--;\r\n                            room.x++;\r\n                            break;\r\n                        case 'northwest':\r\n                            room.y--;\r\n                            room.x--;\r\n                            break;\r\n                        case 'southeast':\r\n                            room.y++;\r\n                            room.x++;\r\n                            break;\r\n                        case 'southwest':\r\n                            room.y++;\r\n                            room.x--;\r\n                            break;\r\n                        case 'up':\r\n                            room.z++;\r\n                            break;\r\n                        case 'down':\r\n                            room.z--;\r\n                            break;\r\n                        //out means you leave a zone\r\n                        case 'out':\r\n                            room.zone = this._map.current.zone - 1;\r\n                            break;\r\n                        //enter or unknown exits new zone\r\n                        default:\r\n                            //if (val.area == currentRoom.area)\r\n                            room.zone = this._map.current.zone + 1;\r\n                            break;\r\n                    }\r\n                    room.x += this._map.current.x;\r\n                    room.y += this._map.current.y;\r\n                    room.z += this._map.current.z;\r\n                }\r\n                if (data.area === this._map.current.area) {\r\n                    if (this._map.roomExists({ x: room.x, y: room.y, z: room.z, zone: this._map.current.zone, area: this._map.current.area }) || data.prevroom.zone) {\r\n                        room.zone = this._map.getFreeZone(this._map.current.zone);\r\n                        this._updateCurrent(room, data);\r\n                    }\r\n                    else {\r\n                        this._updateCurrent(room, data);\r\n                    }\r\n                }\r\n                else if (this._map.roomExists({ x: room.x, y: room.y, z: room.z, zone: this._map.current.zone }) || data.prevroom.zone) {\r\n                    room.zone = this._map.getFreeZone(this._map.current.zone);\r\n                    this._updateCurrent(room, data);\r\n                }\r\n                else {\r\n                    this._updateCurrent(room, data);\r\n                }\r\n            }\r\n            else {\r\n                this._updateCurrent(room, data);\r\n            }\r\n            this._map.save().catch(err => this.client.error(err));\r\n        }\r\n        catch (e) {\r\n            this.emit('error', e);\r\n        }\r\n    }\r\n\r\n    private _updateCurrent(room, data) {\r\n        room.num = data.num;\r\n        room.area = data.area;\r\n        room.name = data.name;\r\n        room.env = data.environment;\r\n        room.indoors = data.indoors;\r\n        let exit;\r\n        for (exit in data.exits)\r\n            room.exits[exit] = data.exits[exit];\r\n        //start with none\r\n        room.details = RoomDetails.None;\r\n        if (typeof data.details === 'number')\r\n            room.details = data.details;\r\n        else\r\n            for (let x = 0; x < data.details.length; x++) {\r\n                switch (data.details[x]) {\r\n                    case 'dock':\r\n                        room.details |= RoomDetails.Dock;\r\n                        break;\r\n                    case 'pier':\r\n                        room.details |= RoomDetails.Pier;\r\n                        break;\r\n                    case 'bank':\r\n                        room.details |= RoomDetails.Bank;\r\n                        break;\r\n                    case 'shop':\r\n                        room.details |= RoomDetails.Shop;\r\n                        break;\r\n                    case 'hospital':\r\n                        room.details |= RoomDetails.Hospital;\r\n                        break;\r\n                    case 'bar':\r\n                        room.details |= RoomDetails.Bar;\r\n                        break;\r\n                    case 'restaurant':\r\n                        room.details |= RoomDetails.Restaurant;\r\n                        break;\r\n                    case 'watersource':\r\n                        room.details |= RoomDetails.WaterSource;\r\n                        break;\r\n                    case 'trainer':\r\n                    case 'training':\r\n                    case 'advance':\r\n                        room.details |= RoomDetails.Trainer;\r\n                        break;\r\n                    case 'stable':\r\n                        room.details |= RoomDetails.Stable;\r\n                        break;\r\n                }\r\n            }\r\n        room = this._map.setRoom(room);\r\n        this._map.current = room.clone();\r\n        this.emit('current-changed', this._map.current);\r\n    }\r\n\r\n    /**\r\n     * debug - emit debug event if enabledDebug on\r\n     * @param {string | object} e The debug message or an object of data \r\n     */\r\n    public debug(e) {\r\n        this.emit('debug', e);\r\n    }\r\n\r\n    public refresh() {\r\n        if (this._dialogMap)\r\n            this._dialogMap.refresh();\r\n    }\r\n\r\n    public createDialog() {\r\n        if (this._dialog) return;\r\n        this._dialog = new Dialog(Object.assign({ persistent: true }, client.getWindowState('mapper') || { center: true }, { title: '<i class=\"bi bi-map\"></i><select id=\"mapper-area\" class=\"form-select form-select-sm me-2 mb-1\" title=\"Select Area\"></select>', id: 'win-mapper', noFooter: true, minHeight: 350 }));\r\n        this._dialog.on('resized', e => {\r\n            this.client.setOption('windows.mapper', e);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('moved', e => {\r\n            this.client.setOption('windows.mapper', e);\r\n        })\r\n        this._dialog.on('maximized', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('restored', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            debounce(() => {\r\n                this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            }, 25, 'mapper-resize');\r\n        });\r\n        this._dialog.on('shown', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            this.client.setOption('showMapper', this._dialog.windowState.show !== 0);\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n        this._dialog.on('closing', () => {\r\n\r\n        });\r\n        this._dialog.on('closed', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            this.client.setOption('showMapper', this._dialog.windowState.show !== 0);\r\n            if (this._dialog && !this._dialog.persistent) {\r\n                if (this._map)\r\n                    this._map.removeListenersFromCaller(this._dialog);\r\n                this._dialogMap.map = null;\r\n                delete this._dialogMap;\r\n                this._dialogMap = null;\r\n                delete this._dialog;\r\n                this._dialog = null;\r\n            }\r\n            removeHash('mapper');\r\n        });\r\n        this._dialog.on('canceling', () => {\r\n\r\n        });\r\n        this._dialog.on('canceled', () => {\r\n            this.client.setOption('windows.mapper', this._dialog.windowState);\r\n            this.client.setOption('showMapper', this._dialog.windowState.show !== 0);\r\n            if (this._dialog && !this._dialog.persistent) {\r\n                if (this._map)\r\n                    this._map.removeListenersFromCaller(this._dialog);\r\n                this._dialogMap.map = null;\r\n                delete this._dialogMap;\r\n                this._dialogMap = null;\r\n                delete this._dialog;\r\n                this._dialog = null;\r\n            }\r\n            removeHash('mapper');\r\n        });\r\n        this._dialog.on('resizing', () => {\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n        });\r\n\r\n        const toolbar = document.createElement('nav');\r\n        toolbar.id = 'mapper-toolbar';\r\n        toolbar.classList.add('navbar', 'bg-light', 'align-items-center');\r\n        toolbar.innerHTML = `<form class=\"container-fluid justify-content-start\"><button id=\"btn-mapper-menu\" class=\"me-2 mb-1 btn-sm btn btn-outline-secondary\" type=\"button\" aria-controls=\"mapper-menu\" title=\"Show menu\" aria-expanded=\"false\" data-bs-toggle=\"offcanvas\" data-bs-target=\"#mapper-menu\" aria-controls=\"mapper-menu\"><i class=\"fa-solid fa-bars\"></i></button><button id=\"btn-mapper-focus\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Focus on current room\"><i class=\"fa fa-crosshairs\"></i></button><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-level\" class=\"mt-1 me-1\">Level: </label><input id=\"mapper-level\" class=\"form-control form-control-sm\" type=\"number\" title=\"Map Level\"></div><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-zone\" class=\"mt-1 me-1\">Zone: </label><input id=\"mapper-zone\" class=\"form-control form-control-sm\" type=\"number\" title=\"Map Zone\"></div><div class=\"btn-group me-2 mb-1\"><label for=\"mapper-zoom\" class=\"me-1\">Zoom: </label><input id=\"mapper-zoom\" class=\"form-range\" type=\"range\" min=\"25\" max=\"300\" step=\"5\"><label id=\"mapper-zoom-display\">100%</label></div></form>`;\r\n        this._dialog.body.appendChild(toolbar);\r\n        this._dialog.body.insertAdjacentHTML('afterbegin', mapperMenu);\r\n        this._dialog.body.querySelector('#mapper-enable a').addEventListener('click', () => {\r\n            this._dialogMap.enabled = !this._dialogMap.enabled;\r\n            if (this._dialogMap.enabled)\r\n                this._dialog.body.querySelector('#mapper-enable').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-enable').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-legend a').addEventListener('click', () => {\r\n            this._dialogMap.showLegend = !this._dialogMap.showLegend;\r\n            if (this._dialogMap.showLegend)\r\n                this._dialog.body.querySelector('#mapper-legend').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-legend').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-room a').addEventListener('click', () => {\r\n            this._dialogSplitter.panel2Collapsed = !this._dialogSplitter.panel2Collapsed;\r\n            if (this._dialogSplitter.panel2Collapsed) {\r\n                this._dialog.dialog.dataset.panel = 'left';\r\n                this._dialog.body.querySelector('#mapper-room').classList.remove('active');\r\n                this._dialog.body.querySelector('#mapper-room').title = 'Show room properties';\r\n                this._dialog.body.querySelector('#mapper-room a span').textContent = 'Show room properties';\r\n            }\r\n            else {\r\n                this._dialog.dialog.dataset.panel = 'right';\r\n                this._dialog.body.querySelector('#mapper-room').classList.add('active');\r\n                this._dialog.body.querySelector('#mapper-room').title = 'Hide room properties';\r\n                this._dialog.body.querySelector('#mapper-room a span').textContent = 'Hide room properties';\r\n            }\r\n            this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n            this.client.setOption('mapper.room', !this._dialogSplitter.panel2Collapsed);\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-refresh a').addEventListener('click', () => {\r\n            this._dialogMap.refresh();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-split a').addEventListener('click', () => {\r\n            this._dialogMap.splitArea = !this._dialogMap.splitArea;\r\n            if (this._dialogMap.splitArea)\r\n                this._dialog.body.querySelector('#mapper-split').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-split').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-fill a').addEventListener('click', () => {\r\n            this._dialogMap.fillWalls = !this._dialogMap.fillWalls;\r\n            if (this._dialogMap.fillWalls)\r\n                this._dialog.body.querySelector('#mapper-fill').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-fill').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-follow a').addEventListener('click', () => {\r\n            this._dialogMap.follow = !this._dialogMap.follow;\r\n            if (this._dialogMap.follow)\r\n                this._dialog.body.querySelector('#mapper-follow').classList.add('active');\r\n            else\r\n                this._dialog.body.querySelector('#mapper-follow').classList.remove('active');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-focus a').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-set-current a').addEventListener('click', () => {\r\n            this._dialogMap.current = this._dialogMap.selected;\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#btn-mapper-focus').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            closeMenu();\r\n        });\r\n\r\n\r\n        this._dialog.body.querySelector('#mapper-highlight-path a').addEventListener('click', () => {\r\n            this._dialogMap.focusCurrentRoom();\r\n            this._dialogMap.showPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-clear-path a').addEventListener('click', () => {\r\n            this._dialogMap.clearPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-walk-path a').addEventListener('click', () => {\r\n            this._dialogMap.walkPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-walk-highlighted-path a').addEventListener('click', () => {\r\n            this._dialogMap.walkMarkedPath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-path a').addEventListener('click', () => {\r\n            this._dialogMap.copyPath('\\n');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-stacked a').addEventListener('click', () => {\r\n            this._dialogMap.copyPath(this.client.getOption('commandStackingChar'));\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-speedpath a').addEventListener('click', () => {\r\n            this._dialogMap.copySpeedpath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-path a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedPath('\\n');\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-stacked a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedPath(this.client.getOption('commandStackingChar'));\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-remove-selected a').addEventListener('click', () => {\r\n            confirm_box('Remove selected room?', `Are you sure you want to remove selected room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearSelectedRoom();\r\n            });\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-remove-current a').addEventListener('click', () => {\r\n            confirm_box('Remove current room?', `Are you sure you want to remove current room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearCurrentRoom();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-remove-current-area a').addEventListener('click', () => {\r\n            confirm_box('Remove current area?', `Are you sure you want to remove all rooms from current area?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearArea();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-remove-all a').addEventListener('click', () => {\r\n            confirm_box('Remove all rooms and areas?', `Are you sure you want to remove all rooms?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearAll();\r\n            });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportImage();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-scaled-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportImage(true);\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-current-image a').addEventListener('click', () => {\r\n            this._dialogMap.exportCurrentImage();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-current-area a').addEventListener('click', () => {\r\n            this._dialogMap.exportArea();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-export-all a').addEventListener('click', () => {\r\n            this._dialogMap.exportAll();\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-import-merge a').addEventListener('click', () => {\r\n            openFileDialog('Import map and merge', false).then(files => {\r\n                readFile(files[0]).then((data: any) => {\r\n                    this.import(data, ImportType.Merge);\r\n                }).catch(client.error);\r\n            }).catch(() => { });\r\n            closeMenu();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-import-replace a').addEventListener('click', () => {\r\n            confirm_box('Import and Replace?', `Are you sure you want to remove all rooms and replace them?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    openFileDialog('Import map and replace', false).then(files => {\r\n                        readFile(files[0]).then((data: any) => {\r\n                            this.import(data, ImportType.Replace);\r\n                        }).catch(client.error);\r\n                    }).catch(() => { });\r\n            });\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-copy-highlighted-speedpath a').addEventListener('click', () => {\r\n            this._dialogMap.copyMarkedSpeedpath();\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialog.body.querySelector('#mapper-about a').addEventListener('click', () => {\r\n            alert_box({ title: '<i class=\"fa-solid fa-circle-info\"></i> Map information', width: 300, height: 200, keepCentered: true, center: true, resizable: false, moveable: false, maximizable: false, buttons: DialogButtons.Ok }, `Areas: ${this._map.Areas.length}<br>Rooms: ${this._map.count}<br>Highest zone: ${this._map.zone}`, 2);\r\n            closeMenu();\r\n        });\r\n\r\n        this._dialogMap = new MapDisplay(document.createElement('div'), { map: this._map });\r\n\r\n        this._dialogMap.on('error', e => this.client.error(e), this);\r\n\r\n        this._dialogMap.on('remove-selected', () => {\r\n            confirm_box('Remove selected room?', `Are you sure you want to remove selected room?`).then(e => {\r\n                if (e.button === DialogButtons.Yes)\r\n                    this._dialogMap.clearSelectedRoom();\r\n            });\r\n        });\r\n\r\n        this._dialogMap.on('active-room-changed', room => {\r\n            const area = this._dialog.header.querySelector('#mapper-area') as HTMLSelectElement;\r\n            if (!room.area || room.area.length === 0) {\r\n                if (area.options.length)\r\n                    area.value = area.options[0].value;\r\n            }\r\n            else {\r\n                if (!area.querySelectorAll(`option[value=\"${room.area.replace(/\"/g, '&quot;')}\"]`).length) {\r\n                    area.insertAdjacentHTML('beforeend', `<option value=\"${room.area.replace(/\"/g, '&quot;')}\">${room.area}</option>`);\r\n                    this._dialog.body.querySelector('#mapper-room-area').insertAdjacentHTML('beforeend', `<option value=\"${room.area.replace(/\"/g, '&quot;')}\">${room.area}</option>`);\r\n                }\r\n                area.value = room.area;\r\n            }\r\n            (this._dialog.body.querySelector('#mapper-level') as HTMLInputElement).value = room.z;\r\n            (this._dialog.body.querySelector('#mapper-zone') as HTMLInputElement).value = room.zone;\r\n            room = room.clone();\r\n            room.ID = room.num;\r\n            delete room.num;\r\n            this.client.setOption('mapper.active', room);\r\n        });\r\n\r\n        this._dialogMap.on('setting-changed', (setting, value) => {\r\n            if (setting === 'active') {\r\n                (this._dialog.header.querySelector('#mapper-area') as HTMLInputElement).value = value.area;\r\n                (this._dialog.body.querySelector('#mapper-level') as HTMLInputElement).value = value.z;\r\n                (this._dialog.body.querySelector('#mapper-zone') as HTMLInputElement).value = value.zone;\r\n            }\r\n            else if (setting === 'scale') {\r\n                (this._dialog.body.querySelector('#mapper-zoom') as HTMLInputElement).value = value;\r\n                this._dialog.body.querySelector('#mapper-zoom-display').textContent = value + '%';\r\n            }\r\n            this.client.setOption(`mapper.${setting}`, value);\r\n        });\r\n\r\n        this._dialog.header.querySelector('#mapper-area').addEventListener('change', e => {\r\n            this._dialogMap.setArea((e.currentTarget as HTMLSelectElement).value);\r\n        });\r\n        this._dialog.body.querySelector('#mapper-level').addEventListener('change', e => {\r\n            this._dialogMap.setLevel(parseInt((e.currentTarget as HTMLInputElement).value, 10));\r\n        });\r\n        this._dialog.body.querySelector('#mapper-zone').addEventListener('change', e => {\r\n            this._dialogMap.setZone(parseInt((e.currentTarget as HTMLInputElement).value, 10));\r\n        });\r\n\r\n        this._dialogSplitter = new Splitter({ id: 'mapper', parent: this._dialog.body, orientation: Orientation.vertical });\r\n        this._dialogSplitter.on('splitter-moved', (e) => {\r\n            this.client.setOption('mapper.roomWidth', e);\r\n        });\r\n        this._dialogSplitter.panel2Collapsed = true;\r\n        if (this.client.getOption('mapper.room'))\r\n            this._dialog.body.querySelector('#mapper-room a').click();\r\n        this._dialogSplitter.SplitterDistance = client.getOption('mapper.roomWidth');\r\n        this._dialogSplitter.panel2.innerHTML = mapperRoom;\r\n        this._dialog.body.querySelector('#mapper-room-close').addEventListener('click', () => {\r\n            this._dialog.body.querySelector('#mapper-room a').click();\r\n        });\r\n        this._dialog.body.querySelector('#mapper-room-accordion').querySelectorAll('input,textarea,select,.accordion-body button').forEach((f: HTMLInputElement) => {\r\n            f.disabled = true;\r\n            if (f.tagName === 'BUTTON') return;\r\n            if (f.type === 'checkbox') {\r\n                f.addEventListener('change', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                    const name = f.name || (f.id).substring(12);\r\n                    if (target.dataset.enum === 'true') {\r\n                        const name = target.name || target.id.substring(0, target.id.lastIndexOf('-'));\r\n                        const enums = this._dialog.body.querySelector('#mapper-room-accordion').querySelectorAll(`[name=${name}]`);\r\n                        let value = 0;\r\n                        for (let e = 0, el = enums.length; e < el; e++) {\r\n                            if ((enums[e] as HTMLInputElement).checked)\r\n                                value |= +(enums[e] as HTMLInputElement).value;\r\n                        }\r\n                        this._dialogMap.selected[name] = value;\r\n                    }\r\n                    else\r\n                        this._dialogMap.selected[name] = target.checked;\r\n                    this._map.setRoom(this._dialogMap.selected);\r\n                    this._map.save().catch(err => this.client.error(err));\r\n                });\r\n            }\r\n            else {\r\n                f.addEventListener('change', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const name = f.name || f.id.substring(12);\r\n                    debounce(() => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this._dialogMap.selected[name] = target.value;\r\n                        this._map.setRoom(this._dialogMap.selected);\r\n                        this._map.save().catch(err => this.client.error(err));\r\n                    }, 100, name);\r\n                });\r\n                f.addEventListener('input', e => {\r\n                    if (this._dialogMap.selected === null || this._dialogMap.selected.num === null) return;\r\n                    const name = f.name || f.id.substring(12);\r\n                    debounce(() => {\r\n                        const target = (e.currentTarget || e.target) as HTMLInputElement;\r\n                        this._dialogMap.selected[name] = target.value;\r\n                        this._map.setRoom(this._dialogMap.selected);\r\n                    }, 100, name);\r\n                });\r\n            }\r\n        });\r\n        this._dialogMap.on('room-selected', room => {\r\n            this._dialog.body.querySelector('#mapper-room-accordion').querySelectorAll('input,textarea,select,.accordion-body button').forEach((f: HTMLInputElement) => {\r\n                if (room === null || room.num === null) {\r\n                    f.disabled = true;\r\n                    if (f.tagName === 'BUTTON') return;\r\n                    if (f.type === 'checkbox')\r\n                        f.checked = false;\r\n                    else\r\n                        f.value = '';\r\n                }\r\n                else {\r\n                    f.disabled = false;\r\n                    if (f.tagName === 'BUTTON') return;\r\n                    const name = f.name || (f.id).substring(12);\r\n                    if (f.type === 'checkbox') {\r\n                        if (f.dataset.enum === 'true') {\r\n                            const value = +f.value;\r\n                            f.checked = (room[name] & value) === value;\r\n                        }\r\n                        else\r\n                            f.checked = room[name];\r\n                    }\r\n                    else\r\n                        f.value = room[name];\r\n                }\r\n            });\r\n            const selected = room;\r\n            const current = this._map.current;\r\n            this._updateMenu('#mapper-remove-selected a', selected === null || selected.num === null);\r\n            this._updateMenu('#mapper-set-current a', selected === null || selected.num === null);\r\n            this._updateMenu('#mapper-highlight-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-walk-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-stacked a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-speedpath a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n        });\r\n        this._dialogMap.on('current-changed', room => {\r\n            const selected = this._dialogMap.selected;\r\n            const current = room;\r\n            this._updateMenu('#mapper-remove-current a', current === null || current.num === null);\r\n            this._updateMenu('#mapper-remove-selected a', selected === null || selected.num === null);\r\n            this._updateMenu('#mapper-set-current a', selected === null || selected.num === null);\r\n            this._updateMenu('#mapper-highlight-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-walk-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-path a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-stacked a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n            this._updateMenu('#mapper-copy-speedpath a', selected === null || selected.num === null || !current || current.num === null || selected.num === current.num);\r\n        });\r\n\r\n        this._dialogMap.on('path-shown', () => {\r\n            this._updateMenu('#mapper-highlight-path a', false);\r\n            this._updateMenu('#mapper-walk-path a', false);\r\n            this._updateMenu('#mapper-walk-highlighted-path a', false);\r\n            this._updateMenu('#mapper-clear-path a', false);\r\n            this._updateMenu('#mapper-copy-highlighted-path a', false);\r\n            this._updateMenu('#mapper-copy-highlighted-stacked a', false);\r\n            this._updateMenu('#mapper-copy-highlighted-speedpath a', false);\r\n        });\r\n\r\n        this._dialogMap.on('path-cleared', () => {\r\n            this._updateMenu('#mapper-clear-path a', true);\r\n            this._updateMenu('#mapper-walk-highlighted-path a', true);\r\n            this._updateMenu('#mapper-copy-highlighted-path a', true);\r\n            this._updateMenu('#mapper-copy-highlighted-stacked a', true);\r\n            this._updateMenu('#mapper-copy-highlighted-speedpath a', true);\r\n        });\r\n\r\n        const el = this._dialog.body.querySelector('#mapper-room-env')\r\n        let items = this._dialog.body.querySelectorAll('#mapper-room-terrains .active');\r\n        let i, il;\r\n        for (i = 0, il = items.length; i < il; i++)\r\n            items[i].classList.remove('active');\r\n        items = this._dialog.body.querySelectorAll('#mapper-room-terrains .dropdown-item');\r\n        for (i = 0, il = items.length; i < il; i++) {\r\n            items[i].addEventListener('click', function () {\r\n                el.value = this.textContent;\r\n                el.dispatchEvent(new Event('change'));\r\n            });\r\n        }\r\n        el.nextElementSibling.addEventListener('show.bs.dropdown', event => {\r\n            let items = this._dialog.body.querySelectorAll('#mapper-room-terrains .dropdown-item');\r\n            for (i = 0, il = items.length; i < il; i++) {\r\n                items[i].classList.remove('active');\r\n                if (el.value === items[i].textContent)\r\n                    items[i].classList.add('active');\r\n            };\r\n        });\r\n\r\n        this._dialogSplitter.panel1.append(this._dialogMap.container);\r\n        this._dialogMap.container.classList.add('map');\r\n\r\n        this._dialogMap.active = new Room(client.getOption('mapper.active'));\r\n        this._dialogMap.active.num = this._dialogMap.active.num || (this._dialogMap.active as any).ID;\r\n        this._dialogMap.commandDelay = client.getOption('commandDelay');\r\n        this._dialogMap.commandDelayCount = client.getOption('commandDelayCount');\r\n\r\n        this._dialogMap.on('debug', msg => {\r\n            this.client.debug(msg);\r\n        });\r\n        (this._dialog.body.querySelector('#mapper-level') as HTMLInputElement).value = '' + this._dialogMap.active.z;\r\n        (this._dialog.body.querySelector('#mapper-zone') as HTMLInputElement).value = '' + this._dialogMap.active.zone;\r\n        this._dialog.body.querySelector('#mapper-zoom').addEventListener('input', e => {\r\n            this._dialogMap.scale = +(e.currentTarget as HTMLInputElement).value;\r\n        });\r\n\r\n        const initMapper = () => {\r\n            const m = this._map.Areas.length;\r\n            const area = this._dialog.header.querySelector('#mapper-area') as HTMLSelectElement;\r\n            let h = '';\r\n            for (let i = 0; i < m; i++)\r\n                h += `<option value=\"${this._map.Areas[i].replace(/\"/g, '&quot;')}\">${this._map.Areas[i]}</option>`;\r\n            area.innerHTML = h;\r\n            this._dialog.body.querySelector('#mapper-room-area').innerHTML = h;\r\n            if (this._dialogMap.active.area && this._map.Areas.indexOf(this._dialogMap.active.area) !== -1)\r\n                area.value = this._dialogMap.active.area;\r\n            else if (m > 0) {\r\n                this._dialogMap.active.area = this.map.Areas[0];\r\n                this._dialogMap.emit('setting-changed', 'active', this._dialogMap.active.area);\r\n                area.value = this._dialogMap.active.area;\r\n            }\r\n            this._dialogMap.refresh();\r\n\r\n            this._dialogMap.enabled = this.client.getOption('mapper.enabled');\r\n            if (this._dialogMap.enabled)\r\n                this._dialog.body.querySelector('#mapper-enable').classList.add('active');\r\n\r\n            this._dialogMap.showLegend = this.client.getOption('mapper.legend');\r\n            if (this._dialogMap.showLegend)\r\n                this._dialog.body.querySelector('#mapper-legend').classList.add('active');\r\n\r\n            this._dialogMap.follow = this.client.getOption('mapper.follow');\r\n            if (this._dialogMap.follow)\r\n                this._dialog.body.querySelector('#mapper-follow').classList.add('active');\r\n\r\n            this._dialogMap.splitArea = this.client.getOption('mapper.split');\r\n            if (this._dialogMap.splitArea)\r\n                this._dialog.body.querySelector('#mapper-split').classList.add('active');\r\n\r\n            this._dialogMap.fillWalls = this.client.getOption('mapper.fill');\r\n            if (this._dialogMap.fillWalls)\r\n                this._dialog.body.querySelector('#mapper-fill').classList.add('active');\r\n\r\n            if (this._dialogMap.follow)\r\n                this._dialogMap.focusCurrentRoom();\r\n            this._dialogMap.scale = this.client.getOption('mapper.scale');\r\n            this._map.on('rooms-removed', rooms => {\r\n                this._map.save();\r\n            }, this._dialog);\r\n\r\n            this._map.on('areas-removed', areas => {\r\n                const area = this._dialog.header.querySelector('#mapper-area') as HTMLSelectElement;\r\n                const roomArea = this._dialog.body.querySelector('#mapper-room-area') as HTMLSelectElement;\r\n                if (this._map.Areas.length === 0) {\r\n                    area.innerHTML = '';\r\n                    roomArea.innerHTML = '';\r\n                }\r\n                else {\r\n                    for (let i = area.length - 1; i >= 0; i--) {\r\n                        if (areas.indexOf(area.options[i].value) !== -1)\r\n                            area.remove(i);\r\n                    }\r\n                    for (let i = roomArea.length - 1; i >= 0; i--) {\r\n                        if (areas.indexOf(roomArea.options[i].value) !== -1)\r\n                            roomArea.remove(i);\r\n                    }\r\n                }\r\n            }, this._dialog);\r\n            this._map.on('areas-added', areas => {\r\n                //TODO recode to insert the area at correct index instead of rebuilding full list\r\n                let h = '';\r\n                const m = this._map.Areas.length;\r\n                for (let i = 0; i < m; i++)\r\n                    h += `<option value=\"${this._map.Areas[i].replace(/\"/g, '&quot;')}\">${this._map.Areas[i]}</option>`;\r\n                this._dialog.header.querySelector('#mapper-area').innerHTML = h;\r\n                this._dialog.body.querySelector('#mapper-room-area').innerHTML = h;\r\n                if (this._dialogMap.active.area && this._map.Areas.indexOf(this._dialogMap.active.area) !== -1)\r\n                    (this._dialog.header.querySelector('#mapper-area') as HTMLSelectElement).value = this._dialogMap.active.area;\r\n                else if (m > 0) {\r\n                    this._dialogMap.active.area = this.map.Areas[0];\r\n                    this._dialogMap.emit('setting-changed', 'active', this._dialogMap.active.area);\r\n                    (this._dialog.header.querySelector('#mapper-area') as HTMLSelectElement).value = this._dialogMap.active.area;\r\n                }\r\n            }, this._dialog);\r\n\r\n            this._map.on('import-progress', progress => {\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.progress = progress;\r\n            }, this._dialog);\r\n            this._map.on('import-complete', () => {\r\n                client.sendGMCP('Room.Info');\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.close();\r\n                this._dialogProgress = null;\r\n                this._dialogMap.refresh();\r\n                this._map.save();\r\n            }, this._dialog);\r\n            this._map.on('import-canceled', () => {\r\n                client.sendGMCP('Room.Info');\r\n                if (this._dialogProgress)\r\n                    this._dialogProgress.close();\r\n                this._dialogProgress = null;\r\n                this._dialogMap.refresh();\r\n                this._map.save();\r\n            }, this._dialog);\r\n            //onload query the mud for current room info\r\n            this.client.sendGMCP('Room.Info');\r\n        }\r\n\r\n        this.on('map-loaded', () => {\r\n            initMapper();\r\n        });\r\n        if (this._map)\r\n            initMapper();\r\n        this._dialogSplitter.panel1.parentElement.style.top = toolbar.offsetHeight + 'px';\r\n    }\r\n\r\n    public show() {\r\n        this.createDialog();\r\n        this._dialog.show();\r\n    }\r\n\r\n    private _updateMenu(selector, disabled) {\r\n        if (disabled)\r\n            this._dialog.body.querySelector(selector).classList.add('disabled');\r\n        else\r\n            this._dialog.body.querySelector(selector).classList.remove('disabled');\r\n    }\r\n\r\n    public import(data, type: ImportType) {\r\n        if (this._dialogProgress)\r\n            throw new Error('Import already in progress');\r\n        if (typeof data === 'string')\r\n            data = JSON.parse(data);\r\n        this._dialogProgress = progress_box('Importing map');\r\n        this._dialogProgress.on('canceled', () => {\r\n            this.map.cancelImport();\r\n        });\r\n        this._dialogProgress.on('closed', reason => {\r\n            if (reason === 'canceled')\r\n                this.map.cancelImport();\r\n        });\r\n        this._dialogProgress.on('shown', () => {\r\n            this.map.import(data, type);\r\n        });\r\n        this._dialogProgress.showModal();\r\n    }\r\n}\r\n\r\nfunction closeMenu() {\r\n    const instance = bootstrap.Offcanvas.getInstance(document.getElementById('mapper-menu'));\r\n    if (!instance) return\r\n    instance.hide();\r\n}\r\n", "<div id=\"status-drag-bar\"></div><div id=\"status\" class=\"d-flex flex-column\"><button id=\"status-close\" style=\"padding:4px\" type=\"button\" class=\"button button-sm btn-close\" title=\"Hide status\"></button><div id=\"character-name\" class=\"status-panel\">&nbsp;</div><div id=\"environment\" class=\"status-panel day\"><div id=\"environmentleft\"><div class=\"overlay\"></div></div><div id=\"environmentcenter\"><div class=\"overlay\"></div></div><div id=\"environmentright\"><div class=\"overlay\"></div></div><div id=\"environmentweather\"></div></div><div id=\"body\" class=\"status-panel\"><div id=\"limbs\"><button id=\"health\" class=\"button button-sm active\" title=\"Show limb health\"><i class=\"fa fa-heart\"></i></button><button id=\"armor\" class=\"button button-sm\" title=\"Show limb armor protection\"><svg width=\"11\" height=\"17\" viewBox=\"0 0 10 17\" preserveAspectRatio=\"xMidYMid\"><path fill=\"currentColor\" d=\"M5 0c0 0 1 0 1 0 1 0 2 1 3 1 1 1 1 2 1 3 0 2 0 5 0 8 -1 1-2 3-3 3 0-2 0-4 0-6 1-1 2-1 2-1C9 7 9 6 9 6 8 6 7 7 6 7 6 7 5 8 5 8 5 8 4 7 4 7 3 7 2 6 1 6 1 6 1 7 1 8c1 0 2 1 2 1 0 2 0 4 0 6 -1-1-2-1-3-2 0 0-1-1-1-1 0-1 0-1 0-2 0-1 0-1 0-2 0-1 0-3 0-4 0-1 1-2 2-2C3 1 4 0 5 0z\"/></svg></button><svg id=\"fullbody\" class=\"health-full\" xmlns=\"http://www.w3.org/2000/svg\" width=\"128\" height=\"200\" viewBox=\"-0.9 -0.8 179 297\"><path id=\"rightwing\" d=\"M140.5 0.1c7-0.8 8 6.4 7.7 11.8 -0.4 9.2-0.3 18.2 1.1 25.8 0.6 3.1 2 6 2 8.3 0.1 7.6-6.1 11.4-10 14.6 1.9 0.5 4.5 0.3 6 1.1 0.6 1.8 0.3 4.7 0 6.6 1.9 0.5 4.7 0.1 6 1.1 0.4 2.2-0.7 2.4-0.6 4 0.3 3 4.2 4.2 4.3 6.6 0.1 1.8-1.1 2.3-2 4 0.6 1.1 2.2 1.2 2.3 2.9 -2.3 2.3-4.2 4.2-1.4 6.9 5.8 5.6 20.4 8.8 21.8 18.6 -3.5 3.1-7.3-0.6-10-2.6 -3-2.2-5.1-5.5-7.7-7.7 -3.3-2.8-9.4-7.3-12.3-2 -0.3 1.6 0.9 1.8 0.6 3.4 -6-0.7-7.7 3-9.7 6.3 -4.9-0.5-6.6-5.4-12.3-4 -1.1-1-1.8-0.7-3.4-0.3 -0.3-1.5-1.6-2-3.2-2.3 -1.5-7.4-6.6-11.2-11.5-15.2 -1.3 5.8-4.9 9.5-11.8 9.8 -5.8-7.5-8.3-23-5.4-35.6 2-1.4 4.5-2.4 8-2.3C103.8 35.9 114.5 3 140.5 0.1zM138.2 6.1c3.6 0.1 5.2 2.3 4.6 6.6C146.3 8.9 141.8 0.5 138.2 6.1zM129.9 7.2c-7 3.1-12.1 10.6-15.5 18.4 1.6 0.2 2.8-2.6 4.6-4 1.4-1.1 3.6-1.8 4.9-3.2C126.7 15.3 126.6 9.9 129.9 7.2zM139.1 9.8c-6.4 4-8.6 12.1-11.5 19.5C133.3 26 139.7 19.4 139.1 9.8zM140.5 20.4c3.4-0.7 4 4.1 2.3 6C146.7 26.3 144.7 15.9 140.5 20.4zM124.7 20.7c-2.7 4.4-7.3 6.9-10.9 10.6 -7.8 8.1-10.7 20.2-13.2 32.7 4.9-6.8 9.9-13.3 15.8-19.8 1.8-2 4.7-4 5.7-6C124.6 33.4 123.5 27.4 124.7 20.7zM140.5 24.1c-1.2 0-2.6-0.1-3.4 0.3 -2.1 4-5.7 6.6-10 8.3 -0.2 1.1-0.6 2.1-0.9 3.2C132.1 33.1 138.4 30.8 140.5 24.1zM145.9 32.7c-0.9 1.9-1.6 4-2.6 5.7C146.1 38.4 146.3 35.1 145.9 32.7zM119.8 44.2c5.5 0.4 9.9-2.7 15.5-3.2 1.5-3 5.2-3.8 6.3-7.2C131.7 33.5 125.4 39.2 119.8 44.2zM144.2 42.8c0.6 2.8-1.6 4.8-3.7 5.7C144.8 50.7 149.8 43.7 144.2 42.8zM111.5 53.7c5.5-2.1 11.4-3.7 18.1-4.6 1.4-2.5 4.9-2.9 6.9-4.9C125.6 43.5 116.3 48.3 111.5 53.7zM108.7 57.7c4.6 0.6 10.2 0.3 14.3 1.4 2.4-1.8 4.6-3.8 7.5-5.2C122.4 52.3 113.7 54.5 108.7 57.7zM138.2 54.8c-3.6 0.5-4.2 3.8-8 4C133.9 59.7 138 58.4 138.2 54.8zM103.8 63.7c2.7-1.8 11.9 1.9 12-3.2C110.9 60 105.3 60 103.8 63.7zM119 61.7c0.7 1.4-0.4 2.9 0 3.7 2.4 0 3.7-1.1 3.4-3.7C121.8 61.3 119.6 61.3 119 61.7zM126.4 65.1c4.1-0.3 11.1 1.8 14.6-0.6C138.9 59.6 128.5 62.6 126.4 65.1zM130.7 67.7c3.4 3.1 8 5 14.6 4.9C143.7 69 137.3 66.5 130.7 67.7zM110.1 71.7c4.6 4.2 17.8 5.3 23.2 1.1 -3.3-2.2-6.9-4-12-3.2C118.1 70.3 114.1 72.8 110.1 71.7zM108.4 74.3c-0.5 0.2 0 0.5 0 0.9 9.8 7 20.8 12.9 34.7 15.8 -3.7-4.5-6.7-9.5-11.5-12.9C122.6 78.9 114.6 77.2 108.4 74.3zM135.6 76c2.6 2.5 9 2.6 13.8 2C147.2 74.3 140.9 76.5 135.6 76zM109.8 78.3c-0.4 0.1 0 0.3 0 0.6 3.9 3.2 8.4 5.5 12 8.9 3.6 3.3 7.2 6.8 8.9 12 1.5 0.5 2.8 1.2 3.7 2.3 0-6.3-5.4-10.3-9.7-13.8C120 84.6 114.9 81.2 109.8 78.3zM136.2 79.2c1.7 2.9 7.1 4.5 12.3 4.9 0.1-1-0.1-1.6-0.3-2.3C144.9 80.2 139 81.2 136.2 79.2zM152.5 81.2c-0.6 0.2-0.9 0.6-1.4 0.9 -0.1 1.2 0.4 1.9 0.9 2.6C152.5 83.8 152.3 82.3 152.5 81.2zM110.1 81.5c-0.8 0.6 0.1 1.8 0 2.6 4.4 2.6 7.6 6.4 8.9 12 0.5 0 1 0 1.4 0 0.8 2 2.3 3.5 3.4 5.2 1.7-0.2 2-1.9 4.3-1.4C125.3 90.5 116.8 86.9 110.1 81.5zM141.9 85.2c0.5 2.1 3 4.6 6 5.2 0.1-1.3 0-2.5-0.6-3.2C144.9 87.2 143.2 86.4 141.9 85.2zM149.7 86.7c0.1 1.6 0.9 2.5 1.4 3.7 0.8-0.6 1-1.8 1.4-2.9C151.4 87.4 151.1 86.4 149.7 86.7zM127.6 88.1c2.8 2.9 5.3 6.2 10 7.2C135.1 92.1 132.6 88.8 127.6 88.1zM140.5 93.2c0.5 1 0 3 2 2.6 0.3-0.3 0.3-1 0.3-1.7C142 93.9 141.6 93.2 140.5 93.2zM144.2 98.7c1.1-1.2 3.1-3 3.4-4C146 94.4 144.1 96.2 144.2 98.7zM136.8 98.1c-0.7 0.6 0.1 1.1 0 2 0.8 0.2 0.7-0.4 1.4-0.3C138.2 98.8 137.6 98.3 136.8 98.1zM140.5 101.6c-0.9-0.5-2.3 0.9-2.3 2.3C139 103.2 139.3 101.9 140.5 101.6z\"/><path id=\"leftwing\" d=\"M78.9 60c3.6-0.1 6 0.9 8 2.3 2.9 12.6 0.4 28-5.4 35.6 -6.9-0.3-10.4-3.9-11.8-9.7 -4.9 4-10 7.8-11.5 15.2 -1.5 0.3-2.9 0.8-3.2 2.3 -1.6-0.4-2.3-0.7-3.4 0.3 -5.8-1.3-7.5 3.5-12.3 4 -2.1-3.3-3.7-7-9.7-6.3 -0.3-1.6 0.9-1.8 0.6-3.4 -3-5.3-9-0.8-12.3 2 -2.6 2.3-4.7 5.5-7.7 7.7 -2.7 2-6.5 5.7-10 2.6 1.4-9.8 16-13 21.8-18.6 2.8-2.7 0.9-4.6-1.4-6.9 0.1-1.6 1.7-1.7 2.3-2.9 -0.9-1.8-2.1-2.2-2-4 0.1-2.4 4-3.6 4.3-6.6 0.2-1.6-0.9-1.8-0.6-4 1.3-1.1 4.1-0.6 6-1.1 -0.3-1.9-0.6-4.8 0-6.6 1.5-0.9 4.1-0.6 6-1.1 -3.9-3.2-10.2-7.1-10-14.6 0-2.3 1.4-5.2 2-8.3 1.5-7.6 1.6-16.6 1.1-25.8C29.3 6.5 30.3-0.7 37.3 0.1 63.3 3 74 35.9 78.9 60zM35 12.7c-0.6-4.3 1-6.5 4.6-6.6C36 0.5 31.5 8.9 35 12.7zM53.9 18.4c1.3 1.4 3.5 2 4.9 3.2 1.8 1.5 3 4.2 4.6 4C60 17.9 54.9 10.3 47.9 7.2 51.2 9.9 51 15.3 53.9 18.4zM50.2 29.3c-2.9-7.4-5.1-15.5-11.5-19.5C38.1 19.4 44.5 26 50.2 29.3zM35 26.4c-1.7-1.9-1.2-6.7 2.3-6C33 15.9 31.1 26.3 35 26.4zM55.6 38.2c1 2 3.9 4 5.7 6 5.9 6.4 10.9 12.9 15.8 19.8 -2.5-12.5-5.4-24.6-13.2-32.7 -3.6-3.7-8.2-6.2-10.9-10.6C54.3 27.4 53.2 33.4 55.6 38.2zM51.6 35.9c-0.3-1.1-0.6-2-0.9-3.2 -4.4-1.7-8-4.3-10-8.3 -0.9-0.4-2.2-0.3-3.4-0.3C39.3 30.8 45.7 33.1 51.6 35.9zM34.4 38.5c-1-1.8-1.7-3.9-2.6-5.7C31.4 35.1 31.7 38.4 34.4 38.5zM36.1 33.9c1.1 3.4 4.8 4.2 6.3 7.2 5.6 0.4 10 3.6 15.5 3.2C52.4 39.2 46.1 33.5 36.1 33.9zM37.3 48.5c-2.1-1-4.3-2.9-3.7-5.7C27.9 43.7 33 50.7 37.3 48.5zM41.3 44.2c2 1.9 5.4 2.4 6.9 4.9 6.7 0.9 12.6 2.5 18.1 4.6C61.5 48.3 52.2 43.5 41.3 44.2zM47.3 54c2.9 1.3 5.1 3.3 7.5 5.2 4.1-1.1 9.7-0.8 14.3-1.4C64.1 54.5 55.3 52.3 47.3 54zM47.6 58.8c-3.8-0.2-4.5-3.6-8-4C39.8 58.4 43.9 59.7 47.6 58.8zM61.9 60.6c0.2 5.1 9.3 1.3 12 3.2C72.5 60 66.9 60 61.9 60.6zM55.3 61.7c-0.2 2.6 1 3.8 3.4 3.7 0.4-0.8-0.7-2.3 0-3.7C58.1 61.3 56 61.3 55.3 61.7zM36.7 64.6c3.5 2.4 10.5 0.3 14.6 0.6C49.3 62.6 38.9 59.6 36.7 64.6zM32.4 72.6c6.6 0.1 11.2-1.8 14.6-4.9C40.5 66.5 34 69 32.4 72.6zM56.5 69.7c-5.2-0.8-8.7 0.9-12 3.2 5.5 4.1 18.7 3 23.2-1.1C63.7 72.8 59.7 70.3 56.5 69.7zM46.2 78.1c-4.7 3.4-7.8 8.4-11.5 12.9 13.9-2.9 24.9-8.8 34.7-15.8 0-0.3 0.5-0.6 0-0.9C63.2 77.2 55.2 78.9 46.2 78.1zM28.4 78.1c4.8 0.6 11.2 0.5 13.8-2C36.9 76.5 30.5 74.3 28.4 78.1zM53 88.4c-4.3 3.4-9.8 7.4-9.7 13.8 0.9-1.1 2.2-1.8 3.7-2.3 1.7-5.2 5.3-8.7 8.9-12 3.7-3.4 8.1-5.7 12-8.9 0-0.3 0.4-0.4 0-0.6C62.9 81.2 57.8 84.6 53 88.4zM29.5 81.8c-0.2 0.7-0.4 1.3-0.3 2.3 5.2-0.3 10.6-2 12.3-4.9C38.7 81.2 32.8 80.2 29.5 81.8zM25.8 84.6c0.5-0.7 0.9-1.4 0.9-2.6 -0.5-0.3-0.8-0.7-1.4-0.9C25.5 82.3 25.3 83.8 25.8 84.6zM49.6 99.8c2.3-0.4 2.6 1.3 4.3 1.4 1.2-1.7 2.6-3.1 3.4-5.2 0.5 0 1 0 1.4 0 1.3-5.7 4.5-9.5 8.9-12 -0.1-0.8 0.8-2 0-2.6C60.9 86.9 52.4 90.5 49.6 99.8zM30.4 87.2c-0.6 0.7-0.7 1.8-0.6 3.2 3-0.5 5.6-3 6-5.2C34.5 86.4 32.8 87.2 30.4 87.2zM25.2 87.5c0.4 1 0.6 2.2 1.4 2.9 0.5-1.2 1.3-2.1 1.4-3.7C26.6 86.4 26.4 87.4 25.2 87.5zM40.1 95.3c4.7-1 7.2-4.2 10-7.2C45.1 88.8 42.7 92.1 40.1 95.3zM35 94.1c0 0.7 0 1.4 0.3 1.7 2 0.4 1.5-1.6 2-2.6C36.2 93.2 35.8 93.9 35 94.1zM30.1 94.7c0.3 1 2.3 2.9 3.4 4C33.7 96.2 31.8 94.4 30.1 94.7zM39.6 99.8c0.7-0.1 0.6 0.5 1.4 0.3 -0.1-0.9 0.7-1.4 0-2C40.1 98.3 39.5 98.8 39.6 99.8zM39.6 103.9c0.1-1.4-1.4-2.8-2.3-2.3C38.5 101.9 38.7 103.2 39.6 103.9z\"/><path id=\"tail\" d=\"M146 229.8c1.8-3.3 1.5-7.5 4.3-10.1 -2-5.3 0.6-12.5-1.2-17.8 -5.6-7.1-8.8-15.2-18.3-20.7 -6.5-1.7-14.5-9.2-22.2-9.3 -4.7-2.4-5.9-6.3-10.4-8.7 0.8-0.8 1-1.7 0.9-2.6l-13.4-3.7c-0.9 3.9 0.5 6.9-0.2 10.8 4.4 4.3 5.6 10.4 11.7 13.6 3.1 1.6 6.9-0.4 9 3.6 8.4 4.5 18.5 0.8 23.2 10 0 0 0 0 0-0.1 5.3 3.7 6.6 9 9.4 13.7 0.2 3 0.4 6.7 0.6 8.9 0.5 4.1 0 2.9-1.8 6.8 -1 2.2-0.4 2.5-1 5 -4.8 0.9-6.5 6-10.2 8.7 -3.1 2.3-7.5 2.5-9.9 5.6 6.5 0.9 11.8-1.1 17.8-1.2 1.6-4.2 4.7-3.2 6.4-4.9 1.1-1.1 1-3.4 1.9-4.6C143.8 231.2 145.4 231 146 229.8z\"/><path id=\"head\" d=\"M97.5 43.8c0.5-1.7 1.8-3 2.6-4.7 0.4-0.9-0.1-2.1 0.5-3.2 0.1-0.2 0.9 0.1 1.1 0 1.1-1.1-0.1-4.1 1.1-6.3 0.5-2-2.3-0.9-1.6-3.2 1.6-4.8-0.3-12.8-3.2-13.2 1.8-0.6-1.5-0.2-0.5-1.6 -2.5-0.6-5-1.3-7.4-2.1 -1.1 0-2.1 0-3.2 0 -0.2 1.7-3 0.8-4.7 1.1 0.4 1.4-0.9 0.7-1.6 1.1 -0.6 0.4-1.3 1.3-1.6 1.6 -0.1 0.1-1 0.4-1.1 0.5 -0.5 1.2-0.8 3.1-2.1 4.2 0.9 2.7-0.9 6.1 0.5 9 0.3 1.1-0.8 1.1-1.1 1.6 -0.9 1.5-0.4 7.5 2.1 7.9 0 3.3 1.7 5 2.6 7.4 -0.1 1.4 0 3 0 4.6 5.8 0 11.6 0 17.4 0C97.4 46.8 97.5 45.3 97.5 43.8z\"/><path id=\"lefthand\" d=\"M48.4 162.4c0 0.7 0 1.4 0 2.1 0.3 0 0.6 0.4 0 0.5 0 1.6 0 3.2 0 4.7 1.7-0.6 0.8 1.5 1.1 2.1 0.3 0.8 1.2 1.4 1.6 2.1 1.7 3 2.5 4 5.3 5.3 0.9 0.4 1.9 1.6 3.2 1.1 1.3-2.9-0.6-3.8-2.1-5.3 -0.2-1.3 2.4 0.3 1.6-1.6 -2.1-2.3-7.7-3.9-5.3-9 4.1-0.6 1.3 5.7 5.3 5.3 0.5-3 0-7 0.5-11.1 -0.6-1.6-2.4-3.4-2.6-5.3 0 0 0-0.1 0-0.1l-7.3 0C49.4 156.6 49 159.6 48.4 162.4z\"/><path id=\"leftleg\" d=\"M78 266.8c-0.7-4.4-0.5-11.2 0-16.9 0.4-4.1 1.8-7.8 2.1-11.6 0.2-3.3 0.3-6.9 0-10 -0.4-3.5-2.2-6.2-2.1-9 0.1-1.9 1.4-3.7 2.1-5.8 1.1-3.3 2.2-6.8 2.6-10 0.9-6.3 0.6-13.4 1.1-20 0.4-5 1.6-8.6 2.6-12.1 0.3-0.9 0.9-1.4 1.1-2.1 0.7-3.5-0.9-6.7 1.3-8.1 -8.6 0-17.2 0-25.9 0 -0.1 9.7 1.1 19.4 1.5 28.6 0.2 3.8-0.3 7.7 0 11.1 0.3 3.5 0.7 7.9 0 11.1 0 0.2-1 1.3-1.1 1.6 -0.2 1.6-0.3 3.2-0.5 4.7 -0.7 5.4-0.9 12.8-0.5 17.9 0.3 4.6 1.5 7.4 2.6 10.5 1.1 3.2 2 6.1 2.6 9.5 0.2 1 0.9 2 1.1 3.2 0.2 1.3-0.2 2.9 0 4.2 0.2 1.5 0.9 2.4 1.1 3.7 0 0 0 0 0 0h8.5C78 267.1 78 267 78 266.8z\"/><path id=\"leftfoot\" d=\"M78.1 267.3h-8.5c0.5 5.9-1.2 9.3-1.1 14.2 -1.7 3-3.8 7.9-3.2 11.6 2 2.4 9.1-0.4 11.1 2.1 0.7 0 1.4 0 2.1 0 3.9-5-0.7-15.5 2.1-21.1C80 271.9 78.6 269.8 78.1 267.3z\"/><path id=\"leftarm\" d=\"M63.2 59.1c-0.6 0.2-0.7 0.9-1.1 1.1 -0.4 0.2-1.2-0.2-1.6 0 -0.5 0.3-0.2 0.8-0.5 1.1 -0.4 0.2-1.2-0.2-1.6 0 -0.5 0.3-0.2 0.8-0.5 1.1 -0.2 0.2-0.8-0.2-1.1 0 -0.2 0.1-0.4 1-0.5 1.1 -1.2 0.6-0.6 0.5-1.6 1.6 -0.6 0.6-1.5 1.4-2.1 3.2 -0.3 0.8-0.3 1.2-0.5 1.6 -0.8 1.8-1 7-1.6 11.1 -0.5 2.9-1.3 6-1.6 9 -0.7 8 2.4 17.9 0 24.3 0 0.1-0.5 0-0.5 0 0 4.9 0 9.8 0 14.8 0.9 7.7 1.6 16.6 1.1 24.7l7.3 0c-0.1-1.1 0.6-3.1 1.1-5.2 0.7-2.9 1.7-6.3 2.1-7.9 0.8-3.1 1.4-6.1 1.6-9 0.5-6.1-1.2-12.9-0.5-17.9 0.3-1.8 1.2-3.6 1.6-5.3 0.5-2.1 0.8-4.2 1.1-6.3 0.5-4.2 0-8.9 2.5-11.9V59.1C65.2 59 64.1 58.8 63.2 59.1z\"/><path id=\"rightfoot\" d=\"M96.9 274c1.3 2.8 1.2 6.6 1.1 10.1 -0.2 4.2-0.9 8.1 1.1 11.2 0.5 0 1.1 0 1.6 0 0.5-1.3 2.2-0.9 3.7-1.1 3-0.3 6.7 0.3 8.4-1.1 0.3-4.1-2.2-7.7-3.2-11.7 -0.4-1.6-0.2-3-0.5-4.8 -0.3-1.5-1-3.2-1.1-4.8 -0.1-1.3 0-2.6 0.1-4h-9C98.6 270.2 97.9 272.3 96.9 274z\"/><path id=\"torso\" d=\"M89.5 161.7c8.4 0 16.9 0 25.5 0 0-1.2-0.1-2.4-0.1-3.5 -0.5-7.1-1.7-14.2-2.6-21.2 -0.5-3.6-0.9-7.1-1.6-10.6 -1.1-5.7-3-12.3-2.1-19.1 0.3-2.7 1.8-5 2.1-7.4 0.4-3.2-1-6.5 0.8-9.7v-31.1c-0.8 0-1.6 0.1-2.4 0 -1.3-1.7-3.9-1.3-5.8-2.1 -0.3-0.1-1.4-1.2-2.1-1.6 -0.9-0.4-1.9-0.4-2.6-1.1 -0.8-1.5-1-3.7-1.1-6 -5.8 0-11.6 0-17.4 0 0 2 0 4-0.6 5.5 -1 0.3-1.7 1-2.6 1.6 -0.4 0.3-1 0.2-1.6 0.5 -0.5 0.3-0.5 0.8-1.1 1.1 -0.6 0.3-1.5-0.2-2.1 0 -0.4 0.2-0.4 0.9-1.1 1.1 -0.6 0.2-1.5-0.2-2.1 0 -0.2 0.1-0.9 1-1.1 1.1 -0.6 0.1-1.2 0.1-1.8 0v30.9c0.1-0.1 0.1-0.1 0.2-0.2 0.7 2.8 0.1 5.9 0.5 9 0.4 2.8 1.8 5.2 2.1 7.9 0.3 2.8 0.2 6.4 0 9.5 -0.4 4.9-2 9.2-2.6 13.2 -0.2 1.2 0.1 2.5 0 3.7 -0.1 1.2-0.9 2.1-1.1 3.2 -0.2 1.4 0.2 2.8 0 4.2 -0.2 1.1-0.9 2.2-1.1 3.2 -0.2 1.8 0.2 3.5 0 5.3 -0.2 1.5-0.9 3.2-1.1 4.8 -0.3 2.6-0.4 5.2-0.4 7.8 8.7 0 17.3 0 25.9 0H89.5z\"/><path id=\"rightleg\" d=\"M114.9 217.2c-0.5-4.3-2-8.4-2.1-12.7 -0.1-4.3 0.9-9.1 1.1-13.7 0.1-2.8-0.1-5.2 0-7.9 0.3-7.2 1.3-14.5 1.2-21.8 -8.6 0-17 0-25.5 0 -0.4 6.7 3.5 13.3 4.2 20.2 0.3 3.5-0.2 6.7 0 10 0.3 4.6 0.8 9.1 1.6 13.2 0.4 2.1 1 3.9 1.6 5.8 0.2 0.5-0.1 1.1 0 1.6 0.1 0.2 0.9 0.8 1.1 1.1 0.2 0.6-0.3 1.5 0 2.1 0.1 0.1 0.9-0.1 1.1 0 0.1 0.1-0.1 0.8 0 1.1 1.2 4-0.5 6.8-1.1 10.5 -0.6 4.7-0.6 10.8 0 15.8 0.1 1.2 0.8 2.5 1.1 3.7 0.3 1.5 0.4 2.9 0.5 4.2 0.6 6.4 0.5 12.6-0.5 17.6h9c0.2-2.9 0.6-5.9 1-7.6 0.7-3.3 1.3-5.8 2.1-8.4 0.6-2.2 1.5-5 2.1-6.3 0.6-1.3 1.3-3.1 1.6-4.2C116.5 233.7 115.9 225 114.9 217.2z\"/><path id=\"rightarm\" d=\"M128 154c-0.5-11.9 1.1-24.4 1.6-33.7 0-1.4 0-2.8 0-4.2 -3.4-6.7 0.2-18.4-1.1-29 -0.2-2-1.2-3.8-1.6-5.8 -0.9-5.7-0.5-10-2.6-14.2 -0.2-0.3-0.3-1.2-0.5-1.6 -0.1-0.2-0.9 0.2-1.1 0 -0.2-0.2-0.6-1.6-1.1-2.1 -0.6-0.7-1-1.2-2.6-2.1 -0.7-0.4-0.6-0.1-1.1-0.5 -0.7-0.7-1.4 0-3.2-0.5 -0.7-0.2-0.5-0.9-1.6-1.1 -0.6-0.1-1.2-0.1-1.8 0v31c0.1-0.1 0.1-0.3 0.2-0.4 -0.6 0.9 1 0.9 1.1 1.1 0.3 0.6-0.2 1.5 0 2.1 1.5 4.5 1.1 11.6 2.1 15.8 0.4 1.8 1.4 3.5 1.6 5.3 0.8 6.9-1.3 15.2 0 20.6 1.7 6.9 3.4 13.1 4.2 20h7.4C128.1 154.3 128.1 154.1 128 154z\"/><path id=\"righthand\" d=\"M120.7 154.5c0 0 0 0 0 0 -0.9 1.5-1.9 3-2.6 4.7 -0.4 1.7 0.5 3.6 0.5 5.3 0.1 1.9-1.6 4.8 0.5 5.3 2.1 0.7 1.5-5.8 5.3-5.3 0.6 2.2-0.1 3.8-1.1 5.3 -1 1.4-3.4 2.9-4.7 3.2 -0.3 2.7 1.9 0 1.6 2.1 -0.8 0.8-1.8 1.4-2.1 2.6 -1 0.7 1.2 1.1 0 2.6 2.4 0.1 4.9-1.2 5.8-2.1 0.5-0.5 0.5-1.4 1.1-2.1 0.8-1 2-2 2.6-3.2 2.9-5.2 1-10.9 0.6-18.5H120.7z\"/></svg><div id=\"lefthandweapon\"></div><div id=\"righthandweapon\"></div><div id=\"overall\" class=\"health-full\">Top Shape</div></div><div id=\"hp-status\"><div><span>HP:</span><div class=\"progressbar\" id=\"hp-bar\"><div class=\"progressbar-text\">0/0</div><div class=\"progressbar-value\"></div></div></div><div><span>SP:</span><div class=\"progressbar\" id=\"sp-bar\"><div class=\"progressbar-text\">0/0</div><div class=\"progressbar-value\"></div></div></div><div><span>MP:</span><div class=\"progressbar\" id=\"mp-bar\"><div class=\"progressbar-text\">0/0</div><div class=\"progressbar-value\"></div></div></div></div></div><div id=\"experience\" class=\"status-panel\"><div><span>XP:</span><span id=\"xp-value\">0</span></div><div><span>Needed:</span><span id=\"need-value\">0</span><div class=\"progressbar\" id=\"need-percent\"><div class=\"progressbar-text\" style=\"text-align:right;right:2px;color:#000\">0</div><div class=\"progressbar-value\"></div></div></div><div><span>Earned:</span><span id=\"earn-value\">0</span></div><div><span>BankedXP:</span><span id=\"xp-banked\">0</span></div></div><div id=\"bars\" class=\"flex-grow-1\"><div id=\"party\"></div><div id=\"combat\"></div></div><div class=\"progressbar\" id=\"lagMeter\"><div class=\"progressbar-text\">0.000 s</div><div class=\"progressbar-value\" style=\"width:100%\"></div></div></div><div id=\"status-simple\"><div id=\"status-simple-hp\" data-var=\"hp\" class=\"progress\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div></div><div id=\"status-simple-sp\" data-var=\"sp\" class=\"progress\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div></div><div id=\"status-simple-mp\" data-var=\"mp\" class=\"progress\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div></div><div id=\"status-simple-xp\" data-var=\"xp\" class=\"progress\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div></div></div><div id=\"status-simple-lagMeter\" class=\"progress\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\"></div></div>", "import '../css/status.css';\r\nimport '../css/status.theme.css';\r\nimport { Client } from '../core/client';\r\nimport { Plugin } from '../core/plugin';\r\nimport { MenuItem } from '../core/types';\r\nimport { Dialog } from '../interface/dialog';\r\nimport { removeHash } from '../interface/interface';\r\nimport { capitalize, isMobile } from '../core/library';\r\nimport { Settings } from '../core/settings';\r\n\r\nexport enum UpdateType { none = 0, sortCombat = 1, sortParty = 2, overall = 4, xp = 8, status = 16 }\r\n\r\n//import status html layout\r\n// @ts-ignore\r\nimport statusDisplay from '../html/status.htm'\r\n\r\nexport class Status extends Plugin {\r\n    private _clientContainer;\r\n    private _info = [];\r\n    private _infoAC = [];\r\n    private _infoLimb = [];\r\n    private _ac: boolean = false;\r\n    private _lagMeter: HTMLElement;\r\n    private _updating: UpdateType;\r\n    private _rTimeout = 0;\r\n    private _dragging = false;\r\n    private _splitterDistance;\r\n    private _status: HTMLElement;\r\n    private _styles: CSSStyleDeclaration;\r\n    private _move;\r\n    private _skillsDialog: Dialog;\r\n    private _skillCategories;\r\n\r\n    get splitterDistance(): number { return this._splitterDistance; }\r\n    set splitterDistance(value: number) {\r\n        if (value === this._splitterDistance) return;\r\n        this._splitterDistance = value;\r\n        this._updateSplitter();\r\n    }\r\n\r\n    get maxWidth() {\r\n        return Math.floor(document.body.clientWidth * 0.66);\r\n    }\r\n\r\n    get currentLag(): string {\r\n        if (!this._lagMeter || !this._lagMeter.firstElementChild) return '';\r\n        return this._lagMeter.firstElementChild.textContent || '';\r\n    }\r\n\r\n    private _updateSplitter() {\r\n        const p = parseInt(this._styles.right, 10) * 2;\r\n        if (!this._splitterDistance || this._splitterDistance < 1) {\r\n            const bounds = this._status.getBoundingClientRect();\r\n            this._splitterDistance = bounds.width + document.body.clientWidth - bounds.right;\r\n        }\r\n        if (!this.client.getOption('showStatus'))\r\n            this._updateInterface();\r\n        else {\r\n            if (!this.client.getOption('statusMode'))\r\n                this._clientContainer.style.right = this._splitterDistance + 'px';\r\n            this._status.style.width = this._splitterDistance - p + 'px';\r\n            document.getElementById('status-drag-bar').style.right = this.splitterDistance + 'px'\r\n        }\r\n        this.client.setOption('statusWidth', this._splitterDistance);\r\n        this.emit('split-moved', this._splitterDistance);\r\n    }\r\n\r\n    constructor(client: Client) {\r\n        super(client);\r\n        this._clientContainer = document.getElementById('client-container');\r\n        if (!Settings.exist('statusMode'))\r\n            client.setOption('statusMode', isMobile() ? 1 : 0)\r\n    }\r\n    public remove(): void {\r\n        let idx = this.client.telnet.GMCPSupports.indexOf('Char 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n        idx = this.client.telnet.GMCPSupports.indexOf('Char.Vitals 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n        idx = this.client.telnet.GMCPSupports.indexOf('Char.Experience 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n        idx = this.client.telnet.GMCPSupports.indexOf('oMUD 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n        idx = this.client.telnet.GMCPSupports.indexOf('Char.Skills 1');\r\n        this.client.telnet.GMCPSupports.splice(idx, 1);\r\n        this.client.removeListenersFromCaller(this);\r\n        this.client.telnet.removeListenersFromCaller(this);\r\n        delete window.$character;\r\n        delete window.$characterid;\r\n    }\r\n    public initialize(): void {\r\n        document.body.insertAdjacentHTML('beforeend', statusDisplay);\r\n        this._status = document.getElementById('status');\r\n        this._styles = getComputedStyle(this._status);\r\n        this.client.telnet.GMCPSupports.push('oMUD 1', 'Char 1', 'Char.Vitals 1', 'Char.Experience 1', 'Char.Skills 1');\r\n        this.client.on('received-GMCP', this.processGMCP, this);\r\n        this.client.on('window', (window, args, name) => {\r\n            if (window === 'skills') {\r\n                if (args === 'close') {\r\n                    if (this._skillsDialog) this._skillsDialog.close();\r\n                }\r\n                else\r\n                    this.showSkills();\r\n            }\r\n        });\r\n        this.client.on('close-window', window => {\r\n            if (window === 'skills' && this._skillsDialog)\r\n                this._skillsDialog.close();\r\n        });\r\n        this._lagMeter = document.getElementById('lagMeter');\r\n        this.client.telnet.on('latency-changed', (lag, avg) => {\r\n            this.updateLagMeter(lag);\r\n        });\r\n        this.client.on('closed', () => {\r\n            this.updateLagMeter(0, true);\r\n        });\r\n        this.client.telnet.GMCPSupports.push('oMUD 1');\r\n        this.client.telnet.GMCPSupports.push('Char.Skills 1');\r\n        this.client.on('add-line', (data) => {\r\n            switch (data.line) {\r\n                case 'Connected...':\r\n                    this.init();\r\n                    return;\r\n                case 'You feel a tingle as you are surrounded by magical shield.':\r\n                case 'You feel a tingle as you are surrounded by a magical shield.':\r\n                case 'You feel a tingle as you are surrounded by magical buffer.':\r\n                case 'You feel a tingle as you are surrounded by a magical buffer.':\r\n                case 'You feel a tingle as you are surrounded by magical protection.':\r\n                case 'You feel a tingle as you are surrounded by a magical protection.':\r\n                case 'Blood flows and covers you forming a protective skin.':\r\n                case 'You feel your skin strengthen.':\r\n                case 'You feel your skin harden.':\r\n                case '^You feel your skin toughen.':\r\n                    document.getElementById('fullbody').classList.add('aura-blue');\r\n                    return;\r\n                case 'Your aura of protection wears off.':\r\n                case 'You feel your skin soften.':\r\n                case 'Blood flows off of you.':\r\n                case 'You remove a spell of protection from yourself.':\r\n                    document.getElementById('fullbody').classList.remove('aura-blue');\r\n                    return;\r\n                case 'You feel more protected as Makkairi\\'s Shield envelops you.':\r\n                    document.getElementById('fullbody').classList.add('aura-red');\r\n                    return;\r\n                case 'You feel more vulnerable as Makkairi\\'s Shield leaves you.':\r\n                    document.getElementById('fullbody').classList.remove('aura-red');\r\n                    return;\r\n            }\r\n            if (data.line.match(/^.* removes a spell of protection from you.$/))\r\n                document.getElementById('fullbody').classList.remove('aura-blue');\r\n        });\r\n        this.client.on('options-loaded', () => {\r\n            this._info['EXPERIENCE_NEED'] = this._info['EXPERIENCE_NEED_RAW'] - this._info['EXPERIENCE'];\r\n\r\n            if (this.client.getOption('showArmor')) {\r\n                this.ac = true;\r\n                this._status.querySelector('#health').classList.remove('active');\r\n                this._status.querySelector('#armor').classList.add('active');\r\n            }\r\n            let w = client.getOption('statusWidth');\r\n            if (w > document.body.clientWidth - this.maxWidth) w = document.body.clientWidth - this.maxWidth;\r\n            //Always want min width even if maxWidth is smaller\r\n            if (w < 184 && w != -1) w = 184;\r\n            this.splitterDistance = w;\r\n            this._updateInterface();\r\n            this._updateMenuItem();\r\n        });\r\n        this.on('debug', e => this.client.debug(e), this);\r\n        this.on('error', e => this.client.error(e), this);\r\n        document.getElementById('status-drag-bar').addEventListener('mousedown', (e: MouseEvent) => {\r\n            if (e.button !== 0) return;\r\n            e.preventDefault();\r\n            this._dragging = true;\r\n            const main = document.getElementById('status-drag-bar');\r\n            const w = this._status.style.width;\r\n            this._status.style.width = '';\r\n            const bounds = this._status.getBoundingClientRect();\r\n            this._status.style.width = w;\r\n            const bounds2 = main.getBoundingClientRect();\r\n            const ghostBar = document.createElement('div');\r\n            ghostBar.id = 'status-ghost-bar';\r\n            ghostBar.style.top = '0';\r\n            ghostBar.style.bottom = '0';\r\n            ghostBar.style.left = bounds2.left + 'px';\r\n            ghostBar.style.cursor = 'ew-resize';\r\n            document.body.append(ghostBar);\r\n            //Use max with unless minWidth is larger\r\n            const maxWidth = Math.min(this.maxWidth, document.body.clientWidth - bounds.width);\r\n            this._move = e => {\r\n                if (e.pageX <= maxWidth)\r\n                    ghostBar.style.left = maxWidth - bounds2.width + 'px';\r\n                else if (e.pageX > bounds.left - bounds2.width)\r\n                    ghostBar.style.left = bounds.left + parseInt(this._styles.right, 10) - bounds2.width + 'px';\r\n                else\r\n                    ghostBar.style.left = e.pageX + 'px';\r\n            }\r\n            document.addEventListener('mousemove', this._move);\r\n        });\r\n\r\n        window.addEventListener('resize', () => this.resize());\r\n        document.addEventListener('mouseup', e => {\r\n            if (!this._dragging) return;\r\n            const w = this._status.style.width;\r\n            this._status.style.width = '';\r\n            const bounds = this._status.getBoundingClientRect();\r\n            const minWidth = (bounds.width + parseInt(this._styles.right, 10));\r\n            const l = document.getElementById('status-drag-bar').getBoundingClientRect().width;\r\n            const maxWidth = Math.min(this.maxWidth, document.body.clientWidth - minWidth);\r\n            this._status.style.width = w;\r\n            if (e.pageX <= maxWidth)\r\n                this.splitterDistance = document.body.clientWidth - maxWidth;\r\n            else if (e.pageX > bounds.left - l)\r\n                this.splitterDistance = minWidth;\r\n            else\r\n                this.splitterDistance = document.body.clientWidth - e.pageX - l;\r\n            //this.splitterDistance = document.body.clientWidth - e.pageX + Math.abs(parseInt(document.getElementById('status-drag-bar').style.right, 10) || 0);\r\n            //this.splitterDistance = document.body.clientWidth - e.pageX + Math.abs(parseInt((this._status.querySelector('#status-drag-bar') as HTMLElement).style.left, 10) || 0);\r\n            document.getElementById('status-ghost-bar').remove();\r\n            document.removeEventListener('mousemove', this._move);\r\n            this._dragging = false;\r\n            this._updateInterface();\r\n        });\r\n        document.getElementById('status-close').addEventListener('click', () => {\r\n            this.client.setOption('showStatus', false);\r\n            this._updateInterface();\r\n            this._updateMenuItem();\r\n        });\r\n\r\n        this._status.querySelector('#health').addEventListener('click', () => {\r\n            if (!this.ac) return;\r\n            this.ac = false;\r\n            this._status.querySelector('#health').classList.add('active');\r\n            this._status.querySelector('#armor').classList.remove('active');\r\n            this.client.setOption('showArmor', this.ac);\r\n        });\r\n\r\n        this._status.querySelector('#armor').addEventListener('click', () => {\r\n            if (this.ac) return;\r\n            this.ac = true;\r\n            this._status.querySelector('#health').classList.remove('active');\r\n            this._status.querySelector('#armor').classList.add('active');\r\n            this.client.setOption('showArmor', this.ac);\r\n        });\r\n\r\n        if (this.client.getOption('showArmor')) {\r\n            this.ac = true;\r\n            this._status.querySelector('#health').classList.remove('active');\r\n            this._status.querySelector('#armor').classList.add('active');\r\n        }\r\n        let w = client.getOption('statusWidth');\r\n        if (w > document.body.clientWidth - this.maxWidth) w = document.body.clientWidth - this.maxWidth;\r\n        if (w < 184 && w != -1) w = 184;\r\n        this.splitterDistance = w;\r\n\r\n        Object.defineProperty(window, '$character', {\r\n            get: () => {\r\n                if (!this._info) return '';\r\n                return this._info['name'] || '';\r\n            },\r\n            configurable: true\r\n        });\r\n\r\n        //no character manager so return -1 to prevent breaking\r\n        Object.defineProperty(window, '$characterid', {\r\n            get: function () {\r\n                return -1;\r\n            },\r\n            configurable: true\r\n        });\r\n        this.client.display.container.append(document.getElementById('status-simple-lagMeter'));\r\n        this._updateSplitter();\r\n        this._updateInterface();\r\n        this.init();\r\n        let options = client.getWindowState('skills');\r\n        if (options && options.show)\r\n            this.showSkills();\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [\r\n            {\r\n                name: '-',\r\n                position: 5,\r\n                exists: '#menu-plugins',\r\n                id: 'plugins'\r\n            },\r\n            {\r\n                id: 'status',\r\n                name: this.client.getOption('showStatus') ? ' Hide status' : ' Show status',\r\n                active: this.client.getOption('showStatus'),\r\n                action: e => {\r\n                    this.client.setOption('showStatus', !this.client.getOption('showStatus'));\r\n                    this._updateInterface();\r\n                    this._updateMenuItem();\r\n                },\r\n                icon: '<i class=\"bi bi-heart-pulse-fill\"></i>',\r\n                position: 6\r\n            },\r\n            {\r\n                name: ' Show skills',\r\n                action: () => this.showSkills(),\r\n                icon: '<i class=\"bi bi-graph-up\"></i>',\r\n                position: '#menu-status'\r\n            }]\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' Status',\r\n            action: 'settings-status',\r\n            icon: '<i class=\"bi bi-heart-pulse-fill\"></i>',\r\n            position: 7\r\n        }]\r\n    }\r\n\r\n    public async processGMCP(mod: string, obj: any) {\r\n        try {\r\n            let limb;\r\n            switch (mod.toLowerCase()) {\r\n                case 'char.name':\r\n                    this._info['name'] = obj.name;\r\n                    this.setTitle(obj.name);\r\n                    break;\r\n                case 'char.base':\r\n                    this.init();\r\n                    this._info['name'] = obj.name;\r\n                    this.setTitle(obj.name);\r\n                    break;\r\n                case 'char.vitals':\r\n                    this.updateBar('hp-bar', obj.hp, obj.hpmax);\r\n                    this.updateBar('sp-bar', obj.sp, obj.spmax);\r\n                    this.updateBar('mp-bar', obj.mp, obj.mpmax);\r\n                    this._info['hp'] = obj.hp;\r\n                    this._info['hpmax'] = obj.hpmax;\r\n                    this._info['sp'] = obj.sp;\r\n                    this._info['spmax'] = obj.spmax;\r\n                    this._info['mp'] = obj.mp;\r\n                    this._info['mpmax'] = obj.mpmax;\r\n                    this.updateSimpleBar('status-simple-hp');\r\n                    this.updateSimpleBar('status-simple-sp');\r\n                    this.updateSimpleBar('status-simple-mp');\r\n                    this._doUpdate(UpdateType.overall);\r\n                    break;\r\n                case 'char.experience':\r\n                    this._info['EXPERIENCE'] = obj.current;\r\n                    this._info['EXPERIENCE_NEED_RAW'] = obj.need;\r\n                    this._info['EXPERIENCE_NEED'] = obj.need - obj.current;\r\n                    this._info['EXPERIENCE_NEED_P'] = obj.needPercent;\r\n                    this._info['EXPERIENCE_EARNED'] = obj.earned;\r\n                    this._info['EXPERIENCE_BANKED'] = obj.banked;\r\n                    this._doUpdate(UpdateType.xp);\r\n                    break;\r\n                case 'omud.ac':\r\n                    for (limb in obj) {\r\n                        if (!obj.hasOwnProperty(limb)) continue;\r\n                        this.setLimbAC(limb, obj[limb]);\r\n                        this.updateLimb(limb);\r\n                    }\r\n                    break;\r\n                case 'omud.limb':\r\n                    for (limb in obj) {\r\n                        if (!obj.hasOwnProperty(limb)) continue;\r\n                        this.setLimbHealth(limb, obj[limb]);\r\n                        this.updateLimb(limb);\r\n                    }\r\n                    break;\r\n                case 'omud.weapons':\r\n                    for (limb in obj) {\r\n                        if (!obj.hasOwnProperty(limb)) continue;\r\n                        this.setWeapon(limb, obj[limb]);\r\n                    }\r\n                    break;\r\n                case 'omud.environment':\r\n                    if (obj.weather) {\r\n                        const env = document.getElementById('environment');\r\n                        //env.className = env.className.split(' ').filter(c => !c.match(/^(weather-.*|intensity-hard)$/)).join(' ');\r\n                        env.classList.remove('weather-' + this._info['WEATHER'], 'intensity-hard');\r\n                        this._info['WEATHER'] = obj.weather;\r\n                        this._info['WEATHER_INTENSITY'] = obj.weather_intensity;\r\n                        if (obj.weather !== '0' && obj.weather !== 'none')\r\n                            env.classList.add('weather-' + obj.weather);\r\n                        if (obj.weather_intensity > 6)\r\n                            env.classList.add('intensity-hard');\r\n                    }\r\n                    if (obj.tod) {\r\n                        const env = document.getElementById('environment');\r\n                        env.classList.remove('day', 'night', 'twilight', 'dawn');\r\n                        env.classList.add(obj.tod);\r\n                        $('#environment').removeClass((index, className) => {\r\n                            return (className.match(/(^|\\s)moon\\d(-\\S+)?/g) || []).join(' ');\r\n                        });\r\n                        if (obj.moons) {\r\n                            env.classList.add('moon1', 'moon1-' + obj.moons[0]);\r\n                            env.classList.add('moon2', 'moon2-' + obj.moons[1]);\r\n                            env.classList.add('moon3', 'moon3-' + obj.moons[2]);\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'omud.combat':\r\n                    if (obj.action === 'leave') {\r\n                        this._clear('combat');\r\n                        this.emit('leave combat');\r\n                    }\r\n                    else if (obj.action === 'add')\r\n                        this.createIconBar('#combat', this._getID(obj, 'combat_'), obj.name, obj.hp, 100, this._livingClass(obj, 'monster-'), obj.order);\r\n                    else if (obj.action === 'update') {\r\n                        if (obj.hp === 0)\r\n                            this.removeBar(this._getID(obj, 'combat_'));\r\n                        else\r\n                            this.createIconBar('#combat', this._getID(obj, 'combat_'), obj.name, obj.hp, 100, this._livingClass(obj, 'monster-'), obj.order);\r\n                    }\r\n                    else if (obj.action === 'remove')\r\n                        this.removeBar(this._getID(obj, 'combat_'));\r\n                    break;\r\n                case 'omud.party':\r\n                    if (obj.action === 'leave') {\r\n                        this._clear('party');\r\n                        this.emit('leave party');\r\n                    }\r\n                    else if (obj.action === 'add') {\r\n                        this.createIconBar('#party', this._getID(obj, 'party_'), obj.name, obj.hp, 100, this._livingClass(obj, 'party-'), obj.name.replace('\"', ''));\r\n                    }\r\n                    else if (obj.action === 'update') {\r\n                        if (obj.hp === 0)\r\n                            this.removeBar(this._getID(obj, 'party_'), true);\r\n                        else\r\n                            this.createIconBar('#party', this._getID(obj, 'party_'), obj.name, obj.hp, 100, this._livingClass(obj, 'party-'), obj.name.replace('\"', ''));\r\n                    }\r\n                    else if (obj.action === 'remove')\r\n                        this.removeBar(this._getID(obj, 'party_'), true);\r\n\r\n                    if ((limb = document.getElementById('party')).children.length)\r\n                        limb.classList.add('hasmembers');\r\n                    else\r\n                        limb.classList.remove('hasmembers');\r\n                    break;\r\n                case 'omud.skill':\r\n                    if (obj.skill && obj.skill.length) {\r\n                        if (!this._info['skills'][obj.skill]) this._info['skills'][obj.skill] = { amount: 0, bonus: 0, percent: 0 };\r\n                        if (obj.hasOwnProperty('percent'))\r\n                            this._info['skills'][obj.skill].percent = obj.percent || 0;\r\n                        if (obj.hasOwnProperty('amount')) {\r\n                            this._info['skills'][obj.skill].amount = obj.amount;\r\n                            this._info['skills'][obj.skill].bonus = obj.bonus || 0;\r\n                            this._info['skills'][obj.skill].category = obj.category;\r\n                        }\r\n                        this._updateSkill(obj.skill, this._info['skills'][obj.skill])\r\n                        this.emit('skill updated', obj.skill, this._info['skills'][obj.skill]);\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        catch (e) {\r\n            this.emit('error', e);\r\n        }\r\n    }\r\n\r\n    private _updateInterface(noSplitter?) {\r\n        if (!this.client.getOption('showStatus')) {\r\n            this._clientContainer.style.right = '';\r\n            this._status.style.visibility = 'hidden';\r\n            this._status.style.display = 'none';\r\n            document.getElementById('status-drag-bar').style.display = 'none';\r\n            this.emit('updated-interface');\r\n            document.getElementById('status-simple').style.display = 'none';\r\n            document.getElementById('status-simple-lagMeter').style.visibility = this.client.getOption('lagMeter') ? 'visible' : '';\r\n            return;\r\n        }\r\n        if (this.client.getOption('statusMode')) {\r\n            this._clientContainer.style.right = '';\r\n            this._status.style.visibility = 'hidden';\r\n            this._status.style.display = 'none';\r\n            document.getElementById('status-drag-bar').style.display = 'none';\r\n            document.getElementById('status-simple').style.display = '';\r\n            document.getElementById('status-simple-lagMeter').style.visibility = this.client.getOption('lagMeter') ? 'visible' : '';\r\n            this.emit('updated-interface');\r\n            return;\r\n        }\r\n        document.getElementById('status-simple').style.display = 'none';\r\n        document.getElementById('status-simple-lagMeter').style.visibility = '';\r\n\r\n        const p = parseInt(this._styles.right, 10) * 2;\r\n        this._clientContainer.style.right = this._splitterDistance + 'px';\r\n        this._status.style.width = this._splitterDistance - p + 'px';\r\n\r\n        this._status.style.visibility = '';\r\n        this._status.style.display = '';\r\n        document.getElementById('status-drag-bar').style.display = '';\r\n\r\n        if (this.client.getOption('statusExperienceNeededProgressbar')) {\r\n            $('#need-value').css('display', 'none');\r\n            $('#need-percent').css('display', 'block');\r\n        }\r\n        else {\r\n            $('#need-value').css('display', '');\r\n            $('#need-percent').css('display', 'none');\r\n        }\r\n\r\n        if (this.client.getOption('showStatusWeather'))\r\n            $('#environment').css('display', '');\r\n        else\r\n            $('#environment').css('display', 'none');\r\n\r\n        if (!this.client.getOption('showStatusLimbs') && !this.client.getOption('showStatusHealth'))\r\n            $('#body').css('display', 'none');\r\n        else\r\n            $('#body').css('display', '');\r\n\r\n        if (!this.client.getOption('showStatusLimbs'))\r\n            $('#limbs').css('display', 'none');\r\n        else\r\n            $('#limbs').css('display', '');\r\n        if (!this.client.getOption('showStatusHealth'))\r\n            $('#hp-status').css('display', 'none');\r\n        else\r\n            $('#hp-status').css('display', '');\r\n\r\n        if (this.client.getOption('showStatusExperience'))\r\n            $('#experience').css('display', '');\r\n        else\r\n            $('#experience').css('display', 'none');\r\n\r\n        if (!this.client.getOption('showStatusPartyHealth') && !this.client.getOption('showStatusCombatHealth'))\r\n            $('#bars').css('min-height', '');\r\n        else\r\n            $('#bars').css('min-height', '0');\r\n\r\n        if (this.client.getOption('showStatusPartyHealth'))\r\n            $('#party').css('display', '');\r\n        else\r\n            $('#party').css('display', 'none');\r\n\r\n        if (this.client.getOption('showStatusCombatHealth'))\r\n            $('#combat').css('display', '');\r\n        else\r\n            $('#combat').css('display', 'none');\r\n\r\n        if (this._lagMeter) {\r\n            if (this.client.getOption('lagMeter')) {\r\n                this._lagMeter.style.visibility = '';\r\n                this._lagMeter.style.display = '';\r\n                this.updateLagMeter(0, true);\r\n            }\r\n            else {\r\n                this._lagMeter.style.visibility = 'hidden';\r\n                this._lagMeter.style.display = 'none';\r\n            }\r\n        }\r\n        if (!noSplitter)\r\n            this._updateSplitter();\r\n        this.emit('updated-interface');\r\n    }\r\n\r\n    public setTitle(title: string, lag?: string) {\r\n        if (!title || title.length === 0)\r\n            this._status.querySelector('#character-name').innerHTML = '&nbsp;';\r\n        else\r\n            this._status.querySelector('#character-name').textContent = title;\r\n\r\n        if (this.client.connected && lag && lag.length) {\r\n            if (title && title.length)\r\n                title = `${title} - ${lag}`;\r\n            else\r\n                title = `${lag}`;\r\n        }\r\n        client.emit('set-title', title || '');\r\n    }\r\n\r\n    public init() {\r\n        document.getElementById('fullbody').classList.remove('aura-red', 'aura-blue');\r\n        this.setTitle('');\r\n        this._info = [];\r\n        this._info['WEATHER'] = 'none';\r\n        this._info['WEATHER_INTENSITY'] = 0;\r\n        this._info['EXPERIENCE'] = 0;\r\n        this._info['EXPERIENCE_NEED'] = 0;\r\n        this._info['EXPERIENCE_NEED_P'] = 0;\r\n        this._info['EXPERIENCE_NEED_RAW'] = 0;\r\n        this._info['EXPERIENCE_EARNED'] = 0;\r\n        this._info['EXPERIENCE_BANKED'] = 0;\r\n        this._info['skills'] = {};\r\n\r\n        this._infoAC = [];\r\n        this._infoAC['head'] = 0;\r\n        this._infoAC['leftarm'] = 0;\r\n        this._infoAC['leftfoot'] = 0;\r\n        this._infoAC['lefthand'] = 0;\r\n        this._infoAC['leftleg'] = 0;\r\n        this._infoAC['rightarm'] = 0;\r\n        this._infoAC['rightfoot'] = 0;\r\n        this._infoAC['righthand'] = 0;\r\n        this._infoAC['rightleg'] = 0;\r\n        this._infoAC['torso'] = 0;\r\n        this._infoAC['overall'] = 0;\r\n\r\n        this._infoLimb = [];\r\n        this._infoLimb['head'] = 0;\r\n        this._infoLimb['leftarm'] = 0;\r\n        this._infoLimb['leftfoot'] = 0;\r\n        this._infoLimb['lefthand'] = 0;\r\n        this._infoLimb['leftleg'] = 0;\r\n        this._infoLimb['rightarm'] = 0;\r\n        this._infoLimb['rightfoot'] = 0;\r\n        this._infoLimb['righthand'] = 0;\r\n        this._infoLimb['rightleg'] = 0;\r\n        this._infoLimb['torso'] = 0;\r\n\r\n        document.getElementById('leftwing').style.display = 'none';\r\n        document.getElementById('rightwing').style.display = 'none';\r\n        document.getElementById('tail').style.display = 'none';\r\n        this.updateBar('hp-bar', 0, 0);\r\n        this.updateBar('sp-bar', 0, 0);\r\n        this.updateBar('mp-bar', 0, 0);\r\n        this.updateSimpleBar('status-simple-hp');\r\n        this.updateSimpleBar('status-simple-sp');\r\n        this.updateSimpleBar('status-simple-mp');\r\n        document.getElementById('xp-value').textContent = '0';\r\n        document.getElementById('xp-banked').textContent = '0';\r\n        document.getElementById('need-value').textContent = '0';\r\n        document.getElementById('earn-value').textContent = '0';\r\n        this.updateBar('need-percent', 0, 0, '0');\r\n        this.updateBar('status-simple-xp', 0, 0, '', true);\r\n        this._clear('combat');\r\n        this._clear('party');\r\n        document.getElementById('party').classList.remove('hasmembers');\r\n        this.updateOverall();\r\n        this.updateStatus();\r\n        this._resetSkills();\r\n        this.emit('skill init');\r\n    }\r\n\r\n    private _clear(id) {\r\n        const el = document.getElementById(id);\r\n        if (el) el.innerHTML = '';\r\n    }\r\n\r\n    public updateStatus() {\r\n        let limb;\r\n        if (this._ac)\r\n            for (limb in this._infoAC)\r\n                this.updateLimb(limb);\r\n        else\r\n            for (limb in this._infoLimb)\r\n                this.updateLimb(limb);\r\n        this._doUpdate(UpdateType.overall | UpdateType.xp);\r\n    }\r\n\r\n    public updateOverall() {\r\n        const el = document.getElementById('overall');\r\n        el.className = '';\r\n        if (this._ac) {\r\n            if (this._infoAC['overall'] === 6.5) {\r\n                el.textContent = 'Extensively';\r\n                el.classList.add('armor-extensively');\r\n            }\r\n            else if (this._infoAC['overall'] === 6) {\r\n                el.textContent = 'Completely';\r\n                el.classList.add('armor-completely');\r\n            }\r\n            else if (this._infoAC['overall'] === 5.5) {\r\n                el.textContent = 'Significantly';\r\n                el.classList.add('armor-significantly');\r\n            }\r\n            else if (this._infoAC['overall'] === 5) {\r\n                el.textContent = 'Considerably';\r\n                el.classList.add('armor-considerably');\r\n            }\r\n            else if (this._infoAC['overall'] === 4.5) {\r\n                el.textContent = 'Well';\r\n                el.classList.add('armor-well');\r\n            }\r\n            else if (this._infoAC['overall'] === 4) {\r\n                el.textContent = 'Adequately';\r\n                el.classList.add('armor-adequately');\r\n            }\r\n            else if (this._infoAC['overall'] === 3.5) {\r\n                el.textContent = 'Fairly';\r\n                el.classList.add('armor-fairly');\r\n            }\r\n            else if (this._infoAC['overall'] === 3) {\r\n                el.textContent = 'Moderately';\r\n                el.classList.add('armor-moderately');\r\n            }\r\n            else if (this._infoAC['overall'] === 2.5) {\r\n                el.textContent = 'Somewhat';\r\n                el.classList.add('armor-somewhat');\r\n            }\r\n            else if (this._infoAC['overall'] === 2) {\r\n                el.textContent = 'Slightly';\r\n                el.classList.add('armor-slightly');\r\n            }\r\n            else if (this._infoAC['overall'] === 1) {\r\n                el.textContent = 'Barely';\r\n                el.classList.add('armor-barely');\r\n            }\r\n            else {\r\n                el.textContent = 'UNARMORED';\r\n                el.classList.add('armor-unarmored');\r\n            }\r\n        }\r\n        else {\r\n            let v = 100;\r\n            if (this._info['hpmax'] !== 0 && !isNaN(this._info['hpmax']))\r\n                v *= this._info['hp'] / this._info['hpmax'];\r\n            if (v > 90) {\r\n                el.textContent = 'Top shape';\r\n                el.classList.add('health-full');\r\n            }\r\n            else if (v > 75) {\r\n                el.textContent = 'Decent shape';\r\n                el.classList.add('health-1-19');\r\n            }\r\n            else if (v > 60) {\r\n                el.textContent = 'Slightly injured';\r\n                el.classList.add('health-20-39');\r\n            }\r\n            else if (v > 45) {\r\n                el.textContent = 'Hurting';\r\n                el.classList.add('health-40-59');\r\n            }\r\n            else if (v > 30) {\r\n                el.textContent = 'Badly injured';\r\n                el.classList.add('health-60-79');\r\n            }\r\n            else if (v > 15) {\r\n                el.textContent = 'Terribly injured';\r\n                el.classList.add('health-80-99');\r\n            }\r\n            else {\r\n                el.textContent = 'Near death';\r\n                el.classList.add('health-100');\r\n            }\r\n        }\r\n    }\r\n\r\n    public updateLimb(limb) {\r\n        limb = limb.replace(/\\s/g, '');\r\n        limb = limb.toLowerCase();\r\n        if (limb === 'overall') {\r\n            this._doUpdate(UpdateType.overall);\r\n            return;\r\n        }\r\n        if (limb === 'righthoof')\r\n            limb = 'rightfoot';\r\n        else if (limb === 'lefthoof')\r\n            limb = 'leftfoot';\r\n        const eLimb = document.getElementById(limb);\r\n        if (!eLimb)\r\n            return;\r\n        eLimb.setAttribute('class', '');\r\n        eLimb.style.display = 'block';\r\n        //eLimb.style.visibility = 'visible';\r\n        if (this._ac) {\r\n            if (this._infoAC[limb] === 6.5)\r\n                eLimb.classList.add('armor-extensively');\r\n            else if (this._infoAC[limb] === 6)\r\n                eLimb.classList.add('armor-completely');\r\n            else if (this._infoAC[limb] === 5.5)\r\n                eLimb.classList.add('armor-significantly');\r\n            else if (this._infoAC[limb] === 5)\r\n                eLimb.classList.add('armor-considerably');\r\n            else if (this._infoAC[limb] === 4.5)\r\n                eLimb.classList.add('armor-well');\r\n            else if (this._infoAC[limb] === 4)\r\n                eLimb.classList.add('armor-adequately');\r\n            else if (this._infoAC[limb] === 3.5)\r\n                eLimb.classList.add('armor-fairly');\r\n            else if (this._infoAC[limb] === 3)\r\n                eLimb.classList.add('armor-moderately');\r\n            else if (this._infoAC[limb] === 2.5)\r\n                eLimb.classList.add('armor-somewhat');\r\n            else if (this._infoAC[limb] === 2)\r\n                eLimb.classList.add('armor-slightly');\r\n            else if (this._infoAC[limb] === 1)\r\n                eLimb.classList.add('armor-barely');\r\n            else\r\n                eLimb.classList.add('armor-unarmored');\r\n        }\r\n        else {\r\n            if (this._infoLimb[limb] === 100)\r\n                eLimb.classList.add('health-100');\r\n            else if (this._infoLimb[limb] >= 80)\r\n                eLimb.classList.add('health-80-99');\r\n            else if (this._infoLimb[limb] >= 60)\r\n                eLimb.classList.add('health-60-79');\r\n            else if (this._infoLimb[limb] >= 40)\r\n                eLimb.classList.add('health-40-59');\r\n            else if (this._infoLimb[limb] >= 20)\r\n                eLimb.classList.add('health-20-39');\r\n            else if (this._infoLimb[limb] >= 1)\r\n                eLimb.classList.add('health-1-19');\r\n            else\r\n                eLimb.classList.add('health-full');\r\n        }\r\n    }\r\n    public updateBar(id: string, value: number, max?: number, text?: string, noText?: boolean) {\r\n        const bar = document.getElementById(id);\r\n        if (!bar)\r\n            return;\r\n        else {\r\n            let p = 100;\r\n            if (max !== 0)\r\n                p = value / max * 100;\r\n            if (!noText)\r\n                bar.firstElementChild.textContent = text || (value + '/' + max);\r\n            (<HTMLElement>bar.lastElementChild).style.width = (100 - p) + '%';\r\n            (<HTMLElement>bar.lastElementChild).ariaValueNow = '' + p;\r\n        }\r\n    }\r\n\r\n    public updateSimpleBar(bar) {\r\n        let p;\r\n        const el = document.getElementById(bar);\r\n        if (!el) return;\r\n        const v = el.dataset.var.toLowerCase();\r\n        if (!this._info || !this._info[v + 'max'])\r\n            p = 100;\r\n        else\r\n            p = this._info[v] / this._info[v + 'max'] * 100;\r\n        const progress = (document.querySelector(`#${bar}  .progress-bar`) as HTMLElement);\r\n        progress.style.width = (100 - p) + '%';\r\n        progress.ariaValueNow = '' + p;\r\n    }\r\n\r\n    public createIconBar(parent, id, label, value, max, icon?, order?) {\r\n        let p = 100;\r\n        if (max !== 0)\r\n            p = value / max * 100;\r\n        p = Math.floor(p);\r\n        id = id.replace(' ', '');\r\n        let bar: any = document.getElementById(id);\r\n        if (!bar) {\r\n            if (!icon)\r\n                icon = label.replace(/\\d+$/, '').trim().replace(' ', '-');\r\n            bar = '<div title=\"' + label + '\" class=\"combat-bar\" id=\"' + id + '\" data-value=\"' + ((100 - p) / 20 * 20) + '\" data-order=\"' + order + '\">';\r\n            bar += '<div class=\"combat-icon ' + icon + '\"></div>';\r\n            bar += '<div class=\"combat-name\"> ' + label + '</div>';\r\n            bar += '<div class=\"progressbar\"><div class=\"progressbar-text\">' + p + '%</div>';\r\n            bar += '<div class=\"progressbar-value\" style=\"width: ' + (100 - p) + '%\"></div>';\r\n            bar += '</div></div>';\r\n            $(parent).append(bar);\r\n            this._doUpdate(parent === '#party' ? UpdateType.sortParty : UpdateType.sortCombat);\r\n        }\r\n        else {\r\n            if (order !== +bar.getAttribute('data-order')) {\r\n                bar.setAttribute('data-order', order);\r\n                this._doUpdate(parent === '#party' ? UpdateType.sortParty : UpdateType.sortCombat);\r\n            }\r\n            bar.setAttribute('data-value', (100 - p) / 20 * 20);\r\n            bar.children[1].textContent = label;\r\n            p = value / max * 100;\r\n            bar.lastElementChild.firstElementChild.textContent = Math.ceil(p) + '%';\r\n            (<HTMLElement>bar.lastElementChild.lastElementChild).style.width = (100 - p) + '%';\r\n        }\r\n    }\r\n\r\n    public removeBar(id, party?) {\r\n        const el = document.getElementById(id);\r\n        if (!el) return;\r\n        el.parentNode.removeChild(el);\r\n        this._doUpdate(party ? UpdateType.sortParty : UpdateType.sortCombat);\r\n    }\r\n\r\n    public sortBars(p) {\r\n        const listItems = p.children('div').get();\r\n        listItems.sort((a, b) => {\r\n            const compA = +a.getAttribute('data-order');\r\n            const compB = +b.getAttribute('data-order');\r\n            return (compA < compB) ? -1 : (compA > compB) ? 1 : 0;\r\n        });\r\n        $.each(listItems, (idx, itm) => { p.append(itm); });\r\n    }\r\n\r\n    public updateLagMeter(lag: number, force?: boolean) {\r\n        if (!this._lagMeter) return;\r\n        if (this.client.getOption('showLagInTitle'))\r\n            this.setTitle(this._info['name'] || '', `${lag / 1000}s`);\r\n        if (!this.client.getOption('lagMeter') && !force) return;\r\n        let p = 100;\r\n        p = lag / 200 * 100;\r\n        if (p > 100) p = 100;\r\n        (<HTMLElement>this._lagMeter.lastElementChild).style.width = (100 - p) + '%';\r\n        this._lagMeter.firstElementChild.textContent = (lag / 1000) + 's';\r\n\r\n        const lm = document.querySelector('#status-simple-lagMeter .progress-bar') as HTMLElement;\r\n        lm.style.width = (100 - p) + '%';\r\n        lm.ariaValueNow = '' + p;\r\n    }\r\n\r\n    private _doUpdate(type?: UpdateType) {\r\n        if (!type) return;\r\n        this._updating |= type;\r\n        if (this._updating === UpdateType.none || this._rTimeout)\r\n            return;\r\n        this._rTimeout = window.requestAnimationFrame(() => {\r\n            if ((this._updating & UpdateType.status) === UpdateType.status) {\r\n                this.updateStatus();\r\n                this._updating &= ~UpdateType.status;\r\n            }\r\n            if ((this._updating & UpdateType.sortCombat) === UpdateType.sortCombat) {\r\n                this.sortBars($('#combat'));\r\n                this._updating &= ~UpdateType.sortCombat;\r\n            }\r\n            if ((this._updating & UpdateType.sortParty) === UpdateType.sortParty) {\r\n                this.sortBars($('#party'));\r\n                this._updating &= ~UpdateType.sortParty;\r\n            }\r\n            if ((this._updating & UpdateType.overall) === UpdateType.overall) {\r\n                this.updateOverall();\r\n                this._updating &= ~UpdateType.overall;\r\n            }\r\n            if ((this._updating & UpdateType.xp) === UpdateType.xp) {\r\n                this.updateXP();\r\n                this._updating &= ~UpdateType.xp;\r\n            }\r\n            this._rTimeout = 0;\r\n            this._doUpdate(this._updating);\r\n        });\r\n    }\r\n\r\n    public updateXP() {\r\n        $('#xp-value').text(this._info['EXPERIENCE']);\r\n        $('#xp-banked').text(this._info['EXPERIENCE_BANKED']);\r\n        if (this._info['EXPERIENCE_NEED'] < 0) {\r\n            $('#need-value').text(this.client.getOption('allowNegativeNumberNeeded') ? this._info['EXPERIENCE_NEED'] : 0);\r\n            this.updateBar('need-percent', 100 - this._info['EXPERIENCE_NEED_P'], 100, this.client.getOption('allowNegativeNumberNeeded') ? this._info['EXPERIENCE_NEED'].toString() : '0');\r\n            this.updateBar('status-simple-xp', 100 - this._info['EXPERIENCE_NEED_P'], 100, '', true);\r\n        }\r\n        else {\r\n            $('#need-value').text(this._info['EXPERIENCE_NEED']);\r\n            this.updateBar('need-percent', 100 - this._info['EXPERIENCE_NEED_P'], 100, this._info['EXPERIENCE_NEED'].toString());\r\n            this.updateBar('status-simple-xp', 100 - this._info['EXPERIENCE_NEED_P'], 100, '', true);\r\n        }\r\n        $('#earn-value').text(this._info['EXPERIENCE_EARNED']);\r\n    }\r\n\r\n    public resize() {\r\n        if (!this.client.getOption('showStatus')) return;\r\n        const w = this._status.style.width;\r\n        this._status.style.width = '';\r\n        const bounds = this._status.getBoundingClientRect();\r\n        const minWidth = (bounds.width + parseInt(this._styles.right, 10));\r\n        const maxWidth = Math.min(document.body.clientWidth - this.maxWidth, document.body.clientWidth - minWidth);\r\n        this._status.style.width = w;\r\n        const bounds2 = this._status.getBoundingClientRect();\r\n        if (bounds2.width < minWidth) {\r\n            this.splitterDistance = minWidth;\r\n        }\r\n        else if (bounds2.width > maxWidth) {\r\n            this.splitterDistance = maxWidth;\r\n        }\r\n    }\r\n\r\n    get skills() {\r\n        return this._info['skills'];\r\n    }\r\n\r\n    public getSkill(skill: string) {\r\n        if (!skill) return 0;\r\n        return this._info['skills'][skill] || 0;\r\n    }\r\n\r\n    get name() {\r\n        return this._info['name'];\r\n    }\r\n\r\n    get ac(): boolean {\r\n        return this._ac;\r\n    }\r\n\r\n    set ac(enable: boolean) {\r\n        if (this._ac !== enable) {\r\n            this._ac = enable;\r\n            this._doUpdate(UpdateType.status);\r\n            this.emit('display-changed');\r\n        }\r\n    }\r\n\r\n    private _sanitizeID(id: string): string {\r\n        id = id.replace(/\\s/gi, '-');\r\n        return id.replace(/[^a-zA-Z0-9_-]/gi, '');\r\n    }\r\n\r\n    private _getID(obj, prefix?: string): string {\r\n        if (!obj) return;\r\n        if (!obj.id) return this._sanitizeID(obj.name || '');\r\n        return (prefix || 'obj_') + obj.id;\r\n    }\r\n\r\n    private _livingClass(obj, prefix?: string): string {\r\n        const cls = [];\r\n        if (!prefix) prefix = '';\r\n        if (obj.class && obj.class.length > 0)\r\n            cls.push(prefix + this._sanitizeID(obj.class));\r\n        if (obj.gender && obj.gender.length > 0)\r\n            cls.push(prefix + this._sanitizeID(obj.gender));\r\n        if (obj.race && obj.race.length > 0)\r\n            cls.push(prefix + this._sanitizeID(obj.race));\r\n        if (obj.guild && obj.guild.length > 0)\r\n            cls.push(prefix + this._sanitizeID(obj.guild));\r\n        if (obj.name && obj.name.length > 0)\r\n            cls.push(prefix + this._sanitizeID(obj.name.replace(/\\d+$/, '').trim()));\r\n        return cls.join(' ').toLowerCase();\r\n    }\r\n\r\n    public setWeapon(limb, weapon) {\r\n        const l = limb;\r\n        limb = limb.replace(/\\s/g, '');\r\n        limb = limb.toLowerCase();\r\n        const eLimb = document.getElementById(limb + 'weapon');\r\n        if (!eLimb)\r\n            return;\r\n        eLimb.className = '';\r\n        if (!weapon) return;\r\n        eLimb.classList.add('weapons');\r\n        if (weapon.quality && weapon.quality.length > 0)\r\n            eLimb.classList.add('weapon-' + this._sanitizeID(weapon.quality));\r\n        if (weapon.material && weapon.material.length > 0)\r\n            eLimb.classList.add('weapon-' + this._sanitizeID(weapon.material));\r\n        if (weapon.type && weapon.type.length > 0)\r\n            eLimb.classList.add('weapon-' + this._sanitizeID(weapon.type));\r\n        if (weapon.subtype && weapon.subtype.length > 0)\r\n            eLimb.classList.add('weapon-' + this._sanitizeID(weapon.subtype));\r\n        if (weapon.name && weapon.name.length > 0)\r\n            eLimb.classList.add('weapon-' + this._sanitizeID(weapon.name));\r\n        if (weapon.dominant)\r\n            eLimb.classList.add('weapon-dominant');\r\n        if (weapon.subtype && weapon.subtype.length > 0)\r\n            eLimb.title = weapon.subtype + ' in ' + l;\r\n        else if (weapon.type && weapon.type.length > 0)\r\n            eLimb.title = weapon.type + ' in ' + l;\r\n        else\r\n            eLimb.title = 'weapon in ' + l;\r\n    }\r\n\r\n    public setLimbAC(limb, ac) {\r\n        limb = limb.replace(/\\s/g, '');\r\n        limb = limb.toLowerCase();\r\n        if (limb === 'righthoof')\r\n            limb = 'rightfoot';\r\n        else if (limb === 'lefthoof')\r\n            limb = 'leftfoot';\r\n        this._infoAC[limb] = ac;\r\n    }\r\n\r\n    public setLimbHealth(limb, health) {\r\n        limb = limb.replace(/\\s/g, '');\r\n        limb = limb.toLowerCase();\r\n        if (limb === 'righthoof')\r\n            limb = 'rightfoot';\r\n        else if (limb === 'lefthoof')\r\n            limb = 'leftfoot';\r\n        this._infoLimb[limb] = health;\r\n    }\r\n\r\n    public showSkills() {\r\n        if (!this._skillsDialog) {\r\n            this._skillsDialog = new Dialog(Object.assign({}, client.getWindowState('skills') || { center: true }, { title: '<i class=\"bi bi-graph-up\"></i><select id=\"filter-skills\" class=\"form-select form-select-sm me-2 mb-1\" title=\"Filter skills\"><option value=\"All\">All</option></select>', id: 'win-skills', noFooter: true, minHeight: 350 }));\r\n            this._skillsDialog.body.classList.add('skills');\r\n            this._skillsDialog.on('resized', e => {\r\n                this.client.setOption('windows.skills', e);\r\n            });\r\n            this._skillsDialog.on('moved', e => {\r\n                this.client.setOption('windows.skills', e);\r\n            })\r\n            this._skillsDialog.on('maximized', () => {\r\n                this.client.setOption('windows.skills', this._skillsDialog.windowState);\r\n            });\r\n            this._skillsDialog.on('restored', () => {\r\n                this.client.setOption('windows.skills', this._skillsDialog.windowState);\r\n            });\r\n            this._skillsDialog.on('shown', () => {\r\n                this.client.setOption('windows.skills', this._skillsDialog.windowState);\r\n            });\r\n            this._skillsDialog.on('closed', () => {\r\n                this.client.setOption('windows.skills', this._skillsDialog.windowState);\r\n                removeHash('skills');\r\n                if (this._skillsDialog && !this._skillsDialog.persistent) {\r\n                    delete this._skillsDialog;\r\n                    this._skillsDialog = null;\r\n                }\r\n            });\r\n            this._skillsDialog.on('canceled', () => {\r\n                this.client.setOption('windows.skills', this._skillsDialog.windowState);\r\n                removeHash('skills');\r\n                if (this._skillsDialog && !this._skillsDialog.persistent) {\r\n                    delete this._skillsDialog;\r\n                    this._skillsDialog = null;\r\n                }\r\n            });\r\n            const filter = this._skillsDialog.header.querySelector('#filter-skills') as HTMLSelectElement;\r\n            filter.addEventListener('change', e => {\r\n                const cats = this._skillsDialog.body.querySelectorAll('.category');\r\n                const selected = this._skillsDialog.header.querySelector('#filter-skills option:checked').textContent;\r\n                if (selected === 'All')\r\n                    cats.forEach(cat => cat.style.display = '');\r\n                else {\r\n                    cats.forEach(cat => cat.style.display = 'none');\r\n                    this._skillsDialog.body.querySelector(`#${selected.toLowerCase()}`).style.display = '';\r\n                }\r\n            });\r\n        }\r\n        this._loadSkills();\r\n        this._skillsDialog.show();\r\n    }\r\n\r\n\r\n    private _loadSkills() {\r\n        const _skills = this._info['skills'];\r\n        let cats = {};\r\n        let cnt = 0;\r\n        let keys = Object.keys(_skills).sort();\r\n        for (let key in keys) {\r\n            let skill = keys[key];\r\n            if (!Object.prototype.hasOwnProperty.call(_skills, skill))\r\n                continue;\r\n            if (!cats[_skills[skill].category || 'default'])\r\n                cats[_skills[skill].category || 'default'] = this._createLabel(skill);\r\n            else\r\n                cats[_skills[skill].category || 'default'] += this._createLabel(skill);\r\n            cnt++;;\r\n        }\r\n        var body = '';\r\n        if (cnt > 0) {\r\n            this._skillCategories = Object.keys(cats).sort();\r\n            let opts = '';\r\n            for (let key in this._skillCategories) {\r\n                let cat = this._skillCategories[key];\r\n                opts += `<option value=\"${capitalize(cat)}\">${capitalize(cat)}</option>`;\r\n                if (cats[cat].length === 0 || !Object.prototype.hasOwnProperty.call(cats, cat))\r\n                    continue;\r\n                body += '<div class=\"category\" id=\"' + cat.toLowerCase() + '\">';\r\n                if (cnt > 1 || cat != 'default')\r\n                    body += '<div class=\"category-title\">' + capitalize(cat) + '</div>';\r\n                body += '<div class=\"category-body\" id=\"' + cat + 'Body\">' + cats[cat] + '</div></div>';\r\n            }\r\n            this._skillsDialog.header.querySelector('#filter-skills').insertAdjacentHTML('beforeend', opts);\r\n        }\r\n        else {\r\n            this._skillCategories = [];\r\n            body = body += '<div class=\"category\" id=\"default\">No skills</div>';\r\n        }\r\n        this._skillsDialog.body.innerHTML = body;\r\n    };\r\n\r\n    private _updateSkill(skill, data) {\r\n        if (!this._skillsDialog) return;\r\n        let _el = this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}.label`);\r\n        if (!_el) {\r\n            _el = this._skillsDialog.body.querySelector(`#${(data.category || 'default')}Body`)\r\n            var found = 0;\r\n            var nodes;\r\n            if (!_el) {\r\n                var cat = capitalize(data.category || 'default');\r\n                this._skillCategories.push(cat.toLowerCase());\r\n                let body = '<div class=\"category\" id=\"' + cat.toLowerCase() + '\">';\r\n                body += '<div class=\"category-title\">' + cat + '</div>';\r\n                body += '<div class=\"category-body\" id=\"' + (data.category || 'default') + 'Body\">' + this._createLabel(skill) + '</div></div>';\r\n                nodes = this._skillsDialog.body.querySelectorAll('.category');\r\n                for (var n = 0, nl = nodes.length; n < nl; n++) {\r\n                    if (nodes[n].children[0].textContent < cat)\r\n                        continue;\r\n                    nodes[n].insertAdjacentHTML('beforebegin', body);\r\n                    found = 1;\r\n                    break;\r\n                }\r\n                if (!found)\r\n                    this._skillsDialog.body.insertAdjacentHTML('beforeend', body);\r\n                this._updateFilter();\r\n            }\r\n            else {\r\n                nodes = this._skillsDialog.body.querySelector(`#${(data.category || 'default')}Body`).children;\r\n                found = 0;\r\n                for (var n = 0, nl = nodes.length; n < nl; n++) {\r\n                    if (nodes[n].getAttribute('title') < skill)\r\n                        continue;\r\n                    nodes[n].insertAdjacentHTML('beforebegin', this._createLabel(skill));\r\n                    found = 1;\r\n                    break;\r\n                }\r\n                if (!found)\r\n                    _el.insertAdjacentHTML('beforeend', this._createLabel(skill));\r\n            }\r\n        }\r\n        else {\r\n            this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Amount`).innerHTML = data.amount;\r\n            if (data.bonus > 0)\r\n                this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Bonus`).innerHTML = '+' + data.bonus;\r\n            else if (data.bonus < 0)\r\n                this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Bonus`).innerHTML = '<span class=\"neg\">-' + data.bonus + '</span>';\r\n            else\r\n                this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Bonus`).innerHTML = data.bonus;\r\n            if (data.percent === 100)\r\n                this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Percent`).innerHTML = '<span class=\"maxed\">MAX!</span>';\r\n            else\r\n                this._skillsDialog.body.querySelector(`#${this._sanitizeID(skill)}Percent`).innerHTML = data.percent + '%';\r\n        }\r\n    };\r\n\r\n    private _updateFilter() {\r\n        const filter = this._skillsDialog.header.querySelector('#filter-skills');\r\n        let val = filter.value;\r\n        filter.innerHTML = '<option value=\"All\">All</option>';\r\n        this._skillCategories.sort();\r\n        let opts = '';\r\n        for (let key in this._skillCategories)\r\n            opts += `<option value=\"${capitalize(this._skillCategories[key])}\">${capitalize(this._skillCategories[key])}</option>`;\r\n        filter.insertAdjacentHTML('beforeend', opts);\r\n        filter.value = val;\r\n    }\r\n\r\n    private _resetSkills() {\r\n        if (!this._skillsDialog) return;\r\n        this._skillsDialog.body.innerHTML = '';\r\n        const filter = this._skillsDialog.header.querySelector('#filter-skills');\r\n        filter.innerHTML = '<option value=\"All\" selected>All</option>';\r\n        this._skillCategories = [];\r\n    }\r\n\r\n    private _createLabel(skill) {\r\n        const data = this._info['skills'][skill];\r\n        const id = this._sanitizeID(skill);\r\n        let label = '<div title=\"' + skill + '\" class=\"label\" id=\"' + id + '\">';\r\n        label += '<div class=\"skill\" id=\"' + id + 'Label\">' + id + '</div>';\r\n        label += '<div class=\"amount\" id=\"' + id + 'Amount\">' + data.amount + '</div>';\r\n        if (data.bonus > 0)\r\n            label += '<div class=\"bonus\" id=\"' + id + 'Bonus\">+' + data.bonus + '</div>';\r\n        else if (data.bonus < 0)\r\n            label += '<div class=\"bonus\" id=\"' + id + 'Bonus\"><span class=\"neg\">-' + data.bonus + '</span></div>';\r\n        else\r\n            label += '<div class=\"bonus\" id=\"' + id + 'Bonus\">' + data.bonus + '</div>';\r\n        if (data.percent === 100)\r\n            label += '<div class=\"percent\" id=\"' + id + 'Percent\"><span class=\"maxed\">MAX!</span></div>';\r\n        else\r\n            label += '<div class=\"percent\" id=\"' + id + 'Percent\">' + data.percent + '%</div>';\r\n        label += '</div>';\r\n        return label;\r\n    }\r\n\r\n    private _updateMenuItem() {\r\n        let button = document.querySelector('#menu-status') as HTMLElement;\r\n        if (client.getOption('showStatus')) {\r\n            button.title = 'Hide status';\r\n            button.classList.add('active');\r\n            document.querySelector('#menu-status a span').textContent = ' Hide status';\r\n        }\r\n        else {\r\n            button.title = 'Show status';\r\n            button.classList.remove('active');\r\n            document.querySelector('#menu-status a span').textContent = ' Show status';\r\n        }\r\n    }\r\n}", "export default \"data:application/javascript;base64,KCgpPT57ZnVuY3Rpb24gZShlKXt0aGlzLm9rPSExLCIjIj09ZS5jaGFyQXQoMCkmJihlPWUuc3Vic3RyKDEsNikpLGU9KGU9ZS5yZXBsYWNlKC8gL2csIiIpKS50b0xvd2VyQ2FzZSgpO3ZhciBhPXthbGljZWJsdWU6ImYwZjhmZiIsYW50aXF1ZXdoaXRlOiJmYWViZDciLGFxdWE6IjAwZmZmZiIsYXF1YW1hcmluZToiN2ZmZmQ0IixhenVyZToiZjBmZmZmIixiZWlnZToiZjVmNWRjIixiaXNxdWU6ImZmZTRjNCIsYmxhY2s6IjAwMDAwMCIsYmxhbmNoZWRhbG1vbmQ6ImZmZWJjZCIsYmx1ZToiMDAwMGZmIixibHVldmlvbGV0OiI4YTJiZTIiLGJyb3duOiJhNTJhMmEiLGJ1cmx5d29vZDoiZGViODg3IixjYWRldGJsdWU6IjVmOWVhMCIsY2hhcnRyZXVzZToiN2ZmZjAwIixjaG9jb2xhdGU6ImQyNjkxZSIsY29yYWw6ImZmN2Y1MCIsY29ybmZsb3dlcmJsdWU6IjY0OTVlZCIsY29ybnNpbGs6ImZmZjhkYyIsY3JpbXNvbjoiZGMxNDNjIixjeWFuOiIwMGZmZmYiLGRhcmtibHVlOiIwMDAwOGIiLGRhcmtjeWFuOiIwMDhiOGIiLGRhcmtnb2xkZW5yb2Q6ImI4ODYwYiIsZGFya2dyYXk6ImE5YTlhOSIsZGFya2dyZWVuOiIwMDY0MDAiLGRhcmtraGFraToiYmRiNzZiIixkYXJrbWFnZW50YToiOGIwMDhiIixkYXJrb2xpdmVncmVlbjoiNTU2YjJmIixkYXJrb3JhbmdlOiJmZjhjMDAiLGRhcmtvcmNoaWQ6Ijk5MzJjYyIsZGFya3JlZDoiOGIwMDAwIixkYXJrc2FsbW9uOiJlOTk2N2EiLGRhcmtzZWFncmVlbjoiOGZiYzhmIixkYXJrc2xhdGVibHVlOiI0ODNkOGIiLGRhcmtzbGF0ZWdyYXk6IjJmNGY0ZiIsZGFya3R1cnF1b2lzZToiMDBjZWQxIixkYXJrdmlvbGV0OiI5NDAwZDMiLGRlZXBwaW5rOiJmZjE0OTMiLGRlZXBza3libHVlOiIwMGJmZmYiLGRpbWdyYXk6IjY5Njk2OSIsZG9kZ2VyYmx1ZToiMWU5MGZmIixmZWxkc3BhcjoiZDE5Mjc1IixmaXJlYnJpY2s6ImIyMjIyMiIsZmxvcmFsd2hpdGU6ImZmZmFmMCIsZm9yZXN0Z3JlZW46IjIyOGIyMiIsZnVjaHNpYToiZmYwMGZmIixnYWluc2Jvcm86ImRjZGNkYyIsZ2hvc3R3aGl0ZToiZjhmOGZmIixnb2xkOiJmZmQ3MDAiLGdvbGRlbnJvZDoiZGFhNTIwIixncmF5OiI4MDgwODAiLGdyZWVuOiIwMDgwMDAiLGdyZWVueWVsbG93OiJhZGZmMmYiLGhvbmV5ZGV3OiJmMGZmZjAiLGhvdHBpbms6ImZmNjliNCIsaW5kaWFucmVkOiJjZDVjNWMiLGluZGlnbzoiNGIwMDgyIixpdm9yeToiZmZmZmYwIixraGFraToiZjBlNjhjIixsYXZlbmRlcjoiZTZlNmZhIixsYXZlbmRlcmJsdXNoOiJmZmYwZjUiLGxhd25ncmVlbjoiN2NmYzAwIixsZW1vbmNoaWZmb246ImZmZmFjZCIsbGlnaHRibHVlOiJhZGQ4ZTYiLGxpZ2h0Y29yYWw6ImYwODA4MCIsbGlnaHRjeWFuOiJlMGZmZmYiLGxpZ2h0Z29sZGVucm9keWVsbG93OiJmYWZhZDIiLGxpZ2h0Z3JleToiZDNkM2QzIixsaWdodGdyZWVuOiI5MGVlOTAiLGxpZ2h0cGluazoiZmZiNmMxIixsaWdodHNhbG1vbjoiZmZhMDdhIixsaWdodHNlYWdyZWVuOiIyMGIyYWEiLGxpZ2h0c2t5Ymx1ZToiODdjZWZhIixsaWdodHNsYXRlYmx1ZToiODQ3MGZmIixsaWdodHNsYXRlZ3JheToiNzc4ODk5IixsaWdodHN0ZWVsYmx1ZToiYjBjNGRlIixsaWdodHllbGxvdzoiZmZmZmUwIixsaW1lOiIwMGZmMDAiLGxpbWVncmVlbjoiMzJjZDMyIixsaW5lbjoiZmFmMGU2IixtYWdlbnRhOiJmZjAwZmYiLG1hcm9vbjoiODAwMDAwIixtZWRpdW1hcXVhbWFyaW5lOiI2NmNkYWEiLG1lZGl1bWJsdWU6IjAwMDBjZCIsbWVkaXVtb3JjaGlkOiJiYTU1ZDMiLG1lZGl1bXB1cnBsZToiOTM3MGQ4IixtZWRpdW1zZWFncmVlbjoiM2NiMzcxIixtZWRpdW1zbGF0ZWJsdWU6IjdiNjhlZSIsbWVkaXVtc3ByaW5nZ3JlZW46IjAwZmE5YSIsbWVkaXVtdHVycXVvaXNlOiI0OGQxY2MiLG1lZGl1bXZpb2xldHJlZDoiYzcxNTg1IixtaWRuaWdodGJsdWU6IjE5MTk3MCIsbWludGNyZWFtOiJmNWZmZmEiLG1pc3R5cm9zZToiZmZlNGUxIixtb2NjYXNpbjoiZmZlNGI1IixuYXZham93aGl0ZToiZmZkZWFkIixuYXZ5OiIwMDAwODAiLG9sZGxhY2U6ImZkZjVlNiIsb2xpdmU6IjgwODAwMCIsb2xpdmVkcmFiOiI2YjhlMjMiLG9yYW5nZToiZmZhNTAwIixvcmFuZ2VyZWQ6ImZmNDUwMCIsb3JjaGlkOiJkYTcwZDYiLHBhbGVnb2xkZW5yb2Q6ImVlZThhYSIscGFsZWdyZWVuOiI5OGZiOTgiLHBhbGV0dXJxdW9pc2U6ImFmZWVlZSIscGFsZXZpb2xldHJlZDoiZDg3MDkzIixwYXBheWF3aGlwOiJmZmVmZDUiLHBlYWNocHVmZjoiZmZkYWI5IixwZXJ1OiJjZDg1M2YiLHBpbms6ImZmYzBjYiIscGx1bToiZGRhMGRkIixwb3dkZXJibHVlOiJiMGUwZTYiLHB1cnBsZToiODAwMDgwIixyZWQ6ImZmMDAwMCIscm9zeWJyb3duOiJiYzhmOGYiLHJveWFsYmx1ZToiNDE2OWUxIixzYWRkbGVicm93bjoiOGI0NTEzIixzYWxtb246ImZhODA3MiIsc2FuZHlicm93bjoiZjRhNDYwIixzZWFncmVlbjoiMmU4YjU3IixzZWFzaGVsbDoiZmZmNWVlIixzaWVubmE6ImEwNTIyZCIsc2lsdmVyOiJjMGMwYzAiLHNreWJsdWU6Ijg3Y2VlYiIsc2xhdGVibHVlOiI2YTVhY2QiLHNsYXRlZ3JheToiNzA4MDkwIixzbm93OiJmZmZhZmEiLHNwcmluZ2dyZWVuOiIwMGZmN2YiLHN0ZWVsYmx1ZToiNDY4MmI0Iix0YW46ImQyYjQ4YyIsdGVhbDoiMDA4MDgwIix0aGlzdGxlOiJkOGJmZDgiLHRvbWF0bzoiZmY2MzQ3Iix0dXJxdW9pc2U6IjQwZTBkMCIsdmlvbGV0OiJlZTgyZWUiLHZpb2xldHJlZDoiZDAyMDkwIix3aGVhdDoiZjVkZWIzIix3aGl0ZToiZmZmZmZmIix3aGl0ZXNtb2tlOiJmNWY1ZjUiLHllbGxvdzoiZmZmZjAwIix5ZWxsb3dncmVlbjoiOWFjZDMyIn07Zm9yKHZhciB0IGluIGEpZT09dCYmKGU9YVt0XSk7Zm9yKHZhciByPVt7cmU6L15yZ2JcKChcZHsxLDN9KSxccyooXGR7MSwzfSksXHMqKFxkezEsM30pXCkkLyxleGFtcGxlOlsicmdiKDEyMywgMjM0LCA0NSkiLCJyZ2IoMjU1LDIzNCwyNDUpIl0scHJvY2VzczpmdW5jdGlvbihlKXtyZXR1cm5bcGFyc2VJbnQoZVsxXSwxMCkscGFyc2VJbnQoZVsyXSwxMCkscGFyc2VJbnQoZVszXSwxMCldfX0se3JlOi9eKFx3ezJ9KShcd3syfSkoXHd7Mn0pJC8sZXhhbXBsZTpbIiMwMGZmMDAiLCIzMzY2OTkiXSxwcm9jZXNzOmZ1bmN0aW9uKGUpe3JldHVybltwYXJzZUludChlWzFdLDE2KSxwYXJzZUludChlWzJdLDE2KSxwYXJzZUludChlWzNdLDE2KV19fSx7cmU6L14oXHd7MX0pKFx3ezF9KShcd3sxfSkkLyxleGFtcGxlOlsiI2ZiMCIsImYwZiJdLHByb2Nlc3M6ZnVuY3Rpb24oZSl7cmV0dXJuW3BhcnNlSW50KGVbMV0rZVsxXSwxNikscGFyc2VJbnQoZVsyXStlWzJdLDE2KSxwYXJzZUludChlWzNdK2VbM10sMTYpXX19XSxzPTAsbj1yLmxlbmd0aDtzPG47cysrKXt2YXIgZj1yW3NdLnJlLGM9cltzXS5wcm9jZXNzLGk9Zi5leGVjKGUpO2lmKGkpe3ZhciBvPWMoaSk7dGhpcy5yPW9bMF0sdGhpcy5nPW9bMV0sdGhpcy5iPW9bMl0sdGhpcy5vaz0hMH19dGhpcy5yPXRoaXMucjwwfHxpc05hTih0aGlzLnIpPzA6dGhpcy5yPjI1NT8yNTU6dGhpcy5yLHRoaXMuZz10aGlzLmc8MHx8aXNOYU4odGhpcy5nKT8wOnRoaXMuZz4yNTU/MjU1OnRoaXMuZyx0aGlzLmI9dGhpcy5iPDB8fGlzTmFOKHRoaXMuYik/MDp0aGlzLmI+MjU1PzI1NTp0aGlzLmIsdGhpcy50b1JHQj1mdW5jdGlvbigpe3JldHVybiJyZ2IoIit0aGlzLnIrIiwgIit0aGlzLmcrIiwgIit0aGlzLmIrIikifSx0aGlzLnRvSGV4PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5yLnRvU3RyaW5nKDE2KSxhPXRoaXMuZy50b1N0cmluZygxNiksdD10aGlzLmIudG9TdHJpbmcoMTYpO3JldHVybiAxPT1lLmxlbmd0aCYmKGU9IjAiK2UpLDE9PWEubGVuZ3RoJiYoYT0iMCIrYSksMT09dC5sZW5ndGgmJih0PSIwIit0KSwiIyIrZSthK3R9fWltcG9ydFNjcmlwdHMoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbW9tZW50QDIuMzAuMS9tb21lbnQubWluLmpzIik7dmFyIGEsdCxyPXtvZmZsaW5lOiExLGdhZ2dlZDohMSxlbmFibGVkOiExLHVuaXF1ZTohMCxwcmVwZW5kOiExLG5hbWU6IiIsd2hhdDoxLGRlYnVnOiExLHRpbWVzdGFtcDowLHRpbWVzdGFtcEZvcm1hdDoiW1tdTU0tREQgSEg6bW06c3MuU1NTW11dICJ9LHM9ITEsbj0iIixmPSExLGM9IiIsaT17fSxvPTAsbD17fSxiPTAsZz17fSxkPW51bGw7ZnVuY3Rpb24gdSgpe2NvbnN0IGU9YztjPXIucHJlZml4P3IucHJlZml4K246bixyLm5hbWUmJnIubmFtZS5sZW5ndGg+MCYmKGMrPSIuIityLm5hbWUpLHIucG9zdGZpeCYmKGMrPXIucG9zdGZpeCksci5kZWJ1ZyYmZSE9PWMmJnBvc3RNZXNzYWdlKHtldmVudDoiZGVidWciLGFyZ3M6J0xvZyBmaWxlOiAiJytjKyciJ30pfWZ1bmN0aW9uIG0oZSx0LHMpe3RyeXtpZihnW2VdfHwoZ1tlXT1bXSksZ1tlXS5sZW5ndGgmJiFzKXJldHVybiB2b2lkIGdbZV0ucHVzaCh7ZmlsZTplLGRhdGE6dH0pO2dbZV0udW5zaGlmdCh7ZmlsZTplLGRhdGE6dH0pLHBvc3RNZXNzYWdlKHtldmVudDoid3JpdGUiLGZpbGU6ZSxkYXRhOnQsY2hhcmFjdGVyOnIubmFtZXx8IiIsdGltZVN0YW1wOmEscG9zdGZpeDpyLnBvc3RmaXgscHJlZml4OnIucHJlZml4fSl9Y2F0Y2goZSl7cG9zdE1lc3NhZ2Uoe2V2ZW50OiJlcnJvciIsYXJnczplfSl9fWZ1bmN0aW9uIHAoZSl7ZiYmKHIub2ZmbGluZXx8cykmJihjJiYwIT09Yy5sZW5ndGh8fHUoKSxtKGMrIi50eHQiLGUpKX1mdW5jdGlvbiBoKGUpe2YmJihyLm9mZmxpbmV8fHMpJiYoYyYmMCE9PWMubGVuZ3RofHx1KCksbShjKyIuaHRtIixlKSl9ZnVuY3Rpb24gayhlKXtmJiYoci5vZmZsaW5lfHxzKSYmKGMmJjAhPT1jLmxlbmd0aHx8dSgpLG0oYysiLnJhdyIsZSkpfWZ1bmN0aW9uIHcoZSl7aWYoIXR8fCF0LmxvZ2dpbmd8fCF0Lm9mZmxpbmUmJiF0LmNvbm5lY3RlZClyZXR1cm47Y29uc3QgYT1zLG49YyxpPWY7aWYoZj10LmxvZ2dpbmcscz10LmNvbm5lY3RlZCxjPXQuY3VycmVudEZpbGUsIXQuZ2FnZ2VkKXtsZXQgYT0iIjtlJiYoYT0iXG4iKSwxJn50LndoYXR8fGgoTSh7dGV4dDp0LmxpbmUsZm9ybWF0czp0LmZvcm1hdHMsdGltZXN0YW1wOnQudGltZXN0YW1wfHxEYXRlLm5vdygpfSkpLDImfnQud2hhdCYmMCE9PXQud2hhdHx8KDI9PT1yLnRpbWVzdGFtcD9wKG1vbWVudCh0LnRpbWVzdGFtcCkuZm9ybWF0KHIudGltZXN0YW1wRm9ybWF0KSk6MCE9PXIudGltZXN0YW1wJiZwKG5ldyBEYXRlKHQudGltZXN0YW1wKS50b0lTT1N0cmluZygpKSxwKHQubGluZSthKSksNCZ+dC53aGF0fHwobW9tZW50JiYyPT09ci50aW1lc3RhbXA/cCgiG1stNzstOG0iK21vbWVudCh0LnRpbWVzdGFtcCkuZm9ybWF0KHIudGltZXN0YW1wRm9ybWF0KSsiG1swbSIpOjAhPT1yLnRpbWVzdGFtcCYmcCgiG1stNzstOG0iK25ldyBEYXRlKHQudGltZXN0YW1wKS50b0lTT1N0cmluZygpKyIbWzBtIiksayh0LnJhdythKSl9Zj1pLHM9YSxjPW4sdD1udWxsfWZ1bmN0aW9uIHYoZSx0KXtyLmVuYWJsZWQ/KGY9ITAsKHIudW5pcXVlfHwwPT09YSkmJihhPShuZXcgRGF0ZSkuZ2V0VGltZSgpLG49bmV3IG1vbWVudChhKS5mb3JtYXQoci5mb3JtYXR8fCJZWVlZTU1ERC1ISG1tc3MiKSx3KCEwKSksdSgpLHIucHJlcGVuZCYmZSYmZS5sZW5ndGg+MCYmKDEmfnIud2hhdHx8aChmdW5jdGlvbihlKXtjb25zdCBhPVtdLHQ9ZS5sZW5ndGg7Zm9yKGxldCByPTA7cjx0O3IrKylhLnB1c2goTShlW3JdKSk7cmV0dXJuIGEuam9pbigiIil9KGV8fFtdKSksMiZ+ci53aGF0JiYwIT09ci53aGF0fHwoMj09PXIudGltZXN0YW1wP3AoZS5tYXAoKGU9Pm1vbWVudChlLnRpbWVzdGFtcCkuZm9ybWF0KHIudGltZXN0YW1wRm9ybWF0KStlLnRleHQpKS5qb2luKCJcbiIpKyh0fHwwPT09ZS5sZW5ndGg/IiI6IlxuIikpOjAhPT1yLnRpbWVzdGFtcD9wKGUubWFwKChlPT5uZXcgRGF0ZShlLnRpbWVzdGFtcCkudG9JU09TdHJpbmcoKStlLnRleHQpKS5qb2luKCJcbiIpKyh0fHwwPT09ZS5sZW5ndGg/IiI6IlxuIikpOnAoZS5tYXAoKGU9PmUudGV4dCkpLmpvaW4oIlxuIikrKHR8fDA9PT1lLmxlbmd0aD8iIjoiXG4iKSkpLDQmfnIud2hhdHx8KDI9PT1yLnRpbWVzdGFtcD9wKGUubWFwKChlPT4iG1stNzstOG0iK21vbWVudChlLnRpbWVzdGFtcCkuZm9ybWF0KHIudGltZXN0YW1wRm9ybWF0KSsiG1swbSIrZS5yYXcpKS5qb2luKCIiKSk6MCE9PXIudGltZXN0YW1wP3AoZS5tYXAoKGU9PiIbWy03Oy04bSIrbmV3IERhdGUoZS50aW1lc3RhbXApLnRvSVNPU3RyaW5nKCkrIhtbMG0iK2UucmF3KSkuam9pbigiIikpOmsoZS5tYXAoKGU9PmUucmF3KSkuam9pbigiIikpKSkscG9zdE1lc3NhZ2Uoe2V2ZW50OiJzdGFydGVkIixhcmdzOmZ9KSk6ZiYmeSgpfWZ1bmN0aW9uIHkoKXtmPSExLHBvc3RNZXNzYWdlKHtldmVudDoic3RvcHBlZCIsYXJnczpmfSl9ZnVuY3Rpb24gJChlKXtyZXR1cm4gZSYmMCE9PWUubGVuZ3RoP2UucmVwbGFjZSgvWyxdL2csIi0iKS5yZXBsYWNlKC9bXChcKVxzO10vZywiIik6bnVsbH1mdW5jdGlvbiBNKGUpe2NvbnN0IGE9W107bGV0IHQscz0wO2NvbnN0IG49ZS50ZXh0LGY9ZS5mb3JtYXRzLGM9Zi5sZW5ndGg7bGV0IGc9ITE7Y29uc3QgZD1bXTtpZigwIT09ci50aW1lc3RhbXApe3Q9W107bGV0IGU9SSgtOCk7bFskKGUpXT90LnB1c2goIiBiIixsWyQoZSldKToobFskKGUpXT1iLHQucHVzaCgiIGIiLGIpLGQucHVzaChgLmIke2J9IHsgYmFja2dyb3VuZC1jb2xvcjogJHtlfTsgfWApLGIrKyksZT1JKC03KSxpWyQoZSldP3QucHVzaCgiIGMiLGlbJChlKV0pOihpWyQoZSldPW8sdC5wdXNoKCIgYyIsbyksZC5wdXNoKGAuYyR7b30geyBjb2xvcjogJHtlfTsgfWApLG8rKyl9Mj09PXIudGltZXN0YW1wJiZtb21lbnQ/YS5wdXNoKCc8c3BhbiBjbGFzcz0idGltZXN0YW1wJywuLi50LCciJywuLi50LCI+Iixtb21lbnQoZS50aW1lc3RhbXApLmZvcm1hdChyLnRpbWVzdGFtcEZvcm1hdCksIjwvc3Bhbj4iKTowIT09ci50aW1lc3RhbXAmJmEucHVzaCgnPHNwYW4gY2xhc3M9InRpbWVzdGFtcCcsLi4udCwnIicsLi4udCwiPiIsbmV3IERhdGUoZS50aW1lc3RhbXApLnRvSVNPU3RyaW5nKCksIiA8L3NwYW4+IiksdD1udWxsO2ZvcihsZXQgZT0wO2U8YztlKyspe2NvbnN0IHI9ZltlXTtsZXQgdSxtLHA7aWYoZTxjLTEpe2lmKHU9ZltlKzFdLHIub2Zmc2V0PT09dS5vZmZzZXQmJnUuZm9ybWF0VHlwZT09PXIuZm9ybWF0VHlwZSljb250aW51ZTttPXUub2Zmc2V0fWVsc2UgbT1uLmxlbmd0aDtpZihzPXIub2Zmc2V0LDA9PT1yLmZvcm1hdFR5cGUpdD1bXSxwPXIuYmFja2dyb3VuZCwibnVtYmVyIj09dHlwZW9mIHAmJihwPUkocCkpLGxbJChwKV0/dC5wdXNoKCIgYiIsbFskKHApXSk6cCYmKGxbJChwKV09Yix0LnB1c2goIiBiIixiKSxkLnB1c2goYC5iJHtifSB7IGJhY2tncm91bmQtY29sb3I6ICR7cH07IH1gKSxiKyspLHA9ci5jb2xvciwibnVtYmVyIj09dHlwZW9mIHAmJihwPUkocCkpLGlbJChwKV0/dC5wdXNoKCIgYyIsaVskKHApXSk6cCYmKGlbJChwKV09byx0LnB1c2goIiBjIixvKSxkLnB1c2goYC5jJHtvfSB7IGNvbG9yOiAke3B9OyB9YCksbysrKSxpWyQoci5mb250KV0/dC5wdXNoKCIgZiIsaVskKHIuZm9udCldKTpyLmZvbnQmJihpWyQoci5mb250KV09byx0LnB1c2goIiBmIixvKSxkLnB1c2goYC5mJHtvfSB7IGZvbnQtZmFtaWx5OiAke3IuZm9udH07IH1gKSxvKyspLGlbJChyLnNpemUpXT90LnB1c2goIiBmIixpWyQoci5zaXplKV0pOnIuc2l6ZSYmKGlbJChyLnNpemUpXT1vLHQucHVzaCgiIGYiLG8pLGQucHVzaChgLmYke299IHsgZm9udC1zaXplOiAke3Iuc2l6ZX07IH1gKSxvKyspLDAhPT1yLnN0eWxlPygxJn5yLnN0eWxlfHx0LnB1c2goIiBiIiksNCZ+ci5zdHlsZXx8dC5wdXNoKCIgaSIpLDEwMjQmfnIuc3R5bGV8fHQucHVzaCgiIG8iKSw1MTImfnIuc3R5bGUmJjgmfnIuc3R5bGV8fHQucHVzaCgiIHUiKSxwPTUxMiZ+ci5zdHlsZT9yLmJhY2tncm91bmQ6ci5jb2xvciwibnVtYmVyIj09dHlwZW9mIHAmJihwPUkocCkpLGlbImJiIiskKHApXT90LnB1c2goIiBiYiIsaVsiYmIiKyQocCldKTpwJiYoaVsiYmIiKyQocCldPW8sdC5wdXNoKCIgYmIiLG8pLGQucHVzaChgLmJiJHtvfSB7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAke3B9OyB9YCksbysrKSwzMiZ+ci5zdHlsZSYmMTYmfnIuc3R5bGV8fCh0aGlzLmVuYWJsZUZsYXNoaW5nP3QucHVzaCgiIGFuc2ktYmxpbmsiKTo1MTImfnIuc3R5bGUmJjgmfnIuc3R5bGUmJnQucHVzaCgiIHUiKSksMjU2Jn5yLnN0eWxlfHx0LnB1c2goIiBzIikpOihwPXIuYmFja2dyb3VuZCwibnVtYmVyIj09dHlwZW9mIHAmJihwPUkocCkpLGlbImJiIiskKHApXT90LnB1c2goIiBiYiIsaVsiYmIiKyQocCldKTpwJiYoaVsiYmIiKyQocCldPW8sdC5wdXNoKCIgYmIiLG8pLGQucHVzaChgLmJiJHtvfSB7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAke3B9OyB9YCksbysrKSksdD0wIT09dC5sZW5ndGg/JyBjbGFzcz0iJyt0LmpvaW4oIiIpLnRyaW0oKSsnIic6IiIsci5ocj9hLnB1c2goJzxzcGFuIHN0eWxlPSJtaW4td2lkdGg6MTAwJTt3aWR0aDoxMDAlOyInLHQsJz48ZGl2IHN0eWxlPSJwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6IDUwJTt0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7aGVpZ2h0OjRweDt3aWR0aDoxMDAlOyBiYWNrZ3JvdW5kLWNvbG9yOicsIm51bWJlciI9PXR5cGVvZiByLmNvbG9yP0koci5jb2xvcik6ci5jb2xvciwnIj48L2Rpdj48L3NwYW4+Jyk6bS1zIT0wJiZhLnB1c2goIjxzcGFuIiwuLi50LCI+IixxKG4uc3Vic3RyaW5nKHMsbSkpLCI8L3NwYW4+Iik7ZWxzZSBpZigxPT09ci5mb3JtYXRUeXBlKXtpZihhLnB1c2goJzxhIGRyYWdnYWJsZT0iZmFsc2UiIGNsYXNzPSJVUkxMaW5rIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7IiB0aXRsZT0iJyksYS5wdXNoKHIuaHJlZi5yZXBsYWNlKC8iL2csIiZxdW90OyIpKSxhLnB1c2goJyIgb25jbGljaz0iJyx0aGlzLmxpbmtGdW5jdGlvbiwiKCciLHIuaHJlZi5yZXBsYWNlKC9cXC9nLCJcXFxcIikucmVwbGFjZSgvIi9nLCImcXVvdDsiKSwiJyk7cmV0dXJuIGZhbHNlO1wiPiIpLG0tcz09MCljb250aW51ZTthLnB1c2goIjxzcGFuIiwuLi50LCI+IiksYS5wdXNoKHEobi5zdWJzdHJpbmcocyxtKSkpLGEucHVzaCgiPC9zcGFuPiIpfWVsc2UgaWYoMj09PXIuZm9ybWF0VHlwZXx8ND09PXIuZm9ybWF0VHlwZXx8OD09PXIuZm9ybWF0VHlwZSlhLnB1c2goIjwvYT4iKTtlbHNlIGlmKDM9PT1yLmZvcm1hdFR5cGUpe2lmKGEucHVzaCgnPGEgZHJhZ2dhYmxlPSJmYWxzZSIgY2xhc3M9Ik1YUExpbmsiIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiIHRpdGxlPSInKSxhLnB1c2goci5ocmVmLnJlcGxhY2UoLyIvZywiJnF1b3Q7IikpLGEucHVzaCgnIicpLHIuZXhwaXJlJiZyLmV4cGlyZS5sZW5ndGgmJmEucHVzaChgIGRhdGEtZXhwaXJlPSIke3IuZXhwaXJlfSJgKSxhLnB1c2goJyBvbmNsaWNrPSInLHRoaXMubXhwTGlua0Z1bmN0aW9uLCIodGhpcywgJyIsci5ocmVmLnJlcGxhY2UoL1xcL2csIlxcXFwiKS5yZXBsYWNlKC8iL2csIiZxdW90OyIpLCInKTtyZXR1cm4gZmFsc2U7XCI+IiksbS1zPT0wKWNvbnRpbnVlO2EucHVzaCgiPHNwYW4iLC4uLnQsIj4iKSxhLnB1c2gocShuLnN1YnN0cmluZyhzLG0pKSksYS5wdXNoKCI8L3NwYW4+Iil9ZWxzZSBpZig3PT09ci5mb3JtYXRUeXBlKXtpZihhLnB1c2goJzxhIGRyYWdnYWJsZT0iZmFsc2UiIGNsYXNzPSJNWFBMaW5rIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7IiB0aXRsZT0iJyksYS5wdXNoKHIuaGludC5yZXBsYWNlKC8iL2csIiZxdW90OyIpKSxhLnB1c2goJyInKSxyLmV4cGlyZSYmci5leHBpcmUubGVuZ3RoJiZhLnB1c2goYCBkYXRhLWV4cGlyZT0iJHtyLmV4cGlyZX0iYCksYS5wdXNoKCcgb25tb3VzZW92ZXI9IicsdGhpcy5teHBUb29sdGlwRnVuY3Rpb24sJyh0aGlzKTsiJyksYS5wdXNoKCcgb25jbGljaz0iJyx0aGlzLm14cFNlbmRGdW5jdGlvbiwiKGV2ZW50fHx3aW5kb3cuZXZlbnQsIHRoaXMsICIsci5ocmVmLnJlcGxhY2UoL1xcL2csIlxcXFwiKS5yZXBsYWNlKC8iL2csIiZxdW90OyIpLCIsICIsci5wcm9tcHQ/IjEiOiIwIiwiLCAiLHIudHQucmVwbGFjZSgvXFwvZywiXFxcXCIpLnJlcGxhY2UoLyIvZywiJnF1b3Q7IiksJyk7cmV0dXJuIGZhbHNlOyI+JyksbS1zPT0wKWNvbnRpbnVlO2EucHVzaCgiPHNwYW4iLC4uLnQsIj4iKSxhLnB1c2gocShuLnN1YnN0cmluZyhzLG0pKSksYS5wdXNoKCI8L3NwYW4+Iil9ZWxzZSBpZig5PT09ci5mb3JtYXRUeXBlJiZtLXMhPTApYS5wdXNoKCI8c3BhbiIsLi4udCwiPiIpLGEucHVzaChxKG4uc3Vic3RyaW5nKHMsbSkpKSxhLnB1c2goIjwvc3Bhbj4iKTtlbHNlIGlmKDU9PT1yLmZvcm1hdFR5cGUpe2xldCBlPSIiO3N3aXRjaChhLnB1c2goJzxpbWcgc3JjPSInKSxyLnVybC5sZW5ndGg+MCYmKGEucHVzaChyLnVybCksZSs9ci51cmwsci51cmwuZW5kc1dpdGgoIi8iKXx8KGEucHVzaCgiLyIpLGUrPSIvIikpLHIudC5sZW5ndGg+MCYmKGEucHVzaChyLnQpLGUrPXIudCxyLnQuZW5kc1dpdGgoIi8iKXx8KGEucHVzaCgiLyIpLGUrPSIvIikpLGUrPXIubmFtZSxhLnB1c2goci5uYW1lLCciICBzdHlsZT0iJyksci53Lmxlbmd0aD4wJiZhLnB1c2goIndpZHRoOiIseChyLncpLCI7Iiksci5oLmxlbmd0aD4wJiZhLnB1c2goImhlaWdodDoiLHgoci5oKSwiOyIpLHIuYWxpZ24udG9Mb3dlckNhc2UoKSl7Y2FzZSJsZWZ0IjphLnB1c2goImZsb2F0OmxlZnQ7Iik7YnJlYWs7Y2FzZSJyaWdodCI6YS5wdXNoKCJmbG9hdDpyaWdodDsiKSxnPSEwO2JyZWFrO2Nhc2UidG9wIjpjYXNlIm1pZGRsZSI6Y2FzZSJib3R0b20iOmEucHVzaCgidmVydGljYWwtYWxpZ246IixyLmFsaWduLCI7Iil9ci5oc3BhY2UubGVuZ3RoPjAmJnIudnNwYWNlLmxlbmd0aD4wPyhhLnB1c2goIm1hcmdpbjoiKSxhLnB1c2goeChyLnZzcGFjZSksIiAiKSxhLnB1c2goeChyLmhzcGFjZSksIjsiKSk6ci5oc3BhY2UubGVuZ3RoPjA/KGEucHVzaCgibWFyZ2luOiIpLGEucHVzaCgiMHB4ICIseChyLmhzcGFjZSksIjsiKSk6ci52c3BhY2UubGVuZ3RoPjAmJihhLnB1c2goIm1hcmdpbjoiKSxhLnB1c2goeChyLnZzcGFjZSksIiAwcHg7IikpLGEucHVzaCgnIicpLHIuaXNtYXAmJmEucHVzaCgnIGlzbWFwIG9uY2xpY2s9InJldHVybiBmYWxzZTsiJyksYS5wdXNoKGBzcmM9IiR7ZX0iLz5gKX19cmV0dXJuIGQubGVuZ3RoJiZhLnB1c2goIjxzdHlsZT4iLC4uLmQsIjwvc3R5bGU+IiksZz9gPHNwYW4gY2xhc3M9ImxpbmUiIHN0eWxlPSJtaW4td2lkdGg6MTAwJSI+JHthLmpvaW4oIiIpfTxicj48L3NwYW4+YDpgPHNwYW4gY2xhc3M9ImxpbmUiPiR7YS5qb2luKCIiKX08YnI+PC9zcGFuPmB9ZnVuY3Rpb24gcShlKXtpZihlJiYwIT09ZS5sZW5ndGgpcmV0dXJuIGUucmVwbGFjZSgvJi9nLCImYW1wOyIpLnJlcGxhY2UoLyIvZywiJnF1b3Q7IikucmVwbGFjZSgvJy9nLCImIzM5OyIpLnJlcGxhY2UoLzwvZywiJmx0OyIpLnJlcGxhY2UoLz4vZywiJmd0OyIpfWZ1bmN0aW9uIHgoZSl7cmV0dXJuIGU/L15cZCtjJC8udGVzdChlKT9lKyJoIjovXlxkKyQvLnRlc3QoZSk/cGFyc2VJbnQoZSwxMCkrInB4IjplOmV9ZnVuY3Rpb24gRCgpe2NvbnN0IGU9W107bGV0IGEsdCxyLHM7Zm9yKGE9MDthPDY7YSsrKWZvcih0PTA7dDw2O3QrKylmb3Iocj0wO3I8NjtyKyspcz0xNiszNiphKzYqdCtyLGVbc109InJnYigiLGVbc10rPWE+MD80MCphKzU1OiIwIixlW3NdKz0iLCIsZVtzXSs9dD4wPzQwKnQrNTU6IjAiLGVbc10rPSIsIixlW3NdKz1yPjA/NDAqcis1NToiMCIsZVtzXSs9IikiO2ZvcihhPTIzMjthPD0yNTU7YSsrKXQ9MTAqKGEtMjMyKSs4LGVbYV09WyJyZ2IoIix0LCIsIix0LCIsIix0LCIpIl0uam9pbigiIik7ZVswXT0icmdiKDAsMCwwKSIsZVsxXT0icmdiKDEyOCwgMCwgMCkiLGVbMl09InJnYigwLCAxMjgsIDApIixlWzNdPSJyZ2IoMTI4LCAxMjgsIDApIixlWzRdPSJyZ2IoMCwgMCwgMjM4KSIsZVs1XT0icmdiKDEyOCwgMCwgMTI4KSIsZVs2XT0icmdiKDAsIDEyOCwgMTI4KSIsZVs3XT0icmdiKDE4NywgMTg3LCAxODcpIixlWzhdPSJyZ2IoMTI4LCAxMjgsIDEyOCkiLGVbOV09InJnYigyNTUsIDAsIDApIixlWzEwXT0icmdiKDAsIDI1NSwgMCkiLGVbMTFdPSJyZ2IoMjU1LCAyNTUsIDApIixlWzEyXT0icmdiKDkyLCA5MiwgMjU1KSIsZVsxM109InJnYigyNTUsIDAsIDI1NSkiLGVbMTRdPSJyZ2IoMCwgMjU1LCAyNTUpIixlWzE1XT0icmdiKDI1NSwgMjU1LCAyNTUpIixlWzI1Nl09InJnYigwLCAwLCAwKSIsZVsyNTddPSJyZ2IoMTE4LCAwLCAwKSIsZVsyNThdPSJyZ2IoMCwgMTA4LCAwKSIsZVsyNTldPSJyZ2IoMTQ1LCAxMzYsIDApIixlWzI2MF09InJnYigwLCAwLCAxNjcpIixlWzI2MV09InJnYigxMDgsIDAsIDEwOCkiLGVbMjYyXT0icmdiKDAsIDEwOCwgMTA4KSIsZVsyNjNdPSJyZ2IoMTYxLCAxNjEsIDE2MSkiLGVbMjY0XT0icmdiKDAsIDAsIDApIixlWzI2NV09InJnYigxMjgsIDAsIDApIixlWzI2Nl09InJnYigwLCAxMjgsIDApIixlWzI2N109InJnYigxMjgsIDEyOCwgMCkiLGVbMjY4XT0icmdiKDAsIDAsIDIzOCkiLGVbMjY5XT0icmdiKDEyOCwgMCwgMTI4KSIsZVsyNzBdPSJyZ2IoMCwgMTI4LCAxMjgpIixlWzI3MV09InJnYigxODcsIDE4NywgMTg3KSIsZVsyNzJdPSJyZ2IoMCwwLDApIixlWzI3M109InJnYigwLCAyNTUsIDI1NSkiLGVbMjc0XT0icmdiKDAsMCwwKSIsZVsyNzVdPSJyZ2IoMjU1LCAyNTUsIDApIixlWzI3Nl09InJnYigwLCAwLCAwKSIsZVsyNzddPSJyZ2IoMjI5LCAyMjksIDIyOSkiLGVbMjc4XT0icmdiKDIwNSwgMCwgMCkiLGVbMjc5XT0icmdiKDIyOSwgMjI5LCAyMjkpIixlWzI4MF09InJnYigyNTUsMjU1LDI1NSkiLGQ9ZX1mdW5jdGlvbiBJKGUpe3N3aXRjaChudWxsPT1kJiZEKCksZSl7Y2FzZS0xMjpyZXR1cm4gZFsyNzldO2Nhc2UtMTE6cmV0dXJuIGRbMjc4XTtjYXNlLTEwOnJldHVybiBkWzI4MF07Y2FzZS04OnJldHVybiBkWzI3Ml07Y2FzZS03OnJldHVybiBkWzI3M107Y2FzZS00OnJldHVybiBkWzI3NF07Y2FzZS0zOnJldHVybiBkWzI3NV07Y2FzZSA0OTpjYXNlLTI6cmV0dXJuIGRbMjc2XTtjYXNlIDM5OmNhc2UtMTpyZXR1cm4gZFsyNzddO2Nhc2UgMDpjYXNlIDMwOnJldHVybiBkWzBdO2Nhc2UgMTpjYXNlIDMxOnJldHVybiBkWzFdO2Nhc2UgMjpjYXNlIDMyOnJldHVybiBkWzJdO2Nhc2UgMzpjYXNlIDMzOnJldHVybiBkWzNdO2Nhc2UgNDpjYXNlIDM0OnJldHVybiBkWzRdO2Nhc2UgNTpjYXNlIDM1OnJldHVybiBkWzVdO2Nhc2UgNjpjYXNlIDM2OnJldHVybiBkWzZdO2Nhc2UgNzpjYXNlIDM3OnJldHVybiBkWzddO2Nhc2UgNDA6cmV0dXJuIGRbMjY0XTtjYXNlIDQxOnJldHVybiBkWzI2NV07Y2FzZSA0MjpyZXR1cm4gZFsyNjZdO2Nhc2UgNDM6cmV0dXJuIGRbMjY3XTtjYXNlIDQ0OnJldHVybiBkWzI2OF07Y2FzZSA0NTpyZXR1cm4gZFsyNjldO2Nhc2UgNDY6cmV0dXJuIGRbMjcwXTtjYXNlIDQ3OnJldHVybiBkWzI3MV07Y2FzZSA4OmNhc2UgOTA6Y2FzZSAxMDA6Y2FzZSAzMDA6Y2FzZSA0MDA6cmV0dXJuIGRbOF07Y2FzZSA5OmNhc2UgOTE6Y2FzZSAxMDE6Y2FzZSAzMTA6Y2FzZSA0MTA6cmV0dXJuIGRbOV07Y2FzZSAxMDpjYXNlIDkyOmNhc2UgMTAyOmNhc2UgMzIwOmNhc2UgNDIwOnJldHVybiBkWzEwXTtjYXNlIDExOmNhc2UgOTM6Y2FzZSAxMDM6Y2FzZSAzMzA6Y2FzZSA0MzA6cmV0dXJuIGRbMTFdO2Nhc2UgMTI6Y2FzZSA5NDpjYXNlIDEwNDpjYXNlIDM0MDpjYXNlIDQ0MDpyZXR1cm4gZFsxMl07Y2FzZSAxMzpjYXNlIDk1OmNhc2UgMTA1OmNhc2UgMzUwOmNhc2UgNDUwOnJldHVybiBkWzEzXTtjYXNlIDE0OmNhc2UgOTY6Y2FzZSAxMDY6Y2FzZSAzNjA6Y2FzZSA0NjA6cmV0dXJuIGRbMTRdO2Nhc2UgMTU6Y2FzZSA5NzpjYXNlIDEwNzpjYXNlIDM3MDpjYXNlIDQ3MDpyZXR1cm4gZFsxNV07Y2FzZSA0ZTM6Y2FzZSAzZTM6cmV0dXJuIGRbMjU2XTtjYXNlIDQxMDA6Y2FzZSAzMTAwOnJldHVybiBkWzI1N107Y2FzZSA0MjAwOmNhc2UgMzIwMDpyZXR1cm4gZFsyNThdO2Nhc2UgNDMwMDpjYXNlIDMzMDA6cmV0dXJuIGRbMjU5XTtjYXNlIDQ0MDA6Y2FzZSAzNDAwOnJldHVybiBkWzI2MF07Y2FzZSA0NTAwOmNhc2UgMzUwMDpyZXR1cm4gZFsyNjFdO2Nhc2UgNDYwMDpjYXNlIDM2MDA6cmV0dXJuIGRbMjYyXTtjYXNlIDQ3MDA6Y2FzZSAzNzAwOnJldHVybiBkWzI2M107ZGVmYXVsdDpyZXR1cm4gZTw9LTE2JiYoZSs9MTYsZSo9LTEpLGU+PTAmJmU8MjgxP2RbZV06ZFsyNzddfX1mdW5jdGlvbiBZKGEsdCl7bnVsbD09ZCYmRCgpLGE8MHx8YT49ZC5sZW5ndGh8fCh0PW5ldyBlKHQpKS5vayYmKGRbYV09dC50b1JHQigpKX1zZWxmLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLChlPT57bGV0IGk7aWYoZS5kYXRhKXN3aXRjaChlLmRhdGEuYWN0aW9uKXtjYXNlIm9wdGlvbnMiOmxldCBvLGw9ci5lbmFibGVkO2ZvcihvIGluIGUuZGF0YS5hcmdzKWlmKGUuZGF0YS5hcmdzLmhhc093blByb3BlcnR5KG8pKWlmKCJjb2xvcnMiIT09bylpZih0JiYid2hhdCI9PT1vJiZyW29dIT09ZS5kYXRhLmFyZ3Nbb10pe2lmKGk9MCwhKDEmfnJbb10pJiYxJn5lLmRhdGEuYXJnc1tvXSYmKGl8PTEpLCEoMiZ+cltvXSkmJjImfmUuZGF0YS5hcmdzW29dJiYoaXw9MiksISg0Jn5yW29dKSYmNCZ+ZS5kYXRhLmFyZ3Nbb10mJihpfD00KSwwIT09aSl7Y29uc3QgZT10O3Qud2hhdD1pLHcoITApLGUud2hhdD1yW29dLHQ9ZX1yW29dPWUuZGF0YS5hcmdzW29dfWVsc2UgcltvXT1lLmRhdGEuYXJnc1tvXTtlbHNle2NvbnN0IGE9ZS5kYXRhLmFyZ3Nbb107aWYoYSYmYS5sZW5ndGg+MCl7bGV0IGU7Y29uc3QgdD1hLmxlbmd0aDtmb3IoZT0wO2U8dDtlKyspYVtlXSYmMCE9PWFbZV0ubGVuZ3RoJiZZKGUsYVtlXSl9fSJib29sZWFuIj09dHlwZW9mIHIudGltZXN0YW1wJiYoci50aW1lc3RhbXA9ci50aW1lc3RhbXA/MjowKSwwIT09YSYmKG49bmV3IG1vbWVudChhKS5mb3JtYXQoci5mb3JtYXR8fCJZWVlZTU1ERC1ISG1tc3MiKSx1KCksdyghMCkpLGwhPXIuZW5hYmxlZD9sfHxmP2wmJmY/eSgpOnIub2ZmbGluZSYmcG9zdE1lc3NhZ2Uoe2V2ZW50OiJzdGFydCJ9KTpwb3N0TWVzc2FnZSh7ZXZlbnQ6InN0YXJ0In0pOnIub2ZmbGluZSYmcG9zdE1lc3NhZ2Uoe2V2ZW50OiJzdGFydCJ9KTticmVhaztjYXNlIm5hbWUiOnIubmFtZT1lLmRhdGEuYXJncyxmJiZmdW5jdGlvbigpe2NvbnN0IGU9YztpZih1KCksZT09PWMpcmV0dXJuO3Bvc3RNZXNzYWdlKHtldmVudDoiZGVidWciLGFyZ3M6J0ZpbGUgY2hhbmdlZDogIicrZSsnIiB0byAiJytjKyciJ30pLHQmJnQuY3VycmVudEZpbGUhPT1lP3coITApOnQmJih0LmN1cnJlbnRGaWxlPWMpfSgpO2JyZWFrO2Nhc2UiY29ubmVjdGVkIjpzPWUuZGF0YS5hcmdzLHUoKTticmVhaztjYXNlImxvZ2dpbmciOnBvc3RNZXNzYWdlKHtldmVudDoibG9nZ2luZyIsYXJnczpmfSk7YnJlYWs7Y2FzZSJ0b2dnbGUiOiFmdW5jdGlvbigpe3IuZW5hYmxlZD0hci5lbmFibGVkLHBvc3RNZXNzYWdlKHtldmVudDoidG9nZ2xlZCIsYXJnczpyLmVuYWJsZWR9KTtjb25zdCBlPXIudW5pcXVlO3IudW5pcXVlPSExLHIuZW5hYmxlZCYmIWY/cG9zdE1lc3NhZ2Uoe2V2ZW50OiJzdGFydEludGVybmFsIn0pOiFyLmVuYWJsZWQmJmYmJnkoKTtyLnVuaXF1ZT1lfSgpO2JyZWFrO2Nhc2Uic3RvcCI6eSgpO2JyZWFrO2Nhc2Uic3RhcnRJbnRlcm5hbCI6aT1yLnVuaXF1ZSxyLnVuaXF1ZT0hMSxlLmRhdGEuYXJncz92KGUuZGF0YS5hcmdzLmxpbmVzLGUuZGF0YS5hcmdzLmZyYWdtZW50KTp2KFtdLCExKSxyLnVuaXF1ZT1pO2JyZWFrO2Nhc2Uic3RhcnQiOmUuZGF0YS5hcmdzP3YoZS5kYXRhLmFyZ3MubGluZXMsZS5kYXRhLmFyZ3MuZnJhZ21lbnQpOnYoW10sITEpO2JyZWFrO2Nhc2UiZmx1c2giOncoZS5kYXRhLmFyZ3MpO2JyZWFrO2Nhc2UiYWRkLWxpbmUiOmNvbnN0IGI9ZS5kYXRhLmFyZ3M7aWYoYi5mcmFnbWVudClyZXR1cm4odD1iKS5sb2dnaW5nPWYsdC5maWxlPWMsdC5jb25uZWN0ZWQ9cyx0Lm9mZmxpbmU9ci5vZmZsaW5lLHQud2hhdD1yLndoYXQsdm9pZCh0LmdhZ2dlZD1iLmdhZ2dlZHx8ci5nYWdnZWQmJmIuZ2FnZ2VkKTtpZih0PW51bGwsIWZ8fCFyLm9mZmxpbmUmJiFzKXJldHVybjtpZihiLmdhZ2dlZCYmIXIuZ2FnZ2VkKXJldHVybjsxJn5yLndoYXR8fGgoTSh7dGV4dDpiLmxpbmUsZm9ybWF0czpiLmZvcm1hdHMsdGltZXN0YW1wOmIudGltZXN0YW1wfHxEYXRlLm5vdygpfSkpLDImfnIud2hhdCYmMCE9PXIud2hhdHx8KDI9PT1yLnRpbWVzdGFtcD9wKG1vbWVudChiLnRpbWVzdGFtcCkuZm9ybWF0KHIudGltZXN0YW1wRm9ybWF0KSk6MCE9PXIudGltZXN0YW1wJiZwKG5ldyBEYXRlKGIudGltZXN0YW1wKS50b0lTT1N0cmluZygpKSxwKGIubGluZSsiXG4iKSksNCZ+ci53aGF0fHwoMj09PXIudGltZXN0YW1wP3AoIhtbLTc7LThtIittb21lbnQoYi50aW1lc3RhbXApLmZvcm1hdChyLnRpbWVzdGFtcEZvcm1hdCkrIhtbMG0iKTowIT09ci50aW1lc3RhbXAmJnAoIhtbLTc7LThtIituZXcgRGF0ZShiLnRpbWVzdGFtcCkudG9JU09TdHJpbmcoKSsiG1swbSIpLGsoYi5yYXcpKTticmVhaztjYXNlIndyaXRlLWRvbmUiOmlmKCFnW2UuZGF0YS5maWxlXSlyZXR1cm47aWYoZ1tlLmRhdGEuZmlsZV0uc2hpZnQoKSxnW2UuZGF0YS5maWxlXS5sZW5ndGgpe2NvbnN0IGE9Z1tlLmRhdGEuZmlsZV0uc2hpZnQoKTttKGEuZmlsZSxhLmRhdGEsITApfWVsc2UgZGVsZXRlIGdbZS5kYXRhLmZpbGVdfX0pLCExKX0pKCk7\";", "<style>body{font-family:'Courier New',Courier,monospace;text-align:left;font-size:1em;white-space:pre;background-color:#000}@-webkit-keyframes blinker{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes blinker{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.animate .ansi-blink{text-decoration:blink;animation-name:blinker;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(1,0,0,1);animation-duration:1s;-webkit-animation-name:blinker;-webkit-animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(1,0,0,1);-webkit-animation-duration:1s}.line>span{padding:0;margin:0;display:inline-block;cursor:text;padding-bottom:1px}.ansi{padding:0;margin:0;display:inline-block;padding-bottom:1px;cursor:text;line-height:normal}.line{word-wrap:break-word;word-break:break-all;min-width:100%;display:block;clear:both;line-height:normal}.line hr{border:0}.line a,.line a:link,.line a:link span{color:inherit;font-weight:inherit;text-decoration:underline}.URLLink,.URLLink:link,.URLLink:link span{text-decoration:underline;cursor:pointer}a.MXPLink:link,a.MXPLink:link span{font-weight:400;color:inherit;text-decoration:underline}a.MXPLink:visited,a.MXPLink:visited span{text-decoration:underline}a.MXPLink:active,a.MXPLink:active span{text-decoration:underline}a.MXPLink:hover,a.MXPLink:hover span{text-decoration:underline}.line .b{font-weight:700}.line .i{font-style:italic}.line .o{text-decoration:overline}.line .u{text-decoration:underline}.line .du{text-decoration:underline;border-bottom:1px solid currentColor;padding-bottom:1px}.line .s{text-decoration:line-through}.line .o.du{text-decoration:underline overline}.line .u.o{text-decoration:underline overline}.line .o.s{text-decoration:overline line-through}.line .du.s{text-decoration:underline line-through}.line .s.u{text-decoration:underline line-through}.line .du.u.o{text-decoration:underline overline}.line .du.s.u{text-decoration:underline line-through}.line .du.o.s{text-decoration:underline overline line-through}.line .u.s.o{text-decoration:underline overline line-through}.line .du.o.s.u{text-decoration:underline overline line-through}</style><script type=\"text/javascript\">function doLink(url) {\n        if (confirm('Open \\'' + url + '\\'?') === true)\n            window.open(encodeURI(url), '_blank');\n    }\n\n    // eslint-disable-next-line no-unused-vars\n    function doMXPLink(el, url) {\n        if (url.startsWith('OoMUD://') || url.startsWith('jiMUD://') || url.startsWith('client://'))\n            doMXPSend(0, el, url.substring(8));\n        else if (confirm('Open \\'' + url + '\\'?') === true)\n            window.open(encodeURI(url.replace('&text;', el.textContent || '')), '_blank');\n    }\n\n    function doMXPSend(e, el, url, pmt, tt) {\n        let im = el.querySelector('img[ismap]');\n        let extra = '';\n        if (im && im.length > 0) {\n            let offset = im.offset();\n            let x = Math.floor(e.clientX - offset.left);\n            let y = Math.floor(e.clientY - offset.top);\n            extra = '?' + x + ',' + y;\n        }\n\n        if (url.constructor === Array || url.__proto__.constructor === Array || Object.prototype.toString.call(url) === '[object Array]') {\n            alert('MXP Menu not supported');\n        }\n        else {\n            url = url.replace('&text;', el.textContent || '') + extra;\n            if (!pmt)\n                url += '\\n';\n            alert(url);\n            console.log(url);\n        }\n    }\n\n    // eslint-disable-next-line no-unused-vars\n    function doMXPTooltip(el) {\n        el.title = el.title.replace('&test;', el.textContent || '');\n    }</script>", "import '../css/logger.css';\r\nimport { Plugin } from '../core/plugin';\r\nimport { MenuItem, } from '../core/types';\r\nimport { Dialog, DialogButtons } from '../interface/dialog';\r\nimport { Splitter, Orientation, PanelAnchor } from '../interface/splitter';\r\nimport { removeHash, updateHash, closeDropdowns } from '../interface/interface';\r\nimport { capitalize, scrollChildIntoView } from '../core/library';\r\nimport { buildBreadcrumb } from '../interface/breadcrumb';\r\n\r\ndeclare let localforage;\r\ndeclare let confirm_box;\r\ndeclare let fileSaveAs;\r\n\r\n// @ts-ignore\r\nimport workerSrc from 'inline-worker:./logger.worker.ts';\r\n// @ts-ignore\r\nimport logHeader from '../html/log.header.html';\r\n\r\nexport enum Log {\r\n    None = 0,\r\n    Html = 1,\r\n    Text = 2,\r\n    Raw = 4\r\n}\r\n\r\nexport class Logger extends Plugin {\r\n    private _logger;\r\n    private _manager: LogManager\r\n\r\n    public get manager(): LogManager { return this._manager; }\r\n\r\n    public remove(): void {\r\n        this.client.removeListenersFromCaller(this);\r\n    }\r\n    public initialize(): void {\r\n        if (this.client.getOption('logEnabled'))\r\n            this._initializeLogger();\r\n        this.client.on('cleared', () => {\r\n            this._post({ action: 'flush', args: true });\r\n        }, this);\r\n        this.client.on('connecting', () => {\r\n            this._post({ action: 'connected', args: this.client.connected });\r\n            this._post({\r\n                action: 'start', args: {\r\n                    lines: this.client.display.lines,\r\n                    fragment: this.client.display.EndOfLine || this.client.telnet.prompt\r\n                }\r\n            });\r\n        }, this);\r\n        this.client.on('add-line-done', async data => {\r\n            if (this.client.getOption('logEnabled'))\r\n                this._post({ action: 'add-line', args: data });\r\n        }, this);\r\n        this.client.on('set-title', (title, lag) => {\r\n            this._post({ action: 'name', args: $character });\r\n        }, this);\r\n        this.client.on('options-loaded', () => {\r\n            this._updateMenuItem(this.client.getOption('logEnabled'));\r\n            if (this.client.getOption('logEnabled'))\r\n                this._initializeLogger();\r\n            else\r\n                this._loadLoggerOptions();\r\n            if (this._manager)\r\n                this._manager.resetState(client.getWindowState('log-viewer') || { center: true });\r\n        }, this);\r\n        this.client.on('closed', () => {\r\n            this._post({ action: 'connected', args: client.connected });\r\n            this._post({ action: 'stop' });\r\n        }, this);\r\n        this.client.on('reconnect', () => {\r\n            if (this.client.connected) return;\r\n            this._post({ action: 'connected', args: client.connected });\r\n            this._post({ action: 'stop' });\r\n        }, this);\r\n        this.client.on('window', (window, args, name) => {\r\n            let pages = window.split('/');\r\n            if (!pages.length) return;\r\n            switch (pages[0]) {\r\n                case 'log-viewer':\r\n                case 'logs':\r\n                case 'log.viewer':\r\n                    if (args === 'close') {\r\n                        if (this._manager)\r\n                            this._manager.close();\r\n                        removeHash('logs');\r\n                    }\r\n                    else {\r\n                        this._createManager();\r\n                        this._manager.dialog.dataset.path = window;\r\n                        this._manager.setBody(window);\r\n                        this._manager.show();\r\n                        //updateHash('logs');\r\n                    }\r\n                    break;\r\n            }\r\n        });\r\n        this.client.on('close-window', (window) => {\r\n            switch (window) {\r\n                case 'log-viewer':\r\n                case 'logs':\r\n                case 'log.viewer':\r\n                    if (this._manager)\r\n                        this._manager.close();\r\n                    removeHash('logs');\r\n                    break;\r\n            }\r\n        });\r\n        this._post({ action: 'name', args: $character || '' });\r\n        window.addEventListener('beforeunload', () => {\r\n            this._post({ action: 'flush' });\r\n        });\r\n        let options = this.client.getWindowState('log-viewer')\r\n        if (options && options.show) {\r\n            this._createManager();\r\n            updateHash('logs');\r\n        }\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [{\r\n            name: ' Enable logging',\r\n            icon: '<i class=\"bi bi-file-text\"></i>',\r\n            position: '#menu-connect',\r\n            active: this.client.getOption('logEnabled'),\r\n            action: () => {\r\n                if (!client.getOption('logEnabled'))\r\n                    this._initializeLogger();\r\n                this._post({ action: 'toggle' });\r\n            }\r\n        },\r\n        {\r\n            name: 'Manage logs',\r\n            icon: '<i class=\"fas fa-list\"></i>',\r\n            position: '#menu-profiles',\r\n            action: () => {\r\n                this._createManager();\r\n                location.hash = 'logs';\r\n            }\r\n        }];\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' Logging',\r\n            action: 'settings-logging',\r\n            icon: '<i class=\"far fa-file-alt\"></i>',\r\n            position: 'a[href=\"#settings-tabCompletion\"]'\r\n        }]\r\n    }\r\n\r\n    private _createManager() {\r\n        if (this._manager) return;\r\n        this._manager = new LogManager();\r\n        this._manager.on('closed', () => {\r\n            if (this._manager && !this._manager.persistent) {\r\n                delete this._manager;\r\n                this._manager = null;\r\n            }\r\n        });\r\n        this._manager.on('canceled', () => {\r\n            if (this._manager && !this._manager.persistent) {\r\n                delete this._manager;\r\n                this._manager = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    private _post(data) {\r\n        if (!this._logger) return;\r\n        this._logger.postMessage(data);\r\n    }\r\n\r\n    public createLogger() {\r\n        return new Worker(workerSrc);\r\n    }\r\n\r\n    private _initializeLogger() {\r\n        if (this._logger) return;\r\n        this._logger = this.createLogger();\r\n        this._logger.addEventListener('message', e => {\r\n            switch (e.data.event) {\r\n                case 'started':\r\n                    this._updateMenuItem(true);\r\n                    break;\r\n                case 'stopped':\r\n                    this._updateMenuItem(false);\r\n                    this._post({ action: 'flush' });\r\n                    this._logger.terminate();\r\n                    this._logger = null;\r\n                    break;\r\n                case 'logging':\r\n                    break;\r\n                case 'error':\r\n                    this.client.error(e.data.args);\r\n                    break;\r\n                case 'debug':\r\n                    if (!this.client)\r\n                        console.log(e.data.args);\r\n                    else if (this.client.getOption('enableDebug'))\r\n                        this.client.debug(e.data.args);\r\n                    break;\r\n                case 'toggled':\r\n                    if (this.client)\r\n                        this.client.setOption('logEnabled', e.data.args);\r\n                    this._updateMenuItem(e.data.args);\r\n                    if (!e.data.args) {\r\n                        this._post({ action: 'flush' });\r\n                        this._logger.terminate();\r\n                        this._logger = null;\r\n                    }\r\n                    break;\r\n                case 'startInternal':\r\n                case 'start':\r\n                    this._post({ action: e.data.event, args: { lines: this.client.display.lines || [], fragment: this.client.display.EndOfLine || this.client.telnet.prompt } });\r\n                    break;\r\n                case 'write':\r\n                    this.updateKey(e.data);\r\n                    localforage.getItem('OoMUDLog' + e.data.file).then(value => {\r\n                        if (!value) value = '';\r\n                        value += e.data.data;\r\n                        localforage.setItem('OoMUDLog' + e.data.file, value).then(() => {\r\n                            if (this._manager) this._manager.logChanged(e.data.file, e.data.data);\r\n                            this._post({ action: 'write-done', file: e.data.file });\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n        this._logger.addEventListener('error', e => {\r\n            if (!this.client)\r\n                console.error(e);\r\n            else\r\n                this.client.error(e);\r\n        });\r\n        this._loadLoggerOptions();\r\n    }\r\n\r\n    private _keyQueue = [];\r\n    private _keyPromise;\r\n    public updateKey(data) {\r\n        this._keyQueue.push(data);\r\n        if (this._keyPromise) return;\r\n        this._keyPromise = localforage.getItem('OoMUDLogKeys').then(value => {\r\n            if (!this._keyQueue.length) return;\r\n            let _keys;\r\n            if (!value)\r\n                _keys = {};\r\n            else\r\n                _keys = value;\r\n            this._keyQueue.forEach(key => {\r\n                _keys[key.file] = { character: key.character, timeStamp: key.timeStamp, postfix: data.postfix, prefix: data.prefix };\r\n            });\r\n            this._keyQueue = [];\r\n            this._keyPromise = null;\r\n            localforage.setItem('OoMUDLogKeys', _keys);\r\n        });\r\n    }\r\n\r\n    private _loadLoggerOptions() {\r\n        this._post({\r\n            action: 'options', args: {\r\n                offline: this.client.getOption('logOffline'),\r\n                gagged: this.client.getOption('logGagged'),\r\n                enabled: this.client.getOption('logEnabled'),\r\n                unique: this.client.getOption('logUniqueOnConnect'),\r\n                prepend: this.client.getOption('logPrepend'),\r\n                what: this.client.getOption('logWhat'),\r\n                debug: this.client.getOption('enableDebug'),\r\n                format: this.client.getOption('logTimeFormat'),\r\n                colors: this.client.getOption('colors'),\r\n                timestamp: this.client.getOption('logTimestamp'),\r\n                timestampFormat: this.client.getOption('logTimestampFormat')\r\n            }\r\n        });\r\n    }\r\n\r\n    private _updateMenuItem(state) {\r\n        const button = document.querySelector('#menu-enable-logging') as HTMLElement;\r\n        if (state) {\r\n            button.title = 'Disable logging';\r\n            button.classList.add('active');\r\n            document.querySelector('#menu-enable-logging a span').textContent = 'Disable logging';\r\n        }\r\n        else {\r\n            button.title = 'Enable logging';\r\n            button.classList.remove('active');\r\n            document.querySelector('#menu-enable-logging a span').textContent = 'Enable logging';\r\n        }\r\n    }\r\n}\r\n\r\nclass LogManager extends Dialog {\r\n    private _menu;\r\n    private _contents;\r\n    private _splitter;\r\n    private _page = 'logs';\r\n    private _logs;\r\n    private _current;\r\n    private _small: boolean = false;\r\n\r\n    constructor() {\r\n        super(Object.assign({}, client.getWindowState('log-viewer') || { center: true }, { title: '<i class=\"fas fa-list\"></i> Log viewer', minWidth: 410 }));\r\n        this.on('resized', e => {\r\n            this._updateSmall(e.width);\r\n            client.setOption('windows.log-viewer', e);\r\n        });\r\n        this.on('closed', () => {\r\n            client.setOption('windows.log-viewer', this.windowState);\r\n            removeHash(this._page);\r\n        });\r\n        this.on('canceled', () => {\r\n            client.setOption('windows.log-viewer', this.windowState);\r\n            removeHash(this._page);\r\n        });\r\n        this.on('moved', e => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            client.setOption('windows.log-viewer', e);\r\n        })\r\n        this.on('maximized', () => {\r\n            client.setOption('windows.log-viewer', this.windowState);\r\n        });\r\n        this.on('restored', () => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            client.setOption('windows.log-viewer', this.windowState);\r\n        });\r\n        this.on('shown', () => {\r\n            this._updateSmall(this.dialog.offsetWidth || this.dialog.clientWidth);\r\n            client.setOption('windows.log-viewer', this.windowState);\r\n        });\r\n        this.body.style.padding = '10px';\r\n        this._splitter = new Splitter({ id: 'log-viewer', parent: this.body, orientation: Orientation.vertical, anchor: PanelAnchor.panel1 });\r\n        if (client.getOption('logger.split') >= 200)\r\n            this._splitter.SplitterDistance = client.getOption('logger.split');\r\n        this._splitter.on('splitter-moved', distance => {\r\n            client.setOption('logger.split', distance);\r\n        });\r\n        this._menu = this._splitter.panel1;\r\n        this._menu.style.overflow = 'hidden';\r\n        this._menu.style.overflowY = 'auto';\r\n        this._contents = document.createElement('iframe');\r\n        this._contents.src = 'about:blank';\r\n        this._contents.classList.add('viewer');\r\n        this._contents.addEventListener('load', () => {\r\n            this._contents.contentWindow.document.body.onclick = () => {\r\n                this.focus();\r\n                closeDropdowns();\r\n            }\r\n        });\r\n        this._splitter.panel2.append(this._contents);\r\n        this._splitter.panel2.style.overflow = 'auto';\r\n        this._splitter.panel2.style.padding = '0';\r\n        this._splitter.panel2.style.paddingLeft = '4px';\r\n\r\n        this._buildMenu();\r\n        let footer = '';\r\n        footer += `<button id=\"${this.id}-back\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Go back\"><i class=\"bi bi-arrow-left\"></i><span class=\"icon-only\"> Back</span></button>`;\r\n        footer += `<button id=\"${this.id}-refresh\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Go back\"><i class=\"bi bi-arrow-repeat\"></i></i><span class=\"icon-only\"> Refresh</span></button>`;\r\n        footer += '<div class=\"vr float-start\" style=\"margin-right: 4px;height: 29px;\"></div>';\r\n        footer += '<span id=\"logs-page-buttons\"></span>';\r\n        footer += `<button id=\"${this.id}-cancel\" type=\"button\" class=\"btn-sm float-end btn btn-light\" title=\"Close dialog\"><i class=\"bi bi-x-lg\"></i><span class=\"icon-only\"> Close</span></button>`;\r\n        this.footer.innerHTML = footer;\r\n        this.footer.classList.add('dropup');\r\n        this.footer.querySelector(`#${this.id}-cancel`).addEventListener('click', () => {\r\n            removeHash(this._page);\r\n            this.close();\r\n        });\r\n        this.footer.querySelector(`#${this.id}-refresh`).addEventListener('click', () => {\r\n            this._buildMenu(true).then(() => {\r\n                const item = this._menu.querySelector(`a[href=\"#logs/${this._current}\"]`);\r\n                if (item) {\r\n                    item.classList.add('active');\r\n                    scrollChildIntoView(this._menu, item);\r\n                }\r\n            });\r\n            this.setBody('');\r\n        });\r\n        this.footer.querySelector(`#${this.id}-back`).addEventListener('click', () => {\r\n            this._goBack();\r\n        });\r\n        this.dialog.dataset.path = 'logs';\r\n        this.setBody('');\r\n    }\r\n\r\n    public setBody(contents: string, args?: any) {\r\n        if (!this._logs) {\r\n            setTimeout(() => {\r\n                this.setBody(contents, args);\r\n            });\r\n            return;\r\n        }\r\n        this._page = this.dialog.dataset.path;\r\n        if (this._page === 'logs')\r\n            this.dialog.dataset.panel = 'left';\r\n        else\r\n            this.dialog.dataset.panel = 'right';\r\n        const pages = this._page.split('/');\r\n        this._current = pages[pages.length - 1];\r\n        this.title = buildBreadcrumb(pages, {\r\n            small: this._small,\r\n            sep: '/', formatter: (item, index, last) => {\r\n                if (index === last) {\r\n                    if (this._logs[item] && !item.endsWith('.txt') && !item.endsWith('.raw') && !item.endsWith('.htm'))\r\n                        return `${formatDate(item)}${this._logs[item].character ? ', ' + this._logs[item].character : ''}>`;\r\n                    else if (this._logs[item] && this._logs[item].timeStamp)\r\n                        return `${formatDate(this._logs[item].timeStamp)}${this._logs[item].character ? ', ' + this._logs[item].character : ''}, ${item.substring(item.length - 3, item.length)}${this._logs[item].prefix ? ', ' + this._logs[item].prefix : ''}${this._logs[item].postfix ? ', ' + this._logs[item].postfix : ''}`;\r\n                }\r\n                return capitalize(item);\r\n            }, icon: '<i class=\"fas fa-list\" style=\"margin-right: 2px;\"></i>'\r\n        })\r\n        let items = this._menu.querySelectorAll('a.active');\r\n        items.forEach(item => item.classList.remove('active'));\r\n        items = this._menu.querySelector(`a[href=\"#logs/${this._current}\"]`);\r\n        if (items)\r\n            items.classList.add('active');\r\n\r\n        if (pages.length < 2) {\r\n            this._setContents('');\r\n            this._splitter.panel2Collapsed = true;\r\n            this.footer.querySelector(`#${this.id}-back`).style.display = 'none';\r\n            this.footer.querySelector('#logs-page-buttons').innerHTML = `<button id=\"${this.id}-clear\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Clear logs\"><i class=\"bi bi-trash\"></i><span class=\"icon-only\"> Clear</span></button>`;\r\n            this.footer.querySelector(`#${this.id}-clear`).addEventListener('click', () => {\r\n                confirm_box('Clear logs?', 'Remove all logs?').then(e => {\r\n                    if (e.button === DialogButtons.Yes) {\r\n                        let logs = Object.keys(this._logs);\r\n                        for (let r = 0, rl = logs.length; r < rl; r++) {\r\n                            localforage.removeItem('OoMUDLog' + logs[r]);\r\n                        }\r\n                        localforage.removeItem('OoMUDLogKeys').then(() => {\r\n                            this._buildMenu();\r\n                            this.setBody('');\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n            let clear = this.footer.querySelector(`#${this.id}-clear`);\r\n            if (clear) clear.style.display = Object.keys(this._logs).length ? '' : 'none';\r\n            (document.getElementById('logs-page-buttons').previousSibling as HTMLElement).style.display = Object.keys(this._logs).length ? '' : 'none';\r\n        }\r\n        else {\r\n            //this._setContents('<html><head><link href=\"oiMUD.min.css\" rel=\"stylesheet\" type=\"text/css\"></head><body style=\"background: white\"><div class=\"loader\"><div class=\"text\">Loading... <div class=\"indicator\"></div></div></div></body></html>');\r\n            localforage.getItem('OoMUDLog' + pages[1]).then(value => {\r\n                if (!pages[1].endsWith('.txt') && !pages[1].endsWith('.raw'))\r\n                    this._setContents(logHeader + (value || '').replace(/\\n/g, ''));\r\n                else\r\n                    this._setContents('<style>body {font-family: \\'Courier New\\', Courier, monospace;text-align: left;font-size: 1em;white-space: pre;background-color: white;}</style>' + (value || ''));\r\n            });\r\n            this.footer.querySelector(`#${this.id}-back`).style.display = '';\r\n            this._splitter.panel2Collapsed = false;\r\n            let b = `<button id=\"${this.id}-export\" type=\"button\" class=\"btn-sm float-start btn btn-light\" title=\"Export log\"><i class=\"bi bi-box-arrow-up\"></i><span class=\"icon-only\"> Export</span></button>`;\r\n            b += `<button id=\"${this.id}-remove\" type=\"button\" class=\"btn-sm btn btn-danger\" title=\"Remove log\"><i class=\"bi bi-trash\"></i><span class=\"icon-only\"> Remove</span></button>`;\r\n            this.footer.querySelector('#logs-page-buttons').innerHTML = b;\r\n            this.footer.querySelector(`#${this.id}-remove`).addEventListener('click', (e: MouseEvent) => {\r\n                this._removeLog(this._current);\r\n            });\r\n            this.footer.querySelector(`#${this.id}-export`).addEventListener('click', (e: MouseEvent) => {\r\n                this._exportLog(this._current);\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    private _setContents(contents) {\r\n        if (!this._contents.contentWindow || !this._contents.contentWindow.document || !this._contents.contentWindow.document.body) {\r\n            setTimeout(() => {\r\n                this._setContents(contents);\r\n            }, 10);\r\n            return;\r\n        }\r\n        this._contents.contentWindow.document.body.innerHTML = contents;\r\n        this._contents.contentWindow.scroll(0, 0);\r\n        this.emit('content-changed');\r\n    }\r\n\r\n    private _appendContents(contents, html?) {\r\n        if (!this._contents.contentWindow || !this._contents.contentWindow.document || !this._contents.contentWindow.document.body) {\r\n            setTimeout(() => {\r\n                this._appendContents(contents, html);\r\n            }, 10);\r\n            return;\r\n        }\r\n        if (html)\r\n            this._contents.contentWindow.document.body.insertAdjacentHTML('beforeend', contents);\r\n        else\r\n            this._contents.contentWindow.document.body.insertAdjacentText('beforeend', contents);\r\n    }\r\n\r\n    private _goBack() {\r\n        const pages = this._page.split('/');\r\n        if (pages.length === 5)\r\n            updateHash(pages.slice(0, pages.length - 2).join('/'), this._page);\r\n        else\r\n            updateHash(pages.slice(0, pages.length - 1).join('/'), this._page);\r\n    }\r\n\r\n    private _buildMenu(noLoader?) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!noLoader)\r\n                this._menu.innerHTML = '<div class=\"loader\"><div class=\"text\">Loading... <div class=\"indicator\"></div></div></div>'\r\n            localforage.getItem('OoMUDLogKeys').then(logs => {\r\n                this._logs = logs || {};\r\n                const keys = Object.keys(this._logs);\r\n                keys.sort();\r\n                if (keys.length === 0)\r\n                    this._menu.innerHTML = '<h1 id=\"empty\" style=\"width: 100%;text-align:center\">No logs.</h1>';\r\n                else {\r\n                    let p = '';\r\n                    for (let k = 0, kl = keys.length; k < kl; k++) {\r\n                        let icon = 'code';\r\n                        if (keys[k].endsWith('.txt'))\r\n                            icon = 'text';\r\n                        else if (keys[k].endsWith('.raw'))\r\n                            icon = 'binary';\r\n                        let title = keys[k];\r\n                        if (!keys[k].endsWith('.txt') && !keys[k].endsWith('.raw') && !keys[k].endsWith('.htm'))\r\n                            title = `${formatDate(keys[k])}${this._logs[keys[k]].character ? ', ' + this._logs[keys[k]].character : ''}`;\r\n                        else if (this._logs[keys[k]].timeStamp)\r\n                            title = `${formatDate(this._logs[keys[k]].timeStamp)}${this._logs[keys[k]].character ? ', ' + this._logs[keys[k]].character : ''}, ${keys[k].substring(keys[k].length - 3, keys[k].length)}${this._logs[keys[k]].prefix ? ', ' + this._logs[keys[k]].prefix : ''}${this._logs[keys[k]].postfix ? ', ' + this._logs[keys[k]].postfix : ''}`;\r\n                        p += `<a id=\"${keys[k]}\" href=\"#logs/${encodeURIComponent(keys[k])}\" class=\"list-group-item list-group-item-action\" title=\"${title}\"><span class=\"list-badge-button badge text-bg-danger\" data-key=\"${keys[k]}\" data-type=\"delete\" title=\"Remove log\"><i class=\"bi bi-trash\"></i></span><span class=\"me-1 list-badge-button badge text-bg-secondary\" data-key=\"${keys[k]}\" data-type=\"export\" title=\"Export log\"><i class=\"bi bi-box-arrow-up\"></i></span><i class=\"bi bi-file-${icon}\"></i>${title}</a>`;\r\n                    }\r\n                    this._menu.innerHTML = '<div class=\"list-group\" id=\"logs-menu\">' + p + '</div>';\r\n                    this._menu.querySelectorAll('[data-type=\"delete\"').forEach(item => {\r\n                        item.addEventListener('click', e => {\r\n                            this._removeLog(e.currentTarget.dataset.key);\r\n                            e.stopPropagation();\r\n                            e.cancelBubble = true;\r\n                            e.preventDefault();\r\n                        });\r\n                    });\r\n                    this._menu.querySelectorAll('[data-type=\"export\"').forEach(item => {\r\n                        item.addEventListener('click', e => {\r\n                            this._exportLog(e.currentTarget.dataset.key);\r\n                            e.stopPropagation();\r\n                            e.cancelBubble = true;\r\n                            e.preventDefault();\r\n                        });\r\n                    });\r\n                }\r\n                resolve('');\r\n            });\r\n        });\r\n    }\r\n\r\n    public async logChanged(log, value) {\r\n        if (!this._logs || !this._logs[log]) {\r\n            await this._buildMenu();\r\n            const item = this._menu.querySelector(`a[href=\"#logs/${this._current}\"]`);\r\n            if (item) {\r\n                item.classList.add('active');\r\n                scrollChildIntoView(this._menu, item);\r\n            }\r\n            let clear = this.footer.querySelector(`#${this.id}-clear`);\r\n            if (clear) clear.style.display = '';\r\n            (document.getElementById('logs-page-buttons').previousSibling as HTMLElement).style.display = '';\r\n        }\r\n        if (this._current === log) {\r\n            if (!log.endsWith('.txt') && !log.endsWith('.raw'))\r\n                this._appendContents((value || '').replace(/\\n/g, ''), true);\r\n            else\r\n                this._appendContents(value || '');\r\n        }\r\n    }\r\n\r\n    private _removeLog(log) {\r\n        confirm_box('Remove log', 'Remove log?').then(e => {\r\n            if (e.button === DialogButtons.Yes) {\r\n                localforage.removeItem('OoMUDLog' + log);\r\n                delete this._logs[log];\r\n                localforage.setItem('OoMUDLogKeys', this._logs);\r\n                document.getElementById(log).remove();\r\n                if (this._page !== 'logs')\r\n                    this._goBack();\r\n            }\r\n        })\r\n    }\r\n\r\n    private _exportLog(log) {\r\n        localforage.getItem('OoMUDLog' + log).then(value => {\r\n            if (log.endsWith('.htm'))\r\n                fileSaveAs.show(logHeader + (value || ''), `oiMUD.${log}l`, 'text/html');\r\n            else if (log.endsWith('.raw'))\r\n                fileSaveAs.show(value || '', `oiMUD.${log}.txt`, 'text/plain');\r\n            else if (log.endsWith('.txt'))\r\n                fileSaveAs.show(value || '', `oiMUD.${log}`, 'text/plain');\r\n            else\r\n                fileSaveAs.show(value || '', `oiMUD.${log}.html`, 'text/plain');\r\n        });\r\n\r\n    }\r\n    private _updateSmall(width) {\r\n        if (!this.header.querySelector('.breadcrumb')) {\r\n            setTimeout(() => {\r\n                this._updateSmall(width);\r\n            }, 10);\r\n            return;\r\n        }\r\n        if (width < 430) {\r\n            if (this._small) return;\r\n            const item = this.header.querySelector('.breadcrumb');\r\n            item.classList.add('breadcrumb-sm');\r\n            this._small = true;\r\n        }\r\n        else if (this._small) {\r\n            const item = this.header.querySelector('.breadcrumb');\r\n            item.classList.remove('breadcrumb-sm');\r\n            this._small = false;\r\n        }\r\n    }\r\n}\r\n\r\nfunction formatDate(date) {\r\n    if (typeof date === 'string')\r\n        date = parseInt(date, 10);\r\n    date = new Date(date);\r\n    let hours = date.getHours();\r\n    let minutes = date.getMinutes();\r\n    let ampm = hours >= 12 ? 'pm' : 'am';\r\n    hours = hours % 12;\r\n    hours = hours ? hours : 12; // the hour '0' should be '12'\r\n    minutes = minutes < 10 ? '0' + minutes : minutes;\r\n    let strTime = hours + ':' + minutes + ' ' + ampm;\r\n    return date.getMonth() + 1 + '/' + date.getDate() + '/' + date.getFullYear() + '  ' + strTime;\r\n}", "import '../css/chat.css';\r\nimport { Plugin } from '../core/plugin';\r\nimport { MenuItem } from '../core/types';\r\nimport { Dialog } from '../interface/dialog';\r\nimport { removeHash } from '../interface/interface';\r\nimport { Display } from '../core/display';\r\nimport { Logger } from './logger';\r\nimport { debounce } from '../core/library';\r\n\r\ndeclare let localforage;\r\n\r\nexport enum chatType {\r\n    none = 0,\r\n    window = 1 << 0,\r\n    dialog = 1 << 1,\r\n}\r\n\r\nexport class Chat extends Plugin {\r\n    private _capture = 0;\r\n    private _captureReview = 0;\r\n    private _captures = [];\r\n    private _captureReviews = [];\r\n    private _noCapture = false;\r\n    private _noCaptureStore = 0;\r\n    private _dialog: Dialog;\r\n    private _window: WindowProxy;\r\n    private _logger: Worker;\r\n    private _loggerPlugin: Logger;\r\n\r\n    private _unload = () => {\r\n        let state = this._getWindowState();\r\n        if (this._isWindowOpen) {\r\n            this._window.close();\r\n            state.show = true;\r\n        }\r\n        else\r\n            state.show = false;\r\n        this.client.setOption('windows.chatWindow', state);\r\n    }\r\n\r\n    public remove(): void {\r\n        this.client.removeListenersFromCaller(this);\r\n        delete (<any>this.client).sendChat\r\n        window.removeEventListener('beforeunload', this._unload);\r\n    }\r\n    public initialize(): void {\r\n        (<any>this.client).sendChat = data => { let e = { data: this.client.parseInline(data), raw: data }; this.client.emit('send-chat', e); this.updateChat(e.data) };\r\n        (<any>this.client).sendChatRaw = data => { let e = { data: data, raw: data }; this.client.emit('send-chat', e); this.updateChat(e.raw) };\r\n        window.addEventListener('beforeunload', this._unload);\r\n        this.client.on('function', data => {\r\n            if (!data) return;\r\n            let args = data.args;\r\n            switch (data.name.toLowerCase()) {\r\n                //spell-checker:ignore chatprompt chatp\r\n                case 'chatprompt':\r\n                case 'chatp':\r\n                    if ((this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    args = this.client.parseInline(args.join(' '));\r\n                    this.updateChat(args);\r\n                    data.handled = true;\r\n                    break;\r\n                case 'chat':\r\n                case 'ch':\r\n                    if ((this.client.getOption('echo') & 4) === 4)\r\n                        this.client.echo(data.raw, -3, -4, true, true);\r\n                    args = this.client.parseInline(args.join(' ') + '\\n');\r\n                    this.updateChat(args);\r\n                    data.handled = true;\r\n                    break;\r\n            }\r\n        }, this);\r\n        this.client.on('add-line', data => {\r\n            let res, c, cl;\r\n            if (!data || typeof data.line == 'undefined' || data.line === null)\r\n                return;\r\n            if (data.fragment || this._captures.length === 0) return;\r\n            //custom capture to ignore who list\r\n            res = /^(-*)\\s*\\[ (.*) matching (users|user) \\]\\s*(-*)$/.exec(data.line);\r\n            if (res && res.length > 0) {\r\n                this._capture = 0;\r\n                this._noCapture = true;\r\n                return;\r\n            }\r\n            //end capture blocking for who list\r\n            res = /^(-*)\\s*\\[ .* \\]\\s*(-*)$/.exec(data.line);\r\n            if (this._noCapture && res && res.length > 0) {\r\n                this._capture = 0;\r\n                this._noCapture = false;\r\n                return;\r\n            }\r\n\r\n            if (data.line === 'Describers:' ||\r\n                data.line === 'You supply a list of nouns so when your object is complete it can correctly build an id list to allow you to properly interact with it.' ||\r\n                data.line === 'You supply a list of adjectives so when your object is complete it can correctly build an id list to allow you to properly interact with it.' ||\r\n                data.line === 'Available sizes:' ||\r\n                data.line === 'Available locations:' ||\r\n                data.line === 'Available tattoos:' ||\r\n                data.line === 'Available colors:'\r\n            ) {\r\n                this._capture = 0;\r\n                this._noCapture = true;\r\n                return;\r\n            }\r\n\r\n            if (this._noCapture && (\r\n                data.line.indexOf('Current name: ') === 0 ||\r\n                data.line.indexOf('Enter up to 2 nouns, [#] to remove, \\'f\\' to finish, \\'q\\' to quit:') === 0 ||\r\n                data.line.indexOf('Enter up to 3 adjectives, \\'f\\' to finish, \\'q\\' to quit:') === 0 ||\r\n                data.line.indexOf('Enter selection ') === 0\r\n            )) {\r\n                this._capture = 0;\r\n                this._noCapture = false;\r\n                return;\r\n            }\r\n\r\n            //locker/store list start\r\n            res = /^ {2}# {2}Item.*$/.exec(data.line);\r\n            if (this._noCaptureStore === 0 && res && res.length > 0) {\r\n                this._capture = 0;\r\n                this._noCaptureStore = 1;\r\n                return;\r\n            }\r\n            //locker/store list end\r\n            res = /^(-*)$/.exec(data.line);\r\n            if (this._noCaptureStore > 0 && res && res.length > 0) {\r\n                this._capture = 0;\r\n                this._noCaptureStore++;\r\n            }\r\n            if (this._noCaptureStore > 2) {\r\n                this._capture = 0;\r\n                this._noCaptureStore = 0;\r\n            }\r\n\r\n            if (this._noCapture || this._noCaptureStore > 0) return;\r\n\r\n            if (this.client.getOption('chat.CaptureOnlyOpen')) {\r\n                if (!(this._isWindowOpen || this._isDialogOpen)) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            //capture indented text\r\n            if (this._capture > 0 && data.line.startsWith('    ')) {\r\n                data.gagged |= this.client.getOption('chat.gag');\r\n                this.updateChat(data);\r\n                return;\r\n            }\r\n            //search capture review blocks\r\n            for (c = 0, cl = this._captureReviews.length; c < cl; c++) {\r\n                //re = new RegExp(_captureReviews[c], 'g');\r\n                res = this._captureReviews[c].exec(data.line);\r\n                if (!res || res.length === 0)\r\n                    continue;\r\n                this._captureReview = 1;\r\n                data.gagged |= this.client.getOption('chat.gag');\r\n                this.updateChat(data);\r\n                return;\r\n            }\r\n            //if in a review capture until end review\r\n            if (this._captureReview > 0) {\r\n                data.gagged |= this.client.getOption('chat.gag');\r\n                this.updateChat(data);\r\n                if (data.line == '-=-=- End Review -=-=-')\r\n                    this._captureReview = -1;\r\n                /*\r\n                res = /^-=-=- End Review -=-=-$/.exec(data.line);\r\n                if (res && res.length > 0)\r\n                    captureReview = -1;\r\n                */\r\n                return;\r\n            }\r\n            //review requires 1 extra capture to get the current date/time\r\n            if (this._captureReview === -1) {\r\n                data.gagged |= this.client.getOption('chat.gag');\r\n                this.updateChat(data);\r\n                this._captureReview = 0;\r\n                return;\r\n            }\r\n\r\n            //capture lines based on matching regex's\r\n            for (c = 0, cl = this._captures.length; c < cl; c++) {\r\n                //re = new RegExp(_captures[c], 'g');\r\n                res = this._captures[c].exec(data.line);\r\n                if (!res || res.length === 0)\r\n                    continue;\r\n                if (this._capture > 0)\r\n                    this._capture--;\r\n                this._capture++;\r\n                data.gagged |= this.client.getOption('chat.gag');\r\n                this.updateChat(data);\r\n                return;\r\n            }\r\n            //no matching capture so if in capture mode reduce\r\n            if (this._capture > 0)\r\n                this._capture--;\r\n        }, this);\r\n        this.client.on('window', (window, args, name) => {\r\n            switch (window) {\r\n                case 'chat-dialog':\r\n                case 'chatdialog':\r\n                case 'chat':\r\n                    if (args === 'close') {\r\n                        if (this._dialog)\r\n                            this._dialog.close();\r\n                        removeHash('chat');\r\n                    }\r\n                    else\r\n                        this.showDialog();\r\n                    break;\r\n                case 'chatwin':\r\n                case 'chatwindow':\r\n                case 'chat-win':\r\n                case 'chat-window':\r\n                    if (args === 'close') {\r\n                        if (this._isWindowOpen)\r\n                            this._window.close();\r\n                    }\r\n                    else\r\n                        this.showWindow();\r\n                    break;\r\n            }\r\n        });\r\n        this.client.on('close-window', window => {\r\n            switch (window) {\r\n                case 'chat-dialog':\r\n                case 'chatdialog':\r\n                case 'chat':\r\n                    if (this._dialog)\r\n                        this._dialog.close();\r\n                    removeHash('chat');\r\n                    break;\r\n                case 'chatwin':\r\n                case 'chatwindow':\r\n                case 'chat-win':\r\n                case 'chat-window':\r\n                    if (this._isWindowOpen)\r\n                        this._window.close();\r\n                    break;\r\n            }\r\n        })\r\n        this.client.on('options-loaded', () => {\r\n            this._loadOptions();\r\n        });\r\n        this.client.on('option-changed', (name: string, value) => {\r\n            if (name.startsWith('chat.') || name === 'enableMXP' || name === 'enableURLDetection' || name === 'display.showInvalidMXPTags' || name === 'display.hideTrailingEmptyLine' || name.startsWith('log') || name === 'enableDebug') {\r\n                this._loadOptions();\r\n            }\r\n        });\r\n        this.client.on('set-title', (title, lag) => {\r\n            this._post({ action: 'name', args: $character });\r\n        }, this);\r\n        this.client.on('connecting', () => {\r\n            this._post({ action: 'connected', args: this.client.connected });\r\n        }, this);\r\n        this._buildCaptures();\r\n        this._loadOptions();\r\n        if (this.client.getOption('showChat') || this.client.getOption('chat.persistent') || this.client.getOption('chat.captureTells') || this.client.getOption('chat.captureTalk') || this.client.getOption('chat.captureLines'))\r\n            this.show();\r\n        let options = this.client.getWindowState('chat')\r\n        if (options && options.show)\r\n            this.showDialog();\r\n        options = this.client.getWindowState('chatWindow')\r\n        if (options && options.show)\r\n            this.showWindow();\r\n    }\r\n\r\n    get menu(): MenuItem[] {\r\n        return [{\r\n            name: '-',\r\n            position: 5,\r\n            exists: '#menu-plugins',\r\n            id: 'plugins'\r\n        },\r\n        {\r\n            name: ' Show chat',\r\n            action: e => { this.client.getOption('showChatWindow') ? this.show() : this.showDialog(); },\r\n            icon: '<i class=\"bi bi-chat\"></i>',\r\n            position: '#menu-plugins'\r\n        }];\r\n    }\r\n\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' Chat',\r\n            action: 'settings-chat',\r\n            icon: '<i class=\"bi bi-chat\"></i>',\r\n            position: 'a[href=\"#settings-specialCharacters\"]'\r\n        }, {\r\n            name: ' Chat display',\r\n            action: 'settings-chatDisplay',\r\n            icon: '<i class=\"bi bi-chat\"></i>',\r\n            position: 'a[href=\"#settings-chat\"]'\r\n        }]\r\n    }\r\n\r\n    private _buildCaptures() {\r\n        this._captures = [];\r\n        this._captureReviews = [];\r\n        if (this.client.getOption('chat.captureTells')) {\r\n            this._captures.push(new RegExp('^([a-zA-Z\\'\\\\s_-]*) tells you:(.*)$'),\r\n                new RegExp('^(\\\\([a-zA-Z\\'\\\\s_-]*\\\\)) tells you:(.*)$'),\r\n                new RegExp('^You tell ([a-zA-Z\\'\\\\s_-]*):(.*)$'),\r\n                new RegExp('^\\\\*([a-zA-Z\\'\\\\s_-]*)(\\\\s?)(.*?)$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) is idle, and may not have been paying attention.$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) is in combat and may not have heard you.$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) is in edit and may not be in a position to respond.$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) is arrested and can not respond.$'),\r\n                new RegExp('^\\\\*You emote to ([a-zA-Z\\'\\\\s_-]*):(.*)$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) shouts in ([a-zA-Z\\'\\\\s_-]*):(.*)$'),\r\n                new RegExp('^You shout in ([a-zA-Z\\'\\\\s_-]*):(.*)$')\r\n            );\r\n            if (this.client.getOption('chat.captureReviews'))\r\n                this._captureReviews.push(new RegExp('^-=-=- Tell Review -=-=-$'));\r\n        }\r\n        if (this.client.getOption('chat.captureTalk')) {\r\n            this._captures.push(new RegExp('^([a-zA-Z\\'\\\\s_-]*) says:(.*)$'),\r\n                new RegExp('^You say:(.*)$'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) whispers to you:(.*)$'),\r\n                new RegExp('You whisper to ([a-zA-Z\\'\\\\s_-]*):(.*)'),\r\n                new RegExp('^([a-zA-Z\\'\\\\s_-]*) yells:(.*)$'),\r\n                new RegExp('^You yell:(.*)$'),\r\n                new RegExp('You say in (.*):(.*)'),\r\n                new RegExp('([a-zA-Z\\'\\\\s_-]*) says something in (.*).'),\r\n                new RegExp('([a-zA-Z\\'\\\\s_-]*) says in (.*):(.*)'));\r\n            if (this.client.getOption('chat.captureReviews'))\r\n                this._captureReviews.push(new RegExp('^-=-=- Say Review -=-=-$'));\r\n        }\r\n        if (this.client.getOption('chat.captureLines')) {\r\n            if (this.client.getOption('chat.captureAllLines')) {\r\n                this._captures.push(new RegExp('^\\\\[(.*)\\\\](.*)$'));\r\n                if (this.client.getOption('chat.captureReviews'))\r\n                    this._captureReviews.push(new RegExp('^-=-=- ((?:(?!\\\\b(Say|Tell|End)\\\\b).)+) Review -=-=-$'));\r\n            }\r\n            else {\r\n                const lines = this.client.getOption('chat.lines');\r\n                for (let l = 0, ll = lines.length; l < ll; l++) {\r\n                    if (lines[l].trim().length === 0) continue;\r\n                    this._captures.push(new RegExp('\\\\[' + lines[l].trim() + '\\\\](.*)', 'i'));\r\n                    if (this.client.getOption('chat.captureReviews'))\r\n                        this._captureReviews.push(new RegExp('^-=-=- ' + lines[l].trim() + ' Review -=-=-$', 'i'));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public updateChat(data) {\r\n        this.emit('update-chat', data);\r\n        if (typeof data === 'string') {\r\n            let display;\r\n            let line = -1;\r\n            if (this._isDialogOpen) {\r\n                line = (<any>this._dialog).display.lines.length - 1;\r\n                (<any>this._dialog).display.append(data);\r\n                display = (<any>this._dialog).display;\r\n            }\r\n            if (this._isWindowOpen) {\r\n                if (!display) line = (<any>this._window).display.lines.length - 1;\r\n                (<any>this._window).display.append(data);\r\n                display = display || (<any>this._window).display;\r\n            }\r\n            if (display) {\r\n                if (line < 0) line = 0;\r\n                data = Object.assign({ fragment: display.EndOfLine, line: display.lines[line].text }, display.lines[line]);\r\n            }\r\n            else\r\n                data = {\r\n                    line: data,\r\n                    formats: [{\r\n                        formatType: 0,\r\n                        offset: 0,\r\n                        color: 37,\r\n                        background: 40,\r\n                        size: 0,\r\n                        font: 0,\r\n                        style: 0,\r\n                        unicode: false\r\n                    }],\r\n                    raw: data,\r\n                    timestamp: Date.now()\r\n                };\r\n        }\r\n        else {\r\n            if (this._isDialogOpen)\r\n                (<any>this._dialog).display.model.appendLines([data]);\r\n            if (this._isWindowOpen)\r\n                (<any>this._window).display.model.appendLines([data]);\r\n        }\r\n        if (this.client.getOption('chat.log'))\r\n            this._post({ action: 'add-line', args: data });\r\n    };\r\n\r\n    private _getWindowState() {\r\n        let state = Object.assign({}, { show: false, width: 640, height: 480, x: window.screenLeft + 200, y: window.screenTop + 200 }, this.client.getWindowState('chatWindow'));\r\n        if (this._isWindowOpen) {\r\n            state.width = this._window.document.body.clientWidth;\r\n            state.height = this._window.document.body.clientHeight;\r\n            state.x = this._window.screenLeft || this._window.screenX;\r\n            state.y = this._window.screenTop || this._window.screenY;\r\n        }\r\n        return state;\r\n    }\r\n\r\n    private _buildToolbar(doc, display) {\r\n        const toolbar = doc.createElement('nav');\r\n        toolbar.id = 'chat-toolbar';\r\n        toolbar.classList.add('navbar', 'bg-light', 'align-items-center');\r\n        toolbar.innerHTML = `<form class=\"container-fluid justify-content-start\"><button id=\"btn-chat-clear\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Clear display\"><i class=\"bi bi-trash\"></i></button><button id=\"btn-chat-lock\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Lock display\"><i class=\"bi bi-lock-fill\"></i></button><div class=\"vr me-2\" style=\"height: 29px;\"></div><button id=\"btn-chat-log\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Log chat\"><i class=\"bi bi-file-text\"></i></button><div class=\"vr me-2\" style=\"height: 29px;\"></div><button id=\"btn-chat-wrap\" type=\"button\" class=\"btn btn-sm btn-outline-secondary me-2 mb-1\" title=\"Toggle word wrap\"><i class=\"bi bi-text-wrap\"></i></button></form>`;\r\n        toolbar.querySelector('#btn-chat-clear').addEventListener('click', () => {\r\n            display.clear();\r\n        });\r\n        toolbar.querySelector('#btn-chat-lock').addEventListener('click', () => {\r\n            this.client.setOption('chat.scrollLocked', !this.client.getOption('chat.scrollLocked'));\r\n            if (this._isWindowOpen) {\r\n                (this._window as any).display.scrollLock = this.client.getOption('chat.scrollLocked');\r\n                this._updateScrollLockButton(this._window.document.querySelector('#btn-chat-lock'), this.client.getOption('chat.scrollLocked'));\r\n            }\r\n            if (this._dialog) {\r\n                (this._dialog as any).display.scrollLock = this.client.getOption('chat.scrollLocked');\r\n                this._updateScrollLockButton(this._dialog.body.querySelector('#btn-chat-lock'), this.client.getOption('chat.scrollLocked'));\r\n            }\r\n        });\r\n        toolbar.querySelector('#btn-chat-log').addEventListener('click', () => {\r\n            this.client.setOption('chat.log', !this.client.getOption('chat.log'));\r\n            if (this.client.getOption('chat.log'))\r\n                this._createLogger();\r\n            if (this._isWindowOpen)\r\n                this._updateButtonState(this._window.document.querySelector('#btn-chat-log'), this.client.getOption('chat.log'));\r\n            if (this._dialog)\r\n                this._updateButtonState(this._dialog.body.querySelector('#btn-chat-log'), this.client.getOption('chat.log'));\r\n            if (this._logger)\r\n                this._post({ action: 'toggle' });\r\n        });\r\n        toolbar.querySelector('#btn-chat-wrap').addEventListener('click', () => {\r\n            this.client.setOption('chat.wordWrap', !this.client.getOption('chat.wordWrap'));\r\n            if (this._isWindowOpen) {\r\n                this._updateButtonState(this._window.document.querySelector('#btn-chat-wrap'), this.client.getOption('chat.wordWrap'));\r\n                (this._window as any).display.wordWrap = this.client.getOption('chat.wordWrap');\r\n            }\r\n            if (this._dialog) {\r\n                this._updateButtonState(this._dialog.body.querySelector('#btn-chat-wrap'), this.client.getOption('chat.wordWrap'));\r\n                (this._dialog as any).display.wordWrap = this.client.getOption('chat.wordWrap');\r\n            }\r\n\r\n        });\r\n        this._updateScrollLockButton(toolbar.querySelector('#btn-chat-lock'), this.client.getOption('chat.scrollLocked'));\r\n        this._updateButtonState(toolbar.querySelector('#btn-chat-wrap'), this.client.getOption('chat.wordWrap'));\r\n        this._updateButtonState(toolbar.querySelector('#btn-chat-log'), this.client.getOption('chat.log'));\r\n        return toolbar;\r\n    }\r\n\r\n    private _updateScrollLockButton(button: HTMLElement, state) {\r\n        if (!button) return;\r\n        let icon = button.firstElementChild;\r\n        if (state) {\r\n            button.title = 'Unlock display';\r\n            button.classList.add('active');\r\n            icon.classList.add('bi-unlock-fill');\r\n            icon.classList.remove('bi-lock-fill');\r\n        }\r\n        else {\r\n            button.title = 'Lock display';\r\n            button.classList.remove('active');\r\n            icon.classList.remove('bi-unlock-fill');\r\n            icon.classList.add('bi-lock-fill');\r\n        }\r\n    }\r\n\r\n    private _updateButtonState(button: HTMLElement, state) {\r\n        if (!button) return;\r\n        if (state)\r\n            button.classList.add('active');\r\n        else\r\n            button.classList.remove('active');\r\n    }\r\n\r\n    public showWindow() {\r\n        if (!this._isWindowOpen) {\r\n            let state = this._getWindowState();\r\n            this._window = window.open('window.htm', \"chat-window\", \"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=\" + (state.width) + \",height=\" + (state.height) + \",top=\" + (state.y) + \",left=\" + (state.x));\r\n            state.show = true;\r\n            this._window.addEventListener('resize', () => {\r\n                this.client.setOption('windows.chatWindow', this._getWindowState());\r\n                debounce(() => {\r\n                    (<any>this._window).display.container.style.top = this._window.document.getElementById('chat-toolbar').offsetHeight + 'px';\r\n                }, 25, 'chat-resize');\r\n            });\r\n            this._window.addEventListener('focus', () => {\r\n                this.client.setOption('windows.chatWindow', this._getWindowState());\r\n            });\r\n            this._window.addEventListener('blur', () => {\r\n                this.client.setOption('windows.chatWindow', this._getWindowState());\r\n            });\r\n            this._window.addEventListener('load', () => {\r\n                this._window.document.querySelector('head').insertAdjacentHTML('afterbegin', `<<link id=\"icon1\" rel=\"shortcut icon\" href=\"images/chat.png\" /><link id=\"icon2\" rel=\"icon\" href=\"images/chat.png\" /><link id=\"icon3\" rel=\"icon\" type=\"image/x-icon\" href=\"images/chat.png\" /><link href=\"oiMUD.min.css\" rel=\"stylesheet\" type=\"text/css\">>`);\r\n                this._window.document.title = 'Chat';\r\n                let el = this._window.document.createElement('div');\r\n                el.id = 'chat-display';\r\n                this._window.document.body.append(el);\r\n                (<any>this._window).display = new Display(el);\r\n                (<any>this._window).display.on('split-move-done', (h) => {\r\n                    this.client.setOption('chat.splitHeight', h);\r\n                });   \r\n                this._loadDisplayOptions((<any>this._window).display);\r\n                this._loadWindowOptions(this._window.document);\r\n                const toolbar = this._buildToolbar(this._window.document, (<any>this._window).display);\r\n                this._window.document.body.appendChild(toolbar);\r\n                this._window.focus();\r\n            });\r\n        }\r\n    }\r\n\r\n    public showDialog() {\r\n        if (!this._dialog) {\r\n            this._dialog = new Dialog(Object.assign({}, this.client.getWindowState('chat') || { center: true }, { title: '<i class=\"bi bi-chat\"></i> Chat', minWidth: 410, noFooter: true, id: 'chat-dialog' }));\r\n            this._dialog.header.querySelector('#chat-dialog-max').insertAdjacentHTML('afterend', '<button type=\"button\" class=\"btn btn-light float-end\" id=\"chat-dialog-window\" title=\"Open chat window\" style=\"padding: 0 4px;margin-top: -1px;\"><i class=\"bi bi-window\"></i></button>');\r\n            this._dialog.header.querySelector('#chat-dialog-window').addEventListener('click', () => {\r\n                this.showWindow();\r\n            });\r\n            let el = document.createElement('div');\r\n            el.id = 'chat-display';\r\n            this._dialog.body.append(el);\r\n            (<any>this._dialog).display = new Display(el);\r\n            (<any>this._dialog).display.on('split-move-done', (h) => {\r\n                this.client.setOption('chat.splitHeight', h);\r\n            });             \r\n            this._loadDisplayOptions((<any>this._dialog).display);\r\n            this._loadWindowOptions(this._dialog.body);\r\n            const toolbar = this._buildToolbar(document, (<any>this._dialog).display);\r\n            this._dialog.body.appendChild(toolbar);\r\n\r\n            this._dialog.on('resized', e => {\r\n                this.client.setOption('windows.chat', e);\r\n                debounce(() => {\r\n                    el.style.top = toolbar.offsetHeight + 'px';\r\n                }, 25, 'chat-resize');\r\n            });\r\n            this._dialog.on('closed', () => {\r\n                this.client.setOption('windows.chat', this._dialog.windowState);\r\n                removeHash('chat');\r\n                this.client.setOption('showChat', false);\r\n                if (this._dialog && !this._dialog.persistent) {\r\n                    delete this._dialog;\r\n                    this._dialog = null;\r\n                }\r\n            });\r\n            this._dialog.on('canceled', () => {\r\n                this.client.setOption('windows.chat', this._dialog.windowState);\r\n                removeHash('chat');\r\n                this.client.setOption('showChat', false);\r\n                if (this._dialog && !this._dialog.persistent) {\r\n                    delete this._dialog;\r\n                    this._dialog = null;\r\n                }\r\n            });\r\n            this._dialog.on('moved', e => {\r\n                this.client.setOption('windows.chat', e);\r\n            })\r\n            this._dialog.on('maximized', () => {\r\n                this.client.setOption('windows.chat', this._dialog.windowState);\r\n            });\r\n            this._dialog.on('restored', () => {\r\n                this.client.setOption('windows.chat', this._dialog.windowState);\r\n            });\r\n            this._dialog.on('shown', () => {\r\n                this.client.setOption('windows.chat', this._dialog.windowState);\r\n                this.client.setOption('showChat', true);\r\n            });\r\n        }\r\n        this._dialog.show();\r\n    }\r\n\r\n    public show() {\r\n        if ((this.client.getOption('showChatWindow') & chatType.window) == chatType.window)\r\n            this.showWindow();\r\n        if (this.client.getOption('showChat') || (this.client.getOption('showChatWindow') & chatType.dialog) == chatType.dialog)\r\n            this.showDialog();\r\n    }\r\n\r\n    public toggleDialog() {\r\n        if (this._isDialogOpen)\r\n            this._dialog.close();\r\n        else\r\n            this.showDialog();\r\n    }\r\n\r\n    private _getLogger() {\r\n        if (this._loggerPlugin) return;\r\n        for (let p = 0, pl = this.client.plugins.length; p < pl; p++) {\r\n            if (this.client.plugins[p] instanceof Logger) {\r\n                this._loggerPlugin = this.client.plugins[p] as Logger;\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _createLogger() {\r\n        if (this._logger || !client.getOption('chat.log')) return;\r\n        this._getLogger();\r\n        if (!this._loggerPlugin) return;\r\n        this._logger = this._loggerPlugin.createLogger();\r\n        this._logger.addEventListener('message', e => {\r\n            switch (e.data.event) {\r\n                case 'started':\r\n                    this.client.setOption('chat.log', true);\r\n                    if (this._isWindowOpen)\r\n                        this._updateButtonState(this._window.document.querySelector('#btn-chat-log'), true);\r\n                    if (this._dialog)\r\n                        this._updateButtonState(this._dialog.body.querySelector('#btn-chat-log'), true);\r\n                    break;\r\n                case 'stopped':\r\n                    this.client.setOption('chat.log', false);\r\n                    if (this._isWindowOpen)\r\n                        this._updateButtonState(this._window.document.querySelector('#btn-chat-log'), false);\r\n                    if (this._dialog)\r\n                        this._updateButtonState(this._dialog.body.querySelector('#btn-chat-log'), false);\r\n                    this._post({ action: 'flush' });\r\n                    this._logger.terminate();\r\n                    this._logger = null;\r\n                    break;\r\n                case 'logging':\r\n                    break;\r\n                case 'error':\r\n                    this.client.error(e.data.args);\r\n                    break;\r\n                case 'debug':\r\n                    if (!this.client)\r\n                        console.log(e.data.args);\r\n                    else if (this.client.getOption('enableDebug'))\r\n                        this.client.debug(e.data.args);\r\n                    break;\r\n                case 'toggled':\r\n                    if (this.client)\r\n                        this.client.setOption('chat.log', e.data.args);\r\n                    if (this._isWindowOpen)\r\n                        this._updateButtonState(this._window.document.querySelector('#btn-chat-log'), e.data.args);\r\n                    if (this._dialog)\r\n                        this._updateButtonState(this._dialog.body.querySelector('#btn-chat-log'), e.data.args);\r\n                    if (!e.data.args) {\r\n                        this._post({ action: 'flush' });\r\n                        this._logger.terminate();\r\n                        this._logger = null;\r\n                    }\r\n                    break;\r\n                case 'startInternal':\r\n                case 'start':\r\n                    if (this._isDialogOpen)\r\n                        this._post({ action: e.data.event, args: { lines: (<any>this._dialog).display.lines, fragment: (<any>this._dialog).display.EndOfLine } });\r\n                    else if (this._isWindowOpen)\r\n                        this._post({ action: e.data.event, args: { lines: (<any>this._window).display.lines, fragment: (<any>this._window).display.EndOfLine } });\r\n                    else\r\n                        this._post({ action: e.data.event });\r\n                    break;\r\n                case 'write':\r\n                    this._getLogger();\r\n                    if (!this._loggerPlugin) return;\r\n                    this._loggerPlugin.updateKey(e.data);\r\n                    localforage.getItem('OoMUDLog' + e.data.file).then(value => {\r\n                        if (!value) value = '';\r\n                        value += e.data.data;\r\n                        localforage.setItem('OoMUDLog' + e.data.file, value).then(() => {\r\n                            if (this._loggerPlugin.manager) this._loggerPlugin.manager.logChanged(e.data.file, e.data.data);\r\n                            this._post({ action: 'write-done', file: e.data.file });\r\n                        });\r\n                    });\r\n                    break;\r\n            }\r\n        });\r\n        this._logger.addEventListener('error', e => {\r\n            if (!this.client)\r\n                console.error(e);\r\n            else\r\n                this.client.error(e);\r\n        });\r\n        this._post({\r\n            action: 'options', args: {\r\n                offline: client.getOption('logOffline'),\r\n                gagged: client.getOption('logGagged'),\r\n                enabled: client.getOption('chat.log'),\r\n                unique: client.getOption('logUniqueOnConnect'),\r\n                prepend: client.getOption('logPrepend'),\r\n                what: client.getOption('logWhat'),\r\n                debug: client.getOption('enableDebug'),\r\n                postfix: '.chat',\r\n                format: client.getOption('logTimeFormat'),\r\n                timestamp: client.getOption('logTimestamp'),\r\n                timestampFormat: client.getOption('logTimestampFormat')\r\n            }\r\n        });\r\n    }\r\n\r\n    private _post(data) {\r\n        if (!this._logger) return;\r\n        this._logger.postMessage(data);\r\n    }\r\n\r\n    private _loadDisplayOptions(display) {\r\n        display.updateFont(client.getOption('chat.font'), client.getOption('chat.fontSize'));\r\n        display.maxLines = client.getOption('chat.bufferSize');\r\n        display.enableFlashing = client.getOption('chat.flashing');\r\n        display.showTimestamp = client.getOption('chat.showTimestamp');\r\n        display.timestampFormat = client.getOption('chat.timestampFormat');\r\n        display.enableMXP = client.getOption('enableMXP');\r\n        display.enableURLDetection = client.getOption('enableURLDetection');\r\n        display.showInvalidMXPTags = client.getOption('display.showInvalidMXPTags');\r\n        display.hideTrailingEmptyLine = client.getOption('display.hideTrailingEmptyLine');\r\n        display.enableColors = client.getOption('chat.enableColors');\r\n        display.enableBackgroundColors = client.getOption('chat.enableBackgroundColors');\r\n        display.tabWidth = client.getOption('chat.tabWidth');\r\n        display.displayControlCodes = client.getOption('chat.displayControlCodes');\r\n        display.emulateTerminal = client.getOption('chat.emulateTerminal');\r\n        display.emulateControlCodes = client.getOption('chat.emulateControlCodes');\r\n        display.wordWrap = client.getOption('chat.wordWrap');\r\n        display.wrapAt = client.getOption('chat.wordWrapAt');\r\n        display.indent = client.getOption('chat.indent');\r\n        display.scrollLock = client.getOption('chat.scrollLocked');\r\n        display.enableSplit = client.getOption('chat.split');\r\n        display.splitLive = client.getOption('chat.splitLive');\r\n        display.splitHeight = client.getOption('chat.splitHeight');        \r\n        display.scrollDisplay();\r\n    }\r\n\r\n    private _loadWindowOptions(target) {\r\n        this._updateScrollLockButton(target.querySelector('#btn-chat-lock'), this.client.getOption('chat.scrollLocked'));\r\n        this._updateButtonState(target.querySelector('#btn-chat-wrap'), this.client.getOption('chat.wordWrap'));\r\n        this._updateButtonState(target.querySelector('#btn-chat-log'), this.client.getOption('chat.log'));\r\n    }\r\n\r\n    private _loadOptions() {\r\n        if (this._dialog) {\r\n            this._dialog.resetState(client.getWindowState('chat') || { center: true });\r\n            this._loadDisplayOptions((<any>this._dialog).display);\r\n            this._loadWindowOptions(this._dialog.body);\r\n        }\r\n        if (this._window) {\r\n            this._loadDisplayOptions((<any>this._window).display);\r\n            this._loadWindowOptions(this._window.document);\r\n        }\r\n\r\n        if (this._logger)\r\n            this._post({\r\n                action: 'options', args: {\r\n                    offline: client.getOption('logOffline'),\r\n                    gagged: client.getOption('logGagged'),\r\n                    enabled: client.getOption('chat.log'),\r\n                    unique: client.getOption('logUniqueOnConnect'),\r\n                    prepend: client.getOption('logPrepend'),\r\n                    what: client.getOption('logWhat'),\r\n                    debug: client.getOption('enableDebug'),\r\n                    prefix: 'chat.',\r\n                    format: client.getOption('logTimeFormat'),\r\n                    timestamp: client.getOption('logTimestamp'),\r\n                    timestampFormat: client.getOption('logTimestampFormat')\r\n                }\r\n            });\r\n        else\r\n            this._createLogger();\r\n        if (this._isDialogOpen)\r\n            this._post({ action: 'start', args: { lines: (<any>this._dialog).display.lines, fragment: (<any>this._dialog).display.EndOfLine } });\r\n        else if (this._isWindowOpen)\r\n            this._post({ action: 'start', args: { lines: (<any>this._window).display.lines, fragment: (<any>this._window).display.EndOfLine } });\r\n        else\r\n            this._post({ action: 'start' });\r\n    }\r\n\r\n    private get _isWindowOpen() {\r\n        return this._window && !this._window.closed;\r\n    }\r\n\r\n    private get _isDialogOpen() {\r\n        return this._dialog && this._dialog.opened;\r\n    }\r\n}", "import { EventEmitter } from '../../core/events';\r\nimport { Client } from '../../core/client';\r\nimport { Mapper } from '../mapper';\r\nimport { Map } from '../../core/map';\r\nimport { Settings, SettingProperties } from '../../core/settings';\r\nimport { DialogIcon } from '../../interface/dialog';\r\nimport { ProfileCollection, Profile, Alias, Macro, Button, Trigger, Context } from '../../core/profile';\r\nimport { Log } from '../logger';\r\n\r\ndeclare let LZString;\r\ndeclare let alert_box;\r\ndeclare let progress_box;\r\n\r\nexport enum BackupSelection {\r\n    None = 0,\r\n    Map = 2,\r\n    Profiles = 4,\r\n    Settings = 8,\r\n    Windows = 16,\r\n    Characters = 32,\r\n    All = 30\r\n}\r\n\r\nexport class Backup extends EventEmitter {\r\n    private _port: number = 1034;\r\n    private _abort: boolean = false;\r\n    private _user;\r\n    private _save;\r\n    private _mapper: Mapper;\r\n    public client: Client;\r\n\r\n    private _dialogProgress;\r\n\r\n    constructor(client: Client) {\r\n        super();\r\n        this.client = client;\r\n        this.initialize();\r\n    }\r\n\r\n    public remove(): void {\r\n        this.client.removeListenersFromCaller(this);\r\n    }\r\n\r\n    public initialize(): void {\r\n        this.client.telnet.GMCPSupports.push('Client 1');\r\n\r\n        this.client.on('connected', () => {\r\n            this._port = this.client.port;\r\n            this._closeDialog();\r\n            this._save = 0;\r\n            this._abort = false;\r\n        }, this);\r\n\r\n        this.client.on('closed', () => {\r\n            this._port = this.client.port;\r\n            this._closeDialog();\r\n            this._save = 0;\r\n            this._abort = false;\r\n        }, this);\r\n\r\n        this.client.on('received-GMCP', async (mod, obj) => {\r\n            if (mod.toLowerCase() !== 'client' || !obj) return;\r\n            this._getMapper();\r\n            switch (obj.action) {\r\n                case 'save':\r\n                    if (this._abort) return;\r\n                    this._user = obj.user;\r\n                    this._showDialog('Saving data');\r\n                    this._abort = false;\r\n                    //if mapper make sure open map saved\r\n                    if (this._mapper && this._mapper.map.changed) {\r\n                        this._mapper.map.save().then(() => {\r\n                            this.save(2);\r\n                        });\r\n                    }\r\n                    else\r\n                        this.save(2);\r\n                    break;\r\n                case 'load':\r\n                    this.client.debug(`Starting load\\n    Chunks: ${obj.chunks}\\n    Start chunk: ${obj.chunk}\\n    Size: ${obj.size}\\n`);\r\n                    this._abort = false;\r\n                    this._user = obj.user;\r\n                    this._save = [obj.chunks || 1, obj.chunk || 0, obj.size, ''];\r\n                    this._showDialog('Loading data');\r\n                    //if mapper make sure open map saved\r\n                    if (this._mapper && this._mapper.map.changed) {\r\n                        this._mapper.map.save().then(() => {\r\n                            this.getChunk();\r\n                        });\r\n                    }\r\n                    else\r\n                        this.getChunk();\r\n                    break;\r\n                case 'error':\r\n                    this.abort(obj.error);\r\n                    break;\r\n            }\r\n        });\r\n        this._port = this.client.port;\r\n    }\r\n\r\n    get URL(): string {\r\n        if (this._port === 1039)\r\n            return 'http://shadowmud.com:1132/client';\r\n        return 'http://shadowmud.com:1130/client';\r\n    }\r\n\r\n    public save(version?: number) {\r\n        Map.load().then((map: Map) => {\r\n            const data = {\r\n                version: 2,\r\n                profiles: this.client.profiles.clone(2),\r\n                settings: new Settings(),\r\n                map: map ? map.Rooms : {}\r\n            };\r\n            let keys, k;\r\n\r\n            const saveSelection = this.client.getOption('backupSave');\r\n\r\n            if ((saveSelection & BackupSelection.Map) !== BackupSelection.Map) {\r\n                delete data.map;\r\n                this.client.debug('Backup save: setting for no mapper data enabled.');\r\n            }\r\n            if ((saveSelection & BackupSelection.Profiles) !== BackupSelection.Profiles) {\r\n                delete data.profiles;\r\n                this.client.debug('Backup save: setting for no profiles enabled.');\r\n            }\r\n            if ((saveSelection & BackupSelection.Windows) !== BackupSelection.Windows) {\r\n                keys = Object.keys(data.settings);\r\n                for (k = keys.length - 1; k >= 0; k--) {\r\n                    if (keys[k].startsWith('windows.'))\r\n                        delete data.settings[keys[k]];\r\n                }\r\n                this.client.debug('Backup save: setting for no window data enabled.');\r\n            }\r\n            if ((saveSelection & BackupSelection.Settings) !== BackupSelection.Settings) {\r\n                let windows;\r\n                if ((saveSelection & BackupSelection.Windows) === BackupSelection.Windows) {\r\n                    windows = {};\r\n                    keys = Object.keys(data.settings);\r\n                    for (k = keys.length - 1; k >= 0; k--) {\r\n                        if (keys[k].startsWith('windows.'))\r\n                            windows[keys[k]] = data.settings[keys[k]];\r\n                    }\r\n                }\r\n                delete data.settings;\r\n                if ((saveSelection & BackupSelection.Windows) === BackupSelection.Windows)\r\n                    data.settings = windows;\r\n                this.client.debug('Backup save: setting for no settings data enabled.');\r\n            }\r\n            else {\r\n                //convert flat setting format to object format\r\n                let props = ['chat', 'mapper', 'profiles', 'codeEditor', 'buttons', 'find', 'display', 'extensions'];\r\n                for (let p = 0, pl = props.length; p < pl; p++) {\r\n                    let prop = {};\r\n                    if (data.settings[props[p]])\r\n                        prop = data.settings[props[p]];\r\n                    let sProp = props[p] + '.';\r\n                    keys = Object.keys(data.settings);\r\n                    for (k = keys.length - 1; k >= 0; k--) {\r\n                        if (keys[k].startsWith(sProp))\r\n                            prop[keys[k].substring(sProp.length)] = data.settings[keys[k]];\r\n                    }\r\n                    data.settings[props[p]] = prop;\r\n                }\r\n                if (!data.settings['profiles'])\r\n                    data.settings['profiles'] = { 'find': {} }\r\n                else if (!data.settings['profiles']['find'])\r\n                    data.settings['profiles']['find'] = {};\r\n                //convert to object instead of flat style\r\n                data.settings['profiles']['find'].case = Settings.getValue('profiles.find.case');\r\n                data.settings['profiles']['find'].word = Settings.getValue('profiles.find.word');\r\n                data.settings['profiles']['find'].reverse = Settings.getValue('profiles.find.reverse');\r\n                data.settings['profiles']['find'].regex = Settings.getValue('profiles.find.regex');\r\n                data.settings['profiles']['find'].selection = Settings.getValue('profiles.find.selection');\r\n                data.settings['profiles']['find'].show = Settings.getValue('profiles.find.show');\r\n                data.settings['profiles']['find'].value = Settings.getValue('profiles.find.value');\r\n                delete data.settings['profiles.find.case'];\r\n                delete data.settings['profiles.find.word'];\r\n                delete data.settings['profiles.find.reverse'];\r\n                delete data.settings['profiles.find.regex'];\r\n                delete data.settings['profiles.find.selection'];\r\n                delete data.settings['profiles.find.show'];\r\n                delete data.settings['profiles.find.value'];\r\n            }\r\n\r\n            let jData = JSON.stringify(data);\r\n            jData = LZString.compressToEncodedURIComponent(jData);\r\n            this._save = [jData.match(/((\\S|\\s|.){1,20000})/g), 0, 0];\r\n            this._save[3] = this._save[0].length;\r\n            this.saveChunk();\r\n        }).catch(err => this.client.error(err));\r\n    }\r\n\r\n    public abort(err?) {\r\n        if (err)\r\n            this.client.debug('client load/save aborted for' + err);\r\n        else\r\n            this.client.debug('client load/save aborted');\r\n        this._closeDialog();\r\n        alert_box('Aborted', err || 'Aborted importing or exporting data.', DialogIcon.exclamation);\r\n        this._save = 0;\r\n        this._abort = true;\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: this.URL,\r\n            data:\r\n            {\r\n                user: this._user,\r\n                a: 'abort'\r\n            }\r\n        });\r\n    }\r\n\r\n    public close() {\r\n        this._closeDialog();\r\n        this._save = 0;\r\n        this._abort = false;\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: this.URL,\r\n            data:\r\n            {\r\n                user: this._user,\r\n                a: 'done'\r\n            }\r\n        });\r\n    }\r\n\r\n    public getChunk() {\r\n        this.client.debug('Requesting client chunk ' + this._save[1]);\r\n        $.ajax(\r\n            {\r\n                type: 'POST',\r\n                url: this.URL,\r\n                data:\r\n                {\r\n                    user: this._user,\r\n                    a: 'get',\r\n                    c: ++this._save[1]\r\n                },\r\n                dataType: 'json',\r\n                success: (data) => {\r\n                    if (this._abort) return;\r\n                    if (!data)\r\n                        this.abort('No data returned');\r\n                    else if (data.msg)\r\n                        this.abort(data.msg || 'Error');\r\n                    else if (data.error)\r\n                        this.abort(data.error);\r\n                    else {\r\n                        this._save[1] = data.chunk || 0;\r\n                        this._save[3] += data.data || '';\r\n                        this.client.debug('Got client chunk ' + this._save[1]);\r\n                        this._updateProgress((this._save[1] + 1) / this._save[0] * 100);\r\n                        if (this._save[1] >= this._save[0] - 1)\r\n                            this.finishLoad();\r\n                        else\r\n                            this.getChunk();\r\n                    }\r\n                },\r\n                error: (data, error, errorThrown) => {\r\n                    this.abort(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    public saveChunk() {\r\n        $.ajax(\r\n            {\r\n                type: 'POST',\r\n                url: this.URL,\r\n                data:\r\n                {\r\n                    user: this._user,\r\n                    a: 'save',\r\n                    data: this._save[0].shift(),\r\n                    append: (this._save[1] > 0 ? 1 : 0)\r\n                },\r\n                dataType: 'json',\r\n                success: (data) => {\r\n                    if (!data)\r\n                        this.abort('No data returned');\r\n                    else if (data.msg !== 'Successfully saved')\r\n                        this.abort(data.msg || 'Error');\r\n                    else if (data.error)\r\n                        this.abort(data.error);\r\n                    else if (this._save[0].length > 0) {\r\n                        this._updateProgress(this._save[1] / this._save[3] * 100);\r\n                        this._save[1]++;\r\n                        this.saveChunk();\r\n                    }\r\n                    else {\r\n                        if (typeof (this._save[2]) === 'function') this._save[2]();\r\n                        client.raise('backup-saved');\r\n                        this.close();\r\n                    }\r\n                },\r\n                error: (data, error, errorThrown) => {\r\n                    this.abort(error);\r\n                }\r\n            });\r\n    }\r\n\r\n    public finishLoad() {\r\n        this.client.debug('Got last chunk, processing data');\r\n        let data = LZString.decompressFromEncodedURIComponent(this._save[3]);\r\n        data = JSON.parse(data);\r\n        if (data.version === 2) {\r\n            const loadSelection = this.client.getOption('backupLoad');\r\n            if (data.map && (loadSelection & BackupSelection.Map) === BackupSelection.Map)\r\n                this._mapper.import(data.map, client.getOption('mapper.importType'))\r\n\r\n            if (data.profiles && (loadSelection & BackupSelection.Profiles) === BackupSelection.Profiles) {\r\n                const profiles = new ProfileCollection();\r\n                const keys = Object.keys(data.profiles);\r\n                const kl = keys.length;\r\n                let n;\r\n                let k = 0;\r\n                for (; k < kl; k++) {\r\n                    n = keys[k];\r\n                    const p = new Profile(n);\r\n                    p.priority = data.profiles[keys[k]].priority;\r\n                    p.enabled = data.profiles[keys[k]].enabled ? true : false;\r\n                    p.enableMacros = data.profiles[keys[k]].enableMacros ? true : false;\r\n                    p.enableTriggers = data.profiles[keys[k]].enableTriggers ? true : false;\r\n                    p.enableAliases = data.profiles[keys[k]].enableAliases ? true : false;\r\n                    p.enableDefaultContext = data.profiles[keys[k]].enableDefaultContext ? true : false;\r\n                    p.macros = [];\r\n                    let l = data.profiles[keys[k]].macros.length;\r\n                    let item;\r\n                    if (l > 0) {\r\n                        for (let m = 0; m < l; m++) {\r\n                            item = new Macro();\r\n                            item.key = data.profiles[keys[k]].macros[m].key;\r\n                            item.value = data.profiles[keys[k]].macros[m].value;\r\n                            item.style = data.profiles[keys[k]].macros[m].style;\r\n                            item.append = data.profiles[keys[k]].macros[m].append ? true : false;\r\n                            item.send = data.profiles[keys[k]].macros[m].send ? true : false;\r\n                            item.name = data.profiles[keys[k]].macros[m].name;\r\n                            item.group = data.profiles[keys[k]].macros[m].group;\r\n                            item.enabled = data.profiles[keys[k]].macros[m].enabled ? true : false;\r\n                            item.modifiers = data.profiles[keys[k]].macros[m].modifiers;\r\n                            item.chain = data.profiles[keys[k]].macros[m].chain ? true : false;\r\n                            item.notes = data.profiles[keys[k]].macros[m].notes || '';\r\n                            p.macros.push(item);\r\n                        }\r\n                    }\r\n\r\n                    l = data.profiles[keys[k]].aliases.length;\r\n                    if (l > 0) {\r\n                        for (let m = 0; m < l; m++) {\r\n                            item = new Alias();\r\n                            item.pattern = data.profiles[keys[k]].aliases[m].pattern;\r\n                            item.value = data.profiles[keys[k]].aliases[m].value;\r\n                            item.style = data.profiles[keys[k]].aliases[m].style;\r\n                            item.multi = data.profiles[keys[k]].aliases[m].multi ? true : false;\r\n                            item.append = data.profiles[keys[k]].aliases[m].append ? true : false;\r\n                            item.name = data.profiles[keys[k]].aliases[m].name;\r\n                            item.group = data.profiles[keys[k]].aliases[m].group;\r\n                            item.enabled = data.profiles[keys[k]].aliases[m].enabled ? true : false;\r\n                            item.params = data.profiles[keys[k]].aliases[m].params;\r\n                            item.priority = data.profiles[keys[k]].aliases[m].priority;\r\n                            item.notes = data.profiles[keys[k]].aliases[m].notes || '';\r\n                            p.aliases.push(item);\r\n                        }\r\n                    }\r\n\r\n                    l = data.profiles[keys[k]].triggers.length;\r\n                    if (l > 0) {\r\n                        for (let m = 0; m < l; m++) {\r\n                            item = new Trigger();\r\n                            item.pattern = data.profiles[keys[k]].triggers[m].pattern;\r\n                            item.value = data.profiles[keys[k]].triggers[m].value;\r\n                            item.style = data.profiles[keys[k]].triggers[m].style;\r\n                            item.verbatim = data.profiles[keys[k]].triggers[m].verbatim ? true : false;\r\n                            item.name = data.profiles[keys[k]].triggers[m].name;\r\n                            item.group = data.profiles[keys[k]].triggers[m].group;\r\n                            item.enabled = data.profiles[keys[k]].triggers[m].enabled ? true : false;\r\n                            item.priority = data.profiles[keys[k]].triggers[m].priority;\r\n                            item.triggerNewline = data.profiles[keys[k]].triggers[m].triggernewline ? true : false;\r\n                            item.caseSensitive = data.profiles[keys[k]].triggers[m].caseSensitive ? true : false;\r\n                            item.triggerPrompt = data.profiles[keys[k]].triggers[m].triggerprompt ? true : false;\r\n                            item.raw = data.profiles[keys[k]].triggers[m].raw ? true : false;\r\n                            item.temp = data.profiles[keys[k]].triggers[m].temp ? true : false;\r\n                            item.type = data.profiles[keys[k]].triggers[m].type;\r\n                            item.notes = data.profiles[keys[k]].triggers[m].notes || '';\r\n                            item.state = data.profiles[keys[k]].triggers[m].state || 0;\r\n                            item.params = data.profiles[keys[k]].triggers[m].params || '';\r\n                            item.fired = data.profiles[keys[k]].triggers[m].fired ? true : false;\r\n                            if (data.profiles[keys[k]].triggers[m].triggers && data.profiles[keys[k]].triggers[m].triggers.length) {\r\n                                const il = data.profiles[keys[k]].triggers[m].triggers.length;\r\n                                for (let i = 0; i < il; i++) {\r\n                                    item.triggers.push(new Trigger(data.profiles[keys[k]].triggers[m].triggers[i]));\r\n                                }\r\n                            }\r\n                            p.triggers.push(item);\r\n                        }\r\n                    }\r\n\r\n                    if (data.profiles[keys[k]].buttons) {\r\n                        l = data.profiles[keys[k]].buttons.length;\r\n                        if (l > 0) {\r\n                            for (let m = 0; m < l; m++) {\r\n                                item = new Button(data.profiles[keys[k]].buttons[m]);\r\n                                p.buttons.push(item);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (data.profiles[keys[k]].contexts) {\r\n                        l = data.profiles[keys[k]].contexts.length;\r\n                        if (l > 0) {\r\n                            for (let m = 0; m < l; m++) {\r\n                                item = new Context(data.profiles[keys[k]].contexts[m]);\r\n                                p.contexts.push(item);\r\n                            }\r\n                        }\r\n                    }\r\n                    profiles.add(p, true);\r\n                }\r\n                profiles.update();\r\n                profiles.save().then(() => {\r\n                    this.client.loadProfiles();\r\n                });\r\n            }\r\n            let keys, k;\r\n            if ((loadSelection & BackupSelection.Settings) === BackupSelection.Settings) {\r\n                this.client.setOption('mapper.enabled', data.settings.mapEnabled ? true : false);\r\n                this.client.setOption('mapper.follow', data.settings.mapFollow ? true : false);\r\n                this.client.setOption('mapper.legend', data.settings.legend ? true : false);\r\n                this.client.setOption('mapper.split', data.settings.MapperSplitArea ? true : false);\r\n                this.client.setOption('mapper.fill', data.settings.MapperFillWalls ? true : false);\r\n                this.client.setOption('mapper.vscroll', data.settings.vscroll);\r\n                this.client.setOption('mapper.hscroll', data.settings.hscroll);\r\n                this.client.setOption('mapper.memory', data.settings.mapperMemory ? true : false);\r\n                this.client.setOption('showScriptErrors', data.settings.showScriptErrors ? true : false);\r\n                this.client.setOption('logWhat', data.settings ? Log.Html : Log.None);\r\n                this.client.setOption('showMapper', data.settings.MapperOpen ? true : false);\r\n                let p, pl;\r\n                for (p = 0, pl = SettingProperties.length; p < pl; p++) {\r\n                    let prop = SettingProperties[p];\r\n                    if (!data.settings.hasOwnProperty(prop)) {\r\n                        continue;\r\n                    }\r\n                    if (prop.startsWith('profiles.') || prop.startsWith('codeEditor.') || prop.startsWith('buttons.') || prop.startsWith('find.') || prop.startsWith('extensions.') || prop.startsWith('windows.') || prop.startsWith('profiles.'))\r\n                        continue;\r\n                    this.client.setOption(prop, data.settings[prop]);\r\n                }\r\n                if (data.settings.windows && (loadSelection & BackupSelection.Windows) === BackupSelection.Windows) {\r\n                    if (data.settings['windows']) {\r\n                        keys = Object.keys(data.settings['windows']);\r\n                        for (k = keys.length - 1; k >= 0; k--) {\r\n                            this.client.setOption(`windows.${keys[k]}`, data.settings['windows'][keys[k]]);\r\n                        }\r\n                    }\r\n                    keys = Object.keys(data.settings);\r\n                    for (k = keys.length - 1; k >= 0; k--) {\r\n                        if (keys[k].startsWith('windows.'))\r\n                            this.client.setOption(keys[k], data.settings[keys[k]]);\r\n                    }\r\n                }\r\n                //convert object format to flat format\r\n                let props = ['chat', 'mapper', 'profiles', 'codeEditor', 'buttons', 'find', 'display', 'extensions'];\r\n                for (p = 0, pl = props.length; p < pl; p++) {\r\n                    if (!data.settings[props[p]] || !data.settings.hasOwnProperty(props[p]))\r\n                        continue;\r\n                    keys = Object.keys(data.settings[props[p]]);\r\n                    for (k = keys.length - 1; k >= 0; k--) {\r\n                        this.client.setOption(`${props[p]}.${keys[k]}`, data.settings[props[p]][keys[k]]);\r\n                    }\r\n                }\r\n                //convert to flat style\r\n                if (data.settings.profiles && data.settings.profiles.find) {\r\n                    this.client.setOption(`profiles.find.case`, data.settings.profiles.find.case);\r\n                    this.client.setOption(`profiles.find.word`, data.settings.profiles.find.word);\r\n                    this.client.setOption(`profiles.find.reverse`, data.settings.profiles.find.reverse);\r\n                    this.client.setOption(`profiles.find.regex`, data.settings.profiles.find.regex);\r\n                    this.client.setOption(`profiles.find.selection`, data.settings.profiles.find.selection);\r\n                    this.client.setOption(`profiles.find.show`, data.settings.profiles.find.show);\r\n                    this.client.setOption(`profiles.find.value`, data.settings.profiles.find.value);\r\n                }\r\n                this.client.clearCache();\r\n                this.client.loadOptions();\r\n            }\r\n            else if (data.settings && (loadSelection & BackupSelection.Windows) === BackupSelection.Windows) {\r\n                if (data.settings['windows']) {\r\n                    keys = Object.keys(data.settings['windows']);\r\n                    for (k = keys.length - 1; k >= 0; k--) {\r\n                        this.client.setOption(`windows.${keys[k]}`, data.settings['windows'][keys[k]]);\r\n                    }\r\n                }\r\n                keys = Object.keys(data.settings);\r\n                for (k = keys.length - 1; k >= 0; k--) {\r\n                    if (keys[k].startsWith('windows.'))\r\n                        this.client.setOption(keys[k], data.settings[keys[k]]);\r\n                }\r\n            }\r\n        }\r\n        client.raise('backup-loaded');\r\n        this.close();\r\n    }\r\n\r\n    private _showDialog(title) {\r\n        if (this._dialogProgress)\r\n            throw new Error('Client save/load is already in progress');\r\n        this._dialogProgress = progress_box(title || 'Saving data');\r\n        this._dialogProgress.on('canceled', () => {\r\n            this.abort();\r\n        });\r\n        this._dialogProgress.on('closed', reason => {\r\n            if (reason === 'canceled')\r\n                this.abort();\r\n        });\r\n        this._dialogProgress.on('shown', () => {\r\n\r\n        });\r\n        this._dialogProgress.showModal();\r\n    }\r\n\r\n    private _closeDialog() {\r\n        if (this._dialogProgress)\r\n            this._dialogProgress.close();\r\n        this._dialogProgress = null;\r\n    }\r\n\r\n    private _updateProgress(progress) {\r\n        if (this._dialogProgress)\r\n            this._dialogProgress.progress = progress;\r\n    }\r\n\r\n    private _getMapper() {\r\n        if (this._mapper) return;\r\n        for (let p = 0, pl = this.client.plugins.length; p < pl; p++) {\r\n            if (this.client.plugins[p] instanceof Mapper) {\r\n                this._mapper = this.client.plugins[p] as Mapper;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n}", "import { Plugin } from '../../core/plugin';\r\nimport { MenuItem } from '../../core/types';\r\nimport { Client } from '../../core/client';\r\nimport { Backup } from './backup';\r\nimport { removeHash } from '../../all';\r\nimport { Dialog } from '../../interface/dialog';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        ShadowMUD;\r\n    }\r\n}\r\n\r\nexport class ShadowMUD extends Plugin {\r\n    public backup: Backup;\r\n\r\n    private _skipMoreTimeout;\r\n    private _skipMoreEvent;\r\n    private _help;\r\n\r\n    constructor(client: Client) {\r\n        super(client);\r\n        this.backup = new Backup(client);\r\n    }\r\n\r\n    public remove(): void {\r\n        this.backup.remove();\r\n        this.client.removeListenersFromCaller(this);\r\n    }\r\n    public initialize(): void {\r\n        this.client.on('add-line', data => {\r\n            if (!this._skipMoreTimeout && data.fragment && data.line.startsWith('--More--') && this.client.getOption('skipMore')) {\r\n                this._skipMoreEvent = data => {\r\n                    clearTimeout(this._skipMoreTimeout || 0);\r\n                    this._skipMoreTimeout = 0;\r\n                    this._skipMoreEvent = 0;\r\n                }\r\n                //clear skip if anything has been sent to the mud from the client\r\n                this.client.once('parse-command', this._skipMoreEvent, this);\r\n                this._skipMoreTimeout = setTimeout(() => {\r\n                    this.client.removeListener('parse-command', this._skipMoreEvent); //clear event to prevent multiple triggers and free memory\r\n                    this._skipMoreTimeout = 0;\r\n                    this._skipMoreEvent = 0;\r\n                    this.client.sendCommand('\\n');\r\n                }, this.client.getOption('skipMoreDelay') >= 0 ? this.client.getOption('skipMoreDelay') : 0);\r\n            }\r\n        }, this);\r\n        this.client.on('window', (window, args, name) => {\r\n            switch (window) {\r\n                case 'shadowmudhelp':\r\n                case 'shadowmud-help':\r\n                case 'smhelp':\r\n                    if (args === 'close') {\r\n                        if (this._help)\r\n                            this._help.close();\r\n                    }\r\n                    else\r\n                        this._showHelp();\r\n                    break;\r\n            }\r\n        }, this);\r\n        this.client.on('close-window', window => {\r\n            switch (window) {\r\n                case 'shadowmudhelp':\r\n                case 'shadowmud-help':\r\n                case 'smhelp':\r\n                    if (this._help)\r\n                        this._help.close();\r\n                    break;\r\n            }\r\n        }, this);\r\n        this.client.on('options-loaded', () => {\r\n            if (this._help) this._help.resetState(client.getWindowState('smhelp') || { center: true, width: 400, height: 275 });\r\n        });\r\n        let options = this.client.getWindowState('smhelp')\r\n        if (options && options.show)\r\n            this._showHelp();\r\n    }\r\n\r\n    private _showHelp() {\r\n        if (client.getOption('externalHelp')) {\r\n            window.open('http://www.shadowmud.com/help.php', '_blank');\r\n            return;\r\n        }\r\n        if (!this._help) {\r\n            this._help = new Dialog(Object.assign({}, client.getWindowState('smhelp') || { center: true, width: 500, height: 375 }, { title: '<i class=\"shadowmud-icon\"></i> ShadowMUD Help', id: 'smhelp', noFooter: true }));\r\n            const frame = document.createElement('iframe');\r\n            //<iframe id=\"smhelpframe\" style=\"z-index:100;border:0px;margin:0px;width:100%;height:100%;overflow:auto\" src=\"/OoMUD/smhelp.php\"></iframe>\r\n            frame.src = 'http://shadowmud.com/OoMUD/smhelp.php';\r\n            frame.id = 'smhelp-frame';\r\n            frame.classList.add('full-page');\r\n            this._help.body.append(frame);\r\n            this._help.on('closed', () => {\r\n                client.setOption('windows.smhelp', this._help.windowState);\r\n                this._help = null;\r\n                removeHash('smhelp');\r\n            });\r\n            this._help.on('canceled', () => {\r\n                client.setOption('windows.smhelp', this._help.windowState);\r\n                this._help = null;\r\n                removeHash('smhelp');\r\n            });\r\n            this._help.on('resized', e => {\r\n                client.setOption('windows.smhelp', e);\r\n            });\r\n            this._help.on('moved', e => {\r\n                client.setOption('windows.smhelp', e);\r\n            })\r\n            this._help.on('maximized', () => {\r\n                client.setOption('windows.smhelp', this._help.windowState);\r\n            });\r\n            this._help.on('restored', () => {\r\n                client.setOption('windows.smhelp', this._help.windowState);\r\n            });\r\n            this._help.on('shown', () => {\r\n                client.setOption('windows.smhelp', this._help.windowState);\r\n            });\r\n        }\r\n        this._help.show();\r\n    }\r\n\r\n    get menu(): MenuItem[] {\r\n        return [{\r\n            name: ' ShadowMUD help',\r\n            action: () => {\r\n                this._showHelp();\r\n            },\r\n            icon: '<i class=\"shadowmud-icon-light\"></i>',\r\n            position: -4\r\n        }];\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' ShadowMUD',\r\n            action: 'settings-shadowmud',\r\n            icon: '<i class=\"shadowmud-icon\"></i>',\r\n        }]\r\n    }\r\n}\r\n\r\nwindow.ShadowMUD = ShadowMUD;", "import '../css/panelbar.css';\r\nimport '../css/panelbar.theme.css';\r\nimport { Client } from '../core/client';\r\nimport { Plugin } from '../core/plugin';\r\nimport { MenuItem } from '../core/types';\r\nimport { MapDisplay } from '../interface/mapdisplay';\r\nimport { Display } from '../core/display';\r\nimport { Mapper } from './mapper';\r\nimport { Chat } from './chat';\r\nimport { Settings } from '../core/settings';\r\nimport { Splitter, Orientation, PanelAnchor } from '../interface/splitter';\r\nimport { isMobile } from '../core/library';\r\nimport { Room } from '../core/map';\r\n\r\ninterface PanelOptions {\r\n    client: Client;\r\n    chat: Chat;\r\n    mapper: Mapper;\r\n    location?: PanelBarLocation;\r\n}\r\n\r\nenum Panels {\r\n    none = 0,\r\n    map = 1 << 1,\r\n    chat = 1 << 2,\r\n    all = map | chat\r\n}\r\n\r\nenum PanelBarLocation {\r\n    left = 0,\r\n    top = 1\r\n}\r\nexport class PanelBar extends Plugin {\r\n    private _clientContainer;\r\n    private _miniMap: MapDisplay;\r\n    private _miniMapTitle: HTMLElement;\r\n    private _miniMapZoom: HTMLInputElement;\r\n    private _chatDisplay: Display;\r\n    private _mapper: Mapper;\r\n    private _chat: Chat;\r\n    private _panel: HTMLElement;\r\n    private _splitterDistance;\r\n    private _dragging = false;\r\n    private _move;\r\n    private _splitter: Splitter;\r\n    private _panelLocation: PanelBarLocation = PanelBarLocation.top;\r\n    private _zTimeout;\r\n\r\n    get location(): PanelBarLocation {\r\n        return this._panelLocation;\r\n    }\r\n    set location(value: PanelBarLocation) {\r\n        if (value === this._panelLocation) return;\r\n        if (this._panelLocation === PanelBarLocation.top) {\r\n            this._clientContainer.style.top = '';\r\n            this._panel.style.height = '';\r\n            this._panel.style.right = '';\r\n            document.getElementById('panel-bar-drag-bar').style.right = '';\r\n        }\r\n        else {\r\n            this._clientContainer.style.left = '';\r\n            this._panel.style.width = '';\r\n        }\r\n        this._panelLocation = value;\r\n        this._panel.dataset.location = '' + value;\r\n        document.getElementById('panel-bar-drag-bar').dataset.location = '' + value;\r\n        this._splitter.orientation = this._panelLocation === PanelBarLocation.left ? Orientation.horizontal : Orientation.vertical;\r\n        this._updateInterface();\r\n    }\r\n\r\n    constructor(options?: PanelOptions | Client) {\r\n        super(options instanceof Client ? options : options?.client);\r\n        if (options) {\r\n            if ((<PanelOptions>options).mapper && (<PanelOptions>options).mapper instanceof Mapper)\r\n                this._mapper = (<PanelOptions>options).mapper;\r\n            if ((<PanelOptions>options).chat && (<PanelOptions>options).chat instanceof Chat)\r\n                this._chat = (<PanelOptions>options).chat;\r\n        }\r\n        if (options && 'location' in options)\r\n            this._panelLocation = options.location;\r\n        if (!Settings.exist('showPanelBar'))\r\n            this.client.setOption('showPanelBar', !isMobile());\r\n        if (!Settings.exist('panelBar.panels'))\r\n            this.client.setOption('panelBar.panels', Panels.all);\r\n        if (!Settings.exist('panelBar.location'))\r\n            this.client.setOption('panelBar.location', isMobile() ? PanelBarLocation.left : PanelBarLocation.top);\r\n        if (!Settings.exist('panelBar.order'))\r\n            this.client.setOption('panelBar.order', 0);\r\n        if (!Settings.exist('panelBar.mapScale'))\r\n            this.client.setOption('panelBar.mapScale', 100);\r\n        this._clientContainer = document.getElementById('client-container');\r\n        this._createSidebar();\r\n    }\r\n\r\n    private _createSidebar() {\r\n        document.body.insertAdjacentHTML('beforeend', `<div id=\"panel-bar-drag-bar\" data-location=\"${this._panelLocation}\"></div><div id=\"panel-bar\" data-location=\"${this._panelLocation}\"><button id=\"panel-bar-close\" style=\"padding: 4px;\" type=\"button\"\r\n        class=\"button button-sm btn-close\" title=\"Hide panel bar\"></button></div>`);\r\n        this._panel = document.getElementById('panel-bar');\r\n        this._splitter = new Splitter({ id: 'panel-bar', parent: this._panel, orientation: this._panelLocation === PanelBarLocation.left ? Orientation.horizontal : Orientation.vertical, anchor: PanelAnchor.panel1 });\r\n        this._splitter.splitterWidth = 3;\r\n        this._splitter.live = false;\r\n        if (this.client.getOption('panelBar.separator') >= 200)\r\n            this._splitter.SplitterDistance = this.client.getOption('panelBar.separator');\r\n        this._splitter.on('splitter-moved', distance => {\r\n            this.client.setOption('panelBar.separator', distance);\r\n        });\r\n    }\r\n\r\n    public remove(): void {\r\n        this._clearMapper();\r\n        this._clearChat();\r\n        this.client.removeListenersFromCaller(this);\r\n        this.client.display.removeListenersFromCaller(this);\r\n    }\r\n    public initialize(): void {\r\n        this._findPlugins();\r\n        this._initChat();\r\n        this._initMapper();\r\n        this.client.on('plugin-added', plugin => {\r\n            if (!this._chat && plugin instanceof Chat) {\r\n                this._chat = plugin;\r\n                this._initChat();\r\n            }\r\n            if (!this._mapper && plugin instanceof Mapper) {\r\n                this._mapper = plugin;\r\n                this._initMapper();\r\n            }\r\n        }, this);\r\n        this.client.on('plugin-removed', plugin => {\r\n            if (this._chat === plugin) {\r\n                this._clearChat();\r\n                this._chat = null;\r\n            }\r\n            if (this._mapper === plugin) {\r\n                this._clearMapper();\r\n                this._mapper = null;\r\n            }\r\n        }, this);\r\n        this.client.on('options-loaded', () => {\r\n            let w = client.getOption('panelBarSize');\r\n            if (w > this.maxWidth) w = this.maxWidth;\r\n            //Always want min width even if maxWidth is smaller\r\n            if (w < 184 && w != -1) w = 184;\r\n            this.splitterDistance = w;\r\n            this._updateInterface();\r\n            this._loadOptions();\r\n            this._updateMenuItem();\r\n        }, this);\r\n        this.client.on('option-changed', (name: string, value) => {\r\n            if (name.startsWith('mapper.') || name.startsWith('chat.') || name === 'commandDelay' || name === 'commandDelayCount' || name === 'enableMXP' || name === 'enableURLDetection' || name === 'display.showInvalidMXPTags' || name === 'display.hideTrailingEmptyLine') {\r\n                this._loadOptions();\r\n                this._updateMenuItem();\r\n            }\r\n        });\r\n        this.client.display.on('resize', () => {\r\n            this._updateInterface();\r\n        }, this);\r\n        document.getElementById('panel-bar-drag-bar').addEventListener('mousedown', (e: MouseEvent) => {\r\n            if (e.button !== 0) return;\r\n            e.preventDefault();\r\n            this._dragging = true;\r\n            const main = document.getElementById('panel-bar-drag-bar');\r\n            let d = 'width';\r\n            let l = 'left';\r\n            let c = 'pageX';\r\n            let b = 'right';\r\n            if (this._panelLocation === PanelBarLocation.top) {\r\n                d = 'height';\r\n                l = 'top';\r\n                c = 'pageY';\r\n                b = 'bottom';\r\n            }\r\n\r\n            const w = this._panel.style[d];\r\n            this._panel.style[d] = '';\r\n            const bounds = this._panel.getBoundingClientRect();\r\n            this._panel.style[d] = w;\r\n            const bounds2 = main.getBoundingClientRect();\r\n            const ghostBar = document.createElement('div');\r\n\r\n            ghostBar.id = 'panel-bar-ghost-bar';\r\n            if (this._panelLocation === PanelBarLocation.top) {\r\n                ghostBar.style.left = '0';\r\n                ghostBar.style.right = '0';\r\n                ghostBar.style.top = bounds2.top + 'px';\r\n                ghostBar.style.cursor = 'ns-resize';\r\n                ghostBar.style.right = this._clientContainer.style.right;\r\n            }\r\n            else {\r\n                ghostBar.style.top = '0';\r\n                ghostBar.style.bottom = '0';\r\n                ghostBar.style.left = bounds2.left + 'px';\r\n                ghostBar.style.cursor = 'ew-resize';\r\n            }\r\n            ghostBar.dataset.location = '' + this._panelLocation;\r\n\r\n            document.body.append(ghostBar);\r\n            //Use max with unless minWidth is larger\r\n            const maxWidth = Math.max(this.maxWidth, bounds[d]);\r\n            this._move = e => {\r\n                if (e[c] >= maxWidth)\r\n                    ghostBar.style[l] = maxWidth + 'px';\r\n                else if (e[c] < bounds[b])\r\n                    ghostBar.style[l] = bounds[b] + 'px';\r\n                else\r\n                    ghostBar.style[l] = e[c] + 'px';\r\n            }\r\n            document.addEventListener('mousemove', this._move);\r\n        });\r\n\r\n        window.addEventListener('resize', () => this.resize());\r\n        document.addEventListener('mouseup', e => {\r\n            if (!this._dragging) return;\r\n            let d = 'width';\r\n            let c = 'pageX';\r\n            let b = 'right';\r\n            if (this._panelLocation === PanelBarLocation.top) {\r\n                d = 'height';\r\n                c = 'pageY';\r\n                b = 'bottom';\r\n            }\r\n\r\n            const w = this._panel.style[d];\r\n            this._panel.style[d] = '';\r\n            const minWidth = this._panel.getBoundingClientRect()[b];\r\n            const bh = document.getElementById('panel-bar-drag-bar').getBoundingClientRect()[d];\r\n            const maxWidth = Math.max(this.maxWidth, minWidth);\r\n            this._panel.style[d] = w;\r\n            if (e[c] >= maxWidth)\r\n                this.splitterDistance = maxWidth;\r\n            else if (e[c] < minWidth)\r\n                this.splitterDistance = minWidth;\r\n            else\r\n                this.splitterDistance = e[c] - bh;\r\n            document.getElementById('panel-bar-ghost-bar').remove();\r\n            document.removeEventListener('mousemove', this._move);\r\n            this._dragging = false;\r\n            this._updateInterface();\r\n        });\r\n        document.getElementById('panel-bar-close').addEventListener('click', () => {\r\n            this.client.setOption('showPanelBar', false);\r\n            this._updateInterface();\r\n            this._updateMenuItem();\r\n        });\r\n        let w = client.getOption('panelBarSize');\r\n        if (w > this.maxWidth) w = this.maxWidth;\r\n        if (w < 184 && w != -1) w = 184;\r\n        this.splitterDistance = w;\r\n        this._updateSplitter();\r\n        this._updateInterface();\r\n        this._miniMapTitle = document.createElement('div');\r\n        this._miniMapTitle.id = 'mini-map-title';\r\n        this._miniMapZoom = document.createElement('input');\r\n        this._miniMapZoom.id = 'mini-map-zoom';\r\n        this._miniMapZoom.classList.add('form-range');\r\n        this._miniMapZoom.type = 'range';\r\n        this._miniMapZoom.min = '25';\r\n        this._miniMapZoom.max = '300';\r\n        this._miniMapZoom.step = '5';\r\n        this._miniMapZoom.addEventListener('input', e => {\r\n            this._miniMap.scale = +(e.currentTarget as HTMLInputElement).value;\r\n            this._displayScale();\r\n        });\r\n        this._miniMap = new MapDisplay(document.createElement('div'), { map: this._mapper ? this._mapper.map : null });\r\n        this._miniMap.showNavigation = false;\r\n        this._miniMap.container.classList.add('mini-map', 'map', 'panel-container');\r\n        this._miniMap.container.insertAdjacentHTML('afterbegin', '<button id=\"btn-mini-map-focus\" type=\"button\" class=\"float-start me-2 button button-sm\" title=\"Focus on current room\"><i class=\"fa fa-crosshairs\"></i></button>');\r\n        this._miniMap.container.querySelector('#btn-mini-map-focus').addEventListener('click', () => {\r\n            this._miniMap.focusCurrentRoom();\r\n        });\r\n        this._miniMap.on('active-room-changed', room => {\r\n            this._setMapTitle(room ? room.area : '');\r\n        });\r\n        this._miniMap.on('current-changed', room => {\r\n            this._setMapTitle(room ? room.area : '');\r\n        });\r\n        this._miniMap.on('setting-changed', (setting, value) => {\r\n            if (setting === 'scale') {\r\n                this._miniMapZoom.value = value;\r\n                this._displayScale();\r\n                this.client.setOption(`panelBar.mapScale`, value);\r\n            }\r\n        });\r\n        this._miniMap.active = new Room(client.getOption('mapper.active'));\r\n        this._miniMap.active.num = this._miniMap.active.num || (this._miniMap.active as any).ID;\r\n        this._chatDisplay = new Display(document.createElement('div'));\r\n        this._chatDisplay.on('split-move-done', (h) => {\r\n            this.client.setOption('chat.splitHeight', h);\r\n        });\r\n        this._chatDisplay.container.classList.add('panel-container');\r\n        this._updateOrder();\r\n        const toolbar = document.createElement('div');\r\n        toolbar.id = 'panel-bar-chat-toolbar';\r\n        toolbar.classList.add('navbar', 'bg-light', 'align-items-center');\r\n        toolbar.innerHTML = '<form class=\"container-fluid justify-content-start\"><button id=\"btn-chat-panel-clear\" type=\"button\" class=\"ms-2 me-2 button button-sm\" title=\"Clear display\"><i class=\"bi bi-trash\"></i></button><button id=\"btn-chat-panel-lock\" type=\"button\" class=\"me-2  button button-sm\" title=\"Lock display\"><i class=\"bi bi-lock-fill\"></i></button><div class=\"vr me-2\" style=\"height: 29px;\"></div><button id=\"btn-chat-panel-wrap\" type=\"button\" class=\"me-2  button button-sm\" title=\"Toggle word wrap\"><i class=\"bi bi-text-wrap\"></i></button></form>';\r\n        this._chatDisplay.container.append(toolbar);\r\n\r\n        toolbar.querySelector('#btn-chat-panel-clear').addEventListener('click', () => {\r\n            this._chatDisplay.clear();\r\n        });\r\n        toolbar.querySelector('#btn-chat-panel-lock').addEventListener('click', () => {\r\n            this.client.setOption('chat.scrollLocked', !this.client.getOption('chat.scrollLocked'));\r\n            this._chatDisplay.scrollLock = this.client.getOption('chat.scrollLocked');\r\n            this._updateScrollLockButton(toolbar.querySelector('#btn-chat-panel-lock'), this.client.getOption('chat.scrollLocked'));\r\n        });\r\n\r\n        toolbar.querySelector('#btn-chat-panel-wrap').addEventListener('click', () => {\r\n            this.client.setOption('chat.wordWrap', !this.client.getOption('chat.wordWrap'));\r\n            this._updateButtonState(toolbar.querySelector('#btn-chat-panel-wrap'), this.client.getOption('chat.wordWrap'));\r\n            this._chatDisplay.wordWrap = this.client.getOption('chat.wordWrap');\r\n        });\r\n        if (this._miniMap.map)\r\n            this._setMapTitle(this._miniMap.current ? this._miniMap.current.area : '');\r\n        this._loadOptions();\r\n    }\r\n    get menu(): MenuItem[] {\r\n        return [{\r\n            name: '-',\r\n            position: 5,\r\n            exists: '#menu-plugins',\r\n            id: 'plugins'\r\n        },\r\n        {\r\n            id: 'panel-bar',\r\n            name: this.client.getOption('showPanelBar') ? ' Hide panel bar' : ' Show panel bar',\r\n            active: this.client.getOption('showPanelBar'),\r\n            action: e => {\r\n                this.client.setOption('showPanelBar', !this.client.getOption('showPanelBar'));\r\n                this._updateInterface();\r\n                this._updateMenuItem();\r\n            },\r\n            icon: '<i class=\"bi bi-layout-sidebar\"></i>',\r\n            position: '#menu-plugins',\r\n            hidden: this.client.getOption('panelBar.panels') === Panels.none\r\n        }];\r\n    }\r\n    get settings(): MenuItem[] {\r\n        return [{\r\n            name: ' Panel bar',\r\n            action: 'settings-panelBar',\r\n            icon: '<i class=\"bi bi-layout-sidebar\"></i>',\r\n            position: 'a[href=\"#settings-specialCharacters\"]'\r\n        }]\r\n    }\r\n\r\n    private _findPlugins() {\r\n        if (this._chat && this._mapper) return;\r\n        for (let p = 0, pl = this.client.plugins.length; p < pl; p++) {\r\n            if (!this._chat && this.client.plugins[p] instanceof Chat) {\r\n                this._chat = this.client.plugins[p] as Chat;\r\n            }\r\n            if (!this._mapper && this.client.plugins[p] instanceof Mapper) {\r\n                this._mapper = this.client.plugins[p] as Mapper;\r\n            }\r\n        }\r\n    }\r\n\r\n    private _initChat() {\r\n        if (!this._chat) return;\r\n        this._chat.on('update-chat', data => {\r\n            if (this._chatDisplay) {\r\n                if (typeof data === 'string')\r\n                    this._chatDisplay.append(data);\r\n                else\r\n                    this._chatDisplay.model.appendLines([data]);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    private _initMapper() {\r\n        if (!this._mapper) return;\r\n        this._mapper.on('map-loaded', () => {\r\n            if (this._miniMap) {\r\n                this._miniMap.map = this._mapper.map;\r\n                this._setMapTitle(this._miniMap.active ? this._miniMap.active.area : '');\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    private _clearMapper() {\r\n        if (!this._mapper) return;\r\n        this._mapper.map.removeListenersFromCaller(this);\r\n        this._mapper.removeListenersFromCaller(this);\r\n    }\r\n\r\n    private _clearChat() {\r\n        if (!this._chat) return;\r\n        this._chat.removeListenersFromCaller(this);\r\n    }\r\n\r\n    get splitterDistance(): number { return this._splitterDistance; }\r\n    set splitterDistance(value: number) {\r\n        if (value === this._splitterDistance) return;\r\n        this._splitterDistance = value;\r\n        this._updateSplitter();\r\n    }\r\n\r\n    get maxWidth() {\r\n        if (this._panelLocation === PanelBarLocation.top)\r\n            return Math.floor(document.body.clientHeight * 0.33);\r\n        return Math.floor(document.body.clientWidth * 0.33);\r\n    }\r\n\r\n    private _updateSplitter() {\r\n        if (!this._splitterDistance || this._splitterDistance < 1) {\r\n            const bounds = this._panel.getBoundingClientRect();\r\n            if (this._panelLocation === PanelBarLocation.top)\r\n                this._splitterDistance = bounds.bottom;\r\n            else\r\n                this._splitterDistance = bounds.right;\r\n        }\r\n        this._updateInterface()\r\n        this.client.setOption('panelBarSize', this._splitterDistance);\r\n        this.emit('split-moved', this._splitterDistance);\r\n    }\r\n\r\n    public resize() {\r\n        if (!this.client.getOption('showPanelBar') || this.client.getOption('panelBar.panels') === Panels.none) return;\r\n        let d = 'width';\r\n        let b = 'right';\r\n        if (this._panelLocation === PanelBarLocation.top) {\r\n            d = 'height';\r\n            b = 'bottom';\r\n        }\r\n\r\n        const w = this._panel.style[d];\r\n        this._panel.style[d] = '';\r\n        const minWidth = this._panel.getBoundingClientRect()[b];\r\n        const maxWidth = Math.max(this.maxWidth, minWidth);\r\n        this._panel.style[d] = w;\r\n        const bounds = this._panel.getBoundingClientRect();\r\n        if (bounds[d] < minWidth) {\r\n            this.splitterDistance = minWidth;\r\n        }\r\n        else if (bounds[d] > maxWidth) {\r\n            this.splitterDistance = maxWidth;\r\n        }\r\n    }\r\n\r\n    private _updateInterface() {\r\n        if (!this.client.getOption('showPanelBar') || this.client.getOption('panelBar.panels') === Panels.none) {\r\n            if (this._panelLocation === PanelBarLocation.top)\r\n                this._clientContainer.style.top = '';\r\n            else\r\n                this._clientContainer.style.left = '';\r\n            this._panel.style.visibility = 'hidden';\r\n            this._panel.style.display = 'none';\r\n            document.getElementById('panel-bar-drag-bar').style.display = 'none';\r\n            this.emit('updated-interface');\r\n            return;\r\n        }\r\n        if (this._panelLocation === PanelBarLocation.top) {\r\n            this._clientContainer.style.top = this._splitterDistance + 'px';\r\n            this._panel.style.height = this._splitterDistance + 'px';\r\n            this._panel.style.right = this._clientContainer.style.right;\r\n            document.getElementById('panel-bar-drag-bar').style.right = this._clientContainer.style.right;\r\n            document.getElementById('panel-bar-drag-bar').style.top = this.splitterDistance + 'px'\r\n        }\r\n        else {\r\n            this._clientContainer.style.left = this._splitterDistance + 'px';\r\n            this._panel.style.width = this._splitterDistance + 'px';\r\n            this._panel.style.right = '';\r\n            document.getElementById('panel-bar-drag-bar').style.left = this.splitterDistance + 'px'\r\n        }\r\n        this._panel.style.visibility = '';\r\n        this._panel.style.display = '';\r\n        document.getElementById('panel-bar-drag-bar').style.display = '';\r\n        this.emit('updated-interface');\r\n    }\r\n\r\n    private _loadDisplayOptions(display) {\r\n        if (!display) return;\r\n        display.updateFont(client.getOption('chat.font'), client.getOption('chat.fontSize'));\r\n        display.maxLines = client.getOption('chat.bufferSize');\r\n        display.enableFlashing = client.getOption('chat.flashing');\r\n        display.showTimestamp = client.getOption('chat.showTimestamp');\r\n        display.timestampFormat = client.getOption('chat.timestampFormat');\r\n        display.enableMXP = client.getOption('enableMXP');\r\n        display.enableURLDetection = client.getOption('enableURLDetection');\r\n        display.showInvalidMXPTags = client.getOption('display.showInvalidMXPTags');\r\n        display.hideTrailingEmptyLine = client.getOption('display.hideTrailingEmptyLine');\r\n        display.enableColors = client.getOption('chat.enableColors');\r\n        display.enableBackgroundColors = client.getOption('chat.enableBackgroundColors');\r\n        display.tabWidth = client.getOption('chat.tabWidth');\r\n        display.displayControlCodes = client.getOption('chat.displayControlCodes');\r\n        display.emulateTerminal = client.getOption('chat.emulateTerminal');\r\n        display.emulateControlCodes = client.getOption('chat.emulateControlCodes');\r\n        display.wordWrap = client.getOption('chat.wordWrap');\r\n        display.wrapAt = client.getOption('chat.wrapAt');\r\n        display.indent = client.getOption('chat.indent');\r\n        display.scrollLock = client.getOption('chat.scrollLocked');\r\n\r\n        //display.enableSplit = client.getOption('chat.split');\r\n        //display.splitLive = client.getOption('chat.splitLive');\r\n        //display.splitHeight = client.getOption('chat.splitHeight');\r\n\r\n        display.scrollDisplay();\r\n    }\r\n\r\n    private _loadOptions() {\r\n        this._loadDisplayOptions(this._chatDisplay);\r\n        this._miniMap.commandDelay = client.getOption('commandDelay');\r\n        this._miniMap.commandDelayCount = client.getOption('commandDelayCount');\r\n        this._miniMap.enabled = this.client.getOption('mapper.enabled');\r\n        this._miniMap.follow = this.client.getOption('mapper.follow');\r\n        this._miniMap.splitArea = this.client.getOption('mapper.split');\r\n        this._miniMap.fillWalls = this.client.getOption('mapper.fill');\r\n        this._miniMap.scale = this.client.getOption('panelBar.mapScale');\r\n        if (this._miniMap.follow)\r\n            this._miniMap.focusCurrentRoom();\r\n        this._splitter.panel1Collapsed = (this.client.getOption('panelBar.panels') & Panels.map) !== Panels.map;\r\n        this._splitter.panel2Collapsed = (this.client.getOption('panelBar.panels') & Panels.chat) !== Panels.chat;\r\n        this.location = this.client.getOption('panelBar.location');\r\n        this._updateOrder();\r\n        this._updateScrollLockButton(this._splitter.panel2.querySelector('#btn-chat-panel-lock'), this.client.getOption('chat.scrollLocked'));\r\n        this._updateButtonState(this._splitter.panel2.querySelector('#btn-chat-panel-wrap'), this.client.getOption('chat.wordWrap'));\r\n    }\r\n\r\n    private _updateMenuItem() {\r\n        let button = document.querySelector('#menu-panel-bar') as HTMLElement;\r\n        if (client.getOption('showPanelBar')) {\r\n            button.title = 'Hide panel bar';\r\n            button.classList.add('active');\r\n            document.querySelector('#menu-panel-bar a span').textContent = ' Hide panel bar';\r\n        }\r\n        else {\r\n            button.title = 'Show panel bar';\r\n            button.classList.remove('active');\r\n            document.querySelector('#menu-panel-bar a span').textContent = ' Show panel bar';\r\n        }\r\n        if (this.client.getOption('panelBar.panels') === Panels.none) {\r\n            button.style.display = 'none';\r\n            button.style.visibility = 'hidden';\r\n        }\r\n        else {\r\n            button.style.display = 'list-item';\r\n            button.style.visibility = 'visible';\r\n        }\r\n    }\r\n\r\n    private _updateScrollLockButton(button: HTMLElement, state) {\r\n        if (!button) return;\r\n        let icon = button.firstElementChild;\r\n        if (state) {\r\n            button.title = 'Unlock display';\r\n            button.classList.add('active');\r\n            icon.classList.add('bi-unlock-fill');\r\n            icon.classList.remove('bi-lock-fill');\r\n        }\r\n        else {\r\n            button.title = 'Lock display';\r\n            button.classList.remove('active');\r\n            icon.classList.remove('bi-unlock-fill');\r\n            icon.classList.add('bi-lock-fill');\r\n        }\r\n    }\r\n\r\n    private _updateButtonState(button: HTMLElement, state) {\r\n        if (!button) return;\r\n        if (state)\r\n            button.classList.add('active');\r\n        else\r\n            button.classList.remove('active');\r\n    }\r\n\r\n    private _setMapTitle(title) {\r\n        this._miniMapTitle.textContent = title || '';\r\n    }\r\n\r\n    private _updateOrder() {\r\n        this._panel.dataset.order = '' + this.client.getOption('panelBar.order');\r\n        if (this.client.getOption('panelBar.order') === 1) {\r\n            this._splitter.panel2.append(this._miniMap.container);\r\n            this._splitter.panel1.append(this._chatDisplay.container);\r\n        }\r\n        else {\r\n            this._splitter.panel1.append(this._miniMap.container);\r\n            this._splitter.panel2.append(this._chatDisplay.container);\r\n        }\r\n        this._miniMap.container.insertAdjacentElement('beforebegin', this._miniMapTitle);\r\n        this._miniMap.container.insertAdjacentElement('beforebegin', this._miniMapZoom);\r\n    }\r\n\r\n    private _displayScale() {\r\n        let el = document.getElementById('mini-map-display');\r\n        if (el)\r\n            el.textContent = this._miniMap.scale + '%';\r\n        else\r\n            this._miniMapZoom.parentElement.insertAdjacentHTML('beforeend', `<label id=\"mini-map-display\">${this._miniMap.scale}%</label>`);\r\n        clearTimeout(this._zTimeout);\r\n        this._zTimeout = setTimeout(() => document.getElementById('mini-map-display').remove(), 1500);\r\n    }\r\n}", "import '../css/client.css';\r\nimport { EventEmitter } from './events';\r\nimport { Telnet } from './telnet';\r\nimport { AnsiColorCode } from './ansi';\r\nimport { SortItemArrayByPriority, selectAll, getParameterByName } from './library';\r\nimport { Settings } from './settings';\r\nimport { Input } from './input';\r\nimport { ProfileCollection, Alias, Trigger, Alarm, Macro, Profile, Button, Context, TriggerType, SubTriggerTypes } from './profile';\r\nimport { Display } from './display';\r\nimport { Plugin } from './plugin';\r\nimport { version } from '../../package.json'\r\n\r\n//import core plugins\r\nimport { MSP } from '../plugins/msp';\r\nimport { Test } from '../plugins/test';\r\nimport { Mapper } from '../plugins/mapper';\r\nimport { Status } from '../plugins/status';\r\nimport { Logger } from '../plugins/logger';\r\nimport { Chat } from '../plugins/chat';\r\nimport { ShadowMUD } from '../plugins/ShadowMUD/shadowmud';\r\nexport { ShadowMUD };\r\nimport { PanelBar } from '../plugins/panelbar';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        Client;\r\n        client: Client;\r\n        oiMUD: Client;\r\n        Display;\r\n        Test;\r\n        Dialog;\r\n    }\r\n}\r\ndeclare let moment;\r\ndeclare let localforage;\r\n\r\ninterface ClientOptions {\r\n    display: HTMLInputElement | JQuery | string;\r\n    commandInput: HTMLTextAreaElement | JQuery | string;\r\n    host?: string;\r\n    port?: number;\r\n    scheme?: string;\r\n    protocol?: string;\r\n}\r\n\r\ninterface ItemCache {\r\n    alarmPatterns: any[];\r\n    alarms: Trigger[];\r\n    triggers: Trigger[];\r\n    aliases: Alias[];\r\n    macros: Macro[];\r\n    buttons: Button[];\r\n    contexts: Context[];\r\n    defaultContext: boolean;\r\n}\r\n\r\n/**\r\n * Mud client\r\n *\r\n * @export\r\n * @class Client\r\n * @extends {EventEmitter}\r\n */\r\nexport class Client extends EventEmitter {\r\n    //#region Private properties\r\n    private _enableDebug: boolean = false;\r\n    private _input: Input;\r\n    private _telnet: Telnet;\r\n    private _itemCache: ItemCache = {\r\n        triggers: null,\r\n        aliases: null,\r\n        macros: null,\r\n        buttons: null,\r\n        contexts: null,\r\n        defaultContext: null,\r\n        alarms: null,\r\n        alarmPatterns: []\r\n    }\r\n    private _alarm;\r\n    private _commandInput: HTMLTextAreaElement;\r\n    private _display: Display;\r\n    private _profiles: ProfileCollection;\r\n    private _variables = {};\r\n    private _plugins: Plugin[];\r\n    private _options: any = {};\r\n    private _autoConnectID;\r\n    //#endregion\r\n    //#region Public properties\r\n    public active: boolean = true;\r\n    public connecting: boolean = false;\r\n    public version: string = version;\r\n    public connectTime: number = 0;\r\n    public disconnectTime: number = 0;\r\n    public lastSendTime: number = 0;\r\n    public defaultTitle = 'oiMUD';\r\n    //#endregion\r\n    //#region Public setter/getters\r\n    public get telnet(): Telnet { return this._telnet; }\r\n    public get variables() { return this._variables; }\r\n    public get commandInput(): HTMLTextAreaElement { return this._commandInput; }\r\n    public get display(): Display { return this._display; }\r\n    public get profiles(): ProfileCollection { return this._profiles; }\r\n    public get plugins(): Plugin[] { return this._plugins; }\r\n    public get options(): Settings { return this._options; }\r\n    public get input(): Input { return this._input; }\r\n\r\n\r\n    set simpleAlarms(value) {\r\n        this.setOption('simpleAlarms', value);\r\n    }\r\n\r\n    get simpleAlarms() { return this.getOption('simpleAlarms'); }\r\n\r\n    set enableParsing(value) {\r\n        this.setOption('enableParsing', value);\r\n        this._input.enableParsing = value;\r\n    }\r\n\r\n    get enableParsing() { return this.getOption('enableParsing'); }\r\n\r\n    set enableTriggers(value) {\r\n        this.setOption('enableTriggers', value);\r\n        this._input.enableTriggers = value;\r\n        this.startAlarms();\r\n    }\r\n\r\n    get enableTriggers() { return this.getOption('enableTriggers'); }\r\n\r\n    get enableDebug(): boolean {\r\n        return this._enableDebug;\r\n    }\r\n\r\n    set enableDebug(enable: boolean) {\r\n        this._enableDebug = enable;\r\n        this._telnet.enableDebug = enable;\r\n        this._display.enableDebug = enable;\r\n    }\r\n\r\n    get host(): string {\r\n        return this._telnet.host;\r\n    }\r\n    set host(host: string) {\r\n        this._telnet.host = host;\r\n    }\r\n\r\n    get port(): number {\r\n        return this._telnet.port;\r\n    }\r\n    set port(port: number) {\r\n        this._telnet.port = port;\r\n    }\r\n\r\n    get connected(): boolean {\r\n        return this._telnet.connected;\r\n    }\r\n\r\n    public get activeProfile() {\r\n        return this._profiles.active;\r\n    };\r\n\r\n    public get commandHistory() {\r\n        return this._input.commandHistory;\r\n    }\r\n\r\n    public get indices() {\r\n        return this._input.indices;\r\n    }\r\n\r\n    public get repeatnum() {\r\n        return this._input.repeatnum;\r\n    }\r\n\r\n    get aliases(): Alias[] {\r\n        if (this._itemCache.aliases)\r\n            return this._itemCache.aliases;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableAliases)\r\n                this._itemCache.aliases = [];\r\n            else\r\n                this._itemCache.aliases = SortItemArrayByPriority(this.profiles.items[keys[k]].aliases);\r\n            return this._itemCache.aliases;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableAliases || this.profiles.items[keys[k]].aliases.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].aliases));\r\n        }\r\n        this._itemCache.aliases = tmp;\r\n        return this._itemCache.aliases;\r\n    }\r\n\r\n    get macros(): Macro[] {\r\n        if (this._itemCache.macros)\r\n            return this._itemCache.macros;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableMacros)\r\n                this._itemCache.macros = [];\r\n            else\r\n                this._itemCache.macros = SortItemArrayByPriority(this.profiles.items[keys[k]].macros);\r\n            return this._itemCache.macros;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableMacros || this.profiles.items[keys[k]].macros.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].macros));\r\n        }\r\n        this._itemCache.macros = tmp;\r\n        return this._itemCache.macros;\r\n    }\r\n\r\n    get triggers(): Trigger[] {\r\n        if (this._itemCache.triggers)\r\n            return this._itemCache.triggers;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                this._itemCache.triggers = [];\r\n            else\r\n                this._itemCache.triggers = SortItemArrayByPriority(this.profiles.items[keys[0]].triggers);\r\n            return this._itemCache.triggers;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].triggers));\r\n        }\r\n        this._itemCache.triggers = tmp;\r\n        return this._itemCache.triggers;\r\n    }\r\n\r\n    public removeTrigger(trigger: Trigger) {\r\n        const keys = this.profiles.keys;\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        let idx = -1;\r\n        if (kl === 0)\r\n            return;\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                return;\r\n            idx = this.profiles.items[keys[k]].triggers.indexOf(trigger);\r\n        }\r\n        else\r\n            for (; k < kl && idx !== -1; k++) {\r\n                if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                    continue;\r\n                idx = this.profiles.items[keys[k]].triggers.indexOf(trigger);\r\n                //found trigger bail, or it will keep looking and k index will be wrong profile\r\n                if (idx !== -1)\r\n                    break;\r\n            }\r\n        //check to be sure trigger found\r\n        if (idx === -1)\r\n            return;\r\n        this.profiles.items[keys[k]].triggers.splice(idx, 1);\r\n        this._itemCache.triggers = null;\r\n        //an alarm or has sub types see if cached\r\n        if ((trigger.triggers.length || trigger.type === TriggerType.Alarm) && this._itemCache.alarms) {\r\n            idx = this._itemCache.alarms.indexOf(trigger);\r\n            if (idx !== -1) {\r\n                this._itemCache.alarms.splice(idx, 1);\r\n                this._itemCache.alarmPatterns.splice(idx, 1);\r\n            }\r\n        }\r\n        this.saveProfiles();\r\n        this.emit('item-removed', 'trigger', keys[k], idx, trigger);\r\n    }\r\n\r\n    get alarms(): Trigger[] {\r\n        if (this._itemCache.alarms)\r\n            return this._itemCache.alarms;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableTriggers)\r\n                this._itemCache.alarms = [];\r\n            else\r\n                this._itemCache.alarms = SortItemArrayByPriority(this.profiles.items[keys[k]].triggers).filter((a: Trigger) => {\r\n                    //has sub triggers of type alarm so cache them for future use as well\r\n                    if (a && a.enabled && a.triggers.length) {\r\n                        if (a.type === TriggerType.Alarm) return true;\r\n                        //loop sub states if one is alarm cache it for future\r\n                        for (let s = 0, sl = a.triggers.length; s < sl; s++)\r\n                            if (a.triggers[s].enabled && a.triggers[s].type === TriggerType.Alarm)\r\n                                return true;\r\n                        return false;\r\n                    }\r\n                    return a && a.enabled && a.type === TriggerType.Alarm;\r\n                });\r\n            this._itemCache.alarms.reverse();\r\n            return this._itemCache.alarms;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableTriggers || this.profiles.items[keys[k]].triggers.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].triggers));\r\n        }\r\n        this._itemCache.alarms = tmp.filter((a) => {\r\n            //has sub triggers of type alarm so cache them for future use as well\r\n            if (a && a.enabled && a.triggers.length) {\r\n                if (a.type === TriggerType.Alarm) return true;\r\n                //loop sub states if one is alarm cache it for future\r\n                for (let s = 0, sl = a.triggers.length; s < sl; s++)\r\n                    if (a.triggers[s].enabled && a.triggers[s].type === TriggerType.Alarm)\r\n                        return true;\r\n                return false;\r\n            }\r\n            return a && a.enabled && a.type === TriggerType.Alarm;\r\n        });\r\n        this._itemCache.alarms.reverse();\r\n        return this._itemCache.alarms;\r\n    }\r\n\r\n    get buttons(): Button[] {\r\n        if (this._itemCache.buttons)\r\n            return this._itemCache.buttons;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableButtons)\r\n                this._itemCache.buttons = [];\r\n            else\r\n                this._itemCache.buttons = SortItemArrayByPriority(this.profiles.items[keys[k]].buttons);\r\n            return this._itemCache.buttons;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableButtons || this.profiles.items[keys[k]].buttons.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].buttons));\r\n        }\r\n        this._itemCache.buttons = tmp;\r\n        return this._itemCache.buttons;\r\n    }\r\n\r\n    get contexts(): Context[] {\r\n        if (this._itemCache.contexts)\r\n            return this._itemCache.contexts;\r\n        const keys = this.profiles.keys;\r\n        const tmp = [];\r\n        let k = 0;\r\n        const kl = keys.length;\r\n        if (kl === 0) return [];\r\n        if (kl === 1) {\r\n            if (!this.profiles.items[keys[0]].enabled || !this.profiles.items[keys[0]].enableContexts)\r\n                this._itemCache.contexts = [];\r\n            else\r\n                this._itemCache.contexts = SortItemArrayByPriority(this.profiles.items[keys[k]].contexts);\r\n            return this._itemCache.contexts;\r\n        }\r\n        for (; k < kl; k++) {\r\n            if (!this.profiles.items[keys[k]].enabled || !this.profiles.items[keys[k]].enableContexts || this.profiles.items[keys[k]].contexts.length === 0)\r\n                continue;\r\n            tmp.push.apply(tmp, SortItemArrayByPriority(this.profiles.items[keys[k]].contexts));\r\n        }\r\n        this._itemCache.contexts = tmp;\r\n        return this._itemCache['contexts'];\r\n    }\r\n\r\n    get defaultContext(): boolean {\r\n        if (this._itemCache.defaultContext !== null)\r\n            return this._itemCache.defaultContext;\r\n        this._itemCache.defaultContext = this.profiles.defaultContext;\r\n        return this._itemCache.defaultContext;\r\n    }\r\n\r\n    //#endregion    \r\n\r\n    public addPlugin(plugin: Plugin) {\r\n        if (!plugin) return;\r\n        this.plugins.push(plugin);\r\n        plugin.initialize();\r\n        this.emit('plugin-added', plugin);\r\n    }\r\n\r\n    public removePlugin(plugin: Plugin) {\r\n        if (!this.plugins.length) return;\r\n        const idx = this.plugins.indexOf(plugin);\r\n        if (idx !== -1) {\r\n            plugin.remove();\r\n            this.plugins.splice(idx, 1);\r\n            this.emit('plugin-removed', plugin);\r\n        }\r\n    }\r\n\r\n    public getVariable(name: string) {\r\n        return this.variables[name];\r\n    }\r\n\r\n    public setVariable(name: string, value) {\r\n        this.variables[name] = value;\r\n    }\r\n\r\n    public setVariables(variables) {\r\n        const names = Object.keys(variables);\r\n        if (names.length === 0) return;\r\n        const nl = names.length;\r\n        let name;\r\n        for (let n = 0; n < nl; n++) {\r\n            name = names[n];\r\n            this.variables[name] = variables[name];\r\n        }\r\n    }\r\n\r\n    public hasVariable(name: string) {\r\n        return this.variables.hasOwnProperty(name);\r\n    }\r\n\r\n    public removeVariable(name: string) {\r\n        if (!this.variables.hasOwnProperty(name))\r\n            return;\r\n        delete this.variables[name];\r\n    }\r\n\r\n    public setHistoryIndex(index) {\r\n        this._input.setHistoryIndex(index);\r\n    }\r\n\r\n    public clearCommandHistory() {\r\n        this._input.clearCommandHistory();\r\n    }\r\n\r\n    public AddCommandToHistory(txt) {\r\n        this._input.AddCommandToHistory(txt);\r\n    }\r\n\r\n    public loadProfiles() {\r\n        return new Promise((resolve) => {\r\n            ProfileCollection.load().then((profiles: ProfileCollection) => {\r\n                this._profiles = profiles;\r\n                //ensure default exist and is loaded\r\n                if (!this.profiles.contains('default')) {\r\n                    this.profiles.add(Profile.Default);\r\n                    this.saveProfiles();\r\n                }\r\n                this.clearCache();\r\n                this.startAlarms();\r\n                this.emit('profiles-loaded');\r\n                resolve(this._profiles);\r\n            });\r\n        });\r\n    }\r\n\r\n    public removeProfile(profile) {\r\n        if (!profile) return;\r\n        this.profiles.remove(profile);\r\n        this.clearCache();\r\n        this.startAlarms();\r\n        this.emit('profile-removed', profile);\r\n    }\r\n\r\n    public saveProfiles() {\r\n        this._profiles.save();\r\n        this.clearCache();\r\n        this.emit('profiles-updated');\r\n    }\r\n\r\n    public toggleProfile(profile: string) {\r\n        this.profiles.toggle(profile);\r\n        this.saveProfiles();\r\n        this.clearCache();\r\n        this.startAlarms();\r\n        this.emit('profile-toggled', profile, this.profiles[profile].enabled);\r\n    }\r\n\r\n    public startAlarms() {\r\n        const al = this.alarms.length;\r\n        if ((al === 0 || !this.getOption('enableTriggers')) && this._alarm) {\r\n            clearInterval(this._alarm);\r\n            this._alarm = null;\r\n        }\r\n        else if (al && !this._alarm)\r\n            this._alarm = setInterval((client) => { client.process_alarms(); }, 1000, this);\r\n    }\r\n\r\n    public setAlarmState(idx, state: boolean) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        for (const p in pattern) {\r\n            if (!pattern.hasOwnProperty(p)) continue;\r\n            if (state) {\r\n                pattern[p].startTime += Date.now() - pattern[p].suspended;\r\n                pattern[p].prevTime += Date.now() - pattern[p].suspended;\r\n                if (pattern[p].tempTime)\r\n                    pattern[p].tempTime += Date.now() - pattern[p].suspended;\r\n                pattern[p].suspended = 0;\r\n            }\r\n            else\r\n                pattern[p].suspended = Date.now();\r\n        }\r\n    }\r\n\r\n    public setAlarmTempTime(idx, temp: number) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[0])\r\n            pattern[0].setTempTime(temp);\r\n    }\r\n\r\n    public restartAlarmState(idx, oldState, newState) {\r\n        if (oldState === newState)\r\n            return;\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[oldState])\r\n            pattern[oldState].restart = Date.now();\r\n        if (pattern[newState])\r\n            pattern[newState].restart = Date.now();\r\n    }\r\n\r\n    public getRemainingAlarmTime(idx) {\r\n        if (typeof idx === 'object')\r\n            idx = this.alarms.indexOf(idx);\r\n        if (idx === -1 || idx >= this.alarms.length)\r\n            return 0;\r\n        if (!this.alarms[idx].enabled)\r\n            return 0;\r\n        let pattern = this._itemCache.alarmPatterns[idx];\r\n        if (!pattern) {\r\n            //use an object to store to prevent having to loop over large array\r\n            pattern = {};\r\n            if (this.alarms[idx].type === TriggerType.Alarm)\r\n                pattern[0] = Alarm.parse(this.alarms[idx]);\r\n            for (let s = 0, sl = this.alarms[idx].triggers.length; s < sl; s++) {\r\n                //enabled and is alarm\r\n                if (this.alarms[idx].triggers[s].enabled && this.alarms[idx].triggers[s].type === TriggerType.Alarm)\r\n                    pattern[s] = Alarm.parse(this.alarms[idx].triggers[s]);\r\n            }\r\n            this._itemCache.alarmPatterns[idx] = pattern;\r\n        }\r\n        if (pattern[0]) {\r\n            const alarm = pattern[0];\r\n            const now = Date.now();\r\n            const dNow = new Date();\r\n            let future = now;\r\n            let fend = future + 90000000;\r\n            let mod = 1000;\r\n            if (alarm.seconds !== -1)\r\n                mod = 1000;\r\n            else if (alarm.minutes !== -1)\r\n                mod = 60000;\r\n            else if (alarm.hours !== -1)\r\n                mod = 3600000;\r\n            if (alarm.tempTime) {\r\n                if (alarm.tempTime - now > 0)\r\n                    return alarm.tempTime - now;\r\n                return 0;\r\n            }\r\n            else {\r\n                while (future < fend) {\r\n                    if (this._alarm_match(alarm, future, dNow))\r\n                        return future - now;\r\n                    future += mod;\r\n                    dNow.setTime(dNow.getTime() + mod);\r\n                }\r\n                return -1;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    public updateAlarms() {\r\n        if (this._itemCache.alarmPatterns) {\r\n            const old = this._itemCache.alarmPatterns;\r\n            const oAlarms = this.alarms;\r\n            this._itemCache.alarmPatterns = [];\r\n            this._itemCache.alarms = null;\r\n            const al = this.alarms.length;\r\n            let idx = -1;\r\n            for (let a = 0; a < al; a++) {\r\n                idx = oAlarms.indexOf(this.alarms[a]);\r\n                if (idx !== -1)\r\n                    this._itemCache.alarmPatterns[a] = old[idx];\r\n            }\r\n        }\r\n        this.startAlarms();\r\n    }\r\n\r\n    public process_alarms() {\r\n        if (!this.getOption('enableTriggers'))\r\n            return;\r\n        let a = 0;\r\n        let changed = false;\r\n        const al = this.alarms.length;\r\n        if (al === 0 && this._alarm) {\r\n            clearInterval(this._alarm);\r\n            this._alarm = null;\r\n            return;\r\n        }\r\n        const patterns = this._itemCache.alarmPatterns;\r\n        const now = Date.now();\r\n        const alarms = this.alarms;\r\n        const dNow = new Date();\r\n        for (a = al - 1; a >= 0; a--) {\r\n            let trigger = alarms[a];\r\n            const parent = trigger;\r\n            //not enabled skip\r\n            if (!trigger.enabled) continue;\r\n            //safety check in case a state was deleted\r\n            if (trigger.state > trigger.triggers.length)\r\n                trigger.state = 0;\r\n            //get sub state\r\n            if (trigger.state !== 0 && trigger.triggers && trigger.triggers.length) {\r\n                //trigger states are 1 based as 0 is parent trigger\r\n                trigger = trigger.triggers[trigger.state - 1];\r\n                //skip disabled states\r\n                while (!trigger.enabled && parent.state !== 0) {\r\n                    //advance state\r\n                    parent.state++;\r\n                    //if no more states start over and stop\r\n                    if (parent.state > parent.triggers.length) {\r\n                        parent.state = 0;\r\n                        //reset to first state\r\n                        trigger = trigger.triggers[parent.state - 1];\r\n                        //stop checking\r\n                        break;\r\n                    }\r\n                    if (parent.state)\r\n                        trigger = trigger.triggers[parent.state - 1];\r\n                    else\r\n                        trigger = parent;\r\n                    changed = true;\r\n                }\r\n                if (changed) {\r\n                    if (this.getOption('saveTriggerStateChanges'))\r\n                        this.saveProfiles();\r\n                    this.emit('item-updated', 'trigger', parent.profile.name, parent.profile.triggers.indexOf(parent), parent);\r\n                }\r\n                //last check to be 100% sure enabled\r\n                if (!trigger.enabled) continue;\r\n            }\r\n            //reparse type\r\n            if (trigger.type === SubTriggerTypes.ReParse || trigger.type === SubTriggerTypes.ReParsePattern) {\r\n                const val = this._input.adjustLastLine(this.display.lines.length, true);\r\n                const line = this.display.lines[val];\r\n                a = this._input.TestTrigger(trigger, parent, a, line, this.display.lines[val].raw || line, val === this.display.lines.length - 1);\r\n                continue;\r\n            }\r\n            //not an alarm either has sub alarms or was updated\r\n            if (trigger.type !== TriggerType.Alarm) continue;\r\n            let alarm = patterns[a];\r\n            //not found build cache\r\n            if (!alarm) {\r\n                try {\r\n                    patterns[a] = {};\r\n                    if (trigger.type === TriggerType.Alarm)\r\n                        patterns[a][0] = Alarm.parse(trigger);\r\n                    for (let s = 0, sl = trigger.triggers.length; s < sl; s++) {\r\n                        if (trigger.triggers[s].type === TriggerType.Alarm)\r\n                            patterns[a][s] = Alarm.parse(trigger.triggers[s]);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    patterns[a] = null;\r\n                    if (this.getOption('disableTriggerOnError')) {\r\n                        trigger.enabled = false;\r\n                        setTimeout(() => {\r\n                            this.saveProfiles();\r\n                            this.emit('item-updated', 'trigger', parent.profile, parent.profile.triggers.indexOf(parent), parent);\r\n                        });\r\n                    }\r\n                    throw e;\r\n                }\r\n                alarm = patterns[a];\r\n                //what ever reason the alarm failed to create so move on to next alarm\r\n                if (!alarm) continue;\r\n            }\r\n            //we want to sub state pattern\r\n            alarm = alarm[trigger.state];\r\n            if (alarm.restart) {\r\n                alarm.startTime = Date.now();\r\n                alarm.prevTime = alarm.startTime;\r\n                if (alarm.tempTime)\r\n                    alarm.tempTime += Date.now() - alarm.restart;\r\n                alarm.restart = 0;\r\n            }\r\n            let match: boolean = true;\r\n            //a temp time was set so it overrides all matches as once the temp time has been reached end\r\n            if (alarm.tempTime) {\r\n                match = now >= alarm.tempTime;\r\n                if (match)\r\n                    alarm.tempTime = 0;\r\n            }\r\n            else\r\n                match = this._alarm_match(alarm, now, dNow);\r\n            if (match && !alarm.suspended) {\r\n                alarm.prevTime = now;\r\n                //save as if temp alarm as execute trigger advances state and temp alarms will need different state shifts\r\n                const state = parent.state;\r\n                this._input.lastTriggered = alarm.pattern;\r\n                //_Triggered = string.Format('{0}:{1}:{2}', Fired.Hour, Fired.Minute, Fired.Second);\r\n                this._input.ExecuteTrigger(trigger, [alarm.pattern], false, -a, null, null, parent);\r\n                if (state !== parent.state)\r\n                    alarm.restart = Date.now();\r\n                if (alarm.temp) {\r\n                    //has sub state so only remove the temp alarm state\r\n                    if (parent.triggers.length) {\r\n                        if (state === 0) {\r\n                            const item = parent.triggers.shift();\r\n                            //restore previous state as shifted state may have skipped next state\r\n                            item.state = state;\r\n                            item.priority = parent.priority;\r\n                            item.name = parent.name;\r\n                            item.profile = parent.profile;\r\n                            //if removed temp shift state adjust\r\n                            if (item.state > item.triggers.length)\r\n                                item.state = 0;\r\n                            item.triggers = parent.triggers;\r\n                            alarms[a] = item;\r\n                            patterns[a] = null;\r\n                            this.saveProfiles();\r\n                            const idx = parent.profile.triggers.indexOf(parent)\r\n                            parent.profile.triggers[idx] = item;\r\n                            this.emit('item-updated', 'trigger', parent.profile.name, idx, item);\r\n                        }\r\n                        else {\r\n                            parent.triggers.splice(state - 1, 1);\r\n                            patterns[a].splice(state - 1, 1);\r\n                            //restore previous state as shifted state may have skipped next state\r\n                            parent.state = state;\r\n                            //if removed temp shift state adjust\r\n                            if (parent.state > parent.triggers.length)\r\n                                parent.state = 0;\r\n                            this.saveProfiles();\r\n                            const idx = parent.profile.triggers.indexOf(parent);\r\n                            this.emit('item-updated', 'trigger', parent.profile.name, idx, parent);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this._input.clearTriggerState(a);\r\n                        this.removeTrigger(parent);\r\n                    }\r\n                }\r\n                //remove after temp as temp requires old index\r\n                a = -this._input.cleanUpTriggerState(-a);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _alarm_match(alarm, now, dNow) {\r\n        if (!alarm || alarm.suspended) return false;\r\n        let match: boolean = true;\r\n        let ts;\r\n        let sec;\r\n        let min;\r\n        let hr;\r\n        let hours;\r\n        let minutes;\r\n        let seconds;\r\n        //no moment fall back to simple math\r\n        if (!moment || this.simpleAlarms) {\r\n            ts = now - this.connectTime;\r\n            if (ts < 1000)\r\n                return false;\r\n            sec = Math.round(ts / 1000);\r\n            min = Math.floor(sec / 60);\r\n            hr = Math.floor(min / 60);\r\n            hours = hr;\r\n            minutes = Math.floor(min % 60);\r\n            seconds = Math.floor(sec % 60);\r\n        }\r\n        else {\r\n            if (alarm.start)\r\n                ts = moment.duration(now - this.connectTime);\r\n            else\r\n                ts = moment.duration(now - alarm.startTime);\r\n            if (ts.asMilliseconds() < 1000)\r\n                return false;\r\n            sec = Math.round(ts.asMilliseconds() / 1000);\r\n            min = Math.floor(sec / 60);\r\n            hr = Math.floor(min / 60);\r\n            hours = ts.hours();\r\n            minutes = ts.minutes();\r\n            seconds = ts.seconds();\r\n        }\r\n        if (alarm.hoursWildCard) {\r\n            if (alarm.hours === 0)\r\n                match = match && hours === 0;\r\n            else if (alarm.hours !== -1)\r\n                match = match && hr !== 0 && hr % alarm.hours === 0;\r\n        }\r\n        else if (alarm.hours !== -1)\r\n            match = match && alarm.hours === (alarm.start ? hours : dNow.getHours());\r\n        if (alarm.minutesWildcard) {\r\n            if (alarm.minutes === 0)\r\n                match = match && minutes === 0;\r\n            else if (alarm.minutes !== -1)\r\n                match = match && min !== 0 && min % alarm.minutes === 0;\r\n        }\r\n        else if (alarm.minutes !== -1)\r\n            match = match && alarm.minutes === (alarm.start ? minutes : dNow.getMinutes());\r\n        if (alarm.secondsWildcard) {\r\n            if (alarm.seconds === 0)\r\n                match = match && seconds === 0;\r\n            else if (alarm.seconds !== -1)\r\n                match = match && sec % alarm.seconds === 0;\r\n        }\r\n        else if (alarm.seconds !== -1)\r\n            match = match && alarm.seconds === (alarm.start ? seconds : dNow.getSeconds());\r\n        return match;\r\n    }\r\n\r\n    constructor(options?: ClientOptions) {\r\n        super();\r\n        window.client = this;\r\n        window.oiMUD = this;\r\n        this._plugins = [];\r\n        options = Object.assign({ display: '#display', commandInput: '#commandInput' }, options || {});\r\n        if (!('display' in options) || typeof options.display === undefined)\r\n            options.display = '#display';\r\n        if (!('commandInput' in options) || typeof options.commandInput === undefined)\r\n            options.commandInput = '#commandInput';\r\n\r\n        this._display = new Display(options.display);\r\n\r\n        this.display.on('click', e => {\r\n            if (this.getOption('CommandonClick'))\r\n                this._commandInput.focus();\r\n        });\r\n        this.display.on('scroll-lock', (lock) => {\r\n            this.scrollLock = lock;\r\n        });\r\n        this.display.on('split-move-done', (h) => {\r\n            this.setOption('display.splitHeight', h);\r\n        });        \r\n        this.display.on('update-window', (width, height) => {\r\n            this.telnet.updateWindow(width, height);\r\n        });\r\n\r\n        this.display.on('update-window', (width, height) => {\r\n            this.telnet.updateWindow(width, height);\r\n        });\r\n\r\n        this.display.on('debug', (msg) => { this.debug(msg); });\r\n        this.display.on('add-line', data => {\r\n            this.emit('add-line', data);\r\n        });\r\n        this.display.on('add-line-done', data => {\r\n            this.emit('add-line-done', data);\r\n        });\r\n        this.display.on('MXP-tag-reply', (tag, args) => {\r\n            const e = { tag: tag, args: args, preventDefault: false };\r\n            this.emit('MXP-tag-reply', e);\r\n            if (e.preventDefault)\r\n                return;\r\n            switch (tag) {\r\n                case 'VERSION':\r\n                    if (this.display.MXPStyleVersion && this.display.MXPStyleVersion.length) {\r\n                        this.debug(`MXP Tag REPLY: <VERSION MXP=1.0 STYLE=${this.display.MXPStyleVersion} CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>`);\r\n                        this.send(`\\x1b[1z<VERSION MXP=1.0 STYLE=${this.display.MXPStyleVersion} CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>\\r\\n`);\r\n                    }\r\n                    else {\r\n                        this.debug(`MXP Tag REPLY: <VERSION MXP=1.0 CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>`);\r\n                        this.send(`\\x1b[1z<VERSION MXP=1.0 CLIENT=jiMUD VERSION=${this.version} REGISTERED=no>\\r\\n`);\r\n                    }\r\n                    break;\r\n                case 'SUPPORT':\r\n                    this.debug(`MXP Tag REPLY: <SUPPORTS ${args.join(' ')}>`);\r\n                    this.send(`\\x1b[1z<SUPPORTS ${args.join(' ')}>\\r\\n`);\r\n                    break;\r\n                case 'USER':\r\n                    this.emit('sendUsername', e);\r\n                    break;\r\n                case 'PASSWORD':\r\n                    this.emit('sendPassword', e);\r\n                    break;\r\n            }\r\n        });\r\n        this.display.on('expire-links', (args) => {\r\n            this.emit('expire-links', args);\r\n        });\r\n\r\n        this.display.on('parse-done', () => {\r\n            this.emit('parse-done');\r\n        });\r\n        this.display.on('set-title', (title, type) => {\r\n            if (typeof title === 'undefined' || title == null || title.length === 0)\r\n                this.emit('set-title', this.getOption('title').replace('$t', this.defaultTitle) || this.defaultTitle);\r\n            else if (type !== 1)\r\n                this.emit('set-title', this.getOption('title').replace('$t', title) || '')\r\n        });\r\n        this.display.on('music', (data) => {\r\n            this.emit('music', data);\r\n        });\r\n        this.display.on('sound', (data) => {\r\n            this.emit('sound', data);\r\n        });\r\n\r\n        this.display.on('bell', () => {\r\n            this.emit('bell');\r\n        });\r\n\r\n        if (typeof options.commandInput === 'string') {\r\n            this._commandInput = document.querySelector(options.commandInput) as HTMLTextAreaElement;\r\n            if (!this._commandInput)\r\n                throw new Error('Invalid selector for command input.');\r\n        }\r\n        else if (options.commandInput instanceof $)\r\n            this._commandInput = options.commandInput[0];\r\n        else if (options.commandInput instanceof HTMLElement)\r\n            this._commandInput = options.commandInput as HTMLTextAreaElement;\r\n        else\r\n            throw new Error('Command input must be a selector, element or jquery object');\r\n\r\n        this._telnet = new Telnet({ protocol: options.protocol, scheme: options.scheme });\r\n        this._telnet.terminal = 'oiMUD';\r\n        this._telnet.version = this.version;\r\n        this._telnet.GMCPSupports.push('oMUD 1');\r\n\r\n        this._telnet.on('error', (err) => {\r\n            if (this.enableDebug) this.debug(err);\r\n            if (err) {\r\n                if (err.type === 'close' && err.code === 1006)\r\n                    return;\r\n                const msg = [];\r\n                if (err.type)\r\n                    msg.push(err.type);\r\n                if (err.text)\r\n                    msg.push(err.text);\r\n                if (err.message)\r\n                    msg.push(err.message);\r\n                if (err.reason)\r\n                    msg.push(err.reason);\r\n                if (err.code)\r\n                    this.error(err.code + ' : ' + msg.join(', '));\r\n                else\r\n                    this.error(msg.join(', '));\r\n            }\r\n            else\r\n                this.error('Unknown telnet error.');\r\n            this.autoConnect();\r\n            this.emit('reconnect');\r\n        });\r\n        this.telnet.on('connecting', () => {\r\n            this.connecting = true;\r\n            this.echo('Trying to connect to ' + this.host + ':' + this.port, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n        });\r\n        this.telnet.on('connect', () => {\r\n            this.connecting = false;\r\n            this.echo('Connected...', AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n            this.connectTime = Date.now();\r\n            this.disconnectTime = 0;\r\n            this.lastSendTime = Date.now();\r\n            if (this._autoConnectID) {\r\n                clearTimeout(this._autoConnectID);\r\n                this._autoConnectID = null;\r\n            }\r\n            this.emit('connected');\r\n            this.raise('connected');\r\n        });\r\n\r\n        this.telnet.on('debug', msg => {\r\n            this.debug(msg);\r\n        });\r\n        this.telnet.on('receive-option', data => {\r\n            this.emit('received-option', data);\r\n        });\r\n        this.telnet.on('close', () => {\r\n            this.connecting = false;\r\n            this.echo('Connection closed to ' + this.host + ':' + this.port, AnsiColorCode.InfoText, AnsiColorCode.InfoBackground, true, true);\r\n            this.disconnectTime = Date.now();\r\n            this.emit('closed');\r\n            this.raise('disconnected');\r\n            //clear after in case events need the times\r\n            this.connectTime = 0;\r\n            this.lastSendTime = 0;\r\n        });\r\n        this.telnet.on('received-data', data => {\r\n            data = { value: data };\r\n            this.emit('received-data', data);\r\n            if (data == null || typeof data === 'undefined' || data.value == null || typeof data.value === 'undefined')\r\n                return;\r\n            this._printInternal(data.value, false, true);\r\n            this.debug('Latency: ' + this.telnet.latency + 'ms');\r\n            this.debug('Latency: ' + (this.telnet.latency / 1000) + 's');\r\n        });\r\n        this.telnet.on('received-MSDP', data => {\r\n            this.emit('received-MSDP', data);\r\n        });\r\n        this.telnet.on('received-GMCP', data => {\r\n            let val: string = data.value;\r\n            let mod: string;\r\n            let idx: number = 0;\r\n            const dl: number = val.length;\r\n            let c;\r\n            if (dl === 0) return;\r\n            for (idx = 0; idx < dl; idx++) {\r\n                c = val.charAt(idx);\r\n                if (c === ' ' || c === '{' || c === '[')\r\n                    break;\r\n            }\r\n            mod = val.substr(0, idx).trim();\r\n            val = val.substr(idx).trim();\r\n            this.debug('GMCP Module: ' + mod);\r\n            this.debug('GMCP Data: ' + val);\r\n            let obj;\r\n            if (mod.toLowerCase() === 'client.gui') {\r\n                obj = val.split('/n');\r\n                if (val.length >= 2) {\r\n                    obj = {\r\n                        version: parseInt(obj[0], 10),\r\n                        url: obj[1]\r\n                    };\r\n                }\r\n                else if (val.length > 0) {\r\n                    obj = {\r\n                        version: parseInt(obj[0], 10),\r\n                        url: obj[1]\r\n                    };\r\n                }\r\n                else\r\n                    obj = { version: obj, url: '' };\r\n                this.emit('received-GMCP', mod, obj);\r\n                return;\r\n            }\r\n            try {\r\n                if (val.length > 0)\r\n                    obj = JSON.parse(val);\r\n            }\r\n            catch (e) {\r\n                this.error('Invalid GMCP');\r\n                return;\r\n            }\r\n            this.emit('received-GMCP', mod, obj);\r\n        });\r\n        this.telnet.on('windowSize', () => { this.UpdateWindow(); });\r\n\r\n        let tmp: any = getParameterByName('host');\r\n        if (tmp !== null && tmp.length)\r\n            this.host = tmp;\r\n        else if (options && 'host' in options)\r\n            this.host = options.host;\r\n        else\r\n            this.host = '127.0.0.1';\r\n        tmp = +getParameterByName('port');\r\n        if (!isNaN(tmp) && tmp > 0)\r\n            this.port = tmp;\r\n        else if (options && 'port' in options)\r\n            this.port = options.port;\r\n        else\r\n            this.port = 23;\r\n\r\n        this._input = new Input(this);\r\n        this._input.on('scroll-lock', (lock) => {\r\n            this.display.scrollLock = lock;\r\n            this.emit('scroll-lock', lock);\r\n        });\r\n        this._input.on('command-history-changed', history => this.emit('command-history-changed', history));\r\n\r\n        this._input.on('item-added', (type, profile, idx, item) => {\r\n            this.emit('item-added', type, profile, idx, item);\r\n        });\r\n\r\n        this._input.on('item-updated', (type, profile, idx, item) => {\r\n            this.emit('item-updated', type, profile, idx, item);\r\n        });\r\n\r\n        this._input.on('item-removed', (type, profile, idx, item) => {\r\n            this.emit('item-removed', type, profile, idx, item);\r\n        });\r\n        this.loadOptions();\r\n        this._commandInput.value = '';\r\n        this._commandInput.focus();\r\n        window.addEventListener('blur', () => {\r\n            this.active = false;\r\n            this.emit('blur');\r\n            this.raise('blur');\r\n        });\r\n        window.addEventListener('focus', () => {\r\n            this.active = true;\r\n            this.emit('focus');\r\n            this.raise('focus');\r\n        });\r\n        window.addEventListener('beforeunload', e => {\r\n            if (this.connected) {\r\n                if (e)\r\n                    e.returnValue = 'Closing or reloading will disconnect you from the mud.';\r\n                return 'Closing or reloading will disconnect you from the mud.';\r\n            }\r\n            this.raise('closed');\r\n        });\r\n        window.addEventListener('unload', () => {\r\n            if (this.connected)\r\n                this.close();\r\n        })\r\n        //Add core plugins\r\n        if (MSP_PLUGIN)\r\n            this.addPlugin(new MSP(this));\r\n        if (MAPPER_PLUGIN)\r\n            this.addPlugin(new Mapper(this));\r\n        if (STATUS_PLUGIN)\r\n            this.addPlugin(new Status(this));\r\n        if (LOGGER_PLUGIN)\r\n            this.addPlugin(new Logger(this));\r\n        if (CHAT_PLUGIN)\r\n            this.addPlugin(new Chat(this));\r\n        if (PANELBAR_PLUGIN)\r\n            this.addPlugin(new PanelBar(this));\r\n        if (SHADOWMUD_PLUGIN)\r\n            this.addPlugin(new ShadowMUD(this));\r\n        if (DEBUG || TEST_PLUGIN)\r\n            this.addPlugin(new Test(this));\r\n        this.autoConnect();\r\n        this.emit('initialized');\r\n    }\r\n\r\n    public loadOptions() {\r\n        this._options = new Settings();\r\n\r\n        this.enableDebug = this._options.enableDebug;\r\n        this.display.maxLines = this._options.bufferSize;\r\n        this.display.enableFlashing = this._options.flashing;\r\n        this.display.enableMXP = this._options.enableMXP;\r\n        this.display.showInvalidMXPTags = this._options['display.showInvalidMXPTags'];\r\n        this.display.enableURLDetection = this._options.enableURLDetection;\r\n        this.display.enableMSP = this._options.enableMSP;\r\n        this.display.enableColors = this._options['display.enableColors'];\r\n        this.display.enableBackgroundColors = this._options['display.enableBackgroundColors'];\r\n\r\n        this.display.wordWrap = this._options['display.wordWrap'];\r\n        this.display.wrapAt = this._options['display.wrapAt'];\r\n        this.display.indent = this._options['display.indent'];\r\n        this.display.showTimestamp = this._options['display.showTimestamp'];\r\n        this.display.tabWidth = this._options['display.tabWidth'];\r\n        this.display.timestampFormat = this._options['display.timestampFormat'];\r\n        this.display.splitHeight = this._options['display.splitHeight'];\r\n        this.display.enableSplit = this._options['display.split'];\r\n        this.display.splitLive = this._options['display.splitLive'];\r\n\r\n        const colors = this.getOption('colors');\r\n        if (colors && colors.length > 0) {\r\n            let c;\r\n            const cl = colors.length;\r\n            for (c = 0; c < cl; c++) {\r\n                if (!colors[c] || colors[c].length === 0) continue;\r\n                this.display.SetColor(c, colors[c]);\r\n            }\r\n        }\r\n\r\n        if (this._telnet) {\r\n            this._telnet.options.MCCP = this._options.enableMCCP;\r\n            this._telnet.options.MXP = this._options.enableMXP;\r\n            this._telnet.UTF8 = this._options.enableUTF8;\r\n            this._telnet.options.ECHO = this._options.enableEcho;\r\n            this._telnet.enableLatency = this._options.lagMeter;\r\n            this._telnet.enablePing = this._options.enablePing;\r\n        }\r\n        this._input.scrollLock = this._options.scrollLocked;\r\n        this._input.enableParsing = this._options.enableParsing;\r\n        this._input.enableTriggers = this._options.enableTriggers;\r\n        this.display.scrollLock = this._options.scrollLocked;\r\n        this.display.hideTrailingEmptyLine = this._options['display.hideTrailingEmptyLine'];\r\n        this.display.displayControlCodes = this.getOption('display.displayControlCodes');\r\n        this.display.emulateTerminal = this.getOption('display.emulateTerminal');\r\n        this.display.emulateControlCodes = this.getOption('display.emulateControlCodes');\r\n\r\n        this._commandInput.wrap = this.getOption('commandWordWrap') ? 'on' : 'off';\r\n\r\n        if (this.UpdateFonts) this.UpdateFonts();\r\n        this.display.scrollDisplay();\r\n        this.loadProfiles();\r\n        this.emit('options-loaded');\r\n    }\r\n\r\n    public setOption(name, value) {\r\n        if (name === -1 || name === '-1')\r\n            return;\r\n        this._options[name] = value;\r\n        Settings.setValue(name, value);\r\n        this.emit('option-changed', name, value);\r\n    }\r\n\r\n    public getOption(name: string): any {\r\n        if (this._options && name in this._options)\r\n            return this._options[name];\r\n        return this._options[name] = Settings.getValue(name);\r\n    }\r\n\r\n    public UpdateFonts() {\r\n        //can only update if display has been setup\r\n        if (!this.display) return;\r\n        this.display.updateFont(this._options.font + ', monospace', this._options.fontSize);\r\n        this._commandInput.style.fontSize = this._options.cmdfontSize;\r\n        this._commandInput.style.fontFamily = this._options.cmdfont + ', monospace';\r\n    }\r\n\r\n    public parse(txt: string) {\r\n        this._parseInternal(txt, false, false, true);\r\n    }\r\n\r\n    private _parseInternal(txt: string, remote: boolean, force?: boolean, prependSplit?: boolean) {\r\n        this.display.append(txt, remote, force, prependSplit);\r\n    }\r\n\r\n    public error(err: any) {\r\n        if (this.enableDebug) this.debug(err);\r\n        let msg = '';\r\n        if (err == null || typeof err === 'undefined')\r\n            err = new Error('Unknown');\r\n        else if (typeof err === 'string' && err.length === 0)\r\n            err = new Error('Unknown');\r\n        if (err.stack && this.getOption('showErrorsExtended'))\r\n            msg = err.stack;\r\n        else if (err instanceof Error || err instanceof TypeError)\r\n            msg = err.name + ': ' + err.message;\r\n        else if (err.message)\r\n            msg = err.message;\r\n        else\r\n            msg = '' + err;\r\n\r\n        if (msg.match(/^.*Error: /g) || msg.match(/^.*Error - /g))\r\n            this.echo(msg, AnsiColorCode.ErrorText, AnsiColorCode.ErrorBackground, true, true);\r\n        else\r\n            this.echo('Error: ' + msg, AnsiColorCode.ErrorText, AnsiColorCode.ErrorBackground, true, true);\r\n\r\n        if (this.getOption('logErrors')) {\r\n            if (!this.getOption('showErrorsExtended')) {\r\n                if (err.stack)\r\n                    msg = err.stack;\r\n                else {\r\n                    err = new Error(err || msg);\r\n                    msg = err.stack;\r\n                }\r\n            }\r\n            else if (!err.stack) {\r\n                err = new Error(err || msg);\r\n                msg = err.stack;\r\n            }\r\n            window.console.log(new Date().toLocaleString());\r\n            window.console.log(msg);\r\n            localforage.getItem('oiMUDErrorLog').then(value => {\r\n                localforage.setItem('oiMUDErrorLog', value = (value || '') + new Date().toLocaleString() + '\\n' + msg + '\\n');\r\n            }).catch(err => this.error(err));\r\n        }\r\n        if (err === 'Error: ECONNRESET - read ECONNRESET.' && this.telnet.connected)\r\n            this.close();\r\n        this.raise('error', msg);\r\n    }\r\n\r\n    public echo(str: string, fore?: number, back?: number, newline?: boolean, forceLine?: boolean) {\r\n        if (str == null) str = '';\r\n        if (newline == null) newline = false;\r\n        if (forceLine == null) forceLine = false;\r\n        if (fore == null) fore = AnsiColorCode.LocalEcho;\r\n        if (back == null) back = AnsiColorCode.LocalEchoBack;\r\n        const codes = '\\x1b[0m' + this.display.CurrentAnsiCode() + '\\n';\r\n        //make its a string in case raw js passes number or something else\r\n        str = '' + str;\r\n        if (str.endsWith('\\n'))\r\n            str = str.substr(0, str.length - 1);\r\n        if (this.telnet.prompt && forceLine) {\r\n            this.print('\\n\\x1b[' + fore + ';' + back + 'm' + str + codes, newline);\r\n            this.telnet.prompt = false;\r\n        }\r\n        else\r\n            this.print('\\x1b[' + fore + ';' + back + 'm' + str + codes, newline);\r\n    }\r\n\r\n    public print(txt: string, newline?: boolean) {\r\n        this._printInternal(txt, newline, false, true);\r\n    }\r\n\r\n    private _printInternal(txt: string, newline?: boolean, remote?: boolean, prependSplit?: boolean) {\r\n        if (txt == null || typeof txt === 'undefined') return;\r\n        if (newline == null) newline = false;\r\n        if (remote == null) remote = false;\r\n        if (newline && this.display.textLength > 0 && !this.display.EndOfLine && this.display.EndOfLineLength !== 0 && !this.telnet.prompt && !this.display.parseQueueEndOfLine)\r\n            txt = '\\n' + txt;\r\n        this.emit('print');\r\n        this._parseInternal(txt, remote, false, prependSplit);\r\n    }\r\n\r\n    public send(data, echo?: boolean) {\r\n        this.telnet.sendData(data);\r\n        this.lastSendTime = Date.now();\r\n        if (echo && this.telnet.echo && this.getOption('commandEcho'))\r\n            this.echo(data);\r\n        else if (echo)\r\n            this.echo('\\n');\r\n    }\r\n\r\n    public sendRaw(data) {\r\n        this.telnet.sendData(data, true);\r\n        this.lastSendTime = Date.now();\r\n    }\r\n\r\n    public sendGMCP(data) {\r\n        this.telnet.sendGMCP(data);\r\n        this.lastSendTime = Date.now();\r\n    }\r\n\r\n    public debug(str: string, style?) {\r\n        const data = { value: str };\r\n        this.emit('debug', data);\r\n        if (!this._enableDebug || data == null || typeof data === 'undefined' || data.value == null || typeof data.value === 'undefined' || data.value.length === 0)\r\n            return;\r\n        if (window.console) {\r\n            if (style)\r\n                window.console.log('%c' + str, style);\r\n            else\r\n                window.console.log(data.value);\r\n        }\r\n    }\r\n\r\n    public sendCommand(txt?: string, noEcho?: boolean, comments?: boolean) {\r\n        if (txt == null) {\r\n            txt = this._commandInput.value;\r\n            if (!this.telnet.echo)\r\n                this._commandInput.value = '';\r\n            else\r\n                this._input.AddCommandToHistory(txt);\r\n        }\r\n        //make its a string in case raw js passes number or something else\r\n        txt = '' + txt;\r\n        if (!txt.endsWith('\\n'))\r\n            txt = txt + '\\n';\r\n        const data = { value: txt, handled: false, comments: comments };\r\n        this.emit('parse-command', data);\r\n        if (data == null || typeof data === 'undefined') return;\r\n        if (data.handled || data.value == null || typeof data.value === 'undefined') return;\r\n        if (data.value.length > 0)\r\n            this.send(data.value, !noEcho);\r\n        if (!this.getOption('keepLastCommand'))\r\n            this._commandInput.value = '';\r\n        else if (this.getOption('selectLastCommand'))\r\n            selectAll(this._commandInput);\r\n    }\r\n\r\n    public sendBackground(txt: string, noEcho?: boolean, comments?: boolean) {\r\n        if (txt == null) {\r\n            txt = this._commandInput.value;\r\n            if (!this.telnet.echo)\r\n                this._commandInput.value = '';\r\n            else\r\n                this._input.AddCommandToHistory(txt);\r\n        }\r\n        //make its a string in case raw js passes number or something else\r\n        txt = '' + txt;\r\n        if (!txt.endsWith('\\n'))\r\n            txt = txt + '\\n';\r\n        const data = { value: txt, handled: false, comments: comments };\r\n        this.emit('parse-command', data);\r\n        if (data == null || typeof data === 'undefined') return;\r\n        if (data.value == null || typeof data.value === 'undefined') return;\r\n        if (!data.handled && data.value.length > 0)\r\n            this.send(data.value, !noEcho);\r\n    }\r\n\r\n    get scrollLock(): boolean {\r\n        return this._input.scrollLock;\r\n    }\r\n\r\n    set scrollLock(enabled: boolean) {\r\n        this._input.scrollLock = enabled;\r\n    }\r\n\r\n    public toggleScrollLock() {\r\n        this._input.toggleScrollLock();\r\n    }\r\n\r\n    public UpdateWindow() {\r\n        this.display.updateWindow();\r\n    }\r\n\r\n    public close() {\r\n        this.telnet.close();\r\n    }\r\n\r\n    public connect() {\r\n        this.emit('connecting');\r\n        this.display.ClearMXP();\r\n        this.display.ResetMXPLine();\r\n        this.telnet.connect();\r\n        this.emit('connect');\r\n        this._commandInput.focus();\r\n    }\r\n\r\n    public receivedData(data) {\r\n        this.telnet.receivedData(data);\r\n    }\r\n\r\n    public notify(title: string, message: string, options?: NotificationOptions) {\r\n        if (this.enableDebug) {\r\n            this.emit('debug', 'notify title: ' + title);\r\n            this.emit('debug', 'notify msg: ' + message);\r\n        }\r\n        this.emit('notify', title, message, options);\r\n    }\r\n\r\n    public clear() {\r\n        this.display.clear();\r\n        this.emit('cleared');\r\n    }\r\n\r\n    public parseInline(text: string) {\r\n        return this._input.parseInline(text);\r\n    }\r\n\r\n    public parseOutgoing(text: string, eAlias?: boolean, stacking?: boolean, noFunction?: boolean) {\r\n        return this._input.parseOutgoing(text, eAlias, stacking, noFunction);\r\n    }\r\n\r\n    public clearCache() {\r\n        this._input.clearCaches();\r\n        this._itemCache = {\r\n            triggers: null,\r\n            aliases: null,\r\n            macros: null,\r\n            buttons: null,\r\n            contexts: null,\r\n            defaultContext: null,\r\n            alarms: null,\r\n            alarmPatterns: []\r\n        };\r\n    };\r\n\r\n    public beep() {\r\n        this.emit('bell');\r\n    }\r\n\r\n    public raise(event: string, args?, delay?: number) {\r\n        //if profiles not loaded, try again until loaded as profiles are loaded async\r\n        if (!this.profiles) {\r\n            setTimeout(() => {\r\n                this.raise(event, args, delay);\r\n            }, 100);\r\n            return;\r\n        }\r\n        if (!delay || delay < 1)\r\n            this._input.triggerEvent(event, args);\r\n        else\r\n            setTimeout(() => {\r\n                this._input.triggerEvent(event, args);\r\n            }, delay);\r\n    }\r\n\r\n    public show() {\r\n        this.emit('show');\r\n    }\r\n\r\n    public hide() {\r\n        this.emit('hide');\r\n    }\r\n\r\n    public toggle() {\r\n        this.emit('toggle');\r\n    }\r\n\r\n    public autoConnect() {\r\n        if (!this._autoConnectID && this.getOption('autoConnect') && !this._telnet.connected)\r\n            this._autoConnectID = setTimeout(() => { this.connect(); this._autoConnectID = null; }, this.getOption('autoConnectDelay'));\r\n    }\r\n\r\n    public getWindowState(windowName) {\r\n        let state = this.getOption('windows.' + windowName);\r\n        if (state && this.getOption('fixHiddenWindows')) {\r\n            if (state.x + state.width / 2 > document.body.clientWidth)\r\n                state.x = document.body.clientWidth - state.width / 2;\r\n            if (state.x < 0)\r\n                state.x = 0;\r\n            if (state.y + state.height / 2 > document.body.clientHeight)\r\n                state.y = document.body.clientHeight - state.height / 2;\r\n            if (state.y < 0)\r\n                state.y = 0;\r\n        }\r\n        return state;\r\n    }\r\n}\r\nwindow.Client = Client;\r\nwindow.Display = Display;"],
  "mappings": "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AK,cACL,IAAK,mBACL,IAAK,qBACL,IAAK,qBACL,IAAK,kBACL,IAAK,kBACL,IAAK,aACL,IAAK,cACL,IAAK,eACL,IAAK,OACL,IAAK,SACL,IAAK,UACL,IAAK,YACL,IAAK,aACL,IAAK,aACL,IAAK,cACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,eACL,IAAK,qBACL,IAAK,sBACL,IAAK,QACL,IAAK,cACL,IAAK,cACL,IAAK,YACL,IAAK,IACL,IAAK,SACL,IAAK,IACL,IAAK,QACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,IACL,IAAK,eACL,IAAK,aACL,IAAK,gBACL,IAAK,gBACL,IAAK,eACL,IAAK,cACL,IAAK,cACL,IAAK,cACL,IAAK,iBACL,IAAK,gBACL,IAAK,eACL,IAAK,iBACL,IAAK,eACL,IAAK,eACL,IAAK,eACL,IAAK,kBACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,MACL,IAAK,eACT,EAEWC,GAAgB,CACvB,OAAQ,EACR,KAAM,EACN,UAAW,EACX,IAAK,EACL,cAAe,GACf,YAAa,GACb,IAAK,GACL,MAAO,GACP,UAAW,GACX,YAAa,GACb,IAAK,GACL,KAAM,GACN,KAAM,GACN,GAAI,GACJ,MAAO,GACP,KAAM,GACN,OAAQ,GACR,OAAQ,GACR,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,EAAG,GACH,WAAY,GACZ,WAAY,GACZ,W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ACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,OACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,IACXmE,EAAI,SACCnE,IAAM,I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AAU,cACV,OAAU,QACV,OAAU,eACV,OAAU,YACV,OAAU,kBACV,OAAU,gBACV,OAAU,gBACV,OAAU,QACV,OAAU,eACV,OAAU,eACV,OAAU,OACV,OAAU,iBACV,OAAU,YACV,OAAU,QACV,OAAU,eACV,OAAU,eACV,OAAU,sBACV,OAAU,OACV,OAAU,OACV,OAAU,WACV,OAAU,YACV,OAAU,SACV,OAAU,SACV,OAAU,SACV,OAAU,cACV,OAAU,SACV,OAAU,YACV,OAAU,gBACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,iBACV,OAAU,iBACV,OAAU,aACV,OAAU,aACV,OAAU,kBACV,OAAU,aACV,OAAU,iBACV,OAAU,aACV,OAAU,aACV,OAAU,WACV,OAAU,aACV,OAAU,aACV,OAAU,aACV,OAAU,YACV,OAAU,aACV,OAAU,mBACV,OAAU,aACV,OAAU,aACV,OAAU,YACV,OAAU,YACV,OAAU,YACV,OAAU,aACV,OAAU,kBACV,OAAU,WACV,OAAU,YACV,OAAU,eACV,OAAU,eACV,OAAU,cACV,OAAU,SACV,OAAU,SACV,OAAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,aACV,OAAU,SACV,OAAU,QACV,OAAU,OACV,OAAU,mBACV,OAAU,gBACV,OAAU,mBACV,OAAU,SACV,OAAU,mBACV,OAAU,iBACV,OAAU,iBACV,OAAU,iBACV,OAAU,WACV,OAAU,aACV,OAAU,mBACV,OAAU,aACV,OAAU,iBACV,OAAU,kBACV,OAAU,WACV,OAAU,aACV,OAAU,cACV,OAAU,cACV,OAAU,aACV,OAAU,aACV,OAAU,kBACV,OAAU,MACV,OAAU,YACV,OAAU,oBACV,OAAU,UACV,OAAU,cACV,OAAU,SACV,OAAU,cACV,OAAU,aACV,OAAU,WACV,OAAU,gBACV,OAAU,gBACV,OAAU,gBACV,OAAU,iBACV,OAAU,eACV,OAAU,aACV,OAAU,OACV,OAAU,gBACV,OAAU,gBACV,OAAU,OACV,OAAU,aACV,OAAU,eACV,OAAU,OACV,OAAU,mBACV,OAAU,mBACV,OAAU,SACV,OAAU,mB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",
  "names": ["require_inflate_stream_min", "__commonJSMin", "exports", "k", "l", "aa", "s", "a", "d", "b", "c", "e", "x", "y", "g", "f", "p", "h", "q", "m", "n", "r", "B", "z", "A", "H", "I", "J", "ba", "ca", "V", "K", "W", "w", "D", "E", "C", "u", "t", "X", "O", "L", "Y", "F", "M", "G", "N", "P", "da", "Z", "v", "$", "ea", "fa", "ga", "ha", "ia", "ja", "ka", "la", "ma", "Q", "na", "S", "T", "oa", "U", "require_buzz", "__commonJSMin", "exports", "module", "context", "factory", "AudioContext", "buzz", "src", "options", "doc", "pid", "events", "eventsOnce", "supported", "volume", "value", "time", "set", "percent", "duration", "timerangeToArray", "key", "types", "func", "self", "efunc", "e", "t", "type", "idx", "i", "namespace", "detail", "eventType", "evt", "to", "callback", "from", "delay", "doFade", "sound", "source", "getExt", "timeRange", "array", "length", "filename", "audioCtx", "j", "k", "sounds", "argsToArray", "soundArray", "a", "fn", "speed", "args", "withHours", "h", "m", "s", "splits", "total", "decimal", "r", "require_pathfinding3D", "__commonJSMin", "exports", "module", "e", "define", "ses", "bootstrap", "t", "n", "i", "s", "o", "__require", "r", "u", "require", "Heap", "defaultCmp", "floor", "heapify", "heappop", "heappush", "heappushpop", "heapreplace", "insort", "min", "nlargest", "nsmallest", "updateItem", "_siftdown", "_siftup", "x", "y", "a", "lo", "hi", "cmp", "mid", "array", "item", "lastelt", "returnitem", "_ref", "_i", "_j", "_len", "_ref1", "_results", "_results1", "pos", "elem", "result", "los", "startpos", "newitem", "parent", "parentpos", "childpos", "endpos", "rightpos", "heap", "Node", "Grid", "width", "height", "depth", "matrix", "_buildNodes", "j", "z", "nodes", "row", "d", "walkable", "node", "allowDiagonal", "dontCrossCorners", "neighbors", "s0", "d0", "s1", "d1", "s2", "d2", "s3", "d3", "s4", "s5", "thisNodes", "newGrid", "newNodes", "dx", "dy", "dz", "backtrace", "path", "biBacktrace", "nodeA", "nodeB", "pathA", "pathB", "pathLength", "sum", "b", "getLine", "x1", "y1", "z1", "x2", "y2", "z2", "ListOfPoints", "xs", "ys", "zs", "p1", "p2", "smoothenPath", "grid", "len", "x0", "y0", "z0", "sx", "sy", "sz", "Util", "Heuristic", "AStarFinder", "opt", "startX", "startY", "startZ", "endX", "endY", "endZ", "openList", "startNode", "endNode", "heuristic", "weight", "abs", "SQRT2", "neighbor", "l", "ng", "BestFirstFinder", "orig", "BiAStarFinder", "startOpenList", "endOpenList", "BY_START", "BY_END", "BiBestFirstFinder", "BiBreadthFirstFinder", "BiDijkstraFinder", "BreadthFirstFinder", "DijkstraFinder", "IDAStarFinder", "nodesVisited", "startTime", "h", "cost", "search", "g", "cutoff", "route", "f", "end", "k", "neighbour", "neighbours", "start", "cutOff", "JumpPointFinder", "_identifySuccessors", "_findNeighbors", "_jump", "px", "py", "pz", "jx", "jy", "nx", "ny", "nz", "EventEmitter", "#events", "type", "listener", "caller", "once", "args", "oEvents", "events", "i", "idx", "key", "len", "fun", "len", "res", "thisp", "i", "val", "SortArrayByPriority", "a", "b", "SortMapByPriority", "SortItemArrayByPriority", "list", "map", "el", "FilterArrayByKeyValue", "array", "k", "v", "al", "_edCache", "htmlEncode", "value", "nonBreaking", "htmlDecode", "stripQuotes", "str", "offset", "el", "box", "docElem", "StringBuffer", "string", "b", "arr", "CharAllowedInURL", "chr", "proto", "i", "keyCodeToChar", "keyCharToCode", "clone", "obj", "replacer", "copy", "o", "output", "v", "key", "setSelectionRange", "input", "selectionStart", "selectionEnd", "range", "selectAll", "x", "y", "w", "h", "r", "k", "p", "idx", "s", "rem", "paddingValue", "newStr", "sep", "type", "escape", "escapeChar", "quote", "sQuote", "pS", "c", "pC", "sp", "spl", "spC", "tl", "getTimeSpan", "al", "tmp", "capitalize", "s", "first", "c", "i", "p", "il", "pl", "splitQuoted", "str", "sep", "ec", "q", "sq", "strings", "ps", "sl", "spl", "sp", "getCursor", "el", "oSel", "_colorCodes", "pinkfishToHTML", "text", "_loadColors", "stack", "codes", "t", "tl", "bold", "boldNest", "classes", "cl", "c", "color", "r", "g", "b", "idx", "getColors", "_ColorTable", "formatUnit", "str", "ch", "isValidIdentifier", "insertValue", "input", "value", "active", "startPos", "endPos", "arg", "_txtDecoder", "ArrayBufferToString", "buffer", "BinaryToString", "BinaryToString", "binary", "error", "_error", "StringToBinary", "string", "chars", "code", "i", "isUCS2", "len", "_i", "_txtEncoder", "StringToUint8Array", "binLen", "buffer", "_createTextarea", "text", "textarea", "copyText", "resolve", "reject", "blob", "data", "permission", "e", "err", "pasteText", "pasteType", "type", "fallBack", "items", "isPasteSupported", "el", "pasteEvent", "isSupported", "getParameterByName", "name", "url", "regex", "results", "fSaveAs", "DownloadAttributeSupport", "BlobBuilder", "URL", "BrowserSupportedMimeTypes", "mimetype", "builder", "link", "event", "_utf8", "intc", "_TryGetCharUTF8", "b", "count", "c", "s", "ss", "StringBuffer", "sl", "printArray", "dl", "ba", "idx", "getScrollbarWidth", "outer", "inner", "scrollbarWidth", "openFileDialog", "title", "multiple", "accept", "dialog", "input", "readFile", "file", "progress", "reader", "evt", "_timers", "debounce", "mainFunction", "delay", "key", "scrollChildIntoView", "parent", "child", "childRect", "parentRect", "isMobile", "userAgent", "isArrayEqual", "a", "b", "i", "l", "isObjectEqual", "propName", "import_inflate_stream_min", "Telnet", "EventEmitter", "options", "_splitBuffer", "_connected", "_MTTS", "_zStream", "_latencyTime", "_doPing", "_closed", "_zlib", "_endMCCP", "_destroySocket", "_createSocket", "data", "skipDecompress", "prependSplit", "tmp", "StringToUint8Array", "raw", "_escapeData", "printArray", "e", "returnRaw", "len", "_sb", "_decompressData", "state", "pState", "processed", "StringBuffer", "ga", "verb", "option", "msdp_val", "msdp_var", "_MSSP", "i", "ne", "idx", "debugOp", "uLen", "_formatByte", "_fireReceiveOption", "_startGMCP", "ArrayBufferToString", "_fireReceiveMSDP", "_fireReceiveGMCP", "_startMCCP", "op", "reply", "val", "w", "h", "w1", "w2", "h1", "h2", "mf", "str", "dl", "ba", "c", "host", "port", "_socket", "hasScheme", "evt", "reader", "b", "Ansi", "AnsiColorCode", "getAnsiColorCode", "color", "back", "getColorCode", "code", "f", "b", "bold", "isMXPColor", "getAnsiCode", "str", "Size", "width", "height", "SettingList", "isMobile", "SettingProperties", "Settings", "_Settings", "s", "sl", "setting", "defaultValue", "tmp", "err", "value", "prop", "TriggerType", "SubTriggerTypes", "MacroDisplay", "item", "d", "keyCodeToChar", "Alarm", "_Alarm", "data", "pattern", "parent", "readOnly", "t", "parts", "tmp", "value", "Item", "_Item", "profile", "prop", "isObjectEqual", "Button", "_Button", "Macro", "_Macro", "Alias", "_Alias", "Trigger", "_Trigger", "il", "i", "state", "Context", "_Context", "Variable", "_Variable", "_type", "splitQuoted", "Profile", "_Profile", "name", "defaults", "m", "dl", "buttons", "b", "file", "version", "sl", "s", "clone", "key", "type", "field", "SortItemArrayByPriority", "l", "v", "ProfileCollection", "_ProfileCollection", "defaultProfile", "a", "ap", "bp", "idx", "c", "noUpdate", "profiles", "p", "pc", "resolve", "reject", "collection", "keys", "k", "kl", "convertPattern", "client", "convertPatternState", "stringBuilder", "tl", "arg", "pat", "nest", "isValidIdentifier", "mathjs", "_mathjs", "WindowVariables", "ProperCase", "str", "txt", "fudgeDice", "ArgumentInvalidError", "name", "ArgumentInvalidNumberError", "value", "ArgumentMissingError", "ArgumentTooManyError", "InvalidForeColorError", "InvalidBackColorError", "InvalidTrigger", "msg", "InvalidTemporaryTrigger", "ProfileNotFound", "profile", "TriggerNotFound", "trigger", "Input", "EventEmitter", "client", "_historyIdx", "_tabIdx", "_tabWords", "_locked", "_TriggerCache", "_TriggerStates", "_TriggerFunctionCache", "_TriggerRegExCache", "_LastTriggered", "_LastTrigger", "_scrollLock", "_gag", "_gagID", "_gags", "_stack", "_vStack", "_controllers", "_controllersCount", "_gamepadCaches", "_lastSuspend", "_MacroCache", "_loops", "_pathQueue", "_pathTimeout", "_pathPaused", "mathjs", "_mathjs", "_initMathJS", "_commandHistory", "event", "data", "_getOption", "state", "_initPads", "_tabSearch", "insertValue", "start", "end", "cursorPos", "getCursor", "endPos", "startPos", "findStr", "regSearch", "word", "line", "tabCasing", "clone", "_updatePads", "scope", "WindowVariables", "a", "ll", "l", "expression", "results", "sl", "obj", "locked", "_getDiceArguments", "arg", "fun", "res", "functions", "args", "math", "c", "sides", "mod", "min", "max", "sum", "i", "fudgeDice", "keys", "_profiles", "k", "kl", "SortItemArrayByPriority", "MacroDisplay", "ansiRegex", "getAnsiCode", "f", "getAnsiColorCode", "getColorCode", "alarms", "al", "t", "p", "escape", "m", "controllers", "ct", "cl", "controller", "axes", "bl", "macros", "FilterArrayByKeyValue", "ml", "val", "pressed", "n", "raw", "cmd", "index", "txt", "idx", "tl", "s", "pd", "ps", "cmdChar", "items", "tmp", "item", "_echo", "o", "_isTriggerType", "Trigger", "_processCommandItemArgs", "Button", "pattern", "commands", "gl", "v", "e", "w", "getTimeSpan", "StringToUint8Array", "Alias", "SettingList", "files", "isMXPColor", "match", "_colorPosition", "_executeForLoop", "out", "isValidIdentifier", "r", "openFileDialog", "readFile", "contents", "$character", "text", "eAlias", "stacking", "append", "noFunctions", "noComments", "str", "alias", "AliasesCached", "aliases", "stackingChar", "spChar", "ePaths", "eCmd", "eEscape", "escChar", "verbatimChar", "eVerbatim", "eParamEscape", "paramChar", "eParam", "nParamChar", "eNParam", "eEval", "iEval", "iComments", "bComments", "iCommentsStr", "bCommentsStr", "bTrim", "sTrim", "findAlias", "tmp2", "_neg", "_pos", "_fall", "nest", "$copied", "ProperCase", "nl", "named", "ret", "keycode", "alt", "ctrl", "shift", "meta", "macro", "replace", "num", "delay", "pPath", "ePath", "cnt", "current", "_isSubTriggerType", "type", "_getTriggerType", "frag", "subtypes", "changed", "triggers", "states", "rCache", "tType", "parent", "_advanceTrigger", "re", "convertPattern", "regex", "pIdx", "reparse", "params", "oldState", "oldFire", "reParse", "force", "forceSingle", "sep", "splitQuoted", "options", "subTrigger", "sTrigger", "reload", "isNew", "_convertTriggerType", "filter", "TriggerType", "SubTriggerTypes", "fore", "back", "xEnd", "xStart", "option", "newline", "forceLine", "syntax", "RGBColor", "color_string", "simple_colors", "key", "color_defs", "bits", "i", "cl", "re", "processor", "channels", "r", "b", "MXPTag", "MXPState", "Entity", "remote", "Element", "Tag", "index", "fore", "back", "MXPStyle", "style", "high", "open", "Parser", "EventEmitter", "options", "_parsing", "_protocols", "_ColorTable", "_CurrentForeColor", "_CurrentBackColor", "_CurrentAttributes", "_SplitBuffer", "_mxpState", "_mxpStyles", "_mxpEntities", "_mxpElements", "_mxpLines", "_iMXPDefaultMode", "Size", "_getColors", "mxp", "_GetCurrentStyle", "f", "b", "fc", "bc", "_getFormatBlock", "offset", "colors", "_ResetColors", "_ProcessAnsiColorParams", "params", "p", "pl", "i", "rgb", "_buildColorTable", "r", "g", "idx", "code", "color", "RGBColor", "_AddLine", "line", "raw", "fragment", "skip", "formats", "data", "_pruneFormats", "textLen", "l", "nF", "format", "end", "nFormat", "_GetEntity", "entity", "_ClearMXPToTag", "tag", "custom", "secure", "tmp", "ml", "_ClearMXPOpen", "_getMXPOpenFormatBlocks", "m", "_getMXPCloseFormatBlocks", "_getMXPBlock", "args", "oTag", "blocks", "arg", "sArg", "sArgs", "x", "xl", "e", "sl", "s", "href", "hint", "expire", "prompt", "_CloneCurrentStyle", "MXPTag", "stripQuotes", "_isNumber", "_GetCloseTags", "_cleanMXPExpired", "cmds", "tt", "caps", "bl", "eType", "n", "type", "tl", "ts", "str", "c", "state", "clr", "_MXPCapture", "il", "_MXPDeCapture", "cnt", "ansi", "text", "force", "prependSplit", "_TermTitle", "_TermTitleType", "_AnsiParams", "stringBuilder", "formatBuilder", "rawBuilder", "pState", "lineLength", "iTmp", "mOffset", "_MXPTag", "_MXPOTag", "_MXPEntity", "_MXPComment", "_MXPArgs", "lines", "d", "u", "tabWidth", "lnk", "fLnk", "lnkOffset", "lLnk", "lNest", "mt", "j", "htmlDecode", "CharAllowedInURL", "_Tab", "psk", "pFnd", "nl", "ex", "_parseNext", "width", "height", "Display", "EventEmitter", "container", "options", "_updating", "_enableDebug", "_maxView", "_padding", "_enableColors", "_enableBackgroundColors", "_hideTrailingEmptyLine", "_maxLines", "_wordWrap", "_indent", "_indentPadding", "_wrapAt", "_scrollAtEnd", "_lineCache", "_expireCache", "_timestamp", "_timestampFormat", "_timestampWidth", "_mouseDown", "_scrollLock", "_selection", "_customSelection", "_container", "_document", "_window", "_styles", "_character", "_view", "_doUpdate", "e", "_split", "caret", "_getMouseEventCaretRange", "range", "bounds", "_bounds", "w", "h", "_bar", "_lastMouse", "_extendSelection", "_createScrollTimer", "_clearMouseDown", "_clearScrollTimer", "_horizontalScrollBarHeight", "_updateSelectionHighlight", "_charHeight", "_charWidth", "DisplayModel", "_wResize", "debounce", "_selectionChange", "selection", "nOffset", "_getNodeOffset", "_wUp", "_wMove", "_resizeObserver", "entries", "observer", "_resizeObserverCache", "_updateSplit", "_observer", "mutationsList", "mutation", "getScrollbarWidth", "_verticalScrollBarHeight", "value", "_buildStyleSheet", "_splitHeight", "_updateSplitLocation", "id", "delta", "_toggleSplit", "_linkFunction", "val", "_mxpLinkFunction", "_mxpSendFunction", "_mxpTooltipFunction", "_model", "data", "noUpdate", "args", "x", "xl", "_rebuildLine", "title", "type", "tag", "idx", "enable", "Size", "_innerHeight", "l", "html", "msg", "force", "y", "amt", "r", "txt", "remote", "prependSplit", "line", "elLine", "_updateDisplay", "width", "height", "_update", "font", "size", "pc", "padding", "styles", "start", "len", "inner", "parts", "offset", "style", "fCls", "text", "formats", "fLen", "right", "f", "format", "nFormat", "end", "td", "htmlEncode", "tmp", "formatUnit", "full", "_rebuildLines", "_html", "fore", "back", "color", "code", "_adjustSplitSelection", "clonedSelection", "div", "elements", "element", "el", "ll", "lines", "target", "source", "so", "eo", "eElement", "_getElement", "sElement", "_isElementVisible", "evt", "pos", "node", "tree", "elRect", "conRect", "view", "containerOffset", "_highlightRange", "_highlight", "viewportX", "viewportY", "viewportWidth", "viewportHeight", "edgeSize", "edgeTop", "edgeLeft", "edgeBottom", "edgeRight", "isInLeftEdge", "isInRightEdge", "isInTopEdge", "isInBottomEdge", "viewWidth", "viewHeight", "maxScrollX", "maxScrollY", "_display", "checkForViewScroll", "_adjustViewScroll", "currentScrollX", "currentScrollY", "canScrollUp", "canScrollDown", "canScrollLeft", "canScrollRight", "nextScrollX", "nextScrollY", "maxStep", "intensity", "_lineID", "_lineIDs", "_expire", "_expire2", "_parser", "Parser", "expire", "_expireLineLinkFormat", "_buildLineExpires", "d", "dl", "fs", "fl", "fsl", "eType", "n", "percent", "ol", "lineLength", "found", "formatEnd", "nF", "_pruneFormats", "textLen", "version", "buzz", "Plugin", "EventEmitter", "#client", "value", "client", "SoundState", "EventEmitter", "_file", "_repeats", "_volume", "_priority", "_retries", "file", "repeats", "volume", "priority", "e", "err", "resolve", "reject", "MSP", "Plugin", "options", "Client", "_enabled", "_enableSound", "_maxErrorRetries", "data", "idx", "_processFunction", "option", "value", "text", "type", "args", "state", "str", "x", "xl", "arg", "tmp", "stripQuotes", "old", "mod", "sound", "i", "Test", "Plugin", "client", "_event", "data", "_processFunction", "openFileDialog", "files", "readFile", "contents", "n", "i", "p", "StringToUint8Array", "avg", "max", "min", "items", "start", "sample", "t", "r", "bg", "a", "Ansi", "AnsiColorCode", "fg", "title", "g", "b", "c", "colors", "cl", "found", "arg", "s", "m", "dcc", "ws", "w", "h", "commands", "e", "emojiRange", "range", "x", "sample2", "maxLines", "id", "name", "PF", "RoomExits", "Room", "_Room", "data", "prop", "exit", "a", "c", "copy", "Map", "_Map", "EventEmitter", "_rooms", "_areas", "_zone", "_keys", "_keysZones", "_current", "value", "or", "rooms", "r", "rl", "_buildKeys", "key", "_normalizeRoom", "_buildAreas", "resolve", "reject", "map", "filter", "keys", "filterKeys", "fl", "roomLoop", "k", "kl", "room", "f", "idx", "areas", "area", "zone", "id", "dest", "b", "aRoom", "bRoom", "_cancel", "type", "MapDisplay", "EventEmitter", "container", "options", "_MouseDrag", "_drag", "_vscroll", "_hscroll", "_markers", "_updating", "_rTimeout", "_focused", "_showLegend", "_splitArea", "_fillWalls", "_enabled", "_follow", "_scale", "_mapperNavDown", "_pointerCache", "_pointerDistance", "_showNav", "_container", "_document", "_window", "_resizeObserver", "entries", "observer", "_resizeObserverCache", "_resizeCanvas", "_observer", "mutationsList", "mutation", "_canvas", "e", "target", "_mapperNavClick", "_context", "index", "cached", "curDiff", "pointerUp", "cachedEv", "_Mouse", "_MouseDown", "_MousePrev", "x", "y", "room", "event", "_doUpdate", "m", "_setFocus", "value", "_selected", "_drawCache", "evt", "rect", "rx", "ry", "ox", "oy", "Room", "canvas", "context", "ex", "resolve", "reject", "_map", "z", "area", "zone", "s", "$w", "$h", "$x", "$y", "rooms", "d", "r", "rl", "type", "_active", "_markedRooms", "level", "es", "map", "idx", "ctx", "nc", "_translate", "amt", "scale", "o", "key", "tx", "f", "color", "w", "h", "exit", "x1", "x2", "y1", "y2", "id", "filter", "destRoom", "roomsC", "oz", "cx", "cy", "cz", "matrix", "grid", "finder", "fPath", "startRoom", "z2", "walk", "cmds", "tmp", "cnt", "option", "tempCanvas", "computedStyle", "borderLeftWidth", "borderRightWidth", "borderTopWidth", "borderBottomWidth", "separator", "copyText", "err", "cmd", "wl", "scaled", "t", "fx", "rectWidth", "rectHeight", "blob", "reader", "paste_special_default", "DialogButtons", "Dialog", "EventEmitter", "options", "_state", "_resize", "_dragPosition", "_windowResize", "debounce", "_footer", "_body", "_id", "_resizeDoDrag", "e", "t", "_dialog", "rect", "_resizeTouchDrag", "_resizeStopDrag", "_document", "styles", "_window", "_dragMouseDown", "tag", "_dragMouseUp", "_dragMouseMove", "_header", "_dragTouchStart", "_dragTouchMove", "x", "y", "size", "_size", "_maximizable", "_closable", "_keydown", "fake", "redirectedEvent", "footer", "ec", "_title", "right", "_initResize", "_initResizeTouch", "bottom", "corner", "left", "top", "_resizeObserver", "entries", "observer", "_resizeObserverCache", "_observer", "mutationsList", "mutation", "value", "type", "el", "returnValue", "w", "h", "position", "_getMaxZIndex", "forceReset", "dialogs", "d", "dl", "i", "order", "z", "a", "b", "full", "silent", "contents", "args", "scripts", "s", "sl", "AlertDialog", "title", "message", "icon", "win", "getIcon", "ConfirmDialog", "buttons", "ProgressDialog", "_progress", "resolve", "reject", "confirm", "reason", "pasteSpecial", "paste", "paste_special_default", "forms", "f", "fl", "closeMenu", "instance", "showMenu", "initMenu", "clientMenu", "el", "text", "icon", "updateScrollLock", "e", "showDialog", "doc", "docEl", "requestFullScreen", "cancelFullScreen", "toggleButtons", "button", "isPasteSupported", "pasteText", "doPasteSpecial", "pl", "s", "sl", "list", "p", "item", "code", "id", "pos", "ie", "AdvEditor", "EventEmitter", "element", "enabledAdvanced", "_simple", "_init", "_colorNames", "_colorList", "_element", "value", "insertValue", "htmlEncode", "content", "_loadColors", "_dColors", "getColors", "c", "color", "r", "g", "b", "idx", "_bold", "bl", "_ColorTable", "_colors", "clientColors", "cNames", "RGBColor", "_nearestHex", "_initPlugins", "_editor", "editor", "url", "fallbackColor", "_lastButton", "Cell", "initial", "v", "_forecolor", "_backcolor", "getCurrentColor", "format", "elm", "applyFormat", "removeFormat", "registerCommands", "name", "setIconColor", "getAdditionalColors", "hasCustom", "type", "remove", "applyColor", "onChoice", "_openColorDialog", "mapColors", "colorMap", "colors", "i", "getFetch", "callback", "splitButtonApi", "newColor", "id", "registerTextColorButton", "tooltip", "lastColor", "_splitButtonApi", "handler", "e", "registerTextColorMenuItem", "text", "data", "_clearReverse", "_addReverse", "buttonPostRender", "buttonApi", "state", "toggleFormat", "isPasteSupported", "api", "_appendFile", "pasteType", "err", "pasteText", "copyText", "els", "back", "fore", "_colorCell", "cell", "_colorDialog", "Dialog", "cl", "html", "html2", "cells", "openFileDialog", "files", "f", "fl", "readFile", "contents", "pinkfishToHTML", "_buildHTMLStack", "tag", "$el", "t", "tl", "stack", "tags", "el", "nodes", "n", "nl", "start", "end", "style", "_formatHtml", "buffer", "codes", "d", "dl", "rgb", "_cleanReset", "hex", "rgbObj", "minDistance", "nearestHex", "currentColor", "distance", "shortRegEx", "full", "rgbArray", "regex", "m", "buildBreadcrumb", "pages", "options", "breadcrumb", "last", "item", "capitalize", "p", "pl", "title", "_small", "settings_menu_default", "SettingsDialog", "_SettingsDialog", "Dialog", "_buildMenu", "footer", "removeHash", "_page", "data", "clone", "openFileDialog", "files", "readFile", "contents", "s", "sl", "SettingList", "_loadPageSettings", "err", "e", "c", "colors", "pages", "title", "capitalize", "forms", "f", "fl", "id", "Settings", "args", "settings_menu_default", "buildBreadcrumb", "_menu", "items", "item", "scrollChildIntoView", "required", "target", "value", "defaultValue", "name", "enums", "el", "r", "v", "color", "RGBColor", "code", "option", "current", "type", "menu", "pl", "plugins", "p", "Splitter", "EventEmitter", "options", "$panel1MinSize", "$panel2MinSize", "$splitterWidth", "$splitterDistance", "$dragging", "$collapsed", "$id", "$panel1", "$panel2", "$anchor", "$el", "value", "_updatePanels", "$dragBar", "$ghostBar", "parent", "$parent", "_createControl", "$orientation", "e", "bnd", "$elBounds", "ge", "l", "$resizeObserver", "entries", "observer", "$resizeObserverCache", "$observer", "mutationsList", "mutation", "ProfileSearch", "EventEmitter", "manager", "parent", "_key", "_control", "_timer", "_regex", "$parent", "_case", "value", "_word", "_reverse", "_position", "_results", "_value", "selection", "focus", "val", "pattern", "re", "items", "m", "i", "il", "item", "profiles", "p", "pl", "profile", "key", "t", "tl", "GetDisplay", "idx", "r", "ProfilesDialog", "Dialog", "_profilesChanged", "_outsideChange", "_current", "_canClose", "_small", "_client", "_updateSmall", "_buildMenu", "type", "profileName", "index", "item", "_addItem", "collection", "profile", "id", "_sanitizeID", "items", "_menu", "_page", "menuItems", "i", "href", "_clipId", "_resetClip", "_splitter", "Splitter", "distance", "_contents", "footer", "el", "rect", "removeHash", "_goBack", "_cutItem", "_copyItem", "_paste", "_search", "_createProfile", "Profile", "il", "data", "openFileDialog", "files", "readFile", "contents", "keys", "k", "kl", "_profileCopyName", "p", "err", "_errorField", "_save", "sOpen", "_clip", "ProfileSearch", "value", "_getItem", "idPrefix", "hrefPrefix", "indent", "menu", "padding", "htmlEncode", "GetDisplay", "_getItems", "c", "cl", "nav", "_profile", "_profileEvents", "_lazyLoad", "e", "capitalize", "_deleteProfile", "_item", "title", "enabled", "args", "pages", "_setCurrent", "buildBreadcrumb", "last", "_updateEditMenu", "_contentPage", "_loadPage", "_setContents", "forms", "f", "fl", "target", "debounce", "_renameProfile", "_sortProfiles", "b", "pp", "_getItemType", "_removeItem", "idx", "_removeItems", "_loadItem", "page", "resolve", "reject", "scripts", "FilterArrayByKeyValue", "keyCharToCode", "Trigger", "updateHash", "DialogButtons", "s", "sl", "events", "name", "enums", "_updateItemMenu", "currentItem", "currentParent", "display", "bc", "select", "expand", "po", "pl", "scrollChildIntoView", "defaults", "menuItem", "oldProfile", "oldID", "newID", "_replaceProfileName", "container", "oldName", "newName", "oldPath", "newPath", "a", "ap", "bp", "_confirmSave", "r", "Alias", "Button", "Macro", "Context", "m", "newNode", "back", "clear", "_getClipData", "obj", "prop", "width", "n", "arr", "keyCodeToChar", "MacroDisplay", "HelpDialog", "Dialog", "_small", "_history", "_current", "_client", "_updateSmall", "debounce", "_splitter", "toolbar", "_setContents", "removeHash", "_page", "_md", "Splitter", "distance", "_menu", "_contents", "closeDropdowns", "script", "old_render", "tokens", "idx", "options", "env", "self", "ref", "url", "p", "_lastSelected", "_path", "updateHash", "value", "_updateHistory", "_navigate", "h", "menu", "history", "i", "il", "items", "e", "el", "rect", "_buildMenu", "contents", "args", "_menuData", "pages", "_expandPath", "buildBreadcrumb", "item", "index", "capitalize", "d", "id", "d2", "_loadPage", "data", "_sanitizeID", "name", "select", "expand", "po", "last", "pl", "scrollChildIntoView", "page", "resolve", "reject", "_menuItem", "indent", "padding", "n", "nl", "_menuItemEvents", "nav", "m", "ml", "ops", "c", "err", "_updateButtons", "direction", "width", "Contextmenu", "_Contextmenu", "EventEmitter", "items", "id", "_cleanUp", "_mouseup", "_menu", "e", "_items", "_id", "_createMenu", "menu", "i", "il", "index", "x", "y", "editor", "editorDialog", "_currentIcon", "_selword", "_selurl", "_selline", "lastMouse", "doLink", "url", "e", "doMXPLink", "el", "doMXPSend", "pmt", "tt", "im", "extra", "os", "offset", "x", "y", "items", "i", "il", "item", "MXPMenuHandler", "Contextmenu", "setSelectionRange", "cmd", "doMXPTooltip", "initializeInterface", "options", "_setIcon", "initMenu", "pasteText", "txt", "html", "copyText", "window", "closeDialog", "a", "value", "parent", "pos", "resizeCommandInput", "initCommandInput", "updateCommandInput", "_dialogs", "title", "buildButtons", "message", "notify", "permission", "args", "name", "showDialog", "h", "menu", "history", "event", "filename", "lineno", "colno", "error", "hashChange", "_loadHistory", "showButtons", "ae", "isPasteSupported", "doPasteSpecial", "removeHash", "string", "hashes", "s", "addHash", "updateHash", "add", "remove", "hashContains", "hashStartsWith", "dialogs", "d", "Dialog", "loadDialog", "footer", "list", "cmds", "l", "ll", "c", "cl", "textarea", "AdvEditor", "openFileDialog", "files", "readFile", "contents", "SettingsDialog", "ProfilesDialog", "HelpDialog", "hl", "dialog", "path", "show", "showError", "resolve", "reject", "subpath", "data", "err", "fragment", "opt", "debounce", "_resizeCommandInput", "commandInputResize", "measure", "cmdSize", "oldMeasure", "minHeight", "height", "padding", "inset", "ico", "icon", "toggleButtons", "createButton", "button", "index", "caption", "bh", "buttons", "b", "bl", "ExecuteButton", "dragButton", "idx", "ret", "elmnt", "pos3", "pos4", "delay", "dragMouseDown", "dragTouchStart", "dragMouseleave", "closeDragButton", "elementDrag", "elementMove", "closeDropdowns", "showDisable", "results", "pasteSpecial", "post", "pre", "replace", "insertValue", "mapper_menu_default", "mapper_room_default", "Mapper", "Plugin", "options", "Client", "Map", "map", "err", "idx", "window", "args", "name", "_dialog", "_dialogMap", "e", "_map", "mod", "data", "room", "_updateCurrent", "Room", "exit", "x", "Dialog", "debounce", "_dialogSplitter", "toolbar", "removeHash", "mapper_menu_default", "closeMenu", "openFileDialog", "files", "readFile", "MapDisplay", "area", "setting", "value", "Splitter", "mapper_room_default", "f", "target", "enums", "el", "selected", "current", "_updateMenu", "items", "i", "il", "event", "msg", "initMapper", "m", "rooms", "areas", "roomArea", "h", "progress", "_dialogProgress", "selector", "disabled", "type", "reason", "instance", "status_default", "Status", "Plugin", "client", "_info", "_infoAC", "_infoLimb", "_ac", "_rTimeout", "_dragging", "_clientContainer", "Settings", "isMobile", "_splitterDistance", "value", "_updateSplitter", "_lagMeter", "p", "_styles", "bounds", "_status", "_updateInterface", "idx", "$character", "$characterid", "status_default", "window", "args", "name", "_skillsDialog", "lag", "avg", "data", "w", "_updateMenuItem", "e", "main", "bounds2", "ghostBar", "maxWidth", "_move", "minWidth", "l", "options", "mod", "obj", "limb", "_doUpdate", "env", "index", "className", "_clear", "_getID", "_livingClass", "_updateSkill", "noSplitter", "title", "_resetSkills", "id", "el", "v", "eLimb", "max", "text", "noText", "bar", "progress", "parent", "label", "icon", "order", "party", "listItems", "a", "b", "compA", "compB", "itm", "force", "lm", "type", "_updating", "skill", "enable", "_sanitizeID", "prefix", "cls", "weapon", "ac", "health", "Dialog", "removeHash", "cats", "selected", "cat", "_loadSkills", "_skills", "cnt", "keys", "key", "_createLabel", "body", "_skillCategories", "opts", "capitalize", "_el", "found", "nodes", "n", "nl", "_updateFilter", "filter", "val", "button", "logger_worker_default", "log_header_default", "Logger", "Plugin", "_keyQueue", "_manager", "_initializeLogger", "_post", "data", "title", "lag", "_updateMenuItem", "_loadLoggerOptions", "window", "args", "name", "pages", "removeHash", "_createManager", "options", "updateHash", "LogManager", "_logger", "logger_worker_default", "e", "value", "_keyPromise", "_keys", "key", "state", "button", "Dialog", "_page", "_small", "_updateSmall", "_splitter", "Splitter", "distance", "_menu", "_contents", "closeDropdowns", "_buildMenu", "footer", "item", "_current", "scrollChildIntoView", "_goBack", "contents", "_logs", "buildBreadcrumb", "index", "last", "formatDate", "capitalize", "items", "_setContents", "logs", "r", "rl", "clear", "log_header_default", "b", "_removeLog", "_exportLog", "_appendContents", "html", "noLoader", "resolve", "reject", "keys", "p", "k", "kl", "icon", "log", "width", "date", "hours", "minutes", "ampm", "strTime", "Chat", "Plugin", "_capture", "_captureReview", "_captures", "_captureReviews", "_noCapture", "_noCaptureStore", "_unload", "state", "_getWindowState", "_isWindowOpen", "_window", "data", "e", "args", "res", "c", "cl", "_isDialogOpen", "window", "name", "_dialog", "removeHash", "_loadOptions", "value", "title", "lag", "_post", "_buildCaptures", "options", "lines", "l", "ll", "display", "line", "_buildToolbar", "doc", "toolbar", "_updateScrollLockButton", "_createLogger", "_updateButtonState", "_logger", "button", "icon", "debounce", "el", "Display", "h", "_loadDisplayOptions", "_loadWindowOptions", "Dialog", "_getLogger", "_loggerPlugin", "p", "pl", "Logger", "target", "Backup", "EventEmitter", "client", "_port", "_abort", "_closeDialog", "_save", "mod", "obj", "_getMapper", "_user", "_showDialog", "_mapper", "version", "Map", "map", "data", "Settings", "keys", "k", "saveSelection", "windows", "props", "p", "pl", "prop", "sProp", "jData", "err", "_updateProgress", "error", "errorThrown", "loadSelection", "profiles", "ProfileCollection", "kl", "n", "Profile", "l", "item", "m", "Macro", "Alias", "Trigger", "il", "i", "Button", "Context", "SettingProperties", "title", "_dialogProgress", "reason", "progress", "Mapper", "ShadowMUD", "Plugin", "client", "Backup", "data", "_skipMoreTimeout", "_skipMoreEvent", "window", "args", "name", "_help", "_showHelp", "options", "Dialog", "frame", "removeHash", "e", "PanelBar", "Plugin", "options", "Client", "_dragging", "_panelLocation", "Mapper", "_mapper", "Chat", "_chat", "Settings", "isMobile", "_clientContainer", "_createSidebar", "value", "_panel", "_splitter", "_updateInterface", "Splitter", "distance", "_clearMapper", "_clearChat", "_findPlugins", "_initChat", "_initMapper", "plugin", "w", "_loadOptions", "_updateMenuItem", "name", "e", "main", "d", "l", "c", "b", "bounds", "bounds2", "ghostBar", "maxWidth", "_move", "minWidth", "bh", "_updateSplitter", "_miniMapTitle", "_miniMapZoom", "_miniMap", "_displayScale", "MapDisplay", "room", "_setMapTitle", "setting", "Room", "_chatDisplay", "Display", "h", "_updateOrder", "toolbar", "_updateScrollLockButton", "_updateButtonState", "p", "pl", "data", "_splitterDistance", "_loadDisplayOptions", "display", "button", "state", "icon", "title", "el", "_zTimeout", "Client", "EventEmitter", "options", "_enableDebug", "_itemCache", "_variables", "_options", "version", "_plugins", "_display", "Display", "e", "_commandInput", "lock", "h", "width", "height", "msg", "data", "tag", "args", "title", "type", "_telnet", "Telnet", "err", "_autoConnectID", "_printInternal", "val", "mod", "idx", "dl", "c", "obj", "tmp", "getParameterByName", "_input", "Input", "history", "profile", "item", "MSP", "Mapper", "Status", "Logger", "Chat", "PanelBar", "ShadowMUD", "Test", "_profiles", "value", "enable", "host", "port", "keys", "k", "kl", "SortItemArrayByPriority", "trigger", "a", "s", "sl", "plugin", "name", "variables", "names", "nl", "n", "index", "txt", "resolve", "ProfileCollection", "profiles", "Profile", "al", "_alarm", "client", "state", "pattern", "Alarm", "p", "temp", "oldState", "newState", "alarm", "now", "dNow", "future", "fend", "_alarm_match", "old", "oAlarms", "changed", "patterns", "alarms", "parent", "line", "match", "ts", "sec", "min", "hr", "hours", "minutes", "seconds", "Settings", "colors", "cl", "_parseInternal", "remote", "force", "prependSplit", "str", "fore", "back", "newline", "forceLine", "codes", "echo", "style", "noEcho", "comments", "selectAll", "enabled", "message", "text", "eAlias", "stacking", "noFunction", "event", "delay", "windowName"]
}
